<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>350</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    350
                    <a href="349.html">prev</a>
                    <a href="351.html">next</a>
                    <a href="350_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_cbc70fa886c8cb9647e92d5fa9f8a4c032c94031_impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/ImpalaOutputFormat.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cbc70fa886c8cb9647e92d5fa9f8a4c032c94031:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/ImpalaOutputFormat.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cbc70fa886c8cb9647e92d5fa9f8a4c032c94031^1:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/ImpalaOutputFormat.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cbc70fa886c8cb9647e92d5fa9f8a4c032c94031^2:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/ImpalaOutputFormat.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;64c00d303220e98a602fec341743013447048eea:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/ImpalaOutputFormat.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [b], [b], [j]], subset: [[b], [b], [b], [b], [b], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-6349807778844055730" onmouseenter="enter('-6349807778844055730');" onmouseout="out('-6349807778844055730');" style="">  19 package com.dtstack.flink.sql.sink.impala;                                                               </span>
<span  style="">  20                                                                                                          </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  21 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="102868081392093008" onmouseenter="enter('102868081392093008');" onmouseout="out('102868081392093008');" style="">  22 import com.dtstack.flink.sql.outputformat.AbstractDtRichOutputFormat;                                    </span>
<span class="-8930056125403642162" onmouseenter="enter('-8930056125403642162');" onmouseout="out('-8930056125403642162');" style="">  23 import com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils;                                              </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="">  24 import com.dtstack.flink.sql.table.AbstractTableInfo;                                                    </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="">  25 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="6538493847244355843" onmouseenter="enter('6538493847244355843');" onmouseout="out('6538493847244355843');" style="">  26 import com.dtstack.flink.sql.util.KrbUtils;                                                              </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  27 import com.google.common.collect.Maps;                                                                   </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  28 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  29 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  30 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  31 import org.apache.flink.types.Row;                                                                       </span>
<span class="506888042235574053" onmouseenter="enter('506888042235574053');" onmouseout="out('506888042235574053');" style="">  32 import org.apache.hadoop.security.UserGroupInformation;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  33 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  34 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  35                                                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  36 import java.io.IOException;                                                                              </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  37 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  38 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="1742248696071637161" onmouseenter="enter('1742248696071637161');" onmouseout="out('1742248696071637161');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import java.security.PrivilegedAction;                                                                   </span>
<span class="7889752473047782369" onmouseenter="enter('7889752473047782369');" onmouseout="out('7889752473047782369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import java.security.PrivilegedExceptionAction;                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 import java.util.List;                                                                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42                                                                                                          </span>
<span class="-6257877604578820371" onmouseenter="enter('-6257877604578820371');" onmouseout="out('-6257877604578820371');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43 import static org.apache.flink.util.Preconditions.checkNotNull;                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 /**                                                                                                      </span>
<span class="-4713169250970759783" onmouseenter="enter('-4713169250970759783');" onmouseout="out('-4713169250970759783');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46  * @program: flinkStreamSQL                                                                              </span>
<span class="-449541966811423146" onmouseenter="enter('-449541966811423146');" onmouseout="out('-449541966811423146');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47  * @author: wuren                                                                                        </span>
<span class="8927744583550778879" onmouseenter="enter('8927744583550778879');" onmouseout="out('8927744583550778879');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48  * @create: 2020/09/11                                                                                   </span>
<span class="-547517873314350357" onmouseenter="enter('-547517873314350357');" onmouseout="out('-547517873314350357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49  **/                                                                                                     </span>
<span class="-3735883079583251544" onmouseenter="enter('-3735883079583251544');" onmouseout="out('-3735883079583251544');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50 public class ImpalaOutputFormat extends JDBCUpsertOutputFormat {                                         </span>
<span class="8204488434818797662" onmouseenter="enter('8204488434818797662');" onmouseout="out('8204488434818797662');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51     private String keytabPath;                                                                           </span>
<span class="-2918852778965959076" onmouseenter="enter('-2918852778965959076');" onmouseout="out('-2918852778965959076');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52     private String krb5confPath;                                                                         </span>
<span class="1721154694511290827" onmouseenter="enter('1721154694511290827');" onmouseout="out('1721154694511290827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53     private String principal;                                                                            </span>
<span class="4789602379336077849" onmouseenter="enter('4789602379336077849');" onmouseout="out('4789602379336077849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54     private Integer authMech;                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55                                                                                                          </span>
<span class="4732040019780124063" onmouseenter="enter('4732040019780124063');" onmouseout="out('4732040019780124063');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56     public ImpalaOutputFormat(                                                                           </span>
<span class="5167136634635436741" onmouseenter="enter('5167136634635436741');" onmouseout="out('5167136634635436741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57         JDBCOptions options,                                                                             </span>
<span class="-4736685996717817971" onmouseenter="enter('-4736685996717817971');" onmouseout="out('-4736685996717817971');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58         String[] fieldNames,                                                                             </span>
<span class="-2618125983682246634" onmouseenter="enter('-2618125983682246634');" onmouseout="out('-2618125983682246634');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59         String[] keyFields,                                                                              </span>
<span class="7293787081639991923" onmouseenter="enter('7293787081639991923');" onmouseout="out('7293787081639991923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60         String[] partitionFields,                                                                        </span>
<span class="1040707008318047089" onmouseenter="enter('1040707008318047089');" onmouseout="out('1040707008318047089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61         int[] fieldTypes,                                                                                </span>
<span class="-8839486848171122355" onmouseenter="enter('-8839486848171122355');" onmouseout="out('-8839486848171122355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62         int flushMaxSize,                                                                                </span>
<span class="-8297155974429506581" onmouseenter="enter('-8297155974429506581');" onmouseout="out('-8297155974429506581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63         long flushIntervalMills,                                                                         </span>
<span class="-7965801230461581297" onmouseenter="enter('-7965801230461581297');" onmouseout="out('-7965801230461581297');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64         boolean allReplace,                                                                              </span>
<span class="-6140757223057885564" onmouseenter="enter('-6140757223057885564');" onmouseout="out('-6140757223057885564');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65         String updateMode,                                                                               </span>
<span class="2636278067336184332" onmouseenter="enter('2636278067336184332');" onmouseout="out('2636278067336184332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66         Integer authMech,                                                                                </span>
<span class="8982626024191430910" onmouseenter="enter('8982626024191430910');" onmouseout="out('8982626024191430910');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67         String keytabPath,                                                                               </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  68 =======                                                                                                  </span>
<span class="6916252335749377687" onmouseenter="enter('6916252335749377687');" onmouseout="out('6916252335749377687');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  69 import java.rmi.RemoteException;                                                                         </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  70 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="7889752473047782369" onmouseenter="enter('7889752473047782369');" onmouseout="out('7889752473047782369');" style="">  71 import java.security.PrivilegedExceptionAction;                                                          </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="">  72 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="">  73 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="">  74 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  75 import java.sql.SQLException;                                                                            </span>
<span class="6402527026259660908" onmouseenter="enter('6402527026259660908');" onmouseout="out('6402527026259660908');" style="">  76 import java.sql.Statement;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  77 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  78 import java.util.Arrays;                                                                                 </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  79 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  80 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  81 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="">  82 import java.util.Objects;                                                                                </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  83 import java.util.Set;                                                                                    </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  84 import java.util.concurrent.ScheduledExecutorService;                                                    </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  85 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  86 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  87 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  88 import java.util.concurrent.atomic.AtomicReference;                                                      </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  89 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  90 import java.util.regex.Pattern;                                                                          </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  91 import java.util.stream.Collectors;                                                                      </span>
<span  style="">  92                                                                                                          </span>
<span class="1455633447019431220" onmouseenter="enter('1455633447019431220');" onmouseout="out('1455633447019431220');" style="">  93 import static com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils.setRecordToStatement;                  </span>
<span class="-6257877604578820371" onmouseenter="enter('-6257877604578820371');" onmouseout="out('-6257877604578820371');" style="">  94 import static org.apache.flink.util.Preconditions.checkNotNull;                                          </span>
<span  style="">  95                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  96 /**                                                                                                      </span>
<span class="7153001641478282104" onmouseenter="enter('7153001641478282104');" onmouseout="out('7153001641478282104');" style="">  97  * Date: 2020/10/14                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  98  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  99  *                                                                                                       </span>
<span class="-4100502199450942834" onmouseenter="enter('-4100502199450942834');" onmouseout="out('-4100502199450942834');" style=""> 100  * @author tiezhu                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 101  */                                                                                                      </span>
<span class="-4121149390422149560" onmouseenter="enter('-4121149390422149560');" onmouseout="out('-4121149390422149560');" style=""> 102 public class ImpalaOutputFormat extends AbstractDtRichOutputFormat&lt;Tuple2&lt;Boolean, Row&gt;&gt; {               </span>
<span  style=""> 103                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 104 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="4732040019780124063" onmouseenter="enter('4732040019780124063');" onmouseout="out('4732040019780124063');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 105     public ImpalaOutputFormat(                                                                           </span>
<span class="5167136634635436741" onmouseenter="enter('5167136634635436741');" onmouseout="out('5167136634635436741');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 106             JDBCOptions options,                                                                         </span>
<span class="-4736685996717817971" onmouseenter="enter('-4736685996717817971');" onmouseout="out('-4736685996717817971');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 107             String[] fieldNames,                                                                         </span>
<span class="-2618125983682246634" onmouseenter="enter('-2618125983682246634');" onmouseout="out('-2618125983682246634');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 108             String[] keyFields,                                                                          </span>
<span class="7293787081639991923" onmouseenter="enter('7293787081639991923');" onmouseout="out('7293787081639991923');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 109             String[] partitionFields,                                                                    </span>
<span class="1040707008318047089" onmouseenter="enter('1040707008318047089');" onmouseout="out('1040707008318047089');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 110             int[] fieldTypes,                                                                            </span>
<span class="-8839486848171122355" onmouseenter="enter('-8839486848171122355');" onmouseout="out('-8839486848171122355');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 111             int flushMaxSize,                                                                            </span>
<span class="-8297155974429506581" onmouseenter="enter('-8297155974429506581');" onmouseout="out('-8297155974429506581');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 112             long flushIntervalMills,                                                                     </span>
<span class="-7965801230461581297" onmouseenter="enter('-7965801230461581297');" onmouseout="out('-7965801230461581297');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 113             boolean allReplace,                                                                          </span>
<span class="-6140757223057885564" onmouseenter="enter('-6140757223057885564');" onmouseout="out('-6140757223057885564');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 114             String updateMode,                                                                           </span>
<span class="2636278067336184332" onmouseenter="enter('2636278067336184332');" onmouseout="out('2636278067336184332');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 115             Integer authMech,                                                                            </span>
<span class="8982626024191430910" onmouseenter="enter('8982626024191430910');" onmouseout="out('8982626024191430910');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 116             String keytabPath,                                                                           </span>
<span class="2911638970634649671" onmouseenter="enter('2911638970634649671');" onmouseout="out('2911638970634649671');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 117             String krb5confPath,                                                                         </span>
<span class="5930293090421288838" onmouseenter="enter('5930293090421288838');" onmouseout="out('5930293090421288838');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 118             String principal) {                                                                          </span>
<span class="6527672739007688219" onmouseenter="enter('6527672739007688219');" onmouseout="out('6527672739007688219');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 119         super(options,                                                                                   </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 120                 fieldNames,                                                                              </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 121                 keyFields,                                                                               </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 122                 partitionFields,                                                                         </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 123                 fieldTypes,                                                                              </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 124                 flushMaxSize,                                                                            </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 125                 flushIntervalMills,                                                                      </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 126                 allReplace,                                                                              </span>
<span class="-4700598038672216861" onmouseenter="enter('-4700598038672216861');" onmouseout="out('-4700598038672216861');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 127                 updateMode);                                                                             </span>
<span class="-4376363009887100958" onmouseenter="enter('-4376363009887100958');" onmouseout="out('-4376363009887100958');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 128         this.authMech = authMech;                                                                        </span>
<span class="6263908765738803139" onmouseenter="enter('6263908765738803139');" onmouseout="out('6263908765738803139');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 129         this.keytabPath = keytabPath;                                                                    </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 130         this.krb5confPath = krb5confPath;                                                                </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131         this.principal = principal;                                                                      </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 132 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133                                                                                                          </span>
<span class="4732040019780124063" onmouseenter="enter('4732040019780124063');" onmouseout="out('4732040019780124063');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134     public ImpalaOutputFormat(                                                                           </span>
<span class="5167136634635436741" onmouseenter="enter('5167136634635436741');" onmouseout="out('5167136634635436741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135         JDBCOptions options,                                                                             </span>
<span class="-4736685996717817971" onmouseenter="enter('-4736685996717817971');" onmouseout="out('-4736685996717817971');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136         String[] fieldNames,                                                                             </span>
<span class="-2618125983682246634" onmouseenter="enter('-2618125983682246634');" onmouseout="out('-2618125983682246634');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137         String[] keyFields,                                                                              </span>
<span class="7293787081639991923" onmouseenter="enter('7293787081639991923');" onmouseout="out('7293787081639991923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138         String[] partitionFields,                                                                        </span>
<span class="1040707008318047089" onmouseenter="enter('1040707008318047089');" onmouseout="out('1040707008318047089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139         int[] fieldTypes,                                                                                </span>
<span class="-8839486848171122355" onmouseenter="enter('-8839486848171122355');" onmouseout="out('-8839486848171122355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140         int flushMaxSize,                                                                                </span>
<span class="-8297155974429506581" onmouseenter="enter('-8297155974429506581');" onmouseout="out('-8297155974429506581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141         long flushIntervalMills,                                                                         </span>
<span class="-7965801230461581297" onmouseenter="enter('-7965801230461581297');" onmouseout="out('-7965801230461581297');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142         boolean allReplace,                                                                              </span>
<span class="-6140757223057885564" onmouseenter="enter('-6140757223057885564');" onmouseout="out('-6140757223057885564');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143         String updateMode,                                                                               </span>
<span class="2636278067336184332" onmouseenter="enter('2636278067336184332');" onmouseout="out('2636278067336184332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144         Integer authMech,                                                                                </span>
<span class="8982626024191430910" onmouseenter="enter('8982626024191430910');" onmouseout="out('8982626024191430910');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145         String keytabPath,                                                                               </span>
<span class="2911638970634649671" onmouseenter="enter('2911638970634649671');" onmouseout="out('2911638970634649671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146         String krb5confPath,                                                                             </span>
<span class="5930293090421288838" onmouseenter="enter('5930293090421288838');" onmouseout="out('5930293090421288838');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147         String principal) {                                                                              </span>
<span class="6527672739007688219" onmouseenter="enter('6527672739007688219');" onmouseout="out('6527672739007688219');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148         super(options,                                                                                   </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149             fieldNames,                                                                                  </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150             keyFields,                                                                                   </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151             partitionFields,                                                                             </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152             fieldTypes,                                                                                  </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153             flushMaxSize,                                                                                </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154             flushIntervalMills,                                                                          </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155             allReplace,                                                                                  </span>
<span class="-4700598038672216861" onmouseenter="enter('-4700598038672216861');" onmouseout="out('-4700598038672216861');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156             updateMode);                                                                                 </span>
<span class="-4376363009887100958" onmouseenter="enter('-4376363009887100958');" onmouseout="out('-4376363009887100958');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157         this.authMech = authMech;                                                                        </span>
<span class="6263908765738803139" onmouseenter="enter('6263908765738803139');" onmouseout="out('6263908765738803139');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158         this.keytabPath = keytabPath;                                                                    </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159         this.krb5confPath = krb5confPath;                                                                </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160         this.principal = principal;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165         if (authMech == 1) {                                                                             </span>
<span class="-7445609792053649263" onmouseenter="enter('-7445609792053649263');" onmouseout="out('-7445609792053649263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166             UserGroupInformation ugi = KrbUtils.loginAndReturnUgi(principal, keytabPath, krb5confPath);  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167             try {                                                                                        </span>
<span class="-7500201448081775902" onmouseenter="enter('-7500201448081775902');" onmouseout="out('-7500201448081775902');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168                 ugi.doAs(new PrivilegedExceptionAction&lt;Void&gt;() {                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169                     @Override                                                                            </span>
<span class="-91807086218371469" onmouseenter="enter('-91807086218371469');" onmouseout="out('-91807086218371469');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170                     public Void run() throws IOException {                                               </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171                         openJdbc();                                                                      </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172                         return null;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174                 });                                                                                      </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175             } catch (InterruptedException e) {                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178         } else {                                                                                         </span>
<span class="7285583204821622280" onmouseenter="enter('7285583204821622280');" onmouseout="out('7285583204821622280');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179             super.open(taskNumber, numTasks);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182                                                                                                          </span>
<span class="-2253996235710800331" onmouseenter="enter('-2253996235710800331');" onmouseout="out('-2253996235710800331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183     public static Builder impalaBuilder() {                                                              </span>
<span class="-1926211775479526780" onmouseenter="enter('-1926211775479526780');" onmouseout="out('-1926211775479526780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184         return new Builder();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186                                                                                                          </span>
<span class="2010609695383714647" onmouseenter="enter('2010609695383714647');" onmouseout="out('2010609695383714647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187     public static class Builder {                                                                        </span>
<span class="4789602379336077849" onmouseenter="enter('4789602379336077849');" onmouseout="out('4789602379336077849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188         private Integer authMech;                                                                        </span>
<span class="8204488434818797662" onmouseenter="enter('8204488434818797662');" onmouseout="out('8204488434818797662');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189         private String keytabPath;                                                                       </span>
<span class="-2918852778965959076" onmouseenter="enter('-2918852778965959076');" onmouseout="out('-2918852778965959076');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190         private String krb5confPath;                                                                     </span>
<span class="1721154694511290827" onmouseenter="enter('1721154694511290827');" onmouseout="out('1721154694511290827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191         private String principal;                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                                                                                                          </span>
<span class="8632875093914341707" onmouseenter="enter('8632875093914341707');" onmouseout="out('8632875093914341707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193         protected JDBCOptions options;                                                                   </span>
<span class="219098296700767876" onmouseenter="enter('219098296700767876');" onmouseout="out('219098296700767876');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194         protected String[] fieldNames;                                                                   </span>
<span class="5985906154332630684" onmouseenter="enter('5985906154332630684');" onmouseout="out('5985906154332630684');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195         protected String[] keyFields;                                                                    </span>
<span class="-2657046113209592975" onmouseenter="enter('-2657046113209592975');" onmouseout="out('-2657046113209592975');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196         protected String[] partitionFields;                                                              </span>
<span class="-2849472784703547647" onmouseenter="enter('-2849472784703547647');" onmouseout="out('-2849472784703547647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197         protected int[] fieldTypes;                                                                      </span>
<span class="-7994526912167873617" onmouseenter="enter('-7994526912167873617');" onmouseout="out('-7994526912167873617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198         protected int flushMaxSize = DEFAULT_FLUSH_MAX_SIZE;                                             </span>
<span class="-502504972010929057" onmouseenter="enter('-502504972010929057');" onmouseout="out('-502504972010929057');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199         protected long flushIntervalMills = DEFAULT_FLUSH_INTERVAL_MILLS;                                </span>
<span class="-1781405325688028484" onmouseenter="enter('-1781405325688028484');" onmouseout="out('-1781405325688028484');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200         protected boolean allReplace = DEFAULT_ALLREPLACE_VALUE;                                         </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201         protected String updateMode;                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203         /**                                                                                              </span>
<span class="5481504062898961016" onmouseenter="enter('5481504062898961016');" onmouseout="out('5481504062898961016');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204          * required, jdbc options.                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205          */                                                                                              </span>
<span class="-6789577863566851614" onmouseenter="enter('-6789577863566851614');" onmouseout="out('-6789577863566851614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206         public Builder setOptions(JDBCOptions options) {                                                 </span>
<span class="-4576342030125016864" onmouseenter="enter('-4576342030125016864');" onmouseout="out('-4576342030125016864');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207             this.options = options;                                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211         /**                                                                                              </span>
<span class="-6656747389933749738" onmouseenter="enter('-6656747389933749738');" onmouseout="out('-6656747389933749738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212          * required, field names of this jdbc sink.                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213          */                                                                                              </span>
<span class="4206393146938641816" onmouseenter="enter('4206393146938641816');" onmouseout="out('4206393146938641816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214         public Builder setFieldNames(String[] fieldNames) {                                              </span>
<span class="-8533428013592676521" onmouseenter="enter('-8533428013592676521');" onmouseout="out('-8533428013592676521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215             this.fieldNames = fieldNames;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219         /**                                                                                              </span>
<span class="-7266512599063730897" onmouseenter="enter('-7266512599063730897');" onmouseout="out('-7266512599063730897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220          * required, upsert unique keys.                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221          */                                                                                              </span>
<span class="5182547725706677872" onmouseenter="enter('5182547725706677872');" onmouseout="out('5182547725706677872');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222         public Builder setKeyFields(List&lt;String&gt; keyFields) {                                            </span>
<span class="-2040409877479865197" onmouseenter="enter('-2040409877479865197');" onmouseout="out('-2040409877479865197');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223             this.keyFields = keyFields == null ? null : keyFields.toArray(new String[keyFields.size()]); </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227         /**                                                                                              </span>
<span class="2669293159353915090" onmouseenter="enter('2669293159353915090');" onmouseout="out('2669293159353915090');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228          * required, field types of this jdbc sink.                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229          */                                                                                              </span>
<span class="-2827077114511059363" onmouseenter="enter('-2827077114511059363');" onmouseout="out('-2827077114511059363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230         public Builder setFieldTypes(int[] fieldTypes) {                                                 </span>
<span class="7622859212288666930" onmouseenter="enter('7622859212288666930');" onmouseout="out('7622859212288666930');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231             this.fieldTypes = fieldTypes;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235         /**                                                                                              </span>
<span class="8911651130315010133" onmouseenter="enter('8911651130315010133');" onmouseout="out('8911651130315010133');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236          * optional, partition Fields                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237          *                                                                                               </span>
<span class="-6644816777766472486" onmouseenter="enter('-6644816777766472486');" onmouseout="out('-6644816777766472486');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238          * @param partitionFields                                                                        </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239          * @return                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240          */                                                                                              </span>
<span class="85175638427035295" onmouseenter="enter('85175638427035295');" onmouseout="out('85175638427035295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241         public Builder setPartitionFields(String[] partitionFields) {                                    </span>
<span class="-5579362841573531869" onmouseenter="enter('-5579362841573531869');" onmouseout="out('-5579362841573531869');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242             this.partitionFields = partitionFields;                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246         /**                                                                                              </span>
<span class="-856751752856244493" onmouseenter="enter('-856751752856244493');" onmouseout="out('-856751752856244493');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247          * optional, flush max size (includes all append, upsert and delete records),                    </span>
<span class="-1144698166522235177" onmouseenter="enter('-1144698166522235177');" onmouseout="out('-1144698166522235177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248          * over this number of records, will flush data.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249          */                                                                                              </span>
<span class="6566053436650323939" onmouseenter="enter('6566053436650323939');" onmouseout="out('6566053436650323939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250         public Builder setFlushMaxSize(int flushMaxSize) {                                               </span>
<span class="1661332877772785928" onmouseenter="enter('1661332877772785928');" onmouseout="out('1661332877772785928');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251             this.flushMaxSize = flushMaxSize;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255         /**                                                                                              </span>
<span class="-69172137005245494" onmouseenter="enter('-69172137005245494');" onmouseout="out('-69172137005245494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256          * optional, flush interval mills, over this time, asynchronous threads will flush data.         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257          */                                                                                              </span>
<span class="-5174969731661074679" onmouseenter="enter('-5174969731661074679');" onmouseout="out('-5174969731661074679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258         public Builder setFlushIntervalMills(long flushIntervalMills) {                                  </span>
<span class="8894509418585583190" onmouseenter="enter('8894509418585583190');" onmouseout="out('8894509418585583190');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259             this.flushIntervalMills = flushIntervalMills;                                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 260 =======                                                                                                  </span>
<span class="-5870848474790717720" onmouseenter="enter('-5870848474790717720');" onmouseout="out('-5870848474790717720');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261     private static final Logger LOG = LoggerFactory.getLogger(ImpalaOutputFormat.class);                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262                                                                                                          </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264                                                                                                          </span>
<span class="-9068282285967712029" onmouseenter="enter('-9068282285967712029');" onmouseout="out('-9068282285967712029');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265     // ${field}                                                                                          </span>
<span class="-5949646080202310183" onmouseenter="enter('-5949646080202310183');" onmouseout="out('-5949646080202310183');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 266     private static final Pattern STATIC_PARTITION_PATTERN = Pattern.compile(&quot;\\$\\{([^}]*)}&quot;);           </span>
<span class="5956354208608974741" onmouseenter="enter('5956354208608974741');" onmouseout="out('5956354208608974741');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 267     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as timestamp)"> 267     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as time🔵</abbr></span>
<span class="1953221153478650066" onmouseenter="enter('1953221153478650066');" onmouseout="out('1953221153478650066');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 268     private static final Pattern TYPE_PATTERN = Pattern.compile(&quot;cast\\((.*) as (.*)\\)&quot;);               </span>
<span class="6992730206516090107" onmouseenter="enter('6992730206516090107');" onmouseout="out('6992730206516090107');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 269     //specific type which values need to be quoted                                                       </span>
<span class="-2884666096421851487" onmouseenter="enter('-2884666096421851487');" onmouseout="out('-2884666096421851487');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 270     private static final String[] NEED_QUOTE_TYPE = {&quot;string&quot;, &quot;timestamp&quot;, &quot;varchar&quot;};                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 271                                                                                                          </span>
<span class="191207487610103693" onmouseenter="enter('191207487610103693');" onmouseout="out('191207487610103693');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 272     private static final Integer DEFAULT_CONN_TIME_OUT = 60;                                             </span>
<span class="-1388186840411616756" onmouseenter="enter('-1388186840411616756');" onmouseout="out('-1388186840411616756');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 273     private static final int RECEIVE_DATA_PRINT_FREQUENCY = 1000;                                        </span>
<span class="-4268888009857984730" onmouseenter="enter('-4268888009857984730');" onmouseout="out('-4268888009857984730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 274     private static final int DIRTY_DATA_PRINT_FREQUENCY = 1000;                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 275                                                                                                          </span>
<span class="-588818051573867979" onmouseenter="enter('-588818051573867979');" onmouseout="out('-588818051573867979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 276     private static final String KUDU_TYPE = &quot;kudu&quot;;                                                      </span>
<span class="-6769623881035360393" onmouseenter="enter('-6769623881035360393');" onmouseout="out('-6769623881035360393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 277     private static final String UPDATE_MODE = &quot;update&quot;;                                                  </span>
<span class="-7709014261424944614" onmouseenter="enter('-7709014261424944614');" onmouseout="out('-7709014261424944614');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 278     private static final String PARTITION_CONSTANT = &quot;PARTITION&quot;;                                        </span>
<span class="1441081326157561113" onmouseenter="enter('1441081326157561113');" onmouseout="out('1441081326157561113');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 279     private static final String DRIVER_NAME = &quot;com.cloudera.impala.jdbc41.Driver&quot;;                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 280                                                                                                          </span>
<span class="-2689163518074835497" onmouseenter="enter('-2689163518074835497');" onmouseout="out('-2689163518074835497');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 281     private static final String VALUES_CONDITION = &quot;${valuesCondition}&quot;;                                 </span>
<span class="3062777246713899037" onmouseenter="enter('3062777246713899037');" onmouseout="out('3062777246713899037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 282     private static final String PARTITION_CONDITION = &quot;${partitionCondition}&quot;;                           </span>
<span class="2401236240707522557" onmouseenter="enter('2401236240707522557');" onmouseout="out('2401236240707522557');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 283     private static final String TABLE_FIELDS_CONDITION = &quot;${tableFieldsCondition}&quot;;                      </span>
<span class="3255739684264436552" onmouseenter="enter('3255739684264436552');" onmouseout="out('3255739684264436552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284     private static final String NO_PARTITION = &quot;noPartition&quot;;                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 285                                                                                                          </span>
<span class="-7445073777200404714" onmouseenter="enter('-7445073777200404714');" onmouseout="out('-7445073777200404714');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 286     protected transient Connection connection;                                                           </span>
<span class="-2184169902108079684" onmouseenter="enter('-2184169902108079684');" onmouseout="out('-2184169902108079684');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 287     protected transient Statement statement;                                                             </span>
<span class="6238382839663594696" onmouseenter="enter('6238382839663594696');" onmouseout="out('6238382839663594696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 288     protected transient PreparedStatement updateStatement;                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 289                                                                                                          </span>
<span class="4293032579277507790" onmouseenter="enter('4293032579277507790');" onmouseout="out('4293032579277507790');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 290     private transient volatile boolean closed = false;                                                   </span>
<span class="8220840984571392918" onmouseenter="enter('8220840984571392918');" onmouseout="out('8220840984571392918');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 291     private int batchCount = 0;                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292                                                                                                          </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293     // |------------------------------------------------|                                                </span>
<span class="-789927222958732888" onmouseenter="enter('-789927222958732888');" onmouseout="out('-789927222958732888');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 294     // |   partitionCondition   |Array of valueCondition|                                                </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295     // |------------------------------------------------|                                                </span>
<span class="-8825804998995953162" onmouseenter="enter('-8825804998995953162');" onmouseout="out('-8825804998995953162');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296     // | ptOne, ptTwo, ptThree  | [(v1, v2, v3, v4, v5)]|   DP                                           </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297     // |------------------------------------------------|                                                </span>
<span class="-5802382310877164118" onmouseenter="enter('-5802382310877164118');" onmouseout="out('-5802382310877164118');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298     // | ptOne = v1, ptTwo = v2 | [(v3, v4, v5)]        |   SP                                           </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 299     // |------------------------------------------------|                                                </span>
<span class="2984234039288316275" onmouseenter="enter('2984234039288316275');" onmouseout="out('2984234039288316275');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 300     // | ptOne, ptTwo = v2      | [(v1, v3, v4, v5)]    |   DP and SP                                    </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 301     // |------------------------------------------------|                                                </span>
<span class="7219405512764117222" onmouseenter="enter('7219405512764117222');" onmouseout="out('7219405512764117222');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302     // | noPartition            | [(v1, v2, v3, v4, v5)]|   kudu or disablePartition                     </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303     // |------------------------------------------------|                                                </span>
<span class="9020411500856357590" onmouseenter="enter('9020411500856357590');" onmouseout="out('9020411500856357590');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304     private transient Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap;                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305                                                                                                          </span>
<span class="-4172535577750872346" onmouseenter="enter('-4172535577750872346');" onmouseout="out('-4172535577750872346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306     protected String keytabPath;                                                                         </span>
<span class="1987487277257130103" onmouseenter="enter('1987487277257130103');" onmouseout="out('1987487277257130103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307     protected String krb5confPath;                                                                       </span>
<span class="3478885111338451838" onmouseenter="enter('3478885111338451838');" onmouseout="out('3478885111338451838');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 308     protected String principal;                                                                          </span>
<span class="-2673327721248325609" onmouseenter="enter('-2673327721248325609');" onmouseout="out('-2673327721248325609');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 309     protected Integer authMech;                                                                          </span>
<span class="-8834882937031238604" onmouseenter="enter('-8834882937031238604');" onmouseout="out('-8834882937031238604');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 310     protected String dbUrl;                                                                              </span>
<span class="4348689613054045460" onmouseenter="enter('4348689613054045460');" onmouseout="out('4348689613054045460');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 311     protected String userName;                                                                           </span>
<span class="519247125889688558" onmouseenter="enter('519247125889688558');" onmouseout="out('519247125889688558');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312     protected String password;                                                                           </span>
<span class="-7554929939288236010" onmouseenter="enter('-7554929939288236010');" onmouseout="out('-7554929939288236010');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 313     protected int batchSize = 100;                                                                       </span>
<span class="8848445520039039194" onmouseenter="enter('8848445520039039194');" onmouseout="out('8848445520039039194');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 314     protected long batchWaitInterval = 60 * 1000L;                                                       </span>
<span class="6924126392600265325" onmouseenter="enter('6924126392600265325');" onmouseout="out('6924126392600265325');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315     protected String tableName;                                                                          </span>
<span class="-8067881189136281922" onmouseenter="enter('-8067881189136281922');" onmouseout="out('-8067881189136281922');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 316     protected List&lt;String&gt; primaryKeys;                                                                  </span>
<span class="-1238809985534246985" onmouseenter="enter('-1238809985534246985');" onmouseout="out('-1238809985534246985');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 317     protected String partitionFields;                                                                    </span>
<span class="-2843446813182919439" onmouseenter="enter('-2843446813182919439');" onmouseout="out('-2843446813182919439');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318     protected Boolean enablePartition;                                                                   </span>
<span class="3349082107931708476" onmouseenter="enter('3349082107931708476');" onmouseout="out('3349082107931708476');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319     protected String schema;                                                                             </span>
<span class="-2869920961807604939" onmouseenter="enter('-2869920961807604939');" onmouseout="out('-2869920961807604939');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320     protected String storeType;                                                                          </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321     protected String updateMode;                                                                         </span>
<span class="8729932671243795004" onmouseenter="enter('8729932671243795004');" onmouseout="out('8729932671243795004');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322     public List&lt;String&gt; fieldNames;                                                                      </span>
<span class="5323664213258183290" onmouseenter="enter('5323664213258183290');" onmouseout="out('5323664213258183290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323     public List&lt;String&gt; fieldTypes;                                                                      </span>
<span class="589573262942162938" onmouseenter="enter('589573262942162938');" onmouseout="out('589573262942162938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 324     public List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList;                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 325                                                                                                          </span>
<span class="-2123205835999557493" onmouseenter="enter('-2123205835999557493');" onmouseout="out('-2123205835999557493');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 326     // partition field of static partition which matched by ${field}                                     </span>
<span class="-976040292573398488" onmouseenter="enter('-976040292573398488');" onmouseout="out('-976040292573398488');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 327     private final List&lt;String&gt; staticPartitionFields = new ArrayList&lt;&gt;();                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 328                                                                                                          </span>
<span class="8461763253073029471" onmouseenter="enter('8461763253073029471');" onmouseout="out('8461763253073029471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 329     // valueFieldsName -&gt; 重组之后的fieldNames，为了重组row data字段值对应                                              </span>
<span class="-5473349939362349748" onmouseenter="enter('-5473349939362349748');" onmouseout="out('-5473349939362349748');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 330     // 需要对partition字段做特殊处理，比如原来的字段顺序为(age, name, id)，但是因为partition，写入的SQL为                               </span>
<span class="888010466316090175" onmouseenter="enter('888010466316090175');" onmouseout="out('888010466316090175');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331     // INSERT INTO tableName(name, id) PARTITION(age) VALUES(?, ?, ?)                                    </span>
<span class="1229277488566704041" onmouseenter="enter('1229277488566704041');" onmouseout="out('1229277488566704041');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 332     // 那么实际executeSql设置字段的顺序应该为(name, id, age)，同时，字段对应的type顺序也需要重组                                       </span>
<span class="6098973354216055964" onmouseenter="enter('6098973354216055964');" onmouseout="out('6098973354216055964');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333     private List&lt;String&gt; valueFieldNames;                                                                </span>
<span class="-7108089166418781511" onmouseenter="enter('-7108089166418781511');" onmouseout="out('-7108089166418781511');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 334     private transient AbstractDtRichOutputFormat&lt;?&gt; metricOutputFormat;                                  </span>
<span class="273368026714901275" onmouseenter="enter('273368026714901275');" onmouseout="out('273368026714901275');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 335     private List&lt;Row&gt; rows;                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336                                                                                                          </span>
<span class="9015955711937997200" onmouseenter="enter('9015955711937997200');" onmouseout="out('9015955711937997200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 337     private transient ScheduledExecutorService scheduler;                                                </span>
<span class="-5761494216005426476" onmouseenter="enter('-5761494216005426476');" onmouseout="out('-5761494216005426476');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 338     private transient ScheduledFuture&lt;?&gt; scheduledFuture;                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 339                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 340     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 341     public void configure(Configuration parameters) {                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 342 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343     }                                                                                                    </span>
<span  style=""> 344                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 345     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style=""> 346     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 347         try {                                                                                            </span>
<span class="4324779626821739975" onmouseenter="enter('4324779626821739975');" onmouseout="out('4324779626821739975');" style=""> 348             rowDataMap = new HashMap&lt;&gt;();                                                                </span>
<span class="-6551372933934183741" onmouseenter="enter('-6551372933934183741');" onmouseout="out('-6551372933934183741');" style=""> 349             rows = new ArrayList&lt;&gt;();                                                                    </span>
<span class="-7937337195293668220" onmouseenter="enter('-7937337195293668220');" onmouseout="out('-7937337195293668220');" style=""> 350             metricOutputFormat = this;                                                                   </span>
<span class="-8035752082134444550" onmouseenter="enter('-8035752082134444550');" onmouseout="out('-8035752082134444550');" style=""> 351             openConnect();                                                                               </span>
<span class="-3251827356232524015" onmouseenter="enter('-3251827356232524015');" onmouseout="out('-3251827356232524015');" style=""> 352             initScheduledTask(batchWaitInterval);                                                        </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 353             init();                                                                                      </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style=""> 354             initMetric();                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 355         } catch (Exception e) {                                                                          </span>
<span class="-105883012207117402" onmouseenter="enter('-105883012207117402');" onmouseout="out('-105883012207117402');" style=""> 356             throw new RuntimeException(&quot;impala output format open error!&quot;, e);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358     }                                                                                                    </span>
<span  style=""> 359                                                                                                          </span>
<span class="-8578201295687943948" onmouseenter="enter('-8578201295687943948');" onmouseout="out('-8578201295687943948');" style=""> 360     private void init() throws SQLException {                                                            </span>
<span class="-8350145873279772804" onmouseenter="enter('-8350145873279772804');" onmouseout="out('-8350145873279772804');" style=""> 361         if (Objects.nonNull(partitionFields)) {                                                          </span>
<span class="8590422903839909721" onmouseenter="enter('8590422903839909721');" onmouseout="out('8590422903839909721');" style=""> 362             // match ${field} from partitionFields                                                       </span>
<span class="399614494149678967" onmouseenter="enter('399614494149678967');" onmouseout="out('399614494149678967');" style=""> 363             Matcher matcher = STATIC_PARTITION_PATTERN.matcher(partitionFields);                         </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 364             while (matcher.find()) {                                                                     </span>
<span class="-1180668930060799754" onmouseenter="enter('-1180668930060799754');" onmouseout="out('-1180668930060799754');" style=""> 365                 LOG.info(&quot;find static partition field: {}&quot;, matcher.group(1));                           </span>
<span class="5933786634924389530" onmouseenter="enter('5933786634924389530');" onmouseout="out('5933786634924389530');" style=""> 366                 staticPartitionFields.add(matcher.group(1));                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368         }                                                                                                </span>
<span  style=""> 369                                                                                                          </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style=""> 370         if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                                  </span>
<span class="-511688609314859464" onmouseenter="enter('-511688609314859464');" onmouseout="out('-511688609314859464');" style=""> 371             if (!storeType.equalsIgnoreCase(KUDU_TYPE)) {                                                </span>
<span class="7738691828431171650" onmouseenter="enter('7738691828431171650');" onmouseout="out('7738691828431171650');" style=""> 372                 throw new IllegalArgumentException(&quot;update mode not support for non-kudu table!&quot;);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373             }                                                                                            </span>
<span  style=""> 374                                                                                                          </span>
<span class="-1926567860735108753" onmouseenter="enter('-1926567860735108753');" onmouseout="out('-1926567860735108753');" style=""><abbr title=" 375             updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, primaryKeys));"> 375             updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, p🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 376             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377         }                                                                                                </span>
<span  style=""> 378                                                                                                          </span>
<span class="5264299831364970974" onmouseenter="enter('5264299831364970974');" onmouseout="out('5264299831364970974');" style=""><abbr title=" 379         valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, partitionFields);"> 379         valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380     }                                                                                                    </span>
<span  style=""> 381                                                                                                          </span>
<span class="-4335191442342413864" onmouseenter="enter('-4335191442342413864');" onmouseout="out('-4335191442342413864');" style=""> 382     private void initScheduledTask(Long batchWaitInterval) {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 383         try {                                                                                            </span>
<span class="-5481453632006175071" onmouseenter="enter('-5481453632006175071');" onmouseout="out('-5481453632006175071');" style=""> 384             if (batchWaitInterval != 0) {                                                                </span>
<span class="777682131179381780" onmouseenter="enter('777682131179381780');" onmouseout="out('777682131179381780');" style=""> 385                 this.scheduler = new ScheduledThreadPoolExecutor(1,                                      </span>
<span class="714213466749562787" onmouseenter="enter('714213466749562787');" onmouseout="out('714213466749562787');" style=""> 386                         new DTThreadFactory(&quot;impala-upsert-output-format&quot;));                             </span>
<span class="-7149116985444787635" onmouseenter="enter('-7149116985444787635');" onmouseout="out('-7149116985444787635');" style=""> 387                 this.scheduledFuture = this.scheduler.scheduleWithFixedDelay(() -&gt; {                     </span>
<span class="-940414522275968791" onmouseenter="enter('-940414522275968791');" onmouseout="out('-940414522275968791');" style=""> 388                     synchronized (ImpalaOutputFormat.this) {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 389                         try {                                                                            </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style=""> 390                             flush();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 391                         } catch (Exception e) {                                                          </span>
<span class="-5628183046854957718" onmouseenter="enter('-5628183046854957718');" onmouseout="out('-5628183046854957718');" style=""> 392                             LOG.error(&quot;Writing records to impala jdbc failed.&quot;, e);                      </span>
<span class="-7023774051195191894" onmouseenter="enter('-7023774051195191894');" onmouseout="out('-7023774051195191894');" style=""> 393                             throw new RuntimeException(&quot;Writing records to impala jdbc failed.&quot;, e);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395                     }                                                                                    </span>
<span class="8465771028460365894" onmouseenter="enter('8465771028460365894');" onmouseout="out('8465771028460365894');" style=""> 396                 }, batchWaitInterval, batchWaitInterval, TimeUnit.MILLISECONDS);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 397             }                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 398         } catch (Exception e) {                                                                          </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style=""> 399             throw new RuntimeException(e);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401     }                                                                                                    </span>
<span  style=""> 402                                                                                                          </span>
<span class="-2844613068709206340" onmouseenter="enter('-2844613068709206340');" onmouseout="out('-2844613068709206340');" style=""> 403     private void openConnect() throws IOException {                                                      </span>
<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style=""> 404         if (authMech == 1) {                                                                             </span>
<span class="-7445609792053649263" onmouseenter="enter('-7445609792053649263');" onmouseout="out('-7445609792053649263');" style=""> 405             UserGroupInformation ugi = KrbUtils.loginAndReturnUgi(principal, keytabPath, krb5confPath);  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 406             try {                                                                                        </span>
<span class="1057249312142684394" onmouseenter="enter('1057249312142684394');" onmouseout="out('1057249312142684394');" style=""> 407                 ugi.doAs((PrivilegedExceptionAction&lt;Void&gt;) () -&gt; {                                       </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style=""> 408                     openJdbc();                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 409                     return null;                                                                         </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 410                 });                                                                                      </span>
<span class="3693318474890767753" onmouseenter="enter('3693318474890767753');" onmouseout="out('3693318474890767753');" style=""> 411             } catch (InterruptedException | IOException e) {                                             </span>
<span class="-3216725393010457363" onmouseenter="enter('-3216725393010457363');" onmouseout="out('-3216725393010457363');" style=""> 412                 throw new IllegalArgumentException(&quot;connect impala error!&quot;, e);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 414         } else {                                                                                         </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style=""> 415             openJdbc();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417     }                                                                                                    </span>
<span  style=""> 418                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 419 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-2253996235710800331" onmouseenter="enter('-2253996235710800331');" onmouseout="out('-2253996235710800331');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 420     public static Builder impalaBuilder() {                                                              </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 421 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 422                                                                                                          </span>
<span class="-2253996235710800331" onmouseenter="enter('-2253996235710800331');" onmouseout="out('-2253996235710800331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 423     public static Builder impalaBuilder() {                                                              </span>
<span class="-1926211775479526780" onmouseenter="enter('-1926211775479526780');" onmouseout="out('-1926211775479526780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 424         return new Builder();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 425     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 426                                                                                                          </span>
<span class="2010609695383714647" onmouseenter="enter('2010609695383714647');" onmouseout="out('2010609695383714647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 427     public static class Builder {                                                                        </span>
<span class="4789602379336077849" onmouseenter="enter('4789602379336077849');" onmouseout="out('4789602379336077849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 428         private Integer authMech;                                                                        </span>
<span class="8204488434818797662" onmouseenter="enter('8204488434818797662');" onmouseout="out('8204488434818797662');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 429         private String keytabPath;                                                                       </span>
<span class="-2918852778965959076" onmouseenter="enter('-2918852778965959076');" onmouseout="out('-2918852778965959076');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 430         private String krb5confPath;                                                                     </span>
<span class="1721154694511290827" onmouseenter="enter('1721154694511290827');" onmouseout="out('1721154694511290827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 431         private String principal;                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 432                                                                                                          </span>
<span class="8632875093914341707" onmouseenter="enter('8632875093914341707');" onmouseout="out('8632875093914341707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 433         protected JDBCOptions options;                                                                   </span>
<span class="219098296700767876" onmouseenter="enter('219098296700767876');" onmouseout="out('219098296700767876');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 434         protected String[] fieldNames;                                                                   </span>
<span class="5985906154332630684" onmouseenter="enter('5985906154332630684');" onmouseout="out('5985906154332630684');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 435         protected String[] keyFields;                                                                    </span>
<span class="-2657046113209592975" onmouseenter="enter('-2657046113209592975');" onmouseout="out('-2657046113209592975');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 436         protected String[] partitionFields;                                                              </span>
<span class="-2849472784703547647" onmouseenter="enter('-2849472784703547647');" onmouseout="out('-2849472784703547647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 437         protected int[] fieldTypes;                                                                      </span>
<span class="-7994526912167873617" onmouseenter="enter('-7994526912167873617');" onmouseout="out('-7994526912167873617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 438         protected int flushMaxSize = DEFAULT_FLUSH_MAX_SIZE;                                             </span>
<span class="-502504972010929057" onmouseenter="enter('-502504972010929057');" onmouseout="out('-502504972010929057');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 439         protected long flushIntervalMills = DEFAULT_FLUSH_INTERVAL_MILLS;                                </span>
<span class="-1781405325688028484" onmouseenter="enter('-1781405325688028484');" onmouseout="out('-1781405325688028484');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 440         protected boolean allReplace = DEFAULT_ALLREPLACE_VALUE;                                         </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 441         protected String updateMode;                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 442                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 443         /**                                                                                              </span>
<span class="5481504062898961016" onmouseenter="enter('5481504062898961016');" onmouseout="out('5481504062898961016');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444          * required, jdbc options.                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 445          */                                                                                              </span>
<span class="-6789577863566851614" onmouseenter="enter('-6789577863566851614');" onmouseout="out('-6789577863566851614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446         public Builder setOptions(JDBCOptions options) {                                                 </span>
<span class="-4576342030125016864" onmouseenter="enter('-4576342030125016864');" onmouseout="out('-4576342030125016864');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447             this.options = options;                                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 451         /**                                                                                              </span>
<span class="-6656747389933749738" onmouseenter="enter('-6656747389933749738');" onmouseout="out('-6656747389933749738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 452          * required, field names of this jdbc sink.                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 453          */                                                                                              </span>
<span class="4206393146938641816" onmouseenter="enter('4206393146938641816');" onmouseout="out('4206393146938641816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 454         public Builder setFieldNames(String[] fieldNames) {                                              </span>
<span class="-8533428013592676521" onmouseenter="enter('-8533428013592676521');" onmouseout="out('-8533428013592676521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 455             this.fieldNames = fieldNames;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 456             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 457         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 458                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 459         /**                                                                                              </span>
<span class="-7266512599063730897" onmouseenter="enter('-7266512599063730897');" onmouseout="out('-7266512599063730897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 460          * required, upsert unique keys.                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 461          */                                                                                              </span>
<span class="5182547725706677872" onmouseenter="enter('5182547725706677872');" onmouseout="out('5182547725706677872');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 462         public Builder setKeyFields(List&lt;String&gt; keyFields) {                                            </span>
<span class="-2040409877479865197" onmouseenter="enter('-2040409877479865197');" onmouseout="out('-2040409877479865197');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 463             this.keyFields = keyFields == null ? null : keyFields.toArray(new String[keyFields.size()]); </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 464             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 465         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 466                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 467         /**                                                                                              </span>
<span class="2669293159353915090" onmouseenter="enter('2669293159353915090');" onmouseout="out('2669293159353915090');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 468          * required, field types of this jdbc sink.                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 469          */                                                                                              </span>
<span class="-2827077114511059363" onmouseenter="enter('-2827077114511059363');" onmouseout="out('-2827077114511059363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 470         public Builder setFieldTypes(int[] fieldTypes) {                                                 </span>
<span class="7622859212288666930" onmouseenter="enter('7622859212288666930');" onmouseout="out('7622859212288666930');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 471             this.fieldTypes = fieldTypes;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 472             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 473         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 474                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 475         /**                                                                                              </span>
<span class="8911651130315010133" onmouseenter="enter('8911651130315010133');" onmouseout="out('8911651130315010133');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 476          * optional, partition Fields                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 477          *                                                                                               </span>
<span class="-6644816777766472486" onmouseenter="enter('-6644816777766472486');" onmouseout="out('-6644816777766472486');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 478          * @param partitionFields                                                                        </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 479          * @return                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 480          */                                                                                              </span>
<span class="85175638427035295" onmouseenter="enter('85175638427035295');" onmouseout="out('85175638427035295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 481         public Builder setPartitionFields(String[] partitionFields) {                                    </span>
<span class="-5579362841573531869" onmouseenter="enter('-5579362841573531869');" onmouseout="out('-5579362841573531869');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 482             this.partitionFields = partitionFields;                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 483             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 484         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 485                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 486         /**                                                                                              </span>
<span class="-856751752856244493" onmouseenter="enter('-856751752856244493');" onmouseout="out('-856751752856244493');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 487          * optional, flush max size (includes all append, upsert and delete records),                    </span>
<span class="-1144698166522235177" onmouseenter="enter('-1144698166522235177');" onmouseout="out('-1144698166522235177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 488          * over this number of records, will flush data.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 489          */                                                                                              </span>
<span class="6566053436650323939" onmouseenter="enter('6566053436650323939');" onmouseout="out('6566053436650323939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 490         public Builder setFlushMaxSize(int flushMaxSize) {                                               </span>
<span class="1661332877772785928" onmouseenter="enter('1661332877772785928');" onmouseout="out('1661332877772785928');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 491             this.flushMaxSize = flushMaxSize;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 492             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 493         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 494                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 495         /**                                                                                              </span>
<span class="-69172137005245494" onmouseenter="enter('-69172137005245494');" onmouseout="out('-69172137005245494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 496          * optional, flush interval mills, over this time, asynchronous threads will flush data.         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 497          */                                                                                              </span>
<span class="-5174969731661074679" onmouseenter="enter('-5174969731661074679');" onmouseout="out('-5174969731661074679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 498         public Builder setFlushIntervalMills(long flushIntervalMills) {                                  </span>
<span class="8894509418585583190" onmouseenter="enter('8894509418585583190');" onmouseout="out('8894509418585583190');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 499             this.flushIntervalMills = flushIntervalMills;                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 500             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 501         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 502                                                                                                          </span>
<span class="-6829645289886270021" onmouseenter="enter('-6829645289886270021');" onmouseout="out('-6829645289886270021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 503         public Builder setAllReplace(boolean allReplace) {                                               </span>
<span class="-7939456506453079727" onmouseenter="enter('-7939456506453079727');" onmouseout="out('-7939456506453079727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 504             this.allReplace = allReplace;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 505             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 506         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 507                                                                                                          </span>
<span class="-8865383825618932145" onmouseenter="enter('-8865383825618932145');" onmouseout="out('-8865383825618932145');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 508         public Builder setUpdateMode(String updateMode) {                                                </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 509             this.updateMode = updateMode;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 510             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 511         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 512                                                                                                          </span>
<span class="-8991908924314829739" onmouseenter="enter('-8991908924314829739');" onmouseout="out('-8991908924314829739');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 513         public Builder setAuthMech(Integer authMech) {                                                   </span>
<span class="-4376363009887100958" onmouseenter="enter('-4376363009887100958');" onmouseout="out('-4376363009887100958');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 514             this.authMech = authMech;                                                                    </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 515             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 516         }                                                                                                </span>
<span class="-5894016934964343602" onmouseenter="enter('-5894016934964343602');" onmouseout="out('-5894016934964343602');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 517         public Builder setKeytabPath(String keytabPath) {                                                </span>
<span class="6263908765738803139" onmouseenter="enter('6263908765738803139');" onmouseout="out('6263908765738803139');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 518             this.keytabPath = keytabPath;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 519             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 520         }                                                                                                </span>
<span class="3824864761746312224" onmouseenter="enter('3824864761746312224');" onmouseout="out('3824864761746312224');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 521         public Builder setKrb5confPath(String krb5confPath) {                                            </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 522             this.krb5confPath = krb5confPath;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 523             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 524         }                                                                                                </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 525         public Builder setPrincipal(String principal) {                                                  </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 526             this.principal = principal;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 527             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 528         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 529                                                                                                          </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 530         public ImpalaOutputFormat build() {                                                              </span>
<span class="-4875931377123605731" onmouseenter="enter('-4875931377123605731');" onmouseout="out('-4875931377123605731');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 531             checkNotNull(options, &quot;No options supplied.&quot;);                                               </span>
<span class="-7519421098126359785" onmouseenter="enter('-7519421098126359785');" onmouseout="out('-7519421098126359785');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 532             checkNotNull(fieldNames, &quot;No fieldNames supplied.&quot;);                                         </span>
<span class="-465714982636894626" onmouseenter="enter('-465714982636894626');" onmouseout="out('-465714982636894626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 533             return new ImpalaOutputFormat(                                                               </span>
<span class="-1722348633561755627" onmouseenter="enter('-1722348633561755627');" onmouseout="out('-1722348633561755627');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 534                 options,                                                                                 </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 535                 fieldNames,                                                                              </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 536                 keyFields,                                                                               </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 537                 partitionFields,                                                                         </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 538                 fieldTypes,                                                                              </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 539                 flushMaxSize,                                                                            </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 540                 flushIntervalMills,                                                                      </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 541                 allReplace,                                                                              </span>
<span class="7760506155904782707" onmouseenter="enter('7760506155904782707');" onmouseout="out('7760506155904782707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 542                 updateMode,                                                                              </span>
<span class="-4863483435840713149" onmouseenter="enter('-4863483435840713149');" onmouseout="out('-4863483435840713149');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 543                 authMech,                                                                                </span>
<span class="6910046306719868385" onmouseenter="enter('6910046306719868385');" onmouseout="out('6910046306719868385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 544                 keytabPath,                                                                              </span>
<span class="2510923373943101588" onmouseenter="enter('2510923373943101588');" onmouseout="out('2510923373943101588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 545                 krb5confPath,                                                                            </span>
<span class="-3475871463423309499" onmouseenter="enter('-3475871463423309499');" onmouseout="out('-3475871463423309499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 546                 principal);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 547         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 548     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 549 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 550 =======                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551     /**                                                                                                  </span>
<span class="-4019084214603833891" onmouseenter="enter('-4019084214603833891');" onmouseout="out('-4019084214603833891');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552      * get jdbc connection                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553      */                                                                                                  </span>
<span class="6517717324631316532" onmouseenter="enter('6517717324631316532');" onmouseout="out('6517717324631316532');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 554     private void openJdbc() {                                                                            </span>
<span class="-5989471214664392944" onmouseenter="enter('-5989471214664392944');" onmouseout="out('-5989471214664392944');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555         JDBCUtils.forName(DRIVER_NAME, getClass().getClassLoader());                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 556         try {                                                                                            </span>
<span class="-4188974437029144237" onmouseenter="enter('-4188974437029144237');" onmouseout="out('-4188974437029144237');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557             connection = DriverManager.getConnection(dbUrl, userName, password);                         </span>
<span class="-3909190598463408725" onmouseenter="enter('-3909190598463408725');" onmouseout="out('-3909190598463408725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558             statement = connection.createStatement();                                                    </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559             connection.setAutoCommit(false);                                                             </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 560         } catch (SQLException sqlException) {                                                            </span>
<span class="8417232372887360387" onmouseenter="enter('8417232372887360387');" onmouseout="out('8417232372887360387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561             throw new RuntimeException(&quot;get impala jdbc connection failed!&quot;, sqlException);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564                                                                                                          </span>
<span class="7521208138226245516" onmouseenter="enter('7521208138226245516');" onmouseout="out('7521208138226245516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565     private void flush() throws Exception {                                                              </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566         if (batchCount &gt; 0) {                                                                            </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567             if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                              </span>
<span class="-7210745719484505959" onmouseenter="enter('-7210745719484505959');" onmouseout="out('-7210745719484505959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568                 executeUpdateBatch();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569             }                                                                                            </span>
<span class="-5565980137871755476" onmouseenter="enter('-5565980137871755476');" onmouseout="out('-5565980137871755476');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570             if (!rowDataMap.isEmpty()) {                                                                 </span>
<span class="8546814641173072756" onmouseenter="enter('8546814641173072756');" onmouseout="out('8546814641173072756');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571                 String templateSql =                                                                     </span>
<span class="-1766017053596733683" onmouseenter="enter('-1766017053596733683');" onmouseout="out('-1766017053596733683');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 572                         &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VALUES ${valuesCondition}&quot;;"> 572                         &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VA🔵</abbr></span>
<span class="7007887973141057675" onmouseenter="enter('7007887973141057675');" onmouseout="out('7007887973141057675');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573                 executeBatchSql(                                                                         </span>
<span class="839015566868436312" onmouseenter="enter('839015566868436312');" onmouseout="out('839015566868436312');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574                         statement,                                                                       </span>
<span class="-8931083358346849072" onmouseenter="enter('-8931083358346849072');" onmouseout="out('-8931083358346849072');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575                         templateSql,                                                                     </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576                         schema,                                                                          </span>
<span class="8599198975592615021" onmouseenter="enter('8599198975592615021');" onmouseout="out('8599198975592615021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577                         tableName,                                                                       </span>
<span class="7739930709415439240" onmouseenter="enter('7739930709415439240');" onmouseout="out('7739930709415439240');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578                         storeType,                                                                       </span>
<span class="4460343981916954231" onmouseenter="enter('4460343981916954231');" onmouseout="out('4460343981916954231');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 579                         enablePartition,                                                                 </span>
<span class="-232795436679668454" onmouseenter="enter('-232795436679668454');" onmouseout="out('-232795436679668454');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580                         valueFieldNames,                                                                 </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581                         partitionFields,                                                                 </span>
<span class="-163268273074797630" onmouseenter="enter('-163268273074797630');" onmouseout="out('-163268273074797630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582                         rowDataMap                                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583                 );                                                                                       </span>
<span class="1629791312198735010" onmouseenter="enter('1629791312198735010');" onmouseout="out('1629791312198735010');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584                 rowDataMap.clear();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586         }                                                                                                </span>
<span class="-5311733944590264805" onmouseenter="enter('-5311733944590264805');" onmouseout="out('-5311733944590264805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 587         batchCount = 0;                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 591     /**                                                                                                  </span>
<span class="-1106181825212481278" onmouseenter="enter('-1106181825212481278');" onmouseout="out('-1106181825212481278');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592      * execute batch update statement                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593      *                                                                                                   </span>
<span class="3560665881375675274" onmouseenter="enter('3560665881375675274');" onmouseout="out('3560665881375675274');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594      * @throws SQLException throw sql exception                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 595      */                                                                                                  </span>
<span class="3206601587144870407" onmouseenter="enter('3206601587144870407');" onmouseout="out('3206601587144870407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 596     private void executeUpdateBatch() throws SQLException {                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 597         try {                                                                                            </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 598             rows.forEach(row -&gt; {                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 599                 try {                                                                                    </span>
<span class="-1215139546593028546" onmouseenter="enter('-1215139546593028546');" onmouseout="out('-1215139546593028546');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 600                     JDBCTypeConvertUtils.setRecordToStatement(                                           </span>
<span class="-4710389352980966846" onmouseenter="enter('-4710389352980966846');" onmouseout="out('-4710389352980966846');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 601                             updateStatement,                                                             </span>
<span class="4668718668329814914" onmouseenter="enter('4668718668329814914');" onmouseout="out('4668718668329814914');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 602                             JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes),                    </span>
<span class="-7576027683765873339" onmouseenter="enter('-7576027683765873339');" onmouseout="out('-7576027683765873339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 603                             row,                                                                         </span>
<span class="-255277236311302851" onmouseenter="enter('-255277236311302851');" onmouseout="out('-255277236311302851');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 604                             primaryKeys.stream().mapToInt(fieldNames::indexOf).toArray()                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 605                     );                                                                                   </span>
<span class="-4238050377414791796" onmouseenter="enter('-4238050377414791796');" onmouseout="out('-4238050377414791796');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 606                     updateStatement.addBatch();                                                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 607                 } catch (Exception e) {                                                                  </span>
<span class="5068376771892501659" onmouseenter="enter('5068376771892501659');" onmouseout="out('5068376771892501659');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 608                     throw new RuntimeException(&quot;impala jdbc execute batch error!&quot;, e);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 609                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 610             });                                                                                          </span>
<span class="-3747739502872154032" onmouseenter="enter('-3747739502872154032');" onmouseout="out('-3747739502872154032');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 611             updateStatement.executeBatch();                                                              </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 612             connection.commit();                                                                         </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 613             rows.clear();                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 614         } catch (Exception e) {                                                                          </span>
<span class="1715728751446881781" onmouseenter="enter('1715728751446881781');" onmouseout="out('1715728751446881781');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615             LOG.debug(&quot;impala jdbc execute batch error &quot;, e);                                            </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616             connection.rollback();                                                                       </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617             connection.commit();                                                                         </span>
<span class="-4187732730208785389" onmouseenter="enter('-4187732730208785389');" onmouseout="out('-4187732730208785389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 618             updateStatement.clearBatch();                                                                </span>
<span class="-8814080953460465644" onmouseenter="enter('-8814080953460465644');" onmouseout="out('-8814080953460465644');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619             executeUpdate(connection);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 620         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 621     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 622                                                                                                          </span>
<span class="-4847686400566224446" onmouseenter="enter('-4847686400566224446');" onmouseout="out('-4847686400566224446');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 623     public void executeUpdate(Connection connection) {                                                   </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 624         rows.forEach(row -&gt; {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 625             try {                                                                                        </span>
<span class="3018395377218617369" onmouseenter="enter('3018395377218617369');" onmouseout="out('3018395377218617369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 626                 setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes), row);"> 626                 setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldT🔵</abbr></span>
<span class="-6547782628025070914" onmouseenter="enter('-6547782628025070914');" onmouseout="out('-6547782628025070914');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 627                 updateStatement.executeUpdate();                                                         </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628                 connection.commit();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629             } catch (Exception e) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630                 try {                                                                                    </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631                     connection.rollback();                                                               </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632                     connection.commit();                                                                 </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 633                 } catch (SQLException e1) {                                                              </span>
<span class="-2635323073569974258" onmouseenter="enter('-2635323073569974258');" onmouseout="out('-2635323073569974258');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634                     throw new RuntimeException(e1);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635                 }                                                                                        </span>
<span class="-4808081927273297919" onmouseenter="enter('-4808081927273297919');" onmouseout="out('-4808081927273297919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 636                 if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {"> 636                 if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LO🔵</abbr></span>
<span class="-2764908242367356599" onmouseenter="enter('-2764908242367356599');" onmouseout="out('-2764908242367356599');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637                     LOG.error(&quot;record insert failed ,this row is {}&quot;, row.toString());                   </span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638                     LOG.error(&quot;&quot;, e);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639                 }                                                                                        </span>
<span class="-8596285303698617705" onmouseenter="enter('-8596285303698617705');" onmouseout="out('-8596285303698617705');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640                 metricOutputFormat.outDirtyRecords.inc();                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642         });                                                                                              </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643         rows.clear();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645                                                                                                          </span>
<span class="5541545914698662583" onmouseenter="enter('5541545914698662583');" onmouseout="out('5541545914698662583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 646     private void putRowIntoMap(Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap, Tuple2&lt;String, String&gt; rowData) {"> 646     private void putRowIntoMap(Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap, Tuple2&lt;String, String&gt; rowData)🔵</abbr></span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647         Set&lt;String&gt; keySet = rowDataMap.keySet();                                                        </span>
<span class="-4115511162008757651" onmouseenter="enter('-4115511162008757651');" onmouseout="out('-4115511162008757651');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648         ArrayList&lt;String&gt; tempRowArray;                                                                  </span>
<span class="-6312285345137005178" onmouseenter="enter('-6312285345137005178');" onmouseout="out('-6312285345137005178');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649         if (keySet.contains(rowData.f0)) {                                                               </span>
<span class="2063657660163215007" onmouseenter="enter('2063657660163215007');" onmouseout="out('2063657660163215007');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650             tempRowArray = rowDataMap.get(rowData.f0);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651         } else {                                                                                         </span>
<span class="7109917545131433172" onmouseenter="enter('7109917545131433172');" onmouseout="out('7109917545131433172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652             tempRowArray = new ArrayList&lt;&gt;();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 653         }                                                                                                </span>
<span class="1467529594977533778" onmouseenter="enter('1467529594977533778');" onmouseout="out('1467529594977533778');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 654         tempRowArray.add(rowData.f1);                                                                    </span>
<span class="6767865840186405987" onmouseenter="enter('6767865840186405987');" onmouseout="out('6767865840186405987');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655         rowDataMap.put(rowData.f0, tempRowArray);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657                                                                                                          </span>
<span class="3578278218776325408" onmouseenter="enter('3578278218776325408');" onmouseout="out('3578278218776325408');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 658     private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPartitionFields, List&lt;String&gt; fieldTypes, String partitionFields) {"> 658     private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPart🔵</abbr></span>
<span class="-9170183165643435780" onmouseenter="enter('-9170183165643435780');" onmouseout="out('-9170183165643435780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 659         if (partitionFields.isEmpty()) {                                                                 </span>
<span class="2916035488958294792" onmouseenter="enter('2916035488958294792');" onmouseout="out('2916035488958294792');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 660             return fieldNames;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 662                                                                                                          </span>
<span class="7990418778069769767" onmouseenter="enter('7990418778069769767');" onmouseout="out('7990418778069769767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663         List&lt;String&gt; valueFields = new ArrayList&lt;&gt;(fieldNames);                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 664                                                                                                          </span>
<span class="2302239674432319726" onmouseenter="enter('2302239674432319726');" onmouseout="out('2302239674432319726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665         for (int i = valueFields.size() - 1; i &gt;= 0; i--) {                                              </span>
<span class="-8004931019804249555" onmouseenter="enter('-8004931019804249555');" onmouseout="out('-8004931019804249555');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666             if (staticPartitionFields.contains(fieldNames.get(i))) {                                     </span>
<span class="-3872161480019783193" onmouseenter="enter('-3872161480019783193');" onmouseout="out('-3872161480019783193');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667                 valueFields.remove(i);                                                                   </span>
<span class="5504621354582269117" onmouseenter="enter('5504621354582269117');" onmouseout="out('5504621354582269117');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668                 fieldTypes.remove(i);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671                                                                                                          </span>
<span class="8724369392835521335" onmouseenter="enter('8724369392835521335');" onmouseout="out('8724369392835521335');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672         for (int i = 0; i &lt; valueFields.size(); i++) {                                                   </span>
<span class="4573573241123850638" onmouseenter="enter('4573573241123850638');" onmouseout="out('4573573241123850638');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673             if (partitionFields.contains(fieldNames.get(i))) {                                           </span>
<span class="-6733214010943616061" onmouseenter="enter('-6733214010943616061');" onmouseout="out('-6733214010943616061');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 674                 valueFields.add(valueFields.remove(i));                                                  </span>
<span class="3100686975272655596" onmouseenter="enter('3100686975272655596');" onmouseout="out('3100686975272655596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675                 fieldTypes.add(fieldTypes.remove(i));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 678                                                                                                          </span>
<span class="-4055330890426471630" onmouseenter="enter('-4055330890426471630');" onmouseout="out('-4055330890426471630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679         return valueFields;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 682     /**                                                                                                  </span>
<span class="-8974785826875952090" onmouseenter="enter('-8974785826875952090');" onmouseout="out('-8974785826875952090');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 683      * Quote a specific type of value, like string, timestamp                                            </span>
<span class="-6015231753011783708" onmouseenter="enter('-6015231753011783708');" onmouseout="out('-6015231753011783708');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 684      * before: 1, cast(tiezhu as string), cast(2001-01-09 01:05:01 as timestamp), cast(123 as int)       </span>
<span class="-9072843877687738552" onmouseenter="enter('-9072843877687738552');" onmouseout="out('-9072843877687738552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 685      * after: 1, cast(&#x27;tiezhu&#x27; as string), cast(&#x27;2001-01-09 01:05:01&#x27; as timestamp), cast(123 as int)    </span>
<span class="1334750812652161584" onmouseenter="enter('1334750812652161584');" onmouseout="out('1334750812652161584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 686      * if cast value is null, then cast(null as type)                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 687      *                                                                                                   </span>
<span class="-7193371921927395943" onmouseenter="enter('-7193371921927395943');" onmouseout="out('-7193371921927395943');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 688      * @param valueCondition original value condition                                                    </span>
<span class="-4015247136226058388" onmouseenter="enter('-4015247136226058388');" onmouseout="out('-4015247136226058388');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 689      * @return quoted condition                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690      */                                                                                                  </span>
<span class="-8514684189215878898" onmouseenter="enter('-8514684189215878898');" onmouseout="out('-8514684189215878898');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 691     private String valueConditionAddQuotation(String valueCondition) {                                   </span>
<span class="-7296893889335175056" onmouseenter="enter('-7296893889335175056');" onmouseout="out('-7296893889335175056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692         String[] temps = valueCondition.split(&quot;,&quot;);                                                      </span>
<span class="936116613567496626" onmouseenter="enter('936116613567496626');" onmouseout="out('936116613567496626');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693         List&lt;String&gt; replacedItem = new ArrayList&lt;&gt;();                                                   </span>
<span class="-3322970786555187036" onmouseenter="enter('-3322970786555187036');" onmouseout="out('-3322970786555187036');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 694         Arrays.stream(temps).forEach(                                                                    </span>
<span class="4635365489417489024" onmouseenter="enter('4635365489417489024');" onmouseout="out('4635365489417489024');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 695                 item -&gt; {                                                                                </span>
<span class="-4536988729093203149" onmouseenter="enter('-4536988729093203149');" onmouseout="out('-4536988729093203149');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 696                     Matcher matcher = TYPE_PATTERN.matcher(item);                                        </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 697                     while (matcher.find()) {                                                             </span>
<span class="4482463139402405127" onmouseenter="enter('4482463139402405127');" onmouseout="out('4482463139402405127');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698                         String value = matcher.group(1);                                                 </span>
<span class="-7401464861945434758" onmouseenter="enter('-7401464861945434758');" onmouseout="out('-7401464861945434758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 699                         String type = matcher.group(2);                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                                                                                                          </span>
<span class="173086077329077799" onmouseenter="enter('173086077329077799');" onmouseout="out('173086077329077799');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701                         for (String needQuoteType : NEED_QUOTE_TYPE) {                                   </span>
<span class="-6207157170096749111" onmouseenter="enter('-6207157170096749111');" onmouseout="out('-6207157170096749111');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 702                             if (type.contains(needQuoteType)) {                                          </span>
<span class="8347227757103419143" onmouseenter="enter('8347227757103419143');" onmouseout="out('8347227757103419143');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703                                 if (!&quot;null&quot;.equals(value)) {                                             </span>
<span class="-4537434762580953169" onmouseenter="enter('-4537434762580953169');" onmouseout="out('-4537434762580953169');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704                                     item = item.replace(value, &quot;&#x27;&quot; + value + &quot;&#x27;&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 706                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708                     }                                                                                    </span>
<span class="8193346150481678438" onmouseenter="enter('8193346150481678438');" onmouseout="out('8193346150481678438');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709                     replacedItem.add(item);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710                 }                                                                                        </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711         );                                                                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712                                                                                                          </span>
<span class="7763750891527797776" onmouseenter="enter('7763750891527797776');" onmouseout="out('7763750891527797776');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713         return &quot;(&quot; + String.join(&quot;, &quot;, replacedItem) + &quot;)&quot;;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716     @Override                                                                                            </span>
<span class="-8766503565464123288" onmouseenter="enter('-8766503565464123288');" onmouseout="out('-8766503565464123288');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717     public void writeRecord(Tuple2&lt;Boolean, Row&gt; record) throws IOException {                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718         try {                                                                                            </span>
<span class="-1438543337409690372" onmouseenter="enter('-1438543337409690372');" onmouseout="out('-1438543337409690372');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 719             if (!record.f0) {                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722                                                                                                          </span>
<span class="-8847095116449263406" onmouseenter="enter('-8847095116449263406');" onmouseout="out('-8847095116449263406');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 723             if (outRecords.getCount() % RECEIVE_DATA_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {     </span>
<span class="867853870420543335" onmouseenter="enter('867853870420543335');" onmouseout="out('867853870420543335');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724                 LOG.info(&quot;Receive data : {}&quot;, record);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726                                                                                                          </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727             if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                              </span>
<span class="-4538110507205524162" onmouseenter="enter('-4538110507205524162');" onmouseout="out('-4538110507205524162');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 728                 rows.add(Row.copy(record.f1));                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729             } else {                                                                                     </span>
<span class="-7917205410914838057" onmouseenter="enter('-7917205410914838057');" onmouseout="out('-7917205410914838057');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                 Map&lt;String, Object&gt; valueMap = Maps.newHashMap();                                        </span>
<span class="1869446492779313508" onmouseenter="enter('1869446492779313508');" onmouseout="out('1869446492779313508');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731                 Row row = Row.copy(record.f1);                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732                                                                                                          </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733                 for (int i = 0; i &lt; row.getArity(); i++) {                                               </span>
<span class="5876572039273015428" onmouseenter="enter('5876572039273015428');" onmouseout="out('5876572039273015428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734                     valueMap.put(fieldNames.get(i), row.getField(i));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 735                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 736                                                                                                          </span>
<span class="-991390362203857814" onmouseenter="enter('-991390362203857814');" onmouseout="out('-991390362203857814');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 737                 Tuple2&lt;String, String&gt; rowTuple2 = new Tuple2&lt;&gt;();                                       </span>
<span class="-209542121488547867" onmouseenter="enter('-209542121488547867');" onmouseout="out('-209542121488547867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 738                 if (storeType.equalsIgnoreCase(KUDU_TYPE) || !enablePartition) {                         </span>
<span class="-4830782679838689768" onmouseenter="enter('-4830782679838689768');" onmouseout="out('-4830782679838689768');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 739                     rowTuple2.f0 = NO_PARTITION;                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 740                 } else {                                                                                 </span>
<span class="5139395380358692168" onmouseenter="enter('5139395380358692168');" onmouseout="out('5139395380358692168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 741                     rowTuple2.f0 = buildPartitionCondition(valueMap, partitionFields, staticPartitionFields);"> 741                     rowTuple2.f0 = buildPartitionCondition(valueMap, partitionFields, staticPartitionFiel🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743                                                                                                          </span>
<span class="-484968884065413564" onmouseenter="enter('-484968884065413564');" onmouseout="out('-484968884065413564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 744                 // 根据字段名对 row data 重组, 比如，原始 row data : (1, xxx, 20) -&gt; (id, name, age)                  </span>
<span class="2038150889857603205" onmouseenter="enter('2038150889857603205');" onmouseout="out('2038150889857603205');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 745                 // 但是由于 partition，写入的field 顺序变成了 (name, id, age)，则需要对 row data 重组变成 (xxx, 1, 20)         </span>
<span class="5421203580895226953" onmouseenter="enter('5421203580895226953');" onmouseout="out('5421203580895226953');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 746                 Row rowValue = new Row(fieldTypes.size());                                               </span>
<span class="-7699243670258396145" onmouseenter="enter('-7699243670258396145');" onmouseout="out('-7699243670258396145');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 747                 for (int i = 0; i &lt; fieldTypes.size(); i++) {                                            </span>
<span class="2312799749991659832" onmouseenter="enter('2312799749991659832');" onmouseout="out('2312799749991659832');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 748                     rowValue.setField(i, valueMap.get(valueFieldNames.get(i)));                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 749                 }                                                                                        </span>
<span class="8595450652771675183" onmouseenter="enter('8595450652771675183');" onmouseout="out('8595450652771675183');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 750                 rowTuple2.f1 = valueConditionAddQuotation(buildValuesCondition(fieldTypes, rowValue));   </span>
<span class="8896132355788887171" onmouseenter="enter('8896132355788887171');" onmouseout="out('8896132355788887171');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 751                 putRowIntoMap(rowDataMap, rowTuple2);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 752             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 753                                                                                                          </span>
<span class="-1784546571648451896" onmouseenter="enter('-1784546571648451896');" onmouseout="out('-1784546571648451896');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 754             batchCount++;                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 755                                                                                                          </span>
<span class="2059038061408804342" onmouseenter="enter('2059038061408804342');" onmouseout="out('2059038061408804342');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 756             if (batchCount &gt;= batchSize) {                                                               </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 757                 flush();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 758             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 759                                                                                                          </span>
<span class="-2147939016446724954" onmouseenter="enter('-2147939016446724954');" onmouseout="out('-2147939016446724954');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 760             // Receive data                                                                              </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 761             outRecords.inc();                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 762         } catch (Exception e) {                                                                          </span>
<span class="-6314596404725474749" onmouseenter="enter('-6314596404725474749');" onmouseout="out('-6314596404725474749');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 763             throw new IOException(&quot;Writing records to impala failed.&quot;, e);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 764         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 765     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 766                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 767     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 768     public void close() throws IOException {                                                             </span>
<span class="6765329276469905715" onmouseenter="enter('6765329276469905715');" onmouseout="out('6765329276469905715');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 769         if (closed) {                                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 770             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 771         }                                                                                                </span>
<span class="-8247099019020917877" onmouseenter="enter('-8247099019020917877');" onmouseout="out('-8247099019020917877');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 772         // 将还未执行的SQL flush                                                                               </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 773         if (batchCount &gt; 0) {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 774             try {                                                                                        </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 775                 flush();                                                                                 </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 776             } catch (Exception e) {                                                                      </span>
<span class="1679153721811128255" onmouseenter="enter('1679153721811128255');" onmouseout="out('1679153721811128255');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 777                 throw new RuntimeException(&quot;Writing records to impala failed.&quot;, e);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 778             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 779         }                                                                                                </span>
<span class="4306800238416480323" onmouseenter="enter('4306800238416480323');" onmouseout="out('4306800238416480323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 780         // cancel scheduled task                                                                         </span>
<span class="-1257031862697527304" onmouseenter="enter('-1257031862697527304');" onmouseout="out('-1257031862697527304');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 781         if (this.scheduledFuture != null) {                                                              </span>
<span class="-290660898949228596" onmouseenter="enter('-290660898949228596');" onmouseout="out('-290660898949228596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 782             scheduledFuture.cancel(false);                                                               </span>
<span class="-3367227577965762682" onmouseenter="enter('-3367227577965762682');" onmouseout="out('-3367227577965762682');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 783             this.scheduler.shutdown();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 784         }                                                                                                </span>
<span class="-6918026600162299955" onmouseenter="enter('-6918026600162299955');" onmouseout="out('-6918026600162299955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 785         // close connection                                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 786         try {                                                                                            </span>
<span class="7850482504012729998" onmouseenter="enter('7850482504012729998');" onmouseout="out('7850482504012729998');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 787             if (connection != null &amp;&amp; connection.isValid(DEFAULT_CONN_TIME_OUT)) {                       </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 788                 connection.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 789             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 790                                                                                                          </span>
<span class="5036557091369948437" onmouseenter="enter('5036557091369948437');" onmouseout="out('5036557091369948437');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 791             if (statement != null &amp;&amp; !statement.isClosed()) {                                            </span>
<span class="-4290000005499431342" onmouseenter="enter('-4290000005499431342');" onmouseout="out('-4290000005499431342');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 792                 statement.close();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 793             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 794                                                                                                          </span>
<span class="-3745862640690712208" onmouseenter="enter('-3745862640690712208');" onmouseout="out('-3745862640690712208');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 795             if (updateStatement != null &amp;&amp; !updateStatement.isClosed()) {                                </span>
<span class="6285223499122042502" onmouseenter="enter('6285223499122042502');" onmouseout="out('6285223499122042502');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 796                 updateStatement.close();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 797             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 798         } catch (SQLException e) {                                                                       </span>
<span class="-8800633426745397107" onmouseenter="enter('-8800633426745397107');" onmouseout="out('-8800633426745397107');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 799             throw new RuntimeException(&quot;impala connection close failed!&quot;, e);                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 800         } finally {                                                                                      </span>
<span class="8335594207613379924" onmouseenter="enter('8335594207613379924');" onmouseout="out('8335594207613379924');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 801             connection = null;                                                                           </span>
<span class="-8855760725718402841" onmouseenter="enter('-8855760725718402841');" onmouseout="out('-8855760725718402841');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 802             statement = null;                                                                            </span>
<span class="-7841270215011717932" onmouseenter="enter('-7841270215011717932');" onmouseout="out('-7841270215011717932');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 803             updateStatement = null;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 804         }                                                                                                </span>
<span class="5606214304023690467" onmouseenter="enter('5606214304023690467');" onmouseout="out('5606214304023690467');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 805         closed = true;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 806     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 807                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 808     /**                                                                                                  </span>
<span class="1296337810927918625" onmouseenter="enter('1296337810927918625');" onmouseout="out('1296337810927918625');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 809      * execute batch sql from row data map                                                               </span>
<span class="-5974232274386764846" onmouseenter="enter('-5974232274386764846');" onmouseout="out('-5974232274386764846');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 810      * sql like &#x27;insert into tableName(f1, f2, f3) ${partitionCondition} values(v1, v2, v3), (v4, v5, v6)...."> 810      * sql like &#x27;insert into tableName(f1, f2, f3) ${partitionCondition} values(v1, v2, v3), (v4, v5, v6)🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 811      *                                                                                                   </span>
<span class="3064025681804756869" onmouseenter="enter('3064025681804756869');" onmouseout="out('3064025681804756869');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 812      * @param statement       execute statement                                                          </span>
<span class="4252025712922498493" onmouseenter="enter('4252025712922498493');" onmouseout="out('4252025712922498493');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 813      * @param tempSql         template sql                                                               </span>
<span class="-888616451537648959" onmouseenter="enter('-888616451537648959');" onmouseout="out('-888616451537648959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 814      * @param storeType       the store type of data                                                     </span>
<span class="-5301096736775778703" onmouseenter="enter('-5301096736775778703');" onmouseout="out('-5301096736775778703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 815      * @param enablePartition enable partition or not                                                    </span>
<span class="-7243431631208061298" onmouseenter="enter('-7243431631208061298');" onmouseout="out('-7243431631208061298');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 816      * @param fieldNames      field name list                                                            </span>
<span class="991482749163976330" onmouseenter="enter('991482749163976330');" onmouseout="out('991482749163976330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 817      * @param partitionFields partition fields                                                           </span>
<span class="5552251290683891506" onmouseenter="enter('5552251290683891506');" onmouseout="out('5552251290683891506');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 818      * @param rowDataMap      row data map                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 819      */                                                                                                  </span>
<span class="4208908199550530657" onmouseenter="enter('4208908199550530657');" onmouseout="out('4208908199550530657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 820     private void executeBatchSql(Statement statement,                                                    </span>
<span class="2680326069917862152" onmouseenter="enter('2680326069917862152');" onmouseout="out('2680326069917862152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 821                                  String tempSql,                                                         </span>
<span class="-1880214364205558871" onmouseenter="enter('-1880214364205558871');" onmouseout="out('-1880214364205558871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 822                                  String schema,                                                          </span>
<span class="6859219661302664351" onmouseenter="enter('6859219661302664351');" onmouseout="out('6859219661302664351');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 823                                  String tableName,                                                       </span>
<span class="3305030788069730493" onmouseenter="enter('3305030788069730493');" onmouseout="out('3305030788069730493');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 824                                  String storeType,                                                       </span>
<span class="3282308130032253418" onmouseenter="enter('3282308130032253418');" onmouseout="out('3282308130032253418');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 825                                  Boolean enablePartition,                                                </span>
<span class="-3269341593111050509" onmouseenter="enter('-3269341593111050509');" onmouseout="out('-3269341593111050509');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 826                                  List&lt;String&gt; fieldNames,                                                </span>
<span class="-152366337684528954" onmouseenter="enter('-152366337684528954');" onmouseout="out('-152366337684528954');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 827                                  String partitionFields,                                                 </span>
<span class="5702355489208114022" onmouseenter="enter('5702355489208114022');" onmouseout="out('5702355489208114022');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 828                                  Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap) {                            </span>
<span class="-8058960308042609674" onmouseenter="enter('-8058960308042609674');" onmouseout="out('-8058960308042609674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 829         StringBuilder valuesCondition = new StringBuilder();                                             </span>
<span class="-1699639020719600437" onmouseenter="enter('-1699639020719600437');" onmouseout="out('-1699639020719600437');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 830         StringBuilder partitionCondition = new StringBuilder();                                          </span>
<span class="4484344279813579809" onmouseenter="enter('4484344279813579809');" onmouseout="out('4484344279813579809');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 831         String tableFieldsCondition = buildTableFieldsCondition(fieldNames, partitionFields);            </span>
<span class="-2056467323596282224" onmouseenter="enter('-2056467323596282224');" onmouseout="out('-2056467323596282224');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 832         ArrayList&lt;String&gt; rowData;                                                                       </span>
<span class="3545700907988930339" onmouseenter="enter('3545700907988930339');" onmouseout="out('3545700907988930339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 833         String tableNameInfo = Objects.isNull(schema) ?                                                  </span>
<span class="1480493120427294696" onmouseenter="enter('1480493120427294696');" onmouseout="out('1480493120427294696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 834                 tableName : quoteIdentifier(schema) + &quot;.&quot; + tableName;                                   </span>
<span class="-7586945217349428495" onmouseenter="enter('-7586945217349428495');" onmouseout="out('-7586945217349428495');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 835         tempSql = tempSql.replace(&quot;tableName&quot;, tableNameInfo);                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 836                                                                                                          </span>
<span class="-739313269293547881" onmouseenter="enter('-739313269293547881');" onmouseout="out('-739313269293547881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 837         // kudu ${partitionCondition} is null                                                            </span>
<span class="-209542121488547867" onmouseenter="enter('-209542121488547867');" onmouseout="out('-209542121488547867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 838         if (storeType.equalsIgnoreCase(KUDU_TYPE) || !enablePartition) {                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 839             try {                                                                                        </span>
<span class="-2154584329942843601" onmouseenter="enter('-2154584329942843601');" onmouseout="out('-2154584329942843601');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 840                 rowData = rowDataMap.get(NO_PARTITION);                                                  </span>
<span class="8347805769565999916" onmouseenter="enter('8347805769565999916');" onmouseout="out('8347805769565999916');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 841                 rowData.forEach(row -&gt; valuesCondition.append(row).append(&quot;, &quot;));                        </span>
<span class="3083642816500849348" onmouseenter="enter('3083642816500849348');" onmouseout="out('3083642816500849348');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 842                 String executeSql = tempSql.replace(VALUES_CONDITION, valuesCondition.toString())        </span>
<span class="1750592158576848918" onmouseenter="enter('1750592158576848918');" onmouseout="out('1750592158576848918');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 843                         .replace(PARTITION_CONDITION, partitionCondition.toString())                     </span>
<span class="1939264830691633930" onmouseenter="enter('1939264830691633930');" onmouseout="out('1939264830691633930');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 844                         .replace(PARTITION_CONSTANT, &quot;&quot;)                                                 </span>
<span class="808490930961205524" onmouseenter="enter('808490930961205524');" onmouseout="out('808490930961205524');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 845                         .replace(TABLE_FIELDS_CONDITION, tableFieldsCondition);                          </span>
<span class="8541330001607166782" onmouseenter="enter('8541330001607166782');" onmouseout="out('8541330001607166782');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 846                 String substring = executeSql.substring(0, executeSql.length() - 2);                     </span>
<span class="9213214884061660178" onmouseenter="enter('9213214884061660178');" onmouseout="out('9213214884061660178');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 847                 statement.execute(substring);                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 848             } catch (Exception e) {                                                                      </span>
<span class="7699356527811265570" onmouseenter="enter('7699356527811265570');" onmouseout="out('7699356527811265570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 849                 throw new RuntimeException(&quot;execute impala SQL error!&quot;, e);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 850             }                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 851             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 852         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 853                                                                                                          </span>
<span class="6613720697354939567" onmouseenter="enter('6613720697354939567');" onmouseout="out('6613720697354939567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 854         // partition sql                                                                                 </span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 855         Set&lt;String&gt; keySet = rowDataMap.keySet();                                                        </span>
<span class="6439574290523368417" onmouseenter="enter('6439574290523368417');" onmouseout="out('6439574290523368417');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 856         String finalTempSql = tempSql;                                                                   </span>
<span class="5286500476222551862" onmouseenter="enter('5286500476222551862');" onmouseout="out('5286500476222551862');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 857         for (String key : keySet) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 858             try {                                                                                        </span>
<span class="-8214047348876131469" onmouseenter="enter('-8214047348876131469');" onmouseout="out('-8214047348876131469');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 859                 String executeSql = String.copyValueOf(finalTempSql.toCharArray());                      </span>
<span class="225939304905434763" onmouseenter="enter('225939304905434763');" onmouseout="out('225939304905434763');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 860                 ArrayList&lt;String&gt; valuesConditionList = rowDataMap.get(key);                             </span>
<span class="3266960038838022824" onmouseenter="enter('3266960038838022824');" onmouseout="out('3266960038838022824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 861                 partitionCondition.append(key);                                                          </span>
<span class="7273478521762013154" onmouseenter="enter('7273478521762013154');" onmouseout="out('7273478521762013154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 862                 executeSql = executeSql.replace(PARTITION_CONDITION, partitionCondition.toString())      </span>
<span class="7623710745634070513" onmouseenter="enter('7623710745634070513');" onmouseout="out('7623710745634070513');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 863                         .replace(TABLE_FIELDS_CONDITION, tableFieldsCondition)                           </span>
<span class="6339876343455538281" onmouseenter="enter('6339876343455538281');" onmouseout="out('6339876343455538281');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 864                         .replace(VALUES_CONDITION, String.join(&quot;, &quot;, valuesConditionList));              </span>
<span class="7589788358669612006" onmouseenter="enter('7589788358669612006');" onmouseout="out('7589788358669612006');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 865                 statement.execute(executeSql);                                                           </span>
<span class="-3000902343706299075" onmouseenter="enter('-3000902343706299075');" onmouseout="out('-3000902343706299075');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 866                 partitionCondition.delete(0, partitionCondition.length());                               </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 867             } catch (SQLException sqlException) {                                                        </span>
<span class="-5222513116835107038" onmouseenter="enter('-5222513116835107038');" onmouseout="out('-5222513116835107038');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 868                 throw new RuntimeException(&quot;execute impala SQL error! &quot;, sqlException);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 869             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 870         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 871     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 872                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 873     /**                                                                                                  </span>
<span class="-7756927092547658158" onmouseenter="enter('-7756927092547658158');" onmouseout="out('-7756927092547658158');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 874      * build partition condition with row data                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 875      *                                                                                                   </span>
<span class="3326420447531983720" onmouseenter="enter('3326420447531983720');" onmouseout="out('3326420447531983720');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 876      * @param rowData              row data                                                              </span>
<span class="-4527404320823727170" onmouseenter="enter('-4527404320823727170');" onmouseout="out('-4527404320823727170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 877      * @param partitionFields      partition fields                                                      </span>
<span class="-1776173940247734574" onmouseenter="enter('-1776173940247734574');" onmouseout="out('-1776173940247734574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 878      * @param staticPartitionField static partition fields                                               </span>
<span class="-1132708759906563110" onmouseenter="enter('-1132708759906563110');" onmouseout="out('-1132708759906563110');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 879      * @return condition like &#x27;(ptOne, ptTwo=v2)&#x27;                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 880      */                                                                                                  </span>
<span class="-3866187778893382496" onmouseenter="enter('-3866187778893382496');" onmouseout="out('-3866187778893382496');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 881     private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;String&gt; staticPartitionField) {"> 881     private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;Stri🔵</abbr></span>
<span class="1267423885187171547" onmouseenter="enter('1267423885187171547');" onmouseout="out('1267423885187171547');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 882         for (String key : staticPartitionField) {                                                        </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 883             StringBuilder sb = new StringBuilder();                                                      </span>
<span class="-5505398468694975344" onmouseenter="enter('-5505398468694975344');" onmouseout="out('-5505398468694975344');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 884             Object value = rowData.get(key);                                                             </span>
<span class="-3546349567435071552" onmouseenter="enter('-3546349567435071552');" onmouseout="out('-3546349567435071552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 885             sb.append(key).append(&quot;=&quot;).append(value);                                                    </span>
<span class="7571464430142538701" onmouseenter="enter('7571464430142538701');" onmouseout="out('7571464430142538701');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 886             partitionFields = partitionFields.replace(&quot;${&quot; + key + &quot;}&quot;, sb.toString());                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 887         }                                                                                                </span>
<span class="-6125585623196674116" onmouseenter="enter('-6125585623196674116');" onmouseout="out('-6125585623196674116');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 888         return &quot;(&quot; + partitionFields + &quot;)&quot;;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 889     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 890                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 891     /**                                                                                                  </span>
<span class="1604816269765986224" onmouseenter="enter('1604816269765986224');" onmouseout="out('1604816269765986224');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 892      * build field condition according to field names                                                    </span>
<span class="-8005762898157210848" onmouseenter="enter('-8005762898157210848');" onmouseout="out('-8005762898157210848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 893      * replace ${tableFieldCondition}                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 894      *                                                                                                   </span>
<span class="-3045974832751459167" onmouseenter="enter('-3045974832751459167');" onmouseout="out('-3045974832751459167');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 895      * @param fieldNames      the selected field names                                                   </span>
<span class="-2115580236801058408" onmouseenter="enter('-2115580236801058408');" onmouseout="out('-2115580236801058408');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 896      * @param partitionFields the partition fields                                                       </span>
<span class="-2587093228749928778" onmouseenter="enter('-2587093228749928778');" onmouseout="out('-2587093228749928778');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 897      * @return condition like &#x27;(id, name, age)&#x27;                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 898      */                                                                                                  </span>
<span class="-1478951256156574678" onmouseenter="enter('-1478951256156574678');" onmouseout="out('-1478951256156574678');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 899     private String buildTableFieldsCondition(List&lt;String&gt; fieldNames, String partitionFields) {          </span>
<span class="-8730756422155226372" onmouseenter="enter('-8730756422155226372');" onmouseout="out('-8730756422155226372');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 900         return &quot;(&quot; + fieldNames.stream()                                                                 </span>
<span class="-1124201215121024792" onmouseenter="enter('-1124201215121024792');" onmouseout="out('-1124201215121024792');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 901                 .filter(f -&gt; !partitionFields.contains(f))                                               </span>
<span class="4761076759122573536" onmouseenter="enter('4761076759122573536');" onmouseout="out('4761076759122573536');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 902                 .map(this::quoteIdentifier)                                                              </span>
<span class="-1385468130735042246" onmouseenter="enter('-1385468130735042246');" onmouseout="out('-1385468130735042246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 903                 .collect(Collectors.joining(&quot;, &quot;)) + &quot;)&quot;;                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 904     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 905                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 906     /**                                                                                                  </span>
<span class="-1930125657620201419" onmouseenter="enter('-1930125657620201419');" onmouseout="out('-1930125657620201419');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 907      * according to field types, build the values condition                                              </span>
<span class="-5328431915012470826" onmouseenter="enter('-5328431915012470826');" onmouseout="out('-5328431915012470826');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 908      * replace ${valuesCondition}                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 909      *                                                                                                   </span>
<span class="889997534505017973" onmouseenter="enter('889997534505017973');" onmouseout="out('889997534505017973');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 910      * @param fieldTypes field types                                                                     </span>
<span class="-5792744344160442542" onmouseenter="enter('-5792744344160442542');" onmouseout="out('-5792744344160442542');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 911      * @return condition like &#x27;(?, ?, cast(? as string))&#x27; and &#x27;?&#x27; will be replaced with row data         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 912      */                                                                                                  </span>
<span class="-8753268388884688793" onmouseenter="enter('-8753268388884688793');" onmouseout="out('-8753268388884688793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 913     private String buildValuesCondition(List&lt;String&gt; fieldTypes, Row row) {                              </span>
<span class="9451785702271217" onmouseenter="enter('9451785702271217');" onmouseout="out('9451785702271217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 914         String valuesCondition = fieldTypes.stream().map(                                                </span>
<span class="-744834501831992668" onmouseenter="enter('-744834501831992668');" onmouseout="out('-744834501831992668');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 915                 f -&gt; {                                                                                   </span>
<span class="9071647551805886291" onmouseenter="enter('9071647551805886291');" onmouseout="out('9071647551805886291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 916                     for (String item : NEED_QUOTE_TYPE) {                                                </span>
<span class="9108011392601680881" onmouseenter="enter('9108011392601680881');" onmouseout="out('9108011392601680881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 917                         if (f.toLowerCase().contains(item)) {                                            </span>
<span class="-8315565477038260180" onmouseenter="enter('-8315565477038260180');" onmouseout="out('-8315565477038260180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 918                             return String.format(&quot;cast(? as %s)&quot;, f.toLowerCase());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 919                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 920                     }                                                                                    </span>
<span class="6027958975032523467" onmouseenter="enter('6027958975032523467');" onmouseout="out('6027958975032523467');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 921                     return &quot;?&quot;;                                                                          </span>
<span class="4654177507103038656" onmouseenter="enter('4654177507103038656');" onmouseout="out('4654177507103038656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 922                 }).collect(Collectors.joining(&quot;, &quot;));                                                    </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 923         for (int i = 0; i &lt; row.getArity(); i++) {                                                       </span>
<span class="2602556020493426404" onmouseenter="enter('2602556020493426404');" onmouseout="out('2602556020493426404');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 924             valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null&quot; : row.getField(i).toString());"> 924             valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 925         }                                                                                                </span>
<span class="6366685022999215739" onmouseenter="enter('6366685022999215739');" onmouseout="out('6366685022999215739');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 926         return valuesCondition;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 927     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 928                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 929     /**                                                                                                  </span>
<span class="2218542669560141576" onmouseenter="enter('2218542669560141576');" onmouseout="out('2218542669560141576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 930      * impala update mode SQL                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 931      *                                                                                                   </span>
<span class="-8218292189476554358" onmouseenter="enter('-8218292189476554358');" onmouseout="out('-8218292189476554358');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 932      * @return UPDATE tableName SET setCondition WHERE whereCondition                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 933      */                                                                                                  </span>
<span class="-3752451701752547882" onmouseenter="enter('-3752451701752547882');" onmouseout="out('-3752451701752547882');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 934     private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; primaryKeys) {"> 934     private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; 🔵</abbr></span>
<span class="5528853464056789996" onmouseenter="enter('5528853464056789996');" onmouseout="out('5528853464056789996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 935         //跳过primary key字段                                                                                </span>
<span class="-8857590287628770183" onmouseenter="enter('-8857590287628770183');" onmouseout="out('-8857590287628770183');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 936         String setClause = fieldNames.stream()                                                           </span>
<span class="-803297460241064625" onmouseenter="enter('-803297460241064625');" onmouseout="out('-803297460241064625');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 937                 .filter(f -&gt; !CollectionUtils.isNotEmpty(primaryKeys) || !primaryKeys.contains(f))       </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 938                 .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                     </span>
<span class="-209499088310020597" onmouseenter="enter('-209499088310020597');" onmouseout="out('-209499088310020597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 939                 .collect(Collectors.joining(&quot;, &quot;));                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 940                                                                                                          </span>
<span class="-3669556570443861667" onmouseenter="enter('-3669556570443861667');" onmouseout="out('-3669556570443861667');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 941         String conditionClause = primaryKeys.stream()                                                    </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 942                 .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                     </span>
<span class="1187060376059521362" onmouseenter="enter('1187060376059521362');" onmouseout="out('1187060376059521362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 943                 .collect(Collectors.joining(&quot; AND &quot;));                                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 944                                                                                                          </span>
<span class="-880277003185331688" onmouseenter="enter('-880277003185331688');" onmouseout="out('-880277003185331688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 945         return &quot;UPDATE &quot; + (Objects.isNull(schema) ? &quot;&quot; : quoteIdentifier(schema) + &quot;.&quot;)                 </span>
<span class="-2776062363149844820" onmouseenter="enter('-2776062363149844820');" onmouseout="out('-2776062363149844820');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 946                 + quoteIdentifier(tableName) + &quot; SET &quot; + setClause + &quot; WHERE &quot; + conditionClause;        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 947     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 948                                                                                                          </span>
<span class="4659511982989745103" onmouseenter="enter('4659511982989745103');" onmouseout="out('4659511982989745103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 949     private String quoteIdentifier(String identifier) {                                                  </span>
<span class="1935684454964464658" onmouseenter="enter('1935684454964464658');" onmouseout="out('1935684454964464658');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 950         return &quot;`&quot; + identifier + &quot;`&quot;;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 951     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 952                                                                                                          </span>
<span class="-2481914402933088399" onmouseenter="enter('-2481914402933088399');" onmouseout="out('-2481914402933088399');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 953     public static Builder getImpalaBuilder() {                                                           </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 954 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1926211775479526780" onmouseenter="enter('-1926211775479526780');" onmouseout="out('-1926211775479526780');" style=""> 955         return new Builder();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 956     }                                                                                                    </span>
<span  style=""> 957                                                                                                          </span>
<span class="2010609695383714647" onmouseenter="enter('2010609695383714647');" onmouseout="out('2010609695383714647');" style=""> 958     public static class Builder {                                                                        </span>
<span class="5030308014750517924" onmouseenter="enter('5030308014750517924');" onmouseout="out('5030308014750517924');" style=""> 959         private final ImpalaOutputFormat format = new ImpalaOutputFormat();                              </span>
<span  style=""> 960                                                                                                          </span>
<span class="4847669250945231235" onmouseenter="enter('4847669250945231235');" onmouseout="out('4847669250945231235');" style=""> 961         public Builder setDbUrl(String dbUrl) {                                                          </span>
<span class="-7007213682983262515" onmouseenter="enter('-7007213682983262515');" onmouseout="out('-7007213682983262515');" style=""> 962             format.dbUrl = dbUrl;                                                                        </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 963             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 964         }                                                                                                </span>
<span  style=""> 965                                                                                                          </span>
<span class="-2062625403058053727" onmouseenter="enter('-2062625403058053727');" onmouseout="out('-2062625403058053727');" style=""> 966         public Builder setUserName(String userName) {                                                    </span>
<span class="8996094991043959374" onmouseenter="enter('8996094991043959374');" onmouseout="out('8996094991043959374');" style=""> 967             format.userName = userName;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 968             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 969         }                                                                                                </span>
<span  style=""> 970                                                                                                          </span>
<span class="-8917696572465338538" onmouseenter="enter('-8917696572465338538');" onmouseout="out('-8917696572465338538');" style=""> 971         public Builder setPassword(String password) {                                                    </span>
<span class="-5617852808102302847" onmouseenter="enter('-5617852808102302847');" onmouseout="out('-5617852808102302847');" style=""> 972             format.password = password;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 973             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 974         }                                                                                                </span>
<span  style=""> 975                                                                                                          </span>
<span class="-6851628607924303336" onmouseenter="enter('-6851628607924303336');" onmouseout="out('-6851628607924303336');" style=""> 976         public Builder setBatchSize(Integer batchSize) {                                                 </span>
<span class="-6323290766219617895" onmouseenter="enter('-6323290766219617895');" onmouseout="out('-6323290766219617895');" style=""> 977             format.batchSize = batchSize;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 978             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 979         }                                                                                                </span>
<span  style=""> 980                                                                                                          </span>
<span class="5791410845050671235" onmouseenter="enter('5791410845050671235');" onmouseout="out('5791410845050671235');" style=""> 981         public Builder setBatchWaitInterval(Long batchWaitInterval) {                                    </span>
<span class="7659700979146023520" onmouseenter="enter('7659700979146023520');" onmouseout="out('7659700979146023520');" style=""> 982             format.batchWaitInterval = batchWaitInterval;                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 983             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 984         }                                                                                                </span>
<span  style=""> 985                                                                                                          </span>
<span class="-8777589626278372083" onmouseenter="enter('-8777589626278372083');" onmouseout="out('-8777589626278372083');" style=""> 986         public Builder setTableName(String tableName) {                                                  </span>
<span class="-1585853008866177938" onmouseenter="enter('-1585853008866177938');" onmouseout="out('-1585853008866177938');" style=""> 987             format.tableName = tableName;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 988             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 989         }                                                                                                </span>
<span  style=""> 990                                                                                                          </span>
<span class="221724127870954269" onmouseenter="enter('221724127870954269');" onmouseout="out('221724127870954269');" style=""> 991         public Builder setPartitionFields(String partitionFields) {                                      </span>
<span class="-8055214001591864073" onmouseenter="enter('-8055214001591864073');" onmouseout="out('-8055214001591864073');" style=""> 992             format.partitionFields = Objects.isNull(partitionFields) ?                                   </span>
<span class="6173943982789028324" onmouseenter="enter('6173943982789028324');" onmouseout="out('6173943982789028324');" style=""> 993                     &quot;&quot; : partitionFields;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 994             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 995         }                                                                                                </span>
<span  style=""> 996                                                                                                          </span>
<span class="-6994787811007556212" onmouseenter="enter('-6994787811007556212');" onmouseout="out('-6994787811007556212');" style=""> 997         public Builder setPrimaryKeys(List&lt;String&gt; primaryKeys) {                                        </span>
<span class="1909693990286542032" onmouseenter="enter('1909693990286542032');" onmouseout="out('1909693990286542032');" style=""> 998             format.primaryKeys = primaryKeys;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 999             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1000         }                                                                                                </span>
<span  style="">1001                                                                                                          </span>
<span class="7512351963685249159" onmouseenter="enter('7512351963685249159');" onmouseout="out('7512351963685249159');" style="">1002         public Builder setSchema(String schema) {                                                        </span>
<span class="306599522236782764" onmouseenter="enter('306599522236782764');" onmouseout="out('306599522236782764');" style="">1003             format.schema = schema;                                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1004             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1005         }                                                                                                </span>
<span  style="">1006                                                                                                          </span>
<span class="4541611662116992338" onmouseenter="enter('4541611662116992338');" onmouseout="out('4541611662116992338');" style="">1007         public Builder setEnablePartition(Boolean enablePartition) {                                     </span>
<span class="-6976631596761488792" onmouseenter="enter('-6976631596761488792');" onmouseout="out('-6976631596761488792');" style="">1008             format.enablePartition = enablePartition;                                                    </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1009             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1010         }                                                                                                </span>
<span  style="">1011                                                                                                          </span>
<span class="-8865383825618932145" onmouseenter="enter('-8865383825618932145');" onmouseout="out('-8865383825618932145');" style="">1012         public Builder setUpdateMode(String updateMode) {                                                </span>
<span class="-2281017119849044621" onmouseenter="enter('-2281017119849044621');" onmouseout="out('-2281017119849044621');" style="">1013             format.updateMode = updateMode;                                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1014             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1015         }                                                                                                </span>
<span  style="">1016                                                                                                          </span>
<span class="8081013001489210313" onmouseenter="enter('8081013001489210313');" onmouseout="out('8081013001489210313');" style="">1017         public Builder setFieldList(List&lt;String&gt; fieldList) {                                            </span>
<span class="-818074055946993480" onmouseenter="enter('-818074055946993480');" onmouseout="out('-818074055946993480');" style="">1018             format.fieldNames = fieldList;                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1019             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1020         }                                                                                                </span>
<span  style="">1021                                                                                                          </span>
<span class="3974737416393184735" onmouseenter="enter('3974737416393184735');" onmouseout="out('3974737416393184735');" style="">1022         public Builder setFieldTypeList(List&lt;String&gt; fieldTypeList) {                                    </span>
<span class="1448747188656744713" onmouseenter="enter('1448747188656744713');" onmouseout="out('1448747188656744713');" style="">1023             format.fieldTypes = fieldTypeList;                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1024             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1025         }                                                                                                </span>
<span  style="">1026                                                                                                          </span>
<span class="2244927175574628655" onmouseenter="enter('2244927175574628655');" onmouseout="out('2244927175574628655');" style="">1027         public Builder setStoreType(String storeType) {                                                  </span>
<span class="-5818885152026709969" onmouseenter="enter('-5818885152026709969');" onmouseout="out('-5818885152026709969');" style="">1028             format.storeType = storeType;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1029             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1030         }                                                                                                </span>
<span  style="">1031                                                                                                          </span>
<span class="-5487489987508961941" onmouseenter="enter('-5487489987508961941');" onmouseout="out('-5487489987508961941');" style="">1032         public Builder setFieldExtraInfoList(List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList) {</span>
<span class="160167467316759360" onmouseenter="enter('160167467316759360');" onmouseout="out('160167467316759360');" style="">1033             format.fieldExtraInfoList = fieldExtraInfoList;                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1034             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1035         }                                                                                                </span>
<span  style="">1036                                                                                                          </span>
<span class="1366044936846496088" onmouseenter="enter('1366044936846496088');" onmouseout="out('1366044936846496088');" style="">1037         public Builder setKeyTabPath(String keyTabPath) {                                                </span>
<span class="8755357456701014681" onmouseenter="enter('8755357456701014681');" onmouseout="out('8755357456701014681');" style="">1038             format.keytabPath = keyTabPath;                                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1039             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1040         }                                                                                                </span>
<span  style="">1041                                                                                                          </span>
<span class="1807007964631867819" onmouseenter="enter('1807007964631867819');" onmouseout="out('1807007964631867819');" style="">1042         public Builder setKrb5ConfPath(String krb5ConfPath) {                                            </span>
<span class="352337563234497723" onmouseenter="enter('352337563234497723');" onmouseout="out('352337563234497723');" style="">1043             format.krb5confPath = krb5ConfPath;                                                          </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1044             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1045         }                                                                                                </span>
<span  style="">1046                                                                                                          </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style="">1047         public Builder setPrincipal(String principal) {                                                  </span>
<span class="6894839552978791309" onmouseenter="enter('6894839552978791309');" onmouseout="out('6894839552978791309');" style="">1048             format.principal = principal;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1049             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1050         }                                                                                                </span>
<span  style="">1051                                                                                                          </span>
<span class="-8991908924314829739" onmouseenter="enter('-8991908924314829739');" onmouseout="out('-8991908924314829739');" style="">1052         public Builder setAuthMech(Integer authMech) {                                                   </span>
<span class="-1412915325814520049" onmouseenter="enter('-1412915325814520049');" onmouseout="out('-1412915325814520049');" style="">1053             format.authMech = authMech;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">1054             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1055         }                                                                                                </span>
<span  style="">1056                                                                                                          </span>
<span class="1564959121680510141" onmouseenter="enter('1564959121680510141');" onmouseout="out('1564959121680510141');" style="">1057         private boolean canHandle(String url) {                                                          </span>
<span class="842511305287615009" onmouseenter="enter('842511305287615009');" onmouseout="out('842511305287615009');" style="">1058             return url.startsWith(&quot;jdbc:impala:&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1059         }                                                                                                </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">1060 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="3824864761746312224" onmouseenter="enter('3824864761746312224');" onmouseout="out('3824864761746312224');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1061         public Builder setKrb5confPath(String krb5confPath) {                                            </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1062             this.krb5confPath = krb5confPath;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1063             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1064         }                                                                                                </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1065         public Builder setPrincipal(String principal) {                                                  </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1066             this.principal = principal;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1067             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1068         }                                                                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">1069 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1070         }                                                                                                </span>
<span class="3824864761746312224" onmouseenter="enter('3824864761746312224');" onmouseout="out('3824864761746312224');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1071         public Builder setKrb5confPath(String krb5confPath) {                                            </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1072             this.krb5confPath = krb5confPath;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1073             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1074         }                                                                                                </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1075         public Builder setPrincipal(String principal) {                                                  </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1076             this.principal = principal;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1077             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1078         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1079                                                                                                          </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1080         public ImpalaOutputFormat build() {                                                              </span>
<span class="-4875931377123605731" onmouseenter="enter('-4875931377123605731');" onmouseout="out('-4875931377123605731');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1081             checkNotNull(options, &quot;No options supplied.&quot;);                                               </span>
<span class="-7519421098126359785" onmouseenter="enter('-7519421098126359785');" onmouseout="out('-7519421098126359785');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1082             checkNotNull(fieldNames, &quot;No fieldNames supplied.&quot;);                                         </span>
<span class="-465714982636894626" onmouseenter="enter('-465714982636894626');" onmouseout="out('-465714982636894626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1083             return new ImpalaOutputFormat(                                                               </span>
<span class="-1722348633561755627" onmouseenter="enter('-1722348633561755627');" onmouseout="out('-1722348633561755627');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1084                 options,                                                                                 </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1085                 fieldNames,                                                                              </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1086                 keyFields,                                                                               </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1087                 partitionFields,                                                                         </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1088                 fieldTypes,                                                                              </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1089                 flushMaxSize,                                                                            </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1090                 flushIntervalMills,                                                                      </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1091                 allReplace,                                                                              </span>
<span class="7760506155904782707" onmouseenter="enter('7760506155904782707');" onmouseout="out('7760506155904782707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1092                 updateMode,                                                                              </span>
<span class="-4863483435840713149" onmouseenter="enter('-4863483435840713149');" onmouseout="out('-4863483435840713149');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1093                 authMech,                                                                                </span>
<span class="6910046306719868385" onmouseenter="enter('6910046306719868385');" onmouseout="out('6910046306719868385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1094                 keytabPath,                                                                              </span>
<span class="2510923373943101588" onmouseenter="enter('2510923373943101588');" onmouseout="out('2510923373943101588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1095                 krb5confPath,                                                                            </span>
<span class="-3475871463423309499" onmouseenter="enter('-3475871463423309499');" onmouseout="out('-3475871463423309499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1096                 principal);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1097         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1098     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">1099 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">1100 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">1101                                                                                                          </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style="">1102         public ImpalaOutputFormat build() {                                                              </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">1103 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-4875931377123605731" onmouseenter="enter('-4875931377123605731');" onmouseout="out('-4875931377123605731');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1104             checkNotNull(options, &quot;No options supplied.&quot;);                                               </span>
<span class="-7519421098126359785" onmouseenter="enter('-7519421098126359785');" onmouseout="out('-7519421098126359785');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1105             checkNotNull(fieldNames, &quot;No fieldNames supplied.&quot;);                                         </span>
<span class="-465714982636894626" onmouseenter="enter('-465714982636894626');" onmouseout="out('-465714982636894626');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1106             return new ImpalaOutputFormat(                                                               </span>
<span class="-1722348633561755627" onmouseenter="enter('-1722348633561755627');" onmouseout="out('-1722348633561755627');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1107                     options,                                                                             </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1108                     fieldNames,                                                                          </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1109                     keyFields,                                                                           </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1110                     partitionFields,                                                                     </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1111                     fieldTypes,                                                                          </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1112                     flushMaxSize,                                                                        </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1113                     flushIntervalMills,                                                                  </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1114                     allReplace,                                                                          </span>
<span class="7760506155904782707" onmouseenter="enter('7760506155904782707');" onmouseout="out('7760506155904782707');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1115                     updateMode,                                                                          </span>
<span class="-4863483435840713149" onmouseenter="enter('-4863483435840713149');" onmouseout="out('-4863483435840713149');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1116                     authMech,                                                                            </span>
<span class="6910046306719868385" onmouseenter="enter('6910046306719868385');" onmouseout="out('6910046306719868385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1117                     keytabPath,                                                                          </span>
<span class="2510923373943101588" onmouseenter="enter('2510923373943101588');" onmouseout="out('2510923373943101588');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1118                     krb5confPath,                                                                        </span>
<span class="-3475871463423309499" onmouseenter="enter('-3475871463423309499');" onmouseout="out('-3475871463423309499');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1119                     principal);                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">1120 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1121         public ImpalaOutputFormat build() {                                                              </span>
<span class="-4875931377123605731" onmouseenter="enter('-4875931377123605731');" onmouseout="out('-4875931377123605731');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1122             checkNotNull(options, &quot;No options supplied.&quot;);                                               </span>
<span class="-7519421098126359785" onmouseenter="enter('-7519421098126359785');" onmouseout="out('-7519421098126359785');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1123             checkNotNull(fieldNames, &quot;No fieldNames supplied.&quot;);                                         </span>
<span class="-465714982636894626" onmouseenter="enter('-465714982636894626');" onmouseout="out('-465714982636894626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1124             return new ImpalaOutputFormat(                                                               </span>
<span class="-1722348633561755627" onmouseenter="enter('-1722348633561755627');" onmouseout="out('-1722348633561755627');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1125                 options,                                                                                 </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1126                 fieldNames,                                                                              </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1127                 keyFields,                                                                               </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1128                 partitionFields,                                                                         </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1129                 fieldTypes,                                                                              </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1130                 flushMaxSize,                                                                            </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1131                 flushIntervalMills,                                                                      </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1132                 allReplace,                                                                              </span>
<span class="7760506155904782707" onmouseenter="enter('7760506155904782707');" onmouseout="out('7760506155904782707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1133                 updateMode,                                                                              </span>
<span class="-4863483435840713149" onmouseenter="enter('-4863483435840713149');" onmouseout="out('-4863483435840713149');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1134                 authMech,                                                                                </span>
<span class="6910046306719868385" onmouseenter="enter('6910046306719868385');" onmouseout="out('6910046306719868385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1135                 keytabPath,                                                                              </span>
<span class="2510923373943101588" onmouseenter="enter('2510923373943101588');" onmouseout="out('2510923373943101588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1136                 krb5confPath,                                                                            </span>
<span class="-3475871463423309499" onmouseenter="enter('-3475871463423309499');" onmouseout="out('-3475871463423309499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1137                 principal);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1138         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1139     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1140 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">1141 =======                                                                                                  </span>
<span class="1659683170431033048" onmouseenter="enter('1659683170431033048');" onmouseout="out('1659683170431033048');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1142             if (!canHandle(format.dbUrl)) {                                                              </span>
<span class="-4870909491096243891" onmouseenter="enter('-4870909491096243891');" onmouseout="out('-4870909491096243891');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1143                 throw new IllegalArgumentException(&quot;impala dbUrl is illegal, check url: &quot; + format.dbUrl);">1143                 throw new IllegalArgumentException(&quot;impala dbUrl is illegal, check url: &quot; + format.dbUrl)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1144             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1145                                                                                                          </span>
<span class="-4505121258189477360" onmouseenter="enter('-4505121258189477360');" onmouseout="out('-4505121258189477360');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1146             if (format.authMech == EAuthMech.Kerberos.getType()) {                                       </span>
<span class="-6183848778016991336" onmouseenter="enter('-6183848778016991336');" onmouseout="out('-6183848778016991336');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1147                 checkNotNull(format.krb5confPath,                                                        </span>
<span class="-4038272028328025626" onmouseenter="enter('-4038272028328025626');" onmouseout="out('-4038272028328025626');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1148                         &quot;When kerberos authentication is enabled, krb5confPath is required！&quot;);           </span>
<span class="-1753032521002756428" onmouseenter="enter('-1753032521002756428');" onmouseout="out('-1753032521002756428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1149                 checkNotNull(format.principal,                                                           </span>
<span class="-5219129049333790569" onmouseenter="enter('-5219129049333790569');" onmouseout="out('-5219129049333790569');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1150                         &quot;When kerberos authentication is enabled, principal is required！&quot;);              </span>
<span class="-3070330065691611476" onmouseenter="enter('-3070330065691611476');" onmouseout="out('-3070330065691611476');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1151                 checkNotNull(format.keytabPath,                                                          </span>
<span class="-393994981289522477" onmouseenter="enter('-393994981289522477');" onmouseout="out('-393994981289522477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1152                         &quot;When kerberos authentication is enabled, keytabPath is required！&quot;);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1153             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1154                                                                                                          </span>
<span class="-5111581416826137591" onmouseenter="enter('-5111581416826137591');" onmouseout="out('-5111581416826137591');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1155             if (format.authMech == EAuthMech.UserName.getType()) {                                       </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1156                 checkNotNull(format.userName, &quot;userName is required!&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1157             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1158                                                                                                          </span>
<span class="-3238564706659558925" onmouseenter="enter('-3238564706659558925');" onmouseout="out('-3238564706659558925');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1159             if (format.authMech == EAuthMech.NameANDPassword.getType()) {                                </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1160                 checkNotNull(format.userName, &quot;userName is required!&quot;);                                  </span>
<span class="-9040493906648204146" onmouseenter="enter('-9040493906648204146');" onmouseout="out('-9040493906648204146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1161                 checkNotNull(format.password, &quot;password is required!&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1162             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1163                                                                                                          </span>
<span class="1310568763423505425" onmouseenter="enter('1310568763423505425');" onmouseout="out('1310568763423505425');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1164             checkNotNull(format.storeType, &quot;storeType is required!&quot;);                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1165                                                                                                          </span>
<span class="9058009825496417823" onmouseenter="enter('9058009825496417823');" onmouseout="out('9058009825496417823');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1166             return format;                                                                               </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">1167 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1168         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1169     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1170 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-6349807778844055730" onmouseenter="enter('-6349807778844055730');" onmouseout="out('-6349807778844055730');" style="">   1 package com.dtstack.flink.sql.sink.impala;                                                               </span>
<span  style="">   2                                                                                                          </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">   3 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="102868081392093008" onmouseenter="enter('102868081392093008');" onmouseout="out('102868081392093008');" style="">   4 import com.dtstack.flink.sql.outputformat.AbstractDtRichOutputFormat;                                    </span>
<span class="-8930056125403642162" onmouseenter="enter('-8930056125403642162');" onmouseout="out('-8930056125403642162');" style="">   5 import com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils;                                              </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="">   6 import com.dtstack.flink.sql.table.AbstractTableInfo;                                                    </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="">   7 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="6538493847244355843" onmouseenter="enter('6538493847244355843');" onmouseout="out('6538493847244355843');" style="">   8 import com.dtstack.flink.sql.util.KrbUtils;                                                              </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">   9 import com.google.common.collect.Maps;                                                                   </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  10 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  11 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  12 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  13 import org.apache.flink.types.Row;                                                                       </span>
<span class="506888042235574053" onmouseenter="enter('506888042235574053');" onmouseout="out('506888042235574053');" style="">  14 import org.apache.hadoop.security.UserGroupInformation;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  15 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  16 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  17                                                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  18 import java.io.IOException;                                                                              </span>
<span class="6916252335749377687" onmouseenter="enter('6916252335749377687');" onmouseout="out('6916252335749377687');" style="">  19 import java.rmi.RemoteException;                                                                         </span>
<span class="7889752473047782369" onmouseenter="enter('7889752473047782369');" onmouseout="out('7889752473047782369');" style="">  20 import java.security.PrivilegedExceptionAction;                                                          </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="">  21 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="">  22 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="">  23 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  24 import java.sql.SQLException;                                                                            </span>
<span class="6402527026259660908" onmouseenter="enter('6402527026259660908');" onmouseout="out('6402527026259660908');" style="">  25 import java.sql.Statement;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  26 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  27 import java.util.Arrays;                                                                                 </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  28 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  29 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  30 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="">  31 import java.util.Objects;                                                                                </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  32 import java.util.Set;                                                                                    </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  33 import java.util.concurrent.ScheduledExecutorService;                                                    </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  34 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  35 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  36 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  37 import java.util.concurrent.atomic.AtomicReference;                                                      </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  38 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  39 import java.util.regex.Pattern;                                                                          </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  40 import java.util.stream.Collectors;                                                                      </span>
<span  style="">  41                                                                                                          </span>
<span class="1455633447019431220" onmouseenter="enter('1455633447019431220');" onmouseout="out('1455633447019431220');" style="">  42 import static com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils.setRecordToStatement;                  </span>
<span class="-6257877604578820371" onmouseenter="enter('-6257877604578820371');" onmouseout="out('-6257877604578820371');" style="">  43 import static org.apache.flink.util.Preconditions.checkNotNull;                                          </span>
<span  style="">  44                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45 /**                                                                                                      </span>
<span class="7153001641478282104" onmouseenter="enter('7153001641478282104');" onmouseout="out('7153001641478282104');" style="">  46  * Date: 2020/10/14                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  47  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  48  *                                                                                                       </span>
<span class="-4100502199450942834" onmouseenter="enter('-4100502199450942834');" onmouseout="out('-4100502199450942834');" style="">  49  * @author tiezhu                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  50  */                                                                                                      </span>
<span class="-4121149390422149560" onmouseenter="enter('-4121149390422149560');" onmouseout="out('-4121149390422149560');" style="">  51 public class ImpalaOutputFormat extends AbstractDtRichOutputFormat&lt;Tuple2&lt;Boolean, Row&gt;&gt; {               </span>
<span  style="">  52                                                                                                          </span>
<span class="-5870848474790717720" onmouseenter="enter('-5870848474790717720');" onmouseout="out('-5870848474790717720');" style="">  53     private static final Logger LOG = LoggerFactory.getLogger(ImpalaOutputFormat.class);                 </span>
<span  style="">  54                                                                                                          </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="">  55     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="">  56                                                                                                          </span>
<span class="-9068282285967712029" onmouseenter="enter('-9068282285967712029');" onmouseout="out('-9068282285967712029');" style="">  57     // ${field}                                                                                          </span>
<span class="-5949646080202310183" onmouseenter="enter('-5949646080202310183');" onmouseout="out('-5949646080202310183');" style="">  58     private static final Pattern STATIC_PARTITION_PATTERN = Pattern.compile(&quot;\\$\\{([^}]*)}&quot;);           </span>
<span class="5956354208608974741" onmouseenter="enter('5956354208608974741');" onmouseout="out('5956354208608974741');" style=""><abbr title="  59     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as timestamp)">  59     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as time🔵</abbr></span>
<span class="1953221153478650066" onmouseenter="enter('1953221153478650066');" onmouseout="out('1953221153478650066');" style="">  60     private static final Pattern TYPE_PATTERN = Pattern.compile(&quot;cast\\((.*) as (.*)\\)&quot;);               </span>
<span class="6992730206516090107" onmouseenter="enter('6992730206516090107');" onmouseout="out('6992730206516090107');" style="">  61     //specific type which values need to be quoted                                                       </span>
<span class="-2884666096421851487" onmouseenter="enter('-2884666096421851487');" onmouseout="out('-2884666096421851487');" style="">  62     private static final String[] NEED_QUOTE_TYPE = {&quot;string&quot;, &quot;timestamp&quot;, &quot;varchar&quot;};                  </span>
<span  style="">  63                                                                                                          </span>
<span class="191207487610103693" onmouseenter="enter('191207487610103693');" onmouseout="out('191207487610103693');" style="">  64     private static final Integer DEFAULT_CONN_TIME_OUT = 60;                                             </span>
<span class="-1388186840411616756" onmouseenter="enter('-1388186840411616756');" onmouseout="out('-1388186840411616756');" style="">  65     private static final int RECEIVE_DATA_PRINT_FREQUENCY = 1000;                                        </span>
<span class="-4268888009857984730" onmouseenter="enter('-4268888009857984730');" onmouseout="out('-4268888009857984730');" style="">  66     private static final int DIRTY_DATA_PRINT_FREQUENCY = 1000;                                          </span>
<span  style="">  67                                                                                                          </span>
<span class="-588818051573867979" onmouseenter="enter('-588818051573867979');" onmouseout="out('-588818051573867979');" style="">  68     private static final String KUDU_TYPE = &quot;kudu&quot;;                                                      </span>
<span class="-6769623881035360393" onmouseenter="enter('-6769623881035360393');" onmouseout="out('-6769623881035360393');" style="">  69     private static final String UPDATE_MODE = &quot;update&quot;;                                                  </span>
<span class="-7709014261424944614" onmouseenter="enter('-7709014261424944614');" onmouseout="out('-7709014261424944614');" style="">  70     private static final String PARTITION_CONSTANT = &quot;PARTITION&quot;;                                        </span>
<span class="1441081326157561113" onmouseenter="enter('1441081326157561113');" onmouseout="out('1441081326157561113');" style="">  71     private static final String DRIVER_NAME = &quot;com.cloudera.impala.jdbc41.Driver&quot;;                       </span>
<span  style="">  72                                                                                                          </span>
<span class="-2689163518074835497" onmouseenter="enter('-2689163518074835497');" onmouseout="out('-2689163518074835497');" style="">  73     private static final String VALUES_CONDITION = &quot;${valuesCondition}&quot;;                                 </span>
<span class="3062777246713899037" onmouseenter="enter('3062777246713899037');" onmouseout="out('3062777246713899037');" style="">  74     private static final String PARTITION_CONDITION = &quot;${partitionCondition}&quot;;                           </span>
<span class="2401236240707522557" onmouseenter="enter('2401236240707522557');" onmouseout="out('2401236240707522557');" style="">  75     private static final String TABLE_FIELDS_CONDITION = &quot;${tableFieldsCondition}&quot;;                      </span>
<span class="3255739684264436552" onmouseenter="enter('3255739684264436552');" onmouseout="out('3255739684264436552');" style="">  76     private static final String NO_PARTITION = &quot;noPartition&quot;;                                            </span>
<span  style="">  77                                                                                                          </span>
<span class="-7445073777200404714" onmouseenter="enter('-7445073777200404714');" onmouseout="out('-7445073777200404714');" style="">  78     protected transient Connection connection;                                                           </span>
<span class="-2184169902108079684" onmouseenter="enter('-2184169902108079684');" onmouseout="out('-2184169902108079684');" style="">  79     protected transient Statement statement;                                                             </span>
<span class="6238382839663594696" onmouseenter="enter('6238382839663594696');" onmouseout="out('6238382839663594696');" style="">  80     protected transient PreparedStatement updateStatement;                                               </span>
<span  style="">  81                                                                                                          </span>
<span class="4293032579277507790" onmouseenter="enter('4293032579277507790');" onmouseout="out('4293032579277507790');" style="">  82     private transient volatile boolean closed = false;                                                   </span>
<span class="8220840984571392918" onmouseenter="enter('8220840984571392918');" onmouseout="out('8220840984571392918');" style="">  83     private int batchCount = 0;                                                                          </span>
<span  style="">  84                                                                                                          </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="">  85     // |------------------------------------------------|                                                </span>
<span class="-789927222958732888" onmouseenter="enter('-789927222958732888');" onmouseout="out('-789927222958732888');" style="">  86     // |   partitionCondition   |Array of valueCondition|                                                </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="">  87     // |------------------------------------------------|                                                </span>
<span class="-8825804998995953162" onmouseenter="enter('-8825804998995953162');" onmouseout="out('-8825804998995953162');" style="">  88     // | ptOne, ptTwo, ptThree  | [(v1, v2, v3, v4, v5)]|   DP                                           </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="">  89     // |------------------------------------------------|                                                </span>
<span class="-5802382310877164118" onmouseenter="enter('-5802382310877164118');" onmouseout="out('-5802382310877164118');" style="">  90     // | ptOne = v1, ptTwo = v2 | [(v3, v4, v5)]        |   SP                                           </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="">  91     // |------------------------------------------------|                                                </span>
<span class="2984234039288316275" onmouseenter="enter('2984234039288316275');" onmouseout="out('2984234039288316275');" style="">  92     // | ptOne, ptTwo = v2      | [(v1, v3, v4, v5)]    |   DP and SP                                    </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="">  93     // |------------------------------------------------|                                                </span>
<span class="7219405512764117222" onmouseenter="enter('7219405512764117222');" onmouseout="out('7219405512764117222');" style="">  94     // | noPartition            | [(v1, v2, v3, v4, v5)]|   kudu or disablePartition                     </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="">  95     // |------------------------------------------------|                                                </span>
<span class="9020411500856357590" onmouseenter="enter('9020411500856357590');" onmouseout="out('9020411500856357590');" style="">  96     private transient Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap;                                         </span>
<span  style="">  97                                                                                                          </span>
<span class="-4172535577750872346" onmouseenter="enter('-4172535577750872346');" onmouseout="out('-4172535577750872346');" style="">  98     protected String keytabPath;                                                                         </span>
<span class="1987487277257130103" onmouseenter="enter('1987487277257130103');" onmouseout="out('1987487277257130103');" style="">  99     protected String krb5confPath;                                                                       </span>
<span class="3478885111338451838" onmouseenter="enter('3478885111338451838');" onmouseout="out('3478885111338451838');" style=""> 100     protected String principal;                                                                          </span>
<span class="-2673327721248325609" onmouseenter="enter('-2673327721248325609');" onmouseout="out('-2673327721248325609');" style=""> 101     protected Integer authMech;                                                                          </span>
<span class="-8834882937031238604" onmouseenter="enter('-8834882937031238604');" onmouseout="out('-8834882937031238604');" style=""> 102     protected String dbUrl;                                                                              </span>
<span class="4348689613054045460" onmouseenter="enter('4348689613054045460');" onmouseout="out('4348689613054045460');" style=""> 103     protected String userName;                                                                           </span>
<span class="519247125889688558" onmouseenter="enter('519247125889688558');" onmouseout="out('519247125889688558');" style=""> 104     protected String password;                                                                           </span>
<span class="-7554929939288236010" onmouseenter="enter('-7554929939288236010');" onmouseout="out('-7554929939288236010');" style=""> 105     protected int batchSize = 100;                                                                       </span>
<span class="8848445520039039194" onmouseenter="enter('8848445520039039194');" onmouseout="out('8848445520039039194');" style=""> 106     protected long batchWaitInterval = 60 * 1000L;                                                       </span>
<span class="6924126392600265325" onmouseenter="enter('6924126392600265325');" onmouseout="out('6924126392600265325');" style=""> 107     protected String tableName;                                                                          </span>
<span class="-8067881189136281922" onmouseenter="enter('-8067881189136281922');" onmouseout="out('-8067881189136281922');" style=""> 108     protected List&lt;String&gt; primaryKeys;                                                                  </span>
<span class="-1238809985534246985" onmouseenter="enter('-1238809985534246985');" onmouseout="out('-1238809985534246985');" style=""> 109     protected String partitionFields;                                                                    </span>
<span class="-2843446813182919439" onmouseenter="enter('-2843446813182919439');" onmouseout="out('-2843446813182919439');" style=""> 110     protected Boolean enablePartition;                                                                   </span>
<span class="3349082107931708476" onmouseenter="enter('3349082107931708476');" onmouseout="out('3349082107931708476');" style=""> 111     protected String schema;                                                                             </span>
<span class="-2869920961807604939" onmouseenter="enter('-2869920961807604939');" onmouseout="out('-2869920961807604939');" style=""> 112     protected String storeType;                                                                          </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style=""> 113     protected String updateMode;                                                                         </span>
<span class="8729932671243795004" onmouseenter="enter('8729932671243795004');" onmouseout="out('8729932671243795004');" style=""> 114     public List&lt;String&gt; fieldNames;                                                                      </span>
<span class="5323664213258183290" onmouseenter="enter('5323664213258183290');" onmouseout="out('5323664213258183290');" style=""> 115     public List&lt;String&gt; fieldTypes;                                                                      </span>
<span class="589573262942162938" onmouseenter="enter('589573262942162938');" onmouseout="out('589573262942162938');" style=""> 116     public List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList;                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="-2123205835999557493" onmouseenter="enter('-2123205835999557493');" onmouseout="out('-2123205835999557493');" style=""> 118     // partition field of static partition which matched by ${field}                                     </span>
<span class="-976040292573398488" onmouseenter="enter('-976040292573398488');" onmouseout="out('-976040292573398488');" style=""> 119     private final List&lt;String&gt; staticPartitionFields = new ArrayList&lt;&gt;();                                </span>
<span  style=""> 120                                                                                                          </span>
<span class="8461763253073029471" onmouseenter="enter('8461763253073029471');" onmouseout="out('8461763253073029471');" style=""> 121     // valueFieldsName -&gt; 重组之后的fieldNames，为了重组row data字段值对应                                              </span>
<span class="-5473349939362349748" onmouseenter="enter('-5473349939362349748');" onmouseout="out('-5473349939362349748');" style=""> 122     // 需要对partition字段做特殊处理，比如原来的字段顺序为(age, name, id)，但是因为partition，写入的SQL为                               </span>
<span class="888010466316090175" onmouseenter="enter('888010466316090175');" onmouseout="out('888010466316090175');" style=""> 123     // INSERT INTO tableName(name, id) PARTITION(age) VALUES(?, ?, ?)                                    </span>
<span class="1229277488566704041" onmouseenter="enter('1229277488566704041');" onmouseout="out('1229277488566704041');" style=""> 124     // 那么实际executeSql设置字段的顺序应该为(name, id, age)，同时，字段对应的type顺序也需要重组                                       </span>
<span class="6098973354216055964" onmouseenter="enter('6098973354216055964');" onmouseout="out('6098973354216055964');" style=""> 125     private List&lt;String&gt; valueFieldNames;                                                                </span>
<span class="-7108089166418781511" onmouseenter="enter('-7108089166418781511');" onmouseout="out('-7108089166418781511');" style=""> 126     private transient AbstractDtRichOutputFormat&lt;?&gt; metricOutputFormat;                                  </span>
<span class="273368026714901275" onmouseenter="enter('273368026714901275');" onmouseout="out('273368026714901275');" style=""> 127     private List&lt;Row&gt; rows;                                                                              </span>
<span  style=""> 128                                                                                                          </span>
<span class="9015955711937997200" onmouseenter="enter('9015955711937997200');" onmouseout="out('9015955711937997200');" style=""> 129     private transient ScheduledExecutorService scheduler;                                                </span>
<span class="-5761494216005426476" onmouseenter="enter('-5761494216005426476');" onmouseout="out('-5761494216005426476');" style=""> 130     private transient ScheduledFuture&lt;?&gt; scheduledFuture;                                                </span>
<span  style=""> 131                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 132     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style=""> 133     public void configure(Configuration parameters) {                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134     }                                                                                                    </span>
<span  style=""> 135                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 136     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style=""> 137     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 138 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 139         if (authMech == 1) {                                                                             </span>
<span class="-7445609792053649263" onmouseenter="enter('-7445609792053649263');" onmouseout="out('-7445609792053649263');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140             UserGroupInformation ugi = KrbUtils.loginAndReturnUgi(principal, keytabPath, krb5confPath);  </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 141 ||||||| BASE                                                                                             </span>
<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142         if (authMech == 1) {                                                                             </span>
<span class="-1284950725257121950" onmouseenter="enter('-1284950725257121950');" onmouseout="out('-1284950725257121950');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143             UserGroupInformation ugi = KrbUtils.getUgi(principal, keytabPath, krb5confPath);             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 144 =======                                                                                                  </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 145 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 146             try {                                                                                        </span>
<span class="4324779626821739975" onmouseenter="enter('4324779626821739975');" onmouseout="out('4324779626821739975');" style=""> 147             rowDataMap = new HashMap&lt;&gt;();                                                                </span>
<span class="-6551372933934183741" onmouseenter="enter('-6551372933934183741');" onmouseout="out('-6551372933934183741');" style=""> 148             rows = new ArrayList&lt;&gt;();                                                                    </span>
<span class="-7937337195293668220" onmouseenter="enter('-7937337195293668220');" onmouseout="out('-7937337195293668220');" style=""> 149             metricOutputFormat = this;                                                                   </span>
<span class="-8035752082134444550" onmouseenter="enter('-8035752082134444550');" onmouseout="out('-8035752082134444550');" style=""> 150             openConnect();                                                                               </span>
<span class="-3251827356232524015" onmouseenter="enter('-3251827356232524015');" onmouseout="out('-3251827356232524015');" style=""> 151             initScheduledTask(batchWaitInterval);                                                        </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 152             init();                                                                                      </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style=""> 153             initMetric();                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 154         } catch (Exception e) {                                                                          </span>
<span class="-105883012207117402" onmouseenter="enter('-105883012207117402');" onmouseout="out('-105883012207117402');" style=""> 155             throw new RuntimeException(&quot;impala output format open error!&quot;, e);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="-2481914402933088399" onmouseenter="enter('-2481914402933088399');" onmouseout="out('-2481914402933088399');" style=""> 159     public static Builder getImpalaBuilder() {                                                           </span>
<span class="-1926211775479526780" onmouseenter="enter('-1926211775479526780');" onmouseout="out('-1926211775479526780');" style=""> 160         return new Builder();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span  style=""> 162                                                                                                          </span>
<span class="-8578201295687943948" onmouseenter="enter('-8578201295687943948');" onmouseout="out('-8578201295687943948');" style=""> 163     private void init() throws SQLException {                                                            </span>
<span class="-8350145873279772804" onmouseenter="enter('-8350145873279772804');" onmouseout="out('-8350145873279772804');" style=""> 164         if (Objects.nonNull(partitionFields)) {                                                          </span>
<span class="8590422903839909721" onmouseenter="enter('8590422903839909721');" onmouseout="out('8590422903839909721');" style=""> 165             // match ${field} from partitionFields                                                       </span>
<span class="399614494149678967" onmouseenter="enter('399614494149678967');" onmouseout="out('399614494149678967');" style=""> 166             Matcher matcher = STATIC_PARTITION_PATTERN.matcher(partitionFields);                         </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 167             while (matcher.find()) {                                                                     </span>
<span class="-1180668930060799754" onmouseenter="enter('-1180668930060799754');" onmouseout="out('-1180668930060799754');" style=""> 168                 LOG.info(&quot;find static partition field: {}&quot;, matcher.group(1));                           </span>
<span class="5933786634924389530" onmouseenter="enter('5933786634924389530');" onmouseout="out('5933786634924389530');" style=""> 169                 staticPartitionFields.add(matcher.group(1));                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171         }                                                                                                </span>
<span  style=""> 172                                                                                                          </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style=""> 173         if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                                  </span>
<span class="-511688609314859464" onmouseenter="enter('-511688609314859464');" onmouseout="out('-511688609314859464');" style=""> 174             if (!storeType.equalsIgnoreCase(KUDU_TYPE)) {                                                </span>
<span class="7738691828431171650" onmouseenter="enter('7738691828431171650');" onmouseout="out('7738691828431171650');" style=""> 175                 throw new IllegalArgumentException(&quot;update mode not support for non-kudu table!&quot;);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176             }                                                                                            </span>
<span  style=""> 177                                                                                                          </span>
<span class="-1926567860735108753" onmouseenter="enter('-1926567860735108753');" onmouseout="out('-1926567860735108753');" style=""><abbr title=" 178             updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, primaryKeys));"> 178             updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, p🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 179             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180         }                                                                                                </span>
<span  style=""> 181                                                                                                          </span>
<span class="5264299831364970974" onmouseenter="enter('5264299831364970974');" onmouseout="out('5264299831364970974');" style=""><abbr title=" 182         valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, partitionFields);"> 182         valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="-4335191442342413864" onmouseenter="enter('-4335191442342413864');" onmouseout="out('-4335191442342413864');" style=""> 185     private void initScheduledTask(Long batchWaitInterval) {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 186         try {                                                                                            </span>
<span class="-5481453632006175071" onmouseenter="enter('-5481453632006175071');" onmouseout="out('-5481453632006175071');" style=""> 187             if (batchWaitInterval != 0) {                                                                </span>
<span class="777682131179381780" onmouseenter="enter('777682131179381780');" onmouseout="out('777682131179381780');" style=""> 188                 this.scheduler = new ScheduledThreadPoolExecutor(1,                                      </span>
<span class="714213466749562787" onmouseenter="enter('714213466749562787');" onmouseout="out('714213466749562787');" style=""> 189                         new DTThreadFactory(&quot;impala-upsert-output-format&quot;));                             </span>
<span class="-7149116985444787635" onmouseenter="enter('-7149116985444787635');" onmouseout="out('-7149116985444787635');" style=""> 190                 this.scheduledFuture = this.scheduler.scheduleWithFixedDelay(() -&gt; {                     </span>
<span class="-940414522275968791" onmouseenter="enter('-940414522275968791');" onmouseout="out('-940414522275968791');" style=""> 191                     synchronized (ImpalaOutputFormat.this) {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 192                         try {                                                                            </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style=""> 193                             flush();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 194                         } catch (Exception e) {                                                          </span>
<span class="-5628183046854957718" onmouseenter="enter('-5628183046854957718');" onmouseout="out('-5628183046854957718');" style=""> 195                             LOG.error(&quot;Writing records to impala jdbc failed.&quot;, e);                      </span>
<span class="-7023774051195191894" onmouseenter="enter('-7023774051195191894');" onmouseout="out('-7023774051195191894');" style=""> 196                             throw new RuntimeException(&quot;Writing records to impala jdbc failed.&quot;, e);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198                     }                                                                                    </span>
<span class="8465771028460365894" onmouseenter="enter('8465771028460365894');" onmouseout="out('8465771028460365894');" style=""> 199                 }, batchWaitInterval, batchWaitInterval, TimeUnit.MILLISECONDS);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200             }                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 201         } catch (Exception e) {                                                                          </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style=""> 202             throw new RuntimeException(e);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204     }                                                                                                    </span>
<span  style=""> 205                                                                                                          </span>
<span class="-2844613068709206340" onmouseenter="enter('-2844613068709206340');" onmouseout="out('-2844613068709206340');" style=""> 206     private void openConnect() throws IOException {                                                      </span>
<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style=""> 207         if (authMech == 1) {                                                                             </span>
<span class="-7445609792053649263" onmouseenter="enter('-7445609792053649263');" onmouseout="out('-7445609792053649263');" style=""> 208             UserGroupInformation ugi = KrbUtils.loginAndReturnUgi(principal, keytabPath, krb5confPath);  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 209             try {                                                                                        </span>
<span class="1057249312142684394" onmouseenter="enter('1057249312142684394');" onmouseout="out('1057249312142684394');" style=""> 210                 ugi.doAs((PrivilegedExceptionAction&lt;Void&gt;) () -&gt; {                                       </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style=""> 211                     openJdbc();                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 212                     return null;                                                                         </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 213                 });                                                                                      </span>
<span class="3693318474890767753" onmouseenter="enter('3693318474890767753');" onmouseout="out('3693318474890767753');" style=""> 214             } catch (InterruptedException | IOException e) {                                             </span>
<span class="-3216725393010457363" onmouseenter="enter('-3216725393010457363');" onmouseout="out('-3216725393010457363');" style=""> 215                 throw new IllegalArgumentException(&quot;connect impala error!&quot;, e);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 217         } else {                                                                                         </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style=""> 218             openJdbc();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220     }                                                                                                    </span>
<span  style=""> 221                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 222     /**                                                                                                  </span>
<span class="-4019084214603833891" onmouseenter="enter('-4019084214603833891');" onmouseout="out('-4019084214603833891');" style=""> 223      * get jdbc connection                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 224      */                                                                                                  </span>
<span class="6517717324631316532" onmouseenter="enter('6517717324631316532');" onmouseout="out('6517717324631316532');" style=""> 225     private void openJdbc() {                                                                            </span>
<span class="-5989471214664392944" onmouseenter="enter('-5989471214664392944');" onmouseout="out('-5989471214664392944');" style=""> 226         JDBCUtils.forName(DRIVER_NAME, getClass().getClassLoader());                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 227         try {                                                                                            </span>
<span class="-4188974437029144237" onmouseenter="enter('-4188974437029144237');" onmouseout="out('-4188974437029144237');" style=""> 228             connection = DriverManager.getConnection(dbUrl, userName, password);                         </span>
<span class="-3909190598463408725" onmouseenter="enter('-3909190598463408725');" onmouseout="out('-3909190598463408725');" style=""> 229             statement = connection.createStatement();                                                    </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style=""> 230             connection.setAutoCommit(false);                                                             </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style=""> 231         } catch (SQLException sqlException) {                                                            </span>
<span class="8417232372887360387" onmouseenter="enter('8417232372887360387');" onmouseout="out('8417232372887360387');" style=""> 232             throw new RuntimeException(&quot;get impala jdbc connection failed!&quot;, sqlException);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="7521208138226245516" onmouseenter="enter('7521208138226245516');" onmouseout="out('7521208138226245516');" style=""> 236     private void flush() throws Exception {                                                              </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style=""> 237         if (batchCount &gt; 0) {                                                                            </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style=""> 238             if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                              </span>
<span class="-7210745719484505959" onmouseenter="enter('-7210745719484505959');" onmouseout="out('-7210745719484505959');" style=""> 239                 executeUpdateBatch();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240             }                                                                                            </span>
<span class="-5565980137871755476" onmouseenter="enter('-5565980137871755476');" onmouseout="out('-5565980137871755476');" style=""> 241             if (!rowDataMap.isEmpty()) {                                                                 </span>
<span class="8546814641173072756" onmouseenter="enter('8546814641173072756');" onmouseout="out('8546814641173072756');" style=""> 242                 String templateSql =                                                                     </span>
<span class="-1766017053596733683" onmouseenter="enter('-1766017053596733683');" onmouseout="out('-1766017053596733683');" style=""><abbr title=" 243                         &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VALUES ${valuesCondition}&quot;;"> 243                         &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VA🔵</abbr></span>
<span class="7007887973141057675" onmouseenter="enter('7007887973141057675');" onmouseout="out('7007887973141057675');" style=""> 244                 executeBatchSql(                                                                         </span>
<span class="839015566868436312" onmouseenter="enter('839015566868436312');" onmouseout="out('839015566868436312');" style=""> 245                         statement,                                                                       </span>
<span class="-8931083358346849072" onmouseenter="enter('-8931083358346849072');" onmouseout="out('-8931083358346849072');" style=""> 246                         templateSql,                                                                     </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style=""> 247                         schema,                                                                          </span>
<span class="8599198975592615021" onmouseenter="enter('8599198975592615021');" onmouseout="out('8599198975592615021');" style=""> 248                         tableName,                                                                       </span>
<span class="7739930709415439240" onmouseenter="enter('7739930709415439240');" onmouseout="out('7739930709415439240');" style=""> 249                         storeType,                                                                       </span>
<span class="4460343981916954231" onmouseenter="enter('4460343981916954231');" onmouseout="out('4460343981916954231');" style=""> 250                         enablePartition,                                                                 </span>
<span class="-232795436679668454" onmouseenter="enter('-232795436679668454');" onmouseout="out('-232795436679668454');" style=""> 251                         valueFieldNames,                                                                 </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style=""> 252                         partitionFields,                                                                 </span>
<span class="-163268273074797630" onmouseenter="enter('-163268273074797630');" onmouseout="out('-163268273074797630');" style=""> 253                         rowDataMap                                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 254                 );                                                                                       </span>
<span class="1629791312198735010" onmouseenter="enter('1629791312198735010');" onmouseout="out('1629791312198735010');" style=""> 255                 rowDataMap.clear();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257         }                                                                                                </span>
<span class="-5311733944590264805" onmouseenter="enter('-5311733944590264805');" onmouseout="out('-5311733944590264805');" style=""> 258         batchCount = 0;                                                                                  </span>
<span  style=""> 259                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260     }                                                                                                    </span>
<span  style=""> 261                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 262     /**                                                                                                  </span>
<span class="-1106181825212481278" onmouseenter="enter('-1106181825212481278');" onmouseout="out('-1106181825212481278');" style=""> 263      * execute batch update statement                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 264      *                                                                                                   </span>
<span class="3560665881375675274" onmouseenter="enter('3560665881375675274');" onmouseout="out('3560665881375675274');" style=""> 265      * @throws SQLException throw sql exception                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 266      */                                                                                                  </span>
<span class="3206601587144870407" onmouseenter="enter('3206601587144870407');" onmouseout="out('3206601587144870407');" style=""> 267     private void executeUpdateBatch() throws SQLException {                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 268         try {                                                                                            </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style=""> 269             rows.forEach(row -&gt; {                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 270                 try {                                                                                    </span>
<span class="-1215139546593028546" onmouseenter="enter('-1215139546593028546');" onmouseout="out('-1215139546593028546');" style=""> 271                     JDBCTypeConvertUtils.setRecordToStatement(                                           </span>
<span class="-4710389352980966846" onmouseenter="enter('-4710389352980966846');" onmouseout="out('-4710389352980966846');" style=""> 272                             updateStatement,                                                             </span>
<span class="4668718668329814914" onmouseenter="enter('4668718668329814914');" onmouseout="out('4668718668329814914');" style=""> 273                             JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes),                    </span>
<span class="-7576027683765873339" onmouseenter="enter('-7576027683765873339');" onmouseout="out('-7576027683765873339');" style=""> 274                             row,                                                                         </span>
<span class="-255277236311302851" onmouseenter="enter('-255277236311302851');" onmouseout="out('-255277236311302851');" style=""> 275                             primaryKeys.stream().mapToInt(fieldNames::indexOf).toArray()                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 276                     );                                                                                   </span>
<span class="-4238050377414791796" onmouseenter="enter('-4238050377414791796');" onmouseout="out('-4238050377414791796');" style=""> 277                     updateStatement.addBatch();                                                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 278                 } catch (Exception e) {                                                                  </span>
<span class="5068376771892501659" onmouseenter="enter('5068376771892501659');" onmouseout="out('5068376771892501659');" style=""> 279                     throw new RuntimeException(&quot;impala jdbc execute batch error!&quot;, e);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 281             });                                                                                          </span>
<span class="-3747739502872154032" onmouseenter="enter('-3747739502872154032');" onmouseout="out('-3747739502872154032');" style=""> 282             updateStatement.executeBatch();                                                              </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 283             connection.commit();                                                                         </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style=""> 284             rows.clear();                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 285         } catch (Exception e) {                                                                          </span>
<span class="1715728751446881781" onmouseenter="enter('1715728751446881781');" onmouseout="out('1715728751446881781');" style=""> 286             LOG.debug(&quot;impala jdbc execute batch error &quot;, e);                                            </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style=""> 287             connection.rollback();                                                                       </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 288             connection.commit();                                                                         </span>
<span class="-4187732730208785389" onmouseenter="enter('-4187732730208785389');" onmouseout="out('-4187732730208785389');" style=""> 289             updateStatement.clearBatch();                                                                </span>
<span class="-8814080953460465644" onmouseenter="enter('-8814080953460465644');" onmouseout="out('-8814080953460465644');" style=""> 290             executeUpdate(connection);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292     }                                                                                                    </span>
<span  style=""> 293                                                                                                          </span>
<span class="-4847686400566224446" onmouseenter="enter('-4847686400566224446');" onmouseout="out('-4847686400566224446');" style=""> 294     public void executeUpdate(Connection connection) {                                                   </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style=""> 295         rows.forEach(row -&gt; {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 296             try {                                                                                        </span>
<span class="3018395377218617369" onmouseenter="enter('3018395377218617369');" onmouseout="out('3018395377218617369');" style=""><abbr title=" 297                 setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes), row);"> 297                 setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldT🔵</abbr></span>
<span class="-6547782628025070914" onmouseenter="enter('-6547782628025070914');" onmouseout="out('-6547782628025070914');" style=""> 298                 updateStatement.executeUpdate();                                                         </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 299                 connection.commit();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 300             } catch (Exception e) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 301                 try {                                                                                    </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style=""> 302                     connection.rollback();                                                               </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 303                     connection.commit();                                                                 </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style=""> 304                 } catch (SQLException e1) {                                                              </span>
<span class="-2635323073569974258" onmouseenter="enter('-2635323073569974258');" onmouseout="out('-2635323073569974258');" style=""> 305                     throw new RuntimeException(e1);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306                 }                                                                                        </span>
<span class="-4808081927273297919" onmouseenter="enter('-4808081927273297919');" onmouseout="out('-4808081927273297919');" style=""><abbr title=" 307                 if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {"> 307                 if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LO🔵</abbr></span>
<span class="-2764908242367356599" onmouseenter="enter('-2764908242367356599');" onmouseout="out('-2764908242367356599');" style=""> 308                     LOG.error(&quot;record insert failed ,this row is {}&quot;, row.toString());                   </span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style=""> 309                     LOG.error(&quot;&quot;, e);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310                 }                                                                                        </span>
<span class="-8596285303698617705" onmouseenter="enter('-8596285303698617705');" onmouseout="out('-8596285303698617705');" style=""> 311                 metricOutputFormat.outDirtyRecords.inc();                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 313         });                                                                                              </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style=""> 314         rows.clear();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315     }                                                                                                    </span>
<span  style=""> 316                                                                                                          </span>
<span class="5541545914698662583" onmouseenter="enter('5541545914698662583');" onmouseout="out('5541545914698662583');" style=""><abbr title=" 317     private void putRowIntoMap(Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap, Tuple2&lt;String, String&gt; rowData) {"> 317     private void putRowIntoMap(Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap, Tuple2&lt;String, String&gt; rowData)🔵</abbr></span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style=""> 318         Set&lt;String&gt; keySet = rowDataMap.keySet();                                                        </span>
<span class="-4115511162008757651" onmouseenter="enter('-4115511162008757651');" onmouseout="out('-4115511162008757651');" style=""> 319         ArrayList&lt;String&gt; tempRowArray;                                                                  </span>
<span class="-6312285345137005178" onmouseenter="enter('-6312285345137005178');" onmouseout="out('-6312285345137005178');" style=""> 320         if (keySet.contains(rowData.f0)) {                                                               </span>
<span class="2063657660163215007" onmouseenter="enter('2063657660163215007');" onmouseout="out('2063657660163215007');" style=""> 321             tempRowArray = rowDataMap.get(rowData.f0);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 322         } else {                                                                                         </span>
<span class="7109917545131433172" onmouseenter="enter('7109917545131433172');" onmouseout="out('7109917545131433172');" style=""> 323             tempRowArray = new ArrayList&lt;&gt;();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324         }                                                                                                </span>
<span class="1467529594977533778" onmouseenter="enter('1467529594977533778');" onmouseout="out('1467529594977533778');" style=""> 325         tempRowArray.add(rowData.f1);                                                                    </span>
<span class="6767865840186405987" onmouseenter="enter('6767865840186405987');" onmouseout="out('6767865840186405987');" style=""> 326         rowDataMap.put(rowData.f0, tempRowArray);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327     }                                                                                                    </span>
<span  style=""> 328                                                                                                          </span>
<span class="3578278218776325408" onmouseenter="enter('3578278218776325408');" onmouseout="out('3578278218776325408');" style=""><abbr title=" 329     private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPartitionFields, List&lt;String&gt; fieldTypes, String partitionFields) {"> 329     private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPart🔵</abbr></span>
<span class="-9170183165643435780" onmouseenter="enter('-9170183165643435780');" onmouseout="out('-9170183165643435780');" style=""> 330         if (partitionFields.isEmpty()) {                                                                 </span>
<span class="2916035488958294792" onmouseenter="enter('2916035488958294792');" onmouseout="out('2916035488958294792');" style=""> 331             return fieldNames;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332         }                                                                                                </span>
<span  style=""> 333                                                                                                          </span>
<span class="7990418778069769767" onmouseenter="enter('7990418778069769767');" onmouseout="out('7990418778069769767');" style=""> 334         List&lt;String&gt; valueFields = new ArrayList&lt;&gt;(fieldNames);                                          </span>
<span  style=""> 335                                                                                                          </span>
<span class="2302239674432319726" onmouseenter="enter('2302239674432319726');" onmouseout="out('2302239674432319726');" style=""> 336         for (int i = valueFields.size() - 1; i &gt;= 0; i--) {                                              </span>
<span class="-8004931019804249555" onmouseenter="enter('-8004931019804249555');" onmouseout="out('-8004931019804249555');" style=""> 337             if (staticPartitionFields.contains(fieldNames.get(i))) {                                     </span>
<span class="-3872161480019783193" onmouseenter="enter('-3872161480019783193');" onmouseout="out('-3872161480019783193');" style=""> 338                 valueFields.remove(i);                                                                   </span>
<span class="5504621354582269117" onmouseenter="enter('5504621354582269117');" onmouseout="out('5504621354582269117');" style=""> 339                 fieldTypes.remove(i);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341         }                                                                                                </span>
<span  style=""> 342                                                                                                          </span>
<span class="8724369392835521335" onmouseenter="enter('8724369392835521335');" onmouseout="out('8724369392835521335');" style=""> 343         for (int i = 0; i &lt; valueFields.size(); i++) {                                                   </span>
<span class="4573573241123850638" onmouseenter="enter('4573573241123850638');" onmouseout="out('4573573241123850638');" style=""> 344             if (partitionFields.contains(fieldNames.get(i))) {                                           </span>
<span class="-6733214010943616061" onmouseenter="enter('-6733214010943616061');" onmouseout="out('-6733214010943616061');" style=""> 345                 valueFields.add(valueFields.remove(i));                                                  </span>
<span class="3100686975272655596" onmouseenter="enter('3100686975272655596');" onmouseout="out('3100686975272655596');" style=""> 346                 fieldTypes.add(fieldTypes.remove(i));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348         }                                                                                                </span>
<span  style=""> 349                                                                                                          </span>
<span class="-4055330890426471630" onmouseenter="enter('-4055330890426471630');" onmouseout="out('-4055330890426471630');" style=""> 350         return valueFields;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351     }                                                                                                    </span>
<span  style=""> 352                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 353     /**                                                                                                  </span>
<span class="-8974785826875952090" onmouseenter="enter('-8974785826875952090');" onmouseout="out('-8974785826875952090');" style=""> 354      * Quote a specific type of value, like string, timestamp                                            </span>
<span class="-6015231753011783708" onmouseenter="enter('-6015231753011783708');" onmouseout="out('-6015231753011783708');" style=""> 355      * before: 1, cast(tiezhu as string), cast(2001-01-09 01:05:01 as timestamp), cast(123 as int)       </span>
<span class="-9072843877687738552" onmouseenter="enter('-9072843877687738552');" onmouseout="out('-9072843877687738552');" style=""> 356      * after: 1, cast(&#x27;tiezhu&#x27; as string), cast(&#x27;2001-01-09 01:05:01&#x27; as timestamp), cast(123 as int)    </span>
<span class="1334750812652161584" onmouseenter="enter('1334750812652161584');" onmouseout="out('1334750812652161584');" style=""> 357      * if cast value is null, then cast(null as type)                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 358      *                                                                                                   </span>
<span class="-7193371921927395943" onmouseenter="enter('-7193371921927395943');" onmouseout="out('-7193371921927395943');" style=""> 359      * @param valueCondition original value condition                                                    </span>
<span class="-4015247136226058388" onmouseenter="enter('-4015247136226058388');" onmouseout="out('-4015247136226058388');" style=""> 360      * @return quoted condition                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 361      */                                                                                                  </span>
<span class="-8514684189215878898" onmouseenter="enter('-8514684189215878898');" onmouseout="out('-8514684189215878898');" style=""> 362     private String valueConditionAddQuotation(String valueCondition) {                                   </span>
<span class="-7296893889335175056" onmouseenter="enter('-7296893889335175056');" onmouseout="out('-7296893889335175056');" style=""> 363         String[] temps = valueCondition.split(&quot;,&quot;);                                                      </span>
<span class="936116613567496626" onmouseenter="enter('936116613567496626');" onmouseout="out('936116613567496626');" style=""> 364         List&lt;String&gt; replacedItem = new ArrayList&lt;&gt;();                                                   </span>
<span class="-3322970786555187036" onmouseenter="enter('-3322970786555187036');" onmouseout="out('-3322970786555187036');" style=""> 365         Arrays.stream(temps).forEach(                                                                    </span>
<span class="4635365489417489024" onmouseenter="enter('4635365489417489024');" onmouseout="out('4635365489417489024');" style=""> 366                 item -&gt; {                                                                                </span>
<span class="-4536988729093203149" onmouseenter="enter('-4536988729093203149');" onmouseout="out('-4536988729093203149');" style=""> 367                     Matcher matcher = TYPE_PATTERN.matcher(item);                                        </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 368                     while (matcher.find()) {                                                             </span>
<span class="4482463139402405127" onmouseenter="enter('4482463139402405127');" onmouseout="out('4482463139402405127');" style=""> 369                         String value = matcher.group(1);                                                 </span>
<span class="-7401464861945434758" onmouseenter="enter('-7401464861945434758');" onmouseout="out('-7401464861945434758');" style=""> 370                         String type = matcher.group(2);                                                  </span>
<span  style=""> 371                                                                                                          </span>
<span class="173086077329077799" onmouseenter="enter('173086077329077799');" onmouseout="out('173086077329077799');" style=""> 372                         for (String needQuoteType : NEED_QUOTE_TYPE) {                                   </span>
<span class="-6207157170096749111" onmouseenter="enter('-6207157170096749111');" onmouseout="out('-6207157170096749111');" style=""> 373                             if (type.contains(needQuoteType)) {                                          </span>
<span class="8347227757103419143" onmouseenter="enter('8347227757103419143');" onmouseout="out('8347227757103419143');" style=""> 374                                 if (!&quot;null&quot;.equals(value)) {                                             </span>
<span class="-4537434762580953169" onmouseenter="enter('-4537434762580953169');" onmouseout="out('-4537434762580953169');" style=""> 375                                     item = item.replace(value, &quot;&#x27;&quot; + value + &quot;&#x27;&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 376                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379                     }                                                                                    </span>
<span class="8193346150481678438" onmouseenter="enter('8193346150481678438');" onmouseout="out('8193346150481678438');" style=""> 380                     replacedItem.add(item);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381                 }                                                                                        </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 382         );                                                                                               </span>
<span  style=""> 383                                                                                                          </span>
<span class="7763750891527797776" onmouseenter="enter('7763750891527797776');" onmouseout="out('7763750891527797776');" style=""> 384         return &quot;(&quot; + String.join(&quot;, &quot;, replacedItem) + &quot;)&quot;;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385     }                                                                                                    </span>
<span  style=""> 386                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 387     @Override                                                                                            </span>
<span class="-8766503565464123288" onmouseenter="enter('-8766503565464123288');" onmouseout="out('-8766503565464123288');" style=""> 388     public void writeRecord(Tuple2&lt;Boolean, Row&gt; record) throws IOException {                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 389         try {                                                                                            </span>
<span class="-1438543337409690372" onmouseenter="enter('-1438543337409690372');" onmouseout="out('-1438543337409690372');" style=""> 390             if (!record.f0) {                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 391                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392             }                                                                                            </span>
<span  style=""> 393                                                                                                          </span>
<span class="-8847095116449263406" onmouseenter="enter('-8847095116449263406');" onmouseout="out('-8847095116449263406');" style=""> 394             if (outRecords.getCount() % RECEIVE_DATA_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {     </span>
<span class="867853870420543335" onmouseenter="enter('867853870420543335');" onmouseout="out('867853870420543335');" style=""> 395                 LOG.info(&quot;Receive data : {}&quot;, record);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396             }                                                                                            </span>
<span  style=""> 397                                                                                                          </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style=""> 398             if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                              </span>
<span class="-4538110507205524162" onmouseenter="enter('-4538110507205524162');" onmouseout="out('-4538110507205524162');" style=""> 399                 rows.add(Row.copy(record.f1));                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 400             } else {                                                                                     </span>
<span class="-7917205410914838057" onmouseenter="enter('-7917205410914838057');" onmouseout="out('-7917205410914838057');" style=""> 401                 Map&lt;String, Object&gt; valueMap = Maps.newHashMap();                                        </span>
<span class="1869446492779313508" onmouseenter="enter('1869446492779313508');" onmouseout="out('1869446492779313508');" style=""> 402                 Row row = Row.copy(record.f1);                                                           </span>
<span  style=""> 403                                                                                                          </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style=""> 404                 for (int i = 0; i &lt; row.getArity(); i++) {                                               </span>
<span class="5876572039273015428" onmouseenter="enter('5876572039273015428');" onmouseout="out('5876572039273015428');" style=""> 405                     valueMap.put(fieldNames.get(i), row.getField(i));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406                 }                                                                                        </span>
<span  style=""> 407                                                                                                          </span>
<span class="-991390362203857814" onmouseenter="enter('-991390362203857814');" onmouseout="out('-991390362203857814');" style=""> 408                 Tuple2&lt;String, String&gt; rowTuple2 = new Tuple2&lt;&gt;();                                       </span>
<span class="-209542121488547867" onmouseenter="enter('-209542121488547867');" onmouseout="out('-209542121488547867');" style=""> 409                 if (storeType.equalsIgnoreCase(KUDU_TYPE) || !enablePartition) {                         </span>
<span class="-4830782679838689768" onmouseenter="enter('-4830782679838689768');" onmouseout="out('-4830782679838689768');" style=""> 410                     rowTuple2.f0 = NO_PARTITION;                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 411                 } else {                                                                                 </span>
<span class="5139395380358692168" onmouseenter="enter('5139395380358692168');" onmouseout="out('5139395380358692168');" style=""><abbr title=" 412                     rowTuple2.f0 = buildPartitionCondition(valueMap, partitionFields, staticPartitionFields);"> 412                     rowTuple2.f0 = buildPartitionCondition(valueMap, partitionFields, staticPartitionFiel🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413                 }                                                                                        </span>
<span  style=""> 414                                                                                                          </span>
<span class="-484968884065413564" onmouseenter="enter('-484968884065413564');" onmouseout="out('-484968884065413564');" style=""> 415                 // 根据字段名对 row data 重组, 比如，原始 row data : (1, xxx, 20) -&gt; (id, name, age)                  </span>
<span class="2038150889857603205" onmouseenter="enter('2038150889857603205');" onmouseout="out('2038150889857603205');" style=""> 416                 // 但是由于 partition，写入的field 顺序变成了 (name, id, age)，则需要对 row data 重组变成 (xxx, 1, 20)         </span>
<span class="5421203580895226953" onmouseenter="enter('5421203580895226953');" onmouseout="out('5421203580895226953');" style=""> 417                 Row rowValue = new Row(fieldTypes.size());                                               </span>
<span class="-7699243670258396145" onmouseenter="enter('-7699243670258396145');" onmouseout="out('-7699243670258396145');" style=""> 418                 for (int i = 0; i &lt; fieldTypes.size(); i++) {                                            </span>
<span class="2312799749991659832" onmouseenter="enter('2312799749991659832');" onmouseout="out('2312799749991659832');" style=""> 419                     rowValue.setField(i, valueMap.get(valueFieldNames.get(i)));                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420                 }                                                                                        </span>
<span class="8595450652771675183" onmouseenter="enter('8595450652771675183');" onmouseout="out('8595450652771675183');" style=""> 421                 rowTuple2.f1 = valueConditionAddQuotation(buildValuesCondition(fieldTypes, rowValue));   </span>
<span class="8896132355788887171" onmouseenter="enter('8896132355788887171');" onmouseout="out('8896132355788887171');" style=""> 422                 putRowIntoMap(rowDataMap, rowTuple2);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423             }                                                                                            </span>
<span  style=""> 424                                                                                                          </span>
<span class="-1784546571648451896" onmouseenter="enter('-1784546571648451896');" onmouseout="out('-1784546571648451896');" style=""> 425             batchCount++;                                                                                </span>
<span  style=""> 426                                                                                                          </span>
<span class="2059038061408804342" onmouseenter="enter('2059038061408804342');" onmouseout="out('2059038061408804342');" style=""> 427             if (batchCount &gt;= batchSize) {                                                               </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style=""> 428                 flush();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429             }                                                                                            </span>
<span  style=""> 430                                                                                                          </span>
<span class="-2147939016446724954" onmouseenter="enter('-2147939016446724954');" onmouseout="out('-2147939016446724954');" style=""> 431             // Receive data                                                                              </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style=""> 432             outRecords.inc();                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 433         } catch (Exception e) {                                                                          </span>
<span class="-6314596404725474749" onmouseenter="enter('-6314596404725474749');" onmouseout="out('-6314596404725474749');" style=""> 434             throw new IOException(&quot;Writing records to impala failed.&quot;, e);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436     }                                                                                                    </span>
<span  style=""> 437                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 438     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style=""> 439     public void close() throws IOException {                                                             </span>
<span class="6765329276469905715" onmouseenter="enter('6765329276469905715');" onmouseout="out('6765329276469905715');" style=""> 440         if (closed) {                                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 441             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442         }                                                                                                </span>
<span class="-8247099019020917877" onmouseenter="enter('-8247099019020917877');" onmouseout="out('-8247099019020917877');" style=""> 443         // 将还未执行的SQL flush                                                                               </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style=""> 444         if (batchCount &gt; 0) {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 445             try {                                                                                        </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style=""> 446                 flush();                                                                                 </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 447             } catch (Exception e) {                                                                      </span>
<span class="1679153721811128255" onmouseenter="enter('1679153721811128255');" onmouseout="out('1679153721811128255');" style=""> 448                 throw new RuntimeException(&quot;Writing records to impala failed.&quot;, e);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450         }                                                                                                </span>
<span class="4306800238416480323" onmouseenter="enter('4306800238416480323');" onmouseout="out('4306800238416480323');" style=""> 451         // cancel scheduled task                                                                         </span>
<span class="-1257031862697527304" onmouseenter="enter('-1257031862697527304');" onmouseout="out('-1257031862697527304');" style=""> 452         if (this.scheduledFuture != null) {                                                              </span>
<span class="-290660898949228596" onmouseenter="enter('-290660898949228596');" onmouseout="out('-290660898949228596');" style=""> 453             scheduledFuture.cancel(false);                                                               </span>
<span class="-3367227577965762682" onmouseenter="enter('-3367227577965762682');" onmouseout="out('-3367227577965762682');" style=""> 454             this.scheduler.shutdown();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455         }                                                                                                </span>
<span class="-6918026600162299955" onmouseenter="enter('-6918026600162299955');" onmouseout="out('-6918026600162299955');" style=""> 456         // close connection                                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 457         try {                                                                                            </span>
<span class="7850482504012729998" onmouseenter="enter('7850482504012729998');" onmouseout="out('7850482504012729998');" style=""> 458             if (connection != null &amp;&amp; connection.isValid(DEFAULT_CONN_TIME_OUT)) {                       </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 459                 connection.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460             }                                                                                            </span>
<span  style=""> 461                                                                                                          </span>
<span class="5036557091369948437" onmouseenter="enter('5036557091369948437');" onmouseout="out('5036557091369948437');" style=""> 462             if (statement != null &amp;&amp; !statement.isClosed()) {                                            </span>
<span class="-4290000005499431342" onmouseenter="enter('-4290000005499431342');" onmouseout="out('-4290000005499431342');" style=""> 463                 statement.close();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464             }                                                                                            </span>
<span  style=""> 465                                                                                                          </span>
<span class="-3745862640690712208" onmouseenter="enter('-3745862640690712208');" onmouseout="out('-3745862640690712208');" style=""> 466             if (updateStatement != null &amp;&amp; !updateStatement.isClosed()) {                                </span>
<span class="6285223499122042502" onmouseenter="enter('6285223499122042502');" onmouseout="out('6285223499122042502');" style=""> 467                 updateStatement.close();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style=""> 469         } catch (SQLException e) {                                                                       </span>
<span class="-8800633426745397107" onmouseenter="enter('-8800633426745397107');" onmouseout="out('-8800633426745397107');" style=""> 470             throw new RuntimeException(&quot;impala connection close failed!&quot;, e);                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 471         } finally {                                                                                      </span>
<span class="8335594207613379924" onmouseenter="enter('8335594207613379924');" onmouseout="out('8335594207613379924');" style=""> 472             connection = null;                                                                           </span>
<span class="-8855760725718402841" onmouseenter="enter('-8855760725718402841');" onmouseout="out('-8855760725718402841');" style=""> 473             statement = null;                                                                            </span>
<span class="-7841270215011717932" onmouseenter="enter('-7841270215011717932');" onmouseout="out('-7841270215011717932');" style=""> 474             updateStatement = null;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475         }                                                                                                </span>
<span class="5606214304023690467" onmouseenter="enter('5606214304023690467');" onmouseout="out('5606214304023690467');" style=""> 476         closed = true;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477     }                                                                                                    </span>
<span  style=""> 478                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 479     /**                                                                                                  </span>
<span class="1296337810927918625" onmouseenter="enter('1296337810927918625');" onmouseout="out('1296337810927918625');" style=""> 480      * execute batch sql from row data map                                                               </span>
<span class="-5974232274386764846" onmouseenter="enter('-5974232274386764846');" onmouseout="out('-5974232274386764846');" style=""><abbr title=" 481      * sql like &#x27;insert into tableName(f1, f2, f3) ${partitionCondition} values(v1, v2, v3), (v4, v5, v6)...."> 481      * sql like &#x27;insert into tableName(f1, f2, f3) ${partitionCondition} values(v1, v2, v3), (v4, v5, v6)🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 482      *                                                                                                   </span>
<span class="3064025681804756869" onmouseenter="enter('3064025681804756869');" onmouseout="out('3064025681804756869');" style=""> 483      * @param statement       execute statement                                                          </span>
<span class="4252025712922498493" onmouseenter="enter('4252025712922498493');" onmouseout="out('4252025712922498493');" style=""> 484      * @param tempSql         template sql                                                               </span>
<span class="-888616451537648959" onmouseenter="enter('-888616451537648959');" onmouseout="out('-888616451537648959');" style=""> 485      * @param storeType       the store type of data                                                     </span>
<span class="-5301096736775778703" onmouseenter="enter('-5301096736775778703');" onmouseout="out('-5301096736775778703');" style=""> 486      * @param enablePartition enable partition or not                                                    </span>
<span class="-7243431631208061298" onmouseenter="enter('-7243431631208061298');" onmouseout="out('-7243431631208061298');" style=""> 487      * @param fieldNames      field name list                                                            </span>
<span class="991482749163976330" onmouseenter="enter('991482749163976330');" onmouseout="out('991482749163976330');" style=""> 488      * @param partitionFields partition fields                                                           </span>
<span class="5552251290683891506" onmouseenter="enter('5552251290683891506');" onmouseout="out('5552251290683891506');" style=""> 489      * @param rowDataMap      row data map                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 490      */                                                                                                  </span>
<span class="4208908199550530657" onmouseenter="enter('4208908199550530657');" onmouseout="out('4208908199550530657');" style=""> 491     private void executeBatchSql(Statement statement,                                                    </span>
<span class="2680326069917862152" onmouseenter="enter('2680326069917862152');" onmouseout="out('2680326069917862152');" style=""> 492                                  String tempSql,                                                         </span>
<span class="-1880214364205558871" onmouseenter="enter('-1880214364205558871');" onmouseout="out('-1880214364205558871');" style=""> 493                                  String schema,                                                          </span>
<span class="6859219661302664351" onmouseenter="enter('6859219661302664351');" onmouseout="out('6859219661302664351');" style=""> 494                                  String tableName,                                                       </span>
<span class="3305030788069730493" onmouseenter="enter('3305030788069730493');" onmouseout="out('3305030788069730493');" style=""> 495                                  String storeType,                                                       </span>
<span class="3282308130032253418" onmouseenter="enter('3282308130032253418');" onmouseout="out('3282308130032253418');" style=""> 496                                  Boolean enablePartition,                                                </span>
<span class="-3269341593111050509" onmouseenter="enter('-3269341593111050509');" onmouseout="out('-3269341593111050509');" style=""> 497                                  List&lt;String&gt; fieldNames,                                                </span>
<span class="-152366337684528954" onmouseenter="enter('-152366337684528954');" onmouseout="out('-152366337684528954');" style=""> 498                                  String partitionFields,                                                 </span>
<span class="5702355489208114022" onmouseenter="enter('5702355489208114022');" onmouseout="out('5702355489208114022');" style=""> 499                                  Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap) {                            </span>
<span class="-8058960308042609674" onmouseenter="enter('-8058960308042609674');" onmouseout="out('-8058960308042609674');" style=""> 500         StringBuilder valuesCondition = new StringBuilder();                                             </span>
<span class="-1699639020719600437" onmouseenter="enter('-1699639020719600437');" onmouseout="out('-1699639020719600437');" style=""> 501         StringBuilder partitionCondition = new StringBuilder();                                          </span>
<span class="4484344279813579809" onmouseenter="enter('4484344279813579809');" onmouseout="out('4484344279813579809');" style=""> 502         String tableFieldsCondition = buildTableFieldsCondition(fieldNames, partitionFields);            </span>
<span class="-2056467323596282224" onmouseenter="enter('-2056467323596282224');" onmouseout="out('-2056467323596282224');" style=""> 503         ArrayList&lt;String&gt; rowData;                                                                       </span>
<span class="3545700907988930339" onmouseenter="enter('3545700907988930339');" onmouseout="out('3545700907988930339');" style=""> 504         String tableNameInfo = Objects.isNull(schema) ?                                                  </span>
<span class="1480493120427294696" onmouseenter="enter('1480493120427294696');" onmouseout="out('1480493120427294696');" style=""> 505                 tableName : quoteIdentifier(schema) + &quot;.&quot; + tableName;                                   </span>
<span class="-7586945217349428495" onmouseenter="enter('-7586945217349428495');" onmouseout="out('-7586945217349428495');" style=""> 506         tempSql = tempSql.replace(&quot;tableName&quot;, tableNameInfo);                                           </span>
<span  style=""> 507                                                                                                          </span>
<span class="-739313269293547881" onmouseenter="enter('-739313269293547881');" onmouseout="out('-739313269293547881');" style=""> 508         // kudu ${partitionCondition} is null                                                            </span>
<span class="-209542121488547867" onmouseenter="enter('-209542121488547867');" onmouseout="out('-209542121488547867');" style=""> 509         if (storeType.equalsIgnoreCase(KUDU_TYPE) || !enablePartition) {                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 510             try {                                                                                        </span>
<span class="-2154584329942843601" onmouseenter="enter('-2154584329942843601');" onmouseout="out('-2154584329942843601');" style=""> 511                 rowData = rowDataMap.get(NO_PARTITION);                                                  </span>
<span class="8347805769565999916" onmouseenter="enter('8347805769565999916');" onmouseout="out('8347805769565999916');" style=""> 512                 rowData.forEach(row -&gt; valuesCondition.append(row).append(&quot;, &quot;));                        </span>
<span class="3083642816500849348" onmouseenter="enter('3083642816500849348');" onmouseout="out('3083642816500849348');" style=""> 513                 String executeSql = tempSql.replace(VALUES_CONDITION, valuesCondition.toString())        </span>
<span class="1750592158576848918" onmouseenter="enter('1750592158576848918');" onmouseout="out('1750592158576848918');" style=""> 514                         .replace(PARTITION_CONDITION, partitionCondition.toString())                     </span>
<span class="1939264830691633930" onmouseenter="enter('1939264830691633930');" onmouseout="out('1939264830691633930');" style=""> 515                         .replace(PARTITION_CONSTANT, &quot;&quot;)                                                 </span>
<span class="808490930961205524" onmouseenter="enter('808490930961205524');" onmouseout="out('808490930961205524');" style=""> 516                         .replace(TABLE_FIELDS_CONDITION, tableFieldsCondition);                          </span>
<span class="8541330001607166782" onmouseenter="enter('8541330001607166782');" onmouseout="out('8541330001607166782');" style=""> 517                 String substring = executeSql.substring(0, executeSql.length() - 2);                     </span>
<span class="9213214884061660178" onmouseenter="enter('9213214884061660178');" onmouseout="out('9213214884061660178');" style=""> 518                 statement.execute(substring);                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 519             } catch (Exception e) {                                                                      </span>
<span class="7699356527811265570" onmouseenter="enter('7699356527811265570');" onmouseout="out('7699356527811265570');" style=""> 520                 throw new RuntimeException(&quot;execute impala SQL error!&quot;, e);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521             }                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 522             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523         }                                                                                                </span>
<span  style=""> 524                                                                                                          </span>
<span class="6613720697354939567" onmouseenter="enter('6613720697354939567');" onmouseout="out('6613720697354939567');" style=""> 525         // partition sql                                                                                 </span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style=""> 526         Set&lt;String&gt; keySet = rowDataMap.keySet();                                                        </span>
<span class="6439574290523368417" onmouseenter="enter('6439574290523368417');" onmouseout="out('6439574290523368417');" style=""> 527         String finalTempSql = tempSql;                                                                   </span>
<span class="5286500476222551862" onmouseenter="enter('5286500476222551862');" onmouseout="out('5286500476222551862');" style=""> 528         for (String key : keySet) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 529             try {                                                                                        </span>
<span class="-8214047348876131469" onmouseenter="enter('-8214047348876131469');" onmouseout="out('-8214047348876131469');" style=""> 530                 String executeSql = String.copyValueOf(finalTempSql.toCharArray());                      </span>
<span class="225939304905434763" onmouseenter="enter('225939304905434763');" onmouseout="out('225939304905434763');" style=""> 531                 ArrayList&lt;String&gt; valuesConditionList = rowDataMap.get(key);                             </span>
<span class="3266960038838022824" onmouseenter="enter('3266960038838022824');" onmouseout="out('3266960038838022824');" style=""> 532                 partitionCondition.append(key);                                                          </span>
<span class="7273478521762013154" onmouseenter="enter('7273478521762013154');" onmouseout="out('7273478521762013154');" style=""> 533                 executeSql = executeSql.replace(PARTITION_CONDITION, partitionCondition.toString())      </span>
<span class="7623710745634070513" onmouseenter="enter('7623710745634070513');" onmouseout="out('7623710745634070513');" style=""> 534                         .replace(TABLE_FIELDS_CONDITION, tableFieldsCondition)                           </span>
<span class="6339876343455538281" onmouseenter="enter('6339876343455538281');" onmouseout="out('6339876343455538281');" style=""> 535                         .replace(VALUES_CONDITION, String.join(&quot;, &quot;, valuesConditionList));              </span>
<span class="7589788358669612006" onmouseenter="enter('7589788358669612006');" onmouseout="out('7589788358669612006');" style=""> 536                 statement.execute(executeSql);                                                           </span>
<span class="-3000902343706299075" onmouseenter="enter('-3000902343706299075');" onmouseout="out('-3000902343706299075');" style=""> 537                 partitionCondition.delete(0, partitionCondition.length());                               </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style=""> 538             } catch (SQLException sqlException) {                                                        </span>
<span class="-5222513116835107038" onmouseenter="enter('-5222513116835107038');" onmouseout="out('-5222513116835107038');" style=""> 539                 throw new RuntimeException(&quot;execute impala SQL error! &quot;, sqlException);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542     }                                                                                                    </span>
<span  style=""> 543                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 544     /**                                                                                                  </span>
<span class="-7756927092547658158" onmouseenter="enter('-7756927092547658158');" onmouseout="out('-7756927092547658158');" style=""> 545      * build partition condition with row data                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 546      *                                                                                                   </span>
<span class="3326420447531983720" onmouseenter="enter('3326420447531983720');" onmouseout="out('3326420447531983720');" style=""> 547      * @param rowData              row data                                                              </span>
<span class="-4527404320823727170" onmouseenter="enter('-4527404320823727170');" onmouseout="out('-4527404320823727170');" style=""> 548      * @param partitionFields      partition fields                                                      </span>
<span class="-1776173940247734574" onmouseenter="enter('-1776173940247734574');" onmouseout="out('-1776173940247734574');" style=""> 549      * @param staticPartitionField static partition fields                                               </span>
<span class="-1132708759906563110" onmouseenter="enter('-1132708759906563110');" onmouseout="out('-1132708759906563110');" style=""> 550      * @return condition like &#x27;(ptOne, ptTwo=v2)&#x27;                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 551      */                                                                                                  </span>
<span class="-3866187778893382496" onmouseenter="enter('-3866187778893382496');" onmouseout="out('-3866187778893382496');" style=""><abbr title=" 552     private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;String&gt; staticPartitionField) {"> 552     private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;Stri🔵</abbr></span>
<span class="1267423885187171547" onmouseenter="enter('1267423885187171547');" onmouseout="out('1267423885187171547');" style=""> 553         for (String key : staticPartitionField) {                                                        </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 554             StringBuilder sb = new StringBuilder();                                                      </span>
<span class="-5505398468694975344" onmouseenter="enter('-5505398468694975344');" onmouseout="out('-5505398468694975344');" style=""> 555             Object value = rowData.get(key);                                                             </span>
<span class="-3546349567435071552" onmouseenter="enter('-3546349567435071552');" onmouseout="out('-3546349567435071552');" style=""> 556             sb.append(key).append(&quot;=&quot;).append(value);                                                    </span>
<span class="7571464430142538701" onmouseenter="enter('7571464430142538701');" onmouseout="out('7571464430142538701');" style=""> 557             partitionFields = partitionFields.replace(&quot;${&quot; + key + &quot;}&quot;, sb.toString());                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558         }                                                                                                </span>
<span class="-6125585623196674116" onmouseenter="enter('-6125585623196674116');" onmouseout="out('-6125585623196674116');" style=""> 559         return &quot;(&quot; + partitionFields + &quot;)&quot;;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 560     }                                                                                                    </span>
<span  style=""> 561                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 562     /**                                                                                                  </span>
<span class="1604816269765986224" onmouseenter="enter('1604816269765986224');" onmouseout="out('1604816269765986224');" style=""> 563      * build field condition according to field names                                                    </span>
<span class="-8005762898157210848" onmouseenter="enter('-8005762898157210848');" onmouseout="out('-8005762898157210848');" style=""> 564      * replace ${tableFieldCondition}                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 565      *                                                                                                   </span>
<span class="-3045974832751459167" onmouseenter="enter('-3045974832751459167');" onmouseout="out('-3045974832751459167');" style=""> 566      * @param fieldNames      the selected field names                                                   </span>
<span class="-2115580236801058408" onmouseenter="enter('-2115580236801058408');" onmouseout="out('-2115580236801058408');" style=""> 567      * @param partitionFields the partition fields                                                       </span>
<span class="-2587093228749928778" onmouseenter="enter('-2587093228749928778');" onmouseout="out('-2587093228749928778');" style=""> 568      * @return condition like &#x27;(id, name, age)&#x27;                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 569      */                                                                                                  </span>
<span class="-1478951256156574678" onmouseenter="enter('-1478951256156574678');" onmouseout="out('-1478951256156574678');" style=""> 570     private String buildTableFieldsCondition(List&lt;String&gt; fieldNames, String partitionFields) {          </span>
<span class="-8730756422155226372" onmouseenter="enter('-8730756422155226372');" onmouseout="out('-8730756422155226372');" style=""> 571         return &quot;(&quot; + fieldNames.stream()                                                                 </span>
<span class="-1124201215121024792" onmouseenter="enter('-1124201215121024792');" onmouseout="out('-1124201215121024792');" style=""> 572                 .filter(f -&gt; !partitionFields.contains(f))                                               </span>
<span class="4761076759122573536" onmouseenter="enter('4761076759122573536');" onmouseout="out('4761076759122573536');" style=""> 573                 .map(this::quoteIdentifier)                                                              </span>
<span class="-1385468130735042246" onmouseenter="enter('-1385468130735042246');" onmouseout="out('-1385468130735042246');" style=""> 574                 .collect(Collectors.joining(&quot;, &quot;)) + &quot;)&quot;;                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 575     }                                                                                                    </span>
<span  style=""> 576                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 577     /**                                                                                                  </span>
<span class="-1930125657620201419" onmouseenter="enter('-1930125657620201419');" onmouseout="out('-1930125657620201419');" style=""> 578      * according to field types, build the values condition                                              </span>
<span class="-5328431915012470826" onmouseenter="enter('-5328431915012470826');" onmouseout="out('-5328431915012470826');" style=""> 579      * replace ${valuesCondition}                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 580      *                                                                                                   </span>
<span class="889997534505017973" onmouseenter="enter('889997534505017973');" onmouseout="out('889997534505017973');" style=""> 581      * @param fieldTypes field types                                                                     </span>
<span class="-5792744344160442542" onmouseenter="enter('-5792744344160442542');" onmouseout="out('-5792744344160442542');" style=""> 582      * @return condition like &#x27;(?, ?, cast(? as string))&#x27; and &#x27;?&#x27; will be replaced with row data         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 583      */                                                                                                  </span>
<span class="-8753268388884688793" onmouseenter="enter('-8753268388884688793');" onmouseout="out('-8753268388884688793');" style=""> 584     private String buildValuesCondition(List&lt;String&gt; fieldTypes, Row row) {                              </span>
<span class="9451785702271217" onmouseenter="enter('9451785702271217');" onmouseout="out('9451785702271217');" style=""> 585         String valuesCondition = fieldTypes.stream().map(                                                </span>
<span class="-744834501831992668" onmouseenter="enter('-744834501831992668');" onmouseout="out('-744834501831992668');" style=""> 586                 f -&gt; {                                                                                   </span>
<span class="9071647551805886291" onmouseenter="enter('9071647551805886291');" onmouseout="out('9071647551805886291');" style=""> 587                     for (String item : NEED_QUOTE_TYPE) {                                                </span>
<span class="9108011392601680881" onmouseenter="enter('9108011392601680881');" onmouseout="out('9108011392601680881');" style=""> 588                         if (f.toLowerCase().contains(item)) {                                            </span>
<span class="-8315565477038260180" onmouseenter="enter('-8315565477038260180');" onmouseout="out('-8315565477038260180');" style=""> 589                             return String.format(&quot;cast(? as %s)&quot;, f.toLowerCase());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 591                     }                                                                                    </span>
<span class="6027958975032523467" onmouseenter="enter('6027958975032523467');" onmouseout="out('6027958975032523467');" style=""> 592                     return &quot;?&quot;;                                                                          </span>
<span class="4654177507103038656" onmouseenter="enter('4654177507103038656');" onmouseout="out('4654177507103038656');" style=""> 593                 }).collect(Collectors.joining(&quot;, &quot;));                                                    </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style=""> 594         for (int i = 0; i &lt; row.getArity(); i++) {                                                       </span>
<span class="2602556020493426404" onmouseenter="enter('2602556020493426404');" onmouseout="out('2602556020493426404');" style=""><abbr title=" 595             valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null&quot; : row.getField(i).toString());"> 595             valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 596         }                                                                                                </span>
<span class="6366685022999215739" onmouseenter="enter('6366685022999215739');" onmouseout="out('6366685022999215739');" style=""> 597         return valuesCondition;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598     }                                                                                                    </span>
<span  style=""> 599                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 600     /**                                                                                                  </span>
<span class="2218542669560141576" onmouseenter="enter('2218542669560141576');" onmouseout="out('2218542669560141576');" style=""> 601      * impala update mode SQL                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 602      *                                                                                                   </span>
<span class="-8218292189476554358" onmouseenter="enter('-8218292189476554358');" onmouseout="out('-8218292189476554358');" style=""> 603      * @return UPDATE tableName SET setCondition WHERE whereCondition                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 604      */                                                                                                  </span>
<span class="-3752451701752547882" onmouseenter="enter('-3752451701752547882');" onmouseout="out('-3752451701752547882');" style=""><abbr title=" 605     private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; primaryKeys) {"> 605     private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; 🔵</abbr></span>
<span class="5528853464056789996" onmouseenter="enter('5528853464056789996');" onmouseout="out('5528853464056789996');" style=""> 606         //跳过primary key字段                                                                                </span>
<span class="-8857590287628770183" onmouseenter="enter('-8857590287628770183');" onmouseout="out('-8857590287628770183');" style=""> 607         String setClause = fieldNames.stream()                                                           </span>
<span class="-803297460241064625" onmouseenter="enter('-803297460241064625');" onmouseout="out('-803297460241064625');" style=""> 608                 .filter(f -&gt; !CollectionUtils.isNotEmpty(primaryKeys) || !primaryKeys.contains(f))       </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style=""> 609                 .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                     </span>
<span class="-209499088310020597" onmouseenter="enter('-209499088310020597');" onmouseout="out('-209499088310020597');" style=""> 610                 .collect(Collectors.joining(&quot;, &quot;));                                                      </span>
<span  style=""> 611                                                                                                          </span>
<span class="-3669556570443861667" onmouseenter="enter('-3669556570443861667');" onmouseout="out('-3669556570443861667');" style=""> 612         String conditionClause = primaryKeys.stream()                                                    </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style=""> 613                 .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                     </span>
<span class="1187060376059521362" onmouseenter="enter('1187060376059521362');" onmouseout="out('1187060376059521362');" style=""> 614                 .collect(Collectors.joining(&quot; AND &quot;));                                                   </span>
<span  style=""> 615                                                                                                          </span>
<span class="-880277003185331688" onmouseenter="enter('-880277003185331688');" onmouseout="out('-880277003185331688');" style=""> 616         return &quot;UPDATE &quot; + (Objects.isNull(schema) ? &quot;&quot; : quoteIdentifier(schema) + &quot;.&quot;)                 </span>
<span class="-2776062363149844820" onmouseenter="enter('-2776062363149844820');" onmouseout="out('-2776062363149844820');" style=""> 617                 + quoteIdentifier(tableName) + &quot; SET &quot; + setClause + &quot; WHERE &quot; + conditionClause;        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 618     }                                                                                                    </span>
<span  style=""> 619                                                                                                          </span>
<span class="4659511982989745103" onmouseenter="enter('4659511982989745103');" onmouseout="out('4659511982989745103');" style=""> 620     private String quoteIdentifier(String identifier) {                                                  </span>
<span class="1935684454964464658" onmouseenter="enter('1935684454964464658');" onmouseout="out('1935684454964464658');" style=""> 621         return &quot;`&quot; + identifier + &quot;`&quot;;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 622     }                                                                                                    </span>
<span  style=""> 623                                                                                                          </span>
<span class="2010609695383714647" onmouseenter="enter('2010609695383714647');" onmouseout="out('2010609695383714647');" style=""> 624     public static class Builder {                                                                        </span>
<span class="5030308014750517924" onmouseenter="enter('5030308014750517924');" onmouseout="out('5030308014750517924');" style=""> 625         private final ImpalaOutputFormat format = new ImpalaOutputFormat();                              </span>
<span  style=""> 626                                                                                                          </span>
<span class="4847669250945231235" onmouseenter="enter('4847669250945231235');" onmouseout="out('4847669250945231235');" style=""> 627         public Builder setDbUrl(String dbUrl) {                                                          </span>
<span class="-7007213682983262515" onmouseenter="enter('-7007213682983262515');" onmouseout="out('-7007213682983262515');" style=""> 628             format.dbUrl = dbUrl;                                                                        </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 629             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 630         }                                                                                                </span>
<span  style=""> 631                                                                                                          </span>
<span class="-2062625403058053727" onmouseenter="enter('-2062625403058053727');" onmouseout="out('-2062625403058053727');" style=""> 632         public Builder setUserName(String userName) {                                                    </span>
<span class="8996094991043959374" onmouseenter="enter('8996094991043959374');" onmouseout="out('8996094991043959374');" style=""> 633             format.userName = userName;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 634             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 635         }                                                                                                </span>
<span  style=""> 636                                                                                                          </span>
<span class="-8917696572465338538" onmouseenter="enter('-8917696572465338538');" onmouseout="out('-8917696572465338538');" style=""> 637         public Builder setPassword(String password) {                                                    </span>
<span class="-5617852808102302847" onmouseenter="enter('-5617852808102302847');" onmouseout="out('-5617852808102302847');" style=""> 638             format.password = password;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 639             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 640         }                                                                                                </span>
<span  style=""> 641                                                                                                          </span>
<span class="-6851628607924303336" onmouseenter="enter('-6851628607924303336');" onmouseout="out('-6851628607924303336');" style=""> 642         public Builder setBatchSize(Integer batchSize) {                                                 </span>
<span class="-6323290766219617895" onmouseenter="enter('-6323290766219617895');" onmouseout="out('-6323290766219617895');" style=""> 643             format.batchSize = batchSize;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 644             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 645         }                                                                                                </span>
<span  style=""> 646                                                                                                          </span>
<span class="5791410845050671235" onmouseenter="enter('5791410845050671235');" onmouseout="out('5791410845050671235');" style=""> 647         public Builder setBatchWaitInterval(Long batchWaitInterval) {                                    </span>
<span class="7659700979146023520" onmouseenter="enter('7659700979146023520');" onmouseout="out('7659700979146023520');" style=""> 648             format.batchWaitInterval = batchWaitInterval;                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 649             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 650         }                                                                                                </span>
<span  style=""> 651                                                                                                          </span>
<span class="-8777589626278372083" onmouseenter="enter('-8777589626278372083');" onmouseout="out('-8777589626278372083');" style=""> 652         public Builder setTableName(String tableName) {                                                  </span>
<span class="-1585853008866177938" onmouseenter="enter('-1585853008866177938');" onmouseout="out('-1585853008866177938');" style=""> 653             format.tableName = tableName;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 654             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 655         }                                                                                                </span>
<span  style=""> 656                                                                                                          </span>
<span class="221724127870954269" onmouseenter="enter('221724127870954269');" onmouseout="out('221724127870954269');" style=""> 657         public Builder setPartitionFields(String partitionFields) {                                      </span>
<span class="-8055214001591864073" onmouseenter="enter('-8055214001591864073');" onmouseout="out('-8055214001591864073');" style=""> 658             format.partitionFields = Objects.isNull(partitionFields) ?                                   </span>
<span class="6173943982789028324" onmouseenter="enter('6173943982789028324');" onmouseout="out('6173943982789028324');" style=""> 659                     &quot;&quot; : partitionFields;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 660             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661         }                                                                                                </span>
<span  style=""> 662                                                                                                          </span>
<span class="-6994787811007556212" onmouseenter="enter('-6994787811007556212');" onmouseout="out('-6994787811007556212');" style=""> 663         public Builder setPrimaryKeys(List&lt;String&gt; primaryKeys) {                                        </span>
<span class="1909693990286542032" onmouseenter="enter('1909693990286542032');" onmouseout="out('1909693990286542032');" style=""> 664             format.primaryKeys = primaryKeys;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 665             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 666         }                                                                                                </span>
<span  style=""> 667                                                                                                          </span>
<span class="7512351963685249159" onmouseenter="enter('7512351963685249159');" onmouseout="out('7512351963685249159');" style=""> 668         public Builder setSchema(String schema) {                                                        </span>
<span class="306599522236782764" onmouseenter="enter('306599522236782764');" onmouseout="out('306599522236782764');" style=""> 669             format.schema = schema;                                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 670             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 671         }                                                                                                </span>
<span  style=""> 672                                                                                                          </span>
<span class="4541611662116992338" onmouseenter="enter('4541611662116992338');" onmouseout="out('4541611662116992338');" style=""> 673         public Builder setEnablePartition(Boolean enablePartition) {                                     </span>
<span class="-6976631596761488792" onmouseenter="enter('-6976631596761488792');" onmouseout="out('-6976631596761488792');" style=""> 674             format.enablePartition = enablePartition;                                                    </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 675             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 676         }                                                                                                </span>
<span  style=""> 677                                                                                                          </span>
<span class="-8865383825618932145" onmouseenter="enter('-8865383825618932145');" onmouseout="out('-8865383825618932145');" style=""> 678         public Builder setUpdateMode(String updateMode) {                                                </span>
<span class="-2281017119849044621" onmouseenter="enter('-2281017119849044621');" onmouseout="out('-2281017119849044621');" style=""> 679             format.updateMode = updateMode;                                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 680             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 681         }                                                                                                </span>
<span  style=""> 682                                                                                                          </span>
<span class="8081013001489210313" onmouseenter="enter('8081013001489210313');" onmouseout="out('8081013001489210313');" style=""> 683         public Builder setFieldList(List&lt;String&gt; fieldList) {                                            </span>
<span class="-818074055946993480" onmouseenter="enter('-818074055946993480');" onmouseout="out('-818074055946993480');" style=""> 684             format.fieldNames = fieldList;                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 685             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 686         }                                                                                                </span>
<span  style=""> 687                                                                                                          </span>
<span class="3974737416393184735" onmouseenter="enter('3974737416393184735');" onmouseout="out('3974737416393184735');" style=""> 688         public Builder setFieldTypeList(List&lt;String&gt; fieldTypeList) {                                    </span>
<span class="1448747188656744713" onmouseenter="enter('1448747188656744713');" onmouseout="out('1448747188656744713');" style=""> 689             format.fieldTypes = fieldTypeList;                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 690             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 691         }                                                                                                </span>
<span  style=""> 692                                                                                                          </span>
<span class="2244927175574628655" onmouseenter="enter('2244927175574628655');" onmouseout="out('2244927175574628655');" style=""> 693         public Builder setStoreType(String storeType) {                                                  </span>
<span class="-5818885152026709969" onmouseenter="enter('-5818885152026709969');" onmouseout="out('-5818885152026709969');" style=""> 694             format.storeType = storeType;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 695             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 696         }                                                                                                </span>
<span  style=""> 697                                                                                                          </span>
<span class="-5487489987508961941" onmouseenter="enter('-5487489987508961941');" onmouseout="out('-5487489987508961941');" style=""> 698         public Builder setFieldExtraInfoList(List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList) {</span>
<span class="160167467316759360" onmouseenter="enter('160167467316759360');" onmouseout="out('160167467316759360');" style=""> 699             format.fieldExtraInfoList = fieldExtraInfoList;                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 700             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 701         }                                                                                                </span>
<span  style=""> 702                                                                                                          </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style=""> 703         public Builder setPrincipal(String principal) {                                                  </span>
<span class="6894839552978791309" onmouseenter="enter('6894839552978791309');" onmouseout="out('6894839552978791309');" style=""> 704             format.principal = principal;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 705             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 706         }                                                                                                </span>
<span  style=""> 707                                                                                                          </span>
<span class="-8991908924314829739" onmouseenter="enter('-8991908924314829739');" onmouseout="out('-8991908924314829739');" style=""> 708         public Builder setAuthMech(Integer authMech) {                                                   </span>
<span class="-1412915325814520049" onmouseenter="enter('-1412915325814520049');" onmouseout="out('-1412915325814520049');" style=""> 709             format.authMech = authMech;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 710             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 711         }                                                                                                </span>
<span  style=""> 712                                                                                                          </span>
<span class="1366044936846496088" onmouseenter="enter('1366044936846496088');" onmouseout="out('1366044936846496088');" style=""> 713         public Builder setKeyTabPath(String keyTabPath) {                                                </span>
<span class="8755357456701014681" onmouseenter="enter('8755357456701014681');" onmouseout="out('8755357456701014681');" style=""> 714             format.keytabPath = keyTabPath;                                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 715             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 716         }                                                                                                </span>
<span  style=""> 717                                                                                                          </span>
<span class="1807007964631867819" onmouseenter="enter('1807007964631867819');" onmouseout="out('1807007964631867819');" style=""> 718         public Builder setKrb5ConfPath(String krb5ConfPath) {                                            </span>
<span class="352337563234497723" onmouseenter="enter('352337563234497723');" onmouseout="out('352337563234497723');" style=""> 719             format.krb5confPath = krb5ConfPath;                                                          </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 720             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 721         }                                                                                                </span>
<span  style=""> 722                                                                                                          </span>
<span class="1564959121680510141" onmouseenter="enter('1564959121680510141');" onmouseout="out('1564959121680510141');" style=""> 723         private boolean canHandle(String url) {                                                          </span>
<span class="842511305287615009" onmouseenter="enter('842511305287615009');" onmouseout="out('842511305287615009');" style=""> 724             return url.startsWith(&quot;jdbc:impala:&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 725         }                                                                                                </span>
<span  style=""> 726                                                                                                          </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style=""> 727         public ImpalaOutputFormat build() {                                                              </span>
<span class="1659683170431033048" onmouseenter="enter('1659683170431033048');" onmouseout="out('1659683170431033048');" style=""> 728             if (!canHandle(format.dbUrl)) {                                                              </span>
<span class="-4870909491096243891" onmouseenter="enter('-4870909491096243891');" onmouseout="out('-4870909491096243891');" style=""><abbr title=" 729                 throw new IllegalArgumentException(&quot;impala dbUrl is illegal, check url: &quot; + format.dbUrl);"> 729                 throw new IllegalArgumentException(&quot;impala dbUrl is illegal, check url: &quot; + format.dbUrl)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 730             }                                                                                            </span>
<span  style=""> 731                                                                                                          </span>
<span class="-4505121258189477360" onmouseenter="enter('-4505121258189477360');" onmouseout="out('-4505121258189477360');" style=""> 732             if (format.authMech == EAuthMech.Kerberos.getType()) {                                       </span>
<span class="-6183848778016991336" onmouseenter="enter('-6183848778016991336');" onmouseout="out('-6183848778016991336');" style=""> 733                 checkNotNull(format.krb5confPath,                                                        </span>
<span class="-4038272028328025626" onmouseenter="enter('-4038272028328025626');" onmouseout="out('-4038272028328025626');" style=""> 734                         &quot;When kerberos authentication is enabled, krb5confPath is required！&quot;);           </span>
<span class="-1753032521002756428" onmouseenter="enter('-1753032521002756428');" onmouseout="out('-1753032521002756428');" style=""> 735                 checkNotNull(format.principal,                                                           </span>
<span class="-5219129049333790569" onmouseenter="enter('-5219129049333790569');" onmouseout="out('-5219129049333790569');" style=""> 736                         &quot;When kerberos authentication is enabled, principal is required！&quot;);              </span>
<span class="-3070330065691611476" onmouseenter="enter('-3070330065691611476');" onmouseout="out('-3070330065691611476');" style=""> 737                 checkNotNull(format.keytabPath,                                                          </span>
<span class="-393994981289522477" onmouseenter="enter('-393994981289522477');" onmouseout="out('-393994981289522477');" style=""> 738                         &quot;When kerberos authentication is enabled, keytabPath is required！&quot;);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739             }                                                                                            </span>
<span  style=""> 740                                                                                                          </span>
<span class="-5111581416826137591" onmouseenter="enter('-5111581416826137591');" onmouseout="out('-5111581416826137591');" style=""> 741             if (format.authMech == EAuthMech.UserName.getType()) {                                       </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style=""> 742                 checkNotNull(format.userName, &quot;userName is required!&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743             }                                                                                            </span>
<span  style=""> 744                                                                                                          </span>
<span class="-3238564706659558925" onmouseenter="enter('-3238564706659558925');" onmouseout="out('-3238564706659558925');" style=""> 745             if (format.authMech == EAuthMech.NameANDPassword.getType()) {                                </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style=""> 746                 checkNotNull(format.userName, &quot;userName is required!&quot;);                                  </span>
<span class="-9040493906648204146" onmouseenter="enter('-9040493906648204146');" onmouseout="out('-9040493906648204146');" style=""> 747                 checkNotNull(format.password, &quot;password is required!&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 748             }                                                                                            </span>
<span  style=""> 749                                                                                                          </span>
<span class="1310568763423505425" onmouseenter="enter('1310568763423505425');" onmouseout="out('1310568763423505425');" style=""> 750             checkNotNull(format.storeType, &quot;storeType is required!&quot;);                                    </span>
<span  style=""> 751                                                                                                          </span>
<span class="9058009825496417823" onmouseenter="enter('9058009825496417823');" onmouseout="out('9058009825496417823');" style=""> 752             return format;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 753         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 754     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 755 }                                                                                                        </span>





























































































































































































































































































































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-6349807778844055730" onmouseenter="enter('-6349807778844055730');" onmouseout="out('-6349807778844055730');" style="">  18 package com.dtstack.flink.sql.sink.impala;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  20 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="102868081392093008" onmouseenter="enter('102868081392093008');" onmouseout="out('102868081392093008');" style="">  21 import com.dtstack.flink.sql.outputformat.AbstractDtRichOutputFormat;                                    </span>
<span class="-8930056125403642162" onmouseenter="enter('-8930056125403642162');" onmouseout="out('-8930056125403642162');" style="">  22 import com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils;                                              </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="">  23 import com.dtstack.flink.sql.table.AbstractTableInfo;                                                    </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="">  24 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="6538493847244355843" onmouseenter="enter('6538493847244355843');" onmouseout="out('6538493847244355843');" style="">  25 import com.dtstack.flink.sql.util.KrbUtils;                                                              </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  26 import com.google.common.collect.Maps;                                                                   </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  27 import java.io.IOException;                                                                              </span>
<span class="6916252335749377687" onmouseenter="enter('6916252335749377687');" onmouseout="out('6916252335749377687');" style="">  28 import java.rmi.RemoteException;                                                                         </span>
<span class="7889752473047782369" onmouseenter="enter('7889752473047782369');" onmouseout="out('7889752473047782369');" style="">  29 import java.security.PrivilegedExceptionAction;                                                          </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="">  30 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="">  31 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="">  32 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  33 import java.sql.SQLException;                                                                            </span>
<span class="6402527026259660908" onmouseenter="enter('6402527026259660908');" onmouseout="out('6402527026259660908');" style="">  34 import java.sql.Statement;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  35 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  36 import java.util.Arrays;                                                                                 </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  37 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  38 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  39 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="">  40 import java.util.Objects;                                                                                </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  41 import java.util.Set;                                                                                    </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  42 import java.util.concurrent.ScheduledExecutorService;                                                    </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  43 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  44 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  45 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  46 import java.util.concurrent.atomic.AtomicReference;                                                      </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  47 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  48 import java.util.regex.Pattern;                                                                          </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  49 import java.util.stream.Collectors;                                                                      </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  50 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  51 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  52 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  53 import org.apache.flink.types.Row;                                                                       </span>
<span class="506888042235574053" onmouseenter="enter('506888042235574053');" onmouseout="out('506888042235574053');" style="">  54 import org.apache.hadoop.security.UserGroupInformation;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  55 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  56 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="1455633447019431220" onmouseenter="enter('1455633447019431220');" onmouseout="out('1455633447019431220');" style="">  57 import static com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils.setRecordToStatement;                  </span>
<span class="-6257877604578820371" onmouseenter="enter('-6257877604578820371');" onmouseout="out('-6257877604578820371');" style="">  58 import static org.apache.flink.util.Preconditions.checkNotNull;                                          </span>
<span  style="">  59                                                                                                          </span>
<span  style="">  60                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  61 /**                                                                                                      </span>
<span class="7153001641478282104" onmouseenter="enter('7153001641478282104');" onmouseout="out('7153001641478282104');" style="">  62  * Date: 2020/10/14                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  63  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  64  *                                                                                                       </span>
<span class="-1506427667416228547" onmouseenter="enter('-1506427667416228547');" onmouseout="out('-1506427667416228547');" style="">  65  * @unknown flinkStreamSQL                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  66  */                                                                                                      </span>
<span class="-4121149390422149560" onmouseenter="enter('-4121149390422149560');" onmouseout="out('-4121149390422149560');" style="">  67 public class ImpalaOutputFormat extends AbstractDtRichOutputFormat&lt;Tuple2&lt;Boolean, Row&gt;&gt; {               </span>
<span class="-5870848474790717720" onmouseenter="enter('-5870848474790717720');" onmouseout="out('-5870848474790717720');" style="">  68     private static final Logger LOG = LoggerFactory.getLogger(ImpalaOutputFormat.class);                 </span>
<span  style="">  69                                                                                                          </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="">  70     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="">  71                                                                                                          </span>
<span class="-9068282285967712029" onmouseenter="enter('-9068282285967712029');" onmouseout="out('-9068282285967712029');" style="">  72     // ${field}                                                                                          </span>
<span class="-9068282285967712029" onmouseenter="enter('-9068282285967712029');" onmouseout="out('-9068282285967712029');" style="">  73     // ${field}                                                                                          </span>
<span class="-5949646080202310183" onmouseenter="enter('-5949646080202310183');" onmouseout="out('-5949646080202310183');" style="">  74     private static final Pattern STATIC_PARTITION_PATTERN = Pattern.compile(&quot;\\$\\{([^}]*)}&quot;);           </span>
<span  style="">  75                                                                                                          </span>
<span class="5956354208608974741" onmouseenter="enter('5956354208608974741');" onmouseout="out('5956354208608974741');" style=""><abbr title="  76     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as timestamp)">  76     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as time🔵</abbr></span>
<span class="5956354208608974741" onmouseenter="enter('5956354208608974741');" onmouseout="out('5956354208608974741');" style=""><abbr title="  77     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as timestamp)">  77     // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as time🔵</abbr></span>
<span class="1953221153478650066" onmouseenter="enter('1953221153478650066');" onmouseout="out('1953221153478650066');" style="">  78     private static final Pattern TYPE_PATTERN = Pattern.compile(&quot;cast\\((.*) as (.*)\\)&quot;);               </span>
<span  style="">  79                                                                                                          </span>
<span class="-7138373001176335296" onmouseenter="enter('-7138373001176335296');" onmouseout="out('-7138373001176335296');" style="">  80     // specific type which values need to be quoted                                                      </span>
<span class="-3819896996042674452" onmouseenter="enter('-3819896996042674452');" onmouseout="out('-3819896996042674452');" style=""><abbr title="  81     private static final String[] NEED_QUOTE_TYPE = new java.lang.String[]{ &quot;string&quot;, &quot;timestamp&quot;, &quot;varchar&quot; };">  81     private static final String[] NEED_QUOTE_TYPE = new java.lang.String[]{ &quot;string&quot;, &quot;timestamp&quot;, &quot;varch🔵</abbr></span>
<span  style="">  82                                                                                                          </span>
<span class="191207487610103693" onmouseenter="enter('191207487610103693');" onmouseout="out('191207487610103693');" style="">  83     private static final Integer DEFAULT_CONN_TIME_OUT = 60;                                             </span>
<span  style="">  84                                                                                                          </span>
<span class="-1388186840411616756" onmouseenter="enter('-1388186840411616756');" onmouseout="out('-1388186840411616756');" style="">  85     private static final int RECEIVE_DATA_PRINT_FREQUENCY = 1000;                                        </span>
<span  style="">  86                                                                                                          </span>
<span class="-4268888009857984730" onmouseenter="enter('-4268888009857984730');" onmouseout="out('-4268888009857984730');" style="">  87     private static final int DIRTY_DATA_PRINT_FREQUENCY = 1000;                                          </span>
<span  style="">  88                                                                                                          </span>
<span class="-588818051573867979" onmouseenter="enter('-588818051573867979');" onmouseout="out('-588818051573867979');" style="">  89     private static final String KUDU_TYPE = &quot;kudu&quot;;                                                      </span>
<span  style="">  90                                                                                                          </span>
<span class="-6769623881035360393" onmouseenter="enter('-6769623881035360393');" onmouseout="out('-6769623881035360393');" style="">  91     private static final String UPDATE_MODE = &quot;update&quot;;                                                  </span>
<span  style="">  92                                                                                                          </span>
<span class="-7709014261424944614" onmouseenter="enter('-7709014261424944614');" onmouseout="out('-7709014261424944614');" style="">  93     private static final String PARTITION_CONSTANT = &quot;PARTITION&quot;;                                        </span>
<span  style="">  94                                                                                                          </span>
<span class="1441081326157561113" onmouseenter="enter('1441081326157561113');" onmouseout="out('1441081326157561113');" style="">  95     private static final String DRIVER_NAME = &quot;com.cloudera.impala.jdbc41.Driver&quot;;                       </span>
<span  style="">  96                                                                                                          </span>
<span class="-2689163518074835497" onmouseenter="enter('-2689163518074835497');" onmouseout="out('-2689163518074835497');" style="">  97     private static final String VALUES_CONDITION = &quot;${valuesCondition}&quot;;                                 </span>
<span  style="">  98                                                                                                          </span>
<span class="3062777246713899037" onmouseenter="enter('3062777246713899037');" onmouseout="out('3062777246713899037');" style="">  99     private static final String PARTITION_CONDITION = &quot;${partitionCondition}&quot;;                           </span>
<span  style=""> 100                                                                                                          </span>
<span class="2401236240707522557" onmouseenter="enter('2401236240707522557');" onmouseout="out('2401236240707522557');" style=""> 101     private static final String TABLE_FIELDS_CONDITION = &quot;${tableFieldsCondition}&quot;;                      </span>
<span  style=""> 102                                                                                                          </span>
<span class="3255739684264436552" onmouseenter="enter('3255739684264436552');" onmouseout="out('3255739684264436552');" style=""> 103     private static final String NO_PARTITION = &quot;noPartition&quot;;                                            </span>
<span  style=""> 104                                                                                                          </span>
<span class="-7445073777200404714" onmouseenter="enter('-7445073777200404714');" onmouseout="out('-7445073777200404714');" style=""> 105     protected transient Connection connection;                                                           </span>
<span  style=""> 106                                                                                                          </span>
<span class="-2184169902108079684" onmouseenter="enter('-2184169902108079684');" onmouseout="out('-2184169902108079684');" style=""> 107     protected transient Statement statement;                                                             </span>
<span  style=""> 108                                                                                                          </span>
<span class="6238382839663594696" onmouseenter="enter('6238382839663594696');" onmouseout="out('6238382839663594696');" style=""> 109     protected transient PreparedStatement updateStatement;                                               </span>
<span  style=""> 110                                                                                                          </span>
<span class="4293032579277507790" onmouseenter="enter('4293032579277507790');" onmouseout="out('4293032579277507790');" style=""> 111     private transient volatile boolean closed = false;                                                   </span>
<span  style=""> 112                                                                                                          </span>
<span class="8220840984571392918" onmouseenter="enter('8220840984571392918');" onmouseout="out('8220840984571392918');" style=""> 113     private int batchCount = 0;                                                                          </span>
<span  style=""> 114                                                                                                          </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style=""> 115     // |------------------------------------------------|                                                </span>
<span class="-789927222958732888" onmouseenter="enter('-789927222958732888');" onmouseout="out('-789927222958732888');" style=""> 116     // |   partitionCondition   |Array of valueCondition|                                                </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style=""> 117     // |------------------------------------------------|                                                </span>
<span class="-8825804998995953162" onmouseenter="enter('-8825804998995953162');" onmouseout="out('-8825804998995953162');" style=""> 118     // | ptOne, ptTwo, ptThree  | [(v1, v2, v3, v4, v5)]|   DP                                           </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style=""> 119     // |------------------------------------------------|                                                </span>
<span class="-5802382310877164118" onmouseenter="enter('-5802382310877164118');" onmouseout="out('-5802382310877164118');" style=""> 120     // | ptOne = v1, ptTwo = v2 | [(v3, v4, v5)]        |   SP                                           </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style=""> 121     // |------------------------------------------------|                                                </span>
<span class="2984234039288316275" onmouseenter="enter('2984234039288316275');" onmouseout="out('2984234039288316275');" style=""> 122     // | ptOne, ptTwo = v2      | [(v1, v3, v4, v5)]    |   DP and SP                                    </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style=""> 123     // |------------------------------------------------|                                                </span>
<span class="7219405512764117222" onmouseenter="enter('7219405512764117222');" onmouseout="out('7219405512764117222');" style=""> 124     // | noPartition            | [(v1, v2, v3, v4, v5)]|   kudu or disablePartition                     </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style=""> 125     // |------------------------------------------------|                                                </span>
<span class="9020411500856357590" onmouseenter="enter('9020411500856357590');" onmouseout="out('9020411500856357590');" style=""> 126     private transient Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap;                                         </span>
<span  style=""> 127                                                                                                          </span>
<span class="-4172535577750872346" onmouseenter="enter('-4172535577750872346');" onmouseout="out('-4172535577750872346');" style=""> 128     protected String keytabPath;                                                                         </span>
<span  style=""> 129                                                                                                          </span>
<span class="1987487277257130103" onmouseenter="enter('1987487277257130103');" onmouseout="out('1987487277257130103');" style=""> 130     protected String krb5confPath;                                                                       </span>
<span  style=""> 131                                                                                                          </span>
<span class="3478885111338451838" onmouseenter="enter('3478885111338451838');" onmouseout="out('3478885111338451838');" style=""> 132     protected String principal;                                                                          </span>
<span  style=""> 133                                                                                                          </span>
<span class="-2673327721248325609" onmouseenter="enter('-2673327721248325609');" onmouseout="out('-2673327721248325609');" style=""> 134     protected Integer authMech;                                                                          </span>
<span  style=""> 135                                                                                                          </span>
<span class="-8834882937031238604" onmouseenter="enter('-8834882937031238604');" onmouseout="out('-8834882937031238604');" style=""> 136     protected String dbUrl;                                                                              </span>
<span  style=""> 137                                                                                                          </span>
<span class="4348689613054045460" onmouseenter="enter('4348689613054045460');" onmouseout="out('4348689613054045460');" style=""> 138     protected String userName;                                                                           </span>
<span  style=""> 139                                                                                                          </span>
<span class="519247125889688558" onmouseenter="enter('519247125889688558');" onmouseout="out('519247125889688558');" style=""> 140     protected String password;                                                                           </span>
<span  style=""> 141                                                                                                          </span>
<span class="-7554929939288236010" onmouseenter="enter('-7554929939288236010');" onmouseout="out('-7554929939288236010');" style=""> 142     protected int batchSize = 100;                                                                       </span>
<span  style=""> 143                                                                                                          </span>
<span class="8848445520039039194" onmouseenter="enter('8848445520039039194');" onmouseout="out('8848445520039039194');" style=""> 144     protected long batchWaitInterval = 60 * 1000L;                                                       </span>
<span  style=""> 145                                                                                                          </span>
<span class="6924126392600265325" onmouseenter="enter('6924126392600265325');" onmouseout="out('6924126392600265325');" style=""> 146     protected String tableName;                                                                          </span>
<span  style=""> 147                                                                                                          </span>
<span class="-8067881189136281922" onmouseenter="enter('-8067881189136281922');" onmouseout="out('-8067881189136281922');" style=""> 148     protected List&lt;String&gt; primaryKeys;                                                                  </span>
<span  style=""> 149                                                                                                          </span>
<span class="-1238809985534246985" onmouseenter="enter('-1238809985534246985');" onmouseout="out('-1238809985534246985');" style=""> 150     protected String partitionFields;                                                                    </span>
<span  style=""> 151                                                                                                          </span>
<span class="-2843446813182919439" onmouseenter="enter('-2843446813182919439');" onmouseout="out('-2843446813182919439');" style=""> 152     protected Boolean enablePartition;                                                                   </span>
<span  style=""> 153                                                                                                          </span>
<span class="3349082107931708476" onmouseenter="enter('3349082107931708476');" onmouseout="out('3349082107931708476');" style=""> 154     protected String schema;                                                                             </span>
<span  style=""> 155                                                                                                          </span>
<span class="-2869920961807604939" onmouseenter="enter('-2869920961807604939');" onmouseout="out('-2869920961807604939');" style=""> 156     protected String storeType;                                                                          </span>
<span  style=""> 157                                                                                                          </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style=""> 158         protected String updateMode;                                                                     </span>
<span  style=""> 159                                                                                                          </span>
<span class="8729932671243795004" onmouseenter="enter('8729932671243795004');" onmouseout="out('8729932671243795004');" style=""> 160     public List&lt;String&gt; fieldNames;                                                                      </span>
<span  style=""> 161                                                                                                          </span>
<span class="5323664213258183290" onmouseenter="enter('5323664213258183290');" onmouseout="out('5323664213258183290');" style=""> 162     public List&lt;String&gt; fieldTypes;                                                                      </span>
<span  style=""> 163                                                                                                          </span>
<span class="589573262942162938" onmouseenter="enter('589573262942162938');" onmouseout="out('589573262942162938');" style=""> 164     public List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList;                                    </span>
<span  style=""> 165                                                                                                          </span>
<span class="-2123205835999557493" onmouseenter="enter('-2123205835999557493');" onmouseout="out('-2123205835999557493');" style=""> 166     // partition field of static partition which matched by ${field}                                     </span>
<span class="-2123205835999557493" onmouseenter="enter('-2123205835999557493');" onmouseout="out('-2123205835999557493');" style=""> 167     // partition field of static partition which matched by ${field}                                     </span>
<span class="-976040292573398488" onmouseenter="enter('-976040292573398488');" onmouseout="out('-976040292573398488');" style=""> 168     private final List&lt;String&gt; staticPartitionFields = new ArrayList&lt;&gt;();                                </span>
<span  style=""> 169                                                                                                          </span>
<span class="8461763253073029471" onmouseenter="enter('8461763253073029471');" onmouseout="out('8461763253073029471');" style=""> 170     // valueFieldsName -&gt; 重组之后的fieldNames，为了重组row data字段值对应                                              </span>
<span class="-5473349939362349748" onmouseenter="enter('-5473349939362349748');" onmouseout="out('-5473349939362349748');" style=""> 171     // 需要对partition字段做特殊处理，比如原来的字段顺序为(age, name, id)，但是因为partition，写入的SQL为                               </span>
<span class="888010466316090175" onmouseenter="enter('888010466316090175');" onmouseout="out('888010466316090175');" style=""> 172     // INSERT INTO tableName(name, id) PARTITION(age) VALUES(?, ?, ?)                                    </span>
<span class="1229277488566704041" onmouseenter="enter('1229277488566704041');" onmouseout="out('1229277488566704041');" style=""> 173     // 那么实际executeSql设置字段的顺序应该为(name, id, age)，同时，字段对应的type顺序也需要重组                                       </span>
<span class="6098973354216055964" onmouseenter="enter('6098973354216055964');" onmouseout="out('6098973354216055964');" style=""> 174     private List&lt;String&gt; valueFieldNames;                                                                </span>
<span  style=""> 175                                                                                                          </span>
<span class="-7108089166418781511" onmouseenter="enter('-7108089166418781511');" onmouseout="out('-7108089166418781511');" style=""> 176     private transient AbstractDtRichOutputFormat&lt;?&gt; metricOutputFormat;                                  </span>
<span  style=""> 177                                                                                                          </span>
<span class="273368026714901275" onmouseenter="enter('273368026714901275');" onmouseout="out('273368026714901275');" style=""> 178     private List&lt;Row&gt; rows;                                                                              </span>
<span  style=""> 179                                                                                                          </span>
<span class="9015955711937997200" onmouseenter="enter('9015955711937997200');" onmouseout="out('9015955711937997200');" style=""> 180     private transient ScheduledExecutorService scheduler;                                                </span>
<span  style=""> 181                                                                                                          </span>
<span class="-5761494216005426476" onmouseenter="enter('-5761494216005426476');" onmouseout="out('-5761494216005426476');" style=""> 182     private transient ScheduledFuture&lt;?&gt; scheduledFuture;                                                </span>
<span  style=""> 183                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 184     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style=""> 185     public void configure(Configuration parameters) {                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186     }                                                                                                    </span>
<span  style=""> 187                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 188     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style=""> 189     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 190         try {                                                                                            </span>
<span class="4324779626821739975" onmouseenter="enter('4324779626821739975');" onmouseout="out('4324779626821739975');" style=""> 191             rowDataMap = new HashMap&lt;&gt;();                                                                </span>
<span class="-6551372933934183741" onmouseenter="enter('-6551372933934183741');" onmouseout="out('-6551372933934183741');" style=""> 192             rows = new ArrayList&lt;&gt;();                                                                    </span>
<span class="-7937337195293668220" onmouseenter="enter('-7937337195293668220');" onmouseout="out('-7937337195293668220');" style=""> 193             metricOutputFormat = this;                                                                   </span>
<span class="-8035752082134444550" onmouseenter="enter('-8035752082134444550');" onmouseout="out('-8035752082134444550');" style=""> 194             openConnect();                                                                               </span>
<span class="-3251827356232524015" onmouseenter="enter('-3251827356232524015');" onmouseout="out('-3251827356232524015');" style=""> 195             initScheduledTask(batchWaitInterval);                                                        </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 196             init();                                                                                      </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style=""> 197             initMetric();                                                                                </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 198         } catch (java.lang.Exception e) {                                                                </span>
<span class="-105883012207117402" onmouseenter="enter('-105883012207117402');" onmouseout="out('-105883012207117402');" style=""> 199             throw new RuntimeException(&quot;impala output format open error!&quot;, e);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201     }                                                                                                    </span>
<span  style=""> 202                                                                                                          </span>
<span class="-8578201295687943948" onmouseenter="enter('-8578201295687943948');" onmouseout="out('-8578201295687943948');" style=""> 203     private void init() throws SQLException {                                                            </span>
<span class="-8350145873279772804" onmouseenter="enter('-8350145873279772804');" onmouseout="out('-8350145873279772804');" style=""> 204         if (Objects.nonNull(partitionFields)) {                                                          </span>
<span class="8590422903839909721" onmouseenter="enter('8590422903839909721');" onmouseout="out('8590422903839909721');" style=""> 205             // match ${field} from partitionFields                                                       </span>
<span class="399614494149678967" onmouseenter="enter('399614494149678967');" onmouseout="out('399614494149678967');" style=""> 206             Matcher matcher = STATIC_PARTITION_PATTERN.matcher(partitionFields);                         </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 207             while (matcher.find()) {                                                                     </span>
<span class="-1180668930060799754" onmouseenter="enter('-1180668930060799754');" onmouseout="out('-1180668930060799754');" style=""> 208                 LOG.info(&quot;find static partition field: {}&quot;, matcher.group(1));                           </span>
<span class="5933786634924389530" onmouseenter="enter('5933786634924389530');" onmouseout="out('5933786634924389530');" style=""> 209                 staticPartitionFields.add(matcher.group(1));                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span  style=""> 212                                                                                                          </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style=""> 213         if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                                  </span>
<span class="-511688609314859464" onmouseenter="enter('-511688609314859464');" onmouseout="out('-511688609314859464');" style=""> 214             if (!storeType.equalsIgnoreCase(KUDU_TYPE)) {                                                </span>
<span class="7738691828431171650" onmouseenter="enter('7738691828431171650');" onmouseout="out('7738691828431171650');" style=""> 215                 throw new IllegalArgumentException(&quot;update mode not support for non-kudu table!&quot;);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216             }                                                                                            </span>
<span  style=""> 217                                                                                                          </span>
<span class="-1926567860735108753" onmouseenter="enter('-1926567860735108753');" onmouseout="out('-1926567860735108753');" style=""><abbr title=" 218             updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, primaryKeys));"> 218             updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, p🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 219             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220         }                                                                                                </span>
<span  style=""> 221                                                                                                          </span>
<span class="5264299831364970974" onmouseenter="enter('5264299831364970974');" onmouseout="out('5264299831364970974');" style=""><abbr title=" 222         valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, partitionFields);"> 222         valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223     }                                                                                                    </span>
<span  style=""> 224                                                                                                          </span>
<span class="-4335191442342413864" onmouseenter="enter('-4335191442342413864');" onmouseout="out('-4335191442342413864');" style=""> 225     private void initScheduledTask(Long batchWaitInterval) {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 226         try {                                                                                            </span>
<span class="-5481453632006175071" onmouseenter="enter('-5481453632006175071');" onmouseout="out('-5481453632006175071');" style=""> 227             if (batchWaitInterval != 0) {                                                                </span>
<span class="4268939604870549239" onmouseenter="enter('4268939604870549239');" onmouseout="out('4268939604870549239');" style=""><abbr title=" 228                 this.scheduler = new ScheduledThreadPoolExecutor(1, new DTThreadFactory(&quot;impala-upsert-output-format&quot;));"> 228                 this.scheduler = new ScheduledThreadPoolExecutor(1, new DTThreadFactory(&quot;impala-upsert-ou🔵</abbr></span>
<span class="-7149116985444787635" onmouseenter="enter('-7149116985444787635');" onmouseout="out('-7149116985444787635');" style=""> 229                 this.scheduledFuture = this.scheduler.scheduleWithFixedDelay(() -&gt; {                     </span>
<span class="2782390661741246227" onmouseenter="enter('2782390661741246227');" onmouseout="out('2782390661741246227');" style=""> 230                     synchronized(this) {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 231                         try {                                                                            </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style=""> 232                             flush();                                                                     </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 233                         } catch (java.lang.Exception e) {                                                </span>
<span class="-5628183046854957718" onmouseenter="enter('-5628183046854957718');" onmouseout="out('-5628183046854957718');" style=""> 234                             LOG.error(&quot;Writing records to impala jdbc failed.&quot;, e);                      </span>
<span class="-7023774051195191894" onmouseenter="enter('-7023774051195191894');" onmouseout="out('-7023774051195191894');" style=""> 235                             throw new RuntimeException(&quot;Writing records to impala jdbc failed.&quot;, e);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237                     }                                                                                    </span>
<span class="8465771028460365894" onmouseenter="enter('8465771028460365894');" onmouseout="out('8465771028460365894');" style=""> 238                 }, batchWaitInterval, batchWaitInterval, TimeUnit.MILLISECONDS);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239             }                                                                                            </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 240         } catch (java.lang.Exception e) {                                                                </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style=""> 241             throw new RuntimeException(e);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243     }                                                                                                    </span>
<span  style=""> 244                                                                                                          </span>
<span class="-2844613068709206340" onmouseenter="enter('-2844613068709206340');" onmouseout="out('-2844613068709206340');" style=""> 245     private void openConnect() throws IOException {                                                      </span>
<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style=""> 246         if (authMech == 1) {                                                                             </span>
<span class="-7445609792053649263" onmouseenter="enter('-7445609792053649263');" onmouseout="out('-7445609792053649263');" style=""> 247             UserGroupInformation ugi = KrbUtils.loginAndReturnUgi(principal, keytabPath, krb5confPath);  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 248             try {                                                                                        </span>
<span class="5677157110288133572" onmouseenter="enter('5677157110288133572');" onmouseout="out('5677157110288133572');" style=""> 249                 ugi.doAs(((PrivilegedExceptionAction&lt;Void&gt;) (() -&gt; {                                     </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style=""> 250                     openJdbc();                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 251                     return null;                                                                         </span>
<span class="-2540327120317221694" onmouseenter="enter('-2540327120317221694');" onmouseout="out('-2540327120317221694');" style=""> 252                 })));                                                                                    </span>
<span class="-4014377831460271002" onmouseenter="enter('-4014377831460271002');" onmouseout="out('-4014377831460271002');" style=""> 253             } catch (java.lang.InterruptedException | IOException e) {                                   </span>
<span class="-3216725393010457363" onmouseenter="enter('-3216725393010457363');" onmouseout="out('-3216725393010457363');" style=""> 254                 throw new IllegalArgumentException(&quot;connect impala error!&quot;, e);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 256         } else {                                                                                         </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style=""> 257             openJdbc();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259     }                                                                                                    </span>
<span  style=""> 260                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 261     /**                                                                                                  </span>
<span class="-4019084214603833891" onmouseenter="enter('-4019084214603833891');" onmouseout="out('-4019084214603833891');" style=""> 262      * get jdbc connection                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 263      */                                                                                                  </span>
<span class="6517717324631316532" onmouseenter="enter('6517717324631316532');" onmouseout="out('6517717324631316532');" style=""> 264     private void openJdbc() {                                                                            </span>
<span class="-5989471214664392944" onmouseenter="enter('-5989471214664392944');" onmouseout="out('-5989471214664392944');" style=""> 265         JDBCUtils.forName(DRIVER_NAME, getClass().getClassLoader());                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 266         try {                                                                                            </span>
<span class="-4188974437029144237" onmouseenter="enter('-4188974437029144237');" onmouseout="out('-4188974437029144237');" style=""> 267             connection = DriverManager.getConnection(dbUrl, userName, password);                         </span>
<span class="-3909190598463408725" onmouseenter="enter('-3909190598463408725');" onmouseout="out('-3909190598463408725');" style=""> 268             statement = connection.createStatement();                                                    </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style=""> 269             connection.setAutoCommit(false);                                                             </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style=""> 270         } catch (SQLException sqlException) {                                                            </span>
<span class="8417232372887360387" onmouseenter="enter('8417232372887360387');" onmouseout="out('8417232372887360387');" style=""> 271             throw new RuntimeException(&quot;get impala jdbc connection failed!&quot;, sqlException);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="7521208138226245516" onmouseenter="enter('7521208138226245516');" onmouseout="out('7521208138226245516');" style=""> 275     private void flush() throws Exception {                                                              </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style=""> 276         if (batchCount &gt; 0) {                                                                            </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style=""> 277             if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                              </span>
<span class="-7210745719484505959" onmouseenter="enter('-7210745719484505959');" onmouseout="out('-7210745719484505959');" style=""> 278                 executeUpdateBatch();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279             }                                                                                            </span>
<span class="-5565980137871755476" onmouseenter="enter('-5565980137871755476');" onmouseout="out('-5565980137871755476');" style=""> 280             if (!rowDataMap.isEmpty()) {                                                                 </span>
<span class="8546814641173072756" onmouseenter="enter('8546814641173072756');" onmouseout="out('8546814641173072756');" style=""> 281                 String templateSql =                                                                     </span>
<span class="-1766017053596733683" onmouseenter="enter('-1766017053596733683');" onmouseout="out('-1766017053596733683');" style=""><abbr title=" 282                         &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VALUES ${valuesCondition}&quot;;"> 282                         &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VA🔵</abbr></span>
<span class="7007887973141057675" onmouseenter="enter('7007887973141057675');" onmouseout="out('7007887973141057675');" style=""> 283                 executeBatchSql(                                                                         </span>
<span class="839015566868436312" onmouseenter="enter('839015566868436312');" onmouseout="out('839015566868436312');" style=""> 284                         statement,                                                                       </span>
<span class="-8931083358346849072" onmouseenter="enter('-8931083358346849072');" onmouseout="out('-8931083358346849072');" style=""> 285                         templateSql,                                                                     </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style=""> 286                         schema,                                                                          </span>
<span class="8599198975592615021" onmouseenter="enter('8599198975592615021');" onmouseout="out('8599198975592615021');" style=""> 287                         tableName,                                                                       </span>
<span class="7739930709415439240" onmouseenter="enter('7739930709415439240');" onmouseout="out('7739930709415439240');" style=""> 288                         storeType,                                                                       </span>
<span class="4460343981916954231" onmouseenter="enter('4460343981916954231');" onmouseout="out('4460343981916954231');" style=""> 289                         enablePartition,                                                                 </span>
<span class="-232795436679668454" onmouseenter="enter('-232795436679668454');" onmouseout="out('-232795436679668454');" style=""> 290                         valueFieldNames,                                                                 </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style=""> 291                         partitionFields,                                                                 </span>
<span class="-163268273074797630" onmouseenter="enter('-163268273074797630');" onmouseout="out('-163268273074797630');" style=""> 292                         rowDataMap                                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 293                 );                                                                                       </span>
<span class="1629791312198735010" onmouseenter="enter('1629791312198735010');" onmouseout="out('1629791312198735010');" style=""> 294                 rowDataMap.clear();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296         }                                                                                                </span>
<span class="-5311733944590264805" onmouseenter="enter('-5311733944590264805');" onmouseout="out('-5311733944590264805');" style=""> 297         batchCount = 0;                                                                                  </span>
<span  style=""> 298                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299     }                                                                                                    </span>
<span  style=""> 300                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 301     /**                                                                                                  </span>
<span class="-1106181825212481278" onmouseenter="enter('-1106181825212481278');" onmouseout="out('-1106181825212481278');" style=""> 302      * execute batch update statement                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 303      *                                                                                                   </span>
<span class="3560665881375675274" onmouseenter="enter('3560665881375675274');" onmouseout="out('3560665881375675274');" style=""> 304      * @throws SQLException throw sql exception                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 305      */                                                                                                  </span>
<span class="3206601587144870407" onmouseenter="enter('3206601587144870407');" onmouseout="out('3206601587144870407');" style=""> 306     private void executeUpdateBatch() throws SQLException {                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 307         try {                                                                                            </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style=""> 308             rows.forEach(row -&gt; {                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 309                 try {                                                                                    </span>
<span class="-1215139546593028546" onmouseenter="enter('-1215139546593028546');" onmouseout="out('-1215139546593028546');" style=""> 310                     JDBCTypeConvertUtils.setRecordToStatement(                                           </span>
<span class="-4710389352980966846" onmouseenter="enter('-4710389352980966846');" onmouseout="out('-4710389352980966846');" style=""> 311                             updateStatement,                                                             </span>
<span class="4668718668329814914" onmouseenter="enter('4668718668329814914');" onmouseout="out('4668718668329814914');" style=""> 312                             JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes),                    </span>
<span class="-7576027683765873339" onmouseenter="enter('-7576027683765873339');" onmouseout="out('-7576027683765873339');" style=""> 313                             row,                                                                         </span>
<span class="-255277236311302851" onmouseenter="enter('-255277236311302851');" onmouseout="out('-255277236311302851');" style=""> 314                             primaryKeys.stream().mapToInt(fieldNames::indexOf).toArray()                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 315                     );                                                                                   </span>
<span class="-4238050377414791796" onmouseenter="enter('-4238050377414791796');" onmouseout="out('-4238050377414791796');" style=""> 316                     updateStatement.addBatch();                                                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 317                 } catch (Exception e) {                                                                  </span>
<span class="5068376771892501659" onmouseenter="enter('5068376771892501659');" onmouseout="out('5068376771892501659');" style=""> 318                     throw new RuntimeException(&quot;impala jdbc execute batch error!&quot;, e);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 320             });                                                                                          </span>
<span class="-3747739502872154032" onmouseenter="enter('-3747739502872154032');" onmouseout="out('-3747739502872154032');" style=""> 321             updateStatement.executeBatch();                                                              </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 322             connection.commit();                                                                         </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style=""> 323             rows.clear();                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 324         } catch (Exception e) {                                                                          </span>
<span class="1715728751446881781" onmouseenter="enter('1715728751446881781');" onmouseout="out('1715728751446881781');" style=""> 325             LOG.debug(&quot;impala jdbc execute batch error &quot;, e);                                            </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style=""> 326             connection.rollback();                                                                       </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 327             connection.commit();                                                                         </span>
<span class="-4187732730208785389" onmouseenter="enter('-4187732730208785389');" onmouseout="out('-4187732730208785389');" style=""> 328             updateStatement.clearBatch();                                                                </span>
<span class="-8814080953460465644" onmouseenter="enter('-8814080953460465644');" onmouseout="out('-8814080953460465644');" style=""> 329             executeUpdate(connection);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331     }                                                                                                    </span>
<span  style=""> 332                                                                                                          </span>
<span class="-4847686400566224446" onmouseenter="enter('-4847686400566224446');" onmouseout="out('-4847686400566224446');" style=""> 333     public void executeUpdate(Connection connection) {                                                   </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style=""> 334         rows.forEach(row -&gt; {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 335             try {                                                                                        </span>
<span class="3018395377218617369" onmouseenter="enter('3018395377218617369');" onmouseout="out('3018395377218617369');" style=""><abbr title=" 336                 setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes), row);"> 336                 setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldT🔵</abbr></span>
<span class="-6547782628025070914" onmouseenter="enter('-6547782628025070914');" onmouseout="out('-6547782628025070914');" style=""> 337                 updateStatement.executeUpdate();                                                         </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 338                 connection.commit();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 339             } catch (Exception e) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 340                 try {                                                                                    </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style=""> 341                     connection.rollback();                                                               </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style=""> 342                     connection.commit();                                                                 </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style=""> 343                 } catch (SQLException e1) {                                                              </span>
<span class="-2635323073569974258" onmouseenter="enter('-2635323073569974258');" onmouseout="out('-2635323073569974258');" style=""> 344                     throw new RuntimeException(e1);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345                 }                                                                                        </span>
<span class="-4808081927273297919" onmouseenter="enter('-4808081927273297919');" onmouseout="out('-4808081927273297919');" style=""><abbr title=" 346                 if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {"> 346                 if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LO🔵</abbr></span>
<span class="-2764908242367356599" onmouseenter="enter('-2764908242367356599');" onmouseout="out('-2764908242367356599');" style=""> 347                     LOG.error(&quot;record insert failed ,this row is {}&quot;, row.toString());                   </span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style=""> 348                     LOG.error(&quot;&quot;, e);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349                 }                                                                                        </span>
<span class="-8596285303698617705" onmouseenter="enter('-8596285303698617705');" onmouseout="out('-8596285303698617705');" style=""> 350                 metricOutputFormat.outDirtyRecords.inc();                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 352         });                                                                                              </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style=""> 353         rows.clear();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354     }                                                                                                    </span>
<span  style=""> 355                                                                                                          </span>
<span class="5541545914698662583" onmouseenter="enter('5541545914698662583');" onmouseout="out('5541545914698662583');" style=""><abbr title=" 356     private void putRowIntoMap(Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap, Tuple2&lt;String, String&gt; rowData) {"> 356     private void putRowIntoMap(Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap, Tuple2&lt;String, String&gt; rowData)🔵</abbr></span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style=""> 357         Set&lt;String&gt; keySet = rowDataMap.keySet();                                                        </span>
<span class="-4115511162008757651" onmouseenter="enter('-4115511162008757651');" onmouseout="out('-4115511162008757651');" style=""> 358         ArrayList&lt;String&gt; tempRowArray;                                                                  </span>
<span class="-6312285345137005178" onmouseenter="enter('-6312285345137005178');" onmouseout="out('-6312285345137005178');" style=""> 359         if (keySet.contains(rowData.f0)) {                                                               </span>
<span class="2063657660163215007" onmouseenter="enter('2063657660163215007');" onmouseout="out('2063657660163215007');" style=""> 360             tempRowArray = rowDataMap.get(rowData.f0);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 361         } else {                                                                                         </span>
<span class="7109917545131433172" onmouseenter="enter('7109917545131433172');" onmouseout="out('7109917545131433172');" style=""> 362             tempRowArray = new ArrayList&lt;&gt;();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363         }                                                                                                </span>
<span class="1467529594977533778" onmouseenter="enter('1467529594977533778');" onmouseout="out('1467529594977533778');" style=""> 364         tempRowArray.add(rowData.f1);                                                                    </span>
<span class="6767865840186405987" onmouseenter="enter('6767865840186405987');" onmouseout="out('6767865840186405987');" style=""> 365         rowDataMap.put(rowData.f0, tempRowArray);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366     }                                                                                                    </span>
<span  style=""> 367                                                                                                          </span>
<span class="3578278218776325408" onmouseenter="enter('3578278218776325408');" onmouseout="out('3578278218776325408');" style=""><abbr title=" 368     private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPartitionFields, List&lt;String&gt; fieldTypes, String partitionFields) {"> 368     private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPart🔵</abbr></span>
<span class="-9170183165643435780" onmouseenter="enter('-9170183165643435780');" onmouseout="out('-9170183165643435780');" style=""> 369         if (partitionFields.isEmpty()) {                                                                 </span>
<span class="2916035488958294792" onmouseenter="enter('2916035488958294792');" onmouseout="out('2916035488958294792');" style=""> 370             return fieldNames;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371         }                                                                                                </span>
<span class="7990418778069769767" onmouseenter="enter('7990418778069769767');" onmouseout="out('7990418778069769767');" style=""> 372         List&lt;String&gt; valueFields = new ArrayList&lt;&gt;(fieldNames);                                          </span>
<span class="2302239674432319726" onmouseenter="enter('2302239674432319726');" onmouseout="out('2302239674432319726');" style=""> 373         for (int i = valueFields.size() - 1; i &gt;= 0; i--) {                                              </span>
<span class="-8004931019804249555" onmouseenter="enter('-8004931019804249555');" onmouseout="out('-8004931019804249555');" style=""> 374             if (staticPartitionFields.contains(fieldNames.get(i))) {                                     </span>
<span class="-3872161480019783193" onmouseenter="enter('-3872161480019783193');" onmouseout="out('-3872161480019783193');" style=""> 375                 valueFields.remove(i);                                                                   </span>
<span class="5504621354582269117" onmouseenter="enter('5504621354582269117');" onmouseout="out('5504621354582269117');" style=""> 376                 fieldTypes.remove(i);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378         }                                                                                                </span>
<span class="8724369392835521335" onmouseenter="enter('8724369392835521335');" onmouseout="out('8724369392835521335');" style=""> 379         for (int i = 0; i &lt; valueFields.size(); i++) {                                                   </span>
<span class="4573573241123850638" onmouseenter="enter('4573573241123850638');" onmouseout="out('4573573241123850638');" style=""> 380             if (partitionFields.contains(fieldNames.get(i))) {                                           </span>
<span class="-6733214010943616061" onmouseenter="enter('-6733214010943616061');" onmouseout="out('-6733214010943616061');" style=""> 381                 valueFields.add(valueFields.remove(i));                                                  </span>
<span class="3100686975272655596" onmouseenter="enter('3100686975272655596');" onmouseout="out('3100686975272655596');" style=""> 382                 fieldTypes.add(fieldTypes.remove(i));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384         }                                                                                                </span>
<span class="-4055330890426471630" onmouseenter="enter('-4055330890426471630');" onmouseout="out('-4055330890426471630');" style=""> 385         return valueFields;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386     }                                                                                                    </span>
<span  style=""> 387                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 388     /**                                                                                                  </span>
<span class="-8974785826875952090" onmouseenter="enter('-8974785826875952090');" onmouseout="out('-8974785826875952090');" style=""> 389      * Quote a specific type of value, like string, timestamp                                            </span>
<span class="-6015231753011783708" onmouseenter="enter('-6015231753011783708');" onmouseout="out('-6015231753011783708');" style=""> 390      * before: 1, cast(tiezhu as string), cast(2001-01-09 01:05:01 as timestamp), cast(123 as int)       </span>
<span class="-9072843877687738552" onmouseenter="enter('-9072843877687738552');" onmouseout="out('-9072843877687738552');" style=""> 391      * after: 1, cast(&#x27;tiezhu&#x27; as string), cast(&#x27;2001-01-09 01:05:01&#x27; as timestamp), cast(123 as int)    </span>
<span class="1334750812652161584" onmouseenter="enter('1334750812652161584');" onmouseout="out('1334750812652161584');" style=""> 392      * if cast value is null, then cast(null as type)                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 393      *                                                                                                   </span>
<span class="-7193371921927395943" onmouseenter="enter('-7193371921927395943');" onmouseout="out('-7193371921927395943');" style=""> 394      * @param valueCondition original value condition                                                    </span>
<span class="-4015247136226058388" onmouseenter="enter('-4015247136226058388');" onmouseout="out('-4015247136226058388');" style=""> 395      * @return quoted condition                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 396      */                                                                                                  </span>
<span class="-8514684189215878898" onmouseenter="enter('-8514684189215878898');" onmouseout="out('-8514684189215878898');" style=""> 397     private String valueConditionAddQuotation(String valueCondition) {                                   </span>
<span class="-7296893889335175056" onmouseenter="enter('-7296893889335175056');" onmouseout="out('-7296893889335175056');" style=""> 398         String[] temps = valueCondition.split(&quot;,&quot;);                                                      </span>
<span class="936116613567496626" onmouseenter="enter('936116613567496626');" onmouseout="out('936116613567496626');" style=""> 399         List&lt;String&gt; replacedItem = new ArrayList&lt;&gt;();                                                   </span>
<span class="-6769405222823700881" onmouseenter="enter('-6769405222823700881');" onmouseout="out('-6769405222823700881');" style=""> 400         Arrays.stream(temps).forEach(( item) -&gt; {                                                        </span>
<span class="-4536988729093203149" onmouseenter="enter('-4536988729093203149');" onmouseout="out('-4536988729093203149');" style=""> 401             Matcher matcher = TYPE_PATTERN.matcher(item);                                                </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 402             while (matcher.find()) {                                                                     </span>
<span class="4482463139402405127" onmouseenter="enter('4482463139402405127');" onmouseout="out('4482463139402405127');" style=""> 403                 String value = matcher.group(1);                                                         </span>
<span class="-7401464861945434758" onmouseenter="enter('-7401464861945434758');" onmouseout="out('-7401464861945434758');" style=""> 404                 String type = matcher.group(2);                                                          </span>
<span class="173086077329077799" onmouseenter="enter('173086077329077799');" onmouseout="out('173086077329077799');" style=""> 405                 for (String needQuoteType : NEED_QUOTE_TYPE) {                                           </span>
<span class="-6207157170096749111" onmouseenter="enter('-6207157170096749111');" onmouseout="out('-6207157170096749111');" style=""> 406                     if (type.contains(needQuoteType)) {                                                  </span>
<span class="8347227757103419143" onmouseenter="enter('8347227757103419143');" onmouseout="out('8347227757103419143');" style=""> 407                         if (!&quot;null&quot;.equals(value)) {                                                     </span>
<span class="-2468191617855490836" onmouseenter="enter('-2468191617855490836');" onmouseout="out('-2468191617855490836');" style=""> 408                             item = item.replace(value, (&quot;&#x27;&quot; + value) + &quot;&#x27;&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 412             }                                                                                            </span>
<span class="8193346150481678438" onmouseenter="enter('8193346150481678438');" onmouseout="out('8193346150481678438');" style=""> 413             replacedItem.add(item);                                                                      </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 414         });                                                                                              </span>
<span class="6634200804499367865" onmouseenter="enter('6634200804499367865');" onmouseout="out('6634200804499367865');" style=""> 415         return (&quot;(&quot; + String.join(&quot;, &quot;, replacedItem)) + &quot;)&quot;;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416     }                                                                                                    </span>
<span  style=""> 417                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 418     @Override                                                                                            </span>
<span class="-8766503565464123288" onmouseenter="enter('-8766503565464123288');" onmouseout="out('-8766503565464123288');" style=""> 419     public void writeRecord(Tuple2&lt;Boolean, Row&gt; record) throws IOException {                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 420         try {                                                                                            </span>
<span class="-1438543337409690372" onmouseenter="enter('-1438543337409690372');" onmouseout="out('-1438543337409690372');" style=""> 421             if (!record.f0) {                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 422                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423             }                                                                                            </span>
<span class="1798702739735824608" onmouseenter="enter('1798702739735824608');" onmouseout="out('1798702739735824608');" style=""> 424             if (((outRecords.getCount() % RECEIVE_DATA_PRINT_FREQUENCY) == 0) || LOG.isDebugEnabled()) { </span>
<span class="867853870420543335" onmouseenter="enter('867853870420543335');" onmouseout="out('867853870420543335');" style=""> 425                 LOG.info(&quot;Receive data : {}&quot;, record);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426             }                                                                                            </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style=""> 427             if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                              </span>
<span class="-4538110507205524162" onmouseenter="enter('-4538110507205524162');" onmouseout="out('-4538110507205524162');" style=""> 428                 rows.add(Row.copy(record.f1));                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 429             } else {                                                                                     </span>
<span class="-7917205410914838057" onmouseenter="enter('-7917205410914838057');" onmouseout="out('-7917205410914838057');" style=""> 430                 Map&lt;String, Object&gt; valueMap = Maps.newHashMap();                                        </span>
<span class="1869446492779313508" onmouseenter="enter('1869446492779313508');" onmouseout="out('1869446492779313508');" style=""> 431                 Row row = Row.copy(record.f1);                                                           </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style=""> 432                 for (int i = 0; i &lt; row.getArity(); i++) {                                               </span>
<span class="5876572039273015428" onmouseenter="enter('5876572039273015428');" onmouseout="out('5876572039273015428');" style=""> 433                     valueMap.put(fieldNames.get(i), row.getField(i));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434                 }                                                                                        </span>
<span class="-991390362203857814" onmouseenter="enter('-991390362203857814');" onmouseout="out('-991390362203857814');" style=""> 435                 Tuple2&lt;String, String&gt; rowTuple2 = new Tuple2&lt;&gt;();                                       </span>
<span class="2982710714467139286" onmouseenter="enter('2982710714467139286');" onmouseout="out('2982710714467139286');" style=""> 436                 if (storeType.equalsIgnoreCase(KUDU_TYPE) || (!enablePartition)) {                       </span>
<span class="-4830782679838689768" onmouseenter="enter('-4830782679838689768');" onmouseout="out('-4830782679838689768');" style=""> 437                     rowTuple2.f0 = NO_PARTITION;                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 438                 } else {                                                                                 </span>
<span class="5139395380358692168" onmouseenter="enter('5139395380358692168');" onmouseout="out('5139395380358692168');" style=""><abbr title=" 439                     rowTuple2.f0 = buildPartitionCondition(valueMap, partitionFields, staticPartitionFields);"> 439                     rowTuple2.f0 = buildPartitionCondition(valueMap, partitionFields, staticPartitionFiel🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 440                 }                                                                                        </span>
<span class="-484968884065413564" onmouseenter="enter('-484968884065413564');" onmouseout="out('-484968884065413564');" style=""> 441                 // 根据字段名对 row data 重组, 比如，原始 row data : (1, xxx, 20) -&gt; (id, name, age)                  </span>
<span class="2038150889857603205" onmouseenter="enter('2038150889857603205');" onmouseout="out('2038150889857603205');" style=""> 442                 // 但是由于 partition，写入的field 顺序变成了 (name, id, age)，则需要对 row data 重组变成 (xxx, 1, 20)         </span>
<span class="5421203580895226953" onmouseenter="enter('5421203580895226953');" onmouseout="out('5421203580895226953');" style=""> 443                 Row rowValue = new Row(fieldTypes.size());                                               </span>
<span class="-7699243670258396145" onmouseenter="enter('-7699243670258396145');" onmouseout="out('-7699243670258396145');" style=""> 444                 for (int i = 0; i &lt; fieldTypes.size(); i++) {                                            </span>
<span class="2312799749991659832" onmouseenter="enter('2312799749991659832');" onmouseout="out('2312799749991659832');" style=""> 445                     rowValue.setField(i, valueMap.get(valueFieldNames.get(i)));                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446                 }                                                                                        </span>
<span class="8595450652771675183" onmouseenter="enter('8595450652771675183');" onmouseout="out('8595450652771675183');" style=""> 447                 rowTuple2.f1 = valueConditionAddQuotation(buildValuesCondition(fieldTypes, rowValue));   </span>
<span class="8896132355788887171" onmouseenter="enter('8896132355788887171');" onmouseout="out('8896132355788887171');" style=""> 448                 putRowIntoMap(rowDataMap, rowTuple2);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449             }                                                                                            </span>
<span class="-1784546571648451896" onmouseenter="enter('-1784546571648451896');" onmouseout="out('-1784546571648451896');" style=""> 450             batchCount++;                                                                                </span>
<span class="2059038061408804342" onmouseenter="enter('2059038061408804342');" onmouseout="out('2059038061408804342');" style=""> 451             if (batchCount &gt;= batchSize) {                                                               </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style=""> 452                 flush();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453             }                                                                                            </span>
<span class="-2147939016446724954" onmouseenter="enter('-2147939016446724954');" onmouseout="out('-2147939016446724954');" style=""> 454             // Receive data                                                                              </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style=""> 455             outRecords.inc();                                                                            </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 456         } catch (java.lang.Exception e) {                                                                </span>
<span class="-6314596404725474749" onmouseenter="enter('-6314596404725474749');" onmouseout="out('-6314596404725474749');" style=""> 457             throw new IOException(&quot;Writing records to impala failed.&quot;, e);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459     }                                                                                                    </span>
<span  style=""> 460                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 461     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style=""> 462     public void close() throws IOException {                                                             </span>
<span class="6765329276469905715" onmouseenter="enter('6765329276469905715');" onmouseout="out('6765329276469905715');" style=""> 463         if (closed) {                                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 464             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465         }                                                                                                </span>
<span class="-8247099019020917877" onmouseenter="enter('-8247099019020917877');" onmouseout="out('-8247099019020917877');" style=""> 466         // 将还未执行的SQL flush                                                                               </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style=""> 467         if (batchCount &gt; 0) {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 468             try {                                                                                        </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style=""> 469                 flush();                                                                                 </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 470             } catch (java.lang.Exception e) {                                                            </span>
<span class="1679153721811128255" onmouseenter="enter('1679153721811128255');" onmouseout="out('1679153721811128255');" style=""> 471                 throw new RuntimeException(&quot;Writing records to impala failed.&quot;, e);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473         }                                                                                                </span>
<span class="4306800238416480323" onmouseenter="enter('4306800238416480323');" onmouseout="out('4306800238416480323');" style=""> 474         // cancel scheduled task                                                                         </span>
<span class="-1257031862697527304" onmouseenter="enter('-1257031862697527304');" onmouseout="out('-1257031862697527304');" style=""> 475         if (this.scheduledFuture != null) {                                                              </span>
<span class="-290660898949228596" onmouseenter="enter('-290660898949228596');" onmouseout="out('-290660898949228596');" style=""> 476             scheduledFuture.cancel(false);                                                               </span>
<span class="-3367227577965762682" onmouseenter="enter('-3367227577965762682');" onmouseout="out('-3367227577965762682');" style=""> 477             this.scheduler.shutdown();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478         }                                                                                                </span>
<span class="-6918026600162299955" onmouseenter="enter('-6918026600162299955');" onmouseout="out('-6918026600162299955');" style=""> 479         // close connection                                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 480         try {                                                                                            </span>
<span class="2047921360780686601" onmouseenter="enter('2047921360780686601');" onmouseout="out('2047921360780686601');" style=""> 481             if ((connection != null) &amp;&amp; connection.isValid(DEFAULT_CONN_TIME_OUT)) {                     </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 482                 connection.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483             }                                                                                            </span>
<span class="8429322953702249735" onmouseenter="enter('8429322953702249735');" onmouseout="out('8429322953702249735');" style=""> 484             if ((statement != null) &amp;&amp; (!statement.isClosed())) {                                        </span>
<span class="-4290000005499431342" onmouseenter="enter('-4290000005499431342');" onmouseout="out('-4290000005499431342');" style=""> 485                 statement.close();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486             }                                                                                            </span>
<span class="174875997820390122" onmouseenter="enter('174875997820390122');" onmouseout="out('174875997820390122');" style=""> 487             if ((updateStatement != null) &amp;&amp; (!updateStatement.isClosed())) {                            </span>
<span class="6285223499122042502" onmouseenter="enter('6285223499122042502');" onmouseout="out('6285223499122042502');" style=""> 488                 updateStatement.close();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style=""> 490         } catch (SQLException e) {                                                                       </span>
<span class="-8800633426745397107" onmouseenter="enter('-8800633426745397107');" onmouseout="out('-8800633426745397107');" style=""> 491             throw new RuntimeException(&quot;impala connection close failed!&quot;, e);                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 492         } finally {                                                                                      </span>
<span class="8335594207613379924" onmouseenter="enter('8335594207613379924');" onmouseout="out('8335594207613379924');" style=""> 493             connection = null;                                                                           </span>
<span class="-8855760725718402841" onmouseenter="enter('-8855760725718402841');" onmouseout="out('-8855760725718402841');" style=""> 494             statement = null;                                                                            </span>
<span class="-7841270215011717932" onmouseenter="enter('-7841270215011717932');" onmouseout="out('-7841270215011717932');" style=""> 495             updateStatement = null;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496         }                                                                                                </span>
<span class="5606214304023690467" onmouseenter="enter('5606214304023690467');" onmouseout="out('5606214304023690467');" style=""> 497         closed = true;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498     }                                                                                                    </span>
<span  style=""> 499                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 500     /**                                                                                                  </span>
<span class="1296337810927918625" onmouseenter="enter('1296337810927918625');" onmouseout="out('1296337810927918625');" style=""> 501      * execute batch sql from row data map                                                               </span>
<span class="-5974232274386764846" onmouseenter="enter('-5974232274386764846');" onmouseout="out('-5974232274386764846');" style=""><abbr title=" 502      * sql like &#x27;insert into tableName(f1, f2, f3) ${partitionCondition} values(v1, v2, v3), (v4, v5, v6)...."> 502      * sql like &#x27;insert into tableName(f1, f2, f3) ${partitionCondition} values(v1, v2, v3), (v4, v5, v6)🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 503      *                                                                                                   </span>
<span class="3064025681804756869" onmouseenter="enter('3064025681804756869');" onmouseout="out('3064025681804756869');" style=""> 504      * @param statement       execute statement                                                          </span>
<span class="4252025712922498493" onmouseenter="enter('4252025712922498493');" onmouseout="out('4252025712922498493');" style=""> 505      * @param tempSql         template sql                                                               </span>
<span class="-888616451537648959" onmouseenter="enter('-888616451537648959');" onmouseout="out('-888616451537648959');" style=""> 506      * @param storeType       the store type of data                                                     </span>
<span class="-5301096736775778703" onmouseenter="enter('-5301096736775778703');" onmouseout="out('-5301096736775778703');" style=""> 507      * @param enablePartition enable partition or not                                                    </span>
<span class="-7243431631208061298" onmouseenter="enter('-7243431631208061298');" onmouseout="out('-7243431631208061298');" style=""> 508      * @param fieldNames      field name list                                                            </span>
<span class="991482749163976330" onmouseenter="enter('991482749163976330');" onmouseout="out('991482749163976330');" style=""> 509      * @param partitionFields partition fields                                                           </span>
<span class="5552251290683891506" onmouseenter="enter('5552251290683891506');" onmouseout="out('5552251290683891506');" style=""> 510      * @param rowDataMap      row data map                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 511      */                                                                                                  </span>
<span class="4130592792811932792" onmouseenter="enter('4130592792811932792');" onmouseout="out('4130592792811932792');" style=""><abbr title=" 512     private void executeBatchSql(Statement statement, String tempSql, String schema, String tableName, String storeType, Boolean enablePartition, List&lt;String&gt; fieldNames, String partitionFields, Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap) {"> 512     private void executeBatchSql(Statement statement, String tempSql, String schema, String tableName, St🔵</abbr></span>
<span class="-8058960308042609674" onmouseenter="enter('-8058960308042609674');" onmouseout="out('-8058960308042609674');" style=""> 513         StringBuilder valuesCondition = new StringBuilder();                                             </span>
<span class="-1699639020719600437" onmouseenter="enter('-1699639020719600437');" onmouseout="out('-1699639020719600437');" style=""> 514         StringBuilder partitionCondition = new StringBuilder();                                          </span>
<span class="4484344279813579809" onmouseenter="enter('4484344279813579809');" onmouseout="out('4484344279813579809');" style=""> 515         String tableFieldsCondition = buildTableFieldsCondition(fieldNames, partitionFields);            </span>
<span class="-2056467323596282224" onmouseenter="enter('-2056467323596282224');" onmouseout="out('-2056467323596282224');" style=""> 516         ArrayList&lt;String&gt; rowData;                                                                       </span>
<span class="2367553030081763438" onmouseenter="enter('2367553030081763438');" onmouseout="out('2367553030081763438');" style=""><abbr title=" 517         String tableNameInfo = (Objects.isNull(schema)) ? tableName : (quoteIdentifier(schema) + &quot;.&quot;) + tableName;"> 517         String tableNameInfo = (Objects.isNull(schema)) ? tableName : (quoteIdentifier(schema) + &quot;.&quot;) + t🔵</abbr></span>
<span class="-7586945217349428495" onmouseenter="enter('-7586945217349428495');" onmouseout="out('-7586945217349428495');" style=""> 518         tempSql = tempSql.replace(&quot;tableName&quot;, tableNameInfo);                                           </span>
<span class="-739313269293547881" onmouseenter="enter('-739313269293547881');" onmouseout="out('-739313269293547881');" style=""> 519         // kudu ${partitionCondition} is null                                                            </span>
<span class="2982710714467139286" onmouseenter="enter('2982710714467139286');" onmouseout="out('2982710714467139286');" style=""> 520         if (storeType.equalsIgnoreCase(KUDU_TYPE) || (!enablePartition)) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 521             try {                                                                                        </span>
<span class="-2154584329942843601" onmouseenter="enter('-2154584329942843601');" onmouseout="out('-2154584329942843601');" style=""> 522                 rowData = rowDataMap.get(NO_PARTITION);                                                  </span>
<span class="5589627175376257013" onmouseenter="enter('5589627175376257013');" onmouseout="out('5589627175376257013');" style=""> 523                 rowData.forEach(( row) -&gt; valuesCondition.append(row).append(&quot;, &quot;));                     </span>
<span class="8355924619777627293" onmouseenter="enter('8355924619777627293');" onmouseout="out('8355924619777627293');" style=""><abbr title=" 524                 String executeSql = tempSql.replace(VALUES_CONDITION, valuesCondition.toString()).replace(PARTITION_CONDITION, partitionCondition.toString()).replace(PARTITION_CONSTANT, &quot;&quot;).replace(TABLE_FIELDS_CONDITION, tableFieldsCondition);"> 524                 String executeSql = tempSql.replace(VALUES_CONDITION, valuesCondition.toString()).replace🔵</abbr></span>
<span class="8541330001607166782" onmouseenter="enter('8541330001607166782');" onmouseout="out('8541330001607166782');" style=""> 525                 String substring = executeSql.substring(0, executeSql.length() - 2);                     </span>
<span class="9213214884061660178" onmouseenter="enter('9213214884061660178');" onmouseout="out('9213214884061660178');" style=""> 526                 statement.execute(substring);                                                            </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 527             } catch (java.lang.Exception e) {                                                            </span>
<span class="7699356527811265570" onmouseenter="enter('7699356527811265570');" onmouseout="out('7699356527811265570');" style=""> 528                 throw new RuntimeException(&quot;execute impala SQL error!&quot;, e);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529             }                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 530             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531         }                                                                                                </span>
<span class="6613720697354939567" onmouseenter="enter('6613720697354939567');" onmouseout="out('6613720697354939567');" style=""> 532         // partition sql                                                                                 </span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style=""> 533         Set&lt;String&gt; keySet = rowDataMap.keySet();                                                        </span>
<span class="6439574290523368417" onmouseenter="enter('6439574290523368417');" onmouseout="out('6439574290523368417');" style=""> 534         String finalTempSql = tempSql;                                                                   </span>
<span class="5286500476222551862" onmouseenter="enter('5286500476222551862');" onmouseout="out('5286500476222551862');" style=""> 535         for (String key : keySet) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 536             try {                                                                                        </span>
<span class="-8214047348876131469" onmouseenter="enter('-8214047348876131469');" onmouseout="out('-8214047348876131469');" style=""> 537                 String executeSql = String.copyValueOf(finalTempSql.toCharArray());                      </span>
<span class="225939304905434763" onmouseenter="enter('225939304905434763');" onmouseout="out('225939304905434763');" style=""> 538                 ArrayList&lt;String&gt; valuesConditionList = rowDataMap.get(key);                             </span>
<span class="3266960038838022824" onmouseenter="enter('3266960038838022824');" onmouseout="out('3266960038838022824');" style=""> 539                 partitionCondition.append(key);                                                          </span>
<span class="-9197017727586362012" onmouseenter="enter('-9197017727586362012');" onmouseout="out('-9197017727586362012');" style=""><abbr title=" 540                 executeSql = executeSql.replace(PARTITION_CONDITION, partitionCondition.toString()).replace(TABLE_FIELDS_CONDITION, tableFieldsCondition).replace(VALUES_CONDITION, String.join(&quot;, &quot;, valuesConditionList));"> 540                 executeSql = executeSql.replace(PARTITION_CONDITION, partitionCondition.toString()).repla🔵</abbr></span>
<span class="7589788358669612006" onmouseenter="enter('7589788358669612006');" onmouseout="out('7589788358669612006');" style=""> 541                 statement.execute(executeSql);                                                           </span>
<span class="-3000902343706299075" onmouseenter="enter('-3000902343706299075');" onmouseout="out('-3000902343706299075');" style=""> 542                 partitionCondition.delete(0, partitionCondition.length());                               </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style=""> 543             } catch (SQLException sqlException) {                                                        </span>
<span class="-5222513116835107038" onmouseenter="enter('-5222513116835107038');" onmouseout="out('-5222513116835107038');" style=""> 544                 throw new RuntimeException(&quot;execute impala SQL error! &quot;, sqlException);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 545             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547     }                                                                                                    </span>
<span  style=""> 548                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 549     /**                                                                                                  </span>
<span class="-7756927092547658158" onmouseenter="enter('-7756927092547658158');" onmouseout="out('-7756927092547658158');" style=""> 550      * build partition condition with row data                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 551      *                                                                                                   </span>
<span class="3326420447531983720" onmouseenter="enter('3326420447531983720');" onmouseout="out('3326420447531983720');" style=""> 552      * @param rowData              row data                                                              </span>
<span class="-4527404320823727170" onmouseenter="enter('-4527404320823727170');" onmouseout="out('-4527404320823727170');" style=""> 553      * @param partitionFields      partition fields                                                      </span>
<span class="-1776173940247734574" onmouseenter="enter('-1776173940247734574');" onmouseout="out('-1776173940247734574');" style=""> 554      * @param staticPartitionField static partition fields                                               </span>
<span class="-1132708759906563110" onmouseenter="enter('-1132708759906563110');" onmouseout="out('-1132708759906563110');" style=""> 555      * @return condition like &#x27;(ptOne, ptTwo=v2)&#x27;                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 556      */                                                                                                  </span>
<span class="-3866187778893382496" onmouseenter="enter('-3866187778893382496');" onmouseout="out('-3866187778893382496');" style=""><abbr title=" 557     private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;String&gt; staticPartitionField) {"> 557     private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;Stri🔵</abbr></span>
<span class="1267423885187171547" onmouseenter="enter('1267423885187171547');" onmouseout="out('1267423885187171547');" style=""> 558         for (String key : staticPartitionField) {                                                        </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 559             StringBuilder sb = new StringBuilder();                                                      </span>
<span class="-5505398468694975344" onmouseenter="enter('-5505398468694975344');" onmouseout="out('-5505398468694975344');" style=""> 560             Object value = rowData.get(key);                                                             </span>
<span class="-3546349567435071552" onmouseenter="enter('-3546349567435071552');" onmouseout="out('-3546349567435071552');" style=""> 561             sb.append(key).append(&quot;=&quot;).append(value);                                                    </span>
<span class="7571464430142538701" onmouseenter="enter('7571464430142538701');" onmouseout="out('7571464430142538701');" style=""> 562             partitionFields = partitionFields.replace(&quot;${&quot; + key + &quot;}&quot;, sb.toString());                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563         }                                                                                                </span>
<span class="-6125585623196674116" onmouseenter="enter('-6125585623196674116');" onmouseout="out('-6125585623196674116');" style=""> 564         return &quot;(&quot; + partitionFields + &quot;)&quot;;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 565     }                                                                                                    </span>
<span  style=""> 566                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 567     /**                                                                                                  </span>
<span class="1604816269765986224" onmouseenter="enter('1604816269765986224');" onmouseout="out('1604816269765986224');" style=""> 568      * build field condition according to field names                                                    </span>
<span class="-8005762898157210848" onmouseenter="enter('-8005762898157210848');" onmouseout="out('-8005762898157210848');" style=""> 569      * replace ${tableFieldCondition}                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 570      *                                                                                                   </span>
<span class="-3045974832751459167" onmouseenter="enter('-3045974832751459167');" onmouseout="out('-3045974832751459167');" style=""> 571      * @param fieldNames      the selected field names                                                   </span>
<span class="-2115580236801058408" onmouseenter="enter('-2115580236801058408');" onmouseout="out('-2115580236801058408');" style=""> 572      * @param partitionFields the partition fields                                                       </span>
<span class="-2587093228749928778" onmouseenter="enter('-2587093228749928778');" onmouseout="out('-2587093228749928778');" style=""> 573      * @return condition like &#x27;(id, name, age)&#x27;                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 574      */                                                                                                  </span>
<span class="-1478951256156574678" onmouseenter="enter('-1478951256156574678');" onmouseout="out('-1478951256156574678');" style=""> 575     private String buildTableFieldsCondition(List&lt;String&gt; fieldNames, String partitionFields) {          </span>
<span class="-8730756422155226372" onmouseenter="enter('-8730756422155226372');" onmouseout="out('-8730756422155226372');" style=""> 576         return &quot;(&quot; + fieldNames.stream()                                                                 </span>
<span class="-1124201215121024792" onmouseenter="enter('-1124201215121024792');" onmouseout="out('-1124201215121024792');" style=""> 577                 .filter(f -&gt; !partitionFields.contains(f))                                               </span>
<span class="4761076759122573536" onmouseenter="enter('4761076759122573536');" onmouseout="out('4761076759122573536');" style=""> 578                 .map(this::quoteIdentifier)                                                              </span>
<span class="-1385468130735042246" onmouseenter="enter('-1385468130735042246');" onmouseout="out('-1385468130735042246');" style=""> 579                 .collect(Collectors.joining(&quot;, &quot;)) + &quot;)&quot;;                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 580     }                                                                                                    </span>
<span  style=""> 581                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 582     /**                                                                                                  </span>
<span class="-1930125657620201419" onmouseenter="enter('-1930125657620201419');" onmouseout="out('-1930125657620201419');" style=""> 583      * according to field types, build the values condition                                              </span>
<span class="-5328431915012470826" onmouseenter="enter('-5328431915012470826');" onmouseout="out('-5328431915012470826');" style=""> 584      * replace ${valuesCondition}                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 585      *                                                                                                   </span>
<span class="889997534505017973" onmouseenter="enter('889997534505017973');" onmouseout="out('889997534505017973');" style=""> 586      * @param fieldTypes field types                                                                     </span>
<span class="-5792744344160442542" onmouseenter="enter('-5792744344160442542');" onmouseout="out('-5792744344160442542');" style=""> 587      * @return condition like &#x27;(?, ?, cast(? as string))&#x27; and &#x27;?&#x27; will be replaced with row data         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 588      */                                                                                                  </span>
<span class="-8753268388884688793" onmouseenter="enter('-8753268388884688793');" onmouseout="out('-8753268388884688793');" style=""> 589     private String buildValuesCondition(List&lt;String&gt; fieldTypes, Row row) {                              </span>
<span class="9451785702271217" onmouseenter="enter('9451785702271217');" onmouseout="out('9451785702271217');" style=""> 590         String valuesCondition = fieldTypes.stream().map(                                                </span>
<span class="-744834501831992668" onmouseenter="enter('-744834501831992668');" onmouseout="out('-744834501831992668');" style=""> 591                 f -&gt; {                                                                                   </span>
<span class="9071647551805886291" onmouseenter="enter('9071647551805886291');" onmouseout="out('9071647551805886291');" style=""> 592                     for (String item : NEED_QUOTE_TYPE) {                                                </span>
<span class="9108011392601680881" onmouseenter="enter('9108011392601680881');" onmouseout="out('9108011392601680881');" style=""> 593                         if (f.toLowerCase().contains(item)) {                                            </span>
<span class="-8315565477038260180" onmouseenter="enter('-8315565477038260180');" onmouseout="out('-8315565477038260180');" style=""> 594                             return String.format(&quot;cast(? as %s)&quot;, f.toLowerCase());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 596                     }                                                                                    </span>
<span class="6027958975032523467" onmouseenter="enter('6027958975032523467');" onmouseout="out('6027958975032523467');" style=""> 597                     return &quot;?&quot;;                                                                          </span>
<span class="4654177507103038656" onmouseenter="enter('4654177507103038656');" onmouseout="out('4654177507103038656');" style=""> 598                 }).collect(Collectors.joining(&quot;, &quot;));                                                    </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style=""> 599         for (int i = 0; i &lt; row.getArity(); i++) {                                                       </span>
<span class="2602556020493426404" onmouseenter="enter('2602556020493426404');" onmouseout="out('2602556020493426404');" style=""><abbr title=" 600             valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null&quot; : row.getField(i).toString());"> 600             valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 601         }                                                                                                </span>
<span class="6366685022999215739" onmouseenter="enter('6366685022999215739');" onmouseout="out('6366685022999215739');" style=""> 602         return valuesCondition;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 603     }                                                                                                    </span>
<span  style=""> 604                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 605     /**                                                                                                  </span>
<span class="2218542669560141576" onmouseenter="enter('2218542669560141576');" onmouseout="out('2218542669560141576');" style=""> 606      * impala update mode SQL                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 607      *                                                                                                   </span>
<span class="-8218292189476554358" onmouseenter="enter('-8218292189476554358');" onmouseout="out('-8218292189476554358');" style=""> 608      * @return UPDATE tableName SET setCondition WHERE whereCondition                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 609      */                                                                                                  </span>
<span class="-3752451701752547882" onmouseenter="enter('-3752451701752547882');" onmouseout="out('-3752451701752547882');" style=""><abbr title=" 610     private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; primaryKeys) {"> 610     private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; 🔵</abbr></span>
<span class="5528853464056789996" onmouseenter="enter('5528853464056789996');" onmouseout="out('5528853464056789996');" style=""> 611         //跳过primary key字段                                                                                </span>
<span class="-8857590287628770183" onmouseenter="enter('-8857590287628770183');" onmouseout="out('-8857590287628770183');" style=""> 612         String setClause = fieldNames.stream()                                                           </span>
<span class="-803297460241064625" onmouseenter="enter('-803297460241064625');" onmouseout="out('-803297460241064625');" style=""> 613                 .filter(f -&gt; !CollectionUtils.isNotEmpty(primaryKeys) || !primaryKeys.contains(f))       </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style=""> 614                 .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                     </span>
<span class="-209499088310020597" onmouseenter="enter('-209499088310020597');" onmouseout="out('-209499088310020597');" style=""> 615                 .collect(Collectors.joining(&quot;, &quot;));                                                      </span>
<span  style=""> 616                                                                                                          </span>
<span class="-3669556570443861667" onmouseenter="enter('-3669556570443861667');" onmouseout="out('-3669556570443861667');" style=""> 617         String conditionClause = primaryKeys.stream()                                                    </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style=""> 618                 .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                     </span>
<span class="1187060376059521362" onmouseenter="enter('1187060376059521362');" onmouseout="out('1187060376059521362');" style=""> 619                 .collect(Collectors.joining(&quot; AND &quot;));                                                   </span>
<span  style=""> 620                                                                                                          </span>
<span class="-880277003185331688" onmouseenter="enter('-880277003185331688');" onmouseout="out('-880277003185331688');" style=""> 621         return &quot;UPDATE &quot; + (Objects.isNull(schema) ? &quot;&quot; : quoteIdentifier(schema) + &quot;.&quot;)                 </span>
<span class="-2776062363149844820" onmouseenter="enter('-2776062363149844820');" onmouseout="out('-2776062363149844820');" style=""> 622                 + quoteIdentifier(tableName) + &quot; SET &quot; + setClause + &quot; WHERE &quot; + conditionClause;        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 623     }                                                                                                    </span>
<span  style=""> 624                                                                                                          </span>
<span class="4659511982989745103" onmouseenter="enter('4659511982989745103');" onmouseout="out('4659511982989745103');" style=""> 625     private String quoteIdentifier(String identifier) {                                                  </span>
<span class="1935684454964464658" onmouseenter="enter('1935684454964464658');" onmouseout="out('1935684454964464658');" style=""> 626         return &quot;`&quot; + identifier + &quot;`&quot;;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 627     }                                                                                                    </span>
<span  style=""> 628                                                                                                          </span>
<span class="-2481914402933088399" onmouseenter="enter('-2481914402933088399');" onmouseout="out('-2481914402933088399');" style=""> 629     public static Builder getImpalaBuilder() {                                                           </span>
<span class="-1926211775479526780" onmouseenter="enter('-1926211775479526780');" onmouseout="out('-1926211775479526780');" style=""> 630         return new Builder();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 631     }                                                                                                    </span>
<span  style=""> 632                                                                                                          </span>
<span class="2010609695383714647" onmouseenter="enter('2010609695383714647');" onmouseout="out('2010609695383714647');" style=""> 633     public static class Builder {                                                                        </span>
<span class="5030308014750517924" onmouseenter="enter('5030308014750517924');" onmouseout="out('5030308014750517924');" style=""> 634         private final ImpalaOutputFormat format = new ImpalaOutputFormat();                              </span>
<span  style=""> 635                                                                                                          </span>
<span class="4847669250945231235" onmouseenter="enter('4847669250945231235');" onmouseout="out('4847669250945231235');" style=""> 636         public Builder setDbUrl(String dbUrl) {                                                          </span>
<span class="-7007213682983262515" onmouseenter="enter('-7007213682983262515');" onmouseout="out('-7007213682983262515');" style=""> 637             format.dbUrl = dbUrl;                                                                        </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 638             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 639         }                                                                                                </span>
<span  style=""> 640                                                                                                          </span>
<span class="-2062625403058053727" onmouseenter="enter('-2062625403058053727');" onmouseout="out('-2062625403058053727');" style=""> 641         public Builder setUserName(String userName) {                                                    </span>
<span class="8996094991043959374" onmouseenter="enter('8996094991043959374');" onmouseout="out('8996094991043959374');" style=""> 642             format.userName = userName;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 643             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 644         }                                                                                                </span>
<span  style=""> 645                                                                                                          </span>
<span class="-8917696572465338538" onmouseenter="enter('-8917696572465338538');" onmouseout="out('-8917696572465338538');" style=""> 646         public Builder setPassword(String password) {                                                    </span>
<span class="-5617852808102302847" onmouseenter="enter('-5617852808102302847');" onmouseout="out('-5617852808102302847');" style=""> 647             format.password = password;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 648             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649         }                                                                                                </span>
<span  style=""> 650                                                                                                          </span>
<span class="-6851628607924303336" onmouseenter="enter('-6851628607924303336');" onmouseout="out('-6851628607924303336');" style=""> 651         public Builder setBatchSize(Integer batchSize) {                                                 </span>
<span class="-6323290766219617895" onmouseenter="enter('-6323290766219617895');" onmouseout="out('-6323290766219617895');" style=""> 652             format.batchSize = batchSize;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 653             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 654         }                                                                                                </span>
<span  style=""> 655                                                                                                          </span>
<span class="5791410845050671235" onmouseenter="enter('5791410845050671235');" onmouseout="out('5791410845050671235');" style=""> 656         public Builder setBatchWaitInterval(Long batchWaitInterval) {                                    </span>
<span class="7659700979146023520" onmouseenter="enter('7659700979146023520');" onmouseout="out('7659700979146023520');" style=""> 657             format.batchWaitInterval = batchWaitInterval;                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 658             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659         }                                                                                                </span>
<span  style=""> 660                                                                                                          </span>
<span class="-8777589626278372083" onmouseenter="enter('-8777589626278372083');" onmouseout="out('-8777589626278372083');" style=""> 661         public Builder setTableName(String tableName) {                                                  </span>
<span class="-1585853008866177938" onmouseenter="enter('-1585853008866177938');" onmouseout="out('-1585853008866177938');" style=""> 662             format.tableName = tableName;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 663             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 664         }                                                                                                </span>
<span  style=""> 665                                                                                                          </span>
<span class="221724127870954269" onmouseenter="enter('221724127870954269');" onmouseout="out('221724127870954269');" style=""> 666         public Builder setPartitionFields(String partitionFields) {                                      </span>
<span class="-5496492743746707432" onmouseenter="enter('-5496492743746707432');" onmouseout="out('-5496492743746707432');" style=""> 667             format.partitionFields = (Objects.isNull(partitionFields)) ? &quot;&quot; : partitionFields;           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 668             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 669         }                                                                                                </span>
<span  style=""> 670                                                                                                          </span>
<span class="-6994787811007556212" onmouseenter="enter('-6994787811007556212');" onmouseout="out('-6994787811007556212');" style=""> 671         public Builder setPrimaryKeys(List&lt;String&gt; primaryKeys) {                                        </span>
<span class="1909693990286542032" onmouseenter="enter('1909693990286542032');" onmouseout="out('1909693990286542032');" style=""> 672             format.primaryKeys = primaryKeys;                                                            </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 673             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674         }                                                                                                </span>
<span  style=""> 675                                                                                                          </span>
<span class="7512351963685249159" onmouseenter="enter('7512351963685249159');" onmouseout="out('7512351963685249159');" style=""> 676         public Builder setSchema(String schema) {                                                        </span>
<span class="306599522236782764" onmouseenter="enter('306599522236782764');" onmouseout="out('306599522236782764');" style=""> 677             format.schema = schema;                                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 678             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 679         }                                                                                                </span>
<span  style=""> 680                                                                                                          </span>
<span class="4541611662116992338" onmouseenter="enter('4541611662116992338');" onmouseout="out('4541611662116992338');" style=""> 681         public Builder setEnablePartition(Boolean enablePartition) {                                     </span>
<span class="-6976631596761488792" onmouseenter="enter('-6976631596761488792');" onmouseout="out('-6976631596761488792');" style=""> 682             format.enablePartition = enablePartition;                                                    </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 683             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 684         }                                                                                                </span>
<span  style=""> 685                                                                                                          </span>
<span class="-8865383825618932145" onmouseenter="enter('-8865383825618932145');" onmouseout="out('-8865383825618932145');" style=""> 686         public Builder setUpdateMode(String updateMode) {                                                </span>
<span class="-2281017119849044621" onmouseenter="enter('-2281017119849044621');" onmouseout="out('-2281017119849044621');" style=""> 687             format.updateMode = updateMode;                                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 688             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 689         }                                                                                                </span>
<span  style=""> 690                                                                                                          </span>
<span class="8081013001489210313" onmouseenter="enter('8081013001489210313');" onmouseout="out('8081013001489210313');" style=""> 691         public Builder setFieldList(List&lt;String&gt; fieldList) {                                            </span>
<span class="-818074055946993480" onmouseenter="enter('-818074055946993480');" onmouseout="out('-818074055946993480');" style=""> 692             format.fieldNames = fieldList;                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 693             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 694         }                                                                                                </span>
<span  style=""> 695                                                                                                          </span>
<span class="3974737416393184735" onmouseenter="enter('3974737416393184735');" onmouseout="out('3974737416393184735');" style=""> 696         public Builder setFieldTypeList(List&lt;String&gt; fieldTypeList) {                                    </span>
<span class="1448747188656744713" onmouseenter="enter('1448747188656744713');" onmouseout="out('1448747188656744713');" style=""> 697             format.fieldTypes = fieldTypeList;                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 698             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 699         }                                                                                                </span>
<span  style=""> 700                                                                                                          </span>
<span class="2244927175574628655" onmouseenter="enter('2244927175574628655');" onmouseout="out('2244927175574628655');" style=""> 701         public Builder setStoreType(String storeType) {                                                  </span>
<span class="-5818885152026709969" onmouseenter="enter('-5818885152026709969');" onmouseout="out('-5818885152026709969');" style=""> 702             format.storeType = storeType;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 703             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 704         }                                                                                                </span>
<span  style=""> 705                                                                                                          </span>
<span class="-5487489987508961941" onmouseenter="enter('-5487489987508961941');" onmouseout="out('-5487489987508961941');" style=""> 706         public Builder setFieldExtraInfoList(List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList) {</span>
<span class="160167467316759360" onmouseenter="enter('160167467316759360');" onmouseout="out('160167467316759360');" style=""> 707             format.fieldExtraInfoList = fieldExtraInfoList;                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 708             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 709         }                                                                                                </span>
<span  style=""> 710                                                                                                          </span>
<span class="1366044936846496088" onmouseenter="enter('1366044936846496088');" onmouseout="out('1366044936846496088');" style=""> 711         public Builder setKeyTabPath(String keyTabPath) {                                                </span>
<span class="8755357456701014681" onmouseenter="enter('8755357456701014681');" onmouseout="out('8755357456701014681');" style=""> 712             format.keytabPath = keyTabPath;                                                              </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 713             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 714         }                                                                                                </span>
<span  style=""> 715                                                                                                          </span>
<span class="1807007964631867819" onmouseenter="enter('1807007964631867819');" onmouseout="out('1807007964631867819');" style=""> 716         public Builder setKrb5ConfPath(String krb5ConfPath) {                                            </span>
<span class="352337563234497723" onmouseenter="enter('352337563234497723');" onmouseout="out('352337563234497723');" style=""> 717             format.krb5confPath = krb5ConfPath;                                                          </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 718             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 719         }                                                                                                </span>
<span  style=""> 720                                                                                                          </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style=""> 721         public Builder setPrincipal(String principal) {                                                  </span>
<span class="6894839552978791309" onmouseenter="enter('6894839552978791309');" onmouseout="out('6894839552978791309');" style=""> 722             format.principal = principal;                                                                </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 723             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724         }                                                                                                </span>
<span  style=""> 725                                                                                                          </span>
<span class="-8991908924314829739" onmouseenter="enter('-8991908924314829739');" onmouseout="out('-8991908924314829739');" style=""> 726         public Builder setAuthMech(Integer authMech) {                                                   </span>
<span class="-1412915325814520049" onmouseenter="enter('-1412915325814520049');" onmouseout="out('-1412915325814520049');" style=""> 727             format.authMech = authMech;                                                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 728             return this;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 729         }                                                                                                </span>
<span  style=""> 730                                                                                                          </span>
<span class="1564959121680510141" onmouseenter="enter('1564959121680510141');" onmouseout="out('1564959121680510141');" style=""> 731         private boolean canHandle(String url) {                                                          </span>
<span class="842511305287615009" onmouseenter="enter('842511305287615009');" onmouseout="out('842511305287615009');" style=""> 732             return url.startsWith(&quot;jdbc:impala:&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 733         }                                                                                                </span>
<span  style=""> 734                                                                                                          </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style=""> 735         public ImpalaOutputFormat build() {                                                              </span>
<span class="1659683170431033048" onmouseenter="enter('1659683170431033048');" onmouseout="out('1659683170431033048');" style=""> 736             if (!canHandle(format.dbUrl)) {                                                              </span>
<span class="-4870909491096243891" onmouseenter="enter('-4870909491096243891');" onmouseout="out('-4870909491096243891');" style=""><abbr title=" 737                 throw new IllegalArgumentException(&quot;impala dbUrl is illegal, check url: &quot; + format.dbUrl);"> 737                 throw new IllegalArgumentException(&quot;impala dbUrl is illegal, check url: &quot; + format.dbUrl)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 738             }                                                                                            </span>
<span class="-4505121258189477360" onmouseenter="enter('-4505121258189477360');" onmouseout="out('-4505121258189477360');" style=""> 739             if (format.authMech == EAuthMech.Kerberos.getType()) {                                       </span>
<span class="6602839569397321565" onmouseenter="enter('6602839569397321565');" onmouseout="out('6602839569397321565');" style=""><abbr title=" 740                 checkNotNull(format.krb5confPath, &quot;When kerberos authentication is enabled, krb5confPath is required！&quot;);"> 740                 checkNotNull(format.krb5confPath, &quot;When kerberos authentication is enabled, krb5confPath 🔵</abbr></span>
<span class="2501395209161425855" onmouseenter="enter('2501395209161425855');" onmouseout="out('2501395209161425855');" style=""><abbr title=" 741                 checkNotNull(format.principal, &quot;When kerberos authentication is enabled, principal is required！&quot;);"> 741                 checkNotNull(format.principal, &quot;When kerberos authentication is enabled, principal is req🔵</abbr></span>
<span class="2944052019736374588" onmouseenter="enter('2944052019736374588');" onmouseout="out('2944052019736374588');" style=""><abbr title=" 742                 checkNotNull(format.keytabPath, &quot;When kerberos authentication is enabled, keytabPath is required！&quot;);"> 742                 checkNotNull(format.keytabPath, &quot;When kerberos authentication is enabled, keytabPath is r🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743             }                                                                                            </span>
<span class="-5111581416826137591" onmouseenter="enter('-5111581416826137591');" onmouseout="out('-5111581416826137591');" style=""> 744             if (format.authMech == EAuthMech.UserName.getType()) {                                       </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style=""> 745                 checkNotNull(format.userName, &quot;userName is required!&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 746             }                                                                                            </span>
<span class="-3238564706659558925" onmouseenter="enter('-3238564706659558925');" onmouseout="out('-3238564706659558925');" style=""> 747             if (format.authMech == EAuthMech.NameANDPassword.getType()) {                                </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style=""> 748                 checkNotNull(format.userName, &quot;userName is required!&quot;);                                  </span>
<span class="-9040493906648204146" onmouseenter="enter('-9040493906648204146');" onmouseout="out('-9040493906648204146');" style=""> 749                 checkNotNull(format.password, &quot;password is required!&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 750             }                                                                                            </span>
<span class="1310568763423505425" onmouseenter="enter('1310568763423505425');" onmouseout="out('1310568763423505425');" style=""> 751             checkNotNull(format.storeType, &quot;storeType is required!&quot;);                                    </span>
<span class="9058009825496417823" onmouseenter="enter('9058009825496417823');" onmouseout="out('9058009825496417823');" style=""> 752             return format;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 753         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 754     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 755 }                                                                                                        </span>





























































































































































































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre>

















<span class="-6349807778844055730" onmouseenter="enter('-6349807778844055730');" onmouseout="out('-6349807778844055730');" style="">   1  package com.dtstack.flink.sql.sink.impala;                                                                        </span>
<span  style="">   2                                                                                                                    </span>
<span class="-1939464442458751974" onmouseenter="enter('-1939464442458751974');" onmouseout="out('-1939464442458751974');" style="">   3  import com.dtstack.flink.sql.sink.rdb.JDBCOptions;                                                                </span>
<span class="-5442145780383345859" onmouseenter="enter('-5442145780383345859');" onmouseout="out('-5442145780383345859');" style="">   4  import com.dtstack.flink.sql.sink.rdb.format.JDBCUpsertOutputFormat;                                              </span>





<span class="6538493847244355843" onmouseenter="enter('6538493847244355843');" onmouseout="out('6538493847244355843');" style="">   5  import com.dtstack.flink.sql.util.KrbUtils;                                                                       </span>





<span class="506888042235574053" onmouseenter="enter('506888042235574053');" onmouseout="out('506888042235574053');" style="">   6  import org.apache.hadoop.security.UserGroupInformation;                                                           </span>


<span  style="">   7                                                                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">   8  import java.io.IOException;                                                                                       </span>
<span class="1742248696071637161" onmouseenter="enter('1742248696071637161');" onmouseout="out('1742248696071637161');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   9 -import java.security.PrivilegedAction;                                                                            </span>

<span class="7889752473047782369" onmouseenter="enter('7889752473047782369');" onmouseout="out('7889752473047782369');" style="">  10  import java.security.PrivilegedExceptionAction;                                                                   </span>








<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  11  import java.util.List;                                                                                            </span>
<span  style="">  12                                                                                                                    </span>













<span class="-6257877604578820371" onmouseenter="enter('-6257877604578820371');" onmouseout="out('-6257877604578820371');" style="">  13  import static org.apache.flink.util.Preconditions.checkNotNull;                                                   </span>
<span  style="">  14                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  15  /**                                                                                                               </span>
<span class="-4713169250970759783" onmouseenter="enter('-4713169250970759783');" onmouseout="out('-4713169250970759783');" style="">  16   * @program: flinkStreamSQL                                                                                       </span>
<span class="-449541966811423146" onmouseenter="enter('-449541966811423146');" onmouseout="out('-449541966811423146');" style="">  17   * @author: wuren                                                                                                 </span>
<span class="8927744583550778879" onmouseenter="enter('8927744583550778879');" onmouseout="out('8927744583550778879');" style="">  18   * @create: 2020/09/11                                                                                            </span>
<span class="-547517873314350357" onmouseenter="enter('-547517873314350357');" onmouseout="out('-547517873314350357');" style="">  19   **/                                                                                                              </span>
<span class="-3735883079583251544" onmouseenter="enter('-3735883079583251544');" onmouseout="out('-3735883079583251544');" style="">  20  public class ImpalaOutputFormat extends JDBCUpsertOutputFormat {                                                  </span>
<span class="8204488434818797662" onmouseenter="enter('8204488434818797662');" onmouseout="out('8204488434818797662');" style="">  21      private String keytabPath;                                                                                    </span>
<span class="-2918852778965959076" onmouseenter="enter('-2918852778965959076');" onmouseout="out('-2918852778965959076');" style="">  22      private String krb5confPath;                                                                                  </span>
<span class="1721154694511290827" onmouseenter="enter('1721154694511290827');" onmouseout="out('1721154694511290827');" style="">  23      private String principal;                                                                                     </span>
<span class="4789602379336077849" onmouseenter="enter('4789602379336077849');" onmouseout="out('4789602379336077849');" style="">  24      private Integer authMech;                                                                                     </span>
<span  style="">  25                                                                                                                    </span>
<span class="4732040019780124063" onmouseenter="enter('4732040019780124063');" onmouseout="out('4732040019780124063');" style="">  26      public ImpalaOutputFormat(                                                                                    </span>
<span class="5167136634635436741" onmouseenter="enter('5167136634635436741');" onmouseout="out('5167136634635436741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -        JDBCOptions options,                                                                                      </span>
<span class="-4736685996717817971" onmouseenter="enter('-4736685996717817971');" onmouseout="out('-4736685996717817971');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -        String[] fieldNames,                                                                                      </span>
<span class="-2618125983682246634" onmouseenter="enter('-2618125983682246634');" onmouseout="out('-2618125983682246634');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -        String[] keyFields,                                                                                       </span>
<span class="7293787081639991923" onmouseenter="enter('7293787081639991923');" onmouseout="out('7293787081639991923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -        String[] partitionFields,                                                                                 </span>
<span class="1040707008318047089" onmouseenter="enter('1040707008318047089');" onmouseout="out('1040707008318047089');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -        int[] fieldTypes,                                                                                         </span>
<span class="-8839486848171122355" onmouseenter="enter('-8839486848171122355');" onmouseout="out('-8839486848171122355');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -        int flushMaxSize,                                                                                         </span>
<span class="-8297155974429506581" onmouseenter="enter('-8297155974429506581');" onmouseout="out('-8297155974429506581');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -        long flushIntervalMills,                                                                                  </span>
<span class="-7965801230461581297" onmouseenter="enter('-7965801230461581297');" onmouseout="out('-7965801230461581297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -        boolean allReplace,                                                                                       </span>
<span class="-6140757223057885564" onmouseenter="enter('-6140757223057885564');" onmouseout="out('-6140757223057885564');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -        String updateMode,                                                                                        </span>
<span class="2636278067336184332" onmouseenter="enter('2636278067336184332');" onmouseout="out('2636278067336184332');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -        Integer authMech,                                                                                         </span>
<span class="8982626024191430910" onmouseenter="enter('8982626024191430910');" onmouseout="out('8982626024191430910');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -        String keytabPath,                                                                                        </span>
<span class="2911638970634649671" onmouseenter="enter('2911638970634649671');" onmouseout="out('2911638970634649671');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -        String krb5confPath,                                                                                      </span>
<span class="5930293090421288838" onmouseenter="enter('5930293090421288838');" onmouseout="out('5930293090421288838');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -        String principal) {                                                                                       </span>
<span class="5167136634635436741" onmouseenter="enter('5167136634635436741');" onmouseout="out('5167136634635436741');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +            JDBCOptions options,                                                                                  </span>
<span class="-4736685996717817971" onmouseenter="enter('-4736685996717817971');" onmouseout="out('-4736685996717817971');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +            String[] fieldNames,                                                                                  </span>
<span class="-2618125983682246634" onmouseenter="enter('-2618125983682246634');" onmouseout="out('-2618125983682246634');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +            String[] keyFields,                                                                                   </span>
<span class="7293787081639991923" onmouseenter="enter('7293787081639991923');" onmouseout="out('7293787081639991923');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  43 +            String[] partitionFields,                                                                             </span>
<span class="1040707008318047089" onmouseenter="enter('1040707008318047089');" onmouseout="out('1040707008318047089');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +            int[] fieldTypes,                                                                                     </span>
<span class="-8839486848171122355" onmouseenter="enter('-8839486848171122355');" onmouseout="out('-8839486848171122355');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +            int flushMaxSize,                                                                                     </span>
<span class="-8297155974429506581" onmouseenter="enter('-8297155974429506581');" onmouseout="out('-8297155974429506581');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +            long flushIntervalMills,                                                                              </span>
<span class="-7965801230461581297" onmouseenter="enter('-7965801230461581297');" onmouseout="out('-7965801230461581297');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +            boolean allReplace,                                                                                   </span>
<span class="-6140757223057885564" onmouseenter="enter('-6140757223057885564');" onmouseout="out('-6140757223057885564');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +            String updateMode,                                                                                    </span>
<span class="2636278067336184332" onmouseenter="enter('2636278067336184332');" onmouseout="out('2636278067336184332');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +            Integer authMech,                                                                                     </span>
<span class="8982626024191430910" onmouseenter="enter('8982626024191430910');" onmouseout="out('8982626024191430910');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +            String keytabPath,                                                                                    </span>
<span class="2911638970634649671" onmouseenter="enter('2911638970634649671');" onmouseout="out('2911638970634649671');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +            String krb5confPath,                                                                                  </span>
<span class="5930293090421288838" onmouseenter="enter('5930293090421288838');" onmouseout="out('5930293090421288838');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +            String principal) {                                                                                   </span>
<span class="6527672739007688219" onmouseenter="enter('6527672739007688219');" onmouseout="out('6527672739007688219');" style="">  53          super(options,                                                                                            </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -            fieldNames,                                                                                           </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -            keyFields,                                                                                            </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -            partitionFields,                                                                                      </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -            fieldTypes,                                                                                           </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -            flushMaxSize,                                                                                         </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -            flushIntervalMills,                                                                                   </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -            allReplace,                                                                                           </span>
<span class="-4700598038672216861" onmouseenter="enter('-4700598038672216861');" onmouseout="out('-4700598038672216861');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -            updateMode);                                                                                          </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +                fieldNames,                                                                                       </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +                keyFields,                                                                                        </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +                partitionFields,                                                                                  </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +                fieldTypes,                                                                                       </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +                flushMaxSize,                                                                                     </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                flushIntervalMills,                                                                               </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +                allReplace,                                                                                       </span>
<span class="-4700598038672216861" onmouseenter="enter('-4700598038672216861');" onmouseout="out('-4700598038672216861');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +                updateMode);                                                                                      </span>
<span class="-4376363009887100958" onmouseenter="enter('-4376363009887100958');" onmouseout="out('-4376363009887100958');" style="">  70          this.authMech = authMech;                                                                                 </span>
<span class="6263908765738803139" onmouseenter="enter('6263908765738803139');" onmouseout="out('6263908765738803139');" style="">  71          this.keytabPath = keytabPath;                                                                             </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="">  72          this.krb5confPath = krb5confPath;                                                                         </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="">  73          this.principal = principal;                                                                               </span>
























































































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74      }                                                                                                             </span>
<span  style="">  75                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  76      @Override                                                                                                     </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="">  77      public void open(int taskNumber, int numTasks) throws IOException {                                           </span>

























































<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style="">  78          if (authMech == 1) {                                                                                      </span>
<span class="-1284950725257121950" onmouseenter="enter('-1284950725257121950');" onmouseout="out('-1284950725257121950');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -            UserGroupInformation ugi = KrbUtils.getUgi(principal, keytabPath, krb5confPath);                      </span>
<span class="-7445609792053649263" onmouseenter="enter('-7445609792053649263');" onmouseout="out('-7445609792053649263');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +            UserGroupInformation ugi = KrbUtils.loginAndReturnUgi(principal, keytabPath, krb5confPath);           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  81              try {                                                                                                 </span>
<span class="-7500201448081775902" onmouseenter="enter('-7500201448081775902');" onmouseout="out('-7500201448081775902');" style="">  82                  ugi.doAs(new PrivilegedExceptionAction&lt;Void&gt;() {                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83                      @Override                                                                                     </span>
<span class="-91807086218371469" onmouseenter="enter('-91807086218371469');" onmouseout="out('-91807086218371469');" style="">  84                      public Void run() throws IOException {                                                        </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style="">  85                          openJdbc();                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="">  86                          return null;                                                                              </span>









































































































































































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="">  88                  });                                                                                               </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style="">  89              } catch (InterruptedException e) {                                                                    </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="">  90                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  92          } else {                                                                                                  </span>
<span class="7285583204821622280" onmouseenter="enter('7285583204821622280');" onmouseout="out('7285583204821622280');" style="">  93              super.open(taskNumber, numTasks);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95      }                                                                                                             </span>
<span  style="">  96                                                                                                                    </span>
<span class="-2253996235710800331" onmouseenter="enter('-2253996235710800331');" onmouseout="out('-2253996235710800331');" style="">  97      public static Builder impalaBuilder() {                                                                       </span>





















































































































































































































































<span class="-1926211775479526780" onmouseenter="enter('-1926211775479526780');" onmouseout="out('-1926211775479526780');" style="">  98          return new Builder();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99      }                                                                                                             </span>
<span  style=""> 100                                                                                                                    </span>
<span class="2010609695383714647" onmouseenter="enter('2010609695383714647');" onmouseout="out('2010609695383714647');" style=""> 101      public static class Builder {                                                                                 </span>
<span class="4789602379336077849" onmouseenter="enter('4789602379336077849');" onmouseout="out('4789602379336077849');" style=""> 102          private Integer authMech;                                                                                 </span>
<span class="8204488434818797662" onmouseenter="enter('8204488434818797662');" onmouseout="out('8204488434818797662');" style=""> 103          private String keytabPath;                                                                                </span>
<span class="-2918852778965959076" onmouseenter="enter('-2918852778965959076');" onmouseout="out('-2918852778965959076');" style=""> 104          private String krb5confPath;                                                                              </span>
<span class="1721154694511290827" onmouseenter="enter('1721154694511290827');" onmouseout="out('1721154694511290827');" style=""> 105          private String principal;                                                                                 </span>
<span  style=""> 106                                                                                                                    </span>
<span class="8632875093914341707" onmouseenter="enter('8632875093914341707');" onmouseout="out('8632875093914341707');" style=""> 107          protected JDBCOptions options;                                                                            </span>
<span class="219098296700767876" onmouseenter="enter('219098296700767876');" onmouseout="out('219098296700767876');" style=""> 108          protected String[] fieldNames;                                                                            </span>
<span class="5985906154332630684" onmouseenter="enter('5985906154332630684');" onmouseout="out('5985906154332630684');" style=""> 109          protected String[] keyFields;                                                                             </span>
<span class="-2657046113209592975" onmouseenter="enter('-2657046113209592975');" onmouseout="out('-2657046113209592975');" style=""> 110          protected String[] partitionFields;                                                                       </span>
<span class="-2849472784703547647" onmouseenter="enter('-2849472784703547647');" onmouseout="out('-2849472784703547647');" style=""> 111          protected int[] fieldTypes;                                                                               </span>
<span class="-7994526912167873617" onmouseenter="enter('-7994526912167873617');" onmouseout="out('-7994526912167873617');" style=""> 112          protected int flushMaxSize = DEFAULT_FLUSH_MAX_SIZE;                                                      </span>
<span class="-502504972010929057" onmouseenter="enter('-502504972010929057');" onmouseout="out('-502504972010929057');" style=""> 113          protected long flushIntervalMills = DEFAULT_FLUSH_INTERVAL_MILLS;                                         </span>
<span class="-1781405325688028484" onmouseenter="enter('-1781405325688028484');" onmouseout="out('-1781405325688028484');" style=""> 114          protected boolean allReplace = DEFAULT_ALLREPLACE_VALUE;                                                  </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style=""> 115          protected String updateMode;                                                                              </span>
<span  style=""> 116                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 117          /**                                                                                                       </span>
<span class="5481504062898961016" onmouseenter="enter('5481504062898961016');" onmouseout="out('5481504062898961016');" style=""> 118           * required, jdbc options.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 119           */                                                                                                       </span>
<span class="-6789577863566851614" onmouseenter="enter('-6789577863566851614');" onmouseout="out('-6789577863566851614');" style=""> 120          public Builder setOptions(JDBCOptions options) {                                                          </span>
<span class="-4576342030125016864" onmouseenter="enter('-4576342030125016864');" onmouseout="out('-4576342030125016864');" style=""> 121              this.options = options;                                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 122              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123          }                                                                                                         </span>
<span  style=""> 124                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 125          /**                                                                                                       </span>
<span class="-6656747389933749738" onmouseenter="enter('-6656747389933749738');" onmouseout="out('-6656747389933749738');" style=""> 126           * required, field names of this jdbc sink.                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 127           */                                                                                                       </span>
<span class="4206393146938641816" onmouseenter="enter('4206393146938641816');" onmouseout="out('4206393146938641816');" style=""> 128          public Builder setFieldNames(String[] fieldNames) {                                                       </span>
<span class="-8533428013592676521" onmouseenter="enter('-8533428013592676521');" onmouseout="out('-8533428013592676521');" style=""> 129              this.fieldNames = fieldNames;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 130              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131          }                                                                                                         </span>
<span  style=""> 132                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 133          /**                                                                                                       </span>
<span class="-7266512599063730897" onmouseenter="enter('-7266512599063730897');" onmouseout="out('-7266512599063730897');" style=""> 134           * required, upsert unique keys.                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 135           */                                                                                                       </span>
<span class="5182547725706677872" onmouseenter="enter('5182547725706677872');" onmouseout="out('5182547725706677872');" style=""> 136          public Builder setKeyFields(List&lt;String&gt; keyFields) {                                                     </span>
<span class="-2040409877479865197" onmouseenter="enter('-2040409877479865197');" onmouseout="out('-2040409877479865197');" style=""> 137              this.keyFields = keyFields == null ? null : keyFields.toArray(new String[keyFields.size()]);          </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 138              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139          }                                                                                                         </span>
<span  style=""> 140                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 141          /**                                                                                                       </span>
<span class="2669293159353915090" onmouseenter="enter('2669293159353915090');" onmouseout="out('2669293159353915090');" style=""> 142           * required, field types of this jdbc sink.                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 143           */                                                                                                       </span>
<span class="-2827077114511059363" onmouseenter="enter('-2827077114511059363');" onmouseout="out('-2827077114511059363');" style=""> 144          public Builder setFieldTypes(int[] fieldTypes) {                                                          </span>
<span class="7622859212288666930" onmouseenter="enter('7622859212288666930');" onmouseout="out('7622859212288666930');" style=""> 145              this.fieldTypes = fieldTypes;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 146              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147          }                                                                                                         </span>
<span  style=""> 148                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 149          /**                                                                                                       </span>
<span class="8911651130315010133" onmouseenter="enter('8911651130315010133');" onmouseout="out('8911651130315010133');" style=""> 150           * optional, partition Fields                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 151           *                                                                                                        </span>
<span class="-6644816777766472486" onmouseenter="enter('-6644816777766472486');" onmouseout="out('-6644816777766472486');" style=""> 152           * @param partitionFields                                                                                 </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 153           * @return                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 154           */                                                                                                       </span>
<span class="85175638427035295" onmouseenter="enter('85175638427035295');" onmouseout="out('85175638427035295');" style=""> 155          public Builder setPartitionFields(String[] partitionFields) {                                             </span>
<span class="-5579362841573531869" onmouseenter="enter('-5579362841573531869');" onmouseout="out('-5579362841573531869');" style=""> 156              this.partitionFields = partitionFields;                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 157              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158          }                                                                                                         </span>
<span  style=""> 159                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 160          /**                                                                                                       </span>
<span class="-856751752856244493" onmouseenter="enter('-856751752856244493');" onmouseout="out('-856751752856244493');" style=""> 161           * optional, flush max size (includes all append, upsert and delete records),                             </span>
<span class="-1144698166522235177" onmouseenter="enter('-1144698166522235177');" onmouseout="out('-1144698166522235177');" style=""> 162           * over this number of records, will flush data.                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 163           */                                                                                                       </span>
<span class="6566053436650323939" onmouseenter="enter('6566053436650323939');" onmouseout="out('6566053436650323939');" style=""> 164          public Builder setFlushMaxSize(int flushMaxSize) {                                                        </span>
<span class="1661332877772785928" onmouseenter="enter('1661332877772785928');" onmouseout="out('1661332877772785928');" style=""> 165              this.flushMaxSize = flushMaxSize;                                                                     </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 166              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167          }                                                                                                         </span>
<span  style=""> 168                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 169          /**                                                                                                       </span>
<span class="-69172137005245494" onmouseenter="enter('-69172137005245494');" onmouseout="out('-69172137005245494');" style=""> 170           * optional, flush interval mills, over this time, asynchronous threads will flush data.                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 171           */                                                                                                       </span>
<span class="-5174969731661074679" onmouseenter="enter('-5174969731661074679');" onmouseout="out('-5174969731661074679');" style=""> 172          public Builder setFlushIntervalMills(long flushIntervalMills) {                                           </span>
<span class="8894509418585583190" onmouseenter="enter('8894509418585583190');" onmouseout="out('8894509418585583190');" style=""> 173              this.flushIntervalMills = flushIntervalMills;                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 174              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175          }                                                                                                         </span>
<span  style=""> 176                                                                                                                    </span>
<span class="-6829645289886270021" onmouseenter="enter('-6829645289886270021');" onmouseout="out('-6829645289886270021');" style=""> 177          public Builder setAllReplace(boolean allReplace) {                                                        </span>
<span class="-7939456506453079727" onmouseenter="enter('-7939456506453079727');" onmouseout="out('-7939456506453079727');" style=""> 178              this.allReplace = allReplace;                                                                         </span>


















































<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 179              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180          }                                                                                                         </span>
<span  style=""> 181                                                                                                                    </span>
<span class="-8865383825618932145" onmouseenter="enter('-8865383825618932145');" onmouseout="out('-8865383825618932145');" style=""> 182          public Builder setUpdateMode(String updateMode) {                                                         </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style=""> 183              this.updateMode = updateMode;                                                                         </span>




































<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 184              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185          }                                                                                                         </span>
<span  style=""> 186                                                                                                                    </span>
<span class="-8991908924314829739" onmouseenter="enter('-8991908924314829739');" onmouseout="out('-8991908924314829739');" style=""> 187          public Builder setAuthMech(Integer authMech) {                                                            </span>
<span class="-4376363009887100958" onmouseenter="enter('-4376363009887100958');" onmouseout="out('-4376363009887100958');" style=""> 188              this.authMech = authMech;                                                                             </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 189              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190          }                                                                                                         </span>
<span class="-5894016934964343602" onmouseenter="enter('-5894016934964343602');" onmouseout="out('-5894016934964343602');" style=""> 191          public Builder setKeytabPath(String keytabPath) {                                                         </span>
<span class="6263908765738803139" onmouseenter="enter('6263908765738803139');" onmouseout="out('6263908765738803139');" style=""> 192              this.keytabPath = keytabPath;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 193              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194          }                                                                                                         </span>
<span class="3824864761746312224" onmouseenter="enter('3824864761746312224');" onmouseout="out('3824864761746312224');" style=""> 195          public Builder setKrb5confPath(String krb5confPath) {                                                     </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style=""> 196              this.krb5confPath = krb5confPath;                                                                     </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 197              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198          }                                                                                                         </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style=""> 199          public Builder setPrincipal(String principal) {                                                           </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style=""> 200              this.principal = principal;                                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 201              return this;                                                                                          </span>






<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202          }                                                                                                         </span>
<span  style=""> 203                                                                                                                    </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style=""> 204          public ImpalaOutputFormat build() {                                                                       </span>
<span class="-4875931377123605731" onmouseenter="enter('-4875931377123605731');" onmouseout="out('-4875931377123605731');" style=""> 205              checkNotNull(options, &quot;No options supplied.&quot;);                                                        </span>
<span class="-7519421098126359785" onmouseenter="enter('-7519421098126359785');" onmouseout="out('-7519421098126359785');" style=""> 206              checkNotNull(fieldNames, &quot;No fieldNames supplied.&quot;);                                                  </span>
<span class="-465714982636894626" onmouseenter="enter('-465714982636894626');" onmouseout="out('-465714982636894626');" style=""> 207              return new ImpalaOutputFormat(                                                                        </span>
<span class="-1722348633561755627" onmouseenter="enter('-1722348633561755627');" onmouseout="out('-1722348633561755627');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -                options,                                                                                          </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -                fieldNames,                                                                                       </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -                keyFields,                                                                                        </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -                partitionFields,                                                                                  </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -                fieldTypes,                                                                                       </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -                flushMaxSize,                                                                                     </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -                flushIntervalMills,                                                                               </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -                allReplace,                                                                                       </span>
<span class="7760506155904782707" onmouseenter="enter('7760506155904782707');" onmouseout="out('7760506155904782707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -                updateMode,                                                                                       </span>
<span class="-4863483435840713149" onmouseenter="enter('-4863483435840713149');" onmouseout="out('-4863483435840713149');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -                authMech,                                                                                         </span>
<span class="6910046306719868385" onmouseenter="enter('6910046306719868385');" onmouseout="out('6910046306719868385');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -                keytabPath,                                                                                       </span>
<span class="2510923373943101588" onmouseenter="enter('2510923373943101588');" onmouseout="out('2510923373943101588');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -                krb5confPath,                                                                                     </span>
<span class="-3475871463423309499" onmouseenter="enter('-3475871463423309499');" onmouseout="out('-3475871463423309499');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -                principal);                                                                                       </span>
<span class="-1722348633561755627" onmouseenter="enter('-1722348633561755627');" onmouseout="out('-1722348633561755627');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +                    options,                                                                                      </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +                    fieldNames,                                                                                   </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 223 +                    keyFields,                                                                                    </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 224 +                    partitionFields,                                                                              </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 225 +                    fieldTypes,                                                                                   </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 226 +                    flushMaxSize,                                                                                 </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 227 +                    flushIntervalMills,                                                                           </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 228 +                    allReplace,                                                                                   </span>
<span class="7760506155904782707" onmouseenter="enter('7760506155904782707');" onmouseout="out('7760506155904782707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 229 +                    updateMode,                                                                                   </span>
<span class="-4863483435840713149" onmouseenter="enter('-4863483435840713149');" onmouseout="out('-4863483435840713149');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 230 +                    authMech,                                                                                     </span>
<span class="6910046306719868385" onmouseenter="enter('6910046306719868385');" onmouseout="out('6910046306719868385');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 231 +                    keytabPath,                                                                                   </span>
<span class="2510923373943101588" onmouseenter="enter('2510923373943101588');" onmouseout="out('2510923373943101588');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 232 +                    krb5confPath,                                                                                 </span>
<span class="-3475871463423309499" onmouseenter="enter('-3475871463423309499');" onmouseout="out('-3475871463423309499');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 233 +                    principal);                                                                                   </span>












<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   1 +/*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   2 + * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   3 + * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   4 + * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   5 + * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   6 + * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   7 + * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   8 + * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 + *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  10 + *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  11 + *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  12 + * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  13 + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  14 + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  15 + * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  16 + * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  17 + */                                                                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  18 +                                                                                                                  </span>
<span class="-6349807778844055730" onmouseenter="enter('-6349807778844055730');" onmouseout="out('-6349807778844055730');" style="">  19  package com.dtstack.flink.sql.sink.impala;                                                                        </span>
<span  style="">  20                                                                                                                    </span>
<span class="-1939464442458751974" onmouseenter="enter('-1939464442458751974');" onmouseout="out('-1939464442458751974');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import com.dtstack.flink.sql.sink.rdb.JDBCOptions;                                                                </span>
<span class="-5442145780383345859" onmouseenter="enter('-5442145780383345859');" onmouseout="out('-5442145780383345859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.sink.rdb.format.JDBCUpsertOutputFormat;                                              </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.dtstack.flink.sql.factory.DTThreadFactory;                                                             </span>
<span class="102868081392093008" onmouseenter="enter('102868081392093008');" onmouseout="out('102868081392093008');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import com.dtstack.flink.sql.outputformat.AbstractDtRichOutputFormat;                                             </span>
<span class="-8930056125403642162" onmouseenter="enter('-8930056125403642162');" onmouseout="out('-8930056125403642162');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils;                                                       </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import com.dtstack.flink.sql.table.AbstractTableInfo;                                                             </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import com.dtstack.flink.sql.util.JDBCUtils;                                                                      </span>
<span class="6538493847244355843" onmouseenter="enter('6538493847244355843');" onmouseout="out('6538493847244355843');" style="">  28  import com.dtstack.flink.sql.util.KrbUtils;                                                                       </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import com.google.common.collect.Maps;                                                                            </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +import org.apache.flink.types.Row;                                                                                </span>
<span class="506888042235574053" onmouseenter="enter('506888042235574053');" onmouseout="out('506888042235574053');" style="">  34  import org.apache.hadoop.security.UserGroupInformation;                                                           </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  37                                                                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  38  import java.io.IOException;                                                                                       </span>
<span class="1742248696071637161" onmouseenter="enter('1742248696071637161');" onmouseout="out('1742248696071637161');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import java.security.PrivilegedAction;                                                                            </span>
<span class="6916252335749377687" onmouseenter="enter('6916252335749377687');" onmouseout="out('6916252335749377687');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +import java.rmi.RemoteException;                                                                                  </span>
<span class="7889752473047782369" onmouseenter="enter('7889752473047782369');" onmouseout="out('7889752473047782369');" style="">  41  import java.security.PrivilegedExceptionAction;                                                                   </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +import java.sql.Connection;                                                                                       </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  43 +import java.sql.DriverManager;                                                                                    </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +import java.sql.PreparedStatement;                                                                                </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +import java.sql.SQLException;                                                                                     </span>
<span class="6402527026259660908" onmouseenter="enter('6402527026259660908');" onmouseout="out('6402527026259660908');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +import java.sql.Statement;                                                                                        </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +import java.util.ArrayList;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +import java.util.Arrays;                                                                                          </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  50  import java.util.List;                                                                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -                                                                                                                  </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +import java.util.Map;                                                                                             </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +import java.util.Objects;                                                                                         </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +import java.util.Set;                                                                                             </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +import java.util.concurrent.ScheduledExecutorService;                                                             </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +import java.util.concurrent.ScheduledFuture;                                                                      </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +import java.util.concurrent.ScheduledThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +import java.util.concurrent.TimeUnit;                                                                             </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +import java.util.concurrent.atomic.AtomicReference;                                                               </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +import java.util.regex.Matcher;                                                                                   </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +import java.util.regex.Pattern;                                                                                   </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +import java.util.stream.Collectors;                                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +                                                                                                                  </span>
<span class="1455633447019431220" onmouseenter="enter('1455633447019431220');" onmouseout="out('1455633447019431220');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +import static com.dtstack.flink.sql.sink.rdb.JDBCTypeConvertUtils.setRecordToStatement;                           </span>
<span class="-6257877604578820371" onmouseenter="enter('-6257877604578820371');" onmouseout="out('-6257877604578820371');" style="">  65  import static org.apache.flink.util.Preconditions.checkNotNull;                                                   </span>
<span  style="">  66                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  67  /**                                                                                                               </span>
<span class="-4713169250970759783" onmouseenter="enter('-4713169250970759783');" onmouseout="out('-4713169250970759783');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 - * @program: flinkStreamSQL                                                                                       </span>
<span class="-449541966811423146" onmouseenter="enter('-449541966811423146');" onmouseout="out('-449541966811423146');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 - * @author: wuren                                                                                                 </span>
<span class="8927744583550778879" onmouseenter="enter('8927744583550778879');" onmouseout="out('8927744583550778879');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 - * @create: 2020/09/11                                                                                            </span>
<span class="-547517873314350357" onmouseenter="enter('-547517873314350357');" onmouseout="out('-547517873314350357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 - **/                                                                                                              </span>
<span class="-3735883079583251544" onmouseenter="enter('-3735883079583251544');" onmouseout="out('-3735883079583251544');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -public class ImpalaOutputFormat extends JDBCUpsertOutputFormat {                                                  </span>
<span class="8204488434818797662" onmouseenter="enter('8204488434818797662');" onmouseout="out('8204488434818797662');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -    private String keytabPath;                                                                                    </span>
<span class="-2918852778965959076" onmouseenter="enter('-2918852778965959076');" onmouseout="out('-2918852778965959076');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -    private String krb5confPath;                                                                                  </span>
<span class="1721154694511290827" onmouseenter="enter('1721154694511290827');" onmouseout="out('1721154694511290827');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -    private String principal;                                                                                     </span>
<span class="4789602379336077849" onmouseenter="enter('4789602379336077849');" onmouseout="out('4789602379336077849');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -    private Integer authMech;                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -                                                                                                                  </span>
<span class="4732040019780124063" onmouseenter="enter('4732040019780124063');" onmouseout="out('4732040019780124063');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -    public ImpalaOutputFormat(                                                                                    </span>
<span class="5167136634635436741" onmouseenter="enter('5167136634635436741');" onmouseout="out('5167136634635436741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -        JDBCOptions options,                                                                                      </span>
<span class="-4736685996717817971" onmouseenter="enter('-4736685996717817971');" onmouseout="out('-4736685996717817971');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -        String[] fieldNames,                                                                                      </span>
<span class="-2618125983682246634" onmouseenter="enter('-2618125983682246634');" onmouseout="out('-2618125983682246634');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -        String[] keyFields,                                                                                       </span>
<span class="7293787081639991923" onmouseenter="enter('7293787081639991923');" onmouseout="out('7293787081639991923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -        String[] partitionFields,                                                                                 </span>
<span class="1040707008318047089" onmouseenter="enter('1040707008318047089');" onmouseout="out('1040707008318047089');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -        int[] fieldTypes,                                                                                         </span>
<span class="-8839486848171122355" onmouseenter="enter('-8839486848171122355');" onmouseout="out('-8839486848171122355');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -        int flushMaxSize,                                                                                         </span>
<span class="-8297155974429506581" onmouseenter="enter('-8297155974429506581');" onmouseout="out('-8297155974429506581');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -        long flushIntervalMills,                                                                                  </span>
<span class="-7965801230461581297" onmouseenter="enter('-7965801230461581297');" onmouseout="out('-7965801230461581297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -        boolean allReplace,                                                                                       </span>
<span class="-6140757223057885564" onmouseenter="enter('-6140757223057885564');" onmouseout="out('-6140757223057885564');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -        String updateMode,                                                                                        </span>
<span class="2636278067336184332" onmouseenter="enter('2636278067336184332');" onmouseout="out('2636278067336184332');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -        Integer authMech,                                                                                         </span>
<span class="8982626024191430910" onmouseenter="enter('8982626024191430910');" onmouseout="out('8982626024191430910');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -        String keytabPath,                                                                                        </span>
<span class="2911638970634649671" onmouseenter="enter('2911638970634649671');" onmouseout="out('2911638970634649671');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -        String krb5confPath,                                                                                      </span>
<span class="5930293090421288838" onmouseenter="enter('5930293090421288838');" onmouseout="out('5930293090421288838');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -        String principal) {                                                                                       </span>













<span class="6527672739007688219" onmouseenter="enter('6527672739007688219');" onmouseout="out('6527672739007688219');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -        super(options,                                                                                            </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -            fieldNames,                                                                                           </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -            keyFields,                                                                                            </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -            partitionFields,                                                                                      </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -            fieldTypes,                                                                                           </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -            flushMaxSize,                                                                                         </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -            flushIntervalMills,                                                                                   </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -            allReplace,                                                                                           </span>
<span class="-4700598038672216861" onmouseenter="enter('-4700598038672216861');" onmouseout="out('-4700598038672216861');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -            updateMode);                                                                                          </span>








<span class="-4376363009887100958" onmouseenter="enter('-4376363009887100958');" onmouseout="out('-4376363009887100958');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -        this.authMech = authMech;                                                                                 </span>
<span class="6263908765738803139" onmouseenter="enter('6263908765738803139');" onmouseout="out('6263908765738803139');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -        this.keytabPath = keytabPath;                                                                             </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -        this.krb5confPath = krb5confPath;                                                                         </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -        this.principal = principal;                                                                               </span>
<span class="7153001641478282104" onmouseenter="enter('7153001641478282104');" onmouseout="out('7153001641478282104');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 105 + * Date: 2020/10/14                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 + * Company: www.dtstack.com                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 + *                                                                                                                </span>
<span class="-4100502199450942834" onmouseenter="enter('-4100502199450942834');" onmouseout="out('-4100502199450942834');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 108 + * @author tiezhu                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 + */                                                                                                               </span>
<span class="-4121149390422149560" onmouseenter="enter('-4121149390422149560');" onmouseout="out('-4121149390422149560');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +public class ImpalaOutputFormat extends AbstractDtRichOutputFormat&lt;Tuple2&lt;Boolean, Row&gt;&gt; {                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +                                                                                                                  </span>
<span class="-5870848474790717720" onmouseenter="enter('-5870848474790717720');" onmouseout="out('-5870848474790717720');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +    private static final Logger LOG = LoggerFactory.getLogger(ImpalaOutputFormat.class);                          </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +                                                                                                                  </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +    private static final long serialVersionUID = 1L;                                                              </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +                                                                                                                  </span>
<span class="-9068282285967712029" onmouseenter="enter('-9068282285967712029');" onmouseout="out('-9068282285967712029');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +    // ${field}                                                                                                   </span>
<span class="-5949646080202310183" onmouseenter="enter('-5949646080202310183');" onmouseout="out('-5949646080202310183');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +    private static final Pattern STATIC_PARTITION_PATTERN = Pattern.compile(&quot;\\$\\{([^}]*)}&quot;);                    </span>
<span class="5956354208608974741" onmouseenter="enter('5956354208608974741');" onmouseout="out('5956354208608974741');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +    // cast(value as string) -&gt; cast(&#x27;value&#x27; as string)  cast(value as timestamp) -&gt; cast(&#x27;value&#x27; as timestamp)   </span>
<span class="1953221153478650066" onmouseenter="enter('1953221153478650066');" onmouseout="out('1953221153478650066');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +    private static final Pattern TYPE_PATTERN = Pattern.compile(&quot;cast\\((.*) as (.*)\\)&quot;);                        </span>
<span class="6992730206516090107" onmouseenter="enter('6992730206516090107');" onmouseout="out('6992730206516090107');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +    //specific type which values need to be quoted                                                                </span>
<span class="-2884666096421851487" onmouseenter="enter('-2884666096421851487');" onmouseout="out('-2884666096421851487');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +    private static final String[] NEED_QUOTE_TYPE = {&quot;string&quot;, &quot;timestamp&quot;, &quot;varchar&quot;};                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +                                                                                                                  </span>
<span class="191207487610103693" onmouseenter="enter('191207487610103693');" onmouseout="out('191207487610103693');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +    private static final Integer DEFAULT_CONN_TIME_OUT = 60;                                                      </span>
<span class="-1388186840411616756" onmouseenter="enter('-1388186840411616756');" onmouseout="out('-1388186840411616756');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +    private static final int RECEIVE_DATA_PRINT_FREQUENCY = 1000;                                                 </span>
<span class="-4268888009857984730" onmouseenter="enter('-4268888009857984730');" onmouseout="out('-4268888009857984730');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +    private static final int DIRTY_DATA_PRINT_FREQUENCY = 1000;                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +                                                                                                                  </span>
<span class="-588818051573867979" onmouseenter="enter('-588818051573867979');" onmouseout="out('-588818051573867979');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +    private static final String KUDU_TYPE = &quot;kudu&quot;;                                                               </span>
<span class="-6769623881035360393" onmouseenter="enter('-6769623881035360393');" onmouseout="out('-6769623881035360393');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +    private static final String UPDATE_MODE = &quot;update&quot;;                                                           </span>
<span class="-7709014261424944614" onmouseenter="enter('-7709014261424944614');" onmouseout="out('-7709014261424944614');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +    private static final String PARTITION_CONSTANT = &quot;PARTITION&quot;;                                                 </span>
<span class="1441081326157561113" onmouseenter="enter('1441081326157561113');" onmouseout="out('1441081326157561113');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +    private static final String DRIVER_NAME = &quot;com.cloudera.impala.jdbc41.Driver&quot;;                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +                                                                                                                  </span>
<span class="-2689163518074835497" onmouseenter="enter('-2689163518074835497');" onmouseout="out('-2689163518074835497');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +    private static final String VALUES_CONDITION = &quot;${valuesCondition}&quot;;                                          </span>
<span class="3062777246713899037" onmouseenter="enter('3062777246713899037');" onmouseout="out('3062777246713899037');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +    private static final String PARTITION_CONDITION = &quot;${partitionCondition}&quot;;                                    </span>
<span class="2401236240707522557" onmouseenter="enter('2401236240707522557');" onmouseout="out('2401236240707522557');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +    private static final String TABLE_FIELDS_CONDITION = &quot;${tableFieldsCondition}&quot;;                               </span>
<span class="3255739684264436552" onmouseenter="enter('3255739684264436552');" onmouseout="out('3255739684264436552');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +    private static final String NO_PARTITION = &quot;noPartition&quot;;                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 136 +                                                                                                                  </span>
<span class="-7445073777200404714" onmouseenter="enter('-7445073777200404714');" onmouseout="out('-7445073777200404714');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +    protected transient Connection connection;                                                                    </span>
<span class="-2184169902108079684" onmouseenter="enter('-2184169902108079684');" onmouseout="out('-2184169902108079684');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +    protected transient Statement statement;                                                                      </span>
<span class="6238382839663594696" onmouseenter="enter('6238382839663594696');" onmouseout="out('6238382839663594696');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +    protected transient PreparedStatement updateStatement;                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +                                                                                                                  </span>
<span class="4293032579277507790" onmouseenter="enter('4293032579277507790');" onmouseout="out('4293032579277507790');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +    private transient volatile boolean closed = false;                                                            </span>
<span class="8220840984571392918" onmouseenter="enter('8220840984571392918');" onmouseout="out('8220840984571392918');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +    private int batchCount = 0;                                                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 143 +                                                                                                                  </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 144 +    // |------------------------------------------------|                                                         </span>
<span class="-789927222958732888" onmouseenter="enter('-789927222958732888');" onmouseout="out('-789927222958732888');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +    // |   partitionCondition   |Array of valueCondition|                                                         </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +    // |------------------------------------------------|                                                         </span>
<span class="-8825804998995953162" onmouseenter="enter('-8825804998995953162');" onmouseout="out('-8825804998995953162');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +    // | ptOne, ptTwo, ptThree  | [(v1, v2, v3, v4, v5)]|   DP                                                    </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +    // |------------------------------------------------|                                                         </span>
<span class="-5802382310877164118" onmouseenter="enter('-5802382310877164118');" onmouseout="out('-5802382310877164118');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +    // | ptOne = v1, ptTwo = v2 | [(v3, v4, v5)]        |   SP                                                    </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +    // |------------------------------------------------|                                                         </span>
<span class="2984234039288316275" onmouseenter="enter('2984234039288316275');" onmouseout="out('2984234039288316275');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +    // | ptOne, ptTwo = v2      | [(v1, v3, v4, v5)]    |   DP and SP                                             </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +    // |------------------------------------------------|                                                         </span>
<span class="7219405512764117222" onmouseenter="enter('7219405512764117222');" onmouseout="out('7219405512764117222');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +    // | noPartition            | [(v1, v2, v3, v4, v5)]|   kudu or disablePartition                              </span>
<span class="1417511218873382999" onmouseenter="enter('1417511218873382999');" onmouseout="out('1417511218873382999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +    // |------------------------------------------------|                                                         </span>
<span class="9020411500856357590" onmouseenter="enter('9020411500856357590');" onmouseout="out('9020411500856357590');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +    private transient Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap;                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +                                                                                                                  </span>
<span class="-4172535577750872346" onmouseenter="enter('-4172535577750872346');" onmouseout="out('-4172535577750872346');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +    protected String keytabPath;                                                                                  </span>
<span class="1987487277257130103" onmouseenter="enter('1987487277257130103');" onmouseout="out('1987487277257130103');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +    protected String krb5confPath;                                                                                </span>
<span class="3478885111338451838" onmouseenter="enter('3478885111338451838');" onmouseout="out('3478885111338451838');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +    protected String principal;                                                                                   </span>
<span class="-2673327721248325609" onmouseenter="enter('-2673327721248325609');" onmouseout="out('-2673327721248325609');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +    protected Integer authMech;                                                                                   </span>
<span class="-8834882937031238604" onmouseenter="enter('-8834882937031238604');" onmouseout="out('-8834882937031238604');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +    protected String dbUrl;                                                                                       </span>
<span class="4348689613054045460" onmouseenter="enter('4348689613054045460');" onmouseout="out('4348689613054045460');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +    protected String userName;                                                                                    </span>
<span class="519247125889688558" onmouseenter="enter('519247125889688558');" onmouseout="out('519247125889688558');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +    protected String password;                                                                                    </span>
<span class="-7554929939288236010" onmouseenter="enter('-7554929939288236010');" onmouseout="out('-7554929939288236010');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +    protected int batchSize = 100;                                                                                </span>
<span class="8848445520039039194" onmouseenter="enter('8848445520039039194');" onmouseout="out('8848445520039039194');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +    protected long batchWaitInterval = 60 * 1000L;                                                                </span>
<span class="6924126392600265325" onmouseenter="enter('6924126392600265325');" onmouseout="out('6924126392600265325');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +    protected String tableName;                                                                                   </span>
<span class="-8067881189136281922" onmouseenter="enter('-8067881189136281922');" onmouseout="out('-8067881189136281922');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +    protected List&lt;String&gt; primaryKeys;                                                                           </span>
<span class="-1238809985534246985" onmouseenter="enter('-1238809985534246985');" onmouseout="out('-1238809985534246985');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +    protected String partitionFields;                                                                             </span>
<span class="-2843446813182919439" onmouseenter="enter('-2843446813182919439');" onmouseout="out('-2843446813182919439');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +    protected Boolean enablePartition;                                                                            </span>
<span class="3349082107931708476" onmouseenter="enter('3349082107931708476');" onmouseout="out('3349082107931708476');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +    protected String schema;                                                                                      </span>
<span class="-2869920961807604939" onmouseenter="enter('-2869920961807604939');" onmouseout="out('-2869920961807604939');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 171 +    protected String storeType;                                                                                   </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +    protected String updateMode;                                                                                  </span>
<span class="8729932671243795004" onmouseenter="enter('8729932671243795004');" onmouseout="out('8729932671243795004');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 173 +    public List&lt;String&gt; fieldNames;                                                                               </span>
<span class="5323664213258183290" onmouseenter="enter('5323664213258183290');" onmouseout="out('5323664213258183290');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +    public List&lt;String&gt; fieldTypes;                                                                               </span>
<span class="589573262942162938" onmouseenter="enter('589573262942162938');" onmouseout="out('589573262942162938');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +    public List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList;                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +                                                                                                                  </span>
<span class="-2123205835999557493" onmouseenter="enter('-2123205835999557493');" onmouseout="out('-2123205835999557493');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +    // partition field of static partition which matched by ${field}                                              </span>
<span class="-976040292573398488" onmouseenter="enter('-976040292573398488');" onmouseout="out('-976040292573398488');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 178 +    private final List&lt;String&gt; staticPartitionFields = new ArrayList&lt;&gt;();                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 179 +                                                                                                                  </span>
<span class="8461763253073029471" onmouseenter="enter('8461763253073029471');" onmouseout="out('8461763253073029471');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 180 +    // valueFieldsName -&gt; 重组之后的fieldNames，为了重组row data字段值对应                                                       </span>
<span class="-5473349939362349748" onmouseenter="enter('-5473349939362349748');" onmouseout="out('-5473349939362349748');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 181 +    // 需要对partition字段做特殊处理，比如原来的字段顺序为(age, name, id)，但是因为partition，写入的SQL为                                        </span>
<span class="888010466316090175" onmouseenter="enter('888010466316090175');" onmouseout="out('888010466316090175');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +    // INSERT INTO tableName(name, id) PARTITION(age) VALUES(?, ?, ?)                                             </span>
<span class="1229277488566704041" onmouseenter="enter('1229277488566704041');" onmouseout="out('1229277488566704041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +    // 那么实际executeSql设置字段的顺序应该为(name, id, age)，同时，字段对应的type顺序也需要重组                                                </span>
<span class="6098973354216055964" onmouseenter="enter('6098973354216055964');" onmouseout="out('6098973354216055964');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 184 +    private List&lt;String&gt; valueFieldNames;                                                                         </span>
<span class="-7108089166418781511" onmouseenter="enter('-7108089166418781511');" onmouseout="out('-7108089166418781511');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +    private transient AbstractDtRichOutputFormat&lt;?&gt; metricOutputFormat;                                           </span>
<span class="273368026714901275" onmouseenter="enter('273368026714901275');" onmouseout="out('273368026714901275');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 186 +    private List&lt;Row&gt; rows;                                                                                       </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 187 +                                                                                                                  </span>
<span class="9015955711937997200" onmouseenter="enter('9015955711937997200');" onmouseout="out('9015955711937997200');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 188 +    private transient ScheduledExecutorService scheduler;                                                         </span>
<span class="-5761494216005426476" onmouseenter="enter('-5761494216005426476');" onmouseout="out('-5761494216005426476');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 189 +    private transient ScheduledFuture&lt;?&gt; scheduledFuture;                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 190 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +    @Override                                                                                                     </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 192 +    public void configure(Configuration parameters) {                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193      }                                                                                                             </span>
<span  style=""> 194                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 195      @Override                                                                                                     </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style=""> 196      public void open(int taskNumber, int numTasks) throws IOException {                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 197 +        try {                                                                                                     </span>
<span class="4324779626821739975" onmouseenter="enter('4324779626821739975');" onmouseout="out('4324779626821739975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +            rowDataMap = new HashMap&lt;&gt;();                                                                         </span>
<span class="-6551372933934183741" onmouseenter="enter('-6551372933934183741');" onmouseout="out('-6551372933934183741');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 199 +            rows = new ArrayList&lt;&gt;();                                                                             </span>
<span class="-7937337195293668220" onmouseenter="enter('-7937337195293668220');" onmouseout="out('-7937337195293668220');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 200 +            metricOutputFormat = this;                                                                            </span>
<span class="-8035752082134444550" onmouseenter="enter('-8035752082134444550');" onmouseout="out('-8035752082134444550');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 201 +            openConnect();                                                                                        </span>
<span class="-3251827356232524015" onmouseenter="enter('-3251827356232524015');" onmouseout="out('-3251827356232524015');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 202 +            initScheduledTask(batchWaitInterval);                                                                 </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 203 +            init();                                                                                               </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 204 +            initMetric();                                                                                         </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 205 +        } catch (Exception e) {                                                                                   </span>
<span class="-105883012207117402" onmouseenter="enter('-105883012207117402');" onmouseout="out('-105883012207117402');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 206 +            throw new RuntimeException(&quot;impala output format open error!&quot;, e);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 207 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 208 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 209 +                                                                                                                  </span>
<span class="-8578201295687943948" onmouseenter="enter('-8578201295687943948');" onmouseout="out('-8578201295687943948');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +    private void init() throws SQLException {                                                                     </span>
<span class="-8350145873279772804" onmouseenter="enter('-8350145873279772804');" onmouseout="out('-8350145873279772804');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 211 +        if (Objects.nonNull(partitionFields)) {                                                                   </span>
<span class="8590422903839909721" onmouseenter="enter('8590422903839909721');" onmouseout="out('8590422903839909721');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +            // match ${field} from partitionFields                                                                </span>
<span class="399614494149678967" onmouseenter="enter('399614494149678967');" onmouseout="out('399614494149678967');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +            Matcher matcher = STATIC_PARTITION_PATTERN.matcher(partitionFields);                                  </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +            while (matcher.find()) {                                                                              </span>
<span class="-1180668930060799754" onmouseenter="enter('-1180668930060799754');" onmouseout="out('-1180668930060799754');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 215 +                LOG.info(&quot;find static partition field: {}&quot;, matcher.group(1));                                    </span>
<span class="5933786634924389530" onmouseenter="enter('5933786634924389530');" onmouseout="out('5933786634924389530');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +                staticPartitionFields.add(matcher.group(1));                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 218 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 219 +                                                                                                                  </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +        if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                                           </span>
<span class="-511688609314859464" onmouseenter="enter('-511688609314859464');" onmouseout="out('-511688609314859464');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +            if (!storeType.equalsIgnoreCase(KUDU_TYPE)) {                                                         </span>
<span class="7738691828431171650" onmouseenter="enter('7738691828431171650');" onmouseout="out('7738691828431171650');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +                throw new IllegalArgumentException(&quot;update mode not support for non-kudu table!&quot;);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 223 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 224 +                                                                                                                  </span>
<span class="-1926567860735108753" onmouseenter="enter('-1926567860735108753');" onmouseout="out('-1926567860735108753');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 225 +            updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, primaryKeys));"> 225 +            updateStatement = connection.prepareStatement(buildUpdateSql(schema, tableName, fieldNames, primaryKey🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 226 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 227 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 228 +                                                                                                                  </span>
<span class="5264299831364970974" onmouseenter="enter('5264299831364970974');" onmouseout="out('5264299831364970974');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 229 +        valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, partitionFields);"> 229 +        valueFieldNames = rebuildFieldNameListAndTypeList(fieldNames, staticPartitionFields, fieldTypes, partition🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 230 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 231 +                                                                                                                  </span>
<span class="-4335191442342413864" onmouseenter="enter('-4335191442342413864');" onmouseout="out('-4335191442342413864');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 232 +    private void initScheduledTask(Long batchWaitInterval) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 233 +        try {                                                                                                     </span>
<span class="-5481453632006175071" onmouseenter="enter('-5481453632006175071');" onmouseout="out('-5481453632006175071');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 234 +            if (batchWaitInterval != 0) {                                                                         </span>
<span class="777682131179381780" onmouseenter="enter('777682131179381780');" onmouseout="out('777682131179381780');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 235 +                this.scheduler = new ScheduledThreadPoolExecutor(1,                                               </span>
<span class="714213466749562787" onmouseenter="enter('714213466749562787');" onmouseout="out('714213466749562787');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 236 +                        new DTThreadFactory(&quot;impala-upsert-output-format&quot;));                                      </span>
<span class="-7149116985444787635" onmouseenter="enter('-7149116985444787635');" onmouseout="out('-7149116985444787635');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 237 +                this.scheduledFuture = this.scheduler.scheduleWithFixedDelay(() -&gt; {                              </span>
<span class="-940414522275968791" onmouseenter="enter('-940414522275968791');" onmouseout="out('-940414522275968791');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 238 +                    synchronized (ImpalaOutputFormat.this) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 239 +                        try {                                                                                     </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 240 +                            flush();                                                                              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 241 +                        } catch (Exception e) {                                                                   </span>
<span class="-5628183046854957718" onmouseenter="enter('-5628183046854957718');" onmouseout="out('-5628183046854957718');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 242 +                            LOG.error(&quot;Writing records to impala jdbc failed.&quot;, e);                               </span>
<span class="-7023774051195191894" onmouseenter="enter('-7023774051195191894');" onmouseout="out('-7023774051195191894');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 243 +                            throw new RuntimeException(&quot;Writing records to impala jdbc failed.&quot;, e);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 244 +                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 245 +                    }                                                                                             </span>
<span class="8465771028460365894" onmouseenter="enter('8465771028460365894');" onmouseout="out('8465771028460365894');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 246 +                }, batchWaitInterval, batchWaitInterval, TimeUnit.MILLISECONDS);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 247 +            }                                                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 248 +        } catch (Exception e) {                                                                                   </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 249 +            throw new RuntimeException(e);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 250 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 251 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +                                                                                                                  </span>
<span class="-2844613068709206340" onmouseenter="enter('-2844613068709206340');" onmouseout="out('-2844613068709206340');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 253 +    private void openConnect() throws IOException {                                                               </span>
<span class="-2394055578891206899" onmouseenter="enter('-2394055578891206899');" onmouseout="out('-2394055578891206899');" style=""> 254          if (authMech == 1) {                                                                                      </span>
<span class="-1284950725257121950" onmouseenter="enter('-1284950725257121950');" onmouseout="out('-1284950725257121950');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -            UserGroupInformation ugi = KrbUtils.getUgi(principal, keytabPath, krb5confPath);                      </span>
<span class="-7445609792053649263" onmouseenter="enter('-7445609792053649263');" onmouseout="out('-7445609792053649263');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 256 +            UserGroupInformation ugi = KrbUtils.loginAndReturnUgi(principal, keytabPath, krb5confPath);           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 257              try {                                                                                                 </span>
<span class="-7500201448081775902" onmouseenter="enter('-7500201448081775902');" onmouseout="out('-7500201448081775902');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                ugi.doAs(new PrivilegedExceptionAction&lt;Void&gt;() {                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -                    @Override                                                                                     </span>
<span class="-91807086218371469" onmouseenter="enter('-91807086218371469');" onmouseout="out('-91807086218371469');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -                    public Void run() throws IOException {                                                        </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -                        openJdbc();                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -                        return null;                                                                              </span>
<span class="1057249312142684394" onmouseenter="enter('1057249312142684394');" onmouseout="out('1057249312142684394');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 263 +                ugi.doAs((PrivilegedExceptionAction&lt;Void&gt;) () -&gt; {                                                </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 264 +                    openJdbc();                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 265 +                    return null;                                                                                  </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 266 +                });                                                                                               </span>
<span class="3693318474890767753" onmouseenter="enter('3693318474890767753');" onmouseout="out('3693318474890767753');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 267 +            } catch (InterruptedException | IOException e) {                                                      </span>
<span class="-3216725393010457363" onmouseenter="enter('-3216725393010457363');" onmouseout="out('-3216725393010457363');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 268 +                throw new IllegalArgumentException(&quot;connect impala error!&quot;, e);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 269 +            }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 270 +        } else {                                                                                                  </span>
<span class="-8367326114243113305" onmouseenter="enter('-8367326114243113305');" onmouseout="out('-8367326114243113305');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 271 +            openJdbc();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 272 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 273 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 274 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 275 +    /**                                                                                                           </span>
<span class="-4019084214603833891" onmouseenter="enter('-4019084214603833891');" onmouseout="out('-4019084214603833891');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 276 +     * get jdbc connection                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 277 +     */                                                                                                           </span>
<span class="6517717324631316532" onmouseenter="enter('6517717324631316532');" onmouseout="out('6517717324631316532');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 278 +    private void openJdbc() {                                                                                     </span>
<span class="-5989471214664392944" onmouseenter="enter('-5989471214664392944');" onmouseout="out('-5989471214664392944');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 279 +        JDBCUtils.forName(DRIVER_NAME, getClass().getClassLoader());                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 280 +        try {                                                                                                     </span>
<span class="-4188974437029144237" onmouseenter="enter('-4188974437029144237');" onmouseout="out('-4188974437029144237');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 281 +            connection = DriverManager.getConnection(dbUrl, userName, password);                                  </span>
<span class="-3909190598463408725" onmouseenter="enter('-3909190598463408725');" onmouseout="out('-3909190598463408725');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 282 +            statement = connection.createStatement();                                                             </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 283 +            connection.setAutoCommit(false);                                                                      </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 284 +        } catch (SQLException sqlException) {                                                                     </span>
<span class="8417232372887360387" onmouseenter="enter('8417232372887360387');" onmouseout="out('8417232372887360387');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 285 +            throw new RuntimeException(&quot;get impala jdbc connection failed!&quot;, sqlException);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 286 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 287 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 288 +                                                                                                                  </span>
<span class="7521208138226245516" onmouseenter="enter('7521208138226245516');" onmouseout="out('7521208138226245516');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 289 +    private void flush() throws Exception {                                                                       </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 290 +        if (batchCount &gt; 0) {                                                                                     </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 291 +            if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                                       </span>
<span class="-7210745719484505959" onmouseenter="enter('-7210745719484505959');" onmouseout="out('-7210745719484505959');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 292 +                executeUpdateBatch();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 293 +            }                                                                                                     </span>
<span class="-5565980137871755476" onmouseenter="enter('-5565980137871755476');" onmouseout="out('-5565980137871755476');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 294 +            if (!rowDataMap.isEmpty()) {                                                                          </span>
<span class="8546814641173072756" onmouseenter="enter('8546814641173072756');" onmouseout="out('8546814641173072756');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 295 +                String templateSql =                                                                              </span>
<span class="-1766017053596733683" onmouseenter="enter('-1766017053596733683');" onmouseout="out('-1766017053596733683');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 296 +                        &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VALUES ${valuesCondition}&quot;;"> 296 +                        &quot;INSERT INTO tableName ${tableFieldsCondition} PARTITION ${partitionCondition} VALUES ${va🔵</abbr></span>
<span class="7007887973141057675" onmouseenter="enter('7007887973141057675');" onmouseout="out('7007887973141057675');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 297 +                executeBatchSql(                                                                                  </span>
<span class="839015566868436312" onmouseenter="enter('839015566868436312');" onmouseout="out('839015566868436312');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 298 +                        statement,                                                                                </span>
<span class="-8931083358346849072" onmouseenter="enter('-8931083358346849072');" onmouseout="out('-8931083358346849072');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 299 +                        templateSql,                                                                              </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 300 +                        schema,                                                                                   </span>
<span class="8599198975592615021" onmouseenter="enter('8599198975592615021');" onmouseout="out('8599198975592615021');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 301 +                        tableName,                                                                                </span>
<span class="7739930709415439240" onmouseenter="enter('7739930709415439240');" onmouseout="out('7739930709415439240');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 302 +                        storeType,                                                                                </span>
<span class="4460343981916954231" onmouseenter="enter('4460343981916954231');" onmouseout="out('4460343981916954231');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 303 +                        enablePartition,                                                                          </span>
<span class="-232795436679668454" onmouseenter="enter('-232795436679668454');" onmouseout="out('-232795436679668454');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 304 +                        valueFieldNames,                                                                          </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 305 +                        partitionFields,                                                                          </span>
<span class="-163268273074797630" onmouseenter="enter('-163268273074797630');" onmouseout="out('-163268273074797630');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 306 +                        rowDataMap                                                                                </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 307 +                );                                                                                                </span>
<span class="1629791312198735010" onmouseenter="enter('1629791312198735010');" onmouseout="out('1629791312198735010');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 308 +                rowDataMap.clear();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 309 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 310 +        }                                                                                                         </span>
<span class="-5311733944590264805" onmouseenter="enter('-5311733944590264805');" onmouseout="out('-5311733944590264805');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 311 +        batchCount = 0;                                                                                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 312 +                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 313 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 314 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 315 +    /**                                                                                                           </span>
<span class="-1106181825212481278" onmouseenter="enter('-1106181825212481278');" onmouseout="out('-1106181825212481278');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 316 +     * execute batch update statement                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 317 +     *                                                                                                            </span>
<span class="3560665881375675274" onmouseenter="enter('3560665881375675274');" onmouseout="out('3560665881375675274');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 318 +     * @throws SQLException throw sql exception                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 319 +     */                                                                                                           </span>
<span class="3206601587144870407" onmouseenter="enter('3206601587144870407');" onmouseout="out('3206601587144870407');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 320 +    private void executeUpdateBatch() throws SQLException {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 321 +        try {                                                                                                     </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 322 +            rows.forEach(row -&gt; {                                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 323 +                try {                                                                                             </span>
<span class="-1215139546593028546" onmouseenter="enter('-1215139546593028546');" onmouseout="out('-1215139546593028546');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 324 +                    JDBCTypeConvertUtils.setRecordToStatement(                                                    </span>
<span class="-4710389352980966846" onmouseenter="enter('-4710389352980966846');" onmouseout="out('-4710389352980966846');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 325 +                            updateStatement,                                                                      </span>
<span class="4668718668329814914" onmouseenter="enter('4668718668329814914');" onmouseout="out('4668718668329814914');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 326 +                            JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes),                             </span>
<span class="-7576027683765873339" onmouseenter="enter('-7576027683765873339');" onmouseout="out('-7576027683765873339');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 327 +                            row,                                                                                  </span>
<span class="-255277236311302851" onmouseenter="enter('-255277236311302851');" onmouseout="out('-255277236311302851');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 328 +                            primaryKeys.stream().mapToInt(fieldNames::indexOf).toArray()                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 329 +                    );                                                                                            </span>
<span class="-4238050377414791796" onmouseenter="enter('-4238050377414791796');" onmouseout="out('-4238050377414791796');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 330 +                    updateStatement.addBatch();                                                                   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 331 +                } catch (Exception e) {                                                                           </span>
<span class="5068376771892501659" onmouseenter="enter('5068376771892501659');" onmouseout="out('5068376771892501659');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 332 +                    throw new RuntimeException(&quot;impala jdbc execute batch error!&quot;, e);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 333 +                }                                                                                                 </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 334 +            });                                                                                                   </span>
<span class="-3747739502872154032" onmouseenter="enter('-3747739502872154032');" onmouseout="out('-3747739502872154032');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 335 +            updateStatement.executeBatch();                                                                       </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 336 +            connection.commit();                                                                                  </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 337 +            rows.clear();                                                                                         </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 338 +        } catch (Exception e) {                                                                                   </span>
<span class="1715728751446881781" onmouseenter="enter('1715728751446881781');" onmouseout="out('1715728751446881781');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 339 +            LOG.debug(&quot;impala jdbc execute batch error &quot;, e);                                                     </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 340 +            connection.rollback();                                                                                </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 341 +            connection.commit();                                                                                  </span>
<span class="-4187732730208785389" onmouseenter="enter('-4187732730208785389');" onmouseout="out('-4187732730208785389');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 342 +            updateStatement.clearBatch();                                                                         </span>
<span class="-8814080953460465644" onmouseenter="enter('-8814080953460465644');" onmouseout="out('-8814080953460465644');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 343 +            executeUpdate(connection);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 344 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 345 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 346 +                                                                                                                  </span>
<span class="-4847686400566224446" onmouseenter="enter('-4847686400566224446');" onmouseout="out('-4847686400566224446');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 347 +    public void executeUpdate(Connection connection) {                                                            </span>
<span class="-2642147019263217962" onmouseenter="enter('-2642147019263217962');" onmouseout="out('-2642147019263217962');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 348 +        rows.forEach(row -&gt; {                                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 349 +            try {                                                                                                 </span>
<span class="3018395377218617369" onmouseenter="enter('3018395377218617369');" onmouseout="out('3018395377218617369');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 350 +                setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes), row);"> 350 +                setRecordToStatement(updateStatement, JDBCTypeConvertUtils.getSqlTypeFromFieldType(fieldTypes), ro🔵</abbr></span>
<span class="-6547782628025070914" onmouseenter="enter('-6547782628025070914');" onmouseout="out('-6547782628025070914');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 351 +                updateStatement.executeUpdate();                                                                  </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 352 +                connection.commit();                                                                              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 353 +            } catch (Exception e) {                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 354 +                try {                                                                                             </span>
<span class="7087468057749493272" onmouseenter="enter('7087468057749493272');" onmouseout="out('7087468057749493272');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 355 +                    connection.rollback();                                                                        </span>
<span class="2006839820365524481" onmouseenter="enter('2006839820365524481');" onmouseout="out('2006839820365524481');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 356 +                    connection.commit();                                                                          </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 357 +                } catch (SQLException e1) {                                                                       </span>
<span class="-2635323073569974258" onmouseenter="enter('-2635323073569974258');" onmouseout="out('-2635323073569974258');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 358 +                    throw new RuntimeException(e1);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 359 +                }                                                                                                 </span>
<span class="-4808081927273297919" onmouseenter="enter('-4808081927273297919');" onmouseout="out('-4808081927273297919');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 360 +                if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {"> 360 +                if (metricOutputFormat.outDirtyRecords.getCount() % DIRTY_DATA_PRINT_FREQUENCY == 0 || LOG.isDebug🔵</abbr></span>
<span class="-2764908242367356599" onmouseenter="enter('-2764908242367356599');" onmouseout="out('-2764908242367356599');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 361 +                    LOG.error(&quot;record insert failed ,this row is {}&quot;, row.toString());                            </span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 362 +                    LOG.error(&quot;&quot;, e);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 363 +                }                                                                                                 </span>
<span class="-8596285303698617705" onmouseenter="enter('-8596285303698617705');" onmouseout="out('-8596285303698617705');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 364 +                metricOutputFormat.outDirtyRecords.inc();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 365 +            }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 366 +        });                                                                                                       </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 367 +        rows.clear();                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 368 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 369 +                                                                                                                  </span>
<span class="5541545914698662583" onmouseenter="enter('5541545914698662583');" onmouseout="out('5541545914698662583');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 370 +    private void putRowIntoMap(Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap, Tuple2&lt;String, String&gt; rowData) {       </span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 371 +        Set&lt;String&gt; keySet = rowDataMap.keySet();                                                                 </span>
<span class="-4115511162008757651" onmouseenter="enter('-4115511162008757651');" onmouseout="out('-4115511162008757651');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 372 +        ArrayList&lt;String&gt; tempRowArray;                                                                           </span>
<span class="-6312285345137005178" onmouseenter="enter('-6312285345137005178');" onmouseout="out('-6312285345137005178');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 373 +        if (keySet.contains(rowData.f0)) {                                                                        </span>
<span class="2063657660163215007" onmouseenter="enter('2063657660163215007');" onmouseout="out('2063657660163215007');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 374 +            tempRowArray = rowDataMap.get(rowData.f0);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 375 +        } else {                                                                                                  </span>
<span class="7109917545131433172" onmouseenter="enter('7109917545131433172');" onmouseout="out('7109917545131433172');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 376 +            tempRowArray = new ArrayList&lt;&gt;();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 377 +        }                                                                                                         </span>
<span class="1467529594977533778" onmouseenter="enter('1467529594977533778');" onmouseout="out('1467529594977533778');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 378 +        tempRowArray.add(rowData.f1);                                                                             </span>
<span class="6767865840186405987" onmouseenter="enter('6767865840186405987');" onmouseout="out('6767865840186405987');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 379 +        rowDataMap.put(rowData.f0, tempRowArray);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 380 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 381 +                                                                                                                  </span>
<span class="3578278218776325408" onmouseenter="enter('3578278218776325408');" onmouseout="out('3578278218776325408');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 382 +    private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPartitionFields, List&lt;String&gt; fieldTypes, String partitionFields) {"> 382 +    private List&lt;String&gt; rebuildFieldNameListAndTypeList(List&lt;String&gt; fieldNames, List&lt;String&gt; staticPartitionFiel🔵</abbr></span>
<span class="-9170183165643435780" onmouseenter="enter('-9170183165643435780');" onmouseout="out('-9170183165643435780');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 383 +        if (partitionFields.isEmpty()) {                                                                          </span>
<span class="2916035488958294792" onmouseenter="enter('2916035488958294792');" onmouseout="out('2916035488958294792');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 384 +            return fieldNames;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 385 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 386 +                                                                                                                  </span>
<span class="7990418778069769767" onmouseenter="enter('7990418778069769767');" onmouseout="out('7990418778069769767');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 387 +        List&lt;String&gt; valueFields = new ArrayList&lt;&gt;(fieldNames);                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 388 +                                                                                                                  </span>
<span class="2302239674432319726" onmouseenter="enter('2302239674432319726');" onmouseout="out('2302239674432319726');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 389 +        for (int i = valueFields.size() - 1; i &gt;= 0; i--) {                                                       </span>
<span class="-8004931019804249555" onmouseenter="enter('-8004931019804249555');" onmouseout="out('-8004931019804249555');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 390 +            if (staticPartitionFields.contains(fieldNames.get(i))) {                                              </span>
<span class="-3872161480019783193" onmouseenter="enter('-3872161480019783193');" onmouseout="out('-3872161480019783193');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 391 +                valueFields.remove(i);                                                                            </span>
<span class="5504621354582269117" onmouseenter="enter('5504621354582269117');" onmouseout="out('5504621354582269117');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 392 +                fieldTypes.remove(i);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 393 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 394 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 395 +                                                                                                                  </span>
<span class="8724369392835521335" onmouseenter="enter('8724369392835521335');" onmouseout="out('8724369392835521335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 396 +        for (int i = 0; i &lt; valueFields.size(); i++) {                                                            </span>
<span class="4573573241123850638" onmouseenter="enter('4573573241123850638');" onmouseout="out('4573573241123850638');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 397 +            if (partitionFields.contains(fieldNames.get(i))) {                                                    </span>
<span class="-6733214010943616061" onmouseenter="enter('-6733214010943616061');" onmouseout="out('-6733214010943616061');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 398 +                valueFields.add(valueFields.remove(i));                                                           </span>
<span class="3100686975272655596" onmouseenter="enter('3100686975272655596');" onmouseout="out('3100686975272655596');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 399 +                fieldTypes.add(fieldTypes.remove(i));                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 400 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 401 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 402 +                                                                                                                  </span>
<span class="-4055330890426471630" onmouseenter="enter('-4055330890426471630');" onmouseout="out('-4055330890426471630');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 403 +        return valueFields;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 404 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 405 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 406 +    /**                                                                                                           </span>
<span class="-8974785826875952090" onmouseenter="enter('-8974785826875952090');" onmouseout="out('-8974785826875952090');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 407 +     * Quote a specific type of value, like string, timestamp                                                     </span>
<span class="-6015231753011783708" onmouseenter="enter('-6015231753011783708');" onmouseout="out('-6015231753011783708');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 408 +     * before: 1, cast(tiezhu as string), cast(2001-01-09 01:05:01 as timestamp), cast(123 as int)                </span>
<span class="-9072843877687738552" onmouseenter="enter('-9072843877687738552');" onmouseout="out('-9072843877687738552');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 409 +     * after: 1, cast(&#x27;tiezhu&#x27; as string), cast(&#x27;2001-01-09 01:05:01&#x27; as timestamp), cast(123 as int)             </span>
<span class="1334750812652161584" onmouseenter="enter('1334750812652161584');" onmouseout="out('1334750812652161584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 410 +     * if cast value is null, then cast(null as type)                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 411 +     *                                                                                                            </span>
<span class="-7193371921927395943" onmouseenter="enter('-7193371921927395943');" onmouseout="out('-7193371921927395943');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 412 +     * @param valueCondition original value condition                                                             </span>
<span class="-4015247136226058388" onmouseenter="enter('-4015247136226058388');" onmouseout="out('-4015247136226058388');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 413 +     * @return quoted condition                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 414 +     */                                                                                                           </span>
<span class="-8514684189215878898" onmouseenter="enter('-8514684189215878898');" onmouseout="out('-8514684189215878898');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 415 +    private String valueConditionAddQuotation(String valueCondition) {                                            </span>
<span class="-7296893889335175056" onmouseenter="enter('-7296893889335175056');" onmouseout="out('-7296893889335175056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 416 +        String[] temps = valueCondition.split(&quot;,&quot;);                                                               </span>
<span class="936116613567496626" onmouseenter="enter('936116613567496626');" onmouseout="out('936116613567496626');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 417 +        List&lt;String&gt; replacedItem = new ArrayList&lt;&gt;();                                                            </span>
<span class="-3322970786555187036" onmouseenter="enter('-3322970786555187036');" onmouseout="out('-3322970786555187036');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 418 +        Arrays.stream(temps).forEach(                                                                             </span>
<span class="4635365489417489024" onmouseenter="enter('4635365489417489024');" onmouseout="out('4635365489417489024');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 419 +                item -&gt; {                                                                                         </span>
<span class="-4536988729093203149" onmouseenter="enter('-4536988729093203149');" onmouseout="out('-4536988729093203149');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 420 +                    Matcher matcher = TYPE_PATTERN.matcher(item);                                                 </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 421 +                    while (matcher.find()) {                                                                      </span>
<span class="4482463139402405127" onmouseenter="enter('4482463139402405127');" onmouseout="out('4482463139402405127');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 422 +                        String value = matcher.group(1);                                                          </span>
<span class="-7401464861945434758" onmouseenter="enter('-7401464861945434758');" onmouseout="out('-7401464861945434758');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 423 +                        String type = matcher.group(2);                                                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 424 +                                                                                                                  </span>
<span class="173086077329077799" onmouseenter="enter('173086077329077799');" onmouseout="out('173086077329077799');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 425 +                        for (String needQuoteType : NEED_QUOTE_TYPE) {                                            </span>
<span class="-6207157170096749111" onmouseenter="enter('-6207157170096749111');" onmouseout="out('-6207157170096749111');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 426 +                            if (type.contains(needQuoteType)) {                                                   </span>
<span class="8347227757103419143" onmouseenter="enter('8347227757103419143');" onmouseout="out('8347227757103419143');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 427 +                                if (!&quot;null&quot;.equals(value)) {                                                      </span>
<span class="-4537434762580953169" onmouseenter="enter('-4537434762580953169');" onmouseout="out('-4537434762580953169');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 428 +                                    item = item.replace(value, &quot;&#x27;&quot; + value + &quot;&#x27;&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 429 +                                }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 430 +                            }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 431 +                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 433 -                });                                                                                               </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 434 -            } catch (InterruptedException e) {                                                                    </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 435 -                e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 436 -            }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 437 -        } else {                                                                                                  </span>
<span class="7285583204821622280" onmouseenter="enter('7285583204821622280');" onmouseout="out('7285583204821622280');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 438 -            super.open(taskNumber, numTasks);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 439 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 440 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 441 -                                                                                                                  </span>
<span class="-2253996235710800331" onmouseenter="enter('-2253996235710800331');" onmouseout="out('-2253996235710800331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 442 -    public static Builder impalaBuilder() {                                                                       </span>
<span class="8193346150481678438" onmouseenter="enter('8193346150481678438');" onmouseout="out('8193346150481678438');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 443 +                    replacedItem.add(item);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 444 +                }                                                                                                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 445 +        );                                                                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 446 +                                                                                                                  </span>
<span class="7763750891527797776" onmouseenter="enter('7763750891527797776');" onmouseout="out('7763750891527797776');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 447 +        return &quot;(&quot; + String.join(&quot;, &quot;, replacedItem) + &quot;)&quot;;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 448 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 449 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 450 +    @Override                                                                                                     </span>
<span class="-8766503565464123288" onmouseenter="enter('-8766503565464123288');" onmouseout="out('-8766503565464123288');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 451 +    public void writeRecord(Tuple2&lt;Boolean, Row&gt; record) throws IOException {                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 452 +        try {                                                                                                     </span>
<span class="-1438543337409690372" onmouseenter="enter('-1438543337409690372');" onmouseout="out('-1438543337409690372');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 453 +            if (!record.f0) {                                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 454 +                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 455 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 456 +                                                                                                                  </span>
<span class="-8847095116449263406" onmouseenter="enter('-8847095116449263406');" onmouseout="out('-8847095116449263406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 457 +            if (outRecords.getCount() % RECEIVE_DATA_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {              </span>
<span class="867853870420543335" onmouseenter="enter('867853870420543335');" onmouseout="out('867853870420543335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 458 +                LOG.info(&quot;Receive data : {}&quot;, record);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 459 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 460 +                                                                                                                  </span>
<span class="6938128932061491747" onmouseenter="enter('6938128932061491747');" onmouseout="out('6938128932061491747');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 461 +            if (updateMode.equalsIgnoreCase(UPDATE_MODE)) {                                                       </span>
<span class="-4538110507205524162" onmouseenter="enter('-4538110507205524162');" onmouseout="out('-4538110507205524162');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 462 +                rows.add(Row.copy(record.f1));                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 463 +            } else {                                                                                              </span>
<span class="-7917205410914838057" onmouseenter="enter('-7917205410914838057');" onmouseout="out('-7917205410914838057');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 464 +                Map&lt;String, Object&gt; valueMap = Maps.newHashMap();                                                 </span>
<span class="1869446492779313508" onmouseenter="enter('1869446492779313508');" onmouseout="out('1869446492779313508');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 465 +                Row row = Row.copy(record.f1);                                                                    </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 466 +                                                                                                                  </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 467 +                for (int i = 0; i &lt; row.getArity(); i++) {                                                        </span>
<span class="5876572039273015428" onmouseenter="enter('5876572039273015428');" onmouseout="out('5876572039273015428');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 468 +                    valueMap.put(fieldNames.get(i), row.getField(i));                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 469 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 470 +                                                                                                                  </span>
<span class="-991390362203857814" onmouseenter="enter('-991390362203857814');" onmouseout="out('-991390362203857814');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 471 +                Tuple2&lt;String, String&gt; rowTuple2 = new Tuple2&lt;&gt;();                                                </span>
<span class="-209542121488547867" onmouseenter="enter('-209542121488547867');" onmouseout="out('-209542121488547867');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 472 +                if (storeType.equalsIgnoreCase(KUDU_TYPE) || !enablePartition) {                                  </span>
<span class="-4830782679838689768" onmouseenter="enter('-4830782679838689768');" onmouseout="out('-4830782679838689768');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 473 +                    rowTuple2.f0 = NO_PARTITION;                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 474 +                } else {                                                                                          </span>
<span class="5139395380358692168" onmouseenter="enter('5139395380358692168');" onmouseout="out('5139395380358692168');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 475 +                    rowTuple2.f0 = buildPartitionCondition(valueMap, partitionFields, staticPartitionFields);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 476 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 477 +                                                                                                                  </span>
<span class="-484968884065413564" onmouseenter="enter('-484968884065413564');" onmouseout="out('-484968884065413564');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 478 +                // 根据字段名对 row data 重组, 比如，原始 row data : (1, xxx, 20) -&gt; (id, name, age)                           </span>
<span class="2038150889857603205" onmouseenter="enter('2038150889857603205');" onmouseout="out('2038150889857603205');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 479 +                // 但是由于 partition，写入的field 顺序变成了 (name, id, age)，则需要对 row data 重组变成 (xxx, 1, 20)                  </span>
<span class="5421203580895226953" onmouseenter="enter('5421203580895226953');" onmouseout="out('5421203580895226953');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 480 +                Row rowValue = new Row(fieldTypes.size());                                                        </span>
<span class="-7699243670258396145" onmouseenter="enter('-7699243670258396145');" onmouseout="out('-7699243670258396145');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 481 +                for (int i = 0; i &lt; fieldTypes.size(); i++) {                                                     </span>
<span class="2312799749991659832" onmouseenter="enter('2312799749991659832');" onmouseout="out('2312799749991659832');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 482 +                    rowValue.setField(i, valueMap.get(valueFieldNames.get(i)));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 483 +                }                                                                                                 </span>
<span class="8595450652771675183" onmouseenter="enter('8595450652771675183');" onmouseout="out('8595450652771675183');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 484 +                rowTuple2.f1 = valueConditionAddQuotation(buildValuesCondition(fieldTypes, rowValue));            </span>
<span class="8896132355788887171" onmouseenter="enter('8896132355788887171');" onmouseout="out('8896132355788887171');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 485 +                putRowIntoMap(rowDataMap, rowTuple2);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 486 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 487 +                                                                                                                  </span>
<span class="-1784546571648451896" onmouseenter="enter('-1784546571648451896');" onmouseout="out('-1784546571648451896');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 488 +            batchCount++;                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 489 +                                                                                                                  </span>
<span class="2059038061408804342" onmouseenter="enter('2059038061408804342');" onmouseout="out('2059038061408804342');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 490 +            if (batchCount &gt;= batchSize) {                                                                        </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 491 +                flush();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 492 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 493 +                                                                                                                  </span>
<span class="-2147939016446724954" onmouseenter="enter('-2147939016446724954');" onmouseout="out('-2147939016446724954');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 494 +            // Receive data                                                                                       </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 495 +            outRecords.inc();                                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 496 +        } catch (Exception e) {                                                                                   </span>
<span class="-6314596404725474749" onmouseenter="enter('-6314596404725474749');" onmouseout="out('-6314596404725474749');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 497 +            throw new IOException(&quot;Writing records to impala failed.&quot;, e);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 498 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 499 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 500 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 501 +    @Override                                                                                                     </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 502 +    public void close() throws IOException {                                                                      </span>
<span class="6765329276469905715" onmouseenter="enter('6765329276469905715');" onmouseout="out('6765329276469905715');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 503 +        if (closed) {                                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 504 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 505 +        }                                                                                                         </span>
<span class="-8247099019020917877" onmouseenter="enter('-8247099019020917877');" onmouseout="out('-8247099019020917877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 506 +        // 将还未执行的SQL flush                                                                                        </span>
<span class="5034389177641676100" onmouseenter="enter('5034389177641676100');" onmouseout="out('5034389177641676100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 507 +        if (batchCount &gt; 0) {                                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 508 +            try {                                                                                                 </span>
<span class="-3801963607042405446" onmouseenter="enter('-3801963607042405446');" onmouseout="out('-3801963607042405446');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 509 +                flush();                                                                                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 510 +            } catch (Exception e) {                                                                               </span>
<span class="1679153721811128255" onmouseenter="enter('1679153721811128255');" onmouseout="out('1679153721811128255');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 511 +                throw new RuntimeException(&quot;Writing records to impala failed.&quot;, e);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 512 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 513 +        }                                                                                                         </span>
<span class="4306800238416480323" onmouseenter="enter('4306800238416480323');" onmouseout="out('4306800238416480323');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 514 +        // cancel scheduled task                                                                                  </span>
<span class="-1257031862697527304" onmouseenter="enter('-1257031862697527304');" onmouseout="out('-1257031862697527304');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 515 +        if (this.scheduledFuture != null) {                                                                       </span>
<span class="-290660898949228596" onmouseenter="enter('-290660898949228596');" onmouseout="out('-290660898949228596');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 516 +            scheduledFuture.cancel(false);                                                                        </span>
<span class="-3367227577965762682" onmouseenter="enter('-3367227577965762682');" onmouseout="out('-3367227577965762682');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 517 +            this.scheduler.shutdown();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 518 +        }                                                                                                         </span>
<span class="-6918026600162299955" onmouseenter="enter('-6918026600162299955');" onmouseout="out('-6918026600162299955');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 519 +        // close connection                                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 520 +        try {                                                                                                     </span>
<span class="7850482504012729998" onmouseenter="enter('7850482504012729998');" onmouseout="out('7850482504012729998');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 521 +            if (connection != null &amp;&amp; connection.isValid(DEFAULT_CONN_TIME_OUT)) {                                </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 522 +                connection.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 523 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 524 +                                                                                                                  </span>
<span class="5036557091369948437" onmouseenter="enter('5036557091369948437');" onmouseout="out('5036557091369948437');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 525 +            if (statement != null &amp;&amp; !statement.isClosed()) {                                                     </span>
<span class="-4290000005499431342" onmouseenter="enter('-4290000005499431342');" onmouseout="out('-4290000005499431342');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 526 +                statement.close();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 527 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 528 +                                                                                                                  </span>
<span class="-3745862640690712208" onmouseenter="enter('-3745862640690712208');" onmouseout="out('-3745862640690712208');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 529 +            if (updateStatement != null &amp;&amp; !updateStatement.isClosed()) {                                         </span>
<span class="6285223499122042502" onmouseenter="enter('6285223499122042502');" onmouseout="out('6285223499122042502');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 530 +                updateStatement.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 531 +            }                                                                                                     </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 532 +        } catch (SQLException e) {                                                                                </span>
<span class="-8800633426745397107" onmouseenter="enter('-8800633426745397107');" onmouseout="out('-8800633426745397107');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 533 +            throw new RuntimeException(&quot;impala connection close failed!&quot;, e);                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 534 +        } finally {                                                                                               </span>
<span class="8335594207613379924" onmouseenter="enter('8335594207613379924');" onmouseout="out('8335594207613379924');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 535 +            connection = null;                                                                                    </span>
<span class="-8855760725718402841" onmouseenter="enter('-8855760725718402841');" onmouseout="out('-8855760725718402841');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 536 +            statement = null;                                                                                     </span>
<span class="-7841270215011717932" onmouseenter="enter('-7841270215011717932');" onmouseout="out('-7841270215011717932');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 537 +            updateStatement = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 538 +        }                                                                                                         </span>
<span class="5606214304023690467" onmouseenter="enter('5606214304023690467');" onmouseout="out('5606214304023690467');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 539 +        closed = true;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 540 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 541 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 542 +    /**                                                                                                           </span>
<span class="1296337810927918625" onmouseenter="enter('1296337810927918625');" onmouseout="out('1296337810927918625');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 543 +     * execute batch sql from row data map                                                                        </span>
<span class="-5974232274386764846" onmouseenter="enter('-5974232274386764846');" onmouseout="out('-5974232274386764846');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 544 +     * sql like &#x27;insert into tableName(f1, f2, f3) ${partitionCondition} values(v1, v2, v3), (v4, v5, v6)....     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 545 +     *                                                                                                            </span>
<span class="3064025681804756869" onmouseenter="enter('3064025681804756869');" onmouseout="out('3064025681804756869');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 546 +     * @param statement       execute statement                                                                   </span>
<span class="4252025712922498493" onmouseenter="enter('4252025712922498493');" onmouseout="out('4252025712922498493');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 547 +     * @param tempSql         template sql                                                                        </span>
<span class="-888616451537648959" onmouseenter="enter('-888616451537648959');" onmouseout="out('-888616451537648959');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 548 +     * @param storeType       the store type of data                                                              </span>
<span class="-5301096736775778703" onmouseenter="enter('-5301096736775778703');" onmouseout="out('-5301096736775778703');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 549 +     * @param enablePartition enable partition or not                                                             </span>
<span class="-7243431631208061298" onmouseenter="enter('-7243431631208061298');" onmouseout="out('-7243431631208061298');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 550 +     * @param fieldNames      field name list                                                                     </span>
<span class="991482749163976330" onmouseenter="enter('991482749163976330');" onmouseout="out('991482749163976330');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 551 +     * @param partitionFields partition fields                                                                    </span>
<span class="5552251290683891506" onmouseenter="enter('5552251290683891506');" onmouseout="out('5552251290683891506');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 552 +     * @param rowDataMap      row data map                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 553 +     */                                                                                                           </span>
<span class="4208908199550530657" onmouseenter="enter('4208908199550530657');" onmouseout="out('4208908199550530657');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 554 +    private void executeBatchSql(Statement statement,                                                             </span>
<span class="2680326069917862152" onmouseenter="enter('2680326069917862152');" onmouseout="out('2680326069917862152');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 555 +                                 String tempSql,                                                                  </span>
<span class="-1880214364205558871" onmouseenter="enter('-1880214364205558871');" onmouseout="out('-1880214364205558871');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 556 +                                 String schema,                                                                   </span>
<span class="6859219661302664351" onmouseenter="enter('6859219661302664351');" onmouseout="out('6859219661302664351');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 557 +                                 String tableName,                                                                </span>
<span class="3305030788069730493" onmouseenter="enter('3305030788069730493');" onmouseout="out('3305030788069730493');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 558 +                                 String storeType,                                                                </span>
<span class="3282308130032253418" onmouseenter="enter('3282308130032253418');" onmouseout="out('3282308130032253418');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 559 +                                 Boolean enablePartition,                                                         </span>
<span class="-3269341593111050509" onmouseenter="enter('-3269341593111050509');" onmouseout="out('-3269341593111050509');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 560 +                                 List&lt;String&gt; fieldNames,                                                         </span>
<span class="-152366337684528954" onmouseenter="enter('-152366337684528954');" onmouseout="out('-152366337684528954');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 561 +                                 String partitionFields,                                                          </span>
<span class="5702355489208114022" onmouseenter="enter('5702355489208114022');" onmouseout="out('5702355489208114022');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 562 +                                 Map&lt;String, ArrayList&lt;String&gt;&gt; rowDataMap) {                                     </span>
<span class="-8058960308042609674" onmouseenter="enter('-8058960308042609674');" onmouseout="out('-8058960308042609674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 563 +        StringBuilder valuesCondition = new StringBuilder();                                                      </span>
<span class="-1699639020719600437" onmouseenter="enter('-1699639020719600437');" onmouseout="out('-1699639020719600437');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 564 +        StringBuilder partitionCondition = new StringBuilder();                                                   </span>
<span class="4484344279813579809" onmouseenter="enter('4484344279813579809');" onmouseout="out('4484344279813579809');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 565 +        String tableFieldsCondition = buildTableFieldsCondition(fieldNames, partitionFields);                     </span>
<span class="-2056467323596282224" onmouseenter="enter('-2056467323596282224');" onmouseout="out('-2056467323596282224');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 566 +        ArrayList&lt;String&gt; rowData;                                                                                </span>
<span class="3545700907988930339" onmouseenter="enter('3545700907988930339');" onmouseout="out('3545700907988930339');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 567 +        String tableNameInfo = Objects.isNull(schema) ?                                                           </span>
<span class="1480493120427294696" onmouseenter="enter('1480493120427294696');" onmouseout="out('1480493120427294696');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 568 +                tableName : quoteIdentifier(schema) + &quot;.&quot; + tableName;                                            </span>
<span class="-7586945217349428495" onmouseenter="enter('-7586945217349428495');" onmouseout="out('-7586945217349428495');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 569 +        tempSql = tempSql.replace(&quot;tableName&quot;, tableNameInfo);                                                    </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 570 +                                                                                                                  </span>
<span class="-739313269293547881" onmouseenter="enter('-739313269293547881');" onmouseout="out('-739313269293547881');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 571 +        // kudu ${partitionCondition} is null                                                                     </span>
<span class="-209542121488547867" onmouseenter="enter('-209542121488547867');" onmouseout="out('-209542121488547867');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 572 +        if (storeType.equalsIgnoreCase(KUDU_TYPE) || !enablePartition) {                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 573 +            try {                                                                                                 </span>
<span class="-2154584329942843601" onmouseenter="enter('-2154584329942843601');" onmouseout="out('-2154584329942843601');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 574 +                rowData = rowDataMap.get(NO_PARTITION);                                                           </span>
<span class="8347805769565999916" onmouseenter="enter('8347805769565999916');" onmouseout="out('8347805769565999916');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 575 +                rowData.forEach(row -&gt; valuesCondition.append(row).append(&quot;, &quot;));                                 </span>
<span class="3083642816500849348" onmouseenter="enter('3083642816500849348');" onmouseout="out('3083642816500849348');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 576 +                String executeSql = tempSql.replace(VALUES_CONDITION, valuesCondition.toString())                 </span>
<span class="1750592158576848918" onmouseenter="enter('1750592158576848918');" onmouseout="out('1750592158576848918');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 577 +                        .replace(PARTITION_CONDITION, partitionCondition.toString())                              </span>
<span class="1939264830691633930" onmouseenter="enter('1939264830691633930');" onmouseout="out('1939264830691633930');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 578 +                        .replace(PARTITION_CONSTANT, &quot;&quot;)                                                          </span>
<span class="808490930961205524" onmouseenter="enter('808490930961205524');" onmouseout="out('808490930961205524');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 579 +                        .replace(TABLE_FIELDS_CONDITION, tableFieldsCondition);                                   </span>
<span class="8541330001607166782" onmouseenter="enter('8541330001607166782');" onmouseout="out('8541330001607166782');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 580 +                String substring = executeSql.substring(0, executeSql.length() - 2);                              </span>
<span class="9213214884061660178" onmouseenter="enter('9213214884061660178');" onmouseout="out('9213214884061660178');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 581 +                statement.execute(substring);                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 582 +            } catch (Exception e) {                                                                               </span>
<span class="7699356527811265570" onmouseenter="enter('7699356527811265570');" onmouseout="out('7699356527811265570');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 583 +                throw new RuntimeException(&quot;execute impala SQL error!&quot;, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 584 +            }                                                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 585 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 586 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 587 +                                                                                                                  </span>
<span class="6613720697354939567" onmouseenter="enter('6613720697354939567');" onmouseout="out('6613720697354939567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 588 +        // partition sql                                                                                          </span>
<span class="-4493594082030439612" onmouseenter="enter('-4493594082030439612');" onmouseout="out('-4493594082030439612');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 589 +        Set&lt;String&gt; keySet = rowDataMap.keySet();                                                                 </span>
<span class="6439574290523368417" onmouseenter="enter('6439574290523368417');" onmouseout="out('6439574290523368417');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 590 +        String finalTempSql = tempSql;                                                                            </span>
<span class="5286500476222551862" onmouseenter="enter('5286500476222551862');" onmouseout="out('5286500476222551862');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 591 +        for (String key : keySet) {                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 592 +            try {                                                                                                 </span>
<span class="-8214047348876131469" onmouseenter="enter('-8214047348876131469');" onmouseout="out('-8214047348876131469');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 593 +                String executeSql = String.copyValueOf(finalTempSql.toCharArray());                               </span>
<span class="225939304905434763" onmouseenter="enter('225939304905434763');" onmouseout="out('225939304905434763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 594 +                ArrayList&lt;String&gt; valuesConditionList = rowDataMap.get(key);                                      </span>
<span class="3266960038838022824" onmouseenter="enter('3266960038838022824');" onmouseout="out('3266960038838022824');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 595 +                partitionCondition.append(key);                                                                   </span>
<span class="7273478521762013154" onmouseenter="enter('7273478521762013154');" onmouseout="out('7273478521762013154');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 596 +                executeSql = executeSql.replace(PARTITION_CONDITION, partitionCondition.toString())               </span>
<span class="7623710745634070513" onmouseenter="enter('7623710745634070513');" onmouseout="out('7623710745634070513');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 597 +                        .replace(TABLE_FIELDS_CONDITION, tableFieldsCondition)                                    </span>
<span class="6339876343455538281" onmouseenter="enter('6339876343455538281');" onmouseout="out('6339876343455538281');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 598 +                        .replace(VALUES_CONDITION, String.join(&quot;, &quot;, valuesConditionList));                       </span>
<span class="7589788358669612006" onmouseenter="enter('7589788358669612006');" onmouseout="out('7589788358669612006');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 599 +                statement.execute(executeSql);                                                                    </span>
<span class="-3000902343706299075" onmouseenter="enter('-3000902343706299075');" onmouseout="out('-3000902343706299075');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 600 +                partitionCondition.delete(0, partitionCondition.length());                                        </span>
<span class="-2037802754415730828" onmouseenter="enter('-2037802754415730828');" onmouseout="out('-2037802754415730828');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 601 +            } catch (SQLException sqlException) {                                                                 </span>
<span class="-5222513116835107038" onmouseenter="enter('-5222513116835107038');" onmouseout="out('-5222513116835107038');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 602 +                throw new RuntimeException(&quot;execute impala SQL error! &quot;, sqlException);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 603 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 604 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 605 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 606 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 607 +    /**                                                                                                           </span>
<span class="-7756927092547658158" onmouseenter="enter('-7756927092547658158');" onmouseout="out('-7756927092547658158');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 608 +     * build partition condition with row data                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 609 +     *                                                                                                            </span>
<span class="3326420447531983720" onmouseenter="enter('3326420447531983720');" onmouseout="out('3326420447531983720');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 610 +     * @param rowData              row data                                                                       </span>
<span class="-4527404320823727170" onmouseenter="enter('-4527404320823727170');" onmouseout="out('-4527404320823727170');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 611 +     * @param partitionFields      partition fields                                                               </span>
<span class="-1776173940247734574" onmouseenter="enter('-1776173940247734574');" onmouseout="out('-1776173940247734574');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 612 +     * @param staticPartitionField static partition fields                                                        </span>
<span class="-1132708759906563110" onmouseenter="enter('-1132708759906563110');" onmouseout="out('-1132708759906563110');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 613 +     * @return condition like &#x27;(ptOne, ptTwo=v2)&#x27;                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 614 +     */                                                                                                           </span>
<span class="-3866187778893382496" onmouseenter="enter('-3866187778893382496');" onmouseout="out('-3866187778893382496');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 615 +    private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;String&gt; staticPartitionField) {"> 615 +    private String buildPartitionCondition(Map&lt;String, Object&gt; rowData, String partitionFields, List&lt;String&gt; stati🔵</abbr></span>
<span class="1267423885187171547" onmouseenter="enter('1267423885187171547');" onmouseout="out('1267423885187171547');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 616 +        for (String key : staticPartitionField) {                                                                 </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 617 +            StringBuilder sb = new StringBuilder();                                                               </span>
<span class="-5505398468694975344" onmouseenter="enter('-5505398468694975344');" onmouseout="out('-5505398468694975344');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 618 +            Object value = rowData.get(key);                                                                      </span>
<span class="-3546349567435071552" onmouseenter="enter('-3546349567435071552');" onmouseout="out('-3546349567435071552');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 619 +            sb.append(key).append(&quot;=&quot;).append(value);                                                             </span>
<span class="7571464430142538701" onmouseenter="enter('7571464430142538701');" onmouseout="out('7571464430142538701');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 620 +            partitionFields = partitionFields.replace(&quot;${&quot; + key + &quot;}&quot;, sb.toString());                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 621 +        }                                                                                                         </span>
<span class="-6125585623196674116" onmouseenter="enter('-6125585623196674116');" onmouseout="out('-6125585623196674116');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 622 +        return &quot;(&quot; + partitionFields + &quot;)&quot;;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 623 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 624 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 625 +    /**                                                                                                           </span>
<span class="1604816269765986224" onmouseenter="enter('1604816269765986224');" onmouseout="out('1604816269765986224');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 626 +     * build field condition according to field names                                                             </span>
<span class="-8005762898157210848" onmouseenter="enter('-8005762898157210848');" onmouseout="out('-8005762898157210848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 627 +     * replace ${tableFieldCondition}                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 628 +     *                                                                                                            </span>
<span class="-3045974832751459167" onmouseenter="enter('-3045974832751459167');" onmouseout="out('-3045974832751459167');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 629 +     * @param fieldNames      the selected field names                                                            </span>
<span class="-2115580236801058408" onmouseenter="enter('-2115580236801058408');" onmouseout="out('-2115580236801058408');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 630 +     * @param partitionFields the partition fields                                                                </span>
<span class="-2587093228749928778" onmouseenter="enter('-2587093228749928778');" onmouseout="out('-2587093228749928778');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 631 +     * @return condition like &#x27;(id, name, age)&#x27;                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 632 +     */                                                                                                           </span>
<span class="-1478951256156574678" onmouseenter="enter('-1478951256156574678');" onmouseout="out('-1478951256156574678');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 633 +    private String buildTableFieldsCondition(List&lt;String&gt; fieldNames, String partitionFields) {                   </span>
<span class="-8730756422155226372" onmouseenter="enter('-8730756422155226372');" onmouseout="out('-8730756422155226372');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 634 +        return &quot;(&quot; + fieldNames.stream()                                                                          </span>
<span class="-1124201215121024792" onmouseenter="enter('-1124201215121024792');" onmouseout="out('-1124201215121024792');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 635 +                .filter(f -&gt; !partitionFields.contains(f))                                                        </span>
<span class="4761076759122573536" onmouseenter="enter('4761076759122573536');" onmouseout="out('4761076759122573536');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 636 +                .map(this::quoteIdentifier)                                                                       </span>
<span class="-1385468130735042246" onmouseenter="enter('-1385468130735042246');" onmouseout="out('-1385468130735042246');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 637 +                .collect(Collectors.joining(&quot;, &quot;)) + &quot;)&quot;;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 638 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 639 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 640 +    /**                                                                                                           </span>
<span class="-1930125657620201419" onmouseenter="enter('-1930125657620201419');" onmouseout="out('-1930125657620201419');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 641 +     * according to field types, build the values condition                                                       </span>
<span class="-5328431915012470826" onmouseenter="enter('-5328431915012470826');" onmouseout="out('-5328431915012470826');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 642 +     * replace ${valuesCondition}                                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 643 +     *                                                                                                            </span>
<span class="889997534505017973" onmouseenter="enter('889997534505017973');" onmouseout="out('889997534505017973');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 644 +     * @param fieldTypes field types                                                                              </span>
<span class="-5792744344160442542" onmouseenter="enter('-5792744344160442542');" onmouseout="out('-5792744344160442542');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 645 +     * @return condition like &#x27;(?, ?, cast(? as string))&#x27; and &#x27;?&#x27; will be replaced with row data                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 646 +     */                                                                                                           </span>
<span class="-8753268388884688793" onmouseenter="enter('-8753268388884688793');" onmouseout="out('-8753268388884688793');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 647 +    private String buildValuesCondition(List&lt;String&gt; fieldTypes, Row row) {                                       </span>
<span class="9451785702271217" onmouseenter="enter('9451785702271217');" onmouseout="out('9451785702271217');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 648 +        String valuesCondition = fieldTypes.stream().map(                                                         </span>
<span class="-744834501831992668" onmouseenter="enter('-744834501831992668');" onmouseout="out('-744834501831992668');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 649 +                f -&gt; {                                                                                            </span>
<span class="9071647551805886291" onmouseenter="enter('9071647551805886291');" onmouseout="out('9071647551805886291');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 650 +                    for (String item : NEED_QUOTE_TYPE) {                                                         </span>
<span class="9108011392601680881" onmouseenter="enter('9108011392601680881');" onmouseout="out('9108011392601680881');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 651 +                        if (f.toLowerCase().contains(item)) {                                                     </span>
<span class="-8315565477038260180" onmouseenter="enter('-8315565477038260180');" onmouseout="out('-8315565477038260180');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 652 +                            return String.format(&quot;cast(? as %s)&quot;, f.toLowerCase());                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 653 +                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 654 +                    }                                                                                             </span>
<span class="6027958975032523467" onmouseenter="enter('6027958975032523467');" onmouseout="out('6027958975032523467');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 655 +                    return &quot;?&quot;;                                                                                   </span>
<span class="4654177507103038656" onmouseenter="enter('4654177507103038656');" onmouseout="out('4654177507103038656');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 656 +                }).collect(Collectors.joining(&quot;, &quot;));                                                             </span>
<span class="302244605993259711" onmouseenter="enter('302244605993259711');" onmouseout="out('302244605993259711');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 657 +        for (int i = 0; i &lt; row.getArity(); i++) {                                                                </span>
<span class="2602556020493426404" onmouseenter="enter('2602556020493426404');" onmouseout="out('2602556020493426404');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 658 +            valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null&quot; : row.getField(i).toString());"> 658 +            valuesCondition = valuesCondition.replaceFirst(&quot;\\?&quot;, Objects.isNull(row.getField(i)) ? &quot;null&quot; : row.g🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 659 +        }                                                                                                         </span>
<span class="6366685022999215739" onmouseenter="enter('6366685022999215739');" onmouseout="out('6366685022999215739');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 660 +        return valuesCondition;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 661 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 662 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 663 +    /**                                                                                                           </span>
<span class="2218542669560141576" onmouseenter="enter('2218542669560141576');" onmouseout="out('2218542669560141576');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 664 +     * impala update mode SQL                                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 665 +     *                                                                                                            </span>
<span class="-8218292189476554358" onmouseenter="enter('-8218292189476554358');" onmouseout="out('-8218292189476554358');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 666 +     * @return UPDATE tableName SET setCondition WHERE whereCondition                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 667 +     */                                                                                                           </span>
<span class="-3752451701752547882" onmouseenter="enter('-3752451701752547882');" onmouseout="out('-3752451701752547882');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 668 +    private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; primaryKeys) {"> 668 +    private String buildUpdateSql(String schema, String tableName, List&lt;String&gt; fieldNames, List&lt;String&gt; primaryKe🔵</abbr></span>
<span class="5528853464056789996" onmouseenter="enter('5528853464056789996');" onmouseout="out('5528853464056789996');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 669 +        //跳过primary key字段                                                                                         </span>
<span class="-8857590287628770183" onmouseenter="enter('-8857590287628770183');" onmouseout="out('-8857590287628770183');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 670 +        String setClause = fieldNames.stream()                                                                    </span>
<span class="-803297460241064625" onmouseenter="enter('-803297460241064625');" onmouseout="out('-803297460241064625');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 671 +                .filter(f -&gt; !CollectionUtils.isNotEmpty(primaryKeys) || !primaryKeys.contains(f))                </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 672 +                .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                              </span>
<span class="-209499088310020597" onmouseenter="enter('-209499088310020597');" onmouseout="out('-209499088310020597');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 673 +                .collect(Collectors.joining(&quot;, &quot;));                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 674 +                                                                                                                  </span>
<span class="-3669556570443861667" onmouseenter="enter('-3669556570443861667');" onmouseout="out('-3669556570443861667');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 675 +        String conditionClause = primaryKeys.stream()                                                             </span>
<span class="4546972743148585186" onmouseenter="enter('4546972743148585186');" onmouseout="out('4546972743148585186');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 676 +                .map(f -&gt; quoteIdentifier(f) + &quot;=?&quot;)                                                              </span>
<span class="1187060376059521362" onmouseenter="enter('1187060376059521362');" onmouseout="out('1187060376059521362');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 677 +                .collect(Collectors.joining(&quot; AND &quot;));                                                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 678 +                                                                                                                  </span>
<span class="-880277003185331688" onmouseenter="enter('-880277003185331688');" onmouseout="out('-880277003185331688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 679 +        return &quot;UPDATE &quot; + (Objects.isNull(schema) ? &quot;&quot; : quoteIdentifier(schema) + &quot;.&quot;)                          </span>
<span class="-2776062363149844820" onmouseenter="enter('-2776062363149844820');" onmouseout="out('-2776062363149844820');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 680 +                + quoteIdentifier(tableName) + &quot; SET &quot; + setClause + &quot; WHERE &quot; + conditionClause;                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 681 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 682 +                                                                                                                  </span>
<span class="4659511982989745103" onmouseenter="enter('4659511982989745103');" onmouseout="out('4659511982989745103');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 683 +    private String quoteIdentifier(String identifier) {                                                           </span>
<span class="1935684454964464658" onmouseenter="enter('1935684454964464658');" onmouseout="out('1935684454964464658');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 684 +        return &quot;`&quot; + identifier + &quot;`&quot;;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 685 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 686 +                                                                                                                  </span>
<span class="-2481914402933088399" onmouseenter="enter('-2481914402933088399');" onmouseout="out('-2481914402933088399');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 687 +    public static Builder getImpalaBuilder() {                                                                    </span>
<span class="-1926211775479526780" onmouseenter="enter('-1926211775479526780');" onmouseout="out('-1926211775479526780');" style=""> 688          return new Builder();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 689      }                                                                                                             </span>
<span  style=""> 690                                                                                                                    </span>
<span class="2010609695383714647" onmouseenter="enter('2010609695383714647');" onmouseout="out('2010609695383714647');" style=""> 691      public static class Builder {                                                                                 </span>
<span class="4789602379336077849" onmouseenter="enter('4789602379336077849');" onmouseout="out('4789602379336077849');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 692 -        private Integer authMech;                                                                                 </span>
<span class="8204488434818797662" onmouseenter="enter('8204488434818797662');" onmouseout="out('8204488434818797662');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 693 -        private String keytabPath;                                                                                </span>
<span class="-2918852778965959076" onmouseenter="enter('-2918852778965959076');" onmouseout="out('-2918852778965959076');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 694 -        private String krb5confPath;                                                                              </span>
<span class="1721154694511290827" onmouseenter="enter('1721154694511290827');" onmouseout="out('1721154694511290827');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 695 -        private String principal;                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 696 -                                                                                                                  </span>
<span class="8632875093914341707" onmouseenter="enter('8632875093914341707');" onmouseout="out('8632875093914341707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 697 -        protected JDBCOptions options;                                                                            </span>
<span class="219098296700767876" onmouseenter="enter('219098296700767876');" onmouseout="out('219098296700767876');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 698 -        protected String[] fieldNames;                                                                            </span>
<span class="5985906154332630684" onmouseenter="enter('5985906154332630684');" onmouseout="out('5985906154332630684');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 699 -        protected String[] keyFields;                                                                             </span>
<span class="-2657046113209592975" onmouseenter="enter('-2657046113209592975');" onmouseout="out('-2657046113209592975');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 700 -        protected String[] partitionFields;                                                                       </span>
<span class="-2849472784703547647" onmouseenter="enter('-2849472784703547647');" onmouseout="out('-2849472784703547647');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 701 -        protected int[] fieldTypes;                                                                               </span>
<span class="-7994526912167873617" onmouseenter="enter('-7994526912167873617');" onmouseout="out('-7994526912167873617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 702 -        protected int flushMaxSize = DEFAULT_FLUSH_MAX_SIZE;                                                      </span>
<span class="-502504972010929057" onmouseenter="enter('-502504972010929057');" onmouseout="out('-502504972010929057');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 703 -        protected long flushIntervalMills = DEFAULT_FLUSH_INTERVAL_MILLS;                                         </span>
<span class="-1781405325688028484" onmouseenter="enter('-1781405325688028484');" onmouseout="out('-1781405325688028484');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 704 -        protected boolean allReplace = DEFAULT_ALLREPLACE_VALUE;                                                  </span>
<span class="-7730622042083062639" onmouseenter="enter('-7730622042083062639');" onmouseout="out('-7730622042083062639');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 705 -        protected String updateMode;                                                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 706 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 707 -        /**                                                                                                       </span>
<span class="5481504062898961016" onmouseenter="enter('5481504062898961016');" onmouseout="out('5481504062898961016');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 708 -         * required, jdbc options.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 709 -         */                                                                                                       </span>
<span class="-6789577863566851614" onmouseenter="enter('-6789577863566851614');" onmouseout="out('-6789577863566851614');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 710 -        public Builder setOptions(JDBCOptions options) {                                                          </span>
<span class="-4576342030125016864" onmouseenter="enter('-4576342030125016864');" onmouseout="out('-4576342030125016864');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 711 -            this.options = options;                                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 712 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 713 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 714 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 715 -        /**                                                                                                       </span>
<span class="-6656747389933749738" onmouseenter="enter('-6656747389933749738');" onmouseout="out('-6656747389933749738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 716 -         * required, field names of this jdbc sink.                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 717 -         */                                                                                                       </span>
<span class="4206393146938641816" onmouseenter="enter('4206393146938641816');" onmouseout="out('4206393146938641816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 718 -        public Builder setFieldNames(String[] fieldNames) {                                                       </span>
<span class="-8533428013592676521" onmouseenter="enter('-8533428013592676521');" onmouseout="out('-8533428013592676521');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 719 -            this.fieldNames = fieldNames;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 720 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 721 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 722 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 723 -        /**                                                                                                       </span>
<span class="-7266512599063730897" onmouseenter="enter('-7266512599063730897');" onmouseout="out('-7266512599063730897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 724 -         * required, upsert unique keys.                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 725 -         */                                                                                                       </span>
<span class="5182547725706677872" onmouseenter="enter('5182547725706677872');" onmouseout="out('5182547725706677872');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 726 -        public Builder setKeyFields(List&lt;String&gt; keyFields) {                                                     </span>
<span class="-2040409877479865197" onmouseenter="enter('-2040409877479865197');" onmouseout="out('-2040409877479865197');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 727 -            this.keyFields = keyFields == null ? null : keyFields.toArray(new String[keyFields.size()]);          </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 728 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 729 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 730 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 731 -        /**                                                                                                       </span>
<span class="2669293159353915090" onmouseenter="enter('2669293159353915090');" onmouseout="out('2669293159353915090');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 732 -         * required, field types of this jdbc sink.                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 733 -         */                                                                                                       </span>
<span class="-2827077114511059363" onmouseenter="enter('-2827077114511059363');" onmouseout="out('-2827077114511059363');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 734 -        public Builder setFieldTypes(int[] fieldTypes) {                                                          </span>
<span class="7622859212288666930" onmouseenter="enter('7622859212288666930');" onmouseout="out('7622859212288666930');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 735 -            this.fieldTypes = fieldTypes;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 736 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 737 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 738 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 739 -        /**                                                                                                       </span>
<span class="8911651130315010133" onmouseenter="enter('8911651130315010133');" onmouseout="out('8911651130315010133');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 740 -         * optional, partition Fields                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 741 -         *                                                                                                        </span>
<span class="-6644816777766472486" onmouseenter="enter('-6644816777766472486');" onmouseout="out('-6644816777766472486');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 742 -         * @param partitionFields                                                                                 </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 743 -         * @return                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 744 -         */                                                                                                       </span>
<span class="85175638427035295" onmouseenter="enter('85175638427035295');" onmouseout="out('85175638427035295');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 745 -        public Builder setPartitionFields(String[] partitionFields) {                                             </span>
<span class="-5579362841573531869" onmouseenter="enter('-5579362841573531869');" onmouseout="out('-5579362841573531869');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 746 -            this.partitionFields = partitionFields;                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 747 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 748 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 749 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 750 -        /**                                                                                                       </span>
<span class="-856751752856244493" onmouseenter="enter('-856751752856244493');" onmouseout="out('-856751752856244493');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 751 -         * optional, flush max size (includes all append, upsert and delete records),                             </span>
<span class="-1144698166522235177" onmouseenter="enter('-1144698166522235177');" onmouseout="out('-1144698166522235177');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 752 -         * over this number of records, will flush data.                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 753 -         */                                                                                                       </span>
<span class="6566053436650323939" onmouseenter="enter('6566053436650323939');" onmouseout="out('6566053436650323939');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 754 -        public Builder setFlushMaxSize(int flushMaxSize) {                                                        </span>
<span class="1661332877772785928" onmouseenter="enter('1661332877772785928');" onmouseout="out('1661332877772785928');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 755 -            this.flushMaxSize = flushMaxSize;                                                                     </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 756 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 757 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 758 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 759 -        /**                                                                                                       </span>
<span class="-69172137005245494" onmouseenter="enter('-69172137005245494');" onmouseout="out('-69172137005245494');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 760 -         * optional, flush interval mills, over this time, asynchronous threads will flush data.                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 761 -         */                                                                                                       </span>
<span class="-5174969731661074679" onmouseenter="enter('-5174969731661074679');" onmouseout="out('-5174969731661074679');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 762 -        public Builder setFlushIntervalMills(long flushIntervalMills) {                                           </span>
<span class="8894509418585583190" onmouseenter="enter('8894509418585583190');" onmouseout="out('8894509418585583190');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 763 -            this.flushIntervalMills = flushIntervalMills;                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 764 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 765 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 766 -                                                                                                                  </span>
<span class="-6829645289886270021" onmouseenter="enter('-6829645289886270021');" onmouseout="out('-6829645289886270021');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 767 -        public Builder setAllReplace(boolean allReplace) {                                                        </span>
<span class="-7939456506453079727" onmouseenter="enter('-7939456506453079727');" onmouseout="out('-7939456506453079727');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 768 -            this.allReplace = allReplace;                                                                         </span>
<span class="5030308014750517924" onmouseenter="enter('5030308014750517924');" onmouseout="out('5030308014750517924');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 769 +        private final ImpalaOutputFormat format = new ImpalaOutputFormat();                                       </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 770 +                                                                                                                  </span>
<span class="4847669250945231235" onmouseenter="enter('4847669250945231235');" onmouseout="out('4847669250945231235');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 771 +        public Builder setDbUrl(String dbUrl) {                                                                   </span>
<span class="-7007213682983262515" onmouseenter="enter('-7007213682983262515');" onmouseout="out('-7007213682983262515');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 772 +            format.dbUrl = dbUrl;                                                                                 </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 773 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 774 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 775 +                                                                                                                  </span>
<span class="-2062625403058053727" onmouseenter="enter('-2062625403058053727');" onmouseout="out('-2062625403058053727');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 776 +        public Builder setUserName(String userName) {                                                             </span>
<span class="8996094991043959374" onmouseenter="enter('8996094991043959374');" onmouseout="out('8996094991043959374');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 777 +            format.userName = userName;                                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 778 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 779 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 780 +                                                                                                                  </span>
<span class="-8917696572465338538" onmouseenter="enter('-8917696572465338538');" onmouseout="out('-8917696572465338538');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 781 +        public Builder setPassword(String password) {                                                             </span>
<span class="-5617852808102302847" onmouseenter="enter('-5617852808102302847');" onmouseout="out('-5617852808102302847');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 782 +            format.password = password;                                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 783 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 784 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 785 +                                                                                                                  </span>
<span class="-6851628607924303336" onmouseenter="enter('-6851628607924303336');" onmouseout="out('-6851628607924303336');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 786 +        public Builder setBatchSize(Integer batchSize) {                                                          </span>
<span class="-6323290766219617895" onmouseenter="enter('-6323290766219617895');" onmouseout="out('-6323290766219617895');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 787 +            format.batchSize = batchSize;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 788 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 789 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 790 +                                                                                                                  </span>
<span class="5791410845050671235" onmouseenter="enter('5791410845050671235');" onmouseout="out('5791410845050671235');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 791 +        public Builder setBatchWaitInterval(Long batchWaitInterval) {                                             </span>
<span class="7659700979146023520" onmouseenter="enter('7659700979146023520');" onmouseout="out('7659700979146023520');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 792 +            format.batchWaitInterval = batchWaitInterval;                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 793 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 794 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 795 +                                                                                                                  </span>
<span class="-8777589626278372083" onmouseenter="enter('-8777589626278372083');" onmouseout="out('-8777589626278372083');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 796 +        public Builder setTableName(String tableName) {                                                           </span>
<span class="-1585853008866177938" onmouseenter="enter('-1585853008866177938');" onmouseout="out('-1585853008866177938');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 797 +            format.tableName = tableName;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 798 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 799 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 800 +                                                                                                                  </span>
<span class="221724127870954269" onmouseenter="enter('221724127870954269');" onmouseout="out('221724127870954269');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 801 +        public Builder setPartitionFields(String partitionFields) {                                               </span>
<span class="-8055214001591864073" onmouseenter="enter('-8055214001591864073');" onmouseout="out('-8055214001591864073');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 802 +            format.partitionFields = Objects.isNull(partitionFields) ?                                            </span>
<span class="6173943982789028324" onmouseenter="enter('6173943982789028324');" onmouseout="out('6173943982789028324');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 803 +                    &quot;&quot; : partitionFields;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 804 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 805 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 806 +                                                                                                                  </span>
<span class="-6994787811007556212" onmouseenter="enter('-6994787811007556212');" onmouseout="out('-6994787811007556212');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 807 +        public Builder setPrimaryKeys(List&lt;String&gt; primaryKeys) {                                                 </span>
<span class="1909693990286542032" onmouseenter="enter('1909693990286542032');" onmouseout="out('1909693990286542032');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 808 +            format.primaryKeys = primaryKeys;                                                                     </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 809 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 810 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 811 +                                                                                                                  </span>
<span class="7512351963685249159" onmouseenter="enter('7512351963685249159');" onmouseout="out('7512351963685249159');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 812 +        public Builder setSchema(String schema) {                                                                 </span>
<span class="306599522236782764" onmouseenter="enter('306599522236782764');" onmouseout="out('306599522236782764');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 813 +            format.schema = schema;                                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 814 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 815 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 816 +                                                                                                                  </span>
<span class="4541611662116992338" onmouseenter="enter('4541611662116992338');" onmouseout="out('4541611662116992338');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 817 +        public Builder setEnablePartition(Boolean enablePartition) {                                              </span>
<span class="-6976631596761488792" onmouseenter="enter('-6976631596761488792');" onmouseout="out('-6976631596761488792');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 818 +            format.enablePartition = enablePartition;                                                             </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 819              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 820          }                                                                                                         </span>
<span  style=""> 821                                                                                                                    </span>
<span class="-8865383825618932145" onmouseenter="enter('-8865383825618932145');" onmouseout="out('-8865383825618932145');" style=""> 822          public Builder setUpdateMode(String updateMode) {                                                         </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 823 -            this.updateMode = updateMode;                                                                         </span>
<span class="-2281017119849044621" onmouseenter="enter('-2281017119849044621');" onmouseout="out('-2281017119849044621');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 824 +            format.updateMode = updateMode;                                                                       </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 825 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 826 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 827 +                                                                                                                  </span>
<span class="8081013001489210313" onmouseenter="enter('8081013001489210313');" onmouseout="out('8081013001489210313');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 828 +        public Builder setFieldList(List&lt;String&gt; fieldList) {                                                     </span>
<span class="-818074055946993480" onmouseenter="enter('-818074055946993480');" onmouseout="out('-818074055946993480');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 829 +            format.fieldNames = fieldList;                                                                        </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 830 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 831 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 832 +                                                                                                                  </span>
<span class="3974737416393184735" onmouseenter="enter('3974737416393184735');" onmouseout="out('3974737416393184735');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 833 +        public Builder setFieldTypeList(List&lt;String&gt; fieldTypeList) {                                             </span>
<span class="1448747188656744713" onmouseenter="enter('1448747188656744713');" onmouseout="out('1448747188656744713');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 834 +            format.fieldTypes = fieldTypeList;                                                                    </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 835 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 836 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 837 +                                                                                                                  </span>
<span class="2244927175574628655" onmouseenter="enter('2244927175574628655');" onmouseout="out('2244927175574628655');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 838 +        public Builder setStoreType(String storeType) {                                                           </span>
<span class="-5818885152026709969" onmouseenter="enter('-5818885152026709969');" onmouseout="out('-5818885152026709969');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 839 +            format.storeType = storeType;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 840 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 841 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 842 +                                                                                                                  </span>
<span class="-5487489987508961941" onmouseenter="enter('-5487489987508961941');" onmouseout="out('-5487489987508961941');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 843 +        public Builder setFieldExtraInfoList(List&lt;AbstractTableInfo.FieldExtraInfo&gt; fieldExtraInfoList) {         </span>
<span class="160167467316759360" onmouseenter="enter('160167467316759360');" onmouseout="out('160167467316759360');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 844 +            format.fieldExtraInfoList = fieldExtraInfoList;                                                       </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 845 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 846 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 847 +                                                                                                                  </span>
<span class="1366044936846496088" onmouseenter="enter('1366044936846496088');" onmouseout="out('1366044936846496088');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 848 +        public Builder setKeyTabPath(String keyTabPath) {                                                         </span>
<span class="8755357456701014681" onmouseenter="enter('8755357456701014681');" onmouseout="out('8755357456701014681');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 849 +            format.keytabPath = keyTabPath;                                                                       </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 850 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 851 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 852 +                                                                                                                  </span>
<span class="1807007964631867819" onmouseenter="enter('1807007964631867819');" onmouseout="out('1807007964631867819');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 853 +        public Builder setKrb5ConfPath(String krb5ConfPath) {                                                     </span>
<span class="352337563234497723" onmouseenter="enter('352337563234497723');" onmouseout="out('352337563234497723');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 854 +            format.krb5confPath = krb5ConfPath;                                                                   </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 855 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 856 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 857 +                                                                                                                  </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 858 +        public Builder setPrincipal(String principal) {                                                           </span>
<span class="6894839552978791309" onmouseenter="enter('6894839552978791309');" onmouseout="out('6894839552978791309');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 859 +            format.principal = principal;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 860              return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 861          }                                                                                                         </span>
<span  style=""> 862                                                                                                                    </span>
<span class="-8991908924314829739" onmouseenter="enter('-8991908924314829739');" onmouseout="out('-8991908924314829739');" style=""> 863          public Builder setAuthMech(Integer authMech) {                                                            </span>
<span class="-4376363009887100958" onmouseenter="enter('-4376363009887100958');" onmouseout="out('-4376363009887100958');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 864 -            this.authMech = authMech;                                                                             </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 865 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 866 -        }                                                                                                         </span>
<span class="-5894016934964343602" onmouseenter="enter('-5894016934964343602');" onmouseout="out('-5894016934964343602');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 867 -        public Builder setKeytabPath(String keytabPath) {                                                         </span>
<span class="6263908765738803139" onmouseenter="enter('6263908765738803139');" onmouseout="out('6263908765738803139');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 868 -            this.keytabPath = keytabPath;                                                                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 869 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 870 -        }                                                                                                         </span>
<span class="3824864761746312224" onmouseenter="enter('3824864761746312224');" onmouseout="out('3824864761746312224');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 871 -        public Builder setKrb5confPath(String krb5confPath) {                                                     </span>
<span class="1769914571698585121" onmouseenter="enter('1769914571698585121');" onmouseout="out('1769914571698585121');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 872 -            this.krb5confPath = krb5confPath;                                                                     </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 873 -            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 874 -        }                                                                                                         </span>
<span class="-8540538228750165144" onmouseenter="enter('-8540538228750165144');" onmouseout="out('-8540538228750165144');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 875 -        public Builder setPrincipal(String principal) {                                                           </span>
<span class="-3079904782829373753" onmouseenter="enter('-3079904782829373753');" onmouseout="out('-3079904782829373753');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 876 -            this.principal = principal;                                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 877 -            return this;                                                                                          </span>
<span class="-1412915325814520049" onmouseenter="enter('-1412915325814520049');" onmouseout="out('-1412915325814520049');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 878 +            format.authMech = authMech;                                                                           </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 879 +            return this;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 880 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 881 +                                                                                                                  </span>
<span class="1564959121680510141" onmouseenter="enter('1564959121680510141');" onmouseout="out('1564959121680510141');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 882 +        private boolean canHandle(String url) {                                                                   </span>
<span class="842511305287615009" onmouseenter="enter('842511305287615009');" onmouseout="out('842511305287615009');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 883 +            return url.startsWith(&quot;jdbc:impala:&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 884          }                                                                                                         </span>
<span  style=""> 885                                                                                                                    </span>
<span class="-8521575333201954447" onmouseenter="enter('-8521575333201954447');" onmouseout="out('-8521575333201954447');" style=""> 886          public ImpalaOutputFormat build() {                                                                       </span>
<span class="-4875931377123605731" onmouseenter="enter('-4875931377123605731');" onmouseout="out('-4875931377123605731');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 887 -            checkNotNull(options, &quot;No options supplied.&quot;);                                                        </span>
<span class="-7519421098126359785" onmouseenter="enter('-7519421098126359785');" onmouseout="out('-7519421098126359785');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 888 -            checkNotNull(fieldNames, &quot;No fieldNames supplied.&quot;);                                                  </span>
<span class="-465714982636894626" onmouseenter="enter('-465714982636894626');" onmouseout="out('-465714982636894626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 889 -            return new ImpalaOutputFormat(                                                                        </span>
<span class="-1722348633561755627" onmouseenter="enter('-1722348633561755627');" onmouseout="out('-1722348633561755627');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 890 -                options,                                                                                          </span>
<span class="5871502184493971205" onmouseenter="enter('5871502184493971205');" onmouseout="out('5871502184493971205');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 891 -                fieldNames,                                                                                       </span>
<span class="7310029079968005764" onmouseenter="enter('7310029079968005764');" onmouseout="out('7310029079968005764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 892 -                keyFields,                                                                                        </span>
<span class="2377300059169474736" onmouseenter="enter('2377300059169474736');" onmouseout="out('2377300059169474736');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 893 -                partitionFields,                                                                                  </span>
<span class="3335296431284667011" onmouseenter="enter('3335296431284667011');" onmouseout="out('3335296431284667011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 894 -                fieldTypes,                                                                                       </span>
<span class="4557556655204774099" onmouseenter="enter('4557556655204774099');" onmouseout="out('4557556655204774099');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 895 -                flushMaxSize,                                                                                     </span>
<span class="6830854366214855975" onmouseenter="enter('6830854366214855975');" onmouseout="out('6830854366214855975');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 896 -                flushIntervalMills,                                                                               </span>
<span class="3306269375559778689" onmouseenter="enter('3306269375559778689');" onmouseout="out('3306269375559778689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 897 -                allReplace,                                                                                       </span>
<span class="7760506155904782707" onmouseenter="enter('7760506155904782707');" onmouseout="out('7760506155904782707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 898 -                updateMode,                                                                                       </span>
<span class="-4863483435840713149" onmouseenter="enter('-4863483435840713149');" onmouseout="out('-4863483435840713149');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 899 -                authMech,                                                                                         </span>
<span class="6910046306719868385" onmouseenter="enter('6910046306719868385');" onmouseout="out('6910046306719868385');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 900 -                keytabPath,                                                                                       </span>
<span class="2510923373943101588" onmouseenter="enter('2510923373943101588');" onmouseout="out('2510923373943101588');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 901 -                krb5confPath,                                                                                     </span>
<span class="-3475871463423309499" onmouseenter="enter('-3475871463423309499');" onmouseout="out('-3475871463423309499');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 902 -                principal);                                                                                       </span>
<span class="1659683170431033048" onmouseenter="enter('1659683170431033048');" onmouseout="out('1659683170431033048');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 903 +            if (!canHandle(format.dbUrl)) {                                                                       </span>
<span class="-4870909491096243891" onmouseenter="enter('-4870909491096243891');" onmouseout="out('-4870909491096243891');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 904 +                throw new IllegalArgumentException(&quot;impala dbUrl is illegal, check url: &quot; + format.dbUrl);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 905 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 906 +                                                                                                                  </span>
<span class="-4505121258189477360" onmouseenter="enter('-4505121258189477360');" onmouseout="out('-4505121258189477360');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 907 +            if (format.authMech == EAuthMech.Kerberos.getType()) {                                                </span>
<span class="-6183848778016991336" onmouseenter="enter('-6183848778016991336');" onmouseout="out('-6183848778016991336');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 908 +                checkNotNull(format.krb5confPath,                                                                 </span>
<span class="-4038272028328025626" onmouseenter="enter('-4038272028328025626');" onmouseout="out('-4038272028328025626');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 909 +                        &quot;When kerberos authentication is enabled, krb5confPath is required！&quot;);                    </span>
<span class="-1753032521002756428" onmouseenter="enter('-1753032521002756428');" onmouseout="out('-1753032521002756428');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 910 +                checkNotNull(format.principal,                                                                    </span>
<span class="-5219129049333790569" onmouseenter="enter('-5219129049333790569');" onmouseout="out('-5219129049333790569');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 911 +                        &quot;When kerberos authentication is enabled, principal is required！&quot;);                       </span>
<span class="-3070330065691611476" onmouseenter="enter('-3070330065691611476');" onmouseout="out('-3070330065691611476');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 912 +                checkNotNull(format.keytabPath,                                                                   </span>
<span class="-393994981289522477" onmouseenter="enter('-393994981289522477');" onmouseout="out('-393994981289522477');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 913 +                        &quot;When kerberos authentication is enabled, keytabPath is required！&quot;);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 914 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 915 +                                                                                                                  </span>
<span class="-5111581416826137591" onmouseenter="enter('-5111581416826137591');" onmouseout="out('-5111581416826137591');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 916 +            if (format.authMech == EAuthMech.UserName.getType()) {                                                </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 917 +                checkNotNull(format.userName, &quot;userName is required!&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 918 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 919 +                                                                                                                  </span>
<span class="-3238564706659558925" onmouseenter="enter('-3238564706659558925');" onmouseout="out('-3238564706659558925');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 920 +            if (format.authMech == EAuthMech.NameANDPassword.getType()) {                                         </span>
<span class="-5189195878644032060" onmouseenter="enter('-5189195878644032060');" onmouseout="out('-5189195878644032060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 921 +                checkNotNull(format.userName, &quot;userName is required!&quot;);                                           </span>
<span class="-9040493906648204146" onmouseenter="enter('-9040493906648204146');" onmouseout="out('-9040493906648204146');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 922 +                checkNotNull(format.password, &quot;password is required!&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 923 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 924 +                                                                                                                  </span>
<span class="1310568763423505425" onmouseenter="enter('1310568763423505425');" onmouseout="out('1310568763423505425');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 925 +            checkNotNull(format.storeType, &quot;storeType is required!&quot;);                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 926 +                                                                                                                  </span>
<span class="9058009825496417823" onmouseenter="enter('9058009825496417823');" onmouseout="out('9058009825496417823');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 927 +            return format;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 928          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 929      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 930  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            