<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>503 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.side.cache.AbsSideCache;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlBasicCall;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlIdentifier;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlKind;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlNode;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.java.typeutils.RowTypeInfo;\n&#x27;
                           &#x27;import com.google.common.collect.Lists;\n&#x27;
                           &#x27;import com.google.common.collect.Maps;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.io.Serializable;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class SideInfo implements &#x27;
                           &#x27;Serializable{\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected RowTypeInfo rowTypeInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;FieldInfo&gt; outFieldInfoList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;String&gt; equalFieldList = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;Integer&gt; equalValIndex = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sqlCondition = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sideSelectFields = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected JoinType joinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value: the ref field index\u200bin the input &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; inFieldIndex = &#x27;
                           &#x27;Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field index\u200bin the side &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; sideFieldIndex &#x27;
                           &#x27;= Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field name\u200bin the side table\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideFieldNameIndex = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideTableInfo sideTableInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected AbsSideCache sideCache;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideInfo(RowTypeInfo rowTypeInfo, &#x27;
                           &#x27;JoinInfo joinInfo, List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList,\n&#x27;
                           &#x27;                    SideTableInfo sideTableInfo){\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;        this.joinType = joinInfo.getJoinType();\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;        parseSelectFields(joinInfo);\n&#x27;
                           &#x27;        buildEqualInfo(joinInfo, sideTableInfo);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void parseSelectFields(JoinInfo &#x27;
                           &#x27;joinInfo){\n&#x27;
                           &#x27;        String sideTableName = &#x27;
                           &#x27;joinInfo.getSideTableName();\n&#x27;
                           &#x27;        String nonSideTableName = &#x27;
                           &#x27;joinInfo.getNonSideTable();\n&#x27;
                           &#x27;        List&lt;String&gt; fields = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;        int sideTableFieldIndex = 0;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        for( int i=0; i&lt;outFieldInfoList.size(); &#x27;
                           &#x27;i++){\n&#x27;
                           &#x27;            FieldInfo fieldInfo = &#x27;
                           &#x27;outFieldInfoList.get(i);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;                String sideFieldName = &#x27;
                           &#x27;sideTableInfo.getPhysicalFields().getOrDefault(fieldInfo.getFieldName(), &#x27;
                           &#x27;fieldInfo.getFieldName());\n&#x27;
                           &#x27;                fields.add(sideFieldName);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;sideSelectFieldsType.put(sideTableFieldIndex, &#x27;
                           &#x27;getTargetFieldType(fieldInfo.getFieldName()));\n&#x27;
                           &#x27;                sideFieldIndex.put(i, &#x27;
                           &#x27;sideTableFieldIndex);\n&#x27;
                           &#x27;                sideFieldNameIndex.put(i, &#x27;
                           &#x27;sideFieldName);\n&#x27;
                           &#x27;                sideTableFieldIndex++;\n&#x27;
                           &#x27;            }else &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(nonSideTableName)){\n&#x27;
                           &#x27;                int nonSideIndex = &#x27;
                           &#x27;rowTypeInfo.getFieldIndex(fieldInfo.getFieldName());\n&#x27;
                           &#x27;                inFieldIndex.put(i, &#x27;
                           &#x27;nonSideIndex);\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                throw new &#x27;
                           &#x27;RuntimeException(&quot;unknown table &quot; + &#x27;
                           &#x27;fieldInfo.getTable());\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if(fields.size() == 0){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;select non &#x27;
                           &#x27;field from table &quot; +  sideTableName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        sideSelectFields = String.join(&quot;,&quot;, &#x27;
                           &#x27;fields);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getTargetFieldType(String &#x27;
                           &#x27;fieldName){\n&#x27;
                           &#x27;        int fieldIndex = &#x27;
                           &#x27;sideTableInfo.getFieldList().indexOf(fieldName);\n&#x27;
                           &#x27;        if(fieldIndex == -1){\n&#x27;
                           &#x27;            throw new &#x27;
                           &#x27;RuntimeException(sideTableInfo.getName() + &quot;can\&#x27;t &#x27;
                           &#x27;find field: &quot; + fieldName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;sideTableInfo.getFieldTypes()[fieldIndex];\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void dealOneEqualCon(SqlNode sqlNode, &#x27;
                           &#x27;String sideTableName){\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(!SqlKind.COMPARISON.contains(sqlNode.getKind())){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;not &#x27;
                           &#x27;compare operator.&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        SqlIdentifier left = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];\n&#x27;
                           &#x27;        SqlIdentifier right = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String leftTableName = &#x27;
                           &#x27;left.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String leftField = &#x27;
                           &#x27;left.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String rightTableName = &#x27;
                           &#x27;right.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String rightField = &#x27;
                           &#x27;right.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(leftTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;            equalFieldList.add(leftField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(rightField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else &#x27;
                           &#x27;if(rightTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalFieldList.add(rightField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(leftField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else{\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;resolve &#x27;
                           &#x27;equalFieldList error:&quot; + sqlNode.toString());\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public abstract void buildEqualInfo(JoinInfo &#x27;
                           &#x27;joinInfo, SideTableInfo sideTableInfo);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public RowTypeInfo getRowTypeInfo() {\n&#x27;
                           &#x27;        return rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setRowTypeInfo(RowTypeInfo &#x27;
                           &#x27;rowTypeInfo) {\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;FieldInfo&gt; getOutFieldInfoList() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setOutFieldInfoList(List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList) {\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;String&gt; getEqualFieldList() {\n&#x27;
                           &#x27;        return equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualFieldList(List&lt;String&gt; &#x27;
                           &#x27;equalFieldList) {\n&#x27;
                           &#x27;        this.equalFieldList = equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;Integer&gt; getEqualValIndex() {\n&#x27;
                           &#x27;        return equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualValIndex(List&lt;Integer&gt; &#x27;
                           &#x27;equalValIndex) {\n&#x27;
                           &#x27;        this.equalValIndex = equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSqlCondition() {\n&#x27;
                           &#x27;        return sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSqlCondition(String &#x27;
                           &#x27;sqlCondition) {\n&#x27;
                           &#x27;        this.sqlCondition = sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSideSelectFields() {\n&#x27;
                           &#x27;        return sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideSelectFields(String &#x27;
                           &#x27;sideSelectFields) {\n&#x27;
                           &#x27;        this.sideSelectFields = sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public JoinType getJoinType() {\n&#x27;
                           &#x27;        return joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setJoinType(JoinType joinType) {\n&#x27;
                           &#x27;        this.joinType = joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; getInFieldIndex() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setInFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; inFieldIndex) {\n&#x27;
                           &#x27;        this.inFieldIndex = inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; &#x27;
                           &#x27;getSideFieldIndex() {\n&#x27;
                           &#x27;        return sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; sideFieldIndex) {\n&#x27;
                           &#x27;        this.sideFieldIndex = sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideTableInfo getSideTableInfo() {\n&#x27;
                           &#x27;        return sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideTableInfo(SideTableInfo &#x27;
                           &#x27;sideTableInfo) {\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AbsSideCache getSideCache() {\n&#x27;
                           &#x27;        return sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideCache(AbsSideCache &#x27;
                           &#x27;sideCache) {\n&#x27;
                           &#x27;        this.sideCache = sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideFieldNameIndex() {\n&#x27;
                           &#x27;        return sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldNameIndex(Map&lt;Integer, &#x27;
                           &#x27;String&gt; sideFieldNameIndex) {\n&#x27;
                           &#x27;        this.sideFieldNameIndex = &#x27;
                           &#x27;sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideSelectFieldsType() {\n&#x27;
                           &#x27;        return sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setSideSelectFieldsType(Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType) {\n&#x27;
                           &#x27;        this.sideSelectFieldsType = &#x27;
                           &#x27;sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSelectSideFieldType(int &#x27;
                           &#x27;index){\n&#x27;
                           &#x27;        return sideSelectFieldsType.get(index);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.side.cache.AbsSideCache;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlBasicCall;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlIdentifier;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlKind;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlNode;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.java.typeutils.RowTypeInfo;\n&#x27;
                           &#x27;import com.google.common.collect.Lists;\n&#x27;
                           &#x27;import com.google.common.collect.Maps;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.io.Serializable;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class SideInfo implements &#x27;
                           &#x27;Serializable{\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected RowTypeInfo rowTypeInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;FieldInfo&gt; outFieldInfoList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;String&gt; equalFieldList = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;Integer&gt; equalValIndex = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sqlCondition = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sideSelectFields = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected JoinType joinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value: the ref field index\u200bin the input &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; inFieldIndex = &#x27;
                           &#x27;Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field index\u200bin the side &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; sideFieldIndex &#x27;
                           &#x27;= Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field name\u200bin the side table\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideFieldNameIndex = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideTableInfo sideTableInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected AbsSideCache sideCache;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideInfo(RowTypeInfo rowTypeInfo, &#x27;
                           &#x27;JoinInfo joinInfo, List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList,\n&#x27;
                           &#x27;                    SideTableInfo sideTableInfo){\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;        this.joinType = joinInfo.getJoinType();\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;        parseSelectFields(joinInfo);\n&#x27;
                           &#x27;        buildEqualInfo(joinInfo, sideTableInfo);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void parseSelectFields(JoinInfo &#x27;
                           &#x27;joinInfo){\n&#x27;
                           &#x27;        String sideTableName = &#x27;
                           &#x27;joinInfo.getSideTableName();\n&#x27;
                           &#x27;        String nonSideTableName = &#x27;
                           &#x27;joinInfo.getNonSideTable();\n&#x27;
                           &#x27;        List&lt;String&gt; fields = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;        int sideTableFieldIndex = 0;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        for( int i=0; i&lt;outFieldInfoList.size(); &#x27;
                           &#x27;i++){\n&#x27;
                           &#x27;            FieldInfo fieldInfo = &#x27;
                           &#x27;outFieldInfoList.get(i);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;                String sideFieldName = &#x27;
                           &#x27;sideTableInfo.getPhysicalFields().getOrDefault(fieldInfo.getFieldName(), &#x27;
                           &#x27;fieldInfo.getFieldName());\n&#x27;
                           &#x27;                fields.add(sideFieldName);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;sideSelectFieldsType.put(sideTableFieldIndex, &#x27;
                           &#x27;getTargetFieldType(fieldInfo.getFieldName()));\n&#x27;
                           &#x27;                sideFieldIndex.put(i, &#x27;
                           &#x27;sideTableFieldIndex);\n&#x27;
                           &#x27;                sideFieldNameIndex.put(i, &#x27;
                           &#x27;sideFieldName);\n&#x27;
                           &#x27;                sideTableFieldIndex++;\n&#x27;
                           &#x27;            }else &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(nonSideTableName)){\n&#x27;
                           &#x27;                int nonSideIndex = &#x27;
                           &#x27;rowTypeInfo.getFieldIndex(fieldInfo.getFieldName());\n&#x27;
                           &#x27;                inFieldIndex.put(i, &#x27;
                           &#x27;nonSideIndex);\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                throw new &#x27;
                           &#x27;RuntimeException(&quot;unknown table &quot; + &#x27;
                           &#x27;fieldInfo.getTable());\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if(fields.size() == 0){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;select non &#x27;
                           &#x27;field from table &quot; +  sideTableName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        sideSelectFields = String.join(&quot;,&quot;, &#x27;
                           &#x27;fields);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getTargetFieldType(String &#x27;
                           &#x27;fieldName){\n&#x27;
                           &#x27;        int fieldIndex = &#x27;
                           &#x27;sideTableInfo.getFieldList().indexOf(fieldName);\n&#x27;
                           &#x27;        if(fieldIndex == -1){\n&#x27;
                           &#x27;            throw new &#x27;
                           &#x27;RuntimeException(sideTableInfo.getName() + &quot;can\&#x27;t &#x27;
                           &#x27;find field: &quot; + fieldName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;sideTableInfo.getFieldTypes()[fieldIndex];\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void dealOneEqualCon(SqlNode sqlNode, &#x27;
                           &#x27;String sideTableName){\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(!SqlKind.COMPARISON.contains(sqlNode.getKind())){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;not &#x27;
                           &#x27;compare operator.&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        SqlIdentifier left = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];\n&#x27;
                           &#x27;        SqlIdentifier right = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String leftTableName = &#x27;
                           &#x27;left.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String leftField = &#x27;
                           &#x27;left.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String rightTableName = &#x27;
                           &#x27;right.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String rightField = &#x27;
                           &#x27;right.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(leftTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;            equalFieldList.add(leftField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(rightField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else &#x27;
                           &#x27;if(rightTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalFieldList.add(rightField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(leftField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else{\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;resolve &#x27;
                           &#x27;equalFieldList error:&quot; + sqlNode.toString());\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public abstract void buildEqualInfo(JoinInfo &#x27;
                           &#x27;joinInfo, SideTableInfo sideTableInfo);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public RowTypeInfo getRowTypeInfo() {\n&#x27;
                           &#x27;        return rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setRowTypeInfo(RowTypeInfo &#x27;
                           &#x27;rowTypeInfo) {\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;FieldInfo&gt; getOutFieldInfoList() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setOutFieldInfoList(List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList) {\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;String&gt; getEqualFieldList() {\n&#x27;
                           &#x27;        return equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualFieldList(List&lt;String&gt; &#x27;
                           &#x27;equalFieldList) {\n&#x27;
                           &#x27;        this.equalFieldList = equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;Integer&gt; getEqualValIndex() {\n&#x27;
                           &#x27;        return equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualValIndex(List&lt;Integer&gt; &#x27;
                           &#x27;equalValIndex) {\n&#x27;
                           &#x27;        this.equalValIndex = equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSqlCondition() {\n&#x27;
                           &#x27;        return sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSqlCondition(String &#x27;
                           &#x27;sqlCondition) {\n&#x27;
                           &#x27;        this.sqlCondition = sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSideSelectFields() {\n&#x27;
                           &#x27;        return sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideSelectFields(String &#x27;
                           &#x27;sideSelectFields) {\n&#x27;
                           &#x27;        this.sideSelectFields = sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public JoinType getJoinType() {\n&#x27;
                           &#x27;        return joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setJoinType(JoinType joinType) {\n&#x27;
                           &#x27;        this.joinType = joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; getInFieldIndex() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setInFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; inFieldIndex) {\n&#x27;
                           &#x27;        this.inFieldIndex = inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; &#x27;
                           &#x27;getSideFieldIndex() {\n&#x27;
                           &#x27;        return sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; sideFieldIndex) {\n&#x27;
                           &#x27;        this.sideFieldIndex = sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideTableInfo getSideTableInfo() {\n&#x27;
                           &#x27;        return sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideTableInfo(SideTableInfo &#x27;
                           &#x27;sideTableInfo) {\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AbsSideCache getSideCache() {\n&#x27;
                           &#x27;        return sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideCache(AbsSideCache &#x27;
                           &#x27;sideCache) {\n&#x27;
                           &#x27;        this.sideCache = sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideFieldNameIndex() {\n&#x27;
                           &#x27;        return sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldNameIndex(Map&lt;Integer, &#x27;
                           &#x27;String&gt; sideFieldNameIndex) {\n&#x27;
                           &#x27;        this.sideFieldNameIndex = &#x27;
                           &#x27;sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideSelectFieldsType() {\n&#x27;
                           &#x27;        return sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setSideSelectFieldsType(Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType) {\n&#x27;
                           &#x27;        this.sideSelectFieldsType = &#x27;
                           &#x27;sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSelectSideFieldType(int &#x27;
                           &#x27;index){\n&#x27;
                           &#x27;        return sideSelectFieldsType.get(index);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.side.cache.AbsSideCache;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlBasicCall;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlIdentifier;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlKind;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlNode;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.java.typeutils.RowTypeInfo;\n&#x27;
                           &#x27;import com.google.common.collect.Lists;\n&#x27;
                           &#x27;import com.google.common.collect.Maps;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.io.Serializable;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class SideInfo implements &#x27;
                           &#x27;Serializable{\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected RowTypeInfo rowTypeInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;FieldInfo&gt; outFieldInfoList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;String&gt; equalFieldList = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;Integer&gt; equalValIndex = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sqlCondition = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sideSelectFields = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected JoinType joinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value: the ref field index\u200bin the input &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; inFieldIndex = &#x27;
                           &#x27;Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field index\u200bin the side &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; sideFieldIndex &#x27;
                           &#x27;= Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field name\u200bin the side table\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideFieldNameIndex = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideTableInfo sideTableInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected AbsSideCache sideCache;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideInfo(RowTypeInfo rowTypeInfo, &#x27;
                           &#x27;JoinInfo joinInfo, List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList,\n&#x27;
                           &#x27;                    SideTableInfo sideTableInfo){\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;        this.joinType = joinInfo.getJoinType();\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;        parseSelectFields(joinInfo);\n&#x27;
                           &#x27;        buildEqualInfo(joinInfo, sideTableInfo);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void parseSelectFields(JoinInfo &#x27;
                           &#x27;joinInfo){\n&#x27;
                           &#x27;        String sideTableName = &#x27;
                           &#x27;joinInfo.getSideTableName();\n&#x27;
                           &#x27;        String nonSideTableName = &#x27;
                           &#x27;joinInfo.getNonSideTable();\n&#x27;
                           &#x27;        List&lt;String&gt; fields = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;        int sideTableFieldIndex = 0;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        for( int i=0; i&lt;outFieldInfoList.size(); &#x27;
                           &#x27;i++){\n&#x27;
                           &#x27;            FieldInfo fieldInfo = &#x27;
                           &#x27;outFieldInfoList.get(i);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;                String sideFieldName = &#x27;
                           &#x27;sideTableInfo.getPhysicalFields().getOrDefault(fieldInfo.getFieldName(), &#x27;
                           &#x27;fieldInfo.getFieldName());\n&#x27;
                           &#x27;                fields.add(sideFieldName);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;sideSelectFieldsType.put(sideTableFieldIndex, &#x27;
                           &#x27;getTargetFieldType(fieldInfo.getFieldName()));\n&#x27;
                           &#x27;                sideFieldIndex.put(i, &#x27;
                           &#x27;sideTableFieldIndex);\n&#x27;
                           &#x27;                sideFieldNameIndex.put(i, &#x27;
                           &#x27;sideFieldName);\n&#x27;
                           &#x27;                sideTableFieldIndex++;\n&#x27;
                           &#x27;            }else &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(nonSideTableName)){\n&#x27;
                           &#x27;                int nonSideIndex = &#x27;
                           &#x27;rowTypeInfo.getFieldIndex(fieldInfo.getFieldName());\n&#x27;
                           &#x27;                inFieldIndex.put(i, &#x27;
                           &#x27;nonSideIndex);\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                throw new &#x27;
                           &#x27;RuntimeException(&quot;unknown table &quot; + &#x27;
                           &#x27;fieldInfo.getTable());\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if(fields.size() == 0){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;select non &#x27;
                           &#x27;field from table &quot; +  sideTableName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        sideSelectFields = String.join(&quot;,&quot;, &#x27;
                           &#x27;fields);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getTargetFieldType(String &#x27;
                           &#x27;fieldName){\n&#x27;
                           &#x27;        int fieldIndex = &#x27;
                           &#x27;sideTableInfo.getFieldList().indexOf(fieldName);\n&#x27;
                           &#x27;        if(fieldIndex == -1){\n&#x27;
                           &#x27;            throw new &#x27;
                           &#x27;RuntimeException(sideTableInfo.getName() + &quot;can\&#x27;t &#x27;
                           &#x27;find field: &quot; + fieldName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;sideTableInfo.getFieldTypes()[fieldIndex];\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void dealOneEqualCon(SqlNode sqlNode, &#x27;
                           &#x27;String sideTableName){\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(!SqlKind.COMPARISON.contains(sqlNode.getKind())){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;not &#x27;
                           &#x27;compare operator.&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        SqlIdentifier left = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];\n&#x27;
                           &#x27;        SqlIdentifier right = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String leftTableName = &#x27;
                           &#x27;left.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String leftField = &#x27;
                           &#x27;left.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String rightTableName = &#x27;
                           &#x27;right.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String rightField = &#x27;
                           &#x27;right.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(leftTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;            equalFieldList.add(leftField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(rightField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else &#x27;
                           &#x27;if(rightTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalFieldList.add(rightField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(leftField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else{\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;resolve &#x27;
                           &#x27;equalFieldList error:&quot; + sqlNode.toString());\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public abstract void buildEqualInfo(JoinInfo &#x27;
                           &#x27;joinInfo, SideTableInfo sideTableInfo);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public RowTypeInfo getRowTypeInfo() {\n&#x27;
                           &#x27;        return rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setRowTypeInfo(RowTypeInfo &#x27;
                           &#x27;rowTypeInfo) {\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;FieldInfo&gt; getOutFieldInfoList() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setOutFieldInfoList(List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList) {\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;String&gt; getEqualFieldList() {\n&#x27;
                           &#x27;        return equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualFieldList(List&lt;String&gt; &#x27;
                           &#x27;equalFieldList) {\n&#x27;
                           &#x27;        this.equalFieldList = equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;Integer&gt; getEqualValIndex() {\n&#x27;
                           &#x27;        return equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualValIndex(List&lt;Integer&gt; &#x27;
                           &#x27;equalValIndex) {\n&#x27;
                           &#x27;        this.equalValIndex = equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSqlCondition() {\n&#x27;
                           &#x27;        return sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSqlCondition(String &#x27;
                           &#x27;sqlCondition) {\n&#x27;
                           &#x27;        this.sqlCondition = sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSideSelectFields() {\n&#x27;
                           &#x27;        return sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideSelectFields(String &#x27;
                           &#x27;sideSelectFields) {\n&#x27;
                           &#x27;        this.sideSelectFields = sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public JoinType getJoinType() {\n&#x27;
                           &#x27;        return joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setJoinType(JoinType joinType) {\n&#x27;
                           &#x27;        this.joinType = joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; getInFieldIndex() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setInFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; inFieldIndex) {\n&#x27;
                           &#x27;        this.inFieldIndex = inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; &#x27;
                           &#x27;getSideFieldIndex() {\n&#x27;
                           &#x27;        return sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; sideFieldIndex) {\n&#x27;
                           &#x27;        this.sideFieldIndex = sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideTableInfo getSideTableInfo() {\n&#x27;
                           &#x27;        return sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideTableInfo(SideTableInfo &#x27;
                           &#x27;sideTableInfo) {\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AbsSideCache getSideCache() {\n&#x27;
                           &#x27;        return sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideCache(AbsSideCache &#x27;
                           &#x27;sideCache) {\n&#x27;
                           &#x27;        this.sideCache = sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideFieldNameIndex() {\n&#x27;
                           &#x27;        return sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldNameIndex(Map&lt;Integer, &#x27;
                           &#x27;String&gt; sideFieldNameIndex) {\n&#x27;
                           &#x27;        this.sideFieldNameIndex = &#x27;
                           &#x27;sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideSelectFieldsType() {\n&#x27;
                           &#x27;        return sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setSideSelectFieldsType(Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType) {\n&#x27;
                           &#x27;        this.sideSelectFieldsType = &#x27;
                           &#x27;sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSelectSideFieldType(int &#x27;
                           &#x27;index){\n&#x27;
                           &#x27;        return sideSelectFieldsType.get(index);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;spork&#x27;, &#x27;baseline&#x27;, &#x27;jfstmerge&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.side.cache.AbsSideCache;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlBasicCall;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlIdentifier;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlKind;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlNode;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.java.typeutils.RowTypeInfo;\n&#x27;
                           &#x27;import com.google.common.collect.Lists;\n&#x27;
                           &#x27;import com.google.common.collect.Maps;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.io.Serializable;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class SideInfo implements &#x27;
                           &#x27;Serializable{\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected RowTypeInfo rowTypeInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;FieldInfo&gt; outFieldInfoList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;String&gt; equalFieldList = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;Integer&gt; equalValIndex = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sqlCondition = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sideSelectFields = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected JoinType joinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value: the ref field index\u200bin the input &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; inFieldIndex = &#x27;
                           &#x27;Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field index\u200bin the side &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; sideFieldIndex &#x27;
                           &#x27;= Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field name\u200bin the side table\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideFieldNameIndex = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideTableInfo sideTableInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected AbsSideCache sideCache;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideInfo(RowTypeInfo rowTypeInfo, &#x27;
                           &#x27;JoinInfo joinInfo, List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList,\n&#x27;
                           &#x27;                    SideTableInfo sideTableInfo){\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;        this.joinType = joinInfo.getJoinType();\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;        parseSelectFields(joinInfo);\n&#x27;
                           &#x27;        buildEqualInfo(joinInfo, sideTableInfo);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void parseSelectFields(JoinInfo &#x27;
                           &#x27;joinInfo){\n&#x27;
                           &#x27;        String sideTableName = &#x27;
                           &#x27;joinInfo.getSideTableName();\n&#x27;
                           &#x27;        String nonSideTableName = &#x27;
                           &#x27;joinInfo.getNonSideTable();\n&#x27;
                           &#x27;        List&lt;String&gt; fields = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;        int sideTableFieldIndex = 0;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        for( int i=0; i&lt;outFieldInfoList.size(); &#x27;
                           &#x27;i++){\n&#x27;
                           &#x27;            FieldInfo fieldInfo = &#x27;
                           &#x27;outFieldInfoList.get(i);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;                String sideFieldName = &#x27;
                           &#x27;sideTableInfo.getPhysicalFields().getOrDefault(fieldInfo.getFieldName(), &#x27;
                           &#x27;fieldInfo.getFieldName());\n&#x27;
                           &#x27;                fields.add(sideFieldName);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;sideSelectFieldsType.put(sideTableFieldIndex, &#x27;
                           &#x27;getTargetFieldType(fieldInfo.getFieldName()));\n&#x27;
                           &#x27;                sideFieldIndex.put(i, &#x27;
                           &#x27;sideTableFieldIndex);\n&#x27;
                           &#x27;                sideFieldNameIndex.put(i, &#x27;
                           &#x27;sideFieldName);\n&#x27;
                           &#x27;                sideTableFieldIndex++;\n&#x27;
                           &#x27;            }else &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(nonSideTableName)){\n&#x27;
                           &#x27;                int nonSideIndex = &#x27;
                           &#x27;rowTypeInfo.getFieldIndex(fieldInfo.getFieldName());\n&#x27;
                           &#x27;                inFieldIndex.put(i, &#x27;
                           &#x27;nonSideIndex);\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                throw new &#x27;
                           &#x27;RuntimeException(&quot;unknown table &quot; + &#x27;
                           &#x27;fieldInfo.getTable());\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if(fields.size() == 0){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;select non &#x27;
                           &#x27;field from table &quot; +  sideTableName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        sideSelectFields = String.join(&quot;,&quot;, &#x27;
                           &#x27;fields);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getTargetFieldType(String &#x27;
                           &#x27;fieldName){\n&#x27;
                           &#x27;        int fieldIndex = &#x27;
                           &#x27;sideTableInfo.getFieldList().indexOf(fieldName);\n&#x27;
                           &#x27;        if(fieldIndex == -1){\n&#x27;
                           &#x27;            throw new &#x27;
                           &#x27;RuntimeException(sideTableInfo.getName() + &quot;can\&#x27;t &#x27;
                           &#x27;find field: &quot; + fieldName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;sideTableInfo.getFieldTypes()[fieldIndex];\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void dealOneEqualCon(SqlNode sqlNode, &#x27;
                           &#x27;String sideTableName){\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(!SqlKind.COMPARISON.contains(sqlNode.getKind())){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;not &#x27;
                           &#x27;compare operator.&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        SqlIdentifier left = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];\n&#x27;
                           &#x27;        SqlIdentifier right = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String leftTableName = &#x27;
                           &#x27;left.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String leftField = &#x27;
                           &#x27;left.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String rightTableName = &#x27;
                           &#x27;right.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String rightField = &#x27;
                           &#x27;right.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(leftTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;            equalFieldList.add(leftField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(rightField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else &#x27;
                           &#x27;if(rightTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalFieldList.add(rightField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(leftField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else{\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;resolve &#x27;
                           &#x27;equalFieldList error:&quot; + sqlNode.toString());\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public abstract void buildEqualInfo(JoinInfo &#x27;
                           &#x27;joinInfo, SideTableInfo sideTableInfo);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public RowTypeInfo getRowTypeInfo() {\n&#x27;
                           &#x27;        return rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setRowTypeInfo(RowTypeInfo &#x27;
                           &#x27;rowTypeInfo) {\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;FieldInfo&gt; getOutFieldInfoList() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setOutFieldInfoList(List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList) {\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;String&gt; getEqualFieldList() {\n&#x27;
                           &#x27;        return equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualFieldList(List&lt;String&gt; &#x27;
                           &#x27;equalFieldList) {\n&#x27;
                           &#x27;        this.equalFieldList = equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;Integer&gt; getEqualValIndex() {\n&#x27;
                           &#x27;        return equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualValIndex(List&lt;Integer&gt; &#x27;
                           &#x27;equalValIndex) {\n&#x27;
                           &#x27;        this.equalValIndex = equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSqlCondition() {\n&#x27;
                           &#x27;        return sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSqlCondition(String &#x27;
                           &#x27;sqlCondition) {\n&#x27;
                           &#x27;        this.sqlCondition = sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSideSelectFields() {\n&#x27;
                           &#x27;        return sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideSelectFields(String &#x27;
                           &#x27;sideSelectFields) {\n&#x27;
                           &#x27;        this.sideSelectFields = sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public JoinType getJoinType() {\n&#x27;
                           &#x27;        return joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setJoinType(JoinType joinType) {\n&#x27;
                           &#x27;        this.joinType = joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; getInFieldIndex() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setInFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; inFieldIndex) {\n&#x27;
                           &#x27;        this.inFieldIndex = inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; &#x27;
                           &#x27;getSideFieldIndex() {\n&#x27;
                           &#x27;        return sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; sideFieldIndex) {\n&#x27;
                           &#x27;        this.sideFieldIndex = sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideTableInfo getSideTableInfo() {\n&#x27;
                           &#x27;        return sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideTableInfo(SideTableInfo &#x27;
                           &#x27;sideTableInfo) {\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AbsSideCache getSideCache() {\n&#x27;
                           &#x27;        return sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideCache(AbsSideCache &#x27;
                           &#x27;sideCache) {\n&#x27;
                           &#x27;        this.sideCache = sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideFieldNameIndex() {\n&#x27;
                           &#x27;        return sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldNameIndex(Map&lt;Integer, &#x27;
                           &#x27;String&gt; sideFieldNameIndex) {\n&#x27;
                           &#x27;        this.sideFieldNameIndex = &#x27;
                           &#x27;sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideSelectFieldsType() {\n&#x27;
                           &#x27;        return sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setSideSelectFieldsType(Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType) {\n&#x27;
                           &#x27;        this.sideSelectFieldsType = &#x27;
                           &#x27;sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSelectSideFieldType(int &#x27;
                           &#x27;index){\n&#x27;
                           &#x27;        return sideSelectFieldsType.get(index);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.side.cache.AbsSideCache;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlBasicCall;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlIdentifier;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlKind;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlNode;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.java.typeutils.RowTypeInfo;\n&#x27;
                           &#x27;import com.google.common.collect.Lists;\n&#x27;
                           &#x27;import com.google.common.collect.Maps;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.io.Serializable;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class SideInfo implements &#x27;
                           &#x27;Serializable{\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected RowTypeInfo rowTypeInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;FieldInfo&gt; outFieldInfoList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;String&gt; equalFieldList = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;Integer&gt; equalValIndex = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sqlCondition = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sideSelectFields = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected JoinType joinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value: the ref field index\u200bin the input &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; inFieldIndex = &#x27;
                           &#x27;Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field index\u200bin the side &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; sideFieldIndex &#x27;
                           &#x27;= Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field name\u200bin the side table\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideFieldNameIndex = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideTableInfo sideTableInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected AbsSideCache sideCache;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideInfo(RowTypeInfo rowTypeInfo, &#x27;
                           &#x27;JoinInfo joinInfo, List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList,\n&#x27;
                           &#x27;                    SideTableInfo sideTableInfo){\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;        this.joinType = joinInfo.getJoinType();\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;        parseSelectFields(joinInfo);\n&#x27;
                           &#x27;        buildEqualInfo(joinInfo, sideTableInfo);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void parseSelectFields(JoinInfo &#x27;
                           &#x27;joinInfo){\n&#x27;
                           &#x27;        String sideTableName = &#x27;
                           &#x27;joinInfo.getSideTableName();\n&#x27;
                           &#x27;        String nonSideTableName = &#x27;
                           &#x27;joinInfo.getNonSideTable();\n&#x27;
                           &#x27;        List&lt;String&gt; fields = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;        int sideTableFieldIndex = 0;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        for( int i=0; i&lt;outFieldInfoList.size(); &#x27;
                           &#x27;i++){\n&#x27;
                           &#x27;            FieldInfo fieldInfo = &#x27;
                           &#x27;outFieldInfoList.get(i);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;                String sideFieldName = &#x27;
                           &#x27;sideTableInfo.getPhysicalFields().getOrDefault(fieldInfo.getFieldName(), &#x27;
                           &#x27;fieldInfo.getFieldName());\n&#x27;
                           &#x27;                fields.add(sideFieldName);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;sideSelectFieldsType.put(sideTableFieldIndex, &#x27;
                           &#x27;getTargetFieldType(fieldInfo.getFieldName()));\n&#x27;
                           &#x27;                sideFieldIndex.put(i, &#x27;
                           &#x27;sideTableFieldIndex);\n&#x27;
                           &#x27;                sideFieldNameIndex.put(i, &#x27;
                           &#x27;sideFieldName);\n&#x27;
                           &#x27;                sideTableFieldIndex++;\n&#x27;
                           &#x27;            }else &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(nonSideTableName)){\n&#x27;
                           &#x27;                int nonSideIndex = &#x27;
                           &#x27;rowTypeInfo.getFieldIndex(fieldInfo.getFieldName());\n&#x27;
                           &#x27;                inFieldIndex.put(i, &#x27;
                           &#x27;nonSideIndex);\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                throw new &#x27;
                           &#x27;RuntimeException(&quot;unknown table &quot; + &#x27;
                           &#x27;fieldInfo.getTable());\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if(fields.size() == 0){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;select non &#x27;
                           &#x27;field from table &quot; +  sideTableName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        sideSelectFields = String.join(&quot;,&quot;, &#x27;
                           &#x27;fields);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getTargetFieldType(String &#x27;
                           &#x27;fieldName){\n&#x27;
                           &#x27;        int fieldIndex = &#x27;
                           &#x27;sideTableInfo.getFieldList().indexOf(fieldName);\n&#x27;
                           &#x27;        if(fieldIndex == -1){\n&#x27;
                           &#x27;            throw new &#x27;
                           &#x27;RuntimeException(sideTableInfo.getName() + &quot;can\&#x27;t &#x27;
                           &#x27;find field: &quot; + fieldName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;sideTableInfo.getFieldTypes()[fieldIndex];\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void dealOneEqualCon(SqlNode sqlNode, &#x27;
                           &#x27;String sideTableName){\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(!SqlKind.COMPARISON.contains(sqlNode.getKind())){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;not &#x27;
                           &#x27;compare operator.&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        SqlIdentifier left = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];\n&#x27;
                           &#x27;        SqlIdentifier right = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String leftTableName = &#x27;
                           &#x27;left.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String leftField = &#x27;
                           &#x27;left.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String rightTableName = &#x27;
                           &#x27;right.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String rightField = &#x27;
                           &#x27;right.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(leftTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;            equalFieldList.add(leftField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(rightField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else &#x27;
                           &#x27;if(rightTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalFieldList.add(rightField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(leftField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else{\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;resolve &#x27;
                           &#x27;equalFieldList error:&quot; + sqlNode.toString());\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public abstract void buildEqualInfo(JoinInfo &#x27;
                           &#x27;joinInfo, SideTableInfo sideTableInfo);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public RowTypeInfo getRowTypeInfo() {\n&#x27;
                           &#x27;        return rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setRowTypeInfo(RowTypeInfo &#x27;
                           &#x27;rowTypeInfo) {\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;FieldInfo&gt; getOutFieldInfoList() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setOutFieldInfoList(List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList) {\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;String&gt; getEqualFieldList() {\n&#x27;
                           &#x27;        return equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualFieldList(List&lt;String&gt; &#x27;
                           &#x27;equalFieldList) {\n&#x27;
                           &#x27;        this.equalFieldList = equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;Integer&gt; getEqualValIndex() {\n&#x27;
                           &#x27;        return equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualValIndex(List&lt;Integer&gt; &#x27;
                           &#x27;equalValIndex) {\n&#x27;
                           &#x27;        this.equalValIndex = equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSqlCondition() {\n&#x27;
                           &#x27;        return sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSqlCondition(String &#x27;
                           &#x27;sqlCondition) {\n&#x27;
                           &#x27;        this.sqlCondition = sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSideSelectFields() {\n&#x27;
                           &#x27;        return sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideSelectFields(String &#x27;
                           &#x27;sideSelectFields) {\n&#x27;
                           &#x27;        this.sideSelectFields = sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public JoinType getJoinType() {\n&#x27;
                           &#x27;        return joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setJoinType(JoinType joinType) {\n&#x27;
                           &#x27;        this.joinType = joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; getInFieldIndex() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setInFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; inFieldIndex) {\n&#x27;
                           &#x27;        this.inFieldIndex = inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; &#x27;
                           &#x27;getSideFieldIndex() {\n&#x27;
                           &#x27;        return sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; sideFieldIndex) {\n&#x27;
                           &#x27;        this.sideFieldIndex = sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideTableInfo getSideTableInfo() {\n&#x27;
                           &#x27;        return sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideTableInfo(SideTableInfo &#x27;
                           &#x27;sideTableInfo) {\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AbsSideCache getSideCache() {\n&#x27;
                           &#x27;        return sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideCache(AbsSideCache &#x27;
                           &#x27;sideCache) {\n&#x27;
                           &#x27;        this.sideCache = sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideFieldNameIndex() {\n&#x27;
                           &#x27;        return sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldNameIndex(Map&lt;Integer, &#x27;
                           &#x27;String&gt; sideFieldNameIndex) {\n&#x27;
                           &#x27;        this.sideFieldNameIndex = &#x27;
                           &#x27;sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideSelectFieldsType() {\n&#x27;
                           &#x27;        return sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setSideSelectFieldsType(Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType) {\n&#x27;
                           &#x27;        this.sideSelectFieldsType = &#x27;
                           &#x27;sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSelectSideFieldType(int &#x27;
                           &#x27;index){\n&#x27;
                           &#x27;        return sideSelectFieldsType.get(index);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.side.cache.AbsSideCache;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlBasicCall;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlIdentifier;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlKind;\n&#x27;
                           &#x27;import org.apache.calcite.sql.SqlNode;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.java.typeutils.RowTypeInfo;\n&#x27;
                           &#x27;import com.google.common.collect.Lists;\n&#x27;
                           &#x27;import com.google.common.collect.Maps;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.io.Serializable;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class SideInfo implements &#x27;
                           &#x27;Serializable{\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected RowTypeInfo rowTypeInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;FieldInfo&gt; outFieldInfoList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;String&gt; equalFieldList = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected List&lt;Integer&gt; equalValIndex = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sqlCondition = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected String sideSelectFields = &quot;&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected JoinType joinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value: the ref field index\u200bin the input &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; inFieldIndex = &#x27;
                           &#x27;Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field index\u200bin the side &#x27;
                           &#x27;table\n&#x27;
                           &#x27;    protected Map&lt;Integer, Integer&gt; sideFieldIndex &#x27;
                           &#x27;= Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    //key:Returns the value of the position, &#x27;
                           &#x27;value:  the ref field name\u200bin the side table\n&#x27;
                           &#x27;    protected Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideFieldNameIndex = Maps.newHashMap();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideTableInfo sideTableInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected AbsSideCache sideCache;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideInfo(RowTypeInfo rowTypeInfo, &#x27;
                           &#x27;JoinInfo joinInfo, List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList,\n&#x27;
                           &#x27;                    SideTableInfo sideTableInfo){\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;        this.joinType = joinInfo.getJoinType();\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;        parseSelectFields(joinInfo);\n&#x27;
                           &#x27;        buildEqualInfo(joinInfo, sideTableInfo);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void parseSelectFields(JoinInfo &#x27;
                           &#x27;joinInfo){\n&#x27;
                           &#x27;        String sideTableName = &#x27;
                           &#x27;joinInfo.getSideTableName();\n&#x27;
                           &#x27;        String nonSideTableName = &#x27;
                           &#x27;joinInfo.getNonSideTable();\n&#x27;
                           &#x27;        List&lt;String&gt; fields = &#x27;
                           &#x27;Lists.newArrayList();\n&#x27;
                           &#x27;        int sideTableFieldIndex = 0;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        for( int i=0; i&lt;outFieldInfoList.size(); &#x27;
                           &#x27;i++){\n&#x27;
                           &#x27;            FieldInfo fieldInfo = &#x27;
                           &#x27;outFieldInfoList.get(i);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;                String sideFieldName = &#x27;
                           &#x27;sideTableInfo.getPhysicalFields().getOrDefault(fieldInfo.getFieldName(), &#x27;
                           &#x27;fieldInfo.getFieldName());\n&#x27;
                           &#x27;                fields.add(sideFieldName);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;sideSelectFieldsType.put(sideTableFieldIndex, &#x27;
                           &#x27;getTargetFieldType(fieldInfo.getFieldName()));\n&#x27;
                           &#x27;                sideFieldIndex.put(i, &#x27;
                           &#x27;sideTableFieldIndex);\n&#x27;
                           &#x27;                sideFieldNameIndex.put(i, &#x27;
                           &#x27;sideFieldName);\n&#x27;
                           &#x27;                sideTableFieldIndex++;\n&#x27;
                           &#x27;            }else &#x27;
                           &#x27;if(fieldInfo.getTable().equalsIgnoreCase(nonSideTableName)){\n&#x27;
                           &#x27;                int nonSideIndex = &#x27;
                           &#x27;rowTypeInfo.getFieldIndex(fieldInfo.getFieldName());\n&#x27;
                           &#x27;                inFieldIndex.put(i, &#x27;
                           &#x27;nonSideIndex);\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                throw new &#x27;
                           &#x27;RuntimeException(&quot;unknown table &quot; + &#x27;
                           &#x27;fieldInfo.getTable());\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if(fields.size() == 0){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;select non &#x27;
                           &#x27;field from table &quot; +  sideTableName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        sideSelectFields = String.join(&quot;,&quot;, &#x27;
                           &#x27;fields);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getTargetFieldType(String &#x27;
                           &#x27;fieldName){\n&#x27;
                           &#x27;        int fieldIndex = &#x27;
                           &#x27;sideTableInfo.getFieldList().indexOf(fieldName);\n&#x27;
                           &#x27;        if(fieldIndex == -1){\n&#x27;
                           &#x27;            throw new &#x27;
                           &#x27;RuntimeException(sideTableInfo.getName() + &quot;can\&#x27;t &#x27;
                           &#x27;find field: &quot; + fieldName);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;sideTableInfo.getFieldTypes()[fieldIndex];\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void dealOneEqualCon(SqlNode sqlNode, &#x27;
                           &#x27;String sideTableName){\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(!SqlKind.COMPARISON.contains(sqlNode.getKind())){\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;not &#x27;
                           &#x27;compare operator.&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        SqlIdentifier left = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];\n&#x27;
                           &#x27;        SqlIdentifier right = &#x27;
                           &#x27;(SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String leftTableName = &#x27;
                           &#x27;left.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String leftField = &#x27;
                           &#x27;left.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String rightTableName = &#x27;
                           &#x27;right.getComponent(0).getSimple();\n&#x27;
                           &#x27;        String rightField = &#x27;
                           &#x27;right.getComponent(1).getSimple();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;if(leftTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;            equalFieldList.add(leftField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(rightField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else &#x27;
                           &#x27;if(rightTableName.equalsIgnoreCase(sideTableName)){\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalFieldList.add(rightField);\n&#x27;
                           &#x27;            int equalFieldIndex = -1;\n&#x27;
                           &#x27;            for(int i=0; &#x27;
                           &#x27;i&lt;rowTypeInfo.getFieldNames().length; i++){\n&#x27;
                           &#x27;                String fieldName = &#x27;
                           &#x27;rowTypeInfo.getFieldNames()[i];\n&#x27;
                           &#x27;                &#x27;
                           &#x27;if(fieldName.equalsIgnoreCase(leftField)){\n&#x27;
                           &#x27;                    equalFieldIndex = i;\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            if(equalFieldIndex == -1){\n&#x27;
                           &#x27;                throw new RuntimeException(&quot;can\&#x27;t &#x27;
                           &#x27;find equal field &quot; + rightField);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            equalValIndex.add(equalFieldIndex);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }else{\n&#x27;
                           &#x27;            throw new RuntimeException(&quot;resolve &#x27;
                           &#x27;equalFieldList error:&quot; + sqlNode.toString());\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public abstract void buildEqualInfo(JoinInfo &#x27;
                           &#x27;joinInfo, SideTableInfo sideTableInfo);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public RowTypeInfo getRowTypeInfo() {\n&#x27;
                           &#x27;        return rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setRowTypeInfo(RowTypeInfo &#x27;
                           &#x27;rowTypeInfo) {\n&#x27;
                           &#x27;        this.rowTypeInfo = rowTypeInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;FieldInfo&gt; getOutFieldInfoList() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setOutFieldInfoList(List&lt;FieldInfo&gt; &#x27;
                           &#x27;outFieldInfoList) {\n&#x27;
                           &#x27;        this.outFieldInfoList = outFieldInfoList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;String&gt; getEqualFieldList() {\n&#x27;
                           &#x27;        return equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualFieldList(List&lt;String&gt; &#x27;
                           &#x27;equalFieldList) {\n&#x27;
                           &#x27;        this.equalFieldList = equalFieldList;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public List&lt;Integer&gt; getEqualValIndex() {\n&#x27;
                           &#x27;        return equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setEqualValIndex(List&lt;Integer&gt; &#x27;
                           &#x27;equalValIndex) {\n&#x27;
                           &#x27;        this.equalValIndex = equalValIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSqlCondition() {\n&#x27;
                           &#x27;        return sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSqlCondition(String &#x27;
                           &#x27;sqlCondition) {\n&#x27;
                           &#x27;        this.sqlCondition = sqlCondition;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSideSelectFields() {\n&#x27;
                           &#x27;        return sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideSelectFields(String &#x27;
                           &#x27;sideSelectFields) {\n&#x27;
                           &#x27;        this.sideSelectFields = sideSelectFields;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public JoinType getJoinType() {\n&#x27;
                           &#x27;        return joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setJoinType(JoinType joinType) {\n&#x27;
                           &#x27;        this.joinType = joinType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; getInFieldIndex() &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        return inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setInFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; inFieldIndex) {\n&#x27;
                           &#x27;        this.inFieldIndex = inFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, Integer&gt; &#x27;
                           &#x27;getSideFieldIndex() {\n&#x27;
                           &#x27;        return sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldIndex(Map&lt;Integer, &#x27;
                           &#x27;Integer&gt; sideFieldIndex) {\n&#x27;
                           &#x27;        this.sideFieldIndex = sideFieldIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public SideTableInfo getSideTableInfo() {\n&#x27;
                           &#x27;        return sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideTableInfo(SideTableInfo &#x27;
                           &#x27;sideTableInfo) {\n&#x27;
                           &#x27;        this.sideTableInfo = sideTableInfo;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AbsSideCache getSideCache() {\n&#x27;
                           &#x27;        return sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideCache(AbsSideCache &#x27;
                           &#x27;sideCache) {\n&#x27;
                           &#x27;        this.sideCache = sideCache;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideFieldNameIndex() {\n&#x27;
                           &#x27;        return sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setSideFieldNameIndex(Map&lt;Integer, &#x27;
                           &#x27;String&gt; sideFieldNameIndex) {\n&#x27;
                           &#x27;        this.sideFieldNameIndex = &#x27;
                           &#x27;sideFieldNameIndex;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public Map&lt;Integer, String&gt; &#x27;
                           &#x27;getSideSelectFieldsType() {\n&#x27;
                           &#x27;        return sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void &#x27;
                           &#x27;setSideSelectFieldsType(Map&lt;Integer, String&gt; &#x27;
                           &#x27;sideSelectFieldsType) {\n&#x27;
                           &#x27;        this.sideSelectFieldsType = &#x27;
                           &#x27;sideSelectFieldsType;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public String getSelectSideFieldType(int &#x27;
                           &#x27;index){\n&#x27;
                           &#x27;        return sideSelectFieldsType.get(index);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;spork&#x27;, &#x27;baseline&#x27;, &#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        