<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>127</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        abbr {
                          /* Here is the delay */
                          transition-delay:0s;
                        }
                    </style>
              </head>
              <body>
                <span style="height: 4vh">
                    127
                    <a href="126.html">prev</a>
                    <a href="128.html">next</a>
                    <a href="127_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    CarGuo/GSYVideoPlayer_d4d1bdf16a1634f70fffbb34594c8ee5d317b61f_gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/IjkExo2MediaPlayer.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;d4d1bdf16a1634f70fffbb34594c8ee5d317b61f:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/IjkExo2MediaPlayer.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;d4d1bdf16a1634f70fffbb34594c8ee5d317b61f^1:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/IjkExo2MediaPlayer.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;d4d1bdf16a1634f70fffbb34594c8ee5d317b61f^2:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/IjkExo2MediaPlayer.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;111bb508922fe092629031fd764786b96f53a796:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/IjkExo2MediaPlayer.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [bs], [bs], [bs], [bs], [bs], [bs], [bs], [sbj], [bs], [j], [j], [j], [j], [j]], subset: [[sbj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre>   1 
   2 package tv.danmaku.ijk.media.exo2;
   3 
   4 import android.annotation.SuppressLint;
   5 import android.content.Context;
   6 import android.net.Uri;
   7 import android.os.Handler;
   8 import android.os.Looper;
   9 
  10 import androidx.annotation.NonNull;
  11 import androidx.annotation.Nullable;
  12 import androidx.annotation.Size;
  13 
  14 import android.view.Surface;
  15 import android.view.SurfaceHolder;
  16 
  17 import com.google.android.exoplayer2.C;
  18 import com.google.android.exoplayer2.DefaultLoadControl;
  19 import com.google.android.exoplayer2.DefaultRenderersFactory;
  20 import com.google.android.exoplayer2.ExoPlaybackException;
  21 import com.google.android.exoplayer2.LoadControl;
  22 import com.google.android.exoplayer2.PlaybackParameters;
  23 import com.google.android.exoplayer2.Player;
  24 import com.google.android.exoplayer2.SeekParameters;
  25 import com.google.android.exoplayer2.SimpleExoPlayer;
  26 import com.google.android.exoplayer2.analytics.AnalyticsListener;
  27 import com.google.android.exoplayer2.decoder.DecoderCounters;
  28 import com.google.android.exoplayer2.metadata.Metadata;
  29 import com.google.android.exoplayer2.source.MediaSource;
  30 import com.google.android.exoplayer2.source.TrackGroupArray;
  31 import com.google.android.exoplayer2.text.Cue;
  32 import com.google.android.exoplayer2.trackselection.DefaultTrackSelector;
  33 import com.google.android.exoplayer2.trackselection.MappingTrackSelector;
  34 import com.google.android.exoplayer2.trackselection.TrackSelectionArray;
  35 import com.google.android.exoplayer2.video.VideoSize;
  36 
  37 import java.io.File;
  38 import java.io.FileDescriptor;
  39 import java.util.HashMap;
  40 import java.util.List;
  41 import java.util.Map;
  42 
  43 import tv.danmaku.ijk.media.exo2.demo.EventLogger;
  44 import tv.danmaku.ijk.media.player.AbstractMediaPlayer;
  45 import tv.danmaku.ijk.media.player.IMediaPlayer;
  46 import tv.danmaku.ijk.media.player.MediaInfo;
  47 import tv.danmaku.ijk.media.player.misc.IjkTrackInfo;
  48 
  49 import static com.google.android.exoplayer2.Player.DISCONTINUITY_REASON_SEEK;
  50 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  51 import static com.google.android.exoplayer2.Player.REPEAT_MODE_ALL;</span>
  52 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 /**</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55  * Created by guoshuyu on 2018/1/10.</span>
  56 =======
  57 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
  58 
  59 
  60 /**
  61  * Created by guoshuyu on 2018/1/10.
  62  * Exo
  63  */
<abbr title="  64 public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.Listener, AnalyticsListener {">  64 public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.Listener, AnalyticsListenerüîµ</abbr>
  65 
  66     public static int ON_POSITION_DISCOUNTINUITY = 2702;
  67 
  68     private static final String TAG = &quot;IjkExo2MediaPlayer&quot;;
  69 
  70     protected Context mAppContext;
  71     protected SimpleExoPlayer mInternalPlayer;
  72     protected EventLogger mEventLogger;
  73     protected DefaultRenderersFactory mRendererFactory;
  74     protected MediaSource mMediaSource;
  75     protected MappingTrackSelector mTrackSelector;
  76     protected LoadControl mLoadControl;
  77     protected String mDataSource;
  78     protected Surface mSurface;
  79     protected Map&lt;String, String&gt; mHeaders = new HashMap&lt;&gt;();
  80     protected PlaybackParameters mSpeedPlaybackParameters;
  81     protected int mVideoWidth;
  82     protected int mVideoHeight;
  83     protected int lastReportedPlaybackState;
  84     protected boolean isLastReportedPlayWhenReady;
  85     protected boolean isPreparing = true;
  86     protected boolean isBuffering = false;
  87     protected boolean isLooping = false;
  88     /**
  89      * ÊòØÂê¶Â∏¶‰∏äheader
  90      */
  91     protected boolean isPreview = false;
  92     /**
  93      * ÊòØÂê¶ÂºÄÂêØÁºìÂ≠ò
  94      */
  95     protected boolean isCache = false;
  96     /**
  97      * dataSourceÁ≠âÁöÑÂ∏ÆÁªÑÁ±ª
  98      */
  99     protected ExoSourceManager mExoHelper;
 100     /**
 101      * ÁºìÂ≠òÁõÆÂΩïÔºåÂèØ‰ª•‰∏∫Á©∫
 102      */
 103     protected File mCacheDir;
 104     /**
 105      * Á±ªÂûãË¶ÜÁõñ
 106      */
 107     private String mOverrideExtension;
 108 
 109     protected int audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 110 
 111 
 112     public IjkExo2MediaPlayer(Context context) {
 113         mAppContext = context.getApplicationContext();
 114         lastReportedPlaybackState = Player.STATE_IDLE;
 115         mExoHelper = ExoSourceManager.newInstance(context, mHeaders);
 116     }
 117 
 118 
 119     private int getVideoRendererIndex() {
 120         if (mInternalPlayer != null) {
 121             for (int i = 0; i &lt; mInternalPlayer.getRendererCount(); i++) {
 122                 if (mInternalPlayer.getRendererType(i) == C.TRACK_TYPE_VIDEO) {
 123                     return i;
 124                 }
 125             }
 126         }
 127         return 0;
 128     }
 129 
 130     @Override
 131     public void setDisplay(SurfaceHolder sh) {
 132         if (sh == null)
 133             setSurface(null);
 134         else
 135             setSurface(sh.getSurface());
 136     }
 137 
 138     @Override
 139     public void setSurface(Surface surface) {
 140         mSurface = surface;
 141         if (mInternalPlayer != null) {
 142             if (surface != null &amp;&amp; !surface.isValid()) {
 143                 mSurface = null;
 144             }
 145             mInternalPlayer.setVideoSurface(surface);
 146         }
 147     }
 148 
 149 
 150     @Override
 151     public void setDataSource(Context context, Uri uri, Map&lt;String, String&gt; headers) {
 152         if (headers != null) {
 153             mHeaders.clear();
 154             mHeaders.putAll(headers);
 155         }
 156         setDataSource(context, uri);
 157     }
 158 
 159     @Override
 160     public void setDataSource(String path) {
 161         setDataSource(mAppContext, Uri.parse(path));
 162     }
 163 
 164     @Override
 165     public void setDataSource(Context context, Uri uri) {
 166         mDataSource = uri.toString();
<abbr title=" 167         mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, mOverrideExtension);"> 167         mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, müîµ</abbr>
 168     }
 169 
 170     @Override
 171     public void setDataSource(FileDescriptor fd) {
 172         throw new UnsupportedOperationException(&quot;no support&quot;);
 173     }
 174 
 175     @Override
 176     public String getDataSource() {
 177         return mDataSource;
 178     }
 179 
 180     @Override
 181     public void prepareAsync() throws IllegalStateException {
 182         if (mInternalPlayer != null)
 183             throw new IllegalStateException(&quot;can&#x27;t prepare a prepared player&quot;);
 184         prepareAsyncInternal();
 185     }
 186 
 187     @Override
 188     public void start() throws IllegalStateException {
 189         if (mInternalPlayer == null)
 190             return;
 191         mInternalPlayer.setPlayWhenReady(true);
 192     }
 193 
 194     @Override
 195     public void stop() throws IllegalStateException {
 196         if (mInternalPlayer == null)
 197             return;
 198         mInternalPlayer.release();
 199     }
 200 
 201     @Override
 202     public void pause() throws IllegalStateException {
 203         if (mInternalPlayer == null)
 204             return;
 205         mInternalPlayer.setPlayWhenReady(false);
 206     }
 207 
 208     @Override
 209     public void setWakeMode(Context context, int mode) {
 210         // FIXME: implement
 211     }
 212 
 213     @Override
 214     public void setScreenOnWhilePlaying(boolean screenOn) {
 215         // TODO: do nothing
 216     }
 217 
 218     @Override
 219     public IjkTrackInfo[] getTrackInfo() {
 220         // TODO: implement
 221         return null;
 222     }
 223 
 224     @Override
 225     public int getVideoWidth() {
 226         return mVideoWidth;
 227     }
 228 
 229     @Override
 230     public int getVideoHeight() {
 231         return mVideoHeight;
 232     }
 233 
 234     @Override
 235     public boolean isPlaying() {
 236         if (mInternalPlayer == null)
 237             return false;
 238         int state = mInternalPlayer.getPlaybackState();
 239         switch (state) {
 240             case Player.STATE_BUFFERING:
 241             case Player.STATE_READY:
 242                 return mInternalPlayer.getPlayWhenReady();
 243             case Player.STATE_IDLE:
 244             case Player.STATE_ENDED:
 245             default:
 246                 return false;
 247         }
 248     }
 249 
 250     @Override
 251     public void seekTo(long msec) throws IllegalStateException {
 252         if (mInternalPlayer == null)
 253             return;
 254         mInternalPlayer.seekTo(msec);
 255     }
 256 
 257     @Override
 258     public long getCurrentPosition() {
 259         if (mInternalPlayer == null)
 260             return 0;
 261         return mInternalPlayer.getCurrentPosition();
 262     }
 263 
 264     @Override
 265     public long getDuration() {
 266         if (mInternalPlayer == null)
 267             return 0;
 268         return mInternalPlayer.getDuration();
 269     }
 270 
 271     @Override
 272     public int getVideoSarNum() {
 273         return 1;
 274     }
 275 
 276     @Override
 277     public int getVideoSarDen() {
 278         return 1;
 279     }
 280 
 281     @Override
 282     public void reset() {
 283         if (mInternalPlayer != null) {
 284             mInternalPlayer.release();
 285             mInternalPlayer = null;
 286         }
 287         if (mExoHelper != null) {
 288             mExoHelper.release();
 289         }
 290         mSurface = null;
 291         mDataSource = null;
 292         mVideoWidth = 0;
 293         mVideoHeight = 0;
 294     }
 295 
 296     @Override
 297     public void onCues(List&lt;Cue&gt; cues) {
 298 
 299     }
 300 
 301     @Override
 302     public void onMetadata(Metadata metadata) {
 303 
 304     }
 305 
 306     @Override
 307     public void setLooping(boolean looping) {
 308         isLooping = looping;
 309     }
 310 
 311     @Override
 312     public boolean isLooping() {
 313         return isLooping;
 314     }
 315 
 316     @Override
 317     public void setVolume(float leftVolume, float rightVolume) {
 318         if (mInternalPlayer != null)
 319             mInternalPlayer.setVolume((leftVolume + rightVolume) / 2);
 320     }
 321 
 322     @Override
 323     public int getAudioSessionId() {
 324         return audioSessionId;
 325     }
 326 
 327     @Override
 328     public MediaInfo getMediaInfo() {
 329         return null;
 330     }
 331 
 332     @Override
 333     public void setLogEnabled(boolean enable) {
 334         // do nothing
 335     }
 336 
 337     @Override
 338     public boolean isPlayable() {
 339         return true;
 340     }
 341 
 342     @Override
 343     public void setAudioStreamType(int streamtype) {
 344         // do nothing
 345     }
 346 
 347     @Override
 348     public void setKeepInBackground(boolean keepInBackground) {
 349         // do nothing
 350     }
 351 
 352     @Override
 353     public void release() {
 354         if (mInternalPlayer != null) {
 355             reset();
 356             mEventLogger = null;
 357         }
 358     }
 359 
 360     protected void prepareAsyncInternal() {
 361         new Handler(Looper.myLooper()).post(
 362                 new Runnable() {
 363                     @Override
 364                     public void run() {
 365                         if (mTrackSelector == null) {
 366                             mTrackSelector = new DefaultTrackSelector(mAppContext);
 367                         }
 368                         mEventLogger = new EventLogger(mTrackSelector);
 369                         boolean preferExtensionDecoders = true;
 370                         boolean useExtensionRenderers = true;//ÊòØÂê¶ÂºÄÂêØÊâ©Â±ï
<abbr title=" 371                         @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtensionRenderers"> 371                         @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtüîµ</abbr>
<abbr title=" 372                                 ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_MODE_PREFER"> 372                                 ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_Müîµ</abbr>
 373                                 : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_ON)
 374                                 : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_OFF;
 375                         if (mRendererFactory == null) {
 376                             mRendererFactory = new DefaultRenderersFactory(mAppContext);
 377                             mRendererFactory.setExtensionRendererMode(extensionRendererMode);
 378                         }
 379                         if (mLoadControl == null) {
 380                             mLoadControl = new DefaultLoadControl();
 381                         }
 382                         mInternalPlayer = new SimpleExoPlayer.Builder(mAppContext, mRendererFactory)
 383                                 .setLooper(Looper.myLooper())
 384                                 .setTrackSelector(mTrackSelector)
 385                                 .setLoadControl(mLoadControl).build();
 386                         mInternalPlayer.addListener(IjkExo2MediaPlayer.this);
 387                         mInternalPlayer.addAnalyticsListener(IjkExo2MediaPlayer.this);
 388                         mInternalPlayer.addListener(mEventLogger);
 389                         if (mSpeedPlaybackParameters != null) {
 390                             mInternalPlayer.setPlaybackParameters(mSpeedPlaybackParameters);
 391                         }
 392                         if (isLooping) {
 393                             mInternalPlayer.setRepeatMode(REPEAT_MODE_ALL);
 394                         }
 395                         if (mSurface != null)
 396                             mInternalPlayer.setVideoSurface(mSurface);
 397                         mInternalPlayer.setMediaSource(mMediaSource);
 398                         mInternalPlayer.prepare();
 399                         mInternalPlayer.setPlayWhenReady(false);
 400                     }
 401                 }
 402         );
 403     }
 404 
 405     public String getOverrideExtension() {
 406         return mOverrideExtension;
 407     }
 408 
 409     public void setOverrideExtension(String overrideExtension) {
 410         this.mOverrideExtension = overrideExtension;
 411     }
 412 
 413     public void stopPlayback() {
 414         mInternalPlayer.stop();
 415     }
 416 
 417     /**
 418      * ÊòØÂê¶ÈúÄË¶ÅÂ∏¶‰∏äheader
 419      * setDataSource‰πãÂâçÁîüÊïà
 420      */
 421     public void setPreview(boolean preview) {
 422         isPreview = preview;
 423     }
 424 
 425     public boolean isPreview() {
 426         return isPreview;
 427     }
 428 
 429     public boolean isCache() {
 430         return isCache;
 431     }
 432 
 433 
 434     /**
 435      * ËÆæÁΩÆseek ÁöÑ‰∏¥ËøëÂ∏ß„ÄÇ
 436      **/
 437     public void setSeekParameter(@Nullable SeekParameters seekParameters) {
 438         mInternalPlayer.setSeekParameters(seekParameters);
 439     }
 440 
 441 
 442     /**
 443      * ÊòØÂê¶ÂºÄÂêØcache
 444      * setDataSource‰πãÂâçÁîüÊïà
 445      */
 446     public void setCache(boolean cache) {
 447         isCache = cache;
 448     }
 449 
 450     public File getCacheDir() {
 451         return mCacheDir;
 452     }
 453 
 454     /**
 455      * cacheÊñá‰ª∂ÁöÑÁõÆÂΩï
 456      * setDataSource‰πãÂâçÁîüÊïà
 457      */
 458     public void setCacheDir(File cacheDir) {
 459         this.mCacheDir = cacheDir;
 460     }
 461 
 462     public MediaSource getMediaSource() {
 463         return mMediaSource;
 464     }
 465 
 466     public void setMediaSource(MediaSource mediaSource) {
 467         this.mMediaSource = mediaSource;
 468     }
 469 
 470     public ExoSourceManager getExoHelper() {
 471         return mExoHelper;
 472     }
 473 
 474     /**
 475      * ÂÄçÈÄüÊí≠Êîæ
 476      *
 477      * @param speed ÂÄçÈÄüÊí≠ÊîæÔºåÈªòËÆ§‰∏∫1
 478      * @param pitch Èü≥ÈáèÁº©ÊîæÔºåÈªòËÆ§‰∏∫1Ôºå‰øÆÊîπ‰ºöÂØºËá¥Â£∞Èü≥ÂèòË∞É
 479      */
 480     public void setSpeed(@Size(min = 0) float speed, @Size(min = 0) float pitch) {
 481         PlaybackParameters playbackParameters = new PlaybackParameters(speed, pitch);
 482         mSpeedPlaybackParameters = playbackParameters;
 483         if (mInternalPlayer != null) {
 484             mInternalPlayer.setPlaybackParameters(playbackParameters);
 485         }
 486     }
 487 
 488     public float getSpeed() {
 489         return mInternalPlayer.getPlaybackParameters().speed;
 490     }
 491 
 492     public int getBufferedPercentage() {
 493         if (mInternalPlayer == null)
 494             return 0;
 495 
 496         return mInternalPlayer.getBufferedPercentage();
 497     }
 498 
 499 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
 500 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 501     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 502 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 503     public MappingTrackSelector getTrackSelector() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 504         return mTrackSelector;</span>
 505 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 506 </span>
 507 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 508     public MappingTrackSelector getTrackSelector() {
 509         return mTrackSelector;
 510     }
 511 
 512     public void setTrackSelector(MappingTrackSelector trackSelector) {
 513         this.mTrackSelector = trackSelector;
 514     }
 515 
 516     public LoadControl getLoadControl() {
 517         return mLoadControl;
 518     }
 519 
 520     public void setLoadControl(LoadControl loadControl) {
 521         this.mLoadControl = loadControl;
 522     }
 523 
 524     public DefaultRenderersFactory getRendererFactory() {
 525         return mRendererFactory;
 526     }
 527 
 528     public void setRendererFactory(DefaultRenderersFactory rendererFactory) {
 529         this.mRendererFactory = rendererFactory;
 530     }
 531 
 532     @Override
<abbr title=" 533     public void onTracksChanged(@NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelections) {"> 533     public void onTracksChanged(@NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSüîµ</abbr>
 534 
 535     }
 536 
 537     @SuppressLint(&quot;SwitchIntDef&quot;)
 538     @Override
 539 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 540     public void onIsLoadingChanged(boolean isLoading) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 541 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 542     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 543 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 544     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 545     public void onPlaybackStateChanged(int state) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 546         onPlayWhenReadyChanged(isLastReportedPlayWhenReady, state);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 547     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 548 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 549     @Override</span>
 550 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 551     public void onLoadingChanged(boolean isLoading) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 552 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 553     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 554 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 555     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 556     public void onPlayerStateChanged(boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 557         //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 558         //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 559         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 559         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + plüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 560         if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 561             int buffer = 0;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 562             if(mInternalPlayer != null) {</span>
 563 =======
 564 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 565     public void onPlayWhenReadyChanged(boolean playWhenReady, int playbackState) {
 566         //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY
 567         //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY
<abbr title=" 568         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 568         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + plüîµ</abbr>
 569         if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {
 570             int buffer = 0;
 571             if (mInternalPlayer != null) {
 572                 buffer = mInternalPlayer.getBufferedPercentage();
 573             }
 574             if (isBuffering) {
 575                 switch (playbackState) {
 576                     case Player.STATE_ENDED:
 577                     case Player.STATE_READY:
 578                         notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_END, buffer);
 579                         isBuffering = false;
 580                         break;
 581                 }
 582             }
 583 
 584             if (isPreparing) {
 585                 switch (playbackState) {
 586                     case Player.STATE_READY:
 587                         notifyOnPrepared();
 588                         isPreparing = false;
 589                         break;
 590                 }
 591             }
 592 
 593             switch (playbackState) {
 594                 case Player.STATE_BUFFERING:
 595                     notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_START, buffer);
 596                     isBuffering = true;
 597                     break;
 598                 case Player.STATE_ENDED:
 599                     notifyOnCompletion();
 600                     break;
 601                 default:
 602                     break;
 603             }
 604         }
 605         isLastReportedPlayWhenReady = playWhenReady;
 606         lastReportedPlaybackState = playbackState;
 607     }
 608 
 609     @Override
 610     public void onRepeatModeChanged(int repeatMode) {
 611 
 612     }
 613 
 614     @Override
 615     public void onShuffleModeEnabledChanged(boolean shuffleModeEnabled) {
 616 
 617     }
 618 
 619     @Override
 620     public void onPlayerError(@NonNull ExoPlaybackException error) {
 621         notifyOnError(IMediaPlayer.MEDIA_ERROR_UNKNOWN, IMediaPlayer.MEDIA_ERROR_UNKNOWN);
 622     }
 623 
 624     @Override
 625 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 626     public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition, int reason) {"> 626     public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition,üîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 627         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 628         if (reason == DISCONTINUITY_REASON_SEEK) {</span>
 629 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 630 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 631     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 632     public void onPlayerError(ExoPlaybackException error) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 633         notifyOnError(IMediaPlayer.MEDIA_ERROR_UNKNOWN, IMediaPlayer.MEDIA_ERROR_UNKNOWN);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 634     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 635 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 636     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 637     public void onPositionDiscontinuity(int reason) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 638 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 639     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 640 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 641     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 642     public void onPlaybackParametersChanged(PlaybackParameters playbackParameters) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 643 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 644     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 645 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 646     @Override</span>
 647 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648     public void onPositionDiscontinuity(int reason) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649         if(reason == DISCONTINUITY_REASON_SEEK) {</span>
 650 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 651             notifyOnSeekComplete();
 652         }
 653     }
 654 
 655     @Override
 656     public void onPlaybackParametersChanged(@NonNull PlaybackParameters playbackParameters) {
 657 
 658     }
 659 
 660 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
 661 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 662     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 663     public void onPlaybackParametersChanged(PlaybackParameters playbackParameters) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 664 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 665     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 666 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 667     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 668     public void onSeekProcessed() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 669         notifyOnSeekComplete();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 670     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 671 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 672     /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////"> 672     /////////////////////////////////////AudioRendererEventListener//////////////////////////////////////üîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 673 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 674 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 675     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 676     public void onPlayerStateChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>
 677 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 678 </span>
 679 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
<abbr title=" 680     /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////"> 680     /////////////////////////////////////AudioRendererEventListener//////////////////////////////////////üîµ</abbr>
 681 
 682 
 683     @Override
 684 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 685     public void onPlayWhenReadyChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>
 686 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 687     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 688     public void onSeekProcessed() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 689         notifyOnSeekComplete();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 690     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 691 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 692     /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////"> 692     /////////////////////////////////////AudioRendererEventListener//////////////////////////////////////üîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 693 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 694 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 695     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 696     public void onPlayerStateChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 697 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 698     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 699 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 700     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 701     public void onTimelineChanged(EventTime eventTime, int reason) {</span>
 702 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703     public void onTimelineChanged(@NonNull EventTime eventTime, int reason) {</span>
 704 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 705 
 706     }
 707 
 708     @Override
 709 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 710     public void onTimelineChanged(EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 711 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 712     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 713 </span>
 714 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 715     /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////"> 715     /////////////////////////////////////AudioRendererEventListener//////////////////////////////////////üîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 716 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 717 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 718     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 719     public void onPlayerStateChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 720 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 721     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 722 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 723     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 724     public void onTimelineChanged(EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 725 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 726     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 727 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 728     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 729     public void onPositionDiscontinuity(EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 730         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 731     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 732 </span>
 733 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734     public void onPositionDiscontinuity(@NonNull EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 735         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 736     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 737 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 738     @Override</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 739     public void onSeekStarted(@NonNull EventTime eventTime) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 740 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 741     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743     @Override</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 744     public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters playbackParameters) {"> 744     public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters plaüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 745 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 746     }</span>
 747 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 748 
 749     @Override
 750     public void onRepeatModeChanged(@NonNull EventTime eventTime, int repeatMode) {
 751 
 752     }
 753 
 754     @Override
 755     public void onShuffleModeChanged(@NonNull EventTime eventTime, boolean shuffleModeEnabled) {
 756 
 757     }
 758 
 759     @Override
 760     public void onPlayerError(@NonNull EventTime eventTime, @NonNull ExoPlaybackException error) {
 761 
 762     }
 763 
 764     @Override
 765 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 766     public void onIsLoadingChanged(EventTime eventTime, boolean isLoading) {</span>
 767 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 768 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 769     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 770 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 771     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 772     public void onRepeatModeChanged(EventTime eventTime, int repeatMode) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 773 </span>
 774 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 775     public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelections) {"> 775     public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNüîµ</abbr></span>
 776 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 777 
 778     }
 779 
 780     @Override
<abbr title=" 781     public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 781     public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaüîµ</abbr>
 782 
 783     }
 784 
 785     @Override
 786     public void onMetadata(@NonNull EventTime eventTime, @NonNull Metadata metadata) {
 787 
 788     }
 789 
 790     @Override
 791 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 792     public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 792     public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, longüîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 793 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 794     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 795 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 796     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 797     public void onMetadata(EventTime eventTime, Metadata metadata) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 798 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 799     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 800 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 801     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 802     public void onAudioDisabled(EventTime eventTime, DecoderCounters counters) {</span>
 803 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 804 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 805     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 806 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 807     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 808     public void onPlayerError(EventTime eventTime, ExoPlaybackException error) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 809 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 810     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 811 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 812     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 813     public void onTracksChanged(EventTime eventTime, TrackGroupArray trackGroups, TrackSelectionArray trackSelections) {"> 813     public void onTracksChanged(EventTime eventTime, TrackGroupArray trackGroups, TrackSelectionArray traüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 814 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 815     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 816 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 817     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 818     public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 818     public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, longüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 819 </span>
 820 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 821     public void onAudioDisabled(@NonNull EventTime eventTime, @NonNull DecoderCounters counters)  {</span>
 822 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 823         audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 824     }
 825 
 826     @Override
<abbr title=" 827     public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs) {"> 827     public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elaüîµ</abbr>
 828 
 829     }
 830 
 831     @Override
 832     public void onDroppedVideoFrames(@NonNull EventTime eventTime, int droppedFrames, long elapsedMs) {
 833 
 834     }
 835 
 836     @Override
 837 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 838     public void onVideoSizeChanged(EventTime eventTime, VideoSize videoSize) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 839         mVideoWidth = (int) (videoSize.width * videoSize.pixelWidthHeightRatio);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 840         mVideoHeight = videoSize.height;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 841         notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.height, 1, 1);"> 841         notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.heiüîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 842         if (videoSize.unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 843             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, videoSize.unappliedRotationDegrees);"> 843             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, videoSize.unappliedRotationDegreüîµ</abbr></span>
 844 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 845 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 846     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 847 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 848     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 849     public void onMetadata(EventTime eventTime, Metadata metadata) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 850 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 851     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 852 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 853     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 854     public void onDecoderEnabled(EventTime eventTime, int trackType, DecoderCounters decoderCounters) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 855 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 856     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 857 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 858     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 859     public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initializationDurationMs) {"> 859     public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initialüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 860 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 861     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 862 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 863     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 864     public void onDecoderInputFormatChanged(EventTime eventTime, int trackType, Format format) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 865 </span>
 866 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 867     public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotationDegrees, float pixelWidthHeightRatio) {"> 867     public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotaüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 868         mVideoWidth = (int) (width * pixelWidthHeightRatio);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 869         mVideoHeight = height;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 870         notifyOnVideoSizeChanged((int) (width * pixelWidthHeightRatio), height, 1, 1);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 871         if (unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 872             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, unappliedRotationDegrees);</span>
 873 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 874     }
 875 
 876 
 877     @Override
 878 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 879     public void onRenderedFirstFrame(EventTime eventTime, Object output, long renderTimeMs) {</span>
 880 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 881     public void onDecoderEnabled(EventTime eventTime, int trackType, DecoderCounters decoderCounters) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 882 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 883     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 884 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 885     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 886     public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initializationDurationMs) {"> 886     public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initialüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 887 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 888     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 889 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 890     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 891     public void onDecoderInputFormatChanged(EventTime eventTime, int trackType, Format format) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 892 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 893     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 894 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 895     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 896     public void onDecoderDisabled(EventTime eventTime, int trackType, DecoderCounters decoderCounters) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 897         audioSessionId = C.AUDIO_SESSION_ID_UNSET;</span>
 898 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 899     public void onRenderedFirstFrame(@NonNull EventTime eventTime, Surface surface) {</span>
 900 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 901 
 902     }
 903 
 904     @Override
 905     public void onDrmKeysLoaded(@NonNull EventTime eventTime) {
 906 
 907     }
 908 
 909     @Override
 910     public void onDrmSessionManagerError(@NonNull EventTime eventTime, @NonNull Exception error) {
 911 
 912     }
 913 
 914     @Override
 915     public void onDrmKeysRestored(@NonNull EventTime eventTime) {
 916 
 917     }
 918 
 919     @Override
 920     public void onDrmKeysRemoved(@NonNull EventTime eventTime) {
 921 
 922     }
 923 }</pre></td>
                            <td><pre>   1 
   2 package tv.danmaku.ijk.media.exo2;
   3 
   4 import android.annotation.SuppressLint;
   5 import android.content.Context;
   6 import android.net.Uri;
   7 import android.os.Handler;
   8 import android.os.Looper;
   9 
  10 import androidx.annotation.NonNull;
  11 import androidx.annotation.Nullable;
  12 import androidx.annotation.Size;
  13 
  14 import android.view.Surface;
  15 import android.view.SurfaceHolder;
  16 
  17 import com.google.android.exoplayer2.C;
  18 import com.google.android.exoplayer2.DefaultLoadControl;
  19 import com.google.android.exoplayer2.DefaultRenderersFactory;
  20 import com.google.android.exoplayer2.ExoPlaybackException;
  21 import com.google.android.exoplayer2.LoadControl;
  22 import com.google.android.exoplayer2.PlaybackParameters;
  23 import com.google.android.exoplayer2.Player;
  24 import com.google.android.exoplayer2.SeekParameters;
  25 import com.google.android.exoplayer2.SimpleExoPlayer;
  26 import com.google.android.exoplayer2.analytics.AnalyticsListener;
  27 import com.google.android.exoplayer2.decoder.DecoderCounters;
  28 import com.google.android.exoplayer2.metadata.Metadata;
  29 import com.google.android.exoplayer2.source.MediaSource;
  30 import com.google.android.exoplayer2.source.TrackGroupArray;
  31 import com.google.android.exoplayer2.text.Cue;
  32 import com.google.android.exoplayer2.trackselection.DefaultTrackSelector;
  33 import com.google.android.exoplayer2.trackselection.MappingTrackSelector;
  34 import com.google.android.exoplayer2.trackselection.TrackSelectionArray;
  35 import com.google.android.exoplayer2.video.VideoSize;
  36 
  37 import java.io.File;
  38 import java.io.FileDescriptor;
  39 import java.util.HashMap;
  40 import java.util.List;
  41 import java.util.Map;
  42 
  43 import tv.danmaku.ijk.media.exo2.demo.EventLogger;
  44 import tv.danmaku.ijk.media.player.AbstractMediaPlayer;
  45 import tv.danmaku.ijk.media.player.IMediaPlayer;
  46 import tv.danmaku.ijk.media.player.MediaInfo;
  47 import tv.danmaku.ijk.media.player.misc.IjkTrackInfo;
  48 
  49 import static com.google.android.exoplayer2.Player.DISCONTINUITY_REASON_SEEK;
  50 import static com.google.android.exoplayer2.Player.REPEAT_MODE_ALL;
  51 
  52 
  53 /**
  54  * Created by guoshuyu on 2018/1/10.
  55  * Exo
  56  */
<abbr title="  57 public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.Listener, AnalyticsListener {">  57 public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.Listener, AnalyticsListenerüîµ</abbr>
  58 
  59     public static int ON_POSITION_DISCOUNTINUITY = 2702;
  60 
  61     private static final String TAG = &quot;IjkExo2MediaPlayer&quot;;
  62 
  63     protected Context mAppContext;
  64     protected SimpleExoPlayer mInternalPlayer;
  65     protected EventLogger mEventLogger;
  66     protected DefaultRenderersFactory mRendererFactory;
  67     protected MediaSource mMediaSource;
  68     protected MappingTrackSelector mTrackSelector;
  69     protected LoadControl mLoadControl;
  70     protected String mDataSource;
  71     protected Surface mSurface;
  72     protected Map&lt;String, String&gt; mHeaders = new HashMap&lt;&gt;();
  73     protected PlaybackParameters mSpeedPlaybackParameters;
  74     protected int mVideoWidth;
  75     protected int mVideoHeight;
  76     protected int lastReportedPlaybackState;
  77     protected boolean isLastReportedPlayWhenReady;
  78     protected boolean isPreparing = true;
  79     protected boolean isBuffering = false;
  80     protected boolean isLooping = false;
  81     /**
  82      * ÊòØÂê¶Â∏¶‰∏äheader
  83      */
  84     protected boolean isPreview = false;
  85     /**
  86      * ÊòØÂê¶ÂºÄÂêØÁºìÂ≠ò
  87      */
  88     protected boolean isCache = false;
  89     /**
  90      * dataSourceÁ≠âÁöÑÂ∏ÆÁªÑÁ±ª
  91      */
  92     protected ExoSourceManager mExoHelper;
  93     /**
  94      * ÁºìÂ≠òÁõÆÂΩïÔºåÂèØ‰ª•‰∏∫Á©∫
  95      */
  96     protected File mCacheDir;
  97     /**
  98      * Á±ªÂûãË¶ÜÁõñ
  99      */
 100     private String mOverrideExtension;
 101 
 102     protected int audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 103 
 104 
 105     public IjkExo2MediaPlayer(Context context) {
 106         mAppContext = context.getApplicationContext();
 107         lastReportedPlaybackState = Player.STATE_IDLE;
 108         mExoHelper = ExoSourceManager.newInstance(context, mHeaders);
 109     }
 110 
 111 
 112     private int getVideoRendererIndex() {
 113         if (mInternalPlayer != null) {
 114             for (int i = 0; i &lt; mInternalPlayer.getRendererCount(); i++) {
 115                 if (mInternalPlayer.getRendererType(i) == C.TRACK_TYPE_VIDEO) {
 116                     return i;
 117                 }
 118             }
 119         }
 120         return 0;
 121     }
 122 
 123     @Override
 124     public void setDisplay(SurfaceHolder sh) {
 125         if (sh == null)
 126             setSurface(null);
 127         else
 128             setSurface(sh.getSurface());
 129     }
 130 
 131     @Override
 132     public void setSurface(Surface surface) {
 133         mSurface = surface;
 134         if (mInternalPlayer != null) {
 135             if (surface != null &amp;&amp; !surface.isValid()) {
 136                 mSurface = null;
 137             }
 138             mInternalPlayer.setVideoSurface(surface);
 139         }
 140     }
 141 
 142 
 143     @Override
 144     public void setDataSource(Context context, Uri uri, Map&lt;String, String&gt; headers) {
 145         if (headers != null) {
 146             mHeaders.clear();
 147             mHeaders.putAll(headers);
 148         }
 149         setDataSource(context, uri);
 150     }
 151 
 152     @Override
 153     public void setDataSource(String path) {
 154         setDataSource(mAppContext, Uri.parse(path));
 155     }
 156 
 157     @Override
 158     public void setDataSource(Context context, Uri uri) {
 159         mDataSource = uri.toString();
<abbr title=" 160         mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, mOverrideExtension);"> 160         mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, müîµ</abbr>
 161     }
 162 
 163     @Override
 164     public void setDataSource(FileDescriptor fd) {
 165         throw new UnsupportedOperationException(&quot;no support&quot;);
 166     }
 167 
 168     @Override
 169     public String getDataSource() {
 170         return mDataSource;
 171     }
 172 
 173     @Override
 174     public void prepareAsync() throws IllegalStateException {
 175         if (mInternalPlayer != null)
 176             throw new IllegalStateException(&quot;can&#x27;t prepare a prepared player&quot;);
 177         prepareAsyncInternal();
 178     }
 179 
 180     @Override
 181     public void start() throws IllegalStateException {
 182         if (mInternalPlayer == null)
 183             return;
 184         mInternalPlayer.setPlayWhenReady(true);
 185     }
 186 
 187     @Override
 188     public void stop() throws IllegalStateException {
 189         if (mInternalPlayer == null)
 190             return;
 191         mInternalPlayer.release();
 192     }
 193 
 194     @Override
 195     public void pause() throws IllegalStateException {
 196         if (mInternalPlayer == null)
 197             return;
 198         mInternalPlayer.setPlayWhenReady(false);
 199     }
 200 
 201     @Override
 202     public void setWakeMode(Context context, int mode) {
 203         // FIXME: implement
 204     }
 205 
 206     @Override
 207     public void setScreenOnWhilePlaying(boolean screenOn) {
 208         // TODO: do nothing
 209     }
 210 
 211     @Override
 212     public IjkTrackInfo[] getTrackInfo() {
 213         // TODO: implement
 214         return null;
 215     }
 216 
 217     @Override
 218     public int getVideoWidth() {
 219         return mVideoWidth;
 220     }
 221 
 222     @Override
 223     public int getVideoHeight() {
 224         return mVideoHeight;
 225     }
 226 
 227     @Override
 228     public boolean isPlaying() {
 229         if (mInternalPlayer == null)
 230             return false;
 231         int state = mInternalPlayer.getPlaybackState();
 232         switch (state) {
 233             case Player.STATE_BUFFERING:
 234             case Player.STATE_READY:
 235                 return mInternalPlayer.getPlayWhenReady();
 236             case Player.STATE_IDLE:
 237             case Player.STATE_ENDED:
 238             default:
 239                 return false;
 240         }
 241     }
 242 
 243     @Override
 244     public void seekTo(long msec) throws IllegalStateException {
 245         if (mInternalPlayer == null)
 246             return;
 247         mInternalPlayer.seekTo(msec);
 248     }
 249 
 250     @Override
 251     public long getCurrentPosition() {
 252         if (mInternalPlayer == null)
 253             return 0;
 254         return mInternalPlayer.getCurrentPosition();
 255     }
 256 
 257     @Override
 258     public long getDuration() {
 259         if (mInternalPlayer == null)
 260             return 0;
 261         return mInternalPlayer.getDuration();
 262     }
 263 
 264     @Override
 265     public int getVideoSarNum() {
 266         return 1;
 267     }
 268 
 269     @Override
 270     public int getVideoSarDen() {
 271         return 1;
 272     }
 273 
 274     @Override
 275     public void reset() {
 276         if (mInternalPlayer != null) {
 277             mInternalPlayer.release();
 278             mInternalPlayer = null;
 279         }
 280         if (mExoHelper != null) {
 281             mExoHelper.release();
 282         }
 283         mSurface = null;
 284         mDataSource = null;
 285         mVideoWidth = 0;
 286         mVideoHeight = 0;
 287     }
 288 
 289     @Override
 290 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 291     public void onCues(List&lt;Cue&gt; cues) {</span>
 292 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293     public void onRenderedFirstFrame(EventTime eventTime, Surface surface) {</span>
 294 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295     public void onRenderedFirstFrame(@NonNull EventTime eventTime, Surface surface) {</span>
 296 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 297 
 298     }
 299 
 300     @Override
 301     public void onMetadata(Metadata metadata) {
 302 
 303     }
 304 
 305     @Override
 306     public void setLooping(boolean looping) {
 307         isLooping = looping;
 308     }
 309 
 310     @Override
 311     public boolean isLooping() {
 312         return isLooping;
 313     }
 314 
 315     @Override
 316     public void setVolume(float leftVolume, float rightVolume) {
 317         if (mInternalPlayer != null)
 318             mInternalPlayer.setVolume((leftVolume + rightVolume) / 2);
 319     }
 320 
 321     @Override
 322     public int getAudioSessionId() {
 323         return audioSessionId;
 324     }
 325 
 326     @Override
 327     public MediaInfo getMediaInfo() {
 328         return null;
 329     }
 330 
 331     @Override
 332     public void setLogEnabled(boolean enable) {
 333         // do nothing
 334     }
 335 
 336     @Override
 337     public boolean isPlayable() {
 338         return true;
 339     }
 340 
 341     @Override
 342     public void setAudioStreamType(int streamtype) {
 343         // do nothing
 344     }
 345 
 346     @Override
 347     public void setKeepInBackground(boolean keepInBackground) {
 348         // do nothing
 349     }
 350 
 351     @Override
 352     public void release() {
 353         if (mInternalPlayer != null) {
 354             reset();
 355             mEventLogger = null;
 356         }
 357     }
 358 
 359     protected void prepareAsyncInternal() {
 360         new Handler(Looper.myLooper()).post(
 361                 new Runnable() {
 362                     @Override
 363                     public void run() {
 364                         if (mTrackSelector == null) {
 365                             mTrackSelector = new DefaultTrackSelector(mAppContext);
 366                         }
 367                         mEventLogger = new EventLogger(mTrackSelector);
 368                         boolean preferExtensionDecoders = true;
 369                         boolean useExtensionRenderers = true;//ÊòØÂê¶ÂºÄÂêØÊâ©Â±ï
<abbr title=" 370                         @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtensionRenderers"> 370                         @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtüîµ</abbr>
<abbr title=" 371                                 ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_MODE_PREFER"> 371                                 ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_Müîµ</abbr>
 372                                 : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_ON)
 373                                 : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_OFF;
 374                         if (mRendererFactory == null) {
 375                             mRendererFactory = new DefaultRenderersFactory(mAppContext);
 376                             mRendererFactory.setExtensionRendererMode(extensionRendererMode);
 377                         }
 378                         if (mLoadControl == null) {
 379                             mLoadControl = new DefaultLoadControl();
 380                         }
 381                         mInternalPlayer = new SimpleExoPlayer.Builder(mAppContext, mRendererFactory)
 382                                 .setLooper(Looper.myLooper())
 383                                 .setTrackSelector(mTrackSelector)
 384                                 .setLoadControl(mLoadControl).build();
 385                         mInternalPlayer.addListener(IjkExo2MediaPlayer.this);
 386                         mInternalPlayer.addAnalyticsListener(IjkExo2MediaPlayer.this);
 387                         mInternalPlayer.addListener(mEventLogger);
 388                         if (mSpeedPlaybackParameters != null) {
 389                             mInternalPlayer.setPlaybackParameters(mSpeedPlaybackParameters);
 390                         }
 391                         if (isLooping) {
 392                             mInternalPlayer.setRepeatMode(REPEAT_MODE_ALL);
 393                         }
 394                         if (mSurface != null)
 395                             mInternalPlayer.setVideoSurface(mSurface);
 396                         mInternalPlayer.setMediaSource(mMediaSource);
 397                         mInternalPlayer.prepare();
 398                         mInternalPlayer.setPlayWhenReady(false);
 399                     }
 400                 }
 401         );
 402     }
 403 
 404     public String getOverrideExtension() {
 405         return mOverrideExtension;
 406     }
 407 
 408     public void setOverrideExtension(String overrideExtension) {
 409         this.mOverrideExtension = overrideExtension;
 410     }
 411 
 412     public void stopPlayback() {
 413         mInternalPlayer.stop();
 414     }
 415 
 416     /**
 417      * ÊòØÂê¶ÈúÄË¶ÅÂ∏¶‰∏äheader
 418      * setDataSource‰πãÂâçÁîüÊïà
 419      */
 420     public void setPreview(boolean preview) {
 421         isPreview = preview;
 422     }
 423 
 424     public boolean isPreview() {
 425         return isPreview;
 426     }
 427 
 428     public boolean isCache() {
 429         return isCache;
 430     }
 431 
 432 
 433     /**
 434      * ËÆæÁΩÆseek ÁöÑ‰∏¥ËøëÂ∏ß„ÄÇ
 435      **/
 436     public void setSeekParameter(@Nullable SeekParameters seekParameters) {
 437         mInternalPlayer.setSeekParameters(seekParameters);
 438     }
 439 
 440 
 441     /**
 442      * ÊòØÂê¶ÂºÄÂêØcache
 443      * setDataSource‰πãÂâçÁîüÊïà
 444      */
 445     public void setCache(boolean cache) {
 446         isCache = cache;
 447     }
 448 
 449     public File getCacheDir() {
 450         return mCacheDir;
 451     }
 452 
 453     /**
 454      * cacheÊñá‰ª∂ÁöÑÁõÆÂΩï
 455      * setDataSource‰πãÂâçÁîüÊïà
 456      */
 457     public void setCacheDir(File cacheDir) {
 458         this.mCacheDir = cacheDir;
 459     }
 460 
 461     public MediaSource getMediaSource() {
 462         return mMediaSource;
 463     }
 464 
 465     public void setMediaSource(MediaSource mediaSource) {
 466         this.mMediaSource = mediaSource;
 467     }
 468 
 469     public ExoSourceManager getExoHelper() {
 470         return mExoHelper;
 471     }
 472 
 473     /**
 474      * ÂÄçÈÄüÊí≠Êîæ
 475      *
 476      * @param speed ÂÄçÈÄüÊí≠ÊîæÔºåÈªòËÆ§‰∏∫1
 477      * @param pitch Èü≥ÈáèÁº©ÊîæÔºåÈªòËÆ§‰∏∫1Ôºå‰øÆÊîπ‰ºöÂØºËá¥Â£∞Èü≥ÂèòË∞É
 478      */
 479     public void setSpeed(@Size(min = 0) float speed, @Size(min = 0) float pitch) {
 480         PlaybackParameters playbackParameters = new PlaybackParameters(speed, pitch);
 481         mSpeedPlaybackParameters = playbackParameters;
 482         if (mInternalPlayer != null) {
 483             mInternalPlayer.setPlaybackParameters(playbackParameters);
 484         }
 485     }
 486 
 487     public float getSpeed() {
 488         return mInternalPlayer.getPlaybackParameters().speed;
 489     }
 490 
 491     public int getBufferedPercentage() {
 492         if (mInternalPlayer == null)
 493             return 0;
 494 
 495         return mInternalPlayer.getBufferedPercentage();
 496     }
 497 
 498 
 499     public MappingTrackSelector getTrackSelector() {
 500         return mTrackSelector;
 501     }
 502 
 503     public void setTrackSelector(MappingTrackSelector trackSelector) {
 504         this.mTrackSelector = trackSelector;
 505     }
 506 
 507     public LoadControl getLoadControl() {
 508         return mLoadControl;
 509     }
 510 
 511     public void setLoadControl(LoadControl loadControl) {
 512         this.mLoadControl = loadControl;
 513     }
 514 
 515     public DefaultRenderersFactory getRendererFactory() {
 516         return mRendererFactory;
 517     }
 518 
 519     public void setRendererFactory(DefaultRenderersFactory rendererFactory) {
 520         this.mRendererFactory = rendererFactory;
 521     }
 522 
 523     @Override
 524     public void onIsLoadingChanged(boolean isLoading) {
 525 
 526     }
 527 
 528     @Override
 529     public void onPlaybackStateChanged(int state) {
 530         onPlayWhenReadyChanged(isLastReportedPlayWhenReady, state);
 531     }
 532 
 533 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 534     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 535     public void onPlayWhenReadyChanged(boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 536         //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 537         //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 538         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 538         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + plüîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 539         if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 540             int buffer = 0;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 541             if (mInternalPlayer != null) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 542                 buffer = mInternalPlayer.getBufferedPercentage();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 543             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 544             if (isBuffering) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 545                 switch (playbackState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 546                     case Player.STATE_ENDED:</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 547                     case Player.STATE_READY:</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 548                         notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_END, buffer);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 549                         isBuffering = false;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 550                         break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 551                 }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 552             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 553 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 554             if (isPreparing) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 555                 switch (playbackState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 556                     case Player.STATE_READY:</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 557                         notifyOnPrepared();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 558                         isPreparing = false;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 559                         break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 560                 }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 561             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 562 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 563             switch (playbackState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 564                 case Player.STATE_BUFFERING:</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 565                     notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_START, buffer);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 566                     isBuffering = true;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 567                     break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 568                 case Player.STATE_READY:</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 569                     break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 570                 case Player.STATE_ENDED:</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 571                     notifyOnCompletion();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 572                     break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 573                 default:</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 574                     break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 575             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 576         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 577         isLastReportedPlayWhenReady = playWhenReady;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 578         lastReportedPlaybackState = playbackState;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 579     }</span>
 580 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 581     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 582     public void onPlayerStateChanged(boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 583         //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 584         //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 585         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 585         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + plüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 586         if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 587             int buffer = 0;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 588             if(mInternalPlayer != null) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 589                 buffer =  mInternalPlayer.getBufferedPercentage();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 590             }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 591             if (isBuffering) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 592                 switch (playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 593                     case Player.STATE_ENDED:</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 594                     case Player.STATE_READY:</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 595                         notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_END, buffer);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 596                         isBuffering = false;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 597                         break;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 598                 }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 599             }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 600 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 601             if (isPreparing) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 602                 switch (playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 603                     case Player.STATE_READY:</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 604                         notifyOnPrepared();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 605                         isPreparing = false;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 606                         break;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 607                 }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 608             }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 609 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 610             switch (playbackState) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 611                 case Player.STATE_BUFFERING:</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 612                     notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_START, buffer);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 613                     isBuffering = true;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 614                     break;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 615                 case Player.STATE_READY:</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 616                     break;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 617                 case Player.STATE_ENDED:</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 618                     notifyOnCompletion();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 619                     break;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 620                 default:</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 621                     break;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 622             }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 623         }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 624         isLastReportedPlayWhenReady = playWhenReady;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 625         lastReportedPlaybackState = playbackState;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 626     }</span>
 627 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628     @SuppressLint(&quot;SwitchIntDef&quot;)</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629     @Override</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630     public void onPlayWhenReadyChanged(boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631         //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632         //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 633         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 633         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + plüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634         if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635             int buffer = 0;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636             if(mInternalPlayer != null) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637                 buffer =  mInternalPlayer.getBufferedPercentage();</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638             }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639             if (isBuffering) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640                 switch (playbackState) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641                     case Player.STATE_ENDED:</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642                     case Player.STATE_READY:</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643                         notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_END, buffer);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644                         isBuffering = false;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645                         break;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646                 }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647             }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649             if (isPreparing) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650                 switch (playbackState) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651                     case Player.STATE_READY:</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652                         notifyOnPrepared();</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 653                         isPreparing = false;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 654                         break;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655                 }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656             }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 658             switch (playbackState) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 659                 case Player.STATE_BUFFERING:</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 660                     notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_START, buffer);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661                     isBuffering = true;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 662                     break;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663                 case Player.STATE_ENDED:</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 664                     notifyOnCompletion();</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665                     break;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666                 default:</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667                     break;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668             }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669         }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670         isLastReportedPlayWhenReady = playWhenReady;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671         lastReportedPlaybackState = playbackState;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672     }</span>
 673 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 674 
 675     @Override
 676     public void onRepeatModeChanged(int repeatMode) {
 677 
 678     }
 679 
 680     @Override
 681     public void onShuffleModeEnabledChanged(boolean shuffleModeEnabled) {
 682 
 683     }
 684 
 685     @Override
 686     public void onPlayerError(@NonNull ExoPlaybackException error) {
 687         notifyOnError(IMediaPlayer.MEDIA_ERROR_UNKNOWN, IMediaPlayer.MEDIA_ERROR_UNKNOWN);
 688     }
 689 
 690 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 691     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 692     public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition, int reason) {"> 692     public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition,üîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 693         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 694         if (reason == DISCONTINUITY_REASON_SEEK) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 695             notifyOnSeekComplete();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 696         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 697     }</span>
 698 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 699     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 700     public void onSeekProcessed() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 701         notifyOnSeekComplete();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 702     }</span>
 703 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704     @Override</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705     public void onPositionDiscontinuity(int reason) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 706         if(reason == DISCONTINUITY_REASON_SEEK) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707             notifyOnSeekComplete();</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708         }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709     }</span>
 710 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 711 
 712     @Override
 713     public void onPlaybackParametersChanged(@NonNull PlaybackParameters playbackParameters) {
 714 
 715     }
 716 
<abbr title=" 717     /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////"> 717     /////////////////////////////////////AudioRendererEventListener//////////////////////////////////////üîµ</abbr>
 718 
 719 
 720     @Override
 721     public void onPlayWhenReadyChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {
 722 
 723     }
 724 
 725 
<abbr title=" 726     /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////"> 726     /////////////////////////////////////AudioRendererEventListener//////////////////////////////////////üîµ</abbr>
 727 
 728 
 729     @Override
 730     public void onTimelineChanged(@NonNull EventTime eventTime, int reason) {
 731 
 732     }
 733 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
 734 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 735 @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 736     public void onPositionDiscontinuity(EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 737         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 738     }</span>
 739 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 740 @Override</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 741     public void onPositionDiscontinuity(@NonNull EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743     }</span>
 744 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 745 
 746 
 747 
 748     @Override
<abbr title=" 749     public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters playbackParameters) {"> 749     public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters plaüîµ</abbr>
 750 
 751     }
 752 
 753     @Override
 754     public void onRepeatModeChanged(@NonNull EventTime eventTime, int repeatMode) {
 755 
 756     }
 757 
 758     @Override
 759     public void onShuffleModeChanged(@NonNull EventTime eventTime, boolean shuffleModeEnabled) {
 760 
 761     }
 762 
 763     @Override
 764     public void onIsLoadingChanged(EventTime eventTime, boolean isLoading) {
 765 
 766     }
 767 
 768     @Override
 769     public void onPlayerError(@NonNull EventTime eventTime, @NonNull ExoPlaybackException error) {
 770 
 771     }
 772 
 773     @Override
<abbr title=" 774     public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelections) {"> 774     public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNüîµ</abbr>
 775 
 776     }
 777 
 778     @Override
<abbr title=" 779     public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 779     public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaüîµ</abbr>
 780 
 781     }
 782 
 783     @Override
 784     public void onMetadata(@NonNull EventTime eventTime, @NonNull Metadata metadata) {
 785 
 786     }
 787 
 788     @Override
 789 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 790     public void onAudioDisabled(EventTime eventTime, DecoderCounters counters) {</span>
 791 ||||||| BASE
 792 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 793     public void onAudioDisabled(@NonNull EventTime eventTime, @NonNull DecoderCounters counters)  {</span>
 794 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 795         audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 796     }
 797 
 798     @Override
<abbr title=" 799     public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs) {"> 799     public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elaüîµ</abbr>
 800 
 801     }
 802 
 803     @Override
 804     public void onDroppedVideoFrames(@NonNull EventTime eventTime, int droppedFrames, long elapsedMs) {
 805 
 806     }
 807 
 808     @Override
 809 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 810     public void onVideoSizeChanged(EventTime eventTime, VideoSize videoSize) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 811         mVideoWidth = (int) (videoSize.width * videoSize.pixelWidthHeightRatio);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 812         mVideoHeight = videoSize.height;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 813         notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.height, 1, 1);"> 813         notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.heiüîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 814         if (videoSize.unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 815             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, videoSize.unappliedRotationDegrees);"> 815             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, videoSize.unappliedRotationDegreüîµ</abbr></span>
 816 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 817     public void onVideoSizeChanged(EventTime eventTime, int width, int height, int unappliedRotationDegrees, float pixelWidthHeightRatio) {"> 817     public void onVideoSizeChanged(EventTime eventTime, int width, int height, int unappliedRotationDegreüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 818         mVideoWidth = (int) (width * pixelWidthHeightRatio);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 819         mVideoHeight = height;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 820         notifyOnVideoSizeChanged((int) (width * pixelWidthHeightRatio), height, 1, 1);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 821         if (unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 822             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, unappliedRotationDegrees);</span>
 823 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 824     public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotationDegrees, float pixelWidthHeightRatio) {"> 824     public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotaüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 825         mVideoWidth = (int) (width * pixelWidthHeightRatio);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 826         mVideoHeight = height;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 827         notifyOnVideoSizeChanged((int) (width * pixelWidthHeightRatio), height, 1, 1);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 828         if (unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 829             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, unappliedRotationDegrees);</span>
 830 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 831     }
 832 
 833 
 834     @Override
 835     public void onRenderedFirstFrame(EventTime eventTime, Object output, long renderTimeMs) {
 836 
 837     }
 838 
 839     @Override
 840     public void onDrmKeysLoaded(@NonNull EventTime eventTime) {
 841 
 842     }
 843 
 844     @Override
 845     public void onDrmSessionManagerError(@NonNull EventTime eventTime, @NonNull Exception error) {
 846 
 847     }
 848 
 849     @Override
 850     public void onDrmKeysRestored(@NonNull EventTime eventTime) {
 851 
 852     }
 853 
 854     @Override
 855     public void onDrmKeysRemoved(@NonNull EventTime eventTime) {
 856 
 857     }
 858 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                            <td><pre>   1 package tv.danmaku.ijk.media.exo2;
   2 
   3 import android.annotation.SuppressLint;
   4 import android.content.Context;
   5 import android.net.Uri;
   6 import android.os.Handler;
   7 import android.os.Looper;
   8 import android.view.Surface;
   9 import android.view.SurfaceHolder;
  10 import androidx.annotation.NonNull;
  11 import androidx.annotation.Nullable;
  12 import androidx.annotation.Size;
  13 import com.google.android.exoplayer2.C;
  14 import com.google.android.exoplayer2.DefaultLoadControl;
  15 import com.google.android.exoplayer2.DefaultRenderersFactory;
  16 import com.google.android.exoplayer2.ExoPlaybackException;
  17 import com.google.android.exoplayer2.LoadControl;
  18 import com.google.android.exoplayer2.PlaybackParameters;
  19 import com.google.android.exoplayer2.Player;
  20 import com.google.android.exoplayer2.SeekParameters;
  21 import com.google.android.exoplayer2.SimpleExoPlayer;
  22 import com.google.android.exoplayer2.analytics.AnalyticsListener;
  23 import com.google.android.exoplayer2.decoder.DecoderCounters;
  24 import com.google.android.exoplayer2.metadata.Metadata;
  25 import com.google.android.exoplayer2.source.MediaSource;
  26 import com.google.android.exoplayer2.source.TrackGroupArray;
  27 import com.google.android.exoplayer2.text.Cue;
  28 import com.google.android.exoplayer2.trackselection.DefaultTrackSelector;
  29 import com.google.android.exoplayer2.trackselection.MappingTrackSelector;
  30 import com.google.android.exoplayer2.trackselection.TrackSelectionArray;
  31 import com.google.android.exoplayer2.video.VideoSize;
  32 import java.io.File;
  33 import java.io.FileDescriptor;
  34 import java.util.HashMap;
  35 import java.util.List;
  36 import java.util.Map;
  37 import static com.google.android.exoplayer2.Player.DISCONTINUITY_REASON_SEEK;
  38 import static com.google.android.exoplayer2.Player.REPEAT_MODE_ALL;
  39 import tv.danmaku.ijk.media.exo2.demo.EventLogger;
  40 import tv.danmaku.ijk.media.player.AbstractMediaPlayer;
  41 import tv.danmaku.ijk.media.player.IMediaPlayer;
  42 import tv.danmaku.ijk.media.player.MediaInfo;
  43 import tv.danmaku.ijk.media.player.misc.IjkTrackInfo;
  44 
  45 
  46 /**
  47  * Created by guoshuyu on 2018/1/10.
  48  * Exo
  49  */
<abbr title="  50 public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.Listener, AnalyticsListener {">  50 public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.Listener, AnalyticsListenerüîµ</abbr>
  51 
  52     public static int ON_POSITION_DISCOUNTINUITY = 2702;
  53 
  54     private static final String TAG = &quot;IjkExo2MediaPlayer&quot;;
  55 
  56     protected Context mAppContext;
  57     protected SimpleExoPlayer mInternalPlayer;
  58     protected EventLogger mEventLogger;
  59     protected DefaultRenderersFactory mRendererFactory;
  60     protected MediaSource mMediaSource;
  61     protected MappingTrackSelector mTrackSelector;
  62     protected LoadControl mLoadControl;
  63     protected String mDataSource;
  64     protected Surface mSurface;
  65     protected Map&lt;String, String&gt; mHeaders = new HashMap&lt;&gt;();
  66     protected PlaybackParameters mSpeedPlaybackParameters;
  67     protected int mVideoWidth;
  68     protected int mVideoHeight;
  69     protected int lastReportedPlaybackState;
  70     protected boolean isLastReportedPlayWhenReady;
  71     protected boolean isPreparing = true;
  72     protected boolean isBuffering = false;
  73     protected boolean isLooping = false;
  74     /**
  75      * ÊòØÂê¶Â∏¶‰∏äheader
  76      */
  77     protected boolean isPreview = false;
  78     /**
  79      * ÊòØÂê¶ÂºÄÂêØÁºìÂ≠ò
  80      */
  81     protected boolean isCache = false;
  82     /**
  83      * dataSourceÁ≠âÁöÑÂ∏ÆÁªÑÁ±ª
  84      */
  85     protected ExoSourceManager mExoHelper;
  86     /**
  87      * ÁºìÂ≠òÁõÆÂΩïÔºåÂèØ‰ª•‰∏∫Á©∫
  88      */
  89     protected File mCacheDir;
  90     /**
  91      * Á±ªÂûãË¶ÜÁõñ
  92      */
  93     private String mOverrideExtension;
  94 
  95     protected int audioSessionId = C.AUDIO_SESSION_ID_UNSET;
  96 
  97 
  98     public IjkExo2MediaPlayer(Context context) {
  99         mAppContext = context.getApplicationContext();
 100         lastReportedPlaybackState = Player.STATE_IDLE;
 101         mExoHelper = ExoSourceManager.newInstance(context, mHeaders);
 102     }
 103 
 104 
 105     private int getVideoRendererIndex() {
 106         if (mInternalPlayer != null) {
 107             for (int i = 0; i &lt; mInternalPlayer.getRendererCount(); i++) {
 108                 if (mInternalPlayer.getRendererType(i) == C.TRACK_TYPE_VIDEO) {
 109                     return i;
 110                 }
 111             }
 112         }
 113         return 0;
 114     }
 115 
 116     @Override
 117     public void setDisplay(SurfaceHolder sh) {
 118         if (sh == null)
 119             setSurface(null);
 120         else
 121             setSurface(sh.getSurface());
 122     }
 123 
 124     @Override
 125     public void setSurface(Surface surface) {
 126         mSurface = surface;
 127         if (mInternalPlayer != null) {
 128             if (surface != null &amp;&amp; !surface.isValid()) {
 129                 mSurface = null;
 130             }
 131             mInternalPlayer.setVideoSurface(surface);
 132         }
 133     }
 134 
 135 
 136     @Override
 137     public void setDataSource(Context context, Uri uri, Map&lt;String, String&gt; headers) {
 138         if (headers != null) {
 139             mHeaders.clear();
 140             mHeaders.putAll(headers);
 141         }
 142         setDataSource(context, uri);
 143     }
 144 
 145     @Override
 146     public void setDataSource(String path) {
 147         setDataSource(mAppContext, Uri.parse(path));
 148     }
 149 
 150     @Override
 151     public void setDataSource(Context context, Uri uri) {
 152         mDataSource = uri.toString();
<abbr title=" 153         mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, mOverrideExtension);"> 153         mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, müîµ</abbr>
 154     }
 155 
 156     @Override
 157     public void setDataSource(FileDescriptor fd) {
 158         throw new UnsupportedOperationException(&quot;no support&quot;);
 159     }
 160 
 161     @Override
 162     public String getDataSource() {
 163         return mDataSource;
 164     }
 165 
 166     @Override
 167     public void prepareAsync() throws IllegalStateException {
 168         if (mInternalPlayer != null)
 169             throw new IllegalStateException(&quot;can&#x27;t prepare a prepared player&quot;);
 170         prepareAsyncInternal();
 171     }
 172 
 173     @Override
 174     public void start() throws IllegalStateException {
 175         if (mInternalPlayer == null)
 176             return;
 177         mInternalPlayer.setPlayWhenReady(true);
 178     }
 179 
 180     @Override
 181     public void stop() throws IllegalStateException {
 182         if (mInternalPlayer == null)
 183             return;
 184         mInternalPlayer.release();
 185     }
 186 
 187     @Override
 188     public void pause() throws IllegalStateException {
 189         if (mInternalPlayer == null)
 190             return;
 191         mInternalPlayer.setPlayWhenReady(false);
 192     }
 193 
 194     @Override
 195     public void setWakeMode(Context context, int mode) {
 196         // FIXME: implement
 197     }
 198 
 199     @Override
 200     public void setScreenOnWhilePlaying(boolean screenOn) {
 201         // TODO: do nothing
 202     }
 203 
 204     @Override
 205     public IjkTrackInfo[] getTrackInfo() {
 206         // TODO: implement
 207         return null;
 208     }
 209 
 210     @Override
 211     public int getVideoWidth() {
 212         return mVideoWidth;
 213     }
 214 
 215     @Override
 216     public int getVideoHeight() {
 217         return mVideoHeight;
 218     }
 219 
 220     @Override
 221     public boolean isPlaying() {
 222         if (mInternalPlayer == null)
 223             return false;
 224         int state = mInternalPlayer.getPlaybackState();
 225         switch (state) {
 226             case Player.STATE_BUFFERING:
 227             case Player.STATE_READY:
 228                 return mInternalPlayer.getPlayWhenReady();
 229             case Player.STATE_IDLE:
 230             case Player.STATE_ENDED:
 231             default:
 232                 return false;
 233         }
 234     }
 235 
 236     @Override
 237     public void seekTo(long msec) throws IllegalStateException {
 238         if (mInternalPlayer == null)
 239             return;
 240         mInternalPlayer.seekTo(msec);
 241     }
 242 
 243     @Override
 244     public long getCurrentPosition() {
 245         if (mInternalPlayer == null)
 246             return 0;
 247         return mInternalPlayer.getCurrentPosition();
 248     }
 249 
 250     @Override
 251     public long getDuration() {
 252         if (mInternalPlayer == null)
 253             return 0;
 254         return mInternalPlayer.getDuration();
 255     }
 256 
 257     @Override
 258     public int getVideoSarNum() {
 259         return 1;
 260     }
 261 
 262     @Override
 263     public int getVideoSarDen() {
 264         return 1;
 265     }
 266 
 267     @Override
 268     public void reset() {
 269         if (mInternalPlayer != null) {
 270             mInternalPlayer.release();
 271             mInternalPlayer = null;
 272         }
 273         if (mExoHelper != null) {
 274             mExoHelper.release();
 275         }
 276         mSurface = null;
 277         mDataSource = null;
 278         mVideoWidth = 0;
 279         mVideoHeight = 0;
 280     }
 281 
 282     @Override
 283     public void onCues(List&lt;Cue&gt; cues) {
 284 
 285     }
 286 
 287     @Override
 288     public void onMetadata(Metadata metadata) {
 289 
 290     }
 291 
 292     @Override
 293     public void setLooping(boolean looping) {
 294         isLooping = looping;
 295     }
 296 
 297     @Override
 298     public boolean isLooping() {
 299         return isLooping;
 300     }
 301 
 302     @Override
 303     public void setVolume(float leftVolume, float rightVolume) {
 304         if (mInternalPlayer != null)
 305             mInternalPlayer.setVolume((leftVolume + rightVolume) / 2);
 306     }
 307 
 308     @Override
 309     public int getAudioSessionId() {
 310         return audioSessionId;
 311     }
 312 
 313     @Override
 314     public MediaInfo getMediaInfo() {
 315         return null;
 316     }
 317 
 318     @Override
 319     public void setLogEnabled(boolean enable) {
 320         // do nothing
 321     }
 322 
 323     @Override
 324     public boolean isPlayable() {
 325         return true;
 326     }
 327 
 328     @Override
 329     public void setAudioStreamType(int streamtype) {
 330         // do nothing
 331     }
 332 
 333     @Override
 334     public void setKeepInBackground(boolean keepInBackground) {
 335         // do nothing
 336     }
 337 
 338     @Override
 339     public void release() {
 340         if (mInternalPlayer != null) {
 341             reset();
 342             mEventLogger = null;
 343         }
 344     }
 345 
 346     protected void prepareAsyncInternal() {
 347         new Handler(Looper.myLooper()).post(
 348                 new Runnable() {
 349                     @Override
 350                     public void run() {
 351                         if (mTrackSelector == null) {
 352                             mTrackSelector = new DefaultTrackSelector(mAppContext);
 353                         }
 354                         mEventLogger = new EventLogger(mTrackSelector);
 355                         boolean preferExtensionDecoders = true;
 356                         boolean useExtensionRenderers = true;//ÊòØÂê¶ÂºÄÂêØÊâ©Â±ï
<abbr title=" 357                         @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtensionRenderers"> 357                         @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtüîµ</abbr>
<abbr title=" 358                                 ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_MODE_PREFER"> 358                                 ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_Müîµ</abbr>
 359                                 : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_ON)
 360                                 : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_OFF;
 361                         if (mRendererFactory == null) {
 362                             mRendererFactory = new DefaultRenderersFactory(mAppContext);
 363                             mRendererFactory.setExtensionRendererMode(extensionRendererMode);
 364                         }
 365                         if (mLoadControl == null) {
 366                             mLoadControl = new DefaultLoadControl();
 367                         }
 368                         mInternalPlayer = new SimpleExoPlayer.Builder(mAppContext, mRendererFactory)
 369                                 .setLooper(Looper.myLooper())
 370                                 .setTrackSelector(mTrackSelector)
 371                                 .setLoadControl(mLoadControl).build();
 372                         mInternalPlayer.addListener(IjkExo2MediaPlayer.this);
 373                         mInternalPlayer.addAnalyticsListener(IjkExo2MediaPlayer.this);
 374                         mInternalPlayer.addListener(mEventLogger);
 375                         if (mSpeedPlaybackParameters != null) {
 376                             mInternalPlayer.setPlaybackParameters(mSpeedPlaybackParameters);
 377                         }
 378                         if (isLooping) {
 379                             mInternalPlayer.setRepeatMode(REPEAT_MODE_ALL);
 380                         }
 381                         if (mSurface != null)
 382                             mInternalPlayer.setVideoSurface(mSurface);
 383                         mInternalPlayer.setMediaSource(mMediaSource);
 384                         mInternalPlayer.prepare();
 385                         mInternalPlayer.setPlayWhenReady(false);
 386                     }
 387                 }
 388         );
 389     }
 390 
 391     public String getOverrideExtension() {
 392         return mOverrideExtension;
 393     }
 394 
 395     public void setOverrideExtension(String overrideExtension) {
 396         this.mOverrideExtension = overrideExtension;
 397     }
 398 
 399     public void stopPlayback() {
 400         mInternalPlayer.stop();
 401     }
 402 
 403     /**
 404      * ÊòØÂê¶ÈúÄË¶ÅÂ∏¶‰∏äheader
 405      * setDataSource‰πãÂâçÁîüÊïà
 406      */
 407     public void setPreview(boolean preview) {
 408         isPreview = preview;
 409     }
 410 
 411     public boolean isPreview() {
 412         return isPreview;
 413     }
 414 
 415     public boolean isCache() {
 416         return isCache;
 417     }
 418 
 419 
 420     /**
 421      * ËÆæÁΩÆseek ÁöÑ‰∏¥ËøëÂ∏ß„ÄÇ
 422      **/
 423     public void setSeekParameter(@Nullable SeekParameters seekParameters) {
 424         mInternalPlayer.setSeekParameters(seekParameters);
 425     }
 426 
 427 
 428     /**
 429      * ÊòØÂê¶ÂºÄÂêØcache
 430      * setDataSource‰πãÂâçÁîüÊïà
 431      */
 432     public void setCache(boolean cache) {
 433         isCache = cache;
 434     }
 435 
 436     public File getCacheDir() {
 437         return mCacheDir;
 438     }
 439 
 440     /**
 441      * cacheÊñá‰ª∂ÁöÑÁõÆÂΩï
 442      * setDataSource‰πãÂâçÁîüÊïà
 443      */
 444     public void setCacheDir(File cacheDir) {
 445         this.mCacheDir = cacheDir;
 446     }
 447 
 448     public MediaSource getMediaSource() {
 449         return mMediaSource;
 450     }
 451 
 452     public void setMediaSource(MediaSource mediaSource) {
 453         this.mMediaSource = mediaSource;
 454     }
 455 
 456     public ExoSourceManager getExoHelper() {
 457         return mExoHelper;
 458     }
 459 
 460     /**
 461      * ÂÄçÈÄüÊí≠Êîæ
 462      *
 463      * @param speed ÂÄçÈÄüÊí≠ÊîæÔºåÈªòËÆ§‰∏∫1
 464      * @param pitch Èü≥ÈáèÁº©ÊîæÔºåÈªòËÆ§‰∏∫1Ôºå‰øÆÊîπ‰ºöÂØºËá¥Â£∞Èü≥ÂèòË∞É
 465      */
 466     public void setSpeed(@Size(min = 0) float speed, @Size(min = 0) float pitch) {
 467         PlaybackParameters playbackParameters = new PlaybackParameters(speed, pitch);
 468         mSpeedPlaybackParameters = playbackParameters;
 469         if (mInternalPlayer != null) {
 470             mInternalPlayer.setPlaybackParameters(playbackParameters);
 471         }
 472     }
 473 
 474     public float getSpeed() {
 475         return mInternalPlayer.getPlaybackParameters().speed;
 476     }
 477 
 478     public int getBufferedPercentage() {
 479         if (mInternalPlayer == null)
 480             return 0;
 481 
 482         return mInternalPlayer.getBufferedPercentage();
 483     }
 484 
 485 
 486 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 487 </span>
 488 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 489 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 489 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 490 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 491 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 492 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 493 </span>
 494 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 495     public MappingTrackSelector getTrackSelector() {
 496         return mTrackSelector;
 497     }
 498 
 499     public void setTrackSelector(MappingTrackSelector trackSelector) {
 500         this.mTrackSelector = trackSelector;
 501     }
 502 
 503     public LoadControl getLoadControl() {
 504         return mLoadControl;
 505     }
 506 
 507     public void setLoadControl(LoadControl loadControl) {
 508         this.mLoadControl = loadControl;
 509     }
 510 
 511     public DefaultRenderersFactory getRendererFactory() {
 512         return mRendererFactory;
 513     }
 514 
 515     public void setRendererFactory(DefaultRenderersFactory rendererFactory) {
 516         this.mRendererFactory = rendererFactory;
 517     }
 518 
 519     @Override
<abbr title=" 520     public void onTracksChanged(@NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelections) {"> 520     public void onTracksChanged(@NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSüîµ</abbr>
 521 
 522     }
 523 
 524     @SuppressLint(&quot;SwitchIntDef&quot;)
 525     @Override
 526 
 527 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 528     public void onIsLoadingChanged(boolean isLoading) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 529 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 530     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 531 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 532     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 533     public void onPlaybackStateChanged(int state) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 534         onPlayWhenReadyChanged(isLastReportedPlayWhenReady, state);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 535     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 536 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 537     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 538 </span>
 539 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 540 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 540 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 541 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543 </span>
 544 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 545     public void onPlayWhenReadyChanged(boolean playWhenReady, int playbackState) {
 546         //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY
 547         //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY
<abbr title=" 548         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 548         //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + plüîµ</abbr>
 549         if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {
 550             int buffer = 0;
 551             if (mInternalPlayer != null) {
 552                 buffer = mInternalPlayer.getBufferedPercentage();
 553             }
 554             if (isBuffering) {
 555                 switch (playbackState) {
 556                     case Player.STATE_ENDED:
 557                     case Player.STATE_READY:
 558                         notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_END, buffer);
 559                         isBuffering = false;
 560                         break;
 561                 }
 562             }
 563 
 564             if (isPreparing) {
 565                 switch (playbackState) {
 566                     case Player.STATE_READY:
 567                         notifyOnPrepared();
 568                         isPreparing = false;
 569                         break;
 570                 }
 571             }
 572 
 573             switch (playbackState) {
 574                 case Player.STATE_BUFFERING:
 575                     notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_START, buffer);
 576                     isBuffering = true;
 577                     break;
 578                 case Player.STATE_ENDED:
 579                     notifyOnCompletion();
 580                     break;
 581                 default:
 582                     break;
 583             }
 584         }
 585         isLastReportedPlayWhenReady = playWhenReady;
 586         lastReportedPlaybackState = playbackState;
 587     }
 588 
 589     @Override
 590     public void onRepeatModeChanged(int repeatMode) {
 591 
 592     }
 593 
 594     @Override
 595     public void onShuffleModeEnabledChanged(boolean shuffleModeEnabled) {
 596 
 597     }
 598 
 599     @Override
 600     public void onPlayerError(@NonNull ExoPlaybackException error) {
 601         notifyOnError(IMediaPlayer.MEDIA_ERROR_UNKNOWN, IMediaPlayer.MEDIA_ERROR_UNKNOWN);
 602     }
 603 
 604     @Override
 605 
 606 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 607     public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition, int reason) {"> 607     public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition,üîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 608         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 609         if (reason == DISCONTINUITY_REASON_SEEK) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 610 </span>
 611 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 612 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 612 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 613 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 614 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615     public void onPositionDiscontinuity(int reason) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616         if(reason == DISCONTINUITY_REASON_SEEK) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617 </span>
 618 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 619             notifyOnSeekComplete();
 620         }
 621     }
 622 
 623     @Override
 624     public void onPlaybackParametersChanged(@NonNull PlaybackParameters playbackParameters) {
 625 
 626     }
 627 
 628 
 629 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 630 </span>
 631 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 632 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 632 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 633 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636 </span>
 637 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
<abbr title=" 638     /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////"> 638     /////////////////////////////////////AudioRendererEventListener//////////////////////////////////////üîµ</abbr>
 639 
 640 
 641     @Override
 642 
 643 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 644     public void onPlayWhenReadyChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 645 </span>
 646 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 647 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 647 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 648 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650     public void onTimelineChanged(@NonNull EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651 </span>
 652 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 653 
 654     }
 655 
 656     @Override
 657 
 658 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 659     public void onTimelineChanged(EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 660 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 661     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 662 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 663 </span>
 664 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 665 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 665 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 666 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668     public void onPositionDiscontinuity(@NonNull EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669         notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672     @Override</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673     public void onSeekStarted(@NonNull EventTime eventTime) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 674 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677     @Override</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 678     public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters playbackParameters) {"> 678     public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters plaüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681 </span>
 682 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 683 
 684     @Override
 685     public void onRepeatModeChanged(@NonNull EventTime eventTime, int repeatMode) {
 686 
 687     }
 688 
 689     @Override
 690     public void onShuffleModeChanged(@NonNull EventTime eventTime, boolean shuffleModeEnabled) {
 691 
 692     }
 693 
 694     @Override
 695     public void onPlayerError(@NonNull EventTime eventTime, @NonNull ExoPlaybackException error) {
 696 
 697     }
 698 
 699     @Override
 700 
 701 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 702     public void onIsLoadingChanged(EventTime eventTime, boolean isLoading) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 703 </span>
 704 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 705 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 705 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 706 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 708     public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelections) {"> 708     public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709 </span>
 710 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 711 
 712     }
 713 
 714     @Override
<abbr title=" 715     public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 715     public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaüîµ</abbr>
 716 
 717     }
 718 
 719     @Override
 720     public void onMetadata(@NonNull EventTime eventTime, @NonNull Metadata metadata) {
 721 
 722     }
 723 
 724     @Override
 725 
 726 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 727     public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 727     public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, longüîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 728 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 729     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 730 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 731     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 732     public void onMetadata(EventTime eventTime, Metadata metadata) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 733 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 734     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 735 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 736     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 737     public void onAudioDisabled(EventTime eventTime, DecoderCounters counters) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 738 </span>
 739 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 740 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 740 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 741 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743     public void onAudioDisabled(@NonNull EventTime eventTime, @NonNull DecoderCounters counters)  {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 744 </span>
 745 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 746         audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 747     }
 748 
 749     @Override
<abbr title=" 750     public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs) {"> 750     public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elaüîµ</abbr>
 751 
 752     }
 753 
 754     @Override
 755     public void onDroppedVideoFrames(@NonNull EventTime eventTime, int droppedFrames, long elapsedMs) {
 756 
 757     }
 758 
 759     @Override
 760 
 761 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 762     public void onVideoSizeChanged(EventTime eventTime, VideoSize videoSize) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 763         mVideoWidth = (int) (videoSize.width * videoSize.pixelWidthHeightRatio);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 764         mVideoHeight = videoSize.height;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 765         notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.height, 1, 1);"> 765         notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.heiüîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 766         if (videoSize.unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 767             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, videoSize.unappliedRotationDegrees);"> 767             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, videoSize.unappliedRotationDegreüîµ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 768 </span>
 769 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 770 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 770 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 771 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 772 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 773     public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotationDegrees, float pixelWidthHeightRatio) {"> 773     public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotaüîµ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 774         mVideoWidth = (int) (width * pixelWidthHeightRatio);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 775         mVideoHeight = height;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 776         notifyOnVideoSizeChanged((int) (width * pixelWidthHeightRatio), height, 1, 1);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 777         if (unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 778             notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, unappliedRotationDegrees);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 779 </span>
 780 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 781     }
 782 
 783 
 784     @Override
 785 
 786 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 787     public void onRenderedFirstFrame(EventTime eventTime, Object output, long renderTimeMs) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 788 </span>
 789 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 790 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 790 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwüîµ</abbr></span>
 791 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 792 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 793     public void onRenderedFirstFrame(@NonNull EventTime eventTime, Surface surface) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 794 </span>
 795 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 796 
 797     }
 798 
 799     @Override
 800     public void onDrmKeysLoaded(@NonNull EventTime eventTime) {
 801 
 802     }
 803 
 804     @Override
 805     public void onDrmSessionManagerError(@NonNull EventTime eventTime, @NonNull Exception error) {
 806 
 807     }
 808 
 809     @Override
 810     public void onDrmKeysRestored(@NonNull EventTime eventTime) {
 811 
 812     }
 813 
 814     @Override
 815     public void onDrmKeysRemoved(@NonNull EventTime eventTime) {
 816 
 817     }
 818 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre>   1  
   2  package tv.danmaku.ijk.media.exo2;
   3  

   4  import android.content.Context;
   5  import android.net.Uri;
   6  import android.os.Handler;
   7  import android.os.Looper;
   8  

   9  import androidx.annotation.Nullable;
  10  import androidx.annotation.Size;
  11  
  12  import android.view.Surface;
  13  import android.view.SurfaceHolder;
  14  
  15  import com.google.android.exoplayer2.C;
  16  import com.google.android.exoplayer2.DefaultLoadControl;
  17  import com.google.android.exoplayer2.DefaultRenderersFactory;
  18  import com.google.android.exoplayer2.ExoPlaybackException;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  19 -import com.google.android.exoplayer2.Format;</span>
  20  import com.google.android.exoplayer2.LoadControl;
  21  import com.google.android.exoplayer2.PlaybackParameters;
  22  import com.google.android.exoplayer2.Player;
  23  import com.google.android.exoplayer2.SeekParameters;
  24  import com.google.android.exoplayer2.SimpleExoPlayer;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  25 -import com.google.android.exoplayer2.Timeline;</span>
  26  import com.google.android.exoplayer2.analytics.AnalyticsListener;
  27  import com.google.android.exoplayer2.decoder.DecoderCounters;
  28  import com.google.android.exoplayer2.metadata.Metadata;
  29  import com.google.android.exoplayer2.source.MediaSource;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  30 -import com.google.android.exoplayer2.source.MediaSourceEventListener;</span>
  31  import com.google.android.exoplayer2.source.TrackGroupArray;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +import com.google.android.exoplayer2.text.Cue;</span>
  33  import com.google.android.exoplayer2.trackselection.DefaultTrackSelector;
  34  import com.google.android.exoplayer2.trackselection.MappingTrackSelector;
  35  import com.google.android.exoplayer2.trackselection.TrackSelectionArray;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +import com.google.android.exoplayer2.video.VideoSize;</span>
  37  
  38  import java.io.File;
  39  import java.io.FileDescriptor;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  40 -import java.io.IOException;</span>
  41  import java.util.HashMap;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +import java.util.List;</span>
  43  import java.util.Map;
  44  
  45  import tv.danmaku.ijk.media.exo2.demo.EventLogger;
  46  import tv.danmaku.ijk.media.player.AbstractMediaPlayer;
  47  import tv.danmaku.ijk.media.player.IMediaPlayer;
  48  import tv.danmaku.ijk.media.player.MediaInfo;
  49  import tv.danmaku.ijk.media.player.misc.IjkTrackInfo;


  50  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +import static com.google.android.exoplayer2.Player.DISCONTINUITY_REASON_SEEK;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +import static com.google.android.exoplayer2.Player.REPEAT_MODE_ALL;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +</span>
  54  
  55  /**
  56   * Created by guoshuyu on 2018/1/10.
  57   * Exo
  58   */
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  59 -public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.EventListener, AnalyticsListener {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  60 -</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.Listener, AnalyticsListener {</span>
  62  
  63      public static int ON_POSITION_DISCOUNTINUITY = 2702;
  64  
  65      private static final String TAG = &quot;IjkExo2MediaPlayer&quot;;
  66  
  67      protected Context mAppContext;
  68      protected SimpleExoPlayer mInternalPlayer;
  69      protected EventLogger mEventLogger;
  70      protected DefaultRenderersFactory mRendererFactory;
  71      protected MediaSource mMediaSource;
  72      protected MappingTrackSelector mTrackSelector;
  73      protected LoadControl mLoadControl;
  74      protected String mDataSource;
  75      protected Surface mSurface;
  76      protected Map&lt;String, String&gt; mHeaders = new HashMap&lt;&gt;();
  77      protected PlaybackParameters mSpeedPlaybackParameters;
  78      protected int mVideoWidth;
  79      protected int mVideoHeight;
  80      protected int lastReportedPlaybackState;
  81      protected boolean isLastReportedPlayWhenReady;
  82      protected boolean isPreparing = true;
  83      protected boolean isBuffering = false;
  84      protected boolean isLooping = false;
  85      /**
  86       * ÊòØÂê¶Â∏¶‰∏äheader
  87       */
  88      protected boolean isPreview = false;
  89      /**
  90       * ÊòØÂê¶ÂºÄÂêØÁºìÂ≠ò
  91       */
  92      protected boolean isCache = false;
  93      /**
  94       * dataSourceÁ≠âÁöÑÂ∏ÆÁªÑÁ±ª
  95       */
  96      protected ExoSourceManager mExoHelper;
  97      /**
  98       * ÁºìÂ≠òÁõÆÂΩïÔºåÂèØ‰ª•‰∏∫Á©∫
  99       */
 100      protected File mCacheDir;
 101      /**
 102       * Á±ªÂûãË¶ÜÁõñ
 103       */
 104      private String mOverrideExtension;
 105  
 106      protected int audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 107  
 108  
 109      public IjkExo2MediaPlayer(Context context) {
 110          mAppContext = context.getApplicationContext();
 111          lastReportedPlaybackState = Player.STATE_IDLE;
 112          mExoHelper = ExoSourceManager.newInstance(context, mHeaders);
 113      }
 114  
 115  
 116      private int getVideoRendererIndex() {
 117          if (mInternalPlayer != null) {
 118              for (int i = 0; i &lt; mInternalPlayer.getRendererCount(); i++) {
 119                  if (mInternalPlayer.getRendererType(i) == C.TRACK_TYPE_VIDEO) {
 120                      return i;
 121                  }
 122              }
 123          }
 124          return 0;
 125      }
 126  
 127      @Override
 128      public void setDisplay(SurfaceHolder sh) {
 129          if (sh == null)
 130              setSurface(null);
 131          else
 132              setSurface(sh.getSurface());
 133      }
 134  
 135      @Override
 136      public void setSurface(Surface surface) {
 137          mSurface = surface;
 138          if (mInternalPlayer != null) {
 139              if (surface != null &amp;&amp; !surface.isValid()) {
 140                  mSurface = null;
 141              }
 142              mInternalPlayer.setVideoSurface(surface);
 143          }
 144      }
 145  
 146  
 147      @Override
 148      public void setDataSource(Context context, Uri uri, Map&lt;String, String&gt; headers) {
 149          if (headers != null) {
 150              mHeaders.clear();
 151              mHeaders.putAll(headers);
 152          }
 153          setDataSource(context, uri);
 154      }
 155  
 156      @Override
 157      public void setDataSource(String path) {
 158          setDataSource(mAppContext, Uri.parse(path));
 159      }
 160  
 161      @Override
 162      public void setDataSource(Context context, Uri uri) {
 163          mDataSource = uri.toString();
<abbr title=" 164          mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, mOverrideExtension);"> 164          mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, mOverrideEüîµ</abbr>
 165      }
 166  
 167      @Override
 168      public void setDataSource(FileDescriptor fd) {
 169          throw new UnsupportedOperationException(&quot;no support&quot;);
 170      }
 171  
 172      @Override
 173      public String getDataSource() {
 174          return mDataSource;
 175      }
 176  
 177      @Override
 178      public void prepareAsync() throws IllegalStateException {
 179          if (mInternalPlayer != null)
 180              throw new IllegalStateException(&quot;can&#x27;t prepare a prepared player&quot;);
 181          prepareAsyncInternal();
 182      }
 183  
 184      @Override
 185      public void start() throws IllegalStateException {
 186          if (mInternalPlayer == null)
 187              return;
 188          mInternalPlayer.setPlayWhenReady(true);
 189      }
 190  
 191      @Override
 192      public void stop() throws IllegalStateException {
 193          if (mInternalPlayer == null)
 194              return;
 195          mInternalPlayer.release();
 196      }
 197  
 198      @Override
 199      public void pause() throws IllegalStateException {
 200          if (mInternalPlayer == null)
 201              return;
 202          mInternalPlayer.setPlayWhenReady(false);
 203      }
 204  
 205      @Override
 206      public void setWakeMode(Context context, int mode) {
 207          // FIXME: implement
 208      }
 209  
 210      @Override
 211      public void setScreenOnWhilePlaying(boolean screenOn) {
 212          // TODO: do nothing
 213      }
 214  
 215      @Override
 216      public IjkTrackInfo[] getTrackInfo() {
 217          // TODO: implement
 218          return null;
 219      }
 220  
 221      @Override
 222      public int getVideoWidth() {
 223          return mVideoWidth;
 224      }
 225  
 226      @Override
 227      public int getVideoHeight() {
 228          return mVideoHeight;
 229      }
 230  
 231      @Override
 232      public boolean isPlaying() {
 233          if (mInternalPlayer == null)
 234              return false;
 235          int state = mInternalPlayer.getPlaybackState();
 236          switch (state) {
 237              case Player.STATE_BUFFERING:
 238              case Player.STATE_READY:
 239                  return mInternalPlayer.getPlayWhenReady();
 240              case Player.STATE_IDLE:
 241              case Player.STATE_ENDED:
 242              default:
 243                  return false;
 244          }
 245      }
 246  
 247      @Override
 248      public void seekTo(long msec) throws IllegalStateException {
 249          if (mInternalPlayer == null)
 250              return;
 251          mInternalPlayer.seekTo(msec);
 252      }
 253  
 254      @Override
 255      public long getCurrentPosition() {
 256          if (mInternalPlayer == null)
 257              return 0;
 258          return mInternalPlayer.getCurrentPosition();
 259      }
 260  
 261      @Override
 262      public long getDuration() {
 263          if (mInternalPlayer == null)
 264              return 0;
 265          return mInternalPlayer.getDuration();
 266      }
 267  
 268      @Override
 269      public int getVideoSarNum() {
 270          return 1;
 271      }
 272  
 273      @Override
 274      public int getVideoSarDen() {
 275          return 1;
 276      }
 277  
 278      @Override
 279      public void reset() {
 280          if (mInternalPlayer != null) {
 281              mInternalPlayer.release();
 282              mInternalPlayer = null;
 283          }
 284          if (mExoHelper != null) {
 285              mExoHelper.release();
 286          }
 287          mSurface = null;
 288          mDataSource = null;
 289          mVideoWidth = 0;
 290          mVideoHeight = 0;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 291 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 292 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 293 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 294 +    public void onCues(List&lt;Cue&gt; cues) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 295 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 296 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 297 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 298 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 299 +    public void onMetadata(Metadata metadata) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 300 +</span>
 301      }
 302  
 303      @Override
 304      public void setLooping(boolean looping) {
 305          isLooping = looping;
 306      }
 307  
 308      @Override
 309      public boolean isLooping() {
 310          return isLooping;
 311      }
 312  
 313      @Override
 314      public void setVolume(float leftVolume, float rightVolume) {
 315          if (mInternalPlayer != null)
 316              mInternalPlayer.setVolume((leftVolume + rightVolume) / 2);
 317      }
 318  
 319      @Override
 320      public int getAudioSessionId() {
 321          return audioSessionId;
 322      }
 323  
 324      @Override
 325      public MediaInfo getMediaInfo() {
 326          return null;
 327      }
 328  
 329      @Override
 330      public void setLogEnabled(boolean enable) {
 331          // do nothing
 332      }
 333  
 334      @Override
 335      public boolean isPlayable() {
 336          return true;
 337      }
 338  
 339      @Override
 340      public void setAudioStreamType(int streamtype) {
 341          // do nothing
 342      }
 343  
 344      @Override
 345      public void setKeepInBackground(boolean keepInBackground) {
 346          // do nothing
 347      }
 348  
 349      @Override
 350      public void release() {
 351          if (mInternalPlayer != null) {
 352              reset();
 353              mEventLogger = null;
 354          }
 355      }
 356  
 357      protected void prepareAsyncInternal() {
 358          new Handler(Looper.myLooper()).post(
 359                  new Runnable() {
 360                      @Override
 361                      public void run() {
 362                          if (mTrackSelector == null) {
 363                              mTrackSelector = new DefaultTrackSelector(mAppContext);
 364                          }
 365                          mEventLogger = new EventLogger(mTrackSelector);
 366                          boolean preferExtensionDecoders = true;
 367                          boolean useExtensionRenderers = true;//ÊòØÂê¶ÂºÄÂêØÊâ©Â±ï
<abbr title=" 368                          @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtensionRenderers"> 368                          @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtensionRenüîµ</abbr>
<abbr title=" 369                                  ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_MODE_PREFER"> 369                                  ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_MODE_PREFEüîµ</abbr>
 370                                  : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_ON)
 371                                  : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_OFF;
 372                          if (mRendererFactory == null) {
 373                              mRendererFactory = new DefaultRenderersFactory(mAppContext);
 374                              mRendererFactory.setExtensionRendererMode(extensionRendererMode);
 375                          }
 376                          if (mLoadControl == null) {
 377                              mLoadControl = new DefaultLoadControl();
 378                          }
 379                          mInternalPlayer = new SimpleExoPlayer.Builder(mAppContext, mRendererFactory)
 380                                  .setLooper(Looper.myLooper())
 381                                  .setTrackSelector(mTrackSelector)
 382                                  .setLoadControl(mLoadControl).build();
 383                          mInternalPlayer.addListener(IjkExo2MediaPlayer.this);
 384                          mInternalPlayer.addAnalyticsListener(IjkExo2MediaPlayer.this);
 385                          mInternalPlayer.addListener(mEventLogger);
 386                          if (mSpeedPlaybackParameters != null) {
 387                              mInternalPlayer.setPlaybackParameters(mSpeedPlaybackParameters);
 388                          }
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 389 +                        if (isLooping) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 390 +                            mInternalPlayer.setRepeatMode(REPEAT_MODE_ALL);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 391 +                        }</span>
 392                          if (mSurface != null)
 393                              mInternalPlayer.setVideoSurface(mSurface);
 394                          mInternalPlayer.setMediaSource(mMediaSource);
 395                          mInternalPlayer.prepare();
 396                          mInternalPlayer.setPlayWhenReady(false);
 397                      }
 398                  }
 399          );
 400      }
 401  
 402      public String getOverrideExtension() {
 403          return mOverrideExtension;
 404      }
 405  
 406      public void setOverrideExtension(String overrideExtension) {
 407          this.mOverrideExtension = overrideExtension;
 408      }
 409  
 410      public void stopPlayback() {
 411          mInternalPlayer.stop();
 412      }
 413  
 414      /**
 415       * ÊòØÂê¶ÈúÄË¶ÅÂ∏¶‰∏äheader
 416       * setDataSource‰πãÂâçÁîüÊïà
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 417 -     *</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 418 -     * @param preview</span>
 419       */
 420      public void setPreview(boolean preview) {
 421          isPreview = preview;
 422      }
 423  
 424      public boolean isPreview() {
 425          return isPreview;
 426      }
 427  
 428      public boolean isCache() {
 429          return isCache;
 430      }
 431  
 432  
 433      /**
 434       * ËÆæÁΩÆseek ÁöÑ‰∏¥ËøëÂ∏ß„ÄÇ
 435       **/
 436      public void setSeekParameter(@Nullable SeekParameters seekParameters) {
 437          mInternalPlayer.setSeekParameters(seekParameters);
 438      }
 439  
 440  
 441      /**
 442       * ÊòØÂê¶ÂºÄÂêØcache
 443       * setDataSource‰πãÂâçÁîüÊïà
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 444 -     *</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 445 -     * @param cache</span>
 446       */
 447      public void setCache(boolean cache) {
 448          isCache = cache;
 449      }
 450  
 451      public File getCacheDir() {
 452          return mCacheDir;
 453      }
 454  
 455      /**
 456       * cacheÊñá‰ª∂ÁöÑÁõÆÂΩï
 457       * setDataSource‰πãÂâçÁîüÊïà
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 458 -     *</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 459 -     * @param cacheDir</span>
 460       */
 461      public void setCacheDir(File cacheDir) {
 462          this.mCacheDir = cacheDir;
 463      }
 464  
 465      public MediaSource getMediaSource() {
 466          return mMediaSource;
 467      }
 468  
 469      public void setMediaSource(MediaSource mediaSource) {
 470          this.mMediaSource = mediaSource;
 471      }
 472  
 473      public ExoSourceManager getExoHelper() {
 474          return mExoHelper;
 475      }
 476  
 477      /**
 478       * ÂÄçÈÄüÊí≠Êîæ
 479       *
 480       * @param speed ÂÄçÈÄüÊí≠ÊîæÔºåÈªòËÆ§‰∏∫1
 481       * @param pitch Èü≥ÈáèÁº©ÊîæÔºåÈªòËÆ§‰∏∫1Ôºå‰øÆÊîπ‰ºöÂØºËá¥Â£∞Èü≥ÂèòË∞É
 482       */
 483      public void setSpeed(@Size(min = 0) float speed, @Size(min = 0) float pitch) {
 484          PlaybackParameters playbackParameters = new PlaybackParameters(speed, pitch);
 485          mSpeedPlaybackParameters = playbackParameters;
 486          if (mInternalPlayer != null) {
 487              mInternalPlayer.setPlaybackParameters(playbackParameters);
 488          }
 489      }
 490  
 491      public float getSpeed() {
 492          return mInternalPlayer.getPlaybackParameters().speed;
 493      }
 494  
 495      public int getBufferedPercentage() {
 496          if (mInternalPlayer == null)
 497              return 0;
 498  
 499          return mInternalPlayer.getBufferedPercentage();
 500      }
 501  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 502 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 503 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 504 -    public void onTimelineChanged(Timeline timeline, Object manifest, int reason) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 505 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 506 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 507 -</span>
 508      public MappingTrackSelector getTrackSelector() {
 509          return mTrackSelector;
 510      }
 511  
 512      public void setTrackSelector(MappingTrackSelector trackSelector) {
 513          this.mTrackSelector = trackSelector;
 514      }
 515  
 516      public LoadControl getLoadControl() {
 517          return mLoadControl;
 518      }
 519  
 520      public void setLoadControl(LoadControl loadControl) {
 521          this.mLoadControl = loadControl;
 522      }
 523  
 524      public DefaultRenderersFactory getRendererFactory() {
 525          return mRendererFactory;
 526      }
 527  
 528      public void setRendererFactory(DefaultRenderersFactory rendererFactory) {
 529          this.mRendererFactory = rendererFactory;
 530      }
 531  
 532      @Override
 533      public void onTracksChanged(TrackGroupArray trackGroups, TrackSelectionArray trackSelections) {
 534  
 535      }
 536  
 537      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 538 -    public void onLoadingChanged(boolean isLoading) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 539 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 540 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 541 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 542 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 543 -    public void onPlayerStateChanged(boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 544 +    public void onIsLoadingChanged(boolean isLoading) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 545 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 546 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 547 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 548 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 549 +    public void onPlaybackStateChanged(int state) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 550 +        onPlayWhenReadyChanged(isLastReportedPlayWhenReady, state);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 551 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 552 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 553 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 554 +    public void onPlayWhenReadyChanged(boolean playWhenReady, int playbackState) {</span>
 555          //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY
 556          //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY
<abbr title=" 557          //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 557          //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackStaüîµ</abbr>
 558          if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {
 559              int buffer = 0;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 560 -            if(mInternalPlayer != null) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 561 -                buffer =  mInternalPlayer.getBufferedPercentage();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 562 +            if (mInternalPlayer != null) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 563 +                buffer = mInternalPlayer.getBufferedPercentage();</span>
 564              }
 565              if (isBuffering) {
 566                  switch (playbackState) {
 567                      case Player.STATE_ENDED:
 568                      case Player.STATE_READY:
 569                          notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_END, buffer);
 570                          isBuffering = false;
 571                          break;
 572                  }
 573              }
 574  
 575              if (isPreparing) {
 576                  switch (playbackState) {
 577                      case Player.STATE_READY:
 578                          notifyOnPrepared();
 579                          isPreparing = false;
 580                          break;
 581                  }
 582              }
 583  
 584              switch (playbackState) {
 585                  case Player.STATE_BUFFERING:
 586                      notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_START, buffer);
 587                      isBuffering = true;
 588                      break;
 589                  case Player.STATE_READY:
 590                      break;
 591                  case Player.STATE_ENDED:
 592                      notifyOnCompletion();
 593                      break;
 594                  default:
 595                      break;
 596              }
 597          }
 598          isLastReportedPlayWhenReady = playWhenReady;
 599          lastReportedPlaybackState = playbackState;
 600      }
 601  
 602      @Override
 603      public void onRepeatModeChanged(int repeatMode) {
 604  
 605      }
 606  
 607      @Override
 608      public void onShuffleModeEnabledChanged(boolean shuffleModeEnabled) {
 609  
 610      }
 611  
 612      @Override
 613      public void onPlayerError(ExoPlaybackException error) {

 614          notifyOnError(IMediaPlayer.MEDIA_ERROR_UNKNOWN, IMediaPlayer.MEDIA_ERROR_UNKNOWN);
 615      }
 616  
 617      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 618 -    public void onPositionDiscontinuity(int reason) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 619 -</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 620 +    public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition, int reason) {"> 620 +    public void onPositionDiscontinuity(Player.PositionInfo oldPosition, Player.PositionInfo newPosition, int reasüîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 621 +        notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 622 +        if (reason == DISCONTINUITY_REASON_SEEK) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 623 +            notifyOnSeekComplete();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 624 +        }</span>
 625      }
 626  
 627      @Override
 628      public void onPlaybackParametersChanged(PlaybackParameters playbackParameters) {
 629  
 630      }
 631  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 632 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 633 -    public void onSeekProcessed() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 634 -        notifyOnSeekComplete();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 635 -    }</span>










<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 636 -</span>
 637      /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////
 638  
 639  
 640      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 641 -    public void onPlayerStateChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 642 +    public void onPlayWhenReadyChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>
 643  
 644      }
 645  
 646      @Override
 647      public void onTimelineChanged(EventTime eventTime, int reason) {
 648  
 649      }
 650  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 651 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 652 -    public void onPositionDiscontinuity(EventTime eventTime, int reason) {</span>






<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 653 -        notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 654 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 655 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 656 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 657 -    public void onSeekStarted(EventTime eventTime) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 658 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 659 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 660 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 661 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 662 -    public void onSeekProcessed(EventTime eventTime) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 663 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 664 -    }</span>
 665  
 666      @Override
 667      public void onPlaybackParametersChanged(EventTime eventTime, PlaybackParameters playbackParameters) {
 668  
 669      }
 670  
 671      @Override
 672      public void onRepeatModeChanged(EventTime eventTime, int repeatMode) {
 673  
 674      }
 675  
 676      @Override
 677      public void onShuffleModeChanged(EventTime eventTime, boolean shuffleModeEnabled) {
 678  
 679      }
 680  
 681      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 682 -    public void onLoadingChanged(EventTime eventTime, boolean isLoading) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 683 +    public void onIsLoadingChanged(EventTime eventTime, boolean isLoading) {</span>
 684  
 685      }
 686  
 687      @Override
 688      public void onPlayerError(EventTime eventTime, ExoPlaybackException error) {
 689  
 690      }
 691  
 692      @Override
<abbr title=" 693      public void onTracksChanged(EventTime eventTime, TrackGroupArray trackGroups, TrackSelectionArray trackSelections) {"> 693      public void onTracksChanged(EventTime eventTime, TrackGroupArray trackGroups, TrackSelectionArray trackSelectiüîµ</abbr>
 694  
 695      }
 696  
 697      @Override
<abbr title=" 698      public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 698      public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEüîµ</abbr>
 699  
 700      }
 701  
 702      @Override
 703      public void onMetadata(EventTime eventTime, Metadata metadata) {
 704  
 705      }
 706  
 707      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 708 -    public void onDecoderEnabled(EventTime eventTime, int trackType, DecoderCounters decoderCounters) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 709 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 710 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 711 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 712 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 713 -    public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initializationDurationMs) {"> 713 -    public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initializationDuüîµ</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 714 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 715 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 716 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 717 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 718 -    public void onDecoderInputFormatChanged(EventTime eventTime, int trackType, Format format) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 719 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 720 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 721 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 722 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 723 -    public void onDecoderDisabled(EventTime eventTime, int trackType, DecoderCounters decoderCounters) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 724 +    public void onAudioDisabled(EventTime eventTime, DecoderCounters counters) {</span>








































 725          audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 726      }
 727  
 728      @Override
<abbr title=" 729      public void onAudioUnderrun(EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs) {"> 729      public void onAudioUnderrun(EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMüîµ</abbr>
 730  
 731      }
 732  
 733      @Override
 734      public void onDroppedVideoFrames(EventTime eventTime, int droppedFrames, long elapsedMs) {
 735  
 736      }
 737  
 738      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 739 -    public void onVideoSizeChanged(EventTime eventTime, int width, int height, int unappliedRotationDegrees, float pixelWidthHeightRatio) {"> 739 -    public void onVideoSizeChanged(EventTime eventTime, int width, int height, int unappliedRotationDegrees, floatüîµ</abbr></span>











<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 740 -        mVideoWidth = (int) (width * pixelWidthHeightRatio);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 741 -        mVideoHeight = height;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 742 -        notifyOnVideoSizeChanged((int) (width * pixelWidthHeightRatio), height, 1, 1);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 743 -        if (unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 744 -            notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, unappliedRotationDegrees);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 745 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 746 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 747 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 748 -    public void onRenderedFirstFrame(EventTime eventTime, Surface surface) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 749 +    public void onVideoSizeChanged(EventTime eventTime, VideoSize videoSize) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 750 +        mVideoWidth = (int) (videoSize.width * videoSize.pixelWidthHeightRatio);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 751 +        mVideoHeight = videoSize.height;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 752 +        notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.height, 1, 1);"> 752 +        notifyOnVideoSizeChanged((int) (videoSize.width * videoSize.pixelWidthHeightRatio), videoSize.height, 1, 1üîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 753 +        if (videoSize.unappliedRotationDegrees &gt; 0)</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 754 +            notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, videoSize.unappliedRotationDegrees);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 755 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 756 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 757 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 758 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 759 +    public void onRenderedFirstFrame(EventTime eventTime, Object output, long renderTimeMs) {</span>
 760  
 761      }
 762  
 763      @Override
 764      public void onDrmKeysLoaded(EventTime eventTime) {
 765  
 766      }
 767  
 768      @Override
 769      public void onDrmSessionManagerError(EventTime eventTime, Exception error) {
 770  
 771      }
 772  
 773      @Override
 774      public void onDrmKeysRestored(EventTime eventTime) {
 775  
 776      }
 777  
 778      @Override
 779      public void onDrmKeysRemoved(EventTime eventTime) {





















 780  
 781      }
 782  }</pre></td>
                            <td><pre>   1  
   2  package tv.danmaku.ijk.media.exo2;
   3  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   4 +import android.annotation.SuppressLint;</span>
   5  import android.content.Context;
   6  import android.net.Uri;
   7  import android.os.Handler;
   8  import android.os.Looper;
   9  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  10 +import androidx.annotation.NonNull;</span>
  11  import androidx.annotation.Nullable;
  12  import androidx.annotation.Size;
  13  
  14  import android.view.Surface;
  15  import android.view.SurfaceHolder;
  16  
  17  import com.google.android.exoplayer2.C;
  18  import com.google.android.exoplayer2.DefaultLoadControl;
  19  import com.google.android.exoplayer2.DefaultRenderersFactory;
  20  import com.google.android.exoplayer2.ExoPlaybackException;
  21  import com.google.android.exoplayer2.Format;
  22  import com.google.android.exoplayer2.LoadControl;
  23  import com.google.android.exoplayer2.PlaybackParameters;
  24  import com.google.android.exoplayer2.Player;
  25  import com.google.android.exoplayer2.SeekParameters;
  26  import com.google.android.exoplayer2.SimpleExoPlayer;
  27  import com.google.android.exoplayer2.Timeline;
  28  import com.google.android.exoplayer2.analytics.AnalyticsListener;
  29  import com.google.android.exoplayer2.decoder.DecoderCounters;
  30  import com.google.android.exoplayer2.metadata.Metadata;
  31  import com.google.android.exoplayer2.source.MediaSource;
  32  import com.google.android.exoplayer2.source.MediaSourceEventListener;
  33  import com.google.android.exoplayer2.source.TrackGroupArray;

  34  import com.google.android.exoplayer2.trackselection.DefaultTrackSelector;
  35  import com.google.android.exoplayer2.trackselection.MappingTrackSelector;
  36  import com.google.android.exoplayer2.trackselection.TrackSelectionArray;

  37  
  38  import java.io.File;
  39  import java.io.FileDescriptor;
  40  import java.io.IOException;
  41  import java.util.HashMap;

  42  import java.util.Map;
  43  
  44  import tv.danmaku.ijk.media.exo2.demo.EventLogger;
  45  import tv.danmaku.ijk.media.player.AbstractMediaPlayer;
  46  import tv.danmaku.ijk.media.player.IMediaPlayer;
  47  import tv.danmaku.ijk.media.player.MediaInfo;
  48  import tv.danmaku.ijk.media.player.misc.IjkTrackInfo;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +import static com.google.android.exoplayer2.Player.DISCONTINUITY_REASON_SEEK;</span>
  51  



  52  
  53  /**
  54   * Created by guoshuyu on 2018/1/10.
  55   * Exo
  56   */
  57  public class IjkExo2MediaPlayer extends AbstractMediaPlayer implements Player.EventListener, AnalyticsListener {
  58  

  59  
  60      public static int ON_POSITION_DISCOUNTINUITY = 2702;
  61  
  62      private static final String TAG = &quot;IjkExo2MediaPlayer&quot;;
  63  
  64      protected Context mAppContext;
  65      protected SimpleExoPlayer mInternalPlayer;
  66      protected EventLogger mEventLogger;
  67      protected DefaultRenderersFactory mRendererFactory;
  68      protected MediaSource mMediaSource;
  69      protected MappingTrackSelector mTrackSelector;
  70      protected LoadControl mLoadControl;
  71      protected String mDataSource;
  72      protected Surface mSurface;
  73      protected Map&lt;String, String&gt; mHeaders = new HashMap&lt;&gt;();
  74      protected PlaybackParameters mSpeedPlaybackParameters;
  75      protected int mVideoWidth;
  76      protected int mVideoHeight;
  77      protected int lastReportedPlaybackState;
  78      protected boolean isLastReportedPlayWhenReady;
  79      protected boolean isPreparing = true;
  80      protected boolean isBuffering = false;
  81      protected boolean isLooping = false;
  82      /**
  83       * ÊòØÂê¶Â∏¶‰∏äheader
  84       */
  85      protected boolean isPreview = false;
  86      /**
  87       * ÊòØÂê¶ÂºÄÂêØÁºìÂ≠ò
  88       */
  89      protected boolean isCache = false;
  90      /**
  91       * dataSourceÁ≠âÁöÑÂ∏ÆÁªÑÁ±ª
  92       */
  93      protected ExoSourceManager mExoHelper;
  94      /**
  95       * ÁºìÂ≠òÁõÆÂΩïÔºåÂèØ‰ª•‰∏∫Á©∫
  96       */
  97      protected File mCacheDir;
  98      /**
  99       * Á±ªÂûãË¶ÜÁõñ
 100       */
 101      private String mOverrideExtension;
 102  
 103      protected int audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 104  
 105  
 106      public IjkExo2MediaPlayer(Context context) {
 107          mAppContext = context.getApplicationContext();
 108          lastReportedPlaybackState = Player.STATE_IDLE;
 109          mExoHelper = ExoSourceManager.newInstance(context, mHeaders);
 110      }
 111  
 112  
 113      private int getVideoRendererIndex() {
 114          if (mInternalPlayer != null) {
 115              for (int i = 0; i &lt; mInternalPlayer.getRendererCount(); i++) {
 116                  if (mInternalPlayer.getRendererType(i) == C.TRACK_TYPE_VIDEO) {
 117                      return i;
 118                  }
 119              }
 120          }
 121          return 0;
 122      }
 123  
 124      @Override
 125      public void setDisplay(SurfaceHolder sh) {
 126          if (sh == null)
 127              setSurface(null);
 128          else
 129              setSurface(sh.getSurface());
 130      }
 131  
 132      @Override
 133      public void setSurface(Surface surface) {
 134          mSurface = surface;
 135          if (mInternalPlayer != null) {
 136              if (surface != null &amp;&amp; !surface.isValid()) {
 137                  mSurface = null;
 138              }
 139              mInternalPlayer.setVideoSurface(surface);
 140          }
 141      }
 142  
 143  
 144      @Override
 145      public void setDataSource(Context context, Uri uri, Map&lt;String, String&gt; headers) {
 146          if (headers != null) {
 147              mHeaders.clear();
 148              mHeaders.putAll(headers);
 149          }
 150          setDataSource(context, uri);
 151      }
 152  
 153      @Override
 154      public void setDataSource(String path) {
 155          setDataSource(mAppContext, Uri.parse(path));
 156      }
 157  
 158      @Override
 159      public void setDataSource(Context context, Uri uri) {
 160          mDataSource = uri.toString();
<abbr title=" 161          mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, mOverrideExtension);"> 161          mMediaSource = mExoHelper.getMediaSource(mDataSource, isPreview, isCache, isLooping, mCacheDir, mOverrideEüîµ</abbr>
 162      }
 163  
 164      @Override
 165      public void setDataSource(FileDescriptor fd) {
 166          throw new UnsupportedOperationException(&quot;no support&quot;);
 167      }
 168  
 169      @Override
 170      public String getDataSource() {
 171          return mDataSource;
 172      }
 173  
 174      @Override
 175      public void prepareAsync() throws IllegalStateException {
 176          if (mInternalPlayer != null)
 177              throw new IllegalStateException(&quot;can&#x27;t prepare a prepared player&quot;);
 178          prepareAsyncInternal();
 179      }
 180  
 181      @Override
 182      public void start() throws IllegalStateException {
 183          if (mInternalPlayer == null)
 184              return;
 185          mInternalPlayer.setPlayWhenReady(true);
 186      }
 187  
 188      @Override
 189      public void stop() throws IllegalStateException {
 190          if (mInternalPlayer == null)
 191              return;
 192          mInternalPlayer.release();
 193      }
 194  
 195      @Override
 196      public void pause() throws IllegalStateException {
 197          if (mInternalPlayer == null)
 198              return;
 199          mInternalPlayer.setPlayWhenReady(false);
 200      }
 201  
 202      @Override
 203      public void setWakeMode(Context context, int mode) {
 204          // FIXME: implement
 205      }
 206  
 207      @Override
 208      public void setScreenOnWhilePlaying(boolean screenOn) {
 209          // TODO: do nothing
 210      }
 211  
 212      @Override
 213      public IjkTrackInfo[] getTrackInfo() {
 214          // TODO: implement
 215          return null;
 216      }
 217  
 218      @Override
 219      public int getVideoWidth() {
 220          return mVideoWidth;
 221      }
 222  
 223      @Override
 224      public int getVideoHeight() {
 225          return mVideoHeight;
 226      }
 227  
 228      @Override
 229      public boolean isPlaying() {
 230          if (mInternalPlayer == null)
 231              return false;
 232          int state = mInternalPlayer.getPlaybackState();
 233          switch (state) {
 234              case Player.STATE_BUFFERING:
 235              case Player.STATE_READY:
 236                  return mInternalPlayer.getPlayWhenReady();
 237              case Player.STATE_IDLE:
 238              case Player.STATE_ENDED:
 239              default:
 240                  return false;
 241          }
 242      }
 243  
 244      @Override
 245      public void seekTo(long msec) throws IllegalStateException {
 246          if (mInternalPlayer == null)
 247              return;
 248          mInternalPlayer.seekTo(msec);
 249      }
 250  
 251      @Override
 252      public long getCurrentPosition() {
 253          if (mInternalPlayer == null)
 254              return 0;
 255          return mInternalPlayer.getCurrentPosition();
 256      }
 257  
 258      @Override
 259      public long getDuration() {
 260          if (mInternalPlayer == null)
 261              return 0;
 262          return mInternalPlayer.getDuration();
 263      }
 264  
 265      @Override
 266      public int getVideoSarNum() {
 267          return 1;
 268      }
 269  
 270      @Override
 271      public int getVideoSarDen() {
 272          return 1;
 273      }
 274  
 275      @Override
 276      public void reset() {
 277          if (mInternalPlayer != null) {
 278              mInternalPlayer.release();
 279              mInternalPlayer = null;
 280          }
 281          if (mExoHelper != null) {
 282              mExoHelper.release();
 283          }
 284          mSurface = null;
 285          mDataSource = null;
 286          mVideoWidth = 0;
 287          mVideoHeight = 0;










 288      }
 289  
 290      @Override
 291      public void setLooping(boolean looping) {
 292          isLooping = looping;
 293      }
 294  
 295      @Override
 296      public boolean isLooping() {
 297          return isLooping;
 298      }
 299  
 300      @Override
 301      public void setVolume(float leftVolume, float rightVolume) {
 302          if (mInternalPlayer != null)
 303              mInternalPlayer.setVolume((leftVolume + rightVolume) / 2);
 304      }
 305  
 306      @Override
 307      public int getAudioSessionId() {
 308          return audioSessionId;
 309      }
 310  
 311      @Override
 312      public MediaInfo getMediaInfo() {
 313          return null;
 314      }
 315  
 316      @Override
 317      public void setLogEnabled(boolean enable) {
 318          // do nothing
 319      }
 320  
 321      @Override
 322      public boolean isPlayable() {
 323          return true;
 324      }
 325  
 326      @Override
 327      public void setAudioStreamType(int streamtype) {
 328          // do nothing
 329      }
 330  
 331      @Override
 332      public void setKeepInBackground(boolean keepInBackground) {
 333          // do nothing
 334      }
 335  
 336      @Override
 337      public void release() {
 338          if (mInternalPlayer != null) {
 339              reset();
 340              mEventLogger = null;
 341          }
 342      }
 343  
 344      protected void prepareAsyncInternal() {
 345          new Handler(Looper.myLooper()).post(
 346                  new Runnable() {
 347                      @Override
 348                      public void run() {
 349                          if (mTrackSelector == null) {
 350                              mTrackSelector = new DefaultTrackSelector(mAppContext);
 351                          }
 352                          mEventLogger = new EventLogger(mTrackSelector);
 353                          boolean preferExtensionDecoders = true;
 354                          boolean useExtensionRenderers = true;//ÊòØÂê¶ÂºÄÂêØÊâ©Â±ï
<abbr title=" 355                          @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtensionRenderers"> 355                          @DefaultRenderersFactory.ExtensionRendererMode int extensionRendererMode = useExtensionRenüîµ</abbr>
<abbr title=" 356                                  ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_MODE_PREFER"> 356                                  ? (preferExtensionDecoders ? DefaultRenderersFactory.EXTENSION_RENDERER_MODE_PREFEüîµ</abbr>
 357                                  : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_ON)
 358                                  : DefaultRenderersFactory.EXTENSION_RENDERER_MODE_OFF;
 359                          if (mRendererFactory == null) {
 360                              mRendererFactory = new DefaultRenderersFactory(mAppContext);
 361                              mRendererFactory.setExtensionRendererMode(extensionRendererMode);
 362                          }
 363                          if (mLoadControl == null) {
 364                              mLoadControl = new DefaultLoadControl();
 365                          }
 366                          mInternalPlayer = new SimpleExoPlayer.Builder(mAppContext, mRendererFactory)
 367                                  .setLooper(Looper.myLooper())
 368                                  .setTrackSelector(mTrackSelector)
 369                                  .setLoadControl(mLoadControl).build();
 370                          mInternalPlayer.addListener(IjkExo2MediaPlayer.this);
 371                          mInternalPlayer.addAnalyticsListener(IjkExo2MediaPlayer.this);
 372                          mInternalPlayer.addListener(mEventLogger);
 373                          if (mSpeedPlaybackParameters != null) {
 374                              mInternalPlayer.setPlaybackParameters(mSpeedPlaybackParameters);
 375                          }



 376                          if (mSurface != null)
 377                              mInternalPlayer.setVideoSurface(mSurface);
 378                          mInternalPlayer.setMediaSource(mMediaSource);
 379                          mInternalPlayer.prepare();
 380                          mInternalPlayer.setPlayWhenReady(false);
 381                      }
 382                  }
 383          );
 384      }
 385  
 386      public String getOverrideExtension() {
 387          return mOverrideExtension;
 388      }
 389  
 390      public void setOverrideExtension(String overrideExtension) {
 391          this.mOverrideExtension = overrideExtension;
 392      }
 393  
 394      public void stopPlayback() {
 395          mInternalPlayer.stop();
 396      }
 397  
 398      /**
 399       * ÊòØÂê¶ÈúÄË¶ÅÂ∏¶‰∏äheader
 400       * setDataSource‰πãÂâçÁîüÊïà
 401       *
 402       * @param preview
 403       */
 404      public void setPreview(boolean preview) {
 405          isPreview = preview;
 406      }
 407  
 408      public boolean isPreview() {
 409          return isPreview;
 410      }
 411  
 412      public boolean isCache() {
 413          return isCache;
 414      }
 415  
 416  
 417      /**
 418       * ËÆæÁΩÆseek ÁöÑ‰∏¥ËøëÂ∏ß„ÄÇ
 419       **/
 420      public void setSeekParameter(@Nullable SeekParameters seekParameters) {
 421          mInternalPlayer.setSeekParameters(seekParameters);
 422      }
 423  
 424  
 425      /**
 426       * ÊòØÂê¶ÂºÄÂêØcache
 427       * setDataSource‰πãÂâçÁîüÊïà
 428       *
 429       * @param cache
 430       */
 431      public void setCache(boolean cache) {
 432          isCache = cache;
 433      }
 434  
 435      public File getCacheDir() {
 436          return mCacheDir;
 437      }
 438  
 439      /**
 440       * cacheÊñá‰ª∂ÁöÑÁõÆÂΩï
 441       * setDataSource‰πãÂâçÁîüÊïà
 442       *
 443       * @param cacheDir
 444       */
 445      public void setCacheDir(File cacheDir) {
 446          this.mCacheDir = cacheDir;
 447      }
 448  
 449      public MediaSource getMediaSource() {
 450          return mMediaSource;
 451      }
 452  
 453      public void setMediaSource(MediaSource mediaSource) {
 454          this.mMediaSource = mediaSource;
 455      }
 456  
 457      public ExoSourceManager getExoHelper() {
 458          return mExoHelper;
 459      }
 460  
 461      /**
 462       * ÂÄçÈÄüÊí≠Êîæ
 463       *
 464       * @param speed ÂÄçÈÄüÊí≠ÊîæÔºåÈªòËÆ§‰∏∫1
 465       * @param pitch Èü≥ÈáèÁº©ÊîæÔºåÈªòËÆ§‰∏∫1Ôºå‰øÆÊîπ‰ºöÂØºËá¥Â£∞Èü≥ÂèòË∞É
 466       */
 467      public void setSpeed(@Size(min = 0) float speed, @Size(min = 0) float pitch) {
 468          PlaybackParameters playbackParameters = new PlaybackParameters(speed, pitch);
 469          mSpeedPlaybackParameters = playbackParameters;
 470          if (mInternalPlayer != null) {
 471              mInternalPlayer.setPlaybackParameters(playbackParameters);
 472          }
 473      }
 474  
 475      public float getSpeed() {
 476          return mInternalPlayer.getPlaybackParameters().speed;
 477      }
 478  
 479      public int getBufferedPercentage() {
 480          if (mInternalPlayer == null)
 481              return 0;
 482  
 483          return mInternalPlayer.getBufferedPercentage();
 484      }
 485  
 486  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 487 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 488 -    public void onTimelineChanged(Timeline timeline, Object manifest, int reason) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 489 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 490 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 491 -</span>
 492      public MappingTrackSelector getTrackSelector() {
 493          return mTrackSelector;
 494      }
 495  
 496      public void setTrackSelector(MappingTrackSelector trackSelector) {
 497          this.mTrackSelector = trackSelector;
 498      }
 499  
 500      public LoadControl getLoadControl() {
 501          return mLoadControl;
 502      }
 503  
 504      public void setLoadControl(LoadControl loadControl) {
 505          this.mLoadControl = loadControl;
 506      }
 507  
 508      public DefaultRenderersFactory getRendererFactory() {
 509          return mRendererFactory;
 510      }
 511  
 512      public void setRendererFactory(DefaultRenderersFactory rendererFactory) {
 513          this.mRendererFactory = rendererFactory;
 514      }
 515  
 516      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 517 -    public void onTracksChanged(TrackGroupArray trackGroups, TrackSelectionArray trackSelections) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 518 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 519 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 520 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 521 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 522 -    public void onLoadingChanged(boolean isLoading) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 523 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 524 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 525 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 526 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 527 -    public void onPlayerStateChanged(boolean playWhenReady, int playbackState) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 528 +    public void onTracksChanged(@NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelections) {"> 528 +    public void onTracksChanged(@NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelectionsüîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 529 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 530 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 531 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 532 +    @SuppressLint(&quot;SwitchIntDef&quot;)</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 533 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 534 +    public void onPlayWhenReadyChanged(boolean playWhenReady, int playbackState) {</span>




 535          //ÈáçÊñ∞Êí≠ÊîæÁä∂ÊÄÅÈ°∫Â∫è‰∏∫ÔºöSTATE_IDLE -„ÄãSTATE_BUFFERING -„ÄãSTATE_READY
 536          //ÁºìÂÜ≤Êó∂È°∫Â∫è‰∏∫ÔºöSTATE_BUFFERING -„ÄãSTATE_READY
<abbr title=" 537          //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackState);"> 537          //Log.e(TAG, &quot;onPlayerStateChanged: playWhenReady = &quot; + playWhenReady + &quot;, playbackState = &quot; + playbackStaüîµ</abbr>
 538          if (isLastReportedPlayWhenReady != playWhenReady || lastReportedPlaybackState != playbackState) {
 539              int buffer = 0;
 540              if(mInternalPlayer != null) {
 541                  buffer =  mInternalPlayer.getBufferedPercentage();


 542              }
 543              if (isBuffering) {
 544                  switch (playbackState) {
 545                      case Player.STATE_ENDED:
 546                      case Player.STATE_READY:
 547                          notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_END, buffer);
 548                          isBuffering = false;
 549                          break;
 550                  }
 551              }
 552  
 553              if (isPreparing) {
 554                  switch (playbackState) {
 555                      case Player.STATE_READY:
 556                          notifyOnPrepared();
 557                          isPreparing = false;
 558                          break;
 559                  }
 560              }
 561  
 562              switch (playbackState) {
 563                  case Player.STATE_BUFFERING:
 564                      notifyOnInfo(IMediaPlayer.MEDIA_INFO_BUFFERING_START, buffer);
 565                      isBuffering = true;
 566                      break;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 567 -                case Player.STATE_READY:</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 568 -                    break;</span>
 569                  case Player.STATE_ENDED:
 570                      notifyOnCompletion();
 571                      break;
 572                  default:
 573                      break;
 574              }
 575          }
 576          isLastReportedPlayWhenReady = playWhenReady;
 577          lastReportedPlaybackState = playbackState;
 578      }
 579  
 580      @Override
 581      public void onRepeatModeChanged(int repeatMode) {
 582  
 583      }
 584  
 585      @Override
 586      public void onShuffleModeEnabledChanged(boolean shuffleModeEnabled) {
 587  
 588      }
 589  
 590      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 591 -    public void onPlayerError(ExoPlaybackException error) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 592 +    public void onPlayerError(@NonNull ExoPlaybackException error) {</span>
 593          notifyOnError(IMediaPlayer.MEDIA_ERROR_UNKNOWN, IMediaPlayer.MEDIA_ERROR_UNKNOWN);
 594      }
 595  
 596      @Override
 597      public void onPositionDiscontinuity(int reason) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 598 -</span>





<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 599 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 600 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 601 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 602 -    public void onPlaybackParametersChanged(PlaybackParameters playbackParameters) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 603 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 604 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 605 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 606 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 607 -    public void onSeekProcessed() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 608 -        notifyOnSeekComplete();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 609 -    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 610 +        if(reason == DISCONTINUITY_REASON_SEEK) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 611 +            notifyOnSeekComplete();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 612 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 613 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 614 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 615 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 616 +    public void onPlaybackParametersChanged(@NonNull PlaybackParameters playbackParameters) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 617 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 618 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 619 +</span>
 620  
 621      /////////////////////////////////////AudioRendererEventListener/////////////////////////////////////////////
 622  
 623  
 624      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 625 -    public void onPlayerStateChanged(EventTime eventTime, boolean playWhenReady, int playbackState) {</span>

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 626 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 627 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 628 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 629 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 630 -    public void onTimelineChanged(EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 631 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 632 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 633 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 634 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 635 -    public void onPositionDiscontinuity(EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 636 +    public void onTimelineChanged(@NonNull EventTime eventTime, int reason) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 637 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 638 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 639 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 640 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 641 +    public void onPositionDiscontinuity(@NonNull EventTime eventTime, int reason) {</span>
 642          notifyOnInfo(ON_POSITION_DISCOUNTINUITY, reason);
 643      }
 644  
 645      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 646 -    public void onSeekStarted(EventTime eventTime) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 647 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 648 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 649 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 650 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 651 -    public void onSeekProcessed(EventTime eventTime) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 652 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 653 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 654 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 655 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 656 -    public void onPlaybackParametersChanged(EventTime eventTime, PlaybackParameters playbackParameters) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 657 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 658 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 659 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 660 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 661 -    public void onRepeatModeChanged(EventTime eventTime, int repeatMode) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 662 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 663 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 664 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 665 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 666 -    public void onShuffleModeChanged(EventTime eventTime, boolean shuffleModeEnabled) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 667 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 668 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 669 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 670 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 671 -    public void onLoadingChanged(EventTime eventTime, boolean isLoading) {</span>

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 672 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 673 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 674 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 675 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 676 -    public void onPlayerError(EventTime eventTime, ExoPlaybackException error) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 677 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 678 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 679 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 680 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 681 -    public void onTracksChanged(EventTime eventTime, TrackGroupArray trackGroups, TrackSelectionArray trackSelections) {"> 681 -    public void onTracksChanged(EventTime eventTime, TrackGroupArray trackGroups, TrackSelectionArray trackSelectiüîµ</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 682 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 683 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 684 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 685 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 686 -    public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 686 -    public void onBandwidthEstimate(EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEüîµ</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 687 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 688 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 689 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 690 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 691 -    public void onMetadata(EventTime eventTime, Metadata metadata) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 692 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 693 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 694 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 695 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 696 -    public void onDecoderEnabled(EventTime eventTime, int trackType, DecoderCounters decoderCounters) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 697 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 698 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 699 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 700 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 701 -    public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initializationDurationMs) {"> 701 -    public void onDecoderInitialized(EventTime eventTime, int trackType, String decoderName, long initializationDuüîµ</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 702 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 703 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 704 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 705 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 706 -    public void onDecoderInputFormatChanged(EventTime eventTime, int trackType, Format format) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 707 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 708 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 709 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 710 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 711 -    public void onDecoderDisabled(EventTime eventTime, int trackType, DecoderCounters decoderCounters) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 712 +    public void onSeekStarted(@NonNull EventTime eventTime) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 713 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 714 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 715 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 716 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 717 +    public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters playbackParameters) {"> 717 +    public void onPlaybackParametersChanged(@NonNull EventTime eventTime, @NonNull PlaybackParameters playbackParaüîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 718 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 719 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 720 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 721 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 722 +    public void onRepeatModeChanged(@NonNull EventTime eventTime, int repeatMode) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 723 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 724 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 725 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 726 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 727 +    public void onShuffleModeChanged(@NonNull EventTime eventTime, boolean shuffleModeEnabled) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 728 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 729 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 730 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 731 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 732 +    public void onPlayerError(@NonNull EventTime eventTime, @NonNull ExoPlaybackException error) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 733 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 734 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 735 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 736 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 737 +    public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNull TrackSelectionArray trackSelections) {"> 737 +    public void onTracksChanged(@NonNull EventTime eventTime, @NonNull TrackGroupArray trackGroups, @NonNull Tracküîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 738 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 739 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 740 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 741 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 742 +    public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, long bitrateEstimate) {"> 742 +    public void onBandwidthEstimate(@NonNull EventTime eventTime, int totalLoadTimeMs, long totalBytesLoaded, longüîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 743 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 744 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 745 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 746 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 747 +    public void onMetadata(@NonNull EventTime eventTime, @NonNull Metadata metadata) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 748 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 749 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 750 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 751 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 752 +    public void onAudioDisabled(@NonNull EventTime eventTime, @NonNull DecoderCounters counters)  {</span>
 753          audioSessionId = C.AUDIO_SESSION_ID_UNSET;
 754      }
 755  
 756      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 757 -    public void onAudioUnderrun(EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs) {"> 757 -    public void onAudioUnderrun(EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMüîµ</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 758 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 759 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 760 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 761 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 762 -    public void onDroppedVideoFrames(EventTime eventTime, int droppedFrames, long elapsedMs) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 763 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 764 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 765 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 766 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 767 -    public void onVideoSizeChanged(EventTime eventTime, int width, int height, int unappliedRotationDegrees, float pixelWidthHeightRatio) {"> 767 -    public void onVideoSizeChanged(EventTime eventTime, int width, int height, int unappliedRotationDegrees, floatüîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 768 +    public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs) {"> 768 +    public void onAudioUnderrun(@NonNull EventTime eventTime, int bufferSize, long bufferSizeMs, long elapsedSinceüîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 769 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 770 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 771 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 772 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 773 +    public void onDroppedVideoFrames(@NonNull EventTime eventTime, int droppedFrames, long elapsedMs) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 774 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 775 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 776 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 777 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 778 +    public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotationDegrees, float pixelWidthHeightRatio) {"> 778 +    public void onVideoSizeChanged(@NonNull EventTime eventTime, int width, int height, int unappliedRotationDegreüîµ</abbr></span>
 779          mVideoWidth = (int) (width * pixelWidthHeightRatio);
 780          mVideoHeight = height;
 781          notifyOnVideoSizeChanged((int) (width * pixelWidthHeightRatio), height, 1, 1);
 782          if (unappliedRotationDegrees &gt; 0)
 783              notifyOnInfo(IMediaPlayer.MEDIA_INFO_VIDEO_ROTATION_CHANGED, unappliedRotationDegrees);
 784      }
 785  
 786      @Override
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 787 -    public void onRenderedFirstFrame(EventTime eventTime, Surface surface) {</span>











<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 788 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 789 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 790 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 791 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 792 -    public void onDrmKeysLoaded(EventTime eventTime) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 793 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 794 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 795 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 796 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 797 -    public void onDrmSessionManagerError(EventTime eventTime, Exception error) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 798 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 799 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 800 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 801 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 802 -    public void onDrmKeysRestored(EventTime eventTime) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 803 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 804 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 805 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 806 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 807 -    public void onDrmKeysRemoved(EventTime eventTime) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 808 +    public void onRenderedFirstFrame(@NonNull EventTime eventTime, Surface surface) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 809 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 810 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 811 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 812 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 813 +    public void onDrmKeysLoaded(@NonNull EventTime eventTime) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 814 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 815 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 816 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 817 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 818 +    public void onDrmSessionManagerError(@NonNull EventTime eventTime, @NonNull Exception error) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 819 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 820 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 821 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 822 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 823 +    public void onDrmKeysRestored(@NonNull EventTime eventTime) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 824 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 825 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 826 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 827 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 828 +    public void onDrmKeysRemoved(@NonNull EventTime eventTime) {</span>
 829  
 830      }
 831  }</pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            