<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>569</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    569
                    <a href="568.html">prev</a>
                    <a href="570.html">next</a>
                    <a href="569_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Freeyourgadget/Gadgetbridge_bb962001a5897d4ce5b4e36e8fdaeab8b49081b4_app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;bb962001a5897d4ce5b4e36e8fdaeab8b49081b4:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;bb962001a5897d4ce5b4e36e8fdaeab8b49081b4^1:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;bb962001a5897d4ce5b4e36e8fdaeab8b49081b4^2:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;c946ef5201bb1c76b017e38501714ab58c2b6b65:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1 /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                 </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2     Gobbetti, Normano64                                                                                  </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18 package nodomain.freeyourgadget.gadgetbridge;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20 import android.annotation.TargetApi;                                                                     </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21 import android.app.Application;                                                                          </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22 import android.app.NotificationManager;                                                                  </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23 import android.app.NotificationManager.Policy;                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25 import android.content.Intent;                                                                           </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26 import android.content.SharedPreferences;                                                                </span>
<span class="-9179032954578521484" onmouseenter="enter('-9179032954578521484');" onmouseout="out('-9179032954578521484');" style="">  27 import android.content.res.Configuration;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  28 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  29 import android.database.Cursor;                                                                          </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  30 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  31 import android.net.Uri;                                                                                  </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  32 import android.os.Build;                                                                                 </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  33 import android.os.Build.VERSION;                                                                         </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  34 import android.preference.PreferenceManager;                                                             </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  35 import android.provider.ContactsContract.PhoneLookup;                                                    </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  36 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  37 import android.util.Log;                                                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  38 import android.util.TypedValue;                                                                          </span>
<span  style="">  39                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  40 import java.io.File;                                                                                     </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  41 import java.io.IOException;                                                                              </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  42 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  43 import java.util.List;                                                                                   </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  44 import java.util.Locale;                                                                                 </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  45 import java.util.Set;                                                                                    </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  46 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  47 import java.util.concurrent.locks.Lock;                                                                  </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  48 import java.util.concurrent.locks.ReentrantLock;                                                         </span>
<span  style="">  49                                                                                                          </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="">  50 import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                        </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  51 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  52 import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                           </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  53 import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                       </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  54 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                       </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  55 import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                          </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  56 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  57 import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                        </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                          </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                 </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  61 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  62 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  63 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  66 =======                                                                                                  </span>
<span class="-2183458107255372167" onmouseenter="enter('-2183458107255372167');" onmouseout="out('-2183458107255372167');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  67 import nodomain.freeyourgadget.gadgetbridge.util.AndroidUtils;                                           </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  68 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  69 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  70 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  71 import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  72 import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                           </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  73 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span  style="">  74                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  75 /**                                                                                                      </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  76  * Main Application class that initializes and provides access to certain things like                    </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  77  * logging and DB access.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  78  */                                                                                                      </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  79 public class GBApplication extends Application {                                                         </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  80     // Since this class must not log to slf4j, we use plain android.util.Log                             </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  81     private static final String TAG = &quot;GBApplication&quot;;                                                   </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  82     public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                           </span>
<span  style="">  83                                                                                                          </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  84     private static GBApplication context;                                                                </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  85     private static final Lock dbLock = new ReentrantLock();                                              </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  86     private static DeviceService deviceService;                                                          </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  87     private static SharedPreferences sharedPrefs;                                                        </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  88     private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                            </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  89     //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  89     //if preferences have to be migrated, increment the following and add the migration logic in migratePðŸ”µ</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  90     private static final int CURRENT_PREFS_VERSION = 2;                                                  </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  91     private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                  </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  92     private static Prefs prefs;                                                                          </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  93     private static GBPrefs gbPrefs;                                                                      </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  94     private static LockHandler lockHandler;                                                              </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  95     /**                                                                                                  </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  96      * Note: is null on Lollipop and Kitkat                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  97      */                                                                                                  </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  98     private static NotificationManager notificationManager;                                              </span>
<span  style="">  99                                                                                                          </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style=""> 100     public static final String ACTION_QUIT                                                               </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style=""> 101             = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                          </span>
<span class="3620791290214227219" onmouseenter="enter('3620791290214227219');" onmouseout="out('3620791290214227219');" style=""><abbr title=" 102     public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.language_change&quot;;"> 102     public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplicatiðŸ”µ</abbr></span>
<span  style=""> 103                                                                                                          </span>
<span class="-6827183296325807512" onmouseenter="enter('-6827183296325807512');" onmouseout="out('-6827183296325807512');" style=""> 104     private static GBApplication app;                                                                    </span>
<span  style=""> 105                                                                                                          </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style=""> 106     private static Logging logging = new Logging() {                                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 107         @Override                                                                                        </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style=""> 108         protected String createLogDirectory() throws IOException {                                       </span>
<span class="9110710162536643525" onmouseenter="enter('9110710162536643525');" onmouseout="out('9110710162536643525');" style=""> 109             if (GBEnvironment.env().isLocalTest()) {                                                     </span>
<span class="-6519269446490050835" onmouseenter="enter('-6519269446490050835');" onmouseout="out('-6519269446490050835');" style=""> 110                 return System.getProperty(Logging.PROP_LOGFILES_DIR);                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 111             } else {                                                                                     </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style=""> 112                 File dir = FileUtils.getExternalFilesDir();                                              </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style=""> 113                 return dir.getAbsolutePath();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 116     };                                                                                                   </span>
<span class="-466220917116319233" onmouseenter="enter('-466220917116319233');" onmouseout="out('-466220917116319233');" style=""> 117     private static Locale language;                                                                      </span>
<span  style=""> 118                                                                                                          </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 119     private DeviceManager deviceManager;                                                                 </span>
<span  style=""> 120                                                                                                          </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 121     public static void quit() {                                                                          </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 122         GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                               </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 123         Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                       </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 124         LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                            </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 125         GBApplication.deviceService().quit();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126     }                                                                                                    </span>
<span  style=""> 127                                                                                                          </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 128     public GBApplication() {                                                                             </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 129         context = this;                                                                                  </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 130         // don&#x27;t do anything here, add it to onCreate instead                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="7323683286886200939" onmouseenter="enter('7323683286886200939');" onmouseout="out('7323683286886200939');" style=""> 133     public static Logging getLogging() {                                                                 </span>
<span class="3757797739027293534" onmouseenter="enter('3757797739027293534');" onmouseout="out('3757797739027293534');" style=""> 134         return logging;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135     }                                                                                                    </span>
<span  style=""> 136                                                                                                          </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 137     protected DeviceService createDeviceService() {                                                      </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 138         return new GBDeviceService(this);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139     }                                                                                                    </span>
<span  style=""> 140                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 141     @Override                                                                                            </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 142     public void onCreate() {                                                                             </span>
<span class="-8156783544820381420" onmouseenter="enter('-8156783544820381420');" onmouseout="out('-8156783544820381420');" style=""> 143         app = this;                                                                                      </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 144         super.onCreate();                                                                                </span>
<span  style=""> 145                                                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 146         if (lockHandler != null) {                                                                       </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 147             // guard against multiple invocations (robolectric)                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 148             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149         }                                                                                                </span>
<span  style=""> 150                                                                                                          </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 151         sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                            </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 152         prefs = new Prefs(sharedPrefs);                                                                  </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 153         gbPrefs = new GBPrefs(prefs);                                                                    </span>
<span  style=""> 154                                                                                                          </span>
<span class="-7675320667911398446" onmouseenter="enter('-7675320667911398446');" onmouseout="out('-7675320667911398446');" style=""> 155         if (!GBEnvironment.isEnvironmentSetup()) {                                                       </span>
<span class="-2266666929574149874" onmouseenter="enter('-2266666929574149874');" onmouseout="out('-2266666929574149874');" style=""> 156             GBEnvironment.setupEnvironment(GBEnvironment.createDeviceEnvironment());                     </span>
<span class="-3738634480535142994" onmouseenter="enter('-3738634480535142994');" onmouseout="out('-3738634480535142994');" style=""> 157             // setup db after the environment is set up, but don&#x27;t do it in test mode                    </span>
<span class="5829052537828666407" onmouseenter="enter('5829052537828666407');" onmouseout="out('5829052537828666407');" style=""> 158             // in test mode, it&#x27;s done individually, see TestBase                                        </span>
<span class="5177995110342670479" onmouseenter="enter('5177995110342670479');" onmouseout="out('5177995110342670479');" style=""> 159             setupDatabase();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160         }                                                                                                </span>
<span  style=""> 161                                                                                                          </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 162         // don&#x27;t do anything here before we set up logging, otherwise                                    </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 163         // slf4j may be implicitly initialized before we properly configured it.                         </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 164         setupLogging(isFileLoggingEnabled());                                                            </span>
<span  style=""> 165                                                                                                          </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 166         if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                            </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 167             migratePrefs(getPrefsFileVersion());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168         }                                                                                                </span>
<span  style=""> 169                                                                                                          </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 170         setupExceptionHandler();                                                                         </span>
<span  style=""> 171                                                                                                          </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 172         deviceManager = new DeviceManager(this);                                                         </span>
<span class="5344675729095119335" onmouseenter="enter('5344675729095119335');" onmouseout="out('5344675729095119335');" style=""> 173         String language = prefs.getString(&quot;language&quot;, &quot;default&quot;);                                        </span>
<span class="-4352228919314969984" onmouseenter="enter('-4352228919314969984');" onmouseout="out('-4352228919314969984');" style=""> 174         setLanguage(language);                                                                           </span>
<span  style=""> 175                                                                                                          </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style=""> 176         createWebViewActivity();                                                                         </span>
<span  style=""> 177                                                                                                          </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 178         deviceService = createDeviceService();                                                           </span>
<span class="-7443536723725935642" onmouseenter="enter('-7443536723725935642');" onmouseout="out('-7443536723725935642');" style=""> 179         loadAppsBlackList();                                                                             </span>
<span class="-5451989795140418224" onmouseenter="enter('-5451989795140418224');" onmouseout="out('-5451989795140418224');" style=""> 180         loadCalendarsBlackList();                                                                        </span>
<span  style=""> 181                                                                                                          </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 182         if (isRunningMarshmallowOrLater()) {                                                             </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""><abbr title=" 183             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);"> 183             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERðŸ”µ</abbr></span>
<span class="-3292367781642785183" onmouseenter="enter('-3292367781642785183');" onmouseout="out('-3292367781642785183');" style=""> 184             //the following will ensure the notification manager is kept alive                           </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 185             startService(new Intent(this, NotificationCollectorMonitorService.class));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187     }                                                                                                    </span>
<span  style=""> 188                                                                                                          </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style=""> 189     private void createWebViewActivity() {                                                               </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style=""> 190         if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                   </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style=""> 191             Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                   </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style=""> 192             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                              </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style=""> 193             startActivity(intent);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195     }                                                                                                    </span>
<span  style=""> 196                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 197     @Override                                                                                            </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 198     public void onTrimMemory(int level) {                                                                </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 199         super.onTrimMemory(level);                                                                       </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 200         if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                           </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 201             if (!hasBusyDevice()) {                                                                      </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 202                 DBHelper.clearSession();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205     }                                                                                                    </span>
<span  style=""> 206                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 207     /**                                                                                                  </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 208      * Returns true if at least a single device is busy, e.g synchronizing activity data                 </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 209      * or something similar.                                                                             </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 210      * Note: busy is not the same as connected or initialized!                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 211      */                                                                                                  </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 212     private boolean hasBusyDevice() {                                                                    </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 213         List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                        </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 214         for (GBDevice device : devices) {                                                                </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 215             if (device.isBusy()) {                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 216                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 219         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220     }                                                                                                    </span>
<span  style=""> 221                                                                                                          </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 222     public static void setupLogging(boolean enabled) {                                                   </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 223         logging.setupLogging(enabled);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224     }                                                                                                    </span>
<span  style=""> 225                                                                                                          </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 226     private void setupExceptionHandler() {                                                               </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 227         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 227         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHðŸ”µ</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 228         Thread.setDefaultUncaughtExceptionHandler(handler);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229     }                                                                                                    </span>
<span  style=""> 230                                                                                                          </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 231     public static boolean isFileLoggingEnabled() {                                                       </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 232         return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233     }                                                                                                    </span>
<span  style=""> 234                                                                                                          </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 235     public static boolean minimizeNotification() {                                                       </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 236         return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237     }                                                                                                    </span>
<span  style=""> 238                                                                                                          </span>
<span class="3584575502170839042" onmouseenter="enter('3584575502170839042');" onmouseout="out('3584575502170839042');" style=""> 239     public void setupDatabase() {                                                                        </span>
<span class="-3757253101115813818" onmouseenter="enter('-3757253101115813818');" onmouseout="out('-3757253101115813818');" style=""> 240         DaoMaster.OpenHelper helper;                                                                     </span>
<span class="9128810292226701201" onmouseenter="enter('9128810292226701201');" onmouseout="out('9128810292226701201');" style=""> 241         GBEnvironment env = GBEnvironment.env();                                                         </span>
<span class="7076376602711179030" onmouseenter="enter('7076376602711179030');" onmouseout="out('7076376602711179030');" style=""> 242         if (env.isTest()) {                                                                              </span>
<span class="-4283816386875317195" onmouseenter="enter('-4283816386875317195');" onmouseout="out('-4283816386875317195');" style=""> 243             helper = new DaoMaster.DevOpenHelper(this, null, null);                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 244         } else {                                                                                         </span>
<span class="4579041963248283587" onmouseenter="enter('4579041963248283587');" onmouseout="out('4579041963248283587');" style=""> 245             helper = new DBOpenHelper(this, DATABASE_NAME, null);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246         }                                                                                                </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 247         SQLiteDatabase db = helper.getWritableDatabase();                                                </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 248         DaoMaster daoMaster = new DaoMaster(db);                                                         </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 249         if (lockHandler == null) {                                                                       </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 250             lockHandler = new LockHandler();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251         }                                                                                                </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 252         lockHandler.init(daoMaster, helper);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253     }                                                                                                    </span>
<span  style=""> 254                                                                                                          </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 255     public static Context getContext() {                                                                 </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 256         return context;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257     }                                                                                                    </span>
<span  style=""> 258                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 259     /**                                                                                                  </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 260      * Returns the facade for talking to devices. Devices are managed by                                 </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 261      * an Android Service and this facade provides access to its functionality.                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 262      *                                                                                                   </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 263      * @return the facade for talking to the service/devices.                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 264      */                                                                                                  </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 265     public static DeviceService deviceService() {                                                        </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 266         return deviceService;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267     }                                                                                                    </span>
<span  style=""> 268                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 269     /**                                                                                                  </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 270      * Returns the DBHandler instance for reading/writing or throws GBException                          </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 271      * when that was not successful                                                                      </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 272      * If acquiring was successful, callers must call #releaseDB when they                               </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 273      * are done (from the same thread that acquired the lock!                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 274      * &lt;p&gt;                                                                                               </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 275      * Callers must not hold a reference to the returned instance because it                             </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 276      * will be invalidated at some point.                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 277      *                                                                                                   </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 278      * @return the DBHandler                                                                             </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 279      * @throws GBException                                                                               </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 280      * @see #releaseDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 281      */                                                                                                  </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 282     public static DBHandler acquireDB() throws GBException {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 283         try {                                                                                            </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 284             if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                  </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 285                 return lockHandler;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286             }                                                                                            </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 287         } catch (InterruptedException ex) {                                                              </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 288             Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289         }                                                                                                </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 290         throw new GBException(&quot;Unable to access the database.&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 293     /**                                                                                                  </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 294      * Releases the database lock.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 295      *                                                                                                   </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 296      * @throws IllegalMonitorStateException if the current thread is not owning the lock                 </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 297      * @see #acquireDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 298      */                                                                                                  </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 299     public static void releaseDB() {                                                                     </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 300         dbLock.unlock();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 303     public static boolean isRunningLollipopOrLater() {                                                   </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 304         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305     }                                                                                                    </span>
<span  style=""> 306                                                                                                          </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 307     public static boolean isRunningMarshmallowOrLater() {                                                </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 308         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309     }                                                                                                    </span>
<span  style=""> 310                                                                                                          </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 311     private static boolean isPrioritySender(int prioritySenders, String number) {                        </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 312         if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 313             return true;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 314         } else {                                                                                         </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 315             Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));          </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 316             String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                    </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 317             Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);       </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 318             boolean exists = false;                                                                      </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 319             int starred = 0;                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 320             try {                                                                                        </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 321                 if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                            </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 322                     exists = true;                                                                       </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 323                     starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324                 }                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 325             } finally {                                                                                  </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 326                 if (cursor != null) {                                                                    </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 327                     cursor.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329             }                                                                                            </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 330             if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 331                 return true;                                                                             </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 332             } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 333                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334             }                                                                                            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 335             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337     }                                                                                                    </span>
<span  style=""> 338                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 339     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 340     public static boolean isPriorityNumber(int priorityType, String number) {                            </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 341         NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();     </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 342         if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                         </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 343             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 343             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIðŸ”µ</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 344                 return isPrioritySender(notificationPolicy.priorityMessageSenders, number);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345             }                                                                                            </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 346         } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                     </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 347             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 347             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORIðŸ”µ</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 348                 return isPrioritySender(notificationPolicy.priorityCallSenders, number);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 351         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352     }                                                                                                    </span>
<span  style=""> 353                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 354     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 355     public static int getGrantedInterruptionFilter() {                                                   </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""><abbr title=" 356         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {"> 356         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()ðŸ”µ</abbr></span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 357             if (notificationManager.isNotificationPolicyAccessGranted()) {                               </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 358                 return notificationManager.getCurrentInterruptionFilter();                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 360         }                                                                                                </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 361         return NotificationManager.INTERRUPTION_FILTER_ALL;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362     }                                                                                                    </span>
<span  style=""> 363                                                                                                          </span>
<span class="-9029891236967858826" onmouseenter="enter('-9029891236967858826');" onmouseout="out('-9029891236967858826');" style=""> 364     private static HashSet&lt;String&gt; apps_blacklist = null;                                                </span>
<span  style=""> 365                                                                                                          </span>
<span class="628937876596348808" onmouseenter="enter('628937876596348808');" onmouseout="out('628937876596348808');" style=""> 366     public static boolean appIsBlacklisted(String packageName) {                                         </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 367         if (apps_blacklist == null) {                                                                    </span>
<span class="-1946294913030942780" onmouseenter="enter('-1946294913030942780');" onmouseout="out('-1946294913030942780');" style=""> 368             GB.log(&quot;appIsBlacklisted: apps_blacklist is null!&quot;, GB.INFO, null);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369         }                                                                                                </span>
<span class="1884921446555776787" onmouseenter="enter('1884921446555776787');" onmouseout="out('1884921446555776787');" style=""> 370         return apps_blacklist != null &amp;&amp; apps_blacklist.contains(packageName);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371     }                                                                                                    </span>
<span  style=""> 372                                                                                                          </span>
<span class="7953897085511400770" onmouseenter="enter('7953897085511400770');" onmouseout="out('7953897085511400770');" style=""> 373     public static void setAppsBlackList(Set&lt;String&gt; packageNames) {                                      </span>
<span class="-8197290468385298169" onmouseenter="enter('-8197290468385298169');" onmouseout="out('-8197290468385298169');" style=""> 374         if (packageNames == null) {                                                                      </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 375             GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 376             apps_blacklist = new HashSet&lt;&gt;();                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 377         } else {                                                                                         </span>
<span class="-3015046103246507563" onmouseenter="enter('-3015046103246507563');" onmouseout="out('-3015046103246507563');" style=""> 378             apps_blacklist = new HashSet&lt;&gt;(packageNames);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379         }                                                                                                </span>
<span class="7291510234597289182" onmouseenter="enter('7291510234597289182');" onmouseout="out('7291510234597289182');" style=""> 380         GB.log(&quot;New apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);           </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 381         saveAppsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382     }                                                                                                    </span>
<span  style=""> 383                                                                                                          </span>
<span class="-4764637370834062607" onmouseenter="enter('-4764637370834062607');" onmouseout="out('-4764637370834062607');" style=""> 384     private static void loadAppsBlackList() {                                                            </span>
<span class="-7366183400676760194" onmouseenter="enter('-7366183400676760194');" onmouseout="out('-7366183400676760194');" style=""> 385         GB.log(&quot;Loading apps_blacklist&quot;, GB.INFO, null);                                                 </span>
<span class="-1377772229847163824" onmouseenter="enter('-1377772229847163824');" onmouseout="out('-1377772229847163824');" style=""> 386         apps_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.PACKAGE_BLACKLIST, null);    </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 387         if (apps_blacklist == null) {                                                                    </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 388             apps_blacklist = new HashSet&lt;&gt;();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389         }                                                                                                </span>
<span class="-1532140920596176818" onmouseenter="enter('-1532140920596176818');" onmouseout="out('-1532140920596176818');" style=""> 390         GB.log(&quot;Loaded apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391     }                                                                                                    </span>
<span  style=""> 392                                                                                                          </span>
<span class="6267616075496604119" onmouseenter="enter('6267616075496604119');" onmouseout="out('6267616075496604119');" style=""> 393     private static void saveAppsBlackList() {                                                            </span>
<span class="2886231841558584460" onmouseenter="enter('2886231841558584460');" onmouseout="out('2886231841558584460');" style=""> 394         GB.log(&quot;Saving apps_blacklist with &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);       </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 395         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-7981649915035584664" onmouseenter="enter('-7981649915035584664');" onmouseout="out('-7981649915035584664');" style=""> 396         if (apps_blacklist.isEmpty()) {                                                                  </span>
<span class="-7815879823137819644" onmouseenter="enter('-7815879823137819644');" onmouseout="out('-7815879823137819644');" style=""> 397             editor.putStringSet(GBPrefs.PACKAGE_BLACKLIST, null);                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 398         } else {                                                                                         </span>
<span class="-85230520183976524" onmouseenter="enter('-85230520183976524');" onmouseout="out('-85230520183976524');" style=""> 399             Prefs.putStringSet(editor, GBPrefs.PACKAGE_BLACKLIST, apps_blacklist);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 401         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402     }                                                                                                    </span>
<span  style=""> 403                                                                                                          </span>
<span class="3406803570609530272" onmouseenter="enter('3406803570609530272');" onmouseout="out('3406803570609530272');" style=""> 404     public static void addAppToBlacklist(String packageName) {                                           </span>
<span class="-4613377587158803622" onmouseenter="enter('-4613377587158803622');" onmouseout="out('-4613377587158803622');" style=""> 405         if (apps_blacklist.add(packageName)) {                                                           </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 406             saveAppsBlackList();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408     }                                                                                                    </span>
<span  style=""> 409                                                                                                          </span>
<span class="6341305090216699567" onmouseenter="enter('6341305090216699567');" onmouseout="out('6341305090216699567');" style=""> 410     public static synchronized void removeFromAppsBlacklist(String packageName) {                        </span>
<span class="6848681783835366738" onmouseenter="enter('6848681783835366738');" onmouseout="out('6848681783835366738');" style=""> 411         GB.log(&quot;Removing from apps_blacklist: &quot; + packageName, GB.INFO, null);                           </span>
<span class="1898542166501963208" onmouseenter="enter('1898542166501963208');" onmouseout="out('1898542166501963208');" style=""> 412         apps_blacklist.remove(packageName);                                                              </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 413         saveAppsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414     }                                                                                                    </span>
<span  style=""> 415                                                                                                          </span>
<span class="-1625652503048685789" onmouseenter="enter('-1625652503048685789');" onmouseout="out('-1625652503048685789');" style=""> 416     private static HashSet&lt;String&gt; calendars_blacklist = null;                                           </span>
<span  style=""> 417                                                                                                          </span>
<span class="7038688512705390946" onmouseenter="enter('7038688512705390946');" onmouseout="out('7038688512705390946');" style=""> 418     public static boolean calendarIsBlacklisted(String calendarDisplayName) {                            </span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 419         if (calendars_blacklist == null) {                                                               </span>
<span class="2679978338359393788" onmouseenter="enter('2679978338359393788');" onmouseout="out('2679978338359393788');" style=""> 420             GB.log(&quot;calendarIsBlacklisted: calendars_blacklist is null!&quot;, GB.INFO, null);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421         }                                                                                                </span>
<span class="-6083844107851171159" onmouseenter="enter('-6083844107851171159');" onmouseout="out('-6083844107851171159');" style=""> 422         return calendars_blacklist != null &amp;&amp; calendars_blacklist.contains(calendarDisplayName);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423     }                                                                                                    </span>
<span  style=""> 424                                                                                                          </span>
<span class="-1203782580073493681" onmouseenter="enter('-1203782580073493681');" onmouseout="out('-1203782580073493681');" style=""> 425     public static void setCalendarsBlackList(Set&lt;String&gt; calendarNames) {                                </span>
<span class="9006806600947611848" onmouseenter="enter('9006806600947611848');" onmouseout="out('9006806600947611848');" style=""> 426         if (calendarNames == null) {                                                                     </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 427             GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 428             calendars_blacklist = new HashSet&lt;&gt;();                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 429         } else {                                                                                         </span>
<span class="-5832993308357266278" onmouseenter="enter('-5832993308357266278');" onmouseout="out('-5832993308357266278');" style=""> 430             calendars_blacklist = new HashSet&lt;&gt;(calendarNames);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431         }                                                                                                </span>
<span class="-2685264550992926452" onmouseenter="enter('-2685264550992926452');" onmouseout="out('-2685264550992926452');" style=""> 432         GB.log(&quot;New calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null); </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 433         saveCalendarsBlackList();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434     }                                                                                                    </span>
<span  style=""> 435                                                                                                          </span>
<span class="-1352938694099643130" onmouseenter="enter('-1352938694099643130');" onmouseout="out('-1352938694099643130');" style=""> 436     public static void addCalendarToBlacklist(String calendarDisplayName) {                              </span>
<span class="5135070223261002446" onmouseenter="enter('5135070223261002446');" onmouseout="out('5135070223261002446');" style=""> 437         if (calendars_blacklist.add(calendarDisplayName)) {                                              </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 438             saveCalendarsBlackList();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 440     }                                                                                                    </span>
<span  style=""> 441                                                                                                          </span>
<span class="-4191679597070541210" onmouseenter="enter('-4191679597070541210');" onmouseout="out('-4191679597070541210');" style=""> 442     public static void removeFromCalendarBlacklist(String calendarDisplayName) {                         </span>
<span class="-3543064320447564137" onmouseenter="enter('-3543064320447564137');" onmouseout="out('-3543064320447564137');" style=""> 443         calendars_blacklist.remove(calendarDisplayName);                                                 </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 444         saveCalendarsBlackList();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445     }                                                                                                    </span>
<span  style=""> 446                                                                                                          </span>
<span class="8449352248946474476" onmouseenter="enter('8449352248946474476');" onmouseout="out('8449352248946474476');" style=""> 447     private static void loadCalendarsBlackList() {                                                       </span>
<span class="929362169649938726" onmouseenter="enter('929362169649938726');" onmouseout="out('929362169649938726');" style=""> 448         GB.log(&quot;Loading calendars_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="-3197959776357605547" onmouseenter="enter('-3197959776357605547');" onmouseout="out('-3197959776357605547');" style=""><abbr title=" 449         calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, null);"> 449         calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, nullðŸ”µ</abbr></span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 450         if (calendars_blacklist == null) {                                                               </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 451             calendars_blacklist = new HashSet&lt;&gt;();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452         }                                                                                                </span>
<span class="-7148420027100342883" onmouseenter="enter('-7148420027100342883');" onmouseout="out('-7148420027100342883');" style=""><abbr title=" 453         GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);"> 453         GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, nullðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 454     }                                                                                                    </span>
<span  style=""> 455                                                                                                          </span>
<span class="2309319604958063821" onmouseenter="enter('2309319604958063821');" onmouseout="out('2309319604958063821');" style=""> 456     private static void saveCalendarsBlackList() {                                                       </span>
<span class="5173264045101766520" onmouseenter="enter('5173264045101766520');" onmouseout="out('5173264045101766520');" style=""><abbr title=" 457         GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);"> 457         GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, nulðŸ”µ</abbr></span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 458         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-7491519725598434790" onmouseenter="enter('-7491519725598434790');" onmouseout="out('-7491519725598434790');" style=""> 459         if (calendars_blacklist.isEmpty()) {                                                             </span>
<span class="4243111498727581039" onmouseenter="enter('4243111498727581039');" onmouseout="out('4243111498727581039');" style=""> 460             editor.putStringSet(GBPrefs.CALENDAR_BLACKLIST, null);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 461         } else {                                                                                         </span>
<span class="-2454412986410082716" onmouseenter="enter('-2454412986410082716');" onmouseout="out('-2454412986410082716');" style=""> 462             Prefs.putStringSet(editor, GBPrefs.CALENDAR_BLACKLIST, calendars_blacklist);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 463         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 464         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465     }                                                                                                    </span>
<span  style=""> 466                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 467     /**                                                                                                  </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 468      * Deletes both the old Activity database and the new one recreates it with empty tables.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 469      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 470      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 471      */                                                                                                  </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 472     public static synchronized boolean deleteActivityDatabase(Context context) {                         </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 473         // TODO: flush, close, reopen db                                                                 </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 474         if (lockHandler != null) {                                                                       </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 475             lockHandler.closeDb();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476         }                                                                                                </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 477         boolean result = deleteOldActivityDatabase(context);                                             </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 478         result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                            </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 479         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480     }                                                                                                    </span>
<span  style=""> 481                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 482     /**                                                                                                  </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 483      * Deletes the legacy (pre 0.12) Activity database                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 484      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 485      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 486      */                                                                                                  </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 487     public static synchronized boolean deleteOldActivityDatabase(Context context) {                      </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 488         DBHelper dbHelper = new DBHelper(context);                                                       </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 489         boolean result = true;                                                                           </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 490         if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                     </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 491             result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492         }                                                                                                </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 493         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494     }                                                                                                    </span>
<span  style=""> 495                                                                                                          </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 496     private int getPrefsFileVersion() {                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 497         try {                                                                                            </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 498             return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 499         } catch (Exception e) {                                                                          </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 500             //in version 1 this was an int                                                               </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 501             return 1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503     }                                                                                                    </span>
<span  style=""> 504                                                                                                          </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 505     private void migratePrefs(int oldVersion) {                                                          </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 506         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 507         switch (oldVersion) {                                                                            </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 508             case 0:                                                                                      </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 509                 String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                     </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 510                 String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                  </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 511                 String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                  </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 512                 String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                 </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 513                 if (legacyGender != null) {                                                              </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 514                     int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;</span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 515                     editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));           </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 516                     editor.remove(&quot;mi_user_gender&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517                 }                                                                                        </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 518                 if (legacyHeight != null) {                                                              </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 519                     editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                    </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 520                     editor.remove(&quot;mi_user_height_cm&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521                 }                                                                                        </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 522                 if (legacyWeigth != null) {                                                              </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 523                     editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                    </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 524                     editor.remove(&quot;mi_user_weight_kg&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525                 }                                                                                        </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 526                 if (legacyYOB != null) {                                                                 </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 527                     editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                   </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 528                     editor.remove(&quot;mi_user_year_of_birth&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529                 }                                                                                        </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 530                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 531                 break;                                                                                   </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 532             case 1:                                                                                      </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 533                 //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 533                 //migrate the integer version of gender introduced in version 1 to a string value, neededðŸ”µ</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 534                 int legacyGender_1 = 2;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 535                 try {                                                                                    </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 536                     legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 537                 } catch (Exception e) {                                                                  </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 538                     Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 539                 }                                                                                        </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 540                 editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));       </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 541                 //also silently migrate the version to a string value                                    </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 542                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 543                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 545         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546     }                                                                                                    </span>
<span  style=""> 547                                                                                                          </span>
<span class="-3847609959270330161" onmouseenter="enter('-3847609959270330161');" onmouseout="out('-3847609959270330161');" style=""> 548     public static void setLanguage(String lang) {                                                        </span>
<span class="2010165672364354755" onmouseenter="enter('2010165672364354755');" onmouseout="out('2010165672364354755');" style=""> 549         if (lang.equals(&quot;default&quot;)) {                                                                    </span>
<span class="-1084003509567751492" onmouseenter="enter('-1084003509567751492');" onmouseout="out('-1084003509567751492');" style=""> 550             language = Resources.getSystem().getConfiguration().locale;                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 551         } else {                                                                                         </span>
<span class="-1687880958280815140" onmouseenter="enter('-1687880958280815140');" onmouseout="out('-1687880958280815140');" style=""> 552             language = new Locale(lang);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 553         }                                                                                                </span>
<span class="-6135042183655095886" onmouseenter="enter('-6135042183655095886');" onmouseout="out('-6135042183655095886');" style=""> 554         updateLanguage(language);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555     }                                                                                                    </span>
<span  style=""> 556                                                                                                          </span>
<span class="5259621038207386847" onmouseenter="enter('5259621038207386847');" onmouseout="out('5259621038207386847');" style=""> 557     public static void updateLanguage(Locale locale) {                                                   </span>
<span class="1109198243690318720" onmouseenter="enter('1109198243690318720');" onmouseout="out('1109198243690318720');" style=""> 558         AndroidUtils.setLanguage(context, locale);                                                       </span>
<span  style=""> 559                                                                                                          </span>
<span class="535862575394010177" onmouseenter="enter('535862575394010177');" onmouseout="out('535862575394010177');" style=""> 560         Intent intent = new Intent();                                                                    </span>
<span class="-164638367863943974" onmouseenter="enter('-164638367863943974');" onmouseout="out('-164638367863943974');" style=""> 561         intent.setAction(ACTION_LANGUAGE_CHANGE);                                                        </span>
<span class="4843300360101524365" onmouseenter="enter('4843300360101524365');" onmouseout="out('4843300360101524365');" style=""> 562         LocalBroadcastManager.getInstance(context).sendBroadcast(intent);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563     }                                                                                                    </span>
<span  style=""> 564                                                                                                          </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 565     public static LimitedQueue getIDSenderLookup() {                                                     </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 566         return mIDSenderLookup;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567     }                                                                                                    </span>
<span  style=""> 568                                                                                                          </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 569     public static boolean isDarkThemeEnabled() {                                                         </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 570         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 570         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 571     }                                                                                                    </span>
<span  style=""> 572                                                                                                          </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 573     public static int getTextColor(Context context) {                                                    </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 574         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 575         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 576         theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                               </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 577         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578     }                                                                                                    </span>
<span  style=""> 579                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 580     @Override                                                                                            </span>
<span class="2483214837331013305" onmouseenter="enter('2483214837331013305');" onmouseout="out('2483214837331013305');" style=""> 581     public void onConfigurationChanged(Configuration newConfig) {                                        </span>
<span class="-1478537389163372238" onmouseenter="enter('-1478537389163372238');" onmouseout="out('-1478537389163372238');" style=""> 582         super.onConfigurationChanged(newConfig);                                                         </span>
<span class="2223384074430921263" onmouseenter="enter('2223384074430921263');" onmouseout="out('2223384074430921263');" style=""> 583         updateLanguage(getLanguage());                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 584     }                                                                                                    </span>
<span  style=""> 585                                                                                                          </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 586     public static int getBackgroundColor(Context context) {                                              </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 587         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 588         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 589         theme.resolveAttribute(android.R.attr.background, typedValue, true);                             </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 590         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 591     }                                                                                                    </span>
<span  style=""> 592                                                                                                          </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 593     public static Prefs getPrefs() {                                                                     </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 594         return prefs;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595     }                                                                                                    </span>
<span  style=""> 596                                                                                                          </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 597     public static GBPrefs getGBPrefs() {                                                                 </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 598         return gbPrefs;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 599     }                                                                                                    </span>
<span  style=""> 600                                                                                                          </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 601     public DeviceManager getDeviceManager() {                                                            </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 602         return deviceManager;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 603     }                                                                                                    </span>
<span  style=""> 604                                                                                                          </span>
<span class="-1673519419532841409" onmouseenter="enter('-1673519419532841409');" onmouseout="out('-1673519419532841409');" style=""> 605     public static GBApplication app() {                                                                  </span>
<span class="-5545492324510288114" onmouseenter="enter('-5545492324510288114');" onmouseout="out('-5545492324510288114');" style=""> 606         return app;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607     }                                                                                                    </span>
<span  style=""> 608                                                                                                          </span>
<span class="4339444706683048648" onmouseenter="enter('4339444706683048648');" onmouseout="out('4339444706683048648');" style=""> 609     public static Locale getLanguage() {                                                                 </span>
<span class="8742914849630491523" onmouseenter="enter('8742914849630491523');" onmouseout="out('8742914849630491523');" style=""> 610         return language;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 611     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 612 }                                                                                                        </span></pre></td>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1 /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                 </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2     Gobbetti, Normano64                                                                                  </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18 package nodomain.freeyourgadget.gadgetbridge;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20 import android.annotation.TargetApi;                                                                     </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21 import android.app.Application;                                                                          </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22 import android.app.NotificationManager;                                                                  </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23 import android.app.NotificationManager.Policy;                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25 import android.content.Intent;                                                                           </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26 import android.content.SharedPreferences;                                                                </span>
<span class="-9179032954578521484" onmouseenter="enter('-9179032954578521484');" onmouseout="out('-9179032954578521484');" style="">  27 import android.content.res.Configuration;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  28 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  29 import android.database.Cursor;                                                                          </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  30 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  31 import android.net.Uri;                                                                                  </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  32 import android.os.Build;                                                                                 </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  33 import android.os.Build.VERSION;                                                                         </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  34 import android.preference.PreferenceManager;                                                             </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  35 import android.provider.ContactsContract.PhoneLookup;                                                    </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  36 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  37 import android.util.Log;                                                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  38 import android.util.TypedValue;                                                                          </span>
<span  style="">  39                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  40 import java.io.File;                                                                                     </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  41 import java.io.IOException;                                                                              </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  42 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  43 import java.util.List;                                                                                   </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  44 import java.util.Locale;                                                                                 </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  45 import java.util.Set;                                                                                    </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  46 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  47 import java.util.concurrent.locks.Lock;                                                                  </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  48 import java.util.concurrent.locks.ReentrantLock;                                                         </span>
<span  style="">  49                                                                                                          </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="">  50 import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                        </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  51 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  52 import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                           </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  53 import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                       </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  54 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                       </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  55 import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                          </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  56 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  57 import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                        </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                          </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                 </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  61 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span class="-2183458107255372167" onmouseenter="enter('-2183458107255372167');" onmouseout="out('-2183458107255372167');" style="">  62 import nodomain.freeyourgadget.gadgetbridge.util.AndroidUtils;                                           </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  63 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  64 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  65 import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  66 import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                           </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  67 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span  style="">  68                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  69 /**                                                                                                      </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  70  * Main Application class that initializes and provides access to certain things like                    </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  71  * logging and DB access.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  72  */                                                                                                      </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  73 public class GBApplication extends Application {                                                         </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  74     // Since this class must not log to slf4j, we use plain android.util.Log                             </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  75     private static final String TAG = &quot;GBApplication&quot;;                                                   </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  76     public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                           </span>
<span  style="">  77                                                                                                          </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  78     private static GBApplication context;                                                                </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  79     private static final Lock dbLock = new ReentrantLock();                                              </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  80     private static DeviceService deviceService;                                                          </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  81     private static SharedPreferences sharedPrefs;                                                        </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  82     private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                            </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  83     //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  83     //if preferences have to be migrated, increment the following and add the migration logic in migratePðŸ”µ</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  84     private static final int CURRENT_PREFS_VERSION = 2;                                                  </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  85     private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                  </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  86     private static Prefs prefs;                                                                          </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  87     private static GBPrefs gbPrefs;                                                                      </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  88     private static LockHandler lockHandler;                                                              </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  89     /**                                                                                                  </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  90      * Note: is null on Lollipop and Kitkat                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  91      */                                                                                                  </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  92     private static NotificationManager notificationManager;                                              </span>
<span  style="">  93                                                                                                          </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style="">  94     public static final String ACTION_QUIT                                                               </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style="">  95             = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                          </span>
<span class="3620791290214227219" onmouseenter="enter('3620791290214227219');" onmouseout="out('3620791290214227219');" style=""><abbr title="  96     public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.language_change&quot;;">  96     public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplicatiðŸ”µ</abbr></span>
<span  style="">  97                                                                                                          </span>
<span class="-6827183296325807512" onmouseenter="enter('-6827183296325807512');" onmouseout="out('-6827183296325807512');" style="">  98     private static GBApplication app;                                                                    </span>
<span  style="">  99                                                                                                          </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style=""> 100     private static Logging logging = new Logging() {                                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 101         @Override                                                                                        </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style=""> 102         protected String createLogDirectory() throws IOException {                                       </span>
<span class="9110710162536643525" onmouseenter="enter('9110710162536643525');" onmouseout="out('9110710162536643525');" style=""> 103             if (GBEnvironment.env().isLocalTest()) {                                                     </span>
<span class="-6519269446490050835" onmouseenter="enter('-6519269446490050835');" onmouseout="out('-6519269446490050835');" style=""> 104                 return System.getProperty(Logging.PROP_LOGFILES_DIR);                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 105             } else {                                                                                     </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style=""> 106                 File dir = FileUtils.getExternalFilesDir();                                              </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style=""> 107                 return dir.getAbsolutePath();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 110     };                                                                                                   </span>
<span class="-466220917116319233" onmouseenter="enter('-466220917116319233');" onmouseout="out('-466220917116319233');" style=""> 111     private static Locale language;                                                                      </span>
<span  style=""> 112                                                                                                          </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 113     private DeviceManager deviceManager;                                                                 </span>
<span  style=""> 114                                                                                                          </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 115     public static void quit() {                                                                          </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 116         GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                               </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 117         Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                       </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 118         LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                            </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 119         GBApplication.deviceService().quit();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120     }                                                                                                    </span>
<span  style=""> 121                                                                                                          </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 122     public GBApplication() {                                                                             </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 123         context = this;                                                                                  </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 124         // don&#x27;t do anything here, add it to onCreate instead                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="7323683286886200939" onmouseenter="enter('7323683286886200939');" onmouseout="out('7323683286886200939');" style=""> 127     public static Logging getLogging() {                                                                 </span>
<span class="3757797739027293534" onmouseenter="enter('3757797739027293534');" onmouseout="out('3757797739027293534');" style=""> 128         return logging;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129     }                                                                                                    </span>
<span  style=""> 130                                                                                                          </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 131     protected DeviceService createDeviceService() {                                                      </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 132         return new GBDeviceService(this);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133     }                                                                                                    </span>
<span  style=""> 134                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 135     @Override                                                                                            </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 136     public void onCreate() {                                                                             </span>
<span class="-8156783544820381420" onmouseenter="enter('-8156783544820381420');" onmouseout="out('-8156783544820381420');" style=""> 137         app = this;                                                                                      </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 138         super.onCreate();                                                                                </span>
<span  style=""> 139                                                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 140         if (lockHandler != null) {                                                                       </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 141             // guard against multiple invocations (robolectric)                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 142             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143         }                                                                                                </span>
<span  style=""> 144                                                                                                          </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 145         sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                            </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 146         prefs = new Prefs(sharedPrefs);                                                                  </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 147         gbPrefs = new GBPrefs(prefs);                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="-7675320667911398446" onmouseenter="enter('-7675320667911398446');" onmouseout="out('-7675320667911398446');" style=""> 149         if (!GBEnvironment.isEnvironmentSetup()) {                                                       </span>
<span class="-2266666929574149874" onmouseenter="enter('-2266666929574149874');" onmouseout="out('-2266666929574149874');" style=""> 150             GBEnvironment.setupEnvironment(GBEnvironment.createDeviceEnvironment());                     </span>
<span class="-3738634480535142994" onmouseenter="enter('-3738634480535142994');" onmouseout="out('-3738634480535142994');" style=""> 151             // setup db after the environment is set up, but don&#x27;t do it in test mode                    </span>
<span class="5829052537828666407" onmouseenter="enter('5829052537828666407');" onmouseout="out('5829052537828666407');" style=""> 152             // in test mode, it&#x27;s done individually, see TestBase                                        </span>
<span class="5177995110342670479" onmouseenter="enter('5177995110342670479');" onmouseout="out('5177995110342670479');" style=""> 153             setupDatabase();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154         }                                                                                                </span>
<span  style=""> 155                                                                                                          </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 156         // don&#x27;t do anything here before we set up logging, otherwise                                    </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 157         // slf4j may be implicitly initialized before we properly configured it.                         </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 158         setupLogging(isFileLoggingEnabled());                                                            </span>
<span  style=""> 159                                                                                                          </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 160         if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                            </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 161             migratePrefs(getPrefsFileVersion());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162         }                                                                                                </span>
<span  style=""> 163                                                                                                          </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 164         setupExceptionHandler();                                                                         </span>
<span  style=""> 165                                                                                                          </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 166         deviceManager = new DeviceManager(this);                                                         </span>
<span class="5344675729095119335" onmouseenter="enter('5344675729095119335');" onmouseout="out('5344675729095119335');" style=""> 167         String language = prefs.getString(&quot;language&quot;, &quot;default&quot;);                                        </span>
<span class="-4352228919314969984" onmouseenter="enter('-4352228919314969984');" onmouseout="out('-4352228919314969984');" style=""> 168         setLanguage(language);                                                                           </span>
<span  style=""> 169                                                                                                          </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style=""> 170         createWebViewActivity();                                                                         </span>
<span  style=""> 171                                                                                                          </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 172         deviceService = createDeviceService();                                                           </span>
<span class="-7443536723725935642" onmouseenter="enter('-7443536723725935642');" onmouseout="out('-7443536723725935642');" style=""> 173         loadAppsBlackList();                                                                             </span>
<span class="-5451989795140418224" onmouseenter="enter('-5451989795140418224');" onmouseout="out('-5451989795140418224');" style=""> 174         loadCalendarsBlackList();                                                                        </span>
<span  style=""> 175                                                                                                          </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 176         if (isRunningMarshmallowOrLater()) {                                                             </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""><abbr title=" 177             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);"> 177             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERðŸ”µ</abbr></span>
<span class="-3292367781642785183" onmouseenter="enter('-3292367781642785183');" onmouseout="out('-3292367781642785183');" style=""> 178             //the following will ensure the notification manager is kept alive                           </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 179             startService(new Intent(this, NotificationCollectorMonitorService.class));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181     }                                                                                                    </span>
<span  style=""> 182                                                                                                          </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style=""> 183     private void createWebViewActivity() {                                                               </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style=""> 184         if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                   </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style=""> 185             Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                   </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style=""> 186             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                              </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style=""> 187             startActivity(intent);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 191     @Override                                                                                            </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 192     public void onTrimMemory(int level) {                                                                </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 193         super.onTrimMemory(level);                                                                       </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 194         if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                           </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 195             if (!hasBusyDevice()) {                                                                      </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 196                 DBHelper.clearSession();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 201     /**                                                                                                  </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 202      * Returns true if at least a single device is busy, e.g synchronizing activity data                 </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 203      * or something similar.                                                                             </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 204      * Note: busy is not the same as connected or initialized!                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 205      */                                                                                                  </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 206     private boolean hasBusyDevice() {                                                                    </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 207         List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                        </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 208         for (GBDevice device : devices) {                                                                </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 209             if (device.isBusy()) {                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 210                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 213         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214     }                                                                                                    </span>
<span  style=""> 215                                                                                                          </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 216     public static void setupLogging(boolean enabled) {                                                   </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 217         logging.setupLogging(enabled);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 220     private void setupExceptionHandler() {                                                               </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 221         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 221         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHðŸ”µ</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 222         Thread.setDefaultUncaughtExceptionHandler(handler);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223     }                                                                                                    </span>
<span  style=""> 224                                                                                                          </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 225     public static boolean isFileLoggingEnabled() {                                                       </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 226         return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227     }                                                                                                    </span>
<span  style=""> 228                                                                                                          </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 229     public static boolean minimizeNotification() {                                                       </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 230         return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231     }                                                                                                    </span>
<span  style=""> 232                                                                                                          </span>
<span class="3584575502170839042" onmouseenter="enter('3584575502170839042');" onmouseout="out('3584575502170839042');" style=""> 233     public void setupDatabase() {                                                                        </span>
<span class="-3757253101115813818" onmouseenter="enter('-3757253101115813818');" onmouseout="out('-3757253101115813818');" style=""> 234         DaoMaster.OpenHelper helper;                                                                     </span>
<span class="9128810292226701201" onmouseenter="enter('9128810292226701201');" onmouseout="out('9128810292226701201');" style=""> 235         GBEnvironment env = GBEnvironment.env();                                                         </span>
<span class="7076376602711179030" onmouseenter="enter('7076376602711179030');" onmouseout="out('7076376602711179030');" style=""> 236         if (env.isTest()) {                                                                              </span>
<span class="-4283816386875317195" onmouseenter="enter('-4283816386875317195');" onmouseout="out('-4283816386875317195');" style=""> 237             helper = new DaoMaster.DevOpenHelper(this, null, null);                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 238         } else {                                                                                         </span>
<span class="4579041963248283587" onmouseenter="enter('4579041963248283587');" onmouseout="out('4579041963248283587');" style=""> 239             helper = new DBOpenHelper(this, DATABASE_NAME, null);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240         }                                                                                                </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 241         SQLiteDatabase db = helper.getWritableDatabase();                                                </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 242         DaoMaster daoMaster = new DaoMaster(db);                                                         </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 243         if (lockHandler == null) {                                                                       </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 244             lockHandler = new LockHandler();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245         }                                                                                                </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 246         lockHandler.init(daoMaster, helper);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247     }                                                                                                    </span>
<span  style=""> 248                                                                                                          </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 249     public static Context getContext() {                                                                 </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 250         return context;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251     }                                                                                                    </span>
<span  style=""> 252                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 253     /**                                                                                                  </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 254      * Returns the facade for talking to devices. Devices are managed by                                 </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 255      * an Android Service and this facade provides access to its functionality.                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 256      *                                                                                                   </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 257      * @return the facade for talking to the service/devices.                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 258      */                                                                                                  </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 259     public static DeviceService deviceService() {                                                        </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 260         return deviceService;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261     }                                                                                                    </span>
<span  style=""> 262                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 263     /**                                                                                                  </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 264      * Returns the DBHandler instance for reading/writing or throws GBException                          </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 265      * when that was not successful                                                                      </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 266      * If acquiring was successful, callers must call #releaseDB when they                               </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 267      * are done (from the same thread that acquired the lock!                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 268      * &lt;p&gt;                                                                                               </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 269      * Callers must not hold a reference to the returned instance because it                             </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 270      * will be invalidated at some point.                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 271      *                                                                                                   </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 272      * @return the DBHandler                                                                             </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 273      * @throws GBException                                                                               </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 274      * @see #releaseDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 275      */                                                                                                  </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 276     public static DBHandler acquireDB() throws GBException {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 277         try {                                                                                            </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 278             if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                  </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 279                 return lockHandler;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280             }                                                                                            </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 281         } catch (InterruptedException ex) {                                                              </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 282             Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283         }                                                                                                </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 284         throw new GBException(&quot;Unable to access the database.&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285     }                                                                                                    </span>
<span  style=""> 286                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 287     /**                                                                                                  </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 288      * Releases the database lock.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 289      *                                                                                                   </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 290      * @throws IllegalMonitorStateException if the current thread is not owning the lock                 </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 291      * @see #acquireDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 292      */                                                                                                  </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 293     public static void releaseDB() {                                                                     </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 294         dbLock.unlock();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295     }                                                                                                    </span>
<span  style=""> 296                                                                                                          </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 297     public static boolean isRunningLollipopOrLater() {                                                   </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 298         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299     }                                                                                                    </span>
<span  style=""> 300                                                                                                          </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 301     public static boolean isRunningMarshmallowOrLater() {                                                </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 302         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303     }                                                                                                    </span>
<span  style=""> 304                                                                                                          </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 305     private static boolean isPrioritySender(int prioritySenders, String number) {                        </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 306         if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 307             return true;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 308         } else {                                                                                         </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 309             Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));          </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 310             String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                    </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 311             Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);       </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 312             boolean exists = false;                                                                      </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 313             int starred = 0;                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 314             try {                                                                                        </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 315                 if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                            </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 316                     exists = true;                                                                       </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 317                     starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318                 }                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 319             } finally {                                                                                  </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 320                 if (cursor != null) {                                                                    </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 321                     cursor.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323             }                                                                                            </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 324             if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 325                 return true;                                                                             </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 326             } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 327                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328             }                                                                                            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 329             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331     }                                                                                                    </span>
<span  style=""> 332                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 333     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 334     public static boolean isPriorityNumber(int priorityType, String number) {                            </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 335         NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();     </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 336         if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                         </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 337             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 337             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIðŸ”µ</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 338                 return isPrioritySender(notificationPolicy.priorityMessageSenders, number);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339             }                                                                                            </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 340         } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                     </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 341             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 341             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORIðŸ”µ</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 342                 return isPrioritySender(notificationPolicy.priorityCallSenders, number);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 344         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 345         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346     }                                                                                                    </span>
<span  style=""> 347                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 348     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 349     public static int getGrantedInterruptionFilter() {                                                   </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""><abbr title=" 350         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {"> 350         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()ðŸ”µ</abbr></span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 351             if (notificationManager.isNotificationPolicyAccessGranted()) {                               </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 352                 return notificationManager.getCurrentInterruptionFilter();                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354         }                                                                                                </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 355         return NotificationManager.INTERRUPTION_FILTER_ALL;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356     }                                                                                                    </span>
<span  style=""> 357                                                                                                          </span>
<span class="-9029891236967858826" onmouseenter="enter('-9029891236967858826');" onmouseout="out('-9029891236967858826');" style=""> 358     private static HashSet&lt;String&gt; apps_blacklist = null;                                                </span>
<span  style=""> 359                                                                                                          </span>
<span class="628937876596348808" onmouseenter="enter('628937876596348808');" onmouseout="out('628937876596348808');" style=""> 360     public static boolean appIsBlacklisted(String packageName) {                                         </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 361         if (apps_blacklist == null) {                                                                    </span>
<span class="-1946294913030942780" onmouseenter="enter('-1946294913030942780');" onmouseout="out('-1946294913030942780');" style=""> 362             GB.log(&quot;appIsBlacklisted: apps_blacklist is null!&quot;, GB.INFO, null);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363         }                                                                                                </span>
<span class="1884921446555776787" onmouseenter="enter('1884921446555776787');" onmouseout="out('1884921446555776787');" style=""> 364         return apps_blacklist != null &amp;&amp; apps_blacklist.contains(packageName);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365     }                                                                                                    </span>
<span  style=""> 366                                                                                                          </span>
<span class="7953897085511400770" onmouseenter="enter('7953897085511400770');" onmouseout="out('7953897085511400770');" style=""> 367     public static void setAppsBlackList(Set&lt;String&gt; packageNames) {                                      </span>
<span class="-8197290468385298169" onmouseenter="enter('-8197290468385298169');" onmouseout="out('-8197290468385298169');" style=""> 368         if (packageNames == null) {                                                                      </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 369             GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 370             apps_blacklist = new HashSet&lt;&gt;();                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 371         } else {                                                                                         </span>
<span class="-3015046103246507563" onmouseenter="enter('-3015046103246507563');" onmouseout="out('-3015046103246507563');" style=""> 372             apps_blacklist = new HashSet&lt;&gt;(packageNames);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373         }                                                                                                </span>
<span class="7291510234597289182" onmouseenter="enter('7291510234597289182');" onmouseout="out('7291510234597289182');" style=""> 374         GB.log(&quot;New apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);           </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 375         saveAppsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 376     }                                                                                                    </span>
<span  style=""> 377                                                                                                          </span>
<span class="-4764637370834062607" onmouseenter="enter('-4764637370834062607');" onmouseout="out('-4764637370834062607');" style=""> 378     private static void loadAppsBlackList() {                                                            </span>
<span class="-7366183400676760194" onmouseenter="enter('-7366183400676760194');" onmouseout="out('-7366183400676760194');" style=""> 379         GB.log(&quot;Loading apps_blacklist&quot;, GB.INFO, null);                                                 </span>
<span class="-1377772229847163824" onmouseenter="enter('-1377772229847163824');" onmouseout="out('-1377772229847163824');" style=""> 380         apps_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.PACKAGE_BLACKLIST, null);    </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 381         if (apps_blacklist == null) {                                                                    </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 382             apps_blacklist = new HashSet&lt;&gt;();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383         }                                                                                                </span>
<span class="-1532140920596176818" onmouseenter="enter('-1532140920596176818');" onmouseout="out('-1532140920596176818');" style=""> 384         GB.log(&quot;Loaded apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385     }                                                                                                    </span>
<span  style=""> 386                                                                                                          </span>
<span class="6267616075496604119" onmouseenter="enter('6267616075496604119');" onmouseout="out('6267616075496604119');" style=""> 387     private static void saveAppsBlackList() {                                                            </span>
<span class="2886231841558584460" onmouseenter="enter('2886231841558584460');" onmouseout="out('2886231841558584460');" style=""> 388         GB.log(&quot;Saving apps_blacklist with &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);       </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 389         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-7981649915035584664" onmouseenter="enter('-7981649915035584664');" onmouseout="out('-7981649915035584664');" style=""> 390         if (apps_blacklist.isEmpty()) {                                                                  </span>
<span class="-7815879823137819644" onmouseenter="enter('-7815879823137819644');" onmouseout="out('-7815879823137819644');" style=""> 391             editor.putStringSet(GBPrefs.PACKAGE_BLACKLIST, null);                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 392         } else {                                                                                         </span>
<span class="-85230520183976524" onmouseenter="enter('-85230520183976524');" onmouseout="out('-85230520183976524');" style=""> 393             Prefs.putStringSet(editor, GBPrefs.PACKAGE_BLACKLIST, apps_blacklist);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 395         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396     }                                                                                                    </span>
<span  style=""> 397                                                                                                          </span>
<span class="3406803570609530272" onmouseenter="enter('3406803570609530272');" onmouseout="out('3406803570609530272');" style=""> 398     public static void addAppToBlacklist(String packageName) {                                           </span>
<span class="-4613377587158803622" onmouseenter="enter('-4613377587158803622');" onmouseout="out('-4613377587158803622');" style=""> 399         if (apps_blacklist.add(packageName)) {                                                           </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 400             saveAppsBlackList();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402     }                                                                                                    </span>
<span  style=""> 403                                                                                                          </span>
<span class="6341305090216699567" onmouseenter="enter('6341305090216699567');" onmouseout="out('6341305090216699567');" style=""> 404     public static synchronized void removeFromAppsBlacklist(String packageName) {                        </span>
<span class="6848681783835366738" onmouseenter="enter('6848681783835366738');" onmouseout="out('6848681783835366738');" style=""> 405         GB.log(&quot;Removing from apps_blacklist: &quot; + packageName, GB.INFO, null);                           </span>
<span class="1898542166501963208" onmouseenter="enter('1898542166501963208');" onmouseout="out('1898542166501963208');" style=""> 406         apps_blacklist.remove(packageName);                                                              </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 407         saveAppsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408     }                                                                                                    </span>
<span  style=""> 409                                                                                                          </span>
<span class="-1625652503048685789" onmouseenter="enter('-1625652503048685789');" onmouseout="out('-1625652503048685789');" style=""> 410     private static HashSet&lt;String&gt; calendars_blacklist = null;                                           </span>
<span  style=""> 411                                                                                                          </span>
<span class="7038688512705390946" onmouseenter="enter('7038688512705390946');" onmouseout="out('7038688512705390946');" style=""> 412     public static boolean calendarIsBlacklisted(String calendarDisplayName) {                            </span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 413         if (calendars_blacklist == null) {                                                               </span>
<span class="2679978338359393788" onmouseenter="enter('2679978338359393788');" onmouseout="out('2679978338359393788');" style=""> 414             GB.log(&quot;calendarIsBlacklisted: calendars_blacklist is null!&quot;, GB.INFO, null);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415         }                                                                                                </span>
<span class="-6083844107851171159" onmouseenter="enter('-6083844107851171159');" onmouseout="out('-6083844107851171159');" style=""> 416         return calendars_blacklist != null &amp;&amp; calendars_blacklist.contains(calendarDisplayName);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417     }                                                                                                    </span>
<span  style=""> 418                                                                                                          </span>
<span class="-1203782580073493681" onmouseenter="enter('-1203782580073493681');" onmouseout="out('-1203782580073493681');" style=""> 419     public static void setCalendarsBlackList(Set&lt;String&gt; calendarNames) {                                </span>
<span class="9006806600947611848" onmouseenter="enter('9006806600947611848');" onmouseout="out('9006806600947611848');" style=""> 420         if (calendarNames == null) {                                                                     </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 421             GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 422             calendars_blacklist = new HashSet&lt;&gt;();                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 423         } else {                                                                                         </span>
<span class="-5832993308357266278" onmouseenter="enter('-5832993308357266278');" onmouseout="out('-5832993308357266278');" style=""> 424             calendars_blacklist = new HashSet&lt;&gt;(calendarNames);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425         }                                                                                                </span>
<span class="-2685264550992926452" onmouseenter="enter('-2685264550992926452');" onmouseout="out('-2685264550992926452');" style=""> 426         GB.log(&quot;New calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null); </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 427         saveCalendarsBlackList();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428     }                                                                                                    </span>
<span  style=""> 429                                                                                                          </span>
<span class="-1352938694099643130" onmouseenter="enter('-1352938694099643130');" onmouseout="out('-1352938694099643130');" style=""> 430     public static void addCalendarToBlacklist(String calendarDisplayName) {                              </span>
<span class="5135070223261002446" onmouseenter="enter('5135070223261002446');" onmouseout="out('5135070223261002446');" style=""> 431         if (calendars_blacklist.add(calendarDisplayName)) {                                              </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 432             saveCalendarsBlackList();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434     }                                                                                                    </span>
<span  style=""> 435                                                                                                          </span>
<span class="-4191679597070541210" onmouseenter="enter('-4191679597070541210');" onmouseout="out('-4191679597070541210');" style=""> 436     public static void removeFromCalendarBlacklist(String calendarDisplayName) {                         </span>
<span class="-3543064320447564137" onmouseenter="enter('-3543064320447564137');" onmouseout="out('-3543064320447564137');" style=""> 437         calendars_blacklist.remove(calendarDisplayName);                                                 </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 438         saveCalendarsBlackList();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439     }                                                                                                    </span>
<span  style=""> 440                                                                                                          </span>
<span class="8449352248946474476" onmouseenter="enter('8449352248946474476');" onmouseout="out('8449352248946474476');" style=""> 441     private static void loadCalendarsBlackList() {                                                       </span>
<span class="929362169649938726" onmouseenter="enter('929362169649938726');" onmouseout="out('929362169649938726');" style=""> 442         GB.log(&quot;Loading calendars_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="-3197959776357605547" onmouseenter="enter('-3197959776357605547');" onmouseout="out('-3197959776357605547');" style=""><abbr title=" 443         calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, null);"> 443         calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, nullðŸ”µ</abbr></span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 444         if (calendars_blacklist == null) {                                                               </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 445             calendars_blacklist = new HashSet&lt;&gt;();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446         }                                                                                                </span>
<span class="-7148420027100342883" onmouseenter="enter('-7148420027100342883');" onmouseout="out('-7148420027100342883');" style=""><abbr title=" 447         GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);"> 447         GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, nullðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448     }                                                                                                    </span>
<span  style=""> 449                                                                                                          </span>
<span class="2309319604958063821" onmouseenter="enter('2309319604958063821');" onmouseout="out('2309319604958063821');" style=""> 450     private static void saveCalendarsBlackList() {                                                       </span>
<span class="5173264045101766520" onmouseenter="enter('5173264045101766520');" onmouseout="out('5173264045101766520');" style=""><abbr title=" 451         GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);"> 451         GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, nulðŸ”µ</abbr></span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 452         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-7491519725598434790" onmouseenter="enter('-7491519725598434790');" onmouseout="out('-7491519725598434790');" style=""> 453         if (calendars_blacklist.isEmpty()) {                                                             </span>
<span class="4243111498727581039" onmouseenter="enter('4243111498727581039');" onmouseout="out('4243111498727581039');" style=""> 454             editor.putStringSet(GBPrefs.CALENDAR_BLACKLIST, null);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 455         } else {                                                                                         </span>
<span class="-2454412986410082716" onmouseenter="enter('-2454412986410082716');" onmouseout="out('-2454412986410082716');" style=""> 456             Prefs.putStringSet(editor, GBPrefs.CALENDAR_BLACKLIST, calendars_blacklist);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 458         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459     }                                                                                                    </span>
<span  style=""> 460                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 461     /**                                                                                                  </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 462      * Deletes both the old Activity database and the new one recreates it with empty tables.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 463      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 464      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 465      */                                                                                                  </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 466     public static synchronized boolean deleteActivityDatabase(Context context) {                         </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 467         // TODO: flush, close, reopen db                                                                 </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 468         if (lockHandler != null) {                                                                       </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 469             lockHandler.closeDb();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470         }                                                                                                </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 471         boolean result = deleteOldActivityDatabase(context);                                             </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 472         result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                            </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 473         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474     }                                                                                                    </span>
<span  style=""> 475                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 476     /**                                                                                                  </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 477      * Deletes the legacy (pre 0.12) Activity database                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 478      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 479      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 480      */                                                                                                  </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 481     public static synchronized boolean deleteOldActivityDatabase(Context context) {                      </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 482         DBHelper dbHelper = new DBHelper(context);                                                       </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 483         boolean result = true;                                                                           </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 484         if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                     </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 485             result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486         }                                                                                                </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 487         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488     }                                                                                                    </span>
<span  style=""> 489                                                                                                          </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 490     private int getPrefsFileVersion() {                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 491         try {                                                                                            </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 492             return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 493         } catch (Exception e) {                                                                          </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 494             //in version 1 this was an int                                                               </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 495             return 1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 497     }                                                                                                    </span>
<span  style=""> 498                                                                                                          </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 499     private void migratePrefs(int oldVersion) {                                                          </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 500         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 501         switch (oldVersion) {                                                                            </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 502             case 0:                                                                                      </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 503                 String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                     </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 504                 String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                  </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 505                 String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                  </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 506                 String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                 </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 507                 if (legacyGender != null) {                                                              </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 508                     int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;</span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 509                     editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));           </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 510                     editor.remove(&quot;mi_user_gender&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511                 }                                                                                        </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 512                 if (legacyHeight != null) {                                                              </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 513                     editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                    </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 514                     editor.remove(&quot;mi_user_height_cm&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 515                 }                                                                                        </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 516                 if (legacyWeigth != null) {                                                              </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 517                     editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                    </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 518                     editor.remove(&quot;mi_user_weight_kg&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519                 }                                                                                        </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 520                 if (legacyYOB != null) {                                                                 </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 521                     editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                   </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 522                     editor.remove(&quot;mi_user_year_of_birth&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523                 }                                                                                        </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 524                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 525                 break;                                                                                   </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 526             case 1:                                                                                      </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 527                 //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 527                 //migrate the integer version of gender introduced in version 1 to a string value, neededðŸ”µ</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 528                 int legacyGender_1 = 2;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 529                 try {                                                                                    </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 530                     legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 531                 } catch (Exception e) {                                                                  </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 532                     Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 533                 }                                                                                        </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 534                 editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));       </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 535                 //also silently migrate the version to a string value                                    </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 536                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 537                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 539         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540     }                                                                                                    </span>
<span  style=""> 541                                                                                                          </span>
<span class="-3847609959270330161" onmouseenter="enter('-3847609959270330161');" onmouseout="out('-3847609959270330161');" style=""> 542     public static void setLanguage(String lang) {                                                        </span>
<span class="2010165672364354755" onmouseenter="enter('2010165672364354755');" onmouseout="out('2010165672364354755');" style=""> 543         if (lang.equals(&quot;default&quot;)) {                                                                    </span>
<span class="-1084003509567751492" onmouseenter="enter('-1084003509567751492');" onmouseout="out('-1084003509567751492');" style=""> 544             language = Resources.getSystem().getConfiguration().locale;                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 545         } else {                                                                                         </span>
<span class="-1687880958280815140" onmouseenter="enter('-1687880958280815140');" onmouseout="out('-1687880958280815140');" style=""> 546             language = new Locale(lang);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547         }                                                                                                </span>
<span class="-6135042183655095886" onmouseenter="enter('-6135042183655095886');" onmouseout="out('-6135042183655095886');" style=""> 548         updateLanguage(language);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549     }                                                                                                    </span>
<span  style=""> 550                                                                                                          </span>
<span class="5259621038207386847" onmouseenter="enter('5259621038207386847');" onmouseout="out('5259621038207386847');" style=""> 551     public static void updateLanguage(Locale locale) {                                                   </span>
<span class="1109198243690318720" onmouseenter="enter('1109198243690318720');" onmouseout="out('1109198243690318720');" style=""> 552         AndroidUtils.setLanguage(context, locale);                                                       </span>
<span  style=""> 553                                                                                                          </span>
<span class="535862575394010177" onmouseenter="enter('535862575394010177');" onmouseout="out('535862575394010177');" style=""> 554         Intent intent = new Intent();                                                                    </span>
<span class="-164638367863943974" onmouseenter="enter('-164638367863943974');" onmouseout="out('-164638367863943974');" style=""> 555         intent.setAction(ACTION_LANGUAGE_CHANGE);                                                        </span>
<span class="4843300360101524365" onmouseenter="enter('4843300360101524365');" onmouseout="out('4843300360101524365');" style=""> 556         LocalBroadcastManager.getInstance(context).sendBroadcast(intent);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 557     }                                                                                                    </span>
<span  style=""> 558                                                                                                          </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 559     public static LimitedQueue getIDSenderLookup() {                                                     </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 560         return mIDSenderLookup;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 561     }                                                                                                    </span>
<span  style=""> 562                                                                                                          </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 563     public static boolean isDarkThemeEnabled() {                                                         </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 564         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 564         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 565     }                                                                                                    </span>
<span  style=""> 566                                                                                                          </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 567     public static int getTextColor(Context context) {                                                    </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 568         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 569         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 570         theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                               </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 571         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 572     }                                                                                                    </span>
<span  style=""> 573                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 574     @Override                                                                                            </span>
<span class="2483214837331013305" onmouseenter="enter('2483214837331013305');" onmouseout="out('2483214837331013305');" style=""> 575     public void onConfigurationChanged(Configuration newConfig) {                                        </span>
<span class="-1478537389163372238" onmouseenter="enter('-1478537389163372238');" onmouseout="out('-1478537389163372238');" style=""> 576         super.onConfigurationChanged(newConfig);                                                         </span>
<span class="2223384074430921263" onmouseenter="enter('2223384074430921263');" onmouseout="out('2223384074430921263');" style=""> 577         updateLanguage(getLanguage());                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578     }                                                                                                    </span>
<span  style=""> 579                                                                                                          </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 580     public static int getBackgroundColor(Context context) {                                              </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 581         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 582         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 583         theme.resolveAttribute(android.R.attr.background, typedValue, true);                             </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 584         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585     }                                                                                                    </span>
<span  style=""> 586                                                                                                          </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 587     public static Prefs getPrefs() {                                                                     </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 588         return prefs;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589     }                                                                                                    </span>
<span  style=""> 590                                                                                                          </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 591     public static GBPrefs getGBPrefs() {                                                                 </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 592         return gbPrefs;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593     }                                                                                                    </span>
<span  style=""> 594                                                                                                          </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 595     public DeviceManager getDeviceManager() {                                                            </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 596         return deviceManager;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597     }                                                                                                    </span>
<span  style=""> 598                                                                                                          </span>
<span class="-1673519419532841409" onmouseenter="enter('-1673519419532841409');" onmouseout="out('-1673519419532841409');" style=""> 599     public static GBApplication app() {                                                                  </span>
<span class="-5545492324510288114" onmouseenter="enter('-5545492324510288114');" onmouseout="out('-5545492324510288114');" style=""> 600         return app;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 601     }                                                                                                    </span>
<span  style=""> 602                                                                                                          </span>
<span class="4339444706683048648" onmouseenter="enter('4339444706683048648');" onmouseout="out('4339444706683048648');" style=""> 603     public static Locale getLanguage() {                                                                 </span>
<span class="8742914849630491523" onmouseenter="enter('8742914849630491523');" onmouseout="out('8742914849630491523');" style=""> 604         return language;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 605     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 606 }                                                                                                        </span>




</pre></td>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1 /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                 </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2     Gobbetti, Normano64                                                                                  </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18 package nodomain.freeyourgadget.gadgetbridge;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20 import android.annotation.TargetApi;                                                                     </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21 import android.app.Application;                                                                          </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  22 import android.app.NotificationManager.Policy;                                                           </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  23 import android.app.NotificationManager;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25 import android.content.Intent;                                                                           </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26 import android.content.SharedPreferences;                                                                </span>
<span class="-9179032954578521484" onmouseenter="enter('-9179032954578521484');" onmouseout="out('-9179032954578521484');" style="">  27 import android.content.res.Configuration;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  28 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  29 import android.database.Cursor;                                                                          </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  30 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  31 import android.net.Uri;                                                                                  </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  32 import android.os.Build.VERSION;                                                                         </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  33 import android.os.Build;                                                                                 </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  34 import android.preference.PreferenceManager;                                                             </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  35 import android.provider.ContactsContract.PhoneLookup;                                                    </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  36 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  37 import android.util.Log;                                                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  38 import android.util.TypedValue;                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  39 import java.io.File;                                                                                     </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  40 import java.io.IOException;                                                                              </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42 import java.util.List;                                                                                   </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  43 import java.util.Locale;                                                                                 </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  44 import java.util.Set;                                                                                    </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  45 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  46 import java.util.concurrent.locks.Lock;                                                                  </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  47 import java.util.concurrent.locks.ReentrantLock;                                                         </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="">  48 import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                        </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  49 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  50 import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                           </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  51 import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                       </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  52 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                       </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  53 import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                          </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  54 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  55 import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                        </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  56 import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                          </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  57 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                 </span>
<span class="-2183458107255372167" onmouseenter="enter('-2183458107255372167');" onmouseout="out('-2183458107255372167');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.util.AndroidUtils;                                           </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  61 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  62 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  63 import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  64 import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                           </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  65 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span  style="">  66                                                                                                          </span>
<span  style="">  67                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  68 /**                                                                                                      </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  69  * Main Application class that initializes and provides access to certain things like                    </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  70  * logging and DB access.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  71  */                                                                                                      </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  72 public class GBApplication extends Application {                                                         </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  73     // Since this class must not log to slf4j, we use plain android.util.Log                             </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  74     private static final String TAG = &quot;GBApplication&quot;;                                                   </span>
<span  style="">  75                                                                                                          </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  76     public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                           </span>
<span  style="">  77                                                                                                          </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  78     private static GBApplication context;                                                                </span>
<span  style="">  79                                                                                                          </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  80     private static final Lock dbLock = new ReentrantLock();                                              </span>
<span  style="">  81                                                                                                          </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  82     private static DeviceService deviceService;                                                          </span>
<span  style="">  83                                                                                                          </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  84     private static SharedPreferences sharedPrefs;                                                        </span>
<span  style="">  85                                                                                                          </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  86     private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                            </span>
<span  style="">  87                                                                                                          </span>
<span class="-7201596570557629566" onmouseenter="enter('-7201596570557629566');" onmouseout="out('-7201596570557629566');" style=""><abbr title="  88     // if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  88     // if preferences have to be migrated, increment the following and add the migration logic in migrateðŸ”µ</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  89     private static final int CURRENT_PREFS_VERSION = 2;                                                  </span>
<span  style="">  90                                                                                                          </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  91     private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                  </span>
<span  style="">  92                                                                                                          </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  93     private static Prefs prefs;                                                                          </span>
<span  style="">  94                                                                                                          </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  95     private static GBPrefs gbPrefs;                                                                      </span>
<span  style="">  96                                                                                                          </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  97     private static LockHandler lockHandler;                                                              </span>
<span  style="">  98                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  99     /**                                                                                                  </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style=""> 100      * Note: is null on Lollipop and Kitkat                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 101      */                                                                                                  </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style=""> 102     private static NotificationManager notificationManager;                                              </span>
<span  style=""> 103                                                                                                          </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style=""> 104     public static final String ACTION_QUIT                                                               </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style=""> 105             = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                          </span>
<span  style=""> 106                                                                                                          </span>
<span class="3620791290214227219" onmouseenter="enter('3620791290214227219');" onmouseout="out('3620791290214227219');" style=""><abbr title=" 107     public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.language_change&quot;;"> 107     public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplicatiðŸ”µ</abbr></span>
<span  style=""> 108                                                                                                          </span>
<span class="-6827183296325807512" onmouseenter="enter('-6827183296325807512');" onmouseout="out('-6827183296325807512');" style=""> 109     private static GBApplication app;                                                                    </span>
<span  style=""> 110                                                                                                          </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style=""> 111     private static Logging logging = new Logging() {                                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 112         @Override                                                                                        </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style=""> 113         protected String createLogDirectory() throws IOException {                                       </span>
<span class="9110710162536643525" onmouseenter="enter('9110710162536643525');" onmouseout="out('9110710162536643525');" style=""> 114             if (GBEnvironment.env().isLocalTest()) {                                                     </span>
<span class="-6519269446490050835" onmouseenter="enter('-6519269446490050835');" onmouseout="out('-6519269446490050835');" style=""> 115                 return System.getProperty(Logging.PROP_LOGFILES_DIR);                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 116             } else {                                                                                     </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style=""> 117                 File dir = FileUtils.getExternalFilesDir();                                              </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style=""> 118                 return dir.getAbsolutePath();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 121     };                                                                                                   </span>
<span  style=""> 122                                                                                                          </span>
<span class="-466220917116319233" onmouseenter="enter('-466220917116319233');" onmouseout="out('-466220917116319233');" style=""> 123     private static Locale language;                                                                      </span>
<span  style=""> 124                                                                                                          </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 125     private DeviceManager deviceManager;                                                                 </span>
<span  style=""> 126                                                                                                          </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 127     public static void quit() {                                                                          </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 128         GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                               </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 129         Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                       </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 130         LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                            </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 131         GBApplication.deviceService().quit();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132     }                                                                                                    </span>
<span  style=""> 133                                                                                                          </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 134     public GBApplication() {                                                                             </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 135         context = this;                                                                                  </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 136         // don&#x27;t do anything here, add it to onCreate instead                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137     }                                                                                                    </span>
<span  style=""> 138                                                                                                          </span>
<span class="7323683286886200939" onmouseenter="enter('7323683286886200939');" onmouseout="out('7323683286886200939');" style=""> 139     public static Logging getLogging() {                                                                 </span>
<span class="3757797739027293534" onmouseenter="enter('3757797739027293534');" onmouseout="out('3757797739027293534');" style=""> 140         return logging;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141     }                                                                                                    </span>
<span  style=""> 142                                                                                                          </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 143     protected DeviceService createDeviceService() {                                                      </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 144         return new GBDeviceService(this);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145     }                                                                                                    </span>
<span  style=""> 146                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 147     @Override                                                                                            </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 148     public void onCreate() {                                                                             </span>
<span class="-8156783544820381420" onmouseenter="enter('-8156783544820381420');" onmouseout="out('-8156783544820381420');" style=""> 149         app = this;                                                                                      </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 150         super.onCreate();                                                                                </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 151         if (lockHandler != null) {                                                                       </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 152             // guard against multiple invocations (robolectric)                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 153             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154         }                                                                                                </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 155         sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                            </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 156         prefs = new Prefs(sharedPrefs);                                                                  </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 157         gbPrefs = new GBPrefs(prefs);                                                                    </span>
<span class="-7675320667911398446" onmouseenter="enter('-7675320667911398446');" onmouseout="out('-7675320667911398446');" style=""> 158         if (!GBEnvironment.isEnvironmentSetup()) {                                                       </span>
<span class="-2266666929574149874" onmouseenter="enter('-2266666929574149874');" onmouseout="out('-2266666929574149874');" style=""> 159             GBEnvironment.setupEnvironment(GBEnvironment.createDeviceEnvironment());                     </span>
<span class="-3738634480535142994" onmouseenter="enter('-3738634480535142994');" onmouseout="out('-3738634480535142994');" style=""> 160             // setup db after the environment is set up, but don&#x27;t do it in test mode                    </span>
<span class="5829052537828666407" onmouseenter="enter('5829052537828666407');" onmouseout="out('5829052537828666407');" style=""> 161             // in test mode, it&#x27;s done individually, see TestBase                                        </span>
<span class="5177995110342670479" onmouseenter="enter('5177995110342670479');" onmouseout="out('5177995110342670479');" style=""> 162             setupDatabase();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163         }                                                                                                </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 164         // don&#x27;t do anything here before we set up logging, otherwise                                    </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 165         // slf4j may be implicitly initialized before we properly configured it.                         </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 166         setupLogging(isFileLoggingEnabled());                                                            </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 167         if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                            </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 168             migratePrefs(getPrefsFileVersion());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169         }                                                                                                </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 170         setupExceptionHandler();                                                                         </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 171         deviceManager = new DeviceManager(this);                                                         </span>
<span class="5344675729095119335" onmouseenter="enter('5344675729095119335');" onmouseout="out('5344675729095119335');" style=""> 172         String language = prefs.getString(&quot;language&quot;, &quot;default&quot;);                                        </span>
<span class="-4352228919314969984" onmouseenter="enter('-4352228919314969984');" onmouseout="out('-4352228919314969984');" style=""> 173         setLanguage(language);                                                                           </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style=""> 174         createWebViewActivity();                                                                         </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 175         deviceService = createDeviceService();                                                           </span>
<span class="-7443536723725935642" onmouseenter="enter('-7443536723725935642');" onmouseout="out('-7443536723725935642');" style=""> 176         loadAppsBlackList();                                                                             </span>
<span class="-5451989795140418224" onmouseenter="enter('-5451989795140418224');" onmouseout="out('-5451989795140418224');" style=""> 177         loadCalendarsBlackList();                                                                        </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 178         if (isRunningMarshmallowOrLater()) {                                                             </span>
<span class="-1786981645580945754" onmouseenter="enter('-1786981645580945754');" onmouseout="out('-1786981645580945754');" style=""><abbr title=" 179             notificationManager = ((NotificationManager) (context.getSystemService(Context.NOTIFICATION_SERVICE)));"> 179             notificationManager = ((NotificationManager) (context.getSystemService(Context.NOTIFICATION_SðŸ”µ</abbr></span>
<span class="8967845918777711559" onmouseenter="enter('8967845918777711559');" onmouseout="out('8967845918777711559');" style=""> 180             // the following will ensure the notification manager is kept alive                          </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 181             startService(new Intent(this, NotificationCollectorMonitorService.class));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style=""> 185     private void createWebViewActivity() {                                                               </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style=""> 186         if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                   </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style=""> 187             Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                   </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style=""> 188             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                              </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style=""> 189             startActivity(intent);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191     }                                                                                                    </span>
<span  style=""> 192                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 193     @Override                                                                                            </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 194     public void onTrimMemory(int level) {                                                                </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 195         super.onTrimMemory(level);                                                                       </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 196         if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                           </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 197             if (!hasBusyDevice()) {                                                                      </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 198                 DBHelper.clearSession();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201     }                                                                                                    </span>
<span  style=""> 202                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 203     /**                                                                                                  </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 204      * Returns true if at least a single device is busy, e.g synchronizing activity data                 </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 205      * or something similar.                                                                             </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 206      * Note: busy is not the same as connected or initialized!                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 207      */                                                                                                  </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 208     private boolean hasBusyDevice() {                                                                    </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 209         List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                        </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 210         for (GBDevice device : devices) {                                                                </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 211             if (device.isBusy()) {                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 212                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 215         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216     }                                                                                                    </span>
<span  style=""> 217                                                                                                          </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 218     public static void setupLogging(boolean enabled) {                                                   </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 219         logging.setupLogging(enabled);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220     }                                                                                                    </span>
<span  style=""> 221                                                                                                          </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 222     private void setupExceptionHandler() {                                                               </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 223         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 223         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHðŸ”µ</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 224         Thread.setDefaultUncaughtExceptionHandler(handler);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225     }                                                                                                    </span>
<span  style=""> 226                                                                                                          </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 227     public static boolean isFileLoggingEnabled() {                                                       </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 228         return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229     }                                                                                                    </span>
<span  style=""> 230                                                                                                          </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 231     public static boolean minimizeNotification() {                                                       </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 232         return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233     }                                                                                                    </span>
<span  style=""> 234                                                                                                          </span>
<span class="3584575502170839042" onmouseenter="enter('3584575502170839042');" onmouseout="out('3584575502170839042');" style=""> 235     public void setupDatabase() {                                                                        </span>
<span class="-3757253101115813818" onmouseenter="enter('-3757253101115813818');" onmouseout="out('-3757253101115813818');" style=""> 236         DaoMaster.OpenHelper helper;                                                                     </span>
<span class="9128810292226701201" onmouseenter="enter('9128810292226701201');" onmouseout="out('9128810292226701201');" style=""> 237         GBEnvironment env = GBEnvironment.env();                                                         </span>
<span class="7076376602711179030" onmouseenter="enter('7076376602711179030');" onmouseout="out('7076376602711179030');" style=""> 238         if (env.isTest()) {                                                                              </span>
<span class="-4283816386875317195" onmouseenter="enter('-4283816386875317195');" onmouseout="out('-4283816386875317195');" style=""> 239             helper = new DaoMaster.DevOpenHelper(this, null, null);                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 240         } else {                                                                                         </span>
<span class="4579041963248283587" onmouseenter="enter('4579041963248283587');" onmouseout="out('4579041963248283587');" style=""> 241             helper = new DBOpenHelper(this, DATABASE_NAME, null);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242         }                                                                                                </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 243         SQLiteDatabase db = helper.getWritableDatabase();                                                </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 244         DaoMaster daoMaster = new DaoMaster(db);                                                         </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 245         if (lockHandler == null) {                                                                       </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 246             lockHandler = new LockHandler();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247         }                                                                                                </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 248         lockHandler.init(daoMaster, helper);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249     }                                                                                                    </span>
<span  style=""> 250                                                                                                          </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 251     public static Context getContext() {                                                                 </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 252         return context;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253     }                                                                                                    </span>
<span  style=""> 254                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 255     /**                                                                                                  </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 256      * Returns the facade for talking to devices. Devices are managed by                                 </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 257      * an Android Service and this facade provides access to its functionality.                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 258      *                                                                                                   </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 259      * @return the facade for talking to the service/devices.                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 260      */                                                                                                  </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 261     public static DeviceService deviceService() {                                                        </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 262         return deviceService;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263     }                                                                                                    </span>
<span  style=""> 264                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 265     /**                                                                                                  </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 266      * Returns the DBHandler instance for reading/writing or throws GBException                          </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 267      * when that was not successful                                                                      </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 268      * If acquiring was successful, callers must call #releaseDB when they                               </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 269      * are done (from the same thread that acquired the lock!                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 270      * &lt;p&gt;                                                                                               </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 271      * Callers must not hold a reference to the returned instance because it                             </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 272      * will be invalidated at some point.                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 273      *                                                                                                   </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 274      * @return the DBHandler                                                                             </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 275      * @throws GBException                                                                               </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 276      * @see #releaseDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 277      */                                                                                                  </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 278     public static DBHandler acquireDB() throws GBException {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 279         try {                                                                                            </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 280             if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                  </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 281                 return lockHandler;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282             }                                                                                            </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 283         } catch (InterruptedException ex) {                                                              </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 284             Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285         }                                                                                                </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 286         throw new GBException(&quot;Unable to access the database.&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287     }                                                                                                    </span>
<span  style=""> 288                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 289     /**                                                                                                  </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 290      * Releases the database lock.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 291      *                                                                                                   </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 292      * @throws IllegalMonitorStateException if the current thread is not owning the lock                 </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 293      * @see #acquireDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 294      */                                                                                                  </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 295     public static void releaseDB() {                                                                     </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 296         dbLock.unlock();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297     }                                                                                                    </span>
<span  style=""> 298                                                                                                          </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 299     public static boolean isRunningLollipopOrLater() {                                                   </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 300         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 303     public static boolean isRunningMarshmallowOrLater() {                                                </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 304         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305     }                                                                                                    </span>
<span  style=""> 306                                                                                                          </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 307     private static boolean isPrioritySender(int prioritySenders, String number) {                        </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 308         if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 309             return true;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 310         } else {                                                                                         </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 311             Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));          </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 312             String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                    </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 313             Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);       </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 314             boolean exists = false;                                                                      </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 315             int starred = 0;                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 316             try {                                                                                        </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 317                 if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                            </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 318                     exists = true;                                                                       </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 319                     starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320                 }                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 321             } finally {                                                                                  </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 322                 if (cursor != null) {                                                                    </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 323                     cursor.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325             }                                                                                            </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 326             if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 327                 return true;                                                                             </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 328             } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 329                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330             }                                                                                            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 331             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333     }                                                                                                    </span>
<span  style=""> 334                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 335     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 336     public static boolean isPriorityNumber(int priorityType, String number) {                            </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 337         NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();     </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 338         if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                         </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 339             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 339             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIðŸ”µ</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 340                 return isPrioritySender(notificationPolicy.priorityMessageSenders, number);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341             }                                                                                            </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 342         } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                     </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 343             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 343             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORIðŸ”µ</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 344                 return isPrioritySender(notificationPolicy.priorityCallSenders, number);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 347         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348     }                                                                                                    </span>
<span  style=""> 349                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 350     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 351     public static int getGrantedInterruptionFilter() {                                                   </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""><abbr title=" 352         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {"> 352         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()ðŸ”µ</abbr></span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 353             if (notificationManager.isNotificationPolicyAccessGranted()) {                               </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 354                 return notificationManager.getCurrentInterruptionFilter();                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356         }                                                                                                </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 357         return NotificationManager.INTERRUPTION_FILTER_ALL;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358     }                                                                                                    </span>
<span  style=""> 359                                                                                                          </span>
<span class="-9029891236967858826" onmouseenter="enter('-9029891236967858826');" onmouseout="out('-9029891236967858826');" style=""> 360     private static HashSet&lt;String&gt; apps_blacklist = null;                                                </span>
<span  style=""> 361                                                                                                          </span>
<span class="628937876596348808" onmouseenter="enter('628937876596348808');" onmouseout="out('628937876596348808');" style=""> 362     public static boolean appIsBlacklisted(String packageName) {                                         </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 363         if (apps_blacklist == null) {                                                                    </span>
<span class="-1946294913030942780" onmouseenter="enter('-1946294913030942780');" onmouseout="out('-1946294913030942780');" style=""> 364             GB.log(&quot;appIsBlacklisted: apps_blacklist is null!&quot;, GB.INFO, null);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365         }                                                                                                </span>
<span class="1884921446555776787" onmouseenter="enter('1884921446555776787');" onmouseout="out('1884921446555776787');" style=""> 366         return apps_blacklist != null &amp;&amp; apps_blacklist.contains(packageName);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367     }                                                                                                    </span>
<span  style=""> 368                                                                                                          </span>
<span class="7953897085511400770" onmouseenter="enter('7953897085511400770');" onmouseout="out('7953897085511400770');" style=""> 369     public static void setAppsBlackList(Set&lt;String&gt; packageNames) {                                      </span>
<span class="-8197290468385298169" onmouseenter="enter('-8197290468385298169');" onmouseout="out('-8197290468385298169');" style=""> 370         if (packageNames == null) {                                                                      </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 371             GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 372             apps_blacklist = new HashSet&lt;&gt;();                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 373         } else {                                                                                         </span>
<span class="-3015046103246507563" onmouseenter="enter('-3015046103246507563');" onmouseout="out('-3015046103246507563');" style=""> 374             apps_blacklist = new HashSet&lt;&gt;(packageNames);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375         }                                                                                                </span>
<span class="7291510234597289182" onmouseenter="enter('7291510234597289182');" onmouseout="out('7291510234597289182');" style=""> 376         GB.log(&quot;New apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);           </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 377         saveAppsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378     }                                                                                                    </span>
<span  style=""> 379                                                                                                          </span>
<span class="-4764637370834062607" onmouseenter="enter('-4764637370834062607');" onmouseout="out('-4764637370834062607');" style=""> 380     private static void loadAppsBlackList() {                                                            </span>
<span class="-7366183400676760194" onmouseenter="enter('-7366183400676760194');" onmouseout="out('-7366183400676760194');" style=""> 381         GB.log(&quot;Loading apps_blacklist&quot;, GB.INFO, null);                                                 </span>
<span class="-1377772229847163824" onmouseenter="enter('-1377772229847163824');" onmouseout="out('-1377772229847163824');" style=""> 382         apps_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.PACKAGE_BLACKLIST, null);    </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 383         if (apps_blacklist == null) {                                                                    </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 384             apps_blacklist = new HashSet&lt;&gt;();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385         }                                                                                                </span>
<span class="-1532140920596176818" onmouseenter="enter('-1532140920596176818');" onmouseout="out('-1532140920596176818');" style=""> 386         GB.log(&quot;Loaded apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387     }                                                                                                    </span>
<span  style=""> 388                                                                                                          </span>
<span class="6267616075496604119" onmouseenter="enter('6267616075496604119');" onmouseout="out('6267616075496604119');" style=""> 389     private static void saveAppsBlackList() {                                                            </span>
<span class="2886231841558584460" onmouseenter="enter('2886231841558584460');" onmouseout="out('2886231841558584460');" style=""> 390         GB.log(&quot;Saving apps_blacklist with &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);       </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 391         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-7981649915035584664" onmouseenter="enter('-7981649915035584664');" onmouseout="out('-7981649915035584664');" style=""> 392         if (apps_blacklist.isEmpty()) {                                                                  </span>
<span class="-7815879823137819644" onmouseenter="enter('-7815879823137819644');" onmouseout="out('-7815879823137819644');" style=""> 393             editor.putStringSet(GBPrefs.PACKAGE_BLACKLIST, null);                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 394         } else {                                                                                         </span>
<span class="-85230520183976524" onmouseenter="enter('-85230520183976524');" onmouseout="out('-85230520183976524');" style=""> 395             Prefs.putStringSet(editor, GBPrefs.PACKAGE_BLACKLIST, apps_blacklist);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 397         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398     }                                                                                                    </span>
<span  style=""> 399                                                                                                          </span>
<span class="3406803570609530272" onmouseenter="enter('3406803570609530272');" onmouseout="out('3406803570609530272');" style=""> 400     public static void addAppToBlacklist(String packageName) {                                           </span>
<span class="-4613377587158803622" onmouseenter="enter('-4613377587158803622');" onmouseout="out('-4613377587158803622');" style=""> 401         if (apps_blacklist.add(packageName)) {                                                           </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 402             saveAppsBlackList();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404     }                                                                                                    </span>
<span  style=""> 405                                                                                                          </span>
<span class="6341305090216699567" onmouseenter="enter('6341305090216699567');" onmouseout="out('6341305090216699567');" style=""> 406     public static synchronized void removeFromAppsBlacklist(String packageName) {                        </span>
<span class="6848681783835366738" onmouseenter="enter('6848681783835366738');" onmouseout="out('6848681783835366738');" style=""> 407         GB.log(&quot;Removing from apps_blacklist: &quot; + packageName, GB.INFO, null);                           </span>
<span class="1898542166501963208" onmouseenter="enter('1898542166501963208');" onmouseout="out('1898542166501963208');" style=""> 408         apps_blacklist.remove(packageName);                                                              </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 409         saveAppsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410     }                                                                                                    </span>
<span  style=""> 411                                                                                                          </span>
<span class="-1625652503048685789" onmouseenter="enter('-1625652503048685789');" onmouseout="out('-1625652503048685789');" style=""> 412     private static HashSet&lt;String&gt; calendars_blacklist = null;                                           </span>
<span  style=""> 413                                                                                                          </span>
<span class="7038688512705390946" onmouseenter="enter('7038688512705390946');" onmouseout="out('7038688512705390946');" style=""> 414     public static boolean calendarIsBlacklisted(String calendarDisplayName) {                            </span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 415         if (calendars_blacklist == null) {                                                               </span>
<span class="2679978338359393788" onmouseenter="enter('2679978338359393788');" onmouseout="out('2679978338359393788');" style=""> 416             GB.log(&quot;calendarIsBlacklisted: calendars_blacklist is null!&quot;, GB.INFO, null);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417         }                                                                                                </span>
<span class="-6083844107851171159" onmouseenter="enter('-6083844107851171159');" onmouseout="out('-6083844107851171159');" style=""> 418         return calendars_blacklist != null &amp;&amp; calendars_blacklist.contains(calendarDisplayName);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419     }                                                                                                    </span>
<span  style=""> 420                                                                                                          </span>
<span class="-1203782580073493681" onmouseenter="enter('-1203782580073493681');" onmouseout="out('-1203782580073493681');" style=""> 421     public static void setCalendarsBlackList(Set&lt;String&gt; calendarNames) {                                </span>
<span class="9006806600947611848" onmouseenter="enter('9006806600947611848');" onmouseout="out('9006806600947611848');" style=""> 422         if (calendarNames == null) {                                                                     </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 423             GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 424             calendars_blacklist = new HashSet&lt;&gt;();                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 425         } else {                                                                                         </span>
<span class="-5832993308357266278" onmouseenter="enter('-5832993308357266278');" onmouseout="out('-5832993308357266278');" style=""> 426             calendars_blacklist = new HashSet&lt;&gt;(calendarNames);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427         }                                                                                                </span>
<span class="-2685264550992926452" onmouseenter="enter('-2685264550992926452');" onmouseout="out('-2685264550992926452');" style=""> 428         GB.log(&quot;New calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null); </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 429         saveCalendarsBlackList();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430     }                                                                                                    </span>
<span  style=""> 431                                                                                                          </span>
<span class="-1352938694099643130" onmouseenter="enter('-1352938694099643130');" onmouseout="out('-1352938694099643130');" style=""> 432     public static void addCalendarToBlacklist(String calendarDisplayName) {                              </span>
<span class="5135070223261002446" onmouseenter="enter('5135070223261002446');" onmouseout="out('5135070223261002446');" style=""> 433         if (calendars_blacklist.add(calendarDisplayName)) {                                              </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 434             saveCalendarsBlackList();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436     }                                                                                                    </span>
<span  style=""> 437                                                                                                          </span>
<span class="-4191679597070541210" onmouseenter="enter('-4191679597070541210');" onmouseout="out('-4191679597070541210');" style=""> 438     public static void removeFromCalendarBlacklist(String calendarDisplayName) {                         </span>
<span class="-3543064320447564137" onmouseenter="enter('-3543064320447564137');" onmouseout="out('-3543064320447564137');" style=""> 439         calendars_blacklist.remove(calendarDisplayName);                                                 </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 440         saveCalendarsBlackList();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441     }                                                                                                    </span>
<span  style=""> 442                                                                                                          </span>
<span class="8449352248946474476" onmouseenter="enter('8449352248946474476');" onmouseout="out('8449352248946474476');" style=""> 443     private static void loadCalendarsBlackList() {                                                       </span>
<span class="929362169649938726" onmouseenter="enter('929362169649938726');" onmouseout="out('929362169649938726');" style=""> 444         GB.log(&quot;Loading calendars_blacklist&quot;, GB.INFO, null);                                            </span>
<span class="-3197959776357605547" onmouseenter="enter('-3197959776357605547');" onmouseout="out('-3197959776357605547');" style=""><abbr title=" 445         calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, null);"> 445         calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, nullðŸ”µ</abbr></span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 446         if (calendars_blacklist == null) {                                                               </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 447             calendars_blacklist = new HashSet&lt;&gt;();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448         }                                                                                                </span>
<span class="-7148420027100342883" onmouseenter="enter('-7148420027100342883');" onmouseout="out('-7148420027100342883');" style=""><abbr title=" 449         GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);"> 449         GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, nullðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450     }                                                                                                    </span>
<span  style=""> 451                                                                                                          </span>
<span class="2309319604958063821" onmouseenter="enter('2309319604958063821');" onmouseout="out('2309319604958063821');" style=""> 452     private static void saveCalendarsBlackList() {                                                       </span>
<span class="5173264045101766520" onmouseenter="enter('5173264045101766520');" onmouseout="out('5173264045101766520');" style=""><abbr title=" 453         GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);"> 453         GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, nulðŸ”µ</abbr></span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 454         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-7491519725598434790" onmouseenter="enter('-7491519725598434790');" onmouseout="out('-7491519725598434790');" style=""> 455         if (calendars_blacklist.isEmpty()) {                                                             </span>
<span class="4243111498727581039" onmouseenter="enter('4243111498727581039');" onmouseout="out('4243111498727581039');" style=""> 456             editor.putStringSet(GBPrefs.CALENDAR_BLACKLIST, null);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 457         } else {                                                                                         </span>
<span class="-2454412986410082716" onmouseenter="enter('-2454412986410082716');" onmouseout="out('-2454412986410082716');" style=""> 458             Prefs.putStringSet(editor, GBPrefs.CALENDAR_BLACKLIST, calendars_blacklist);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 460         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461     }                                                                                                    </span>
<span  style=""> 462                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 463     /**                                                                                                  </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 464      * Deletes both the old Activity database and the new one recreates it with empty tables.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 465      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 466      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 467      */                                                                                                  </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 468     public static synchronized boolean deleteActivityDatabase(Context context) {                         </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 469         // TODO: flush, close, reopen db                                                                 </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 470         if (lockHandler != null) {                                                                       </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 471             lockHandler.closeDb();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472         }                                                                                                </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 473         boolean result = deleteOldActivityDatabase(context);                                             </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 474         result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                            </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 475         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476     }                                                                                                    </span>
<span  style=""> 477                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 478     /**                                                                                                  </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 479      * Deletes the legacy (pre 0.12) Activity database                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 480      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 481      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 482      */                                                                                                  </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 483     public static synchronized boolean deleteOldActivityDatabase(Context context) {                      </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 484         DBHelper dbHelper = new DBHelper(context);                                                       </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 485         boolean result = true;                                                                           </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 486         if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                     </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 487             result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488         }                                                                                                </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 489         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 490     }                                                                                                    </span>
<span  style=""> 491                                                                                                          </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 492     private int getPrefsFileVersion() {                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 493         try {                                                                                            </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 494             return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 495         } catch (Exception e) {                                                                          </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 496             //in version 1 this was an int                                                               </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 497             return 1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499     }                                                                                                    </span>
<span  style=""> 500                                                                                                          </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 501     private void migratePrefs(int oldVersion) {                                                          </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 502         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 503         switch (oldVersion) {                                                                            </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 504             case 0:                                                                                      </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 505                 String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                     </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 506                 String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                  </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 507                 String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                  </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 508                 String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                 </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 509                 if (legacyGender != null) {                                                              </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 510                     int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;</span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 511                     editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));           </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 512                     editor.remove(&quot;mi_user_gender&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 513                 }                                                                                        </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 514                 if (legacyHeight != null) {                                                              </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 515                     editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                    </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 516                     editor.remove(&quot;mi_user_height_cm&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517                 }                                                                                        </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 518                 if (legacyWeigth != null) {                                                              </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 519                     editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                    </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 520                     editor.remove(&quot;mi_user_weight_kg&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521                 }                                                                                        </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 522                 if (legacyYOB != null) {                                                                 </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 523                     editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                   </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 524                     editor.remove(&quot;mi_user_year_of_birth&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525                 }                                                                                        </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 526                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 527                 break;                                                                                   </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 528             case 1:                                                                                      </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 529                 //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 529                 //migrate the integer version of gender introduced in version 1 to a string value, neededðŸ”µ</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 530                 int legacyGender_1 = 2;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 531                 try {                                                                                    </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 532                     legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 533                 } catch (Exception e) {                                                                  </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 534                     Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535                 }                                                                                        </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 536                 editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));       </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 537                 //also silently migrate the version to a string value                                    </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 538                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 539                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 541         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542     }                                                                                                    </span>
<span  style=""> 543                                                                                                          </span>
<span class="-3847609959270330161" onmouseenter="enter('-3847609959270330161');" onmouseout="out('-3847609959270330161');" style=""> 544     public static void setLanguage(String lang) {                                                        </span>
<span class="2010165672364354755" onmouseenter="enter('2010165672364354755');" onmouseout="out('2010165672364354755');" style=""> 545         if (lang.equals(&quot;default&quot;)) {                                                                    </span>
<span class="-1084003509567751492" onmouseenter="enter('-1084003509567751492');" onmouseout="out('-1084003509567751492');" style=""> 546             language = Resources.getSystem().getConfiguration().locale;                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 547         } else {                                                                                         </span>
<span class="-1687880958280815140" onmouseenter="enter('-1687880958280815140');" onmouseout="out('-1687880958280815140');" style=""> 548             language = new Locale(lang);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549         }                                                                                                </span>
<span class="-6135042183655095886" onmouseenter="enter('-6135042183655095886');" onmouseout="out('-6135042183655095886');" style=""> 550         updateLanguage(language);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 551     }                                                                                                    </span>
<span  style=""> 552                                                                                                          </span>
<span class="5259621038207386847" onmouseenter="enter('5259621038207386847');" onmouseout="out('5259621038207386847');" style=""> 553     public static void updateLanguage(Locale locale) {                                                   </span>
<span class="1109198243690318720" onmouseenter="enter('1109198243690318720');" onmouseout="out('1109198243690318720');" style=""> 554         AndroidUtils.setLanguage(context, locale);                                                       </span>
<span class="535862575394010177" onmouseenter="enter('535862575394010177');" onmouseout="out('535862575394010177');" style=""> 555         Intent intent = new Intent();                                                                    </span>
<span class="-164638367863943974" onmouseenter="enter('-164638367863943974');" onmouseout="out('-164638367863943974');" style=""> 556         intent.setAction(ACTION_LANGUAGE_CHANGE);                                                        </span>
<span class="4843300360101524365" onmouseenter="enter('4843300360101524365');" onmouseout="out('4843300360101524365');" style=""> 557         LocalBroadcastManager.getInstance(context).sendBroadcast(intent);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558     }                                                                                                    </span>
<span  style=""> 559                                                                                                          </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 560     public static LimitedQueue getIDSenderLookup() {                                                     </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 561         return mIDSenderLookup;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 562     }                                                                                                    </span>
<span  style=""> 563                                                                                                          </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 564     public static boolean isDarkThemeEnabled() {                                                         </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 565         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 565         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566     }                                                                                                    </span>
<span  style=""> 567                                                                                                          </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 568     public static int getTextColor(Context context) {                                                    </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 569         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 570         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 571         theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                               </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 572         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 573     }                                                                                                    </span>
<span  style=""> 574                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 575     @Override                                                                                            </span>
<span class="2483214837331013305" onmouseenter="enter('2483214837331013305');" onmouseout="out('2483214837331013305');" style=""> 576     public void onConfigurationChanged(Configuration newConfig) {                                        </span>
<span class="-1478537389163372238" onmouseenter="enter('-1478537389163372238');" onmouseout="out('-1478537389163372238');" style=""> 577         super.onConfigurationChanged(newConfig);                                                         </span>
<span class="2223384074430921263" onmouseenter="enter('2223384074430921263');" onmouseout="out('2223384074430921263');" style=""> 578         updateLanguage(getLanguage());                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579     }                                                                                                    </span>
<span  style=""> 580                                                                                                          </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 581     public static int getBackgroundColor(Context context) {                                              </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 582         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 583         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 584         theme.resolveAttribute(android.R.attr.background, typedValue, true);                             </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 585         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 586     }                                                                                                    </span>
<span  style=""> 587                                                                                                          </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 588     public static Prefs getPrefs() {                                                                     </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 589         return prefs;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590     }                                                                                                    </span>
<span  style=""> 591                                                                                                          </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 592     public static GBPrefs getGBPrefs() {                                                                 </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 593         return gbPrefs;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594     }                                                                                                    </span>
<span  style=""> 595                                                                                                          </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 596     public DeviceManager getDeviceManager() {                                                            </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 597         return deviceManager;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598     }                                                                                                    </span>
<span  style=""> 599                                                                                                          </span>
<span class="-1673519419532841409" onmouseenter="enter('-1673519419532841409');" onmouseout="out('-1673519419532841409');" style=""> 600     public static GBApplication app() {                                                                  </span>
<span class="-5545492324510288114" onmouseenter="enter('-5545492324510288114');" onmouseout="out('-5545492324510288114');" style=""> 601         return app;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 602     }                                                                                                    </span>
<span  style=""> 603                                                                                                          </span>
<span class="4339444706683048648" onmouseenter="enter('4339444706683048648');" onmouseout="out('4339444706683048648');" style=""> 604     public static Locale getLanguage() {                                                                 </span>
<span class="8742914849630491523" onmouseenter="enter('8742914849630491523');" onmouseout="out('8742914849630491523');" style=""> 605         return language;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 606     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607 }                                                                                                        </span>



</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1  /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                          </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2      Gobbetti, Normano64                                                                                           </span>
<span  style="">   3                                                                                                                    </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4      This file is part of Gadgetbridge.                                                                            </span>
<span  style="">   5                                                                                                                    </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6      Gadgetbridge is free software: you can redistribute it and/or modify                                          </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7      it under the terms of the GNU Affero General Public License as published                                      </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8      by the Free Software Foundation, either version 3 of the License, or                                          </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9      (at your option) any later version.                                                                           </span>
<span  style="">  10                                                                                                                    </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11      Gadgetbridge is distributed in the hope that it will be useful,                                               </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12      but WITHOUT ANY WARRANTY; without even the implied warranty of                                                </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                                 </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14      GNU Affero General Public License for more details.                                                           </span>
<span  style="">  15                                                                                                                    </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16      You should have received a copy of the GNU Affero General Public License                                      </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17      along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                                      </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18  package nodomain.freeyourgadget.gadgetbridge;                                                                     </span>
<span  style="">  19                                                                                                                    </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20  import android.annotation.TargetApi;                                                                              </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21  import android.app.Application;                                                                                   </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22  import android.app.NotificationManager;                                                                           </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23  import android.app.NotificationManager.Policy;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25  import android.content.Intent;                                                                                    </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26  import android.content.SharedPreferences;                                                                         </span>
<span class="-9179032954578521484" onmouseenter="enter('-9179032954578521484');" onmouseout="out('-9179032954578521484');" style="">  27  import android.content.res.Configuration;                                                                         </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  28  import android.content.res.Resources;                                                                             </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  29  import android.database.Cursor;                                                                                   </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  30  import android.database.sqlite.SQLiteDatabase;                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  31  import android.net.Uri;                                                                                           </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  32  import android.os.Build;                                                                                          </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  33  import android.os.Build.VERSION;                                                                                  </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  34  import android.preference.PreferenceManager;                                                                      </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  35  import android.provider.ContactsContract.PhoneLookup;                                                             </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  36  import android.support.v4.content.LocalBroadcastManager;                                                          </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  37  import android.util.Log;                                                                                          </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  38  import android.util.TypedValue;                                                                                   </span>
<span  style="">  39                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  40  import java.io.File;                                                                                              </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  41  import java.io.IOException;                                                                                       </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  42  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  43  import java.util.List;                                                                                            </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  44  import java.util.Locale;                                                                                          </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  45  import java.util.Set;                                                                                             </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  46  import java.util.concurrent.TimeUnit;                                                                             </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  47  import java.util.concurrent.locks.Lock;                                                                           </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  48  import java.util.concurrent.locks.ReentrantLock;                                                                  </span>
<span  style="">  49                                                                                                                    </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                                 </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  51  import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                                   </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  52  import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                                    </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  53  import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                                </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  54  import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                                </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  55  import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                                   </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  56  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  57  import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                                 </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  58  import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                                   </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  59  import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                                  </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="">  60  import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                          </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                                    </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  62  import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                                       </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  63  import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                              </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  64  import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                         </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  65  import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                                    </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  66  import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                           </span>
<span  style="">  67                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  68  /**                                                                                                               </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  69   * Main Application class that initializes and provides access to certain things like                             </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  70   * logging and DB access.                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  71   */                                                                                                               </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  72  public class GBApplication extends Application {                                                                  </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  73      // Since this class must not log to slf4j, we use plain android.util.Log                                      </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  74      private static final String TAG = &quot;GBApplication&quot;;                                                            </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  75      public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                                    </span>
<span  style="">  76                                                                                                                    </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  77      private static GBApplication context;                                                                         </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  78      private static final Lock dbLock = new ReentrantLock();                                                       </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  79      private static DeviceService deviceService;                                                                   </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  80      private static SharedPreferences sharedPrefs;                                                                 </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  81      private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                                     </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  82      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  82      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs beloðŸ”µ</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  83      private static final int CURRENT_PREFS_VERSION = 2;                                                           </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  84      private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                           </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  85      private static Prefs prefs;                                                                                   </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  86      private static GBPrefs gbPrefs;                                                                               </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  87      private static LockHandler lockHandler;                                                                       </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  88      /**                                                                                                           </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  89       * Note: is null on Lollipop and Kitkat                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90       */                                                                                                           </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  91      private static NotificationManager notificationManager;                                                       </span>
<span  style="">  92                                                                                                                    </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style="">  93      public static final String ACTION_QUIT                                                                        </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style="">  94              = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                                   </span>
<span class="3620791290214227219" onmouseenter="enter('3620791290214227219');" onmouseout="out('3620791290214227219');" style=""><abbr title="  95      public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.language_change&quot;;">  95      public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.actionðŸ”µ</abbr></span>
<span  style="">  96                                                                                                                    </span>
<span class="-6827183296325807512" onmouseenter="enter('-6827183296325807512');" onmouseout="out('-6827183296325807512');" style="">  97      private static GBApplication app;                                                                             </span>
<span  style="">  98                                                                                                                    </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style="">  99      private static Logging logging = new Logging() {                                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 100          @Override                                                                                                 </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style=""> 101          protected String createLogDirectory() throws IOException {                                                </span>
<span class="9110710162536643525" onmouseenter="enter('9110710162536643525');" onmouseout="out('9110710162536643525');" style=""> 102              if (GBEnvironment.env().isLocalTest()) {                                                              </span>
<span class="-6519269446490050835" onmouseenter="enter('-6519269446490050835');" onmouseout="out('-6519269446490050835');" style=""> 103                  return System.getProperty(Logging.PROP_LOGFILES_DIR);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 104              } else {                                                                                              </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style=""> 105                  File dir = FileUtils.getExternalFilesDir();                                                       </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style=""> 106                  return dir.getAbsolutePath();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 109      };                                                                                                            </span>
<span class="-466220917116319233" onmouseenter="enter('-466220917116319233');" onmouseout="out('-466220917116319233');" style=""> 110      private static Locale language;                                                                               </span>
<span  style=""> 111                                                                                                                    </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 112      private DeviceManager deviceManager;                                                                          </span>
<span  style=""> 113                                                                                                                    </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 114      public static void quit() {                                                                                   </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 115          GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                                        </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 116          Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                                </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 117          LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                                     </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 118          GBApplication.deviceService().quit();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119      }                                                                                                             </span>
<span  style=""> 120                                                                                                                    </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 121      public GBApplication() {                                                                                      </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 122          context = this;                                                                                           </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 123          // don&#x27;t do anything here, add it to onCreate instead                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124      }                                                                                                             </span>
<span  style=""> 125                                                                                                                    </span>
<span class="7323683286886200939" onmouseenter="enter('7323683286886200939');" onmouseout="out('7323683286886200939');" style=""> 126      public static Logging getLogging() {                                                                          </span>
<span class="3757797739027293534" onmouseenter="enter('3757797739027293534');" onmouseout="out('3757797739027293534');" style=""> 127          return logging;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128      }                                                                                                             </span>
<span  style=""> 129                                                                                                                    </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 130      protected DeviceService createDeviceService() {                                                               </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 131          return new GBDeviceService(this);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132      }                                                                                                             </span>
<span  style=""> 133                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 134      @Override                                                                                                     </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 135      public void onCreate() {                                                                                      </span>
<span class="-8156783544820381420" onmouseenter="enter('-8156783544820381420');" onmouseout="out('-8156783544820381420');" style=""> 136          app = this;                                                                                               </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 137          super.onCreate();                                                                                         </span>
<span  style=""> 138                                                                                                                    </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 139          if (lockHandler != null) {                                                                                </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 140              // guard against multiple invocations (robolectric)                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 141              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142          }                                                                                                         </span>
<span  style=""> 143                                                                                                                    </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 144          sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                                     </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 145          prefs = new Prefs(sharedPrefs);                                                                           </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 146          gbPrefs = new GBPrefs(prefs);                                                                             </span>
<span  style=""> 147                                                                                                                    </span>
<span class="-7675320667911398446" onmouseenter="enter('-7675320667911398446');" onmouseout="out('-7675320667911398446');" style=""> 148          if (!GBEnvironment.isEnvironmentSetup()) {                                                                </span>
<span class="-2266666929574149874" onmouseenter="enter('-2266666929574149874');" onmouseout="out('-2266666929574149874');" style=""> 149              GBEnvironment.setupEnvironment(GBEnvironment.createDeviceEnvironment());                              </span>
<span class="-3738634480535142994" onmouseenter="enter('-3738634480535142994');" onmouseout="out('-3738634480535142994');" style=""> 150              // setup db after the environment is set up, but don&#x27;t do it in test mode                             </span>
<span class="5829052537828666407" onmouseenter="enter('5829052537828666407');" onmouseout="out('5829052537828666407');" style=""> 151              // in test mode, it&#x27;s done individually, see TestBase                                                 </span>
<span class="5177995110342670479" onmouseenter="enter('5177995110342670479');" onmouseout="out('5177995110342670479');" style=""> 152              setupDatabase();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153          }                                                                                                         </span>
<span  style=""> 154                                                                                                                    </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 155          // don&#x27;t do anything here before we set up logging, otherwise                                             </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 156          // slf4j may be implicitly initialized before we properly configured it.                                  </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 157          setupLogging(isFileLoggingEnabled());                                                                     </span>
<span  style=""> 158                                                                                                                    </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 159          if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                                     </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 160              migratePrefs(getPrefsFileVersion());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161          }                                                                                                         </span>
<span  style=""> 162                                                                                                                    </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 163          setupExceptionHandler();                                                                                  </span>
<span  style=""> 164                                                                                                                    </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 165          deviceManager = new DeviceManager(this);                                                                  </span>
<span class="5344675729095119335" onmouseenter="enter('5344675729095119335');" onmouseout="out('5344675729095119335');" style=""> 166          String language = prefs.getString(&quot;language&quot;, &quot;default&quot;);                                                 </span>
<span class="-4352228919314969984" onmouseenter="enter('-4352228919314969984');" onmouseout="out('-4352228919314969984');" style=""> 167          setLanguage(language);                                                                                    </span>
<span  style=""> 168                                                                                                                    </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +        createWebViewActivity();                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +                                                                                                                  </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 171          deviceService = createDeviceService();                                                                    </span>
<span class="-7443536723725935642" onmouseenter="enter('-7443536723725935642');" onmouseout="out('-7443536723725935642');" style=""> 172          loadAppsBlackList();                                                                                      </span>
<span class="-5451989795140418224" onmouseenter="enter('-5451989795140418224');" onmouseout="out('-5451989795140418224');" style=""> 173          loadCalendarsBlackList();                                                                                 </span>
<span  style=""> 174                                                                                                                    </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 175          if (isRunningMarshmallowOrLater()) {                                                                      </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""> 176              notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);   </span>
<span class="-3292367781642785183" onmouseenter="enter('-3292367781642785183');" onmouseout="out('-3292367781642785183');" style=""> 177              //the following will ensure the notification manager is kept alive                                    </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 178              startService(new Intent(this, NotificationCollectorMonitorService.class));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 179 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 180 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 181 +                                                                                                                  </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +    private void createWebViewActivity() {                                                                        </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +        if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                            </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 184 +            Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                            </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                                       </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 186 +            startActivity(intent);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188      }                                                                                                             </span>
<span  style=""> 189                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 190      @Override                                                                                                     </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 191      public void onTrimMemory(int level) {                                                                         </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 192          super.onTrimMemory(level);                                                                                </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 193          if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                                    </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 194              if (!hasBusyDevice()) {                                                                               </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 195                  DBHelper.clearSession();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198      }                                                                                                             </span>
<span  style=""> 199                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 200      /**                                                                                                           </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 201       * Returns true if at least a single device is busy, e.g synchronizing activity data                          </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 202       * or something similar.                                                                                      </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 203       * Note: busy is not the same as connected or initialized!                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 204       */                                                                                                           </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 205      private boolean hasBusyDevice() {                                                                             </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 206          List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                                 </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 207          for (GBDevice device : devices) {                                                                         </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 208              if (device.isBusy()) {                                                                                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 209                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 212          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213      }                                                                                                             </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 215      public static void setupLogging(boolean enabled) {                                                            </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 216          logging.setupLogging(enabled);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217      }                                                                                                             </span>
<span  style=""> 218                                                                                                                    </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 219      private void setupExceptionHandler() {                                                                        </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 220          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 220          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler())ðŸ”µ</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 221          Thread.setDefaultUncaughtExceptionHandler(handler);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222      }                                                                                                             </span>
<span  style=""> 223                                                                                                                    </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 224      public static boolean isFileLoggingEnabled() {                                                                </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 225          return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226      }                                                                                                             </span>
<span  style=""> 227                                                                                                                    </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 228      public static boolean minimizeNotification() {                                                                </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 229          return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230      }                                                                                                             </span>
<span  style=""> 231                                                                                                                    </span>
<span class="3584575502170839042" onmouseenter="enter('3584575502170839042');" onmouseout="out('3584575502170839042');" style=""> 232      public void setupDatabase() {                                                                                 </span>
<span class="-3757253101115813818" onmouseenter="enter('-3757253101115813818');" onmouseout="out('-3757253101115813818');" style=""> 233          DaoMaster.OpenHelper helper;                                                                              </span>
<span class="9128810292226701201" onmouseenter="enter('9128810292226701201');" onmouseout="out('9128810292226701201');" style=""> 234          GBEnvironment env = GBEnvironment.env();                                                                  </span>
<span class="7076376602711179030" onmouseenter="enter('7076376602711179030');" onmouseout="out('7076376602711179030');" style=""> 235          if (env.isTest()) {                                                                                       </span>
<span class="-4283816386875317195" onmouseenter="enter('-4283816386875317195');" onmouseout="out('-4283816386875317195');" style=""> 236              helper = new DaoMaster.DevOpenHelper(this, null, null);                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 237          } else {                                                                                                  </span>
<span class="4579041963248283587" onmouseenter="enter('4579041963248283587');" onmouseout="out('4579041963248283587');" style=""> 238              helper = new DBOpenHelper(this, DATABASE_NAME, null);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239          }                                                                                                         </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 240          SQLiteDatabase db = helper.getWritableDatabase();                                                         </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 241          DaoMaster daoMaster = new DaoMaster(db);                                                                  </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 242          if (lockHandler == null) {                                                                                </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 243              lockHandler = new LockHandler();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244          }                                                                                                         </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 245          lockHandler.init(daoMaster, helper);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 248      public static Context getContext() {                                                                          </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 249          return context;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250      }                                                                                                             </span>
<span  style=""> 251                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 252      /**                                                                                                           </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 253       * Returns the facade for talking to devices. Devices are managed by                                          </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 254       * an Android Service and this facade provides access to its functionality.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 255       *                                                                                                            </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 256       * @return the facade for talking to the service/devices.                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 257       */                                                                                                           </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 258      public static DeviceService deviceService() {                                                                 </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 259          return deviceService;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260      }                                                                                                             </span>
<span  style=""> 261                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 262      /**                                                                                                           </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 263       * Returns the DBHandler instance for reading/writing or throws GBException                                   </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 264       * when that was not successful                                                                               </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 265       * If acquiring was successful, callers must call #releaseDB when they                                        </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 266       * are done (from the same thread that acquired the lock!                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 267       * &lt;p&gt;                                                                                                        </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 268       * Callers must not hold a reference to the returned instance because it                                      </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 269       * will be invalidated at some point.                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 270       *                                                                                                            </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 271       * @return the DBHandler                                                                                      </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 272       * @throws GBException                                                                                        </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 273       * @see #releaseDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 274       */                                                                                                           </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 275      public static DBHandler acquireDB() throws GBException {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 276          try {                                                                                                     </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 277              if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                           </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 278                  return lockHandler;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279              }                                                                                                     </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 280          } catch (InterruptedException ex) {                                                                       </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 281              Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282          }                                                                                                         </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 283          throw new GBException(&quot;Unable to access the database.&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284      }                                                                                                             </span>
<span  style=""> 285                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 286      /**                                                                                                           </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 287       * Releases the database lock.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 288       *                                                                                                            </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 289       * @throws IllegalMonitorStateException if the current thread is not owning the lock                          </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 290       * @see #acquireDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 291       */                                                                                                           </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 292      public static void releaseDB() {                                                                              </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 293          dbLock.unlock();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294      }                                                                                                             </span>
<span  style=""> 295                                                                                                                    </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 296      public static boolean isRunningLollipopOrLater() {                                                            </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 297          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298      }                                                                                                             </span>
<span  style=""> 299                                                                                                                    </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 300      public static boolean isRunningMarshmallowOrLater() {                                                         </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 301          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302      }                                                                                                             </span>
<span  style=""> 303                                                                                                                    </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 304      private static boolean isPrioritySender(int prioritySenders, String number) {                                 </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 305          if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 306              return true;                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 307          } else {                                                                                                  </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 308              Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));                   </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 309              String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                             </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 310              Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);                </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 311              boolean exists = false;                                                                               </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 312              int starred = 0;                                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 313              try {                                                                                                 </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 314                  if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                                     </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 315                      exists = true;                                                                                </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 316                      starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317                  }                                                                                                 </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 318              } finally {                                                                                           </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 319                  if (cursor != null) {                                                                             </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 320                      cursor.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322              }                                                                                                     </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 323              if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 324                  return true;                                                                                      </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 325              } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 326                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327              }                                                                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 328              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330      }                                                                                                             </span>
<span  style=""> 331                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 332      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 333      public static boolean isPriorityNumber(int priorityType, String number) {                                     </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 334          NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();              </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 335          if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                                  </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 336              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 336              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATðŸ”µ</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 337                  return isPrioritySender(notificationPolicy.priorityMessageSenders, number);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338              }                                                                                                     </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 339          } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                              </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 340              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 340              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGOðŸ”µ</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 341                  return isPrioritySender(notificationPolicy.priorityCallSenders, number);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 344          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345      }                                                                                                             </span>
<span  style=""> 346                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 347      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 348      public static int getGrantedInterruptionFilter() {                                                            </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""> 349          if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {      </span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 350              if (notificationManager.isNotificationPolicyAccessGranted()) {                                        </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 351                  return notificationManager.getCurrentInterruptionFilter();                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353          }                                                                                                         </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 354          return NotificationManager.INTERRUPTION_FILTER_ALL;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355      }                                                                                                             </span>
<span  style=""> 356                                                                                                                    </span>
<span class="-9029891236967858826" onmouseenter="enter('-9029891236967858826');" onmouseout="out('-9029891236967858826');" style=""> 357      private static HashSet&lt;String&gt; apps_blacklist = null;                                                         </span>
<span  style=""> 358                                                                                                                    </span>
<span class="628937876596348808" onmouseenter="enter('628937876596348808');" onmouseout="out('628937876596348808');" style=""> 359      public static boolean appIsBlacklisted(String packageName) {                                                  </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 360          if (apps_blacklist == null) {                                                                             </span>
<span class="-1946294913030942780" onmouseenter="enter('-1946294913030942780');" onmouseout="out('-1946294913030942780');" style=""> 361              GB.log(&quot;appIsBlacklisted: apps_blacklist is null!&quot;, GB.INFO, null);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362          }                                                                                                         </span>
<span class="1884921446555776787" onmouseenter="enter('1884921446555776787');" onmouseout="out('1884921446555776787');" style=""> 363          return apps_blacklist != null &amp;&amp; apps_blacklist.contains(packageName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364      }                                                                                                             </span>
<span  style=""> 365                                                                                                                    </span>
<span class="7953897085511400770" onmouseenter="enter('7953897085511400770');" onmouseout="out('7953897085511400770');" style=""> 366      public static void setAppsBlackList(Set&lt;String&gt; packageNames) {                                               </span>
<span class="-8197290468385298169" onmouseenter="enter('-8197290468385298169');" onmouseout="out('-8197290468385298169');" style=""> 367          if (packageNames == null) {                                                                               </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 368              GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                                     </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 369              apps_blacklist = new HashSet&lt;&gt;();                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 370          } else {                                                                                                  </span>
<span class="-3015046103246507563" onmouseenter="enter('-3015046103246507563');" onmouseout="out('-3015046103246507563');" style=""> 371              apps_blacklist = new HashSet&lt;&gt;(packageNames);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372          }                                                                                                         </span>
<span class="7291510234597289182" onmouseenter="enter('7291510234597289182');" onmouseout="out('7291510234597289182');" style=""> 373          GB.log(&quot;New apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);                    </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 374          saveAppsBlackList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375      }                                                                                                             </span>
<span  style=""> 376                                                                                                                    </span>
<span class="-4764637370834062607" onmouseenter="enter('-4764637370834062607');" onmouseout="out('-4764637370834062607');" style=""> 377      private static void loadAppsBlackList() {                                                                     </span>
<span class="-7366183400676760194" onmouseenter="enter('-7366183400676760194');" onmouseout="out('-7366183400676760194');" style=""> 378          GB.log(&quot;Loading apps_blacklist&quot;, GB.INFO, null);                                                          </span>
<span class="-1377772229847163824" onmouseenter="enter('-1377772229847163824');" onmouseout="out('-1377772229847163824');" style=""> 379          apps_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.PACKAGE_BLACKLIST, null);             </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 380          if (apps_blacklist == null) {                                                                             </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 381              apps_blacklist = new HashSet&lt;&gt;();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382          }                                                                                                         </span>
<span class="-1532140920596176818" onmouseenter="enter('-1532140920596176818');" onmouseout="out('-1532140920596176818');" style=""> 383          GB.log(&quot;Loaded apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384      }                                                                                                             </span>
<span  style=""> 385                                                                                                                    </span>
<span class="6267616075496604119" onmouseenter="enter('6267616075496604119');" onmouseout="out('6267616075496604119');" style=""> 386      private static void saveAppsBlackList() {                                                                     </span>
<span class="2886231841558584460" onmouseenter="enter('2886231841558584460');" onmouseout="out('2886231841558584460');" style=""> 387          GB.log(&quot;Saving apps_blacklist with &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);                </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 388          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-7981649915035584664" onmouseenter="enter('-7981649915035584664');" onmouseout="out('-7981649915035584664');" style=""> 389          if (apps_blacklist.isEmpty()) {                                                                           </span>
<span class="-7815879823137819644" onmouseenter="enter('-7815879823137819644');" onmouseout="out('-7815879823137819644');" style=""> 390              editor.putStringSet(GBPrefs.PACKAGE_BLACKLIST, null);                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 391          } else {                                                                                                  </span>
<span class="-85230520183976524" onmouseenter="enter('-85230520183976524');" onmouseout="out('-85230520183976524');" style=""> 392              Prefs.putStringSet(editor, GBPrefs.PACKAGE_BLACKLIST, apps_blacklist);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 393          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 394          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395      }                                                                                                             </span>
<span  style=""> 396                                                                                                                    </span>
<span class="3406803570609530272" onmouseenter="enter('3406803570609530272');" onmouseout="out('3406803570609530272');" style=""> 397      public static void addAppToBlacklist(String packageName) {                                                    </span>
<span class="-4613377587158803622" onmouseenter="enter('-4613377587158803622');" onmouseout="out('-4613377587158803622');" style=""> 398          if (apps_blacklist.add(packageName)) {                                                                    </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 399              saveAppsBlackList();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401      }                                                                                                             </span>
<span  style=""> 402                                                                                                                    </span>
<span class="6341305090216699567" onmouseenter="enter('6341305090216699567');" onmouseout="out('6341305090216699567');" style=""> 403      public static synchronized void removeFromAppsBlacklist(String packageName) {                                 </span>
<span class="6848681783835366738" onmouseenter="enter('6848681783835366738');" onmouseout="out('6848681783835366738');" style=""> 404          GB.log(&quot;Removing from apps_blacklist: &quot; + packageName, GB.INFO, null);                                    </span>
<span class="1898542166501963208" onmouseenter="enter('1898542166501963208');" onmouseout="out('1898542166501963208');" style=""> 405          apps_blacklist.remove(packageName);                                                                       </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 406          saveAppsBlackList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407      }                                                                                                             </span>
<span  style=""> 408                                                                                                                    </span>
<span class="-1625652503048685789" onmouseenter="enter('-1625652503048685789');" onmouseout="out('-1625652503048685789');" style=""> 409      private static HashSet&lt;String&gt; calendars_blacklist = null;                                                    </span>
<span  style=""> 410                                                                                                                    </span>
<span class="7038688512705390946" onmouseenter="enter('7038688512705390946');" onmouseout="out('7038688512705390946');" style=""> 411      public static boolean calendarIsBlacklisted(String calendarDisplayName) {                                     </span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 412          if (calendars_blacklist == null) {                                                                        </span>
<span class="2679978338359393788" onmouseenter="enter('2679978338359393788');" onmouseout="out('2679978338359393788');" style=""> 413              GB.log(&quot;calendarIsBlacklisted: calendars_blacklist is null!&quot;, GB.INFO, null);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414          }                                                                                                         </span>
<span class="-6083844107851171159" onmouseenter="enter('-6083844107851171159');" onmouseout="out('-6083844107851171159');" style=""> 415          return calendars_blacklist != null &amp;&amp; calendars_blacklist.contains(calendarDisplayName);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416      }                                                                                                             </span>
<span  style=""> 417                                                                                                                    </span>
<span class="-1203782580073493681" onmouseenter="enter('-1203782580073493681');" onmouseout="out('-1203782580073493681');" style=""> 418      public static void setCalendarsBlackList(Set&lt;String&gt; calendarNames) {                                         </span>
<span class="9006806600947611848" onmouseenter="enter('9006806600947611848');" onmouseout="out('9006806600947611848');" style=""> 419          if (calendarNames == null) {                                                                              </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 420              GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                                     </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 421              calendars_blacklist = new HashSet&lt;&gt;();                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 422          } else {                                                                                                  </span>
<span class="-5832993308357266278" onmouseenter="enter('-5832993308357266278');" onmouseout="out('-5832993308357266278');" style=""> 423              calendars_blacklist = new HashSet&lt;&gt;(calendarNames);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424          }                                                                                                         </span>
<span class="-2685264550992926452" onmouseenter="enter('-2685264550992926452');" onmouseout="out('-2685264550992926452');" style=""> 425          GB.log(&quot;New calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);          </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 426          saveCalendarsBlackList();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427      }                                                                                                             </span>
<span  style=""> 428                                                                                                                    </span>
<span class="-1352938694099643130" onmouseenter="enter('-1352938694099643130');" onmouseout="out('-1352938694099643130');" style=""> 429      public static void addCalendarToBlacklist(String calendarDisplayName) {                                       </span>
<span class="5135070223261002446" onmouseenter="enter('5135070223261002446');" onmouseout="out('5135070223261002446');" style=""> 430          if (calendars_blacklist.add(calendarDisplayName)) {                                                       </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 431              saveCalendarsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433      }                                                                                                             </span>
<span  style=""> 434                                                                                                                    </span>
<span class="-4191679597070541210" onmouseenter="enter('-4191679597070541210');" onmouseout="out('-4191679597070541210');" style=""> 435      public static void removeFromCalendarBlacklist(String calendarDisplayName) {                                  </span>
<span class="-3543064320447564137" onmouseenter="enter('-3543064320447564137');" onmouseout="out('-3543064320447564137');" style=""> 436          calendars_blacklist.remove(calendarDisplayName);                                                          </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 437          saveCalendarsBlackList();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438      }                                                                                                             </span>
<span  style=""> 439                                                                                                                    </span>
<span class="8449352248946474476" onmouseenter="enter('8449352248946474476');" onmouseout="out('8449352248946474476');" style=""> 440      private static void loadCalendarsBlackList() {                                                                </span>
<span class="929362169649938726" onmouseenter="enter('929362169649938726');" onmouseout="out('929362169649938726');" style=""> 441          GB.log(&quot;Loading calendars_blacklist&quot;, GB.INFO, null);                                                     </span>
<span class="-3197959776357605547" onmouseenter="enter('-3197959776357605547');" onmouseout="out('-3197959776357605547');" style=""> 442          calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, null);       </span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 443          if (calendars_blacklist == null) {                                                                        </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 444              calendars_blacklist = new HashSet&lt;&gt;();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445          }                                                                                                         </span>
<span class="-7148420027100342883" onmouseenter="enter('-7148420027100342883');" onmouseout="out('-7148420027100342883');" style=""> 446          GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447      }                                                                                                             </span>
<span  style=""> 448                                                                                                                    </span>
<span class="2309319604958063821" onmouseenter="enter('2309319604958063821');" onmouseout="out('2309319604958063821');" style=""> 449      private static void saveCalendarsBlackList() {                                                                </span>
<span class="5173264045101766520" onmouseenter="enter('5173264045101766520');" onmouseout="out('5173264045101766520');" style=""> 450          GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);      </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 451          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-7491519725598434790" onmouseenter="enter('-7491519725598434790');" onmouseout="out('-7491519725598434790');" style=""> 452          if (calendars_blacklist.isEmpty()) {                                                                      </span>
<span class="4243111498727581039" onmouseenter="enter('4243111498727581039');" onmouseout="out('4243111498727581039');" style=""> 453              editor.putStringSet(GBPrefs.CALENDAR_BLACKLIST, null);                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 454          } else {                                                                                                  </span>
<span class="-2454412986410082716" onmouseenter="enter('-2454412986410082716');" onmouseout="out('-2454412986410082716');" style=""> 455              Prefs.putStringSet(editor, GBPrefs.CALENDAR_BLACKLIST, calendars_blacklist);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 457          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458      }                                                                                                             </span>
<span  style=""> 459                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 460      /**                                                                                                           </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 461       * Deletes both the old Activity database and the new one recreates it with empty tables.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 462       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 463       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 464       */                                                                                                           </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 465      public static synchronized boolean deleteActivityDatabase(Context context) {                                  </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 466          // TODO: flush, close, reopen db                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 467          if (lockHandler != null) {                                                                                </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 468              lockHandler.closeDb();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469          }                                                                                                         </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 470          boolean result = deleteOldActivityDatabase(context);                                                      </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 471          result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                                     </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 472          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473      }                                                                                                             </span>
<span  style=""> 474                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 475      /**                                                                                                           </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 476       * Deletes the legacy (pre 0.12) Activity database                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 477       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 478       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 479       */                                                                                                           </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 480      public static synchronized boolean deleteOldActivityDatabase(Context context) {                               </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 481          DBHelper dbHelper = new DBHelper(context);                                                                </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 482          boolean result = true;                                                                                    </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 483          if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                              </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 484              result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485          }                                                                                                         </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 486          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487      }                                                                                                             </span>
<span  style=""> 488                                                                                                                    </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 489      private int getPrefsFileVersion() {                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 490          try {                                                                                                     </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 491              return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 492          } catch (Exception e) {                                                                                   </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 493              //in version 1 this was an int                                                                        </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 494              return 1;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 495          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496      }                                                                                                             </span>
<span  style=""> 497                                                                                                                    </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 498      private void migratePrefs(int oldVersion) {                                                                   </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 499          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 500          switch (oldVersion) {                                                                                     </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 501              case 0:                                                                                               </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 502                  String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                              </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 503                  String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                           </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 504                  String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                           </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 505                  String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                          </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 506                  if (legacyGender != null) {                                                                       </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 507                      int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;         </span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 508                      editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));                    </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 509                      editor.remove(&quot;mi_user_gender&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510                  }                                                                                                 </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 511                  if (legacyHeight != null) {                                                                       </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 512                      editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                             </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 513                      editor.remove(&quot;mi_user_height_cm&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 514                  }                                                                                                 </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 515                  if (legacyWeigth != null) {                                                                       </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 516                      editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                             </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 517                      editor.remove(&quot;mi_user_weight_kg&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518                  }                                                                                                 </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 519                  if (legacyYOB != null) {                                                                          </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 520                      editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                            </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 521                      editor.remove(&quot;mi_user_year_of_birth&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522                  }                                                                                                 </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 523                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 524                  break;                                                                                            </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 525              case 1:                                                                                               </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 526                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 526                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the ðŸ”µ</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 527                  int legacyGender_1 = 2;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 528                  try {                                                                                             </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 529                      legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 530                  } catch (Exception e) {                                                                           </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 531                      Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532                  }                                                                                                 </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 533                  editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));                </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 534                  //also silently migrate the version to a string value                                             </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 535                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 536                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 538          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 539      }                                                                                                             </span>
<span  style=""> 540                                                                                                                    </span>
<span class="-3847609959270330161" onmouseenter="enter('-3847609959270330161');" onmouseout="out('-3847609959270330161');" style=""> 541      public static void setLanguage(String lang) {                                                                 </span>
<span class="2010165672364354755" onmouseenter="enter('2010165672364354755');" onmouseout="out('2010165672364354755');" style=""> 542          if (lang.equals(&quot;default&quot;)) {                                                                             </span>
<span class="-1084003509567751492" onmouseenter="enter('-1084003509567751492');" onmouseout="out('-1084003509567751492');" style=""> 543              language = Resources.getSystem().getConfiguration().locale;                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 544          } else {                                                                                                  </span>
<span class="-1687880958280815140" onmouseenter="enter('-1687880958280815140');" onmouseout="out('-1687880958280815140');" style=""> 545              language = new Locale(lang);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546          }                                                                                                         </span>
<span class="-6799828154341191236" onmouseenter="enter('-6799828154341191236');" onmouseout="out('-6799828154341191236');" style=""> 547          Configuration config = new Configuration();                                                               </span>
<span class="7136604939176469382" onmouseenter="enter('7136604939176469382');" onmouseout="out('7136604939176469382');" style=""> 548          config.setLocale(language);                                                                               </span>
<span  style=""> 549                                                                                                                    </span>
<span class="133641751450047465" onmouseenter="enter('133641751450047465');" onmouseout="out('133641751450047465');" style=""> 550          // FIXME: I have no idea what I am doing                                                                  </span>
<span class="-5594712779893326857" onmouseenter="enter('-5594712779893326857');" onmouseout="out('-5594712779893326857');" style=""> 551          context.getResources().updateConfiguration(config, context.getResources().getDisplayMetrics());           </span>





<span  style=""> 552                                                                                                                    </span>
<span class="535862575394010177" onmouseenter="enter('535862575394010177');" onmouseout="out('535862575394010177');" style=""> 553          Intent intent = new Intent();                                                                             </span>
<span class="-164638367863943974" onmouseenter="enter('-164638367863943974');" onmouseout="out('-164638367863943974');" style=""> 554          intent.setAction(ACTION_LANGUAGE_CHANGE);                                                                 </span>
<span class="4843300360101524365" onmouseenter="enter('4843300360101524365');" onmouseout="out('4843300360101524365');" style=""> 555          LocalBroadcastManager.getInstance(context).sendBroadcast(intent);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 556      }                                                                                                             </span>
<span  style=""> 557                                                                                                                    </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 558      public static LimitedQueue getIDSenderLookup() {                                                              </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 559          return mIDSenderLookup;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 560      }                                                                                                             </span>
<span  style=""> 561                                                                                                                    </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 562      public static boolean isDarkThemeEnabled() {                                                                  </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 563          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 563          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(contexðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 564      }                                                                                                             </span>
<span  style=""> 565                                                                                                                    </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 566      public static int getTextColor(Context context) {                                                             </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 567          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 568          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 569          theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                                        </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 570          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 571      }                                                                                                             </span>
<span  style=""> 572                                                                                                                    </span>






<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 573      public static int getBackgroundColor(Context context) {                                                       </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 574          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 575          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 576          theme.resolveAttribute(android.R.attr.background, typedValue, true);                                      </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 577          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578      }                                                                                                             </span>
<span  style=""> 579                                                                                                                    </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 580      public static Prefs getPrefs() {                                                                              </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 581          return prefs;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 582      }                                                                                                             </span>
<span  style=""> 583                                                                                                                    </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 584      public static GBPrefs getGBPrefs() {                                                                          </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 585          return gbPrefs;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 586      }                                                                                                             </span>
<span  style=""> 587                                                                                                                    </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 588      public DeviceManager getDeviceManager() {                                                                     </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 589          return deviceManager;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590      }                                                                                                             </span>
<span  style=""> 591                                                                                                                    </span>
<span class="-1673519419532841409" onmouseenter="enter('-1673519419532841409');" onmouseout="out('-1673519419532841409');" style=""> 592      public static GBApplication app() {                                                                           </span>
<span class="-5545492324510288114" onmouseenter="enter('-5545492324510288114');" onmouseout="out('-5545492324510288114');" style=""> 593          return app;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594      }                                                                                                             </span>
<span  style=""> 595                                                                                                                    </span>
<span class="4339444706683048648" onmouseenter="enter('4339444706683048648');" onmouseout="out('4339444706683048648');" style=""> 596      public static Locale getLanguage() {                                                                          </span>
<span class="8742914849630491523" onmouseenter="enter('8742914849630491523');" onmouseout="out('8742914849630491523');" style=""> 597          return language;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 599  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1  /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                          </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2      Gobbetti, Normano64                                                                                           </span>
<span  style="">   3                                                                                                                    </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4      This file is part of Gadgetbridge.                                                                            </span>
<span  style="">   5                                                                                                                    </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6      Gadgetbridge is free software: you can redistribute it and/or modify                                          </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7      it under the terms of the GNU Affero General Public License as published                                      </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8      by the Free Software Foundation, either version 3 of the License, or                                          </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9      (at your option) any later version.                                                                           </span>
<span  style="">  10                                                                                                                    </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11      Gadgetbridge is distributed in the hope that it will be useful,                                               </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12      but WITHOUT ANY WARRANTY; without even the implied warranty of                                                </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                                 </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14      GNU Affero General Public License for more details.                                                           </span>
<span  style="">  15                                                                                                                    </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16      You should have received a copy of the GNU Affero General Public License                                      </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17      along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                                      </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18  package nodomain.freeyourgadget.gadgetbridge;                                                                     </span>
<span  style="">  19                                                                                                                    </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20  import android.annotation.TargetApi;                                                                              </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21  import android.app.Application;                                                                                   </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22  import android.app.NotificationManager;                                                                           </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23  import android.app.NotificationManager.Policy;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25  import android.content.Intent;                                                                                    </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26  import android.content.SharedPreferences;                                                                         </span>
<span class="-9179032954578521484" onmouseenter="enter('-9179032954578521484');" onmouseout="out('-9179032954578521484');" style="">  27  import android.content.res.Configuration;                                                                         </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  28  import android.content.res.Resources;                                                                             </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  29  import android.database.Cursor;                                                                                   </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  30  import android.database.sqlite.SQLiteDatabase;                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  31  import android.net.Uri;                                                                                           </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  32  import android.os.Build;                                                                                          </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  33  import android.os.Build.VERSION;                                                                                  </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  34  import android.preference.PreferenceManager;                                                                      </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  35  import android.provider.ContactsContract.PhoneLookup;                                                             </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  36  import android.support.v4.content.LocalBroadcastManager;                                                          </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  37  import android.util.Log;                                                                                          </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  38  import android.util.TypedValue;                                                                                   </span>
<span  style="">  39                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  40  import java.io.File;                                                                                              </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  41  import java.io.IOException;                                                                                       </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  42  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  43  import java.util.List;                                                                                            </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  44  import java.util.Locale;                                                                                          </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  45  import java.util.Set;                                                                                             </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  46  import java.util.concurrent.TimeUnit;                                                                             </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  47  import java.util.concurrent.locks.Lock;                                                                           </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  48  import java.util.concurrent.locks.ReentrantLock;                                                                  </span>
<span  style="">  49                                                                                                                    </span>

<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  50  import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                                   </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  51  import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                                    </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  52  import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                                </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  53  import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                                </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  54  import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                                   </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  55  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  56  import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                                 </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  57  import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                                   </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  58  import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                                  </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="">  59  import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                          </span>
<span class="-2183458107255372167" onmouseenter="enter('-2183458107255372167');" onmouseout="out('-2183458107255372167');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +import nodomain.freeyourgadget.gadgetbridge.util.AndroidUtils;                                                    </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  61  import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                                       </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  62  import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                              </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  63  import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                         </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  64  import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                                    </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  65  import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                           </span>
<span  style="">  66                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  67  /**                                                                                                               </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  68   * Main Application class that initializes and provides access to certain things like                             </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  69   * logging and DB access.                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  70   */                                                                                                               </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  71  public class GBApplication extends Application {                                                                  </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  72      // Since this class must not log to slf4j, we use plain android.util.Log                                      </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  73      private static final String TAG = &quot;GBApplication&quot;;                                                            </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  74      public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                                    </span>
<span  style="">  75                                                                                                                    </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  76      private static GBApplication context;                                                                         </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  77      private static final Lock dbLock = new ReentrantLock();                                                       </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  78      private static DeviceService deviceService;                                                                   </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  79      private static SharedPreferences sharedPrefs;                                                                 </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  80      private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                                     </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  81      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  81      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs beloðŸ”µ</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  82      private static final int CURRENT_PREFS_VERSION = 2;                                                           </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  83      private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                           </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  84      private static Prefs prefs;                                                                                   </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  85      private static GBPrefs gbPrefs;                                                                               </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  86      private static LockHandler lockHandler;                                                                       </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  87      /**                                                                                                           </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  88       * Note: is null on Lollipop and Kitkat                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  89       */                                                                                                           </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  90      private static NotificationManager notificationManager;                                                       </span>
<span  style="">  91                                                                                                                    </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style="">  92      public static final String ACTION_QUIT                                                                        </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style="">  93              = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                                   </span>
<span class="3620791290214227219" onmouseenter="enter('3620791290214227219');" onmouseout="out('3620791290214227219');" style=""><abbr title="  94      public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.language_change&quot;;">  94      public static final String ACTION_LANGUAGE_CHANGE = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.actionðŸ”µ</abbr></span>
<span  style="">  95                                                                                                                    </span>
<span class="-6827183296325807512" onmouseenter="enter('-6827183296325807512');" onmouseout="out('-6827183296325807512');" style="">  96      private static GBApplication app;                                                                             </span>
<span  style="">  97                                                                                                                    </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style="">  98      private static Logging logging = new Logging() {                                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  99          @Override                                                                                                 </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style=""> 100          protected String createLogDirectory() throws IOException {                                                </span>
<span class="9110710162536643525" onmouseenter="enter('9110710162536643525');" onmouseout="out('9110710162536643525');" style=""> 101              if (GBEnvironment.env().isLocalTest()) {                                                              </span>
<span class="-6519269446490050835" onmouseenter="enter('-6519269446490050835');" onmouseout="out('-6519269446490050835');" style=""> 102                  return System.getProperty(Logging.PROP_LOGFILES_DIR);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 103              } else {                                                                                              </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style=""> 104                  File dir = FileUtils.getExternalFilesDir();                                                       </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style=""> 105                  return dir.getAbsolutePath();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 108      };                                                                                                            </span>
<span class="-466220917116319233" onmouseenter="enter('-466220917116319233');" onmouseout="out('-466220917116319233');" style=""> 109      private static Locale language;                                                                               </span>
<span  style=""> 110                                                                                                                    </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 111      private DeviceManager deviceManager;                                                                          </span>
<span  style=""> 112                                                                                                                    </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 113      public static void quit() {                                                                                   </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 114          GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                                        </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 115          Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                                </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 116          LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                                     </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 117          GBApplication.deviceService().quit();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118      }                                                                                                             </span>
<span  style=""> 119                                                                                                                    </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 120      public GBApplication() {                                                                                      </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 121          context = this;                                                                                           </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 122          // don&#x27;t do anything here, add it to onCreate instead                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123      }                                                                                                             </span>
<span  style=""> 124                                                                                                                    </span>
<span class="7323683286886200939" onmouseenter="enter('7323683286886200939');" onmouseout="out('7323683286886200939');" style=""> 125      public static Logging getLogging() {                                                                          </span>
<span class="3757797739027293534" onmouseenter="enter('3757797739027293534');" onmouseout="out('3757797739027293534');" style=""> 126          return logging;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127      }                                                                                                             </span>
<span  style=""> 128                                                                                                                    </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 129      protected DeviceService createDeviceService() {                                                               </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 130          return new GBDeviceService(this);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131      }                                                                                                             </span>
<span  style=""> 132                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 133      @Override                                                                                                     </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 134      public void onCreate() {                                                                                      </span>
<span class="-8156783544820381420" onmouseenter="enter('-8156783544820381420');" onmouseout="out('-8156783544820381420');" style=""> 135          app = this;                                                                                               </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 136          super.onCreate();                                                                                         </span>
<span  style=""> 137                                                                                                                    </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 138          if (lockHandler != null) {                                                                                </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 139              // guard against multiple invocations (robolectric)                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 140              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141          }                                                                                                         </span>
<span  style=""> 142                                                                                                                    </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 143          sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                                     </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 144          prefs = new Prefs(sharedPrefs);                                                                           </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 145          gbPrefs = new GBPrefs(prefs);                                                                             </span>
<span  style=""> 146                                                                                                                    </span>
<span class="-7675320667911398446" onmouseenter="enter('-7675320667911398446');" onmouseout="out('-7675320667911398446');" style=""> 147          if (!GBEnvironment.isEnvironmentSetup()) {                                                                </span>
<span class="-2266666929574149874" onmouseenter="enter('-2266666929574149874');" onmouseout="out('-2266666929574149874');" style=""> 148              GBEnvironment.setupEnvironment(GBEnvironment.createDeviceEnvironment());                              </span>
<span class="-3738634480535142994" onmouseenter="enter('-3738634480535142994');" onmouseout="out('-3738634480535142994');" style=""> 149              // setup db after the environment is set up, but don&#x27;t do it in test mode                             </span>
<span class="5829052537828666407" onmouseenter="enter('5829052537828666407');" onmouseout="out('5829052537828666407');" style=""> 150              // in test mode, it&#x27;s done individually, see TestBase                                                 </span>
<span class="5177995110342670479" onmouseenter="enter('5177995110342670479');" onmouseout="out('5177995110342670479');" style=""> 151              setupDatabase();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152          }                                                                                                         </span>
<span  style=""> 153                                                                                                                    </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 154          // don&#x27;t do anything here before we set up logging, otherwise                                             </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 155          // slf4j may be implicitly initialized before we properly configured it.                                  </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 156          setupLogging(isFileLoggingEnabled());                                                                     </span>
<span  style=""> 157                                                                                                                    </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 158          if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                                     </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 159              migratePrefs(getPrefsFileVersion());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160          }                                                                                                         </span>
<span  style=""> 161                                                                                                                    </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 162          setupExceptionHandler();                                                                                  </span>
<span  style=""> 163                                                                                                                    </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 164          deviceManager = new DeviceManager(this);                                                                  </span>
<span class="5344675729095119335" onmouseenter="enter('5344675729095119335');" onmouseout="out('5344675729095119335');" style=""> 165          String language = prefs.getString(&quot;language&quot;, &quot;default&quot;);                                                 </span>
<span class="-4352228919314969984" onmouseenter="enter('-4352228919314969984');" onmouseout="out('-4352228919314969984');" style=""> 166          setLanguage(language);                                                                                    </span>
<span  style=""> 167                                                                                                                    </span>


<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 168          deviceService = createDeviceService();                                                                    </span>
<span class="-7443536723725935642" onmouseenter="enter('-7443536723725935642');" onmouseout="out('-7443536723725935642');" style=""> 169          loadAppsBlackList();                                                                                      </span>
<span class="-5451989795140418224" onmouseenter="enter('-5451989795140418224');" onmouseout="out('-5451989795140418224');" style=""> 170          loadCalendarsBlackList();                                                                                 </span>
<span  style=""> 171                                                                                                                    </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 172          if (isRunningMarshmallowOrLater()) {                                                                      </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""> 173              notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);   </span>
<span class="-3292367781642785183" onmouseenter="enter('-3292367781642785183');" onmouseout="out('-3292367781642785183');" style=""> 174              //the following will ensure the notification manager is kept alive                                    </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 175              startService(new Intent(this, NotificationCollectorMonitorService.class));                            </span>








<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177      }                                                                                                             </span>
<span  style=""> 178                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 179      @Override                                                                                                     </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 180      public void onTrimMemory(int level) {                                                                         </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 181          super.onTrimMemory(level);                                                                                </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 182          if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                                    </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 183              if (!hasBusyDevice()) {                                                                               </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 184                  DBHelper.clearSession();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187      }                                                                                                             </span>
<span  style=""> 188                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 189      /**                                                                                                           </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 190       * Returns true if at least a single device is busy, e.g synchronizing activity data                          </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 191       * or something similar.                                                                                      </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 192       * Note: busy is not the same as connected or initialized!                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 193       */                                                                                                           </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 194      private boolean hasBusyDevice() {                                                                             </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 195          List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                                 </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 196          for (GBDevice device : devices) {                                                                         </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 197              if (device.isBusy()) {                                                                                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 198                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 201          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202      }                                                                                                             </span>
<span  style=""> 203                                                                                                                    </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 204      public static void setupLogging(boolean enabled) {                                                            </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 205          logging.setupLogging(enabled);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206      }                                                                                                             </span>
<span  style=""> 207                                                                                                                    </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 208      private void setupExceptionHandler() {                                                                        </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 209          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 209          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler())ðŸ”µ</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 210          Thread.setDefaultUncaughtExceptionHandler(handler);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211      }                                                                                                             </span>
<span  style=""> 212                                                                                                                    </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 213      public static boolean isFileLoggingEnabled() {                                                                </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 214          return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215      }                                                                                                             </span>
<span  style=""> 216                                                                                                                    </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 217      public static boolean minimizeNotification() {                                                                </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 218          return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219      }                                                                                                             </span>
<span  style=""> 220                                                                                                                    </span>
<span class="3584575502170839042" onmouseenter="enter('3584575502170839042');" onmouseout="out('3584575502170839042');" style=""> 221      public void setupDatabase() {                                                                                 </span>
<span class="-3757253101115813818" onmouseenter="enter('-3757253101115813818');" onmouseout="out('-3757253101115813818');" style=""> 222          DaoMaster.OpenHelper helper;                                                                              </span>
<span class="9128810292226701201" onmouseenter="enter('9128810292226701201');" onmouseout="out('9128810292226701201');" style=""> 223          GBEnvironment env = GBEnvironment.env();                                                                  </span>
<span class="7076376602711179030" onmouseenter="enter('7076376602711179030');" onmouseout="out('7076376602711179030');" style=""> 224          if (env.isTest()) {                                                                                       </span>
<span class="-4283816386875317195" onmouseenter="enter('-4283816386875317195');" onmouseout="out('-4283816386875317195');" style=""> 225              helper = new DaoMaster.DevOpenHelper(this, null, null);                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 226          } else {                                                                                                  </span>
<span class="4579041963248283587" onmouseenter="enter('4579041963248283587');" onmouseout="out('4579041963248283587');" style=""> 227              helper = new DBOpenHelper(this, DATABASE_NAME, null);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228          }                                                                                                         </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 229          SQLiteDatabase db = helper.getWritableDatabase();                                                         </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 230          DaoMaster daoMaster = new DaoMaster(db);                                                                  </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 231          if (lockHandler == null) {                                                                                </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 232              lockHandler = new LockHandler();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233          }                                                                                                         </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 234          lockHandler.init(daoMaster, helper);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235      }                                                                                                             </span>
<span  style=""> 236                                                                                                                    </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 237      public static Context getContext() {                                                                          </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 238          return context;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239      }                                                                                                             </span>
<span  style=""> 240                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 241      /**                                                                                                           </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 242       * Returns the facade for talking to devices. Devices are managed by                                          </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 243       * an Android Service and this facade provides access to its functionality.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 244       *                                                                                                            </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 245       * @return the facade for talking to the service/devices.                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 246       */                                                                                                           </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 247      public static DeviceService deviceService() {                                                                 </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 248          return deviceService;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249      }                                                                                                             </span>
<span  style=""> 250                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 251      /**                                                                                                           </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 252       * Returns the DBHandler instance for reading/writing or throws GBException                                   </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 253       * when that was not successful                                                                               </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 254       * If acquiring was successful, callers must call #releaseDB when they                                        </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 255       * are done (from the same thread that acquired the lock!                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 256       * &lt;p&gt;                                                                                                        </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 257       * Callers must not hold a reference to the returned instance because it                                      </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 258       * will be invalidated at some point.                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 259       *                                                                                                            </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 260       * @return the DBHandler                                                                                      </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 261       * @throws GBException                                                                                        </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 262       * @see #releaseDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 263       */                                                                                                           </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 264      public static DBHandler acquireDB() throws GBException {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 265          try {                                                                                                     </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 266              if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                           </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 267                  return lockHandler;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268              }                                                                                                     </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 269          } catch (InterruptedException ex) {                                                                       </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 270              Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271          }                                                                                                         </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 272          throw new GBException(&quot;Unable to access the database.&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273      }                                                                                                             </span>
<span  style=""> 274                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 275      /**                                                                                                           </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 276       * Releases the database lock.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 277       *                                                                                                            </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 278       * @throws IllegalMonitorStateException if the current thread is not owning the lock                          </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 279       * @see #acquireDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 280       */                                                                                                           </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 281      public static void releaseDB() {                                                                              </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 282          dbLock.unlock();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283      }                                                                                                             </span>
<span  style=""> 284                                                                                                                    </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 285      public static boolean isRunningLollipopOrLater() {                                                            </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 286          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287      }                                                                                                             </span>
<span  style=""> 288                                                                                                                    </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 289      public static boolean isRunningMarshmallowOrLater() {                                                         </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 290          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291      }                                                                                                             </span>
<span  style=""> 292                                                                                                                    </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 293      private static boolean isPrioritySender(int prioritySenders, String number) {                                 </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 294          if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 295              return true;                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 296          } else {                                                                                                  </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 297              Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));                   </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 298              String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                             </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 299              Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);                </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 300              boolean exists = false;                                                                               </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 301              int starred = 0;                                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 302              try {                                                                                                 </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 303                  if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                                     </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 304                      exists = true;                                                                                </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 305                      starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306                  }                                                                                                 </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 307              } finally {                                                                                           </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 308                  if (cursor != null) {                                                                             </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 309                      cursor.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311              }                                                                                                     </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 312              if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 313                  return true;                                                                                      </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 314              } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 315                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316              }                                                                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 317              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319      }                                                                                                             </span>
<span  style=""> 320                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 321      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 322      public static boolean isPriorityNumber(int priorityType, String number) {                                     </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 323          NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();              </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 324          if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                                  </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 325              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 325              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATðŸ”µ</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 326                  return isPrioritySender(notificationPolicy.priorityMessageSenders, number);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327              }                                                                                                     </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 328          } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                              </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 329              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 329              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGOðŸ”µ</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 330                  return isPrioritySender(notificationPolicy.priorityCallSenders, number);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 333          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334      }                                                                                                             </span>
<span  style=""> 335                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 336      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 337      public static int getGrantedInterruptionFilter() {                                                            </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""> 338          if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {      </span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 339              if (notificationManager.isNotificationPolicyAccessGranted()) {                                        </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 340                  return notificationManager.getCurrentInterruptionFilter();                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342          }                                                                                                         </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 343          return NotificationManager.INTERRUPTION_FILTER_ALL;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 344      }                                                                                                             </span>
<span  style=""> 345                                                                                                                    </span>
<span class="-9029891236967858826" onmouseenter="enter('-9029891236967858826');" onmouseout="out('-9029891236967858826');" style=""> 346      private static HashSet&lt;String&gt; apps_blacklist = null;                                                         </span>
<span  style=""> 347                                                                                                                    </span>
<span class="628937876596348808" onmouseenter="enter('628937876596348808');" onmouseout="out('628937876596348808');" style=""> 348      public static boolean appIsBlacklisted(String packageName) {                                                  </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 349          if (apps_blacklist == null) {                                                                             </span>
<span class="-1946294913030942780" onmouseenter="enter('-1946294913030942780');" onmouseout="out('-1946294913030942780');" style=""> 350              GB.log(&quot;appIsBlacklisted: apps_blacklist is null!&quot;, GB.INFO, null);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351          }                                                                                                         </span>
<span class="1884921446555776787" onmouseenter="enter('1884921446555776787');" onmouseout="out('1884921446555776787');" style=""> 352          return apps_blacklist != null &amp;&amp; apps_blacklist.contains(packageName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353      }                                                                                                             </span>
<span  style=""> 354                                                                                                                    </span>
<span class="7953897085511400770" onmouseenter="enter('7953897085511400770');" onmouseout="out('7953897085511400770');" style=""> 355      public static void setAppsBlackList(Set&lt;String&gt; packageNames) {                                               </span>
<span class="-8197290468385298169" onmouseenter="enter('-8197290468385298169');" onmouseout="out('-8197290468385298169');" style=""> 356          if (packageNames == null) {                                                                               </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 357              GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                                     </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 358              apps_blacklist = new HashSet&lt;&gt;();                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 359          } else {                                                                                                  </span>
<span class="-3015046103246507563" onmouseenter="enter('-3015046103246507563');" onmouseout="out('-3015046103246507563');" style=""> 360              apps_blacklist = new HashSet&lt;&gt;(packageNames);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361          }                                                                                                         </span>
<span class="7291510234597289182" onmouseenter="enter('7291510234597289182');" onmouseout="out('7291510234597289182');" style=""> 362          GB.log(&quot;New apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);                    </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 363          saveAppsBlackList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364      }                                                                                                             </span>
<span  style=""> 365                                                                                                                    </span>
<span class="-4764637370834062607" onmouseenter="enter('-4764637370834062607');" onmouseout="out('-4764637370834062607');" style=""> 366      private static void loadAppsBlackList() {                                                                     </span>
<span class="-7366183400676760194" onmouseenter="enter('-7366183400676760194');" onmouseout="out('-7366183400676760194');" style=""> 367          GB.log(&quot;Loading apps_blacklist&quot;, GB.INFO, null);                                                          </span>
<span class="-1377772229847163824" onmouseenter="enter('-1377772229847163824');" onmouseout="out('-1377772229847163824');" style=""> 368          apps_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.PACKAGE_BLACKLIST, null);             </span>
<span class="-7866931991939484661" onmouseenter="enter('-7866931991939484661');" onmouseout="out('-7866931991939484661');" style=""> 369          if (apps_blacklist == null) {                                                                             </span>
<span class="4032076944324717341" onmouseenter="enter('4032076944324717341');" onmouseout="out('4032076944324717341');" style=""> 370              apps_blacklist = new HashSet&lt;&gt;();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371          }                                                                                                         </span>
<span class="-1532140920596176818" onmouseenter="enter('-1532140920596176818');" onmouseout="out('-1532140920596176818');" style=""> 372          GB.log(&quot;Loaded apps_blacklist has &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373      }                                                                                                             </span>
<span  style=""> 374                                                                                                                    </span>
<span class="6267616075496604119" onmouseenter="enter('6267616075496604119');" onmouseout="out('6267616075496604119');" style=""> 375      private static void saveAppsBlackList() {                                                                     </span>
<span class="2886231841558584460" onmouseenter="enter('2886231841558584460');" onmouseout="out('2886231841558584460');" style=""> 376          GB.log(&quot;Saving apps_blacklist with &quot; + apps_blacklist.size() + &quot; entries&quot;, GB.INFO, null);                </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 377          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-7981649915035584664" onmouseenter="enter('-7981649915035584664');" onmouseout="out('-7981649915035584664');" style=""> 378          if (apps_blacklist.isEmpty()) {                                                                           </span>
<span class="-7815879823137819644" onmouseenter="enter('-7815879823137819644');" onmouseout="out('-7815879823137819644');" style=""> 379              editor.putStringSet(GBPrefs.PACKAGE_BLACKLIST, null);                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 380          } else {                                                                                                  </span>
<span class="-85230520183976524" onmouseenter="enter('-85230520183976524');" onmouseout="out('-85230520183976524');" style=""> 381              Prefs.putStringSet(editor, GBPrefs.PACKAGE_BLACKLIST, apps_blacklist);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 383          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384      }                                                                                                             </span>
<span  style=""> 385                                                                                                                    </span>
<span class="3406803570609530272" onmouseenter="enter('3406803570609530272');" onmouseout="out('3406803570609530272');" style=""> 386      public static void addAppToBlacklist(String packageName) {                                                    </span>
<span class="-4613377587158803622" onmouseenter="enter('-4613377587158803622');" onmouseout="out('-4613377587158803622');" style=""> 387          if (apps_blacklist.add(packageName)) {                                                                    </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 388              saveAppsBlackList();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390      }                                                                                                             </span>
<span  style=""> 391                                                                                                                    </span>
<span class="6341305090216699567" onmouseenter="enter('6341305090216699567');" onmouseout="out('6341305090216699567');" style=""> 392      public static synchronized void removeFromAppsBlacklist(String packageName) {                                 </span>
<span class="6848681783835366738" onmouseenter="enter('6848681783835366738');" onmouseout="out('6848681783835366738');" style=""> 393          GB.log(&quot;Removing from apps_blacklist: &quot; + packageName, GB.INFO, null);                                    </span>
<span class="1898542166501963208" onmouseenter="enter('1898542166501963208');" onmouseout="out('1898542166501963208');" style=""> 394          apps_blacklist.remove(packageName);                                                                       </span>
<span class="-2995734684500033412" onmouseenter="enter('-2995734684500033412');" onmouseout="out('-2995734684500033412');" style=""> 395          saveAppsBlackList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396      }                                                                                                             </span>
<span  style=""> 397                                                                                                                    </span>
<span class="-1625652503048685789" onmouseenter="enter('-1625652503048685789');" onmouseout="out('-1625652503048685789');" style=""> 398      private static HashSet&lt;String&gt; calendars_blacklist = null;                                                    </span>
<span  style=""> 399                                                                                                                    </span>
<span class="7038688512705390946" onmouseenter="enter('7038688512705390946');" onmouseout="out('7038688512705390946');" style=""> 400      public static boolean calendarIsBlacklisted(String calendarDisplayName) {                                     </span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 401          if (calendars_blacklist == null) {                                                                        </span>
<span class="2679978338359393788" onmouseenter="enter('2679978338359393788');" onmouseout="out('2679978338359393788');" style=""> 402              GB.log(&quot;calendarIsBlacklisted: calendars_blacklist is null!&quot;, GB.INFO, null);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403          }                                                                                                         </span>
<span class="-6083844107851171159" onmouseenter="enter('-6083844107851171159');" onmouseout="out('-6083844107851171159');" style=""> 404          return calendars_blacklist != null &amp;&amp; calendars_blacklist.contains(calendarDisplayName);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405      }                                                                                                             </span>
<span  style=""> 406                                                                                                                    </span>
<span class="-1203782580073493681" onmouseenter="enter('-1203782580073493681');" onmouseout="out('-1203782580073493681');" style=""> 407      public static void setCalendarsBlackList(Set&lt;String&gt; calendarNames) {                                         </span>
<span class="9006806600947611848" onmouseenter="enter('9006806600947611848');" onmouseout="out('9006806600947611848');" style=""> 408          if (calendarNames == null) {                                                                              </span>
<span class="8011861988992627761" onmouseenter="enter('8011861988992627761');" onmouseout="out('8011861988992627761');" style=""> 409              GB.log(&quot;Set null apps_blacklist&quot;, GB.INFO, null);                                                     </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 410              calendars_blacklist = new HashSet&lt;&gt;();                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 411          } else {                                                                                                  </span>
<span class="-5832993308357266278" onmouseenter="enter('-5832993308357266278');" onmouseout="out('-5832993308357266278');" style=""> 412              calendars_blacklist = new HashSet&lt;&gt;(calendarNames);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413          }                                                                                                         </span>
<span class="-2685264550992926452" onmouseenter="enter('-2685264550992926452');" onmouseout="out('-2685264550992926452');" style=""> 414          GB.log(&quot;New calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);          </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 415          saveCalendarsBlackList();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416      }                                                                                                             </span>
<span  style=""> 417                                                                                                                    </span>
<span class="-1352938694099643130" onmouseenter="enter('-1352938694099643130');" onmouseout="out('-1352938694099643130');" style=""> 418      public static void addCalendarToBlacklist(String calendarDisplayName) {                                       </span>
<span class="5135070223261002446" onmouseenter="enter('5135070223261002446');" onmouseout="out('5135070223261002446');" style=""> 419          if (calendars_blacklist.add(calendarDisplayName)) {                                                       </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 420              saveCalendarsBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422      }                                                                                                             </span>
<span  style=""> 423                                                                                                                    </span>
<span class="-4191679597070541210" onmouseenter="enter('-4191679597070541210');" onmouseout="out('-4191679597070541210');" style=""> 424      public static void removeFromCalendarBlacklist(String calendarDisplayName) {                                  </span>
<span class="-3543064320447564137" onmouseenter="enter('-3543064320447564137');" onmouseout="out('-3543064320447564137');" style=""> 425          calendars_blacklist.remove(calendarDisplayName);                                                          </span>
<span class="4109182306492151004" onmouseenter="enter('4109182306492151004');" onmouseout="out('4109182306492151004');" style=""> 426          saveCalendarsBlackList();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427      }                                                                                                             </span>
<span  style=""> 428                                                                                                                    </span>
<span class="8449352248946474476" onmouseenter="enter('8449352248946474476');" onmouseout="out('8449352248946474476');" style=""> 429      private static void loadCalendarsBlackList() {                                                                </span>
<span class="929362169649938726" onmouseenter="enter('929362169649938726');" onmouseout="out('929362169649938726');" style=""> 430          GB.log(&quot;Loading calendars_blacklist&quot;, GB.INFO, null);                                                     </span>
<span class="-3197959776357605547" onmouseenter="enter('-3197959776357605547');" onmouseout="out('-3197959776357605547');" style=""> 431          calendars_blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(GBPrefs.CALENDAR_BLACKLIST, null);       </span>
<span class="-3661250670337549793" onmouseenter="enter('-3661250670337549793');" onmouseout="out('-3661250670337549793');" style=""> 432          if (calendars_blacklist == null) {                                                                        </span>
<span class="-6817255855205812342" onmouseenter="enter('-6817255855205812342');" onmouseout="out('-6817255855205812342');" style=""> 433              calendars_blacklist = new HashSet&lt;&gt;();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434          }                                                                                                         </span>
<span class="-7148420027100342883" onmouseenter="enter('-7148420027100342883');" onmouseout="out('-7148420027100342883');" style=""> 435          GB.log(&quot;Loaded calendars_blacklist has &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436      }                                                                                                             </span>
<span  style=""> 437                                                                                                                    </span>
<span class="2309319604958063821" onmouseenter="enter('2309319604958063821');" onmouseout="out('2309319604958063821');" style=""> 438      private static void saveCalendarsBlackList() {                                                                </span>
<span class="5173264045101766520" onmouseenter="enter('5173264045101766520');" onmouseout="out('5173264045101766520');" style=""> 439          GB.log(&quot;Saving calendars_blacklist with &quot; + calendars_blacklist.size() + &quot; entries&quot;, GB.INFO, null);      </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 440          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-7491519725598434790" onmouseenter="enter('-7491519725598434790');" onmouseout="out('-7491519725598434790');" style=""> 441          if (calendars_blacklist.isEmpty()) {                                                                      </span>
<span class="4243111498727581039" onmouseenter="enter('4243111498727581039');" onmouseout="out('4243111498727581039');" style=""> 442              editor.putStringSet(GBPrefs.CALENDAR_BLACKLIST, null);                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 443          } else {                                                                                                  </span>
<span class="-2454412986410082716" onmouseenter="enter('-2454412986410082716');" onmouseout="out('-2454412986410082716');" style=""> 444              Prefs.putStringSet(editor, GBPrefs.CALENDAR_BLACKLIST, calendars_blacklist);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 446          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447      }                                                                                                             </span>
<span  style=""> 448                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 449      /**                                                                                                           </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 450       * Deletes both the old Activity database and the new one recreates it with empty tables.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 451       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 452       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 453       */                                                                                                           </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 454      public static synchronized boolean deleteActivityDatabase(Context context) {                                  </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 455          // TODO: flush, close, reopen db                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 456          if (lockHandler != null) {                                                                                </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 457              lockHandler.closeDb();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458          }                                                                                                         </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 459          boolean result = deleteOldActivityDatabase(context);                                                      </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 460          result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                                     </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 461          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462      }                                                                                                             </span>
<span  style=""> 463                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 464      /**                                                                                                           </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 465       * Deletes the legacy (pre 0.12) Activity database                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 466       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 467       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 468       */                                                                                                           </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 469      public static synchronized boolean deleteOldActivityDatabase(Context context) {                               </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 470          DBHelper dbHelper = new DBHelper(context);                                                                </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 471          boolean result = true;                                                                                    </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 472          if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                              </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 473              result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474          }                                                                                                         </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 475          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476      }                                                                                                             </span>
<span  style=""> 477                                                                                                                    </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 478      private int getPrefsFileVersion() {                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 479          try {                                                                                                     </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 480              return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 481          } catch (Exception e) {                                                                                   </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 482              //in version 1 this was an int                                                                        </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 483              return 1;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485      }                                                                                                             </span>
<span  style=""> 486                                                                                                                    </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 487      private void migratePrefs(int oldVersion) {                                                                   </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 488          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 489          switch (oldVersion) {                                                                                     </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 490              case 0:                                                                                               </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 491                  String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                              </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 492                  String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                           </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 493                  String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                           </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 494                  String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                          </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 495                  if (legacyGender != null) {                                                                       </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 496                      int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;         </span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 497                      editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));                    </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 498                      editor.remove(&quot;mi_user_gender&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499                  }                                                                                                 </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 500                  if (legacyHeight != null) {                                                                       </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 501                      editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                             </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 502                      editor.remove(&quot;mi_user_height_cm&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503                  }                                                                                                 </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 504                  if (legacyWeigth != null) {                                                                       </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 505                      editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                             </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 506                      editor.remove(&quot;mi_user_weight_kg&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507                  }                                                                                                 </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 508                  if (legacyYOB != null) {                                                                          </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 509                      editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                            </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 510                      editor.remove(&quot;mi_user_year_of_birth&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511                  }                                                                                                 </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 512                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 513                  break;                                                                                            </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 514              case 1:                                                                                               </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 515                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 515                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the ðŸ”µ</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 516                  int legacyGender_1 = 2;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 517                  try {                                                                                             </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 518                      legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 519                  } catch (Exception e) {                                                                           </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 520                      Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521                  }                                                                                                 </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 522                  editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));                </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 523                  //also silently migrate the version to a string value                                             </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 524                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 525                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 527          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528      }                                                                                                             </span>
<span  style=""> 529                                                                                                                    </span>
<span class="-3847609959270330161" onmouseenter="enter('-3847609959270330161');" onmouseout="out('-3847609959270330161');" style=""> 530      public static void setLanguage(String lang) {                                                                 </span>
<span class="2010165672364354755" onmouseenter="enter('2010165672364354755');" onmouseout="out('2010165672364354755');" style=""> 531          if (lang.equals(&quot;default&quot;)) {                                                                             </span>
<span class="-1084003509567751492" onmouseenter="enter('-1084003509567751492');" onmouseout="out('-1084003509567751492');" style=""> 532              language = Resources.getSystem().getConfiguration().locale;                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 533          } else {                                                                                                  </span>
<span class="-1687880958280815140" onmouseenter="enter('-1687880958280815140');" onmouseout="out('-1687880958280815140');" style=""> 534              language = new Locale(lang);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535          }                                                                                                         </span>
<span class="-6799828154341191236" onmouseenter="enter('-6799828154341191236');" onmouseout="out('-6799828154341191236');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 536 -        Configuration config = new Configuration();                                                               </span>
<span class="7136604939176469382" onmouseenter="enter('7136604939176469382');" onmouseout="out('7136604939176469382');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 537 -        config.setLocale(language);                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 538 -                                                                                                                  </span>
<span class="133641751450047465" onmouseenter="enter('133641751450047465');" onmouseout="out('133641751450047465');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 539 -        // FIXME: I have no idea what I am doing                                                                  </span>
<span class="-5594712779893326857" onmouseenter="enter('-5594712779893326857');" onmouseout="out('-5594712779893326857');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 540 -        context.getResources().updateConfiguration(config, context.getResources().getDisplayMetrics());           </span>
<span class="-6135042183655095886" onmouseenter="enter('-6135042183655095886');" onmouseout="out('-6135042183655095886');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 541 +        updateLanguage(language);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 542 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 543 +                                                                                                                  </span>
<span class="5259621038207386847" onmouseenter="enter('5259621038207386847');" onmouseout="out('5259621038207386847');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 544 +    public static void updateLanguage(Locale locale) {                                                            </span>
<span class="1109198243690318720" onmouseenter="enter('1109198243690318720');" onmouseout="out('1109198243690318720');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 545 +        AndroidUtils.setLanguage(context, locale);                                                                </span>
<span  style=""> 546                                                                                                                    </span>
<span class="535862575394010177" onmouseenter="enter('535862575394010177');" onmouseout="out('535862575394010177');" style=""> 547          Intent intent = new Intent();                                                                             </span>
<span class="-164638367863943974" onmouseenter="enter('-164638367863943974');" onmouseout="out('-164638367863943974');" style=""> 548          intent.setAction(ACTION_LANGUAGE_CHANGE);                                                                 </span>
<span class="4843300360101524365" onmouseenter="enter('4843300360101524365');" onmouseout="out('4843300360101524365');" style=""> 549          LocalBroadcastManager.getInstance(context).sendBroadcast(intent);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550      }                                                                                                             </span>
<span  style=""> 551                                                                                                                    </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 552      public static LimitedQueue getIDSenderLookup() {                                                              </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 553          return mIDSenderLookup;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 554      }                                                                                                             </span>
<span  style=""> 555                                                                                                                    </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 556      public static boolean isDarkThemeEnabled() {                                                                  </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 557          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 557          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(contexðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558      }                                                                                                             </span>
<span  style=""> 559                                                                                                                    </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 560      public static int getTextColor(Context context) {                                                             </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 561          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 562          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 563          theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                                        </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 564          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 565      }                                                                                                             </span>
<span  style=""> 566                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 567 +    @Override                                                                                                     </span>
<span class="2483214837331013305" onmouseenter="enter('2483214837331013305');" onmouseout="out('2483214837331013305');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 568 +    public void onConfigurationChanged(Configuration newConfig) {                                                 </span>
<span class="-1478537389163372238" onmouseenter="enter('-1478537389163372238');" onmouseout="out('-1478537389163372238');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 569 +        super.onConfigurationChanged(newConfig);                                                                  </span>
<span class="2223384074430921263" onmouseenter="enter('2223384074430921263');" onmouseout="out('2223384074430921263');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 570 +        updateLanguage(getLanguage());                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 571 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 572 +                                                                                                                  </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 573      public static int getBackgroundColor(Context context) {                                                       </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 574          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 575          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 576          theme.resolveAttribute(android.R.attr.background, typedValue, true);                                      </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 577          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578      }                                                                                                             </span>
<span  style=""> 579                                                                                                                    </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 580      public static Prefs getPrefs() {                                                                              </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 581          return prefs;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 582      }                                                                                                             </span>
<span  style=""> 583                                                                                                                    </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 584      public static GBPrefs getGBPrefs() {                                                                          </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 585          return gbPrefs;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 586      }                                                                                                             </span>
<span  style=""> 587                                                                                                                    </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 588      public DeviceManager getDeviceManager() {                                                                     </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 589          return deviceManager;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590      }                                                                                                             </span>
<span  style=""> 591                                                                                                                    </span>
<span class="-1673519419532841409" onmouseenter="enter('-1673519419532841409');" onmouseout="out('-1673519419532841409');" style=""> 592      public static GBApplication app() {                                                                           </span>
<span class="-5545492324510288114" onmouseenter="enter('-5545492324510288114');" onmouseout="out('-5545492324510288114');" style=""> 593          return app;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594      }                                                                                                             </span>
<span  style=""> 595                                                                                                                    </span>
<span class="4339444706683048648" onmouseenter="enter('4339444706683048648');" onmouseout="out('4339444706683048648');" style=""> 596      public static Locale getLanguage() {                                                                          </span>
<span class="8742914849630491523" onmouseenter="enter('8742914849630491523');" onmouseout="out('8742914849630491523');" style=""> 597          return language;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 599  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            