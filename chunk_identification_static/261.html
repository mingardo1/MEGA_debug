<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>261</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    261
                    <a href="260.html">prev</a>
                    <a href="262.html">next</a>
                    <a href="261_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_30e3058e916f9dae3d97cc8ba5fb89c2999c645f_redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;30e3058e916f9dae3d97cc8ba5fb89c2999c645f:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;30e3058e916f9dae3d97cc8ba5fb89c2999c645f^1:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;30e3058e916f9dae3d97cc8ba5fb89c2999c645f^2:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;d022e4b01c20810044fc561a790109c3915a7708:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  21 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  22 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  23 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  24 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  25 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  26 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  28 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  29 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  30 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  31 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  32 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  33 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="-2524259626202941740" onmouseenter="enter('-2524259626202941740');" onmouseout="out('-2524259626202941740');" style="">  34 import io.lettuce.core.RedisURI;                                                                         </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  35 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  36 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  37 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  38 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  39 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  40 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  41 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  42 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  43 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  44 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  45 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span  style="">  46                                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  47 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  48 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="">  49 import java.util.Objects;                                                                                </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  50 import java.util.function.Consumer;                                                                      </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  51 import java.util.regex.Matcher;                                                                          </span>
<span  style="">  52                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  53 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  54  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  55  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  56 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  57                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  58     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  59                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  60     private RedisClient redisClient;                                                                     </span>
<span  style="">  61                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  62     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  63                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  64     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  65                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  66     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  67                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  68     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  69                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  70     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  71                                                                                                          </span>
<span class="7294087828322742276" onmouseenter="enter('7294087828322742276');" onmouseout="out('7294087828322742276');" style="">  72     private final RedisSideReqRow redisSideReqRow;                                                       </span>
<span  style="">  73                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  74     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  74     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  75         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-6270850474357319169" onmouseenter="enter('-6270850474357319169');" onmouseout="out('-6270850474357319169');" style="">  76         redisSideReqRow = new RedisSideReqRow(super.sideInfo, (RedisSideTableInfo) sideTableInfo);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77     }                                                                                                    </span>
<span  style="">  78                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  79     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  80     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  81         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  82         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  83         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  86     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  87         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  88         String password = redisSideTableInfo.getPassword();                                              </span>
<span  style="">  89                                                                                                          </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  90         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  91         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  92             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  94         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  95             case STANDALONE:                                                                             </span>
<span class="2121621884245667476" onmouseenter="enter('2121621884245667476');" onmouseout="out('2121621884245667476');" style="">  96                 RedisURI redisURI = RedisURI.create(&quot;redis://&quot; + url);                                   </span>
<span class="-2874159006221404812" onmouseenter="enter('-2874159006221404812');" onmouseout="out('-2874159006221404812');" style="">  97                 redisURI.setPassword(password);                                                          </span>
<span class="7633329922038274391" onmouseenter="enter('7633329922038274391');" onmouseout="out('7633329922038274391');" style="">  98                 redisURI.setDatabase(Integer.parseInt(database));                                        </span>
<span class="5148353327116752546" onmouseenter="enter('5148353327116752546');" onmouseout="out('5148353327116752546');" style="">  99                 redisClient = RedisClient.create(redisURI);                                              </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 100                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 101                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 102                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 103             case SENTINEL:                                                                               </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 104 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6840600257396794471" onmouseenter="enter('6840600257396794471');" onmouseout="out('6840600257396794471');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 105                 RedisURI redisSentinelURI = RedisURI.create(&quot;redis-sentinel://&quot; + url);                  </span>
<span class="5608287290966185827" onmouseenter="enter('5608287290966185827');" onmouseout="out('5608287290966185827');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 106                 redisSentinelURI.setPassword(password);                                                  </span>
<span class="4751558948604978604" onmouseenter="enter('4751558948604978604');" onmouseout="out('4751558948604978604');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 107                 redisSentinelURI.setDatabase(Integer.parseInt(database));                                </span>
<span class="6783411963682015775" onmouseenter="enter('6783411963682015775');" onmouseout="out('6783411963682015775');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 108                 redisSentinelURI.setSentinelMasterId(redisSideTableInfo.getMasterName());                </span>
<span class="-3337939030544591152" onmouseenter="enter('-3337939030544591152');" onmouseout="out('-3337939030544591152');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 109                 redisClient = RedisClient.create(redisSentinelURI);                                      </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 110 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="6840600257396794471" onmouseenter="enter('6840600257396794471');" onmouseout="out('6840600257396794471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111                 RedisURI redisSentinelURI = RedisURI.create(&quot;redis-sentinel://&quot; + url);                  </span>
<span class="5608287290966185827" onmouseenter="enter('5608287290966185827');" onmouseout="out('5608287290966185827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112                 redisSentinelURI.setPassword(password);                                                  </span>
<span class="8982839524192854704" onmouseenter="enter('8982839524192854704');" onmouseout="out('8982839524192854704');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113                 redisSentinelURI.setDatabase(Integer.valueOf(database));                                 </span>
<span class="6783411963682015775" onmouseenter="enter('6783411963682015775');" onmouseout="out('6783411963682015775');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114                 redisSentinelURI.setSentinelMasterId(redisSideTableInfo.getMasterName());                </span>
<span class="-3337939030544591152" onmouseenter="enter('-3337939030544591152');" onmouseout="out('-3337939030544591152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115                 redisClient = RedisClient.create(redisSentinelURI);                                      </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119             case CLUSTER:                                                                                </span>
<span class="-1232003316882934085" onmouseenter="enter('-1232003316882934085');" onmouseout="out('-1232003316882934085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120                 RedisURI clusterURI = RedisURI.create(&quot;redis://&quot; + url);                                 </span>
<span class="-6736113041303383524" onmouseenter="enter('-6736113041303383524');" onmouseout="out('-6736113041303383524');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121                 clusterURI.setPassword(password);                                                        </span>
<span class="-3535495827857877665" onmouseenter="enter('-3535495827857877665');" onmouseout="out('-3535495827857877665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122                 clusterClient = RedisClusterClient.create(clusterURI);                                   </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130     @Override                                                                                            </span>
<span class="2764971140877613779" onmouseenter="enter('2764971140877613779');" onmouseout="out('2764971140877613779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131     public BaseRow fillData(BaseRow input, Object sideInput) {                                           </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135     @Override                                                                                            </span>
<span class="-2468672087887077523" onmouseenter="enter('-2468672087887077523');" onmouseout="out('-2468672087887077523');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 136     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 136     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; rðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140         }                                                                                                </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 142 =======                                                                                                  </span>
<span class="-2791484299191497297" onmouseenter="enter('-2791484299191497297');" onmouseout="out('-2791484299191497297');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143                 String[] urlSplit = StringUtils.split(url, &quot;,&quot;);                                         </span>
<span class="423226683654134269" onmouseenter="enter('423226683654134269');" onmouseout="out('423226683654134269');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                 RedisURI.Builder builder = null;                                                         </span>
<span class="910408284979279714" onmouseenter="enter('910408284979279714');" onmouseout="out('910408284979279714');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145                 for (String item : urlSplit) {                                                           </span>
<span class="-513377933792792952" onmouseenter="enter('-513377933792792952');" onmouseout="out('-513377933792792952');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146                     Matcher mather = RedisSideReqRow.HOST_PORT_PATTERN.matcher(item);                    </span>
<span class="-5646142024278808605" onmouseenter="enter('-5646142024278808605');" onmouseout="out('-5646142024278808605');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147                     if (mather.find()) {                                                                 </span>
<span class="-6927514783972631089" onmouseenter="enter('-6927514783972631089');" onmouseout="out('-6927514783972631089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148                         builder = buildSentinelUri(                                                      </span>
<span class="-4625352577483463673" onmouseenter="enter('-4625352577483463673');" onmouseout="out('-4625352577483463673');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149                                 mather.group(&quot;host&quot;),                                                    </span>
<span class="-3744103454976238122" onmouseenter="enter('-3744103454976238122');" onmouseout="out('-3744103454976238122');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150                                 mather.group(&quot;port&quot;),                                                    </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151                                 builder                                                                  </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152                         );                                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                     } else {                                                                             </span>
<span class="-5454936540258631376" onmouseenter="enter('-5454936540258631376');" onmouseout="out('-5454936540258631376');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                         throw new IllegalArgumentException(                                              </span>
<span class="-51612453309450757" onmouseenter="enter('-51612453309450757');" onmouseout="out('-51612453309450757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155                                 String.format(&quot;Illegal format with redis url [%s]&quot;, item)                </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156                         );                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159                                                                                                          </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160                 if (Objects.nonNull(builder)) {                                                          </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161                     builder                                                                              </span>
<span class="6387121860922260106" onmouseenter="enter('6387121860922260106');" onmouseout="out('6387121860922260106');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162                             .withPassword(tableInfo.getPassword())                                       </span>
<span class="4468160857799094737" onmouseenter="enter('4468160857799094737');" onmouseout="out('4468160857799094737');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163                             .withDatabase(Integer.parseInt(tableInfo.getDatabase()))                     </span>
<span class="7019100605467766689" onmouseenter="enter('7019100605467766689');" onmouseout="out('7019100605467766689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164                             .withSentinelMasterId(tableInfo.getMasterName());                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165                 } else {                                                                                 </span>
<span class="8684235763561238790" onmouseenter="enter('8684235763561238790');" onmouseout="out('8684235763561238790');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166                     throw new NullPointerException(&quot;build redis uri error!&quot;);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168                                                                                                          </span>
<span class="-776007856786993542" onmouseenter="enter('-776007856786993542');" onmouseout="out('-776007856786993542');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169                 RedisURI uri = builder.build();                                                          </span>
<span class="2908648228718416574" onmouseenter="enter('2908648228718416574');" onmouseout="out('2908648228718416574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170                 redisClient = RedisClient.create(uri);                                                   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 171 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 172                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 173                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 174                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 175             case CLUSTER:                                                                                </span>
<span class="-1232003316882934085" onmouseenter="enter('-1232003316882934085');" onmouseout="out('-1232003316882934085');" style=""> 176                 RedisURI clusterURI = RedisURI.create(&quot;redis://&quot; + url);                                 </span>
<span class="-6736113041303383524" onmouseenter="enter('-6736113041303383524');" onmouseout="out('-6736113041303383524');" style=""> 177                 clusterURI.setPassword(password);                                                        </span>
<span class="-3535495827857877665" onmouseenter="enter('-3535495827857877665');" onmouseout="out('-3535495827857877665');" style=""> 178                 clusterClient = RedisClusterClient.create(clusterURI);                                   </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 179                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 180                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 181             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 182                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span  style=""> 185                                                                                                          </span>
<span class="-2408254141930996430" onmouseenter="enter('-2408254141930996430');" onmouseout="out('-2408254141930996430');" style=""> 186     private RedisURI.Builder buildSentinelUri(                                                           </span>
<span class="-857215016271929958" onmouseenter="enter('-857215016271929958');" onmouseout="out('-857215016271929958');" style=""> 187             String host,                                                                                 </span>
<span class="-6401167448936803376" onmouseenter="enter('-6401167448936803376');" onmouseout="out('-6401167448936803376');" style=""> 188             String port,                                                                                 </span>
<span class="-5720589329365192953" onmouseenter="enter('-5720589329365192953');" onmouseout="out('-5720589329365192953');" style=""> 189             RedisURI.Builder builder) {                                                                  </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style=""> 190         if (Objects.nonNull(builder)) {                                                                  </span>
<span class="-1025231635963132883" onmouseenter="enter('-1025231635963132883');" onmouseout="out('-1025231635963132883');" style=""> 191             builder.withSentinel(host, Integer.parseInt(port));                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 192         } else {                                                                                         </span>
<span class="-4728574802854133154" onmouseenter="enter('-4728574802854133154');" onmouseout="out('-4728574802854133154');" style=""> 193             builder = RedisURI.Builder.sentinel(host, Integer.parseInt(port));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194         }                                                                                                </span>
<span class="4801455624621135639" onmouseenter="enter('4801455624621135639');" onmouseout="out('4801455624621135639');" style=""> 195         return builder;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196     }                                                                                                    </span>
<span  style=""> 197                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 198     @Override                                                                                            </span>
<span class="2764971140877613779" onmouseenter="enter('2764971140877613779');" onmouseout="out('2764971140877613779');" style=""> 199     public BaseRow fillData(BaseRow input, Object sideInput) {                                           </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 200         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201     }                                                                                                    </span>
<span  style=""> 202                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 203     @Override                                                                                            </span>
<span class="-2468672087887077523" onmouseenter="enter('-2468672087887077523');" onmouseout="out('-2468672087887077523');" style=""><abbr title=" 204     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 204     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; rðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 205         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 206         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 207             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208         }                                                                                                </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 209         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="-1942501682256209221" onmouseenter="enter('-1942501682256209221');" onmouseout="out('-1942501682256209221');" style=""> 210         future.thenAccept(values -&gt; {                                                                    </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 211             if (MapUtils.isNotEmpty(values)) {                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 212                 try {                                                                                    </span>
<span class="-4104377924620833457" onmouseenter="enter('-4104377924620833457');" onmouseout="out('-4104377924620833457');" style=""> 213                     BaseRow row = fillData(input, values);                                               </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style=""> 214                     dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));        </span>
<span class="8992185222434351188" onmouseenter="enter('8992185222434351188');" onmouseout="out('8992185222434351188');" style=""> 215                     RowDataComplete.completeBaseRow(resultFuture, row);                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 216                 } catch (Exception e) {                                                                  </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 217                     dealFillDataError(input, resultFuture, e);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 219             } else {                                                                                     </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 220                 dealMissKey(input, resultFuture);                                                        </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 221                 dealCacheData(key, CacheMissVal.getMissKeyObj());                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 223         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224     }                                                                                                    </span>
<span  style=""> 225                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 226     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 227     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 228         return redisSideReqRow.buildCacheKey(refData);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229     }                                                                                                    </span>
<span  style=""> 230                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 231     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 232     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 233         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 234         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 235             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 237         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 238             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 240         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 241             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 243         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 244             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246     }                                                                                                    </span>
<span  style=""> 247                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  21 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  22 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  23 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  24 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  25 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  26 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  28 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  29 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  30 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  31 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  32 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  33 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="-2524259626202941740" onmouseenter="enter('-2524259626202941740');" onmouseout="out('-2524259626202941740');" style="">  34 import io.lettuce.core.RedisURI;                                                                         </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  35 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  36 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  37 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  38 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  39 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  40 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  41 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  42 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  43 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  44 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  45 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span  style="">  46                                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  47 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  48 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="">  49 import java.util.Objects;                                                                                </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  50 import java.util.function.Consumer;                                                                      </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  51 import java.util.regex.Matcher;                                                                          </span>
<span  style="">  52                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  53 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  54  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  55  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  56 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  57                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  58     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  59                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  60     private RedisClient redisClient;                                                                     </span>
<span  style="">  61                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  62     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  63                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  64     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  65                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  66     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  67                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  68     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  69                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  70     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  71                                                                                                          </span>
<span class="7294087828322742276" onmouseenter="enter('7294087828322742276');" onmouseout="out('7294087828322742276');" style="">  72     private final RedisSideReqRow redisSideReqRow;                                                       </span>
<span  style="">  73                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  74     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  74     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  75         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-6270850474357319169" onmouseenter="enter('-6270850474357319169');" onmouseout="out('-6270850474357319169');" style="">  76         redisSideReqRow = new RedisSideReqRow(super.sideInfo, (RedisSideTableInfo) sideTableInfo);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77     }                                                                                                    </span>
<span  style="">  78                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  79     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  80     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  81         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  82         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  83         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  86     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  87         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  88         String password = redisSideTableInfo.getPassword();                                              </span>
<span  style="">  89                                                                                                          </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  90         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  91         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  92             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  94         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  95             case STANDALONE:                                                                             </span>
<span class="2121621884245667476" onmouseenter="enter('2121621884245667476');" onmouseout="out('2121621884245667476');" style="">  96                 RedisURI redisURI = RedisURI.create(&quot;redis://&quot; + url);                                   </span>
<span class="-2874159006221404812" onmouseenter="enter('-2874159006221404812');" onmouseout="out('-2874159006221404812');" style="">  97                 redisURI.setPassword(password);                                                          </span>
<span class="7633329922038274391" onmouseenter="enter('7633329922038274391');" onmouseout="out('7633329922038274391');" style="">  98                 redisURI.setDatabase(Integer.parseInt(database));                                        </span>
<span class="5148353327116752546" onmouseenter="enter('5148353327116752546');" onmouseout="out('5148353327116752546');" style="">  99                 redisClient = RedisClient.create(redisURI);                                              </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 100                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 101                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 102                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 103             case SENTINEL:                                                                               </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 104 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="6840600257396794471" onmouseenter="enter('6840600257396794471');" onmouseout="out('6840600257396794471');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 105                 RedisURI redisSentinelURI = RedisURI.create(&quot;redis-sentinel://&quot; + url);                  </span>
<span class="5608287290966185827" onmouseenter="enter('5608287290966185827');" onmouseout="out('5608287290966185827');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 106                 redisSentinelURI.setPassword(password);                                                  </span>
<span class="4751558948604978604" onmouseenter="enter('4751558948604978604');" onmouseout="out('4751558948604978604');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 107                 redisSentinelURI.setDatabase(Integer.parseInt(database));                                </span>
<span class="6783411963682015775" onmouseenter="enter('6783411963682015775');" onmouseout="out('6783411963682015775');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 108                 redisSentinelURI.setSentinelMasterId(redisSideTableInfo.getMasterName());                </span>
<span class="-3337939030544591152" onmouseenter="enter('-3337939030544591152');" onmouseout="out('-3337939030544591152');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 109                 redisClient = RedisClient.create(redisSentinelURI);                                      </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 110 ||||||| BASE                                                                                             </span>
<span class="6840600257396794471" onmouseenter="enter('6840600257396794471');" onmouseout="out('6840600257396794471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111                 RedisURI redisSentinelURI = RedisURI.create(&quot;redis-sentinel://&quot; + url);                  </span>
<span class="5608287290966185827" onmouseenter="enter('5608287290966185827');" onmouseout="out('5608287290966185827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112                 redisSentinelURI.setPassword(password);                                                  </span>
<span class="8982839524192854704" onmouseenter="enter('8982839524192854704');" onmouseout="out('8982839524192854704');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113                 redisSentinelURI.setDatabase(Integer.valueOf(database));                                 </span>
<span class="6783411963682015775" onmouseenter="enter('6783411963682015775');" onmouseout="out('6783411963682015775');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114                 redisSentinelURI.setSentinelMasterId(redisSideTableInfo.getMasterName());                </span>
<span class="-3337939030544591152" onmouseenter="enter('-3337939030544591152');" onmouseout="out('-3337939030544591152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115                 redisClient = RedisClient.create(redisSentinelURI);                                      </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119             case CLUSTER:                                                                                </span>
<span class="-1232003316882934085" onmouseenter="enter('-1232003316882934085');" onmouseout="out('-1232003316882934085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120                 RedisURI clusterURI = RedisURI.create(&quot;redis://&quot; + url);                                 </span>
<span class="-6736113041303383524" onmouseenter="enter('-6736113041303383524');" onmouseout="out('-6736113041303383524');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121                 clusterURI.setPassword(password);                                                        </span>
<span class="-3535495827857877665" onmouseenter="enter('-3535495827857877665');" onmouseout="out('-3535495827857877665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122                 clusterClient = RedisClusterClient.create(clusterURI);                                   </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 129 =======                                                                                                  </span>
<span class="-2791484299191497297" onmouseenter="enter('-2791484299191497297');" onmouseout="out('-2791484299191497297');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130                 String[] urlSplit = StringUtils.split(url, &quot;,&quot;);                                         </span>
<span class="423226683654134269" onmouseenter="enter('423226683654134269');" onmouseout="out('423226683654134269');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131                 RedisURI.Builder builder = null;                                                         </span>
<span class="910408284979279714" onmouseenter="enter('910408284979279714');" onmouseout="out('910408284979279714');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132                 for (String item : urlSplit) {                                                           </span>
<span class="-513377933792792952" onmouseenter="enter('-513377933792792952');" onmouseout="out('-513377933792792952');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133                     Matcher mather = RedisSideReqRow.HOST_PORT_PATTERN.matcher(item);                    </span>
<span class="-5646142024278808605" onmouseenter="enter('-5646142024278808605');" onmouseout="out('-5646142024278808605');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134                     if (mather.find()) {                                                                 </span>
<span class="-6927514783972631089" onmouseenter="enter('-6927514783972631089');" onmouseout="out('-6927514783972631089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135                         builder = buildSentinelUri(                                                      </span>
<span class="-4625352577483463673" onmouseenter="enter('-4625352577483463673');" onmouseout="out('-4625352577483463673');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136                                 mather.group(&quot;host&quot;),                                                    </span>
<span class="-3744103454976238122" onmouseenter="enter('-3744103454976238122');" onmouseout="out('-3744103454976238122');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137                                 mather.group(&quot;port&quot;),                                                    </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138                                 builder                                                                  </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139                         );                                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140                     } else {                                                                             </span>
<span class="-5454936540258631376" onmouseenter="enter('-5454936540258631376');" onmouseout="out('-5454936540258631376');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141                         throw new IllegalArgumentException(                                              </span>
<span class="-51612453309450757" onmouseenter="enter('-51612453309450757');" onmouseout="out('-51612453309450757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142                                 String.format(&quot;Illegal format with redis url [%s]&quot;, item)                </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143                         );                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146                                                                                                          </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147                 if (Objects.nonNull(builder)) {                                                          </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148                     builder                                                                              </span>
<span class="6387121860922260106" onmouseenter="enter('6387121860922260106');" onmouseout="out('6387121860922260106');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149                             .withPassword(tableInfo.getPassword())                                       </span>
<span class="4468160857799094737" onmouseenter="enter('4468160857799094737');" onmouseout="out('4468160857799094737');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150                             .withDatabase(Integer.parseInt(tableInfo.getDatabase()))                     </span>
<span class="7019100605467766689" onmouseenter="enter('7019100605467766689');" onmouseout="out('7019100605467766689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151                             .withSentinelMasterId(tableInfo.getMasterName());                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152                 } else {                                                                                 </span>
<span class="8684235763561238790" onmouseenter="enter('8684235763561238790');" onmouseout="out('8684235763561238790');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                     throw new NullPointerException(&quot;build redis uri error!&quot;);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155                                                                                                          </span>
<span class="-776007856786993542" onmouseenter="enter('-776007856786993542');" onmouseout="out('-776007856786993542');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156                 RedisURI uri = builder.build();                                                          </span>
<span class="2908648228718416574" onmouseenter="enter('2908648228718416574');" onmouseout="out('2908648228718416574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157                 redisClient = RedisClient.create(uri);                                                   </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 158 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 159                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 160                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 161                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 162             case CLUSTER:                                                                                </span>
<span class="-1232003316882934085" onmouseenter="enter('-1232003316882934085');" onmouseout="out('-1232003316882934085');" style=""> 163                 RedisURI clusterURI = RedisURI.create(&quot;redis://&quot; + url);                                 </span>
<span class="-6736113041303383524" onmouseenter="enter('-6736113041303383524');" onmouseout="out('-6736113041303383524');" style=""> 164                 clusterURI.setPassword(password);                                                        </span>
<span class="-3535495827857877665" onmouseenter="enter('-3535495827857877665');" onmouseout="out('-3535495827857877665');" style=""> 165                 clusterClient = RedisClusterClient.create(clusterURI);                                   </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 166                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 167                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 168             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 169                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171     }                                                                                                    </span>
<span  style=""> 172                                                                                                          </span>
<span class="-2408254141930996430" onmouseenter="enter('-2408254141930996430');" onmouseout="out('-2408254141930996430');" style=""> 173     private RedisURI.Builder buildSentinelUri(                                                           </span>
<span class="-857215016271929958" onmouseenter="enter('-857215016271929958');" onmouseout="out('-857215016271929958');" style=""> 174             String host,                                                                                 </span>
<span class="-6401167448936803376" onmouseenter="enter('-6401167448936803376');" onmouseout="out('-6401167448936803376');" style=""> 175             String port,                                                                                 </span>
<span class="-5720589329365192953" onmouseenter="enter('-5720589329365192953');" onmouseout="out('-5720589329365192953');" style=""> 176             RedisURI.Builder builder) {                                                                  </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style=""> 177         if (Objects.nonNull(builder)) {                                                                  </span>
<span class="-1025231635963132883" onmouseenter="enter('-1025231635963132883');" onmouseout="out('-1025231635963132883');" style=""> 178             builder.withSentinel(host, Integer.parseInt(port));                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 179         } else {                                                                                         </span>
<span class="-4728574802854133154" onmouseenter="enter('-4728574802854133154');" onmouseout="out('-4728574802854133154');" style=""> 180             builder = RedisURI.Builder.sentinel(host, Integer.parseInt(port));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181         }                                                                                                </span>
<span class="4801455624621135639" onmouseenter="enter('4801455624621135639');" onmouseout="out('4801455624621135639');" style=""> 182         return builder;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 185     @Override                                                                                            </span>
<span class="2764971140877613779" onmouseenter="enter('2764971140877613779');" onmouseout="out('2764971140877613779');" style=""> 186     public BaseRow fillData(BaseRow input, Object sideInput) {                                           </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 187         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188     }                                                                                                    </span>
<span  style=""> 189                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 190     @Override                                                                                            </span>
<span class="-2468672087887077523" onmouseenter="enter('-2468672087887077523');" onmouseout="out('-2468672087887077523');" style=""><abbr title=" 191     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 191     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; rðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 192         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 193         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 194             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 196         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="-1942501682256209221" onmouseenter="enter('-1942501682256209221');" onmouseout="out('-1942501682256209221');" style=""> 197         future.thenAccept(values -&gt; {                                                                    </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 198                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 199                     try {                                                                                </span>
<span class="-4104377924620833457" onmouseenter="enter('-4104377924620833457');" onmouseout="out('-4104377924620833457');" style=""> 200                         BaseRow row = fillData(input, values);                                           </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style=""> 201                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));    </span>
<span class="8992185222434351188" onmouseenter="enter('8992185222434351188');" onmouseout="out('8992185222434351188');" style=""> 202                         RowDataComplete.completeBaseRow(resultFuture, row);                              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 203                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 204                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 206                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 207                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 208                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 210         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 213     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 214     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 215         return redisSideReqRow.buildCacheKey(refData);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216     }                                                                                                    </span>
<span  style=""> 217                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 218     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 219     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 220         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 221         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 222             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 224         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 225             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 227         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 228             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 230         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 231             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233     }                                                                                                    </span>
<span  style=""> 234                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235 }                                                                                                        </span>











</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  18 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  23 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  24 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  25 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  26 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  27 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  28 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  29 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  30 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  31 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  32 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="-2524259626202941740" onmouseenter="enter('-2524259626202941740');" onmouseout="out('-2524259626202941740');" style="">  33 import io.lettuce.core.RedisURI;                                                                         </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  34 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  35 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  36 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  37 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  38 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  39 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  40 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="">  41 import java.util.Objects;                                                                                </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  42 import java.util.function.Consumer;                                                                      </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  43 import java.util.regex.Matcher;                                                                          </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  44 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  45 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  46 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  47 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  48 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  49 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span  style="">  50                                                                                                          </span>
<span  style="">  51                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  53  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  55 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  56     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  57                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  58     private RedisClient redisClient;                                                                     </span>
<span  style="">  59                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  60     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  61                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  62     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  63                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  64     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  65                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  66     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  67                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  68     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  69                                                                                                          </span>
<span class="7294087828322742276" onmouseenter="enter('7294087828322742276');" onmouseout="out('7294087828322742276');" style="">  70     private final RedisSideReqRow redisSideReqRow;                                                       </span>
<span  style="">  71                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  72     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  72     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  73         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-7954617859025338600" onmouseenter="enter('-7954617859025338600');" onmouseout="out('-7954617859025338600');" style="">  74         redisSideReqRow = new RedisSideReqRow(super.sideInfo, ((RedisSideTableInfo) (sideTableInfo)));   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  77     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  78     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  79         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  80         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  81         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span  style="">  83                                                                                                          </span>
<span class="7748152788990363550" onmouseenter="enter('7748152788990363550');" onmouseout="out('7748152788990363550');" style="">  84     private void buildRedisClient(RedisSideTableInfo tableInfo) {                                        </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  85         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  86         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  87         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="-9026313238376494393" onmouseenter="enter('-9026313238376494393');" onmouseout="out('-9026313238376494393');" style="">  88         if (database == null) {                                                                          </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  89             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90         }                                                                                                </span>
<span class="-4392454403551039604" onmouseenter="enter('-4392454403551039604');" onmouseout="out('-4392454403551039604');" style="">  91         switch (RedisType.parse(tableInfo.getRedisType())) {                                             </span>
<span class="-2949951463250628099" onmouseenter="enter('-2949951463250628099');" onmouseout="out('-2949951463250628099');" style="">  92             case STANDALONE :                                                                            </span>
<span class="2121621884245667476" onmouseenter="enter('2121621884245667476');" onmouseout="out('2121621884245667476');" style="">  93                 RedisURI redisURI = RedisURI.create(&quot;redis://&quot; + url);                                   </span>
<span class="-2874159006221404812" onmouseenter="enter('-2874159006221404812');" onmouseout="out('-2874159006221404812');" style="">  94                 redisURI.setPassword(password);                                                          </span>
<span class="7633329922038274391" onmouseenter="enter('7633329922038274391');" onmouseout="out('7633329922038274391');" style="">  95                 redisURI.setDatabase(Integer.parseInt(database));                                        </span>
<span class="5148353327116752546" onmouseenter="enter('5148353327116752546');" onmouseout="out('5148353327116752546');" style="">  96                 redisClient = RedisClient.create(redisURI);                                              </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style="">  97                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style="">  98                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  99                 break;                                                                                   </span>
<span class="-2039731520025434486" onmouseenter="enter('-2039731520025434486');" onmouseout="out('-2039731520025434486');" style=""> 100             case SENTINEL :                                                                              </span>
<span class="-2791484299191497297" onmouseenter="enter('-2791484299191497297');" onmouseout="out('-2791484299191497297');" style=""> 101                 String[] urlSplit = StringUtils.split(url, &quot;,&quot;);                                         </span>
<span class="423226683654134269" onmouseenter="enter('423226683654134269');" onmouseout="out('423226683654134269');" style=""> 102                 RedisURI.Builder builder = null;                                                         </span>
<span class="910408284979279714" onmouseenter="enter('910408284979279714');" onmouseout="out('910408284979279714');" style=""> 103                 for (String item : urlSplit) {                                                           </span>
<span class="-513377933792792952" onmouseenter="enter('-513377933792792952');" onmouseout="out('-513377933792792952');" style=""> 104                     Matcher mather = RedisSideReqRow.HOST_PORT_PATTERN.matcher(item);                    </span>
<span class="-5646142024278808605" onmouseenter="enter('-5646142024278808605');" onmouseout="out('-5646142024278808605');" style=""> 105                     if (mather.find()) {                                                                 </span>
<span class="-3481287485785809124" onmouseenter="enter('-3481287485785809124');" onmouseout="out('-3481287485785809124');" style=""> 106                         builder = buildSentinelUri(mather.group(&quot;host&quot;), mather.group(&quot;port&quot;), builder); </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 107                     } else {                                                                             </span>
<span class="2965412631745323071" onmouseenter="enter('2965412631745323071');" onmouseout="out('2965412631745323071');" style=""><abbr title=" 108                         throw new IllegalArgumentException(String.format(&quot;Illegal format with redis url [%s]&quot;, item));"> 108                         throw new IllegalArgumentException(String.format(&quot;Illegal format with redis url [ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110                 }                                                                                        </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style=""> 111                 if (Objects.nonNull(builder)) {                                                          </span>
<span class="-8582990177999210704" onmouseenter="enter('-8582990177999210704');" onmouseout="out('-8582990177999210704');" style=""><abbr title=" 112                     builder.withPassword(tableInfo.getPassword()).withDatabase(Integer.parseInt(tableInfo.getDatabase())).withSentinelMasterId(tableInfo.getMasterName());"> 112                     builder.withPassword(tableInfo.getPassword()).withDatabase(Integer.parseInt(tableInfoðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 113                 } else {                                                                                 </span>
<span class="8684235763561238790" onmouseenter="enter('8684235763561238790');" onmouseout="out('8684235763561238790');" style=""> 114                     throw new NullPointerException(&quot;build redis uri error!&quot;);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115                 }                                                                                        </span>
<span class="-776007856786993542" onmouseenter="enter('-776007856786993542');" onmouseout="out('-776007856786993542');" style=""> 116                 RedisURI uri = builder.build();                                                          </span>
<span class="2908648228718416574" onmouseenter="enter('2908648228718416574');" onmouseout="out('2908648228718416574');" style=""> 117                 redisClient = RedisClient.create(uri);                                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 118                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 119                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 120                 break;                                                                                   </span>
<span class="-6189414154434577421" onmouseenter="enter('-6189414154434577421');" onmouseout="out('-6189414154434577421');" style=""> 121             case CLUSTER :                                                                               </span>
<span class="-1232003316882934085" onmouseenter="enter('-1232003316882934085');" onmouseout="out('-1232003316882934085');" style=""> 122                 RedisURI clusterURI = RedisURI.create(&quot;redis://&quot; + url);                                 </span>
<span class="-6736113041303383524" onmouseenter="enter('-6736113041303383524');" onmouseout="out('-6736113041303383524');" style=""> 123                 clusterURI.setPassword(password);                                                        </span>
<span class="-3535495827857877665" onmouseenter="enter('-3535495827857877665');" onmouseout="out('-3535495827857877665');" style=""> 124                 clusterClient = RedisClusterClient.create(clusterURI);                                   </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 125                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 126                 async = clusterConnection.async();                                                       </span>
<span class="3050734735710613783" onmouseenter="enter('3050734735710613783');" onmouseout="out('3050734735710613783');" style=""> 127             default :                                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 128                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130     }                                                                                                    </span>
<span  style=""> 131                                                                                                          </span>
<span class="-2408254141930996430" onmouseenter="enter('-2408254141930996430');" onmouseout="out('-2408254141930996430');" style=""> 132     private RedisURI.Builder buildSentinelUri(                                                           </span>
<span class="-857215016271929958" onmouseenter="enter('-857215016271929958');" onmouseout="out('-857215016271929958');" style=""> 133             String host,                                                                                 </span>
<span class="-6401167448936803376" onmouseenter="enter('-6401167448936803376');" onmouseout="out('-6401167448936803376');" style=""> 134             String port,                                                                                 </span>
<span class="-5720589329365192953" onmouseenter="enter('-5720589329365192953');" onmouseout="out('-5720589329365192953');" style=""> 135             RedisURI.Builder builder) {                                                                  </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style=""> 136         if (Objects.nonNull(builder)) {                                                                  </span>
<span class="-1025231635963132883" onmouseenter="enter('-1025231635963132883');" onmouseout="out('-1025231635963132883');" style=""> 137             builder.withSentinel(host, Integer.parseInt(port));                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 138         } else {                                                                                         </span>
<span class="-4728574802854133154" onmouseenter="enter('-4728574802854133154');" onmouseout="out('-4728574802854133154');" style=""> 139             builder = RedisURI.Builder.sentinel(host, Integer.parseInt(port));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140         }                                                                                                </span>
<span class="4801455624621135639" onmouseenter="enter('4801455624621135639');" onmouseout="out('4801455624621135639');" style=""> 141         return builder;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142     }                                                                                                    </span>
<span  style=""> 143                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 144     @Override                                                                                            </span>
<span class="2764971140877613779" onmouseenter="enter('2764971140877613779');" onmouseout="out('2764971140877613779');" style=""> 145     public BaseRow fillData(BaseRow input, Object sideInput) {                                           </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 146         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147     }                                                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 149     @Override                                                                                            </span>
<span class="-2468672087887077523" onmouseenter="enter('-2468672087887077523');" onmouseout="out('-2468672087887077523');" style=""><abbr title=" 150     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 150     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; rðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 151         String key = buildCacheKey(inputParams);                                                         </span>
<span class="391086597940522415" onmouseenter="enter('391086597940522415');" onmouseout="out('391086597940522415');" style=""> 152         if (StringUtils.isBlank(key)) {                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 153             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154         }                                                                                                </span>
<span class="1977156455400636871" onmouseenter="enter('1977156455400636871');" onmouseout="out('1977156455400636871');" style=""> 155         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) (async)).hgetall(key);       </span>
<span class="6693838762614554149" onmouseenter="enter('6693838762614554149');" onmouseout="out('6693838762614554149');" style=""> 156         future.thenAccept(( values) -&gt; {                                                                 </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 157             if (MapUtils.isNotEmpty(values)) {                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 158                 try {                                                                                    </span>
<span class="-4104377924620833457" onmouseenter="enter('-4104377924620833457');" onmouseout="out('-4104377924620833457');" style=""> 159                     BaseRow row = fillData(input, values);                                               </span>
<span class="8909590001630271596" onmouseenter="enter('8909590001630271596');" onmouseout="out('8909590001630271596');" style=""> 160                     dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));       </span>
<span class="8992185222434351188" onmouseenter="enter('8992185222434351188');" onmouseout="out('8992185222434351188');" style=""> 161                     RowDataComplete.completeBaseRow(resultFuture, row);                                  </span>
<span class="6077291764686690243" onmouseenter="enter('6077291764686690243');" onmouseout="out('6077291764686690243');" style=""> 162                 } catch ( e) {                                                                           </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 163                     dealFillDataError(input, resultFuture, e);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 165             } else {                                                                                     </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 166                 dealMissKey(input, resultFuture);                                                        </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 167                 dealCacheData(key, CacheMissVal.getMissKeyObj());                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 169         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170     }                                                                                                    </span>
<span  style=""> 171                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 172     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 173     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 174         return redisSideReqRow.buildCacheKey(refData);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175     }                                                                                                    </span>
<span  style=""> 176                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 177     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 178     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 179         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 180         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 181             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 183         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 184             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 186         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 187             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 189         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 190             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193 }                                                                                                        </span>





















































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  21  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  22  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  23  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  24  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  25  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  26  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  28  import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                          </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  29  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  30  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  31  import com.dtstack.flink.sql.util.RowDataComplete;                                                                </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  32  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  33  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="-2524259626202941740" onmouseenter="enter('-2524259626202941740');" onmouseout="out('-2524259626202941740');" style="">  34  import io.lettuce.core.RedisURI;                                                                                  </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  35  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  36  import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                          </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  37  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  38  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  39  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  40  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  41  import org.apache.commons.lang.StringUtils;                                                                       </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  42  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  43  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  44  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  45  import org.apache.flink.table.dataformat.BaseRow;                                                                 </span>
<span  style="">  46                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  47  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  48  import java.util.Map;                                                                                             </span>

<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  49  import java.util.function.Consumer;                                                                               </span>


<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  50  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  51   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  52   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  53  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  54                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  55      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  56                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  57      private RedisClient redisClient;                                                                              </span>
<span  style="">  58                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  59      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  60                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  61      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  62                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  63      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  64                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  65      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  66                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  67      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  68                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -    private RedisSideReqRow redisSideReqRow;                                                                      </span>
<span class="7294087828322742276" onmouseenter="enter('7294087828322742276');" onmouseout="out('7294087828322742276');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +    private final RedisSideReqRow redisSideReqRow;                                                                </span>
<span  style="">  71                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  72      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  72      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  73          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-6270850474357319169" onmouseenter="enter('-6270850474357319169');" onmouseout="out('-6270850474357319169');" style="">  74          redisSideReqRow = new RedisSideReqRow(super.sideInfo, (RedisSideTableInfo) sideTableInfo);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75      }                                                                                                             </span>
<span  style="">  76                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  77      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  78      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  79          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  80          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  81          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82      }                                                                                                             </span>
<span  style="">  83                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  84      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  85          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  86          String password = redisSideTableInfo.getPassword();                                                       </span>
<span  style="">  87                                                                                                                    </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  88          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  89          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  90              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91          }                                                                                                         </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  92          switch (RedisType.parse(tableInfo.getRedisType())){                                                       </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  93              case STANDALONE:                                                                                      </span>
<span class="2121621884245667476" onmouseenter="enter('2121621884245667476');" onmouseout="out('2121621884245667476');" style="">  94                  RedisURI redisURI = RedisURI.create(&quot;redis://&quot; + url);                                            </span>
<span class="-2874159006221404812" onmouseenter="enter('-2874159006221404812');" onmouseout="out('-2874159006221404812');" style="">  95                  redisURI.setPassword(password);                                                                   </span>
<span class="-3097620976335032278" onmouseenter="enter('-3097620976335032278');" onmouseout="out('-3097620976335032278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -                redisURI.setDatabase(Integer.valueOf(database));                                                  </span>
<span class="7633329922038274391" onmouseenter="enter('7633329922038274391');" onmouseout="out('7633329922038274391');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  97 +                redisURI.setDatabase(Integer.parseInt(database));                                                 </span>
<span class="5148353327116752546" onmouseenter="enter('5148353327116752546');" onmouseout="out('5148353327116752546');" style="">  98                  redisClient = RedisClient.create(redisURI);                                                       </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style="">  99                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 100                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 101                  break;                                                                                            </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 102              case SENTINEL:                                                                                        </span>
<span class="6840600257396794471" onmouseenter="enter('6840600257396794471');" onmouseout="out('6840600257396794471');" style=""> 103                  RedisURI redisSentinelURI = RedisURI.create(&quot;redis-sentinel://&quot; + url);                           </span>
<span class="5608287290966185827" onmouseenter="enter('5608287290966185827');" onmouseout="out('5608287290966185827');" style=""> 104                  redisSentinelURI.setPassword(password);                                                           </span>
<span class="8982839524192854704" onmouseenter="enter('8982839524192854704');" onmouseout="out('8982839524192854704');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -                redisSentinelURI.setDatabase(Integer.valueOf(database));                                          </span>
<span class="4751558948604978604" onmouseenter="enter('4751558948604978604');" onmouseout="out('4751558948604978604');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +                redisSentinelURI.setDatabase(Integer.parseInt(database));                                         </span>
<span class="6783411963682015775" onmouseenter="enter('6783411963682015775');" onmouseout="out('6783411963682015775');" style=""> 107                  redisSentinelURI.setSentinelMasterId(redisSideTableInfo.getMasterName());                         </span>
<span class="-3337939030544591152" onmouseenter="enter('-3337939030544591152');" onmouseout="out('-3337939030544591152');" style=""> 108                  redisClient = RedisClient.create(redisSentinelURI);                                               </span>




























<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 109                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 110                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 111                  break;                                                                                            </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 112              case CLUSTER:                                                                                         </span>
<span class="-1232003316882934085" onmouseenter="enter('-1232003316882934085');" onmouseout="out('-1232003316882934085');" style=""> 113                  RedisURI clusterURI = RedisURI.create(&quot;redis://&quot; + url);                                          </span>
<span class="-6736113041303383524" onmouseenter="enter('-6736113041303383524');" onmouseout="out('-6736113041303383524');" style=""> 114                  clusterURI.setPassword(password);                                                                 </span>
<span class="-3535495827857877665" onmouseenter="enter('-3535495827857877665');" onmouseout="out('-3535495827857877665');" style=""> 115                  clusterClient = RedisClusterClient.create(clusterURI);                                            </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 116                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 117                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 118              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 119                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120          }                                                                                                         </span>












<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121      }                                                                                                             </span>
<span  style=""> 122                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 123      @Override                                                                                                     </span>
<span class="2764971140877613779" onmouseenter="enter('2764971140877613779');" onmouseout="out('2764971140877613779');" style=""> 124      public BaseRow fillData(BaseRow input, Object sideInput) {                                                    </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 125          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126      }                                                                                                             </span>
<span  style=""> 127                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 128      @Override                                                                                                     </span>
<span class="-2468672087887077523" onmouseenter="enter('-2468672087887077523');" onmouseout="out('-2468672087887077523');" style=""><abbr title=" 129      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 129      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFutuðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 130          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 131          if(StringUtils.isBlank(key)){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 132              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133          }                                                                                                         </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 134          RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);                  </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -        future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -            @Override                                                                                             </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -            public void accept(Map&lt;String, String&gt; values) {                                                      </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -                if (MapUtils.isNotEmpty(values)) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -                    try {                                                                                         </span>
<span class="-4104377924620833457" onmouseenter="enter('-4104377924620833457');" onmouseout="out('-4104377924620833457');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -                        BaseRow row = fillData(input, values);                                                    </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));             </span>
<span class="8992185222434351188" onmouseenter="enter('8992185222434351188');" onmouseout="out('8992185222434351188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -                        RowDataComplete.completeBaseRow(resultFuture, row);                                       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -                    } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                        dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -                    }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -                } else {                                                                                          </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -                    dealMissKey(input, resultFuture);                                                             </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                    dealCacheData(key, CacheMissVal.getMissKeyObj());                                             </span>
<span class="-1942501682256209221" onmouseenter="enter('-1942501682256209221');" onmouseout="out('-1942501682256209221');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +        future.thenAccept(values -&gt; {                                                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +            if (MapUtils.isNotEmpty(values)) {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +                try {                                                                                             </span>
<span class="-4104377924620833457" onmouseenter="enter('-4104377924620833457');" onmouseout="out('-4104377924620833457');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +                    BaseRow row = fillData(input, values);                                                        </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +                    dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));                 </span>
<span class="8992185222434351188" onmouseenter="enter('8992185222434351188');" onmouseout="out('8992185222434351188');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +                    RowDataComplete.completeBaseRow(resultFuture, row);                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +                } catch (Exception e) {                                                                           </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +                    dealFillDataError(input, resultFuture, e);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +            } else {                                                                                              </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +                dealMissKey(input, resultFuture);                                                                 </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +                dealCacheData(key, CacheMissVal.getMissKeyObj());                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 162          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163      }                                                                                                             </span>
<span  style=""> 164                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 165      @Override                                                                                                     </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 166      public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                                    </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 167          return redisSideReqRow.buildCacheKey(refData);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168      }                                                                                                             </span>
<span  style=""> 169                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 170      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 171      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 172          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 173          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 174              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 176          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 177              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 179          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 180              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 182          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 183              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185      }                                                                                                             </span>
<span  style=""> 186                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  21  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  22  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  23  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  24  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  25  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  26  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  28  import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                          </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  29  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  30  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  31  import com.dtstack.flink.sql.util.RowDataComplete;                                                                </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  32  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  33  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="-2524259626202941740" onmouseenter="enter('-2524259626202941740');" onmouseout="out('-2524259626202941740');" style="">  34  import io.lettuce.core.RedisURI;                                                                                  </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  35  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  36  import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                          </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  37  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  38  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  39  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  40  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  41  import org.apache.commons.lang.StringUtils;                                                                       </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  42  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  43  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  44  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  45  import org.apache.flink.table.dataformat.BaseRow;                                                                 </span>
<span  style="">  46                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  47  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  48  import java.util.Map;                                                                                             </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +import java.util.Objects;                                                                                         </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  50  import java.util.function.Consumer;                                                                               </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +import java.util.regex.Matcher;                                                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  53  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  54   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  55   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  56  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  57                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  58      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  59                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  60      private RedisClient redisClient;                                                                              </span>
<span  style="">  61                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  62      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  63                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  64      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  65                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  66      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  67                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  68      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  69                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  70      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  71                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  72      private RedisSideReqRow redisSideReqRow;                                                                      </span>

<span  style="">  73                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  74      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  74      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  75          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-6270850474357319169" onmouseenter="enter('-6270850474357319169');" onmouseout="out('-6270850474357319169');" style="">  76          redisSideReqRow = new RedisSideReqRow(super.sideInfo, (RedisSideTableInfo) sideTableInfo);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77      }                                                                                                             </span>
<span  style="">  78                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  79      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  80      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  81          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  82          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  83          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84      }                                                                                                             </span>
<span  style="">  85                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  86      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  87          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  88          String password = redisSideTableInfo.getPassword();                                                       </span>
<span  style="">  89                                                                                                                    </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  90          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  91          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  92              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93          }                                                                                                         </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  94          switch (RedisType.parse(tableInfo.getRedisType())){                                                       </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  95              case STANDALONE:                                                                                      </span>
<span class="2121621884245667476" onmouseenter="enter('2121621884245667476');" onmouseout="out('2121621884245667476');" style="">  96                  RedisURI redisURI = RedisURI.create(&quot;redis://&quot; + url);                                            </span>
<span class="-2874159006221404812" onmouseenter="enter('-2874159006221404812');" onmouseout="out('-2874159006221404812');" style="">  97                  redisURI.setPassword(password);                                                                   </span>
<span class="-3097620976335032278" onmouseenter="enter('-3097620976335032278');" onmouseout="out('-3097620976335032278');" style="">  98                  redisURI.setDatabase(Integer.valueOf(database));                                                  </span>

<span class="5148353327116752546" onmouseenter="enter('5148353327116752546');" onmouseout="out('5148353327116752546');" style="">  99                  redisClient = RedisClient.create(redisURI);                                                       </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 100                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 101                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 102                  break;                                                                                            </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 103              case SENTINEL:                                                                                        </span>
<span class="6840600257396794471" onmouseenter="enter('6840600257396794471');" onmouseout="out('6840600257396794471');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -                RedisURI redisSentinelURI = RedisURI.create(&quot;redis-sentinel://&quot; + url);                           </span>
<span class="5608287290966185827" onmouseenter="enter('5608287290966185827');" onmouseout="out('5608287290966185827');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -                redisSentinelURI.setPassword(password);                                                           </span>
<span class="8982839524192854704" onmouseenter="enter('8982839524192854704');" onmouseout="out('8982839524192854704');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -                redisSentinelURI.setDatabase(Integer.valueOf(database));                                          </span>

<span class="6783411963682015775" onmouseenter="enter('6783411963682015775');" onmouseout="out('6783411963682015775');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -                redisSentinelURI.setSentinelMasterId(redisSideTableInfo.getMasterName());                         </span>
<span class="-3337939030544591152" onmouseenter="enter('-3337939030544591152');" onmouseout="out('-3337939030544591152');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -                redisClient = RedisClient.create(redisSentinelURI);                                               </span>
<span class="-2791484299191497297" onmouseenter="enter('-2791484299191497297');" onmouseout="out('-2791484299191497297');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +                String[] urlSplit = StringUtils.split(url, &quot;,&quot;);                                                  </span>
<span class="423226683654134269" onmouseenter="enter('423226683654134269');" onmouseout="out('423226683654134269');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +                RedisURI.Builder builder = null;                                                                  </span>
<span class="910408284979279714" onmouseenter="enter('910408284979279714');" onmouseout="out('910408284979279714');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +                for (String item : urlSplit) {                                                                    </span>
<span class="-513377933792792952" onmouseenter="enter('-513377933792792952');" onmouseout="out('-513377933792792952');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +                    Matcher mather = RedisSideReqRow.HOST_PORT_PATTERN.matcher(item);                             </span>
<span class="-5646142024278808605" onmouseenter="enter('-5646142024278808605');" onmouseout="out('-5646142024278808605');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +                    if (mather.find()) {                                                                          </span>
<span class="-6927514783972631089" onmouseenter="enter('-6927514783972631089');" onmouseout="out('-6927514783972631089');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +                        builder = buildSentinelUri(                                                               </span>
<span class="-4625352577483463673" onmouseenter="enter('-4625352577483463673');" onmouseout="out('-4625352577483463673');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +                                mather.group(&quot;host&quot;),                                                             </span>
<span class="-3744103454976238122" onmouseenter="enter('-3744103454976238122');" onmouseout="out('-3744103454976238122');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +                                mather.group(&quot;port&quot;),                                                             </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +                                builder                                                                           </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                        );                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +                    } else {                                                                                      </span>
<span class="-5454936540258631376" onmouseenter="enter('-5454936540258631376');" onmouseout="out('-5454936540258631376');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +                        throw new IllegalArgumentException(                                                       </span>
<span class="-51612453309450757" onmouseenter="enter('-51612453309450757');" onmouseout="out('-51612453309450757');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +                                String.format(&quot;Illegal format with redis url [%s]&quot;, item)                         </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +                        );                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +                                                                                                                  </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +                if (Objects.nonNull(builder)) {                                                                   </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +                    builder                                                                                       </span>
<span class="6387121860922260106" onmouseenter="enter('6387121860922260106');" onmouseout="out('6387121860922260106');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +                            .withPassword(tableInfo.getPassword())                                                </span>
<span class="4468160857799094737" onmouseenter="enter('4468160857799094737');" onmouseout="out('4468160857799094737');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +                            .withDatabase(Integer.parseInt(tableInfo.getDatabase()))                              </span>
<span class="7019100605467766689" onmouseenter="enter('7019100605467766689');" onmouseout="out('7019100605467766689');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +                            .withSentinelMasterId(tableInfo.getMasterName());                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +                } else {                                                                                          </span>
<span class="8684235763561238790" onmouseenter="enter('8684235763561238790');" onmouseout="out('8684235763561238790');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +                    throw new NullPointerException(&quot;build redis uri error!&quot;);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +                                                                                                                  </span>
<span class="-776007856786993542" onmouseenter="enter('-776007856786993542');" onmouseout="out('-776007856786993542');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +                RedisURI uri = builder.build();                                                                   </span>
<span class="2908648228718416574" onmouseenter="enter('2908648228718416574');" onmouseout="out('2908648228718416574');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 136 +                redisClient = RedisClient.create(uri);                                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 137                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 138                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 139                  break;                                                                                            </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 140              case CLUSTER:                                                                                         </span>
<span class="-1232003316882934085" onmouseenter="enter('-1232003316882934085');" onmouseout="out('-1232003316882934085');" style=""> 141                  RedisURI clusterURI = RedisURI.create(&quot;redis://&quot; + url);                                          </span>
<span class="-6736113041303383524" onmouseenter="enter('-6736113041303383524');" onmouseout="out('-6736113041303383524');" style=""> 142                  clusterURI.setPassword(password);                                                                 </span>
<span class="-3535495827857877665" onmouseenter="enter('-3535495827857877665');" onmouseout="out('-3535495827857877665');" style=""> 143                  clusterClient = RedisClusterClient.create(clusterURI);                                            </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 144                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 145                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 146              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 147                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +                                                                                                                  </span>
<span class="-2408254141930996430" onmouseenter="enter('-2408254141930996430');" onmouseout="out('-2408254141930996430');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +    private RedisURI.Builder buildSentinelUri(                                                                    </span>
<span class="-857215016271929958" onmouseenter="enter('-857215016271929958');" onmouseout="out('-857215016271929958');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +            String host,                                                                                          </span>
<span class="-6401167448936803376" onmouseenter="enter('-6401167448936803376');" onmouseout="out('-6401167448936803376');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +            String port,                                                                                          </span>
<span class="-5720589329365192953" onmouseenter="enter('-5720589329365192953');" onmouseout="out('-5720589329365192953');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +            RedisURI.Builder builder) {                                                                           </span>
<span class="3124741909187409136" onmouseenter="enter('3124741909187409136');" onmouseout="out('3124741909187409136');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +        if (Objects.nonNull(builder)) {                                                                           </span>
<span class="-1025231635963132883" onmouseenter="enter('-1025231635963132883');" onmouseout="out('-1025231635963132883');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +            builder.withSentinel(host, Integer.parseInt(port));                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +        } else {                                                                                                  </span>
<span class="-4728574802854133154" onmouseenter="enter('-4728574802854133154');" onmouseout="out('-4728574802854133154');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +            builder = RedisURI.Builder.sentinel(host, Integer.parseInt(port));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +        }                                                                                                         </span>
<span class="4801455624621135639" onmouseenter="enter('4801455624621135639');" onmouseout="out('4801455624621135639');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +        return builder;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161      }                                                                                                             </span>
<span  style=""> 162                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163      @Override                                                                                                     </span>
<span class="2764971140877613779" onmouseenter="enter('2764971140877613779');" onmouseout="out('2764971140877613779');" style=""> 164      public BaseRow fillData(BaseRow input, Object sideInput) {                                                    </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 165          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166      }                                                                                                             </span>
<span  style=""> 167                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 168      @Override                                                                                                     </span>
<span class="-2468672087887077523" onmouseenter="enter('-2468672087887077523');" onmouseout="out('-2468672087887077523');" style=""><abbr title=" 169      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 169      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, BaseRow input, ResultFuture&lt;BaseRow&gt; resultFutuðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 170          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 171          if(StringUtils.isBlank(key)){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 172              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173          }                                                                                                         </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 174          RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);                  </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 175          future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 176              @Override                                                                                             </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 177              public void accept(Map&lt;String, String&gt; values) {                                                      </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 178                  if (MapUtils.isNotEmpty(values)) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 179                      try {                                                                                         </span>
<span class="-4104377924620833457" onmouseenter="enter('-4104377924620833457');" onmouseout="out('-4104377924620833457');" style=""> 180                          BaseRow row = fillData(input, values);                                                    </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style=""> 181                          dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));             </span>
<span class="8992185222434351188" onmouseenter="enter('8992185222434351188');" onmouseout="out('8992185222434351188');" style=""> 182                          RowDataComplete.completeBaseRow(resultFuture, row);                                       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 183                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 184                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 186                  } else {                                                                                          </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 187                      dealMissKey(input, resultFuture);                                                             </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 188                      dealCacheData(key, CacheMissVal.getMissKeyObj());                                             </span>








<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189                  }                                                                                                 </span>



<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 191          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192      }                                                                                                             </span>
<span  style=""> 193                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 194      @Override                                                                                                     </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 195      public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                                    </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 196          return redisSideReqRow.buildCacheKey(refData);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197      }                                                                                                             </span>
<span  style=""> 198                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 199      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 200      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 201          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 202          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 203              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 205          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 206              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 208          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 209              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 211          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 212              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214      }                                                                                                             </span>
<span  style=""> 215                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            