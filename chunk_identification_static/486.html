<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>486</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    486
                    <a href="485.html">prev</a>
                    <a href="487.html">next</a>
                    <a href="486_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_07c4ccdd6f1f5fed2b5b800377edca583bc33bbe_core/src/main/java/com/dtstack/flink/sql/util/ParseUtils.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;07c4ccdd6f1f5fed2b5b800377edca583bc33bbe:core/src/main/java/com/dtstack/flink/sql/util/ParseUtils.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;07c4ccdd6f1f5fed2b5b800377edca583bc33bbe^1:core/src/main/java/com/dtstack/flink/sql/util/ParseUtils.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;07c4ccdd6f1f5fed2b5b800377edca583bc33bbe^2:core/src/main/java/com/dtstack/flink/sql/util/ParseUtils.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e1736f333f6ce46e1045ac877bcaa38cbc20c6cc:core/src/main/java/com/dtstack/flink/sql/util/ParseUtils.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b]], subset: [[b], [b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">  19 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">  20  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">  21  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">  22  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">  23  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">  24  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">  25  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">  26  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  27  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  28  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  29  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  30  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  31  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  32  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  33  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  34  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  35  */                                                                                                      </span>
<span  style="">  36                                                                                                          </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  37 package com.dtstack.flink.sql.util;                                                                      </span>
<span  style="">  38                                                                                                          </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  39 import com.google.common.collect.HashBasedTable;                                                         </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  40 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41 import com.google.common.collect.HashBiMap;                                                              </span>
<span class="5169042772451251702" onmouseenter="enter('5169042772451251702');" onmouseout="out('5169042772451251702');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  42 import org.apache.calcite.sql.*;                                                                         </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  43 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="5169042772451251702" onmouseenter="enter('5169042772451251702');" onmouseout="out('5169042772451251702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44 import org.apache.calcite.sql.*;                                                                         </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47                                                                                                          </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 import java.util.List;                                                                                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  50 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  51                                                                                                          </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  52 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  53 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  54 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  55 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  56 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  57 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  58 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  59 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span  style="">  60                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  61 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="196713859697444637" onmouseenter="enter('196713859697444637');" onmouseout="out('196713859697444637');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  62 import java.util.*;                                                                                      </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  63 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66 import java.util.Set;                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67                                                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70 /**                                                                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  71 =======                                                                                                  </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  72 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  73 import java.util.List;                                                                                   </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  74 import java.util.Set;                                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  75 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  76                                                                                                          </span>
<span class="-1580562890124813833" onmouseenter="enter('-1580562890124813833');" onmouseout="out('-1580562890124813833');" style="">  77 import static org.apache.calcite.sql.SqlKind.AS;                                                         </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="">  78 import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                 </span>
<span class="-1728920721125829339" onmouseenter="enter('-1728920721125829339');" onmouseout="out('-1728920721125829339');" style="">  79 import static org.apache.calcite.sql.SqlKind.JOIN;                                                       </span>
<span  style="">  80                                                                                                          </span>
<span  style="">  81                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  82 /**                                                                                                      </span>
<span class="-5495386940022079489" onmouseenter="enter('-5495386940022079489');" onmouseout="out('-5495386940022079489');" style="">  83  * @Auther: jiangjunjie                                                                                  </span>
<span class="-5787409337524476693" onmouseenter="enter('-5787409337524476693');" onmouseout="out('-5787409337524476693');" style="">  84  * @Date: 2019-06-30 14:57                                                                               </span>
<span class="-5284392641623597580" onmouseenter="enter('-5284392641623597580');" onmouseout="out('-5284392641623597580');" style="">  85  * @Description:                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  86  */                                                                                                      </span>
<span class="-1866530984685416906" onmouseenter="enter('-1866530984685416906');" onmouseout="out('-1866530984685416906');" style="">  87 public class ParseUtils {                                                                                </span>
<span class="8890655695211200116" onmouseenter="enter('8890655695211200116');" onmouseout="out('8890655695211200116');" style="">  88     public static void parseAnd(SqlNode conditionNode, List&lt;SqlNode&gt; sqlNodeList) {                      </span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title="  89         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {">  89         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().sizðŸ”µ</abbr></span>
<span class="1148725245245949994" onmouseenter="enter('1148725245245949994');" onmouseout="out('1148725245245949994');" style="">  90             parseAnd(((SqlBasicCall) conditionNode).getOperands()[0], sqlNodeList);                      </span>
<span class="-3813321520044694485" onmouseenter="enter('-3813321520044694485');" onmouseout="out('-3813321520044694485');" style="">  91             sqlNodeList.add(((SqlBasicCall) conditionNode).getOperands()[1]);                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  92         } else {                                                                                         </span>
<span class="6614631290047043163" onmouseenter="enter('6614631290047043163');" onmouseout="out('6614631290047043163');" style="">  93             sqlNodeList.add(conditionNode);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95     }                                                                                                    </span>
<span  style="">  96                                                                                                          </span>
<span class="-1060545560500196395" onmouseenter="enter('-1060545560500196395');" onmouseout="out('-1060545560500196395');" style="">  97     public static void parseJoinCompareOperate(SqlNode condition, List&lt;String&gt; sqlJoinCompareOperate) {  </span>
<span class="-2746361559719659334" onmouseenter="enter('-2746361559719659334');" onmouseout="out('-2746361559719659334');" style="">  98         SqlBasicCall joinCondition = (SqlBasicCall) condition;                                           </span>
<span class="6074868054083144054" onmouseenter="enter('6074868054083144054');" onmouseout="out('6074868054083144054');" style="">  99         if (joinCondition.getKind() == SqlKind.AND) {                                                    </span>
<span class="-4754031241214130165" onmouseenter="enter('-4754031241214130165');" onmouseout="out('-4754031241214130165');" style=""> 100             List&lt;SqlNode&gt; operandList = joinCondition.getOperandList();                                  </span>
<span class="5346589125395085803" onmouseenter="enter('5346589125395085803');" onmouseout="out('5346589125395085803');" style=""> 101             for (SqlNode sqlNode : operandList) {                                                        </span>
<span class="-2292733210455866502" onmouseenter="enter('-2292733210455866502');" onmouseout="out('-2292733210455866502');" style=""> 102                 parseJoinCompareOperate(sqlNode, sqlJoinCompareOperate);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 104         } else {                                                                                         </span>
<span class="-1600941433765614522" onmouseenter="enter('-1600941433765614522');" onmouseout="out('-1600941433765614522');" style=""> 105             String operator = transformNotEqualsOperator(joinCondition.getKind());                       </span>
<span class="4282383423815043500" onmouseenter="enter('4282383423815043500');" onmouseout="out('4282383423815043500');" style=""> 106             sqlJoinCompareOperate.add(operator);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="1701523092530860818" onmouseenter="enter('1701523092530860818');" onmouseout="out('1701523092530860818');" style=""> 110     public static String transformNotEqualsOperator(SqlKind sqlKind) {                                   </span>
<span class="-5519640728565052860" onmouseenter="enter('-5519640728565052860');" onmouseout="out('-5519640728565052860');" style=""> 111         if (StringUtils.equalsIgnoreCase(sqlKind.toString(), &quot;NOT_EQUALS&quot;)) {                            </span>
<span class="-3530763381623721293" onmouseenter="enter('-3530763381623721293');" onmouseout="out('-3530763381623721293');" style=""> 112             return &quot;!=&quot;;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113         }                                                                                                </span>
<span class="4075145857114168205" onmouseenter="enter('4075145857114168205');" onmouseout="out('4075145857114168205');" style=""> 114         return sqlKind.sql;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115     }                                                                                                    </span>
<span  style=""> 116                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 117     /**                                                                                                  </span>
<span class="-4264902615967480616" onmouseenter="enter('-4264902615967480616');" onmouseout="out('-4264902615967480616');" style=""> 118      *  parse multi join table name, child query RealTabName is null                                     </span>
<span class="-5476579727084261436" onmouseenter="enter('-5476579727084261436');" onmouseout="out('-5476579727084261436');" style=""> 119      * @param leftJoin                                                                                   </span>
<span class="-2372480317946695008" onmouseenter="enter('-2372480317946695008');" onmouseout="out('-2372480317946695008');" style=""> 120      * @param aliasAndRealTabName                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 121      */                                                                                                  </span>
<span class="6979857197640908692" onmouseenter="enter('6979857197640908692');" onmouseout="out('6979857197640908692');" style=""><abbr title=" 122     public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealTabName, Set&lt;String&gt; sideTableSet) {"> 122     public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealðŸ”µ</abbr></span>
<span class="6808100454525620158" onmouseenter="enter('6808100454525620158');" onmouseout="out('6808100454525620158');" style=""> 123         if (leftJoin.getKind() == IDENTIFIER) {                                                          </span>
<span class="-1751511746861335268" onmouseenter="enter('-1751511746861335268');" onmouseout="out('-1751511746861335268');" style=""> 124             SqlIdentifier sqlIdentifier = (SqlIdentifier) leftJoin;                                      </span>
<span class="3343920246496917235" onmouseenter="enter('3343920246496917235');" onmouseout="out('3343920246496917235');" style=""> 125             if (sqlIdentifier.names.size() == 1 &amp;&amp; !sideTableSet.contains(sqlIdentifier.names.get(0))) { </span>
<span class="4912958075808673473" onmouseenter="enter('4912958075808673473');" onmouseout="out('4912958075808673473');" style=""><abbr title=" 126                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(0)));"> 126                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127             }                                                                                            </span>
<span class="-1513716574707047223" onmouseenter="enter('-1513716574707047223');" onmouseout="out('-1513716574707047223');" style=""> 128         } else if (leftJoin.getKind() == AS) {                                                           </span>
<span class="4921062408152466061" onmouseenter="enter('4921062408152466061');" onmouseout="out('4921062408152466061');" style=""> 129             SqlNode sqlNode = ((SqlBasicCall) leftJoin).getOperands()[0];                                </span>
<span class="-4716376852598925886" onmouseenter="enter('-4716376852598925886');" onmouseout="out('-4716376852598925886');" style=""> 130             if (sideTableSet.contains(sqlNode.toString())) {                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 131                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132             }                                                                                            </span>
<span class="-8871371884329332565" onmouseenter="enter('-8871371884329332565');" onmouseout="out('-8871371884329332565');" style=""> 133             if (sqlNode.getKind() == IDENTIFIER) {                                                       </span>
<span class="-8670728232596214008" onmouseenter="enter('-8670728232596214008');" onmouseout="out('-8670728232596214008');" style=""><abbr title=" 134                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), sqlNode.toString()));"> 134                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 135             } else {                                                                                     </span>
<span class="-562388873889266871" onmouseenter="enter('-562388873889266871');" onmouseout="out('-562388873889266871');" style=""> 136                 // child query                                                                           </span>
<span class="-2358139277705514143" onmouseenter="enter('-2358139277705514143');" onmouseout="out('-2358139277705514143');" style=""><abbr title=" 137                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), null));"> 137                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138             }                                                                                            </span>
<span class="-7673228552561235105" onmouseenter="enter('-7673228552561235105');" onmouseout="out('-7673228552561235105');" style=""> 139         } else if (leftJoin.getKind() == JOIN) {                                                         </span>
<span class="-3633036192623665744" onmouseenter="enter('-3633036192623665744');" onmouseout="out('-3633036192623665744');" style=""> 140             parseLeftNodeTableName(((SqlJoin) leftJoin).getLeft(), aliasAndRealTabName, sideTableSet);   </span>
<span class="7552580298604746031" onmouseenter="enter('7552580298604746031');" onmouseout="out('7552580298604746031');" style=""> 141             parseLeftNodeTableName(((SqlJoin) leftJoin).getRight(), aliasAndRealTabName, sideTableSet);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143     }                                                                                                    </span>
<span  style=""> 144                                                                                                          </span>
<span class="-1209813794856912353" onmouseenter="enter('-1209813794856912353');" onmouseout="out('-1209813794856912353');" style=""><abbr title=" 145     public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 145     public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, StrinðŸ”µ</abbr></span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title=" 146         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {"> 146         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().sizðŸ”µ</abbr></span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 147             SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                           </span>
<span class="-7266522834447768289" onmouseenter="enter('-7266522834447768289');" onmouseout="out('-7266522834447768289');" style=""><abbr title=" 148             Arrays.stream(operands).forEach(op -&gt; replaceJoinConditionTabName(op, mappingTable, tabAlias));"> 148             Arrays.stream(operands).forEach(op -&gt; replaceJoinConditionTabName(op, mappingTable, tabAlias)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 149         } else {                                                                                         </span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 150             SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                           </span>
<span class="-6080469922932827331" onmouseenter="enter('-6080469922932827331');" onmouseout="out('-6080469922932827331');" style=""> 151             for (int i = 0; i &lt; operands.length; i++) {                                                  </span>
<span class="2646557500991236375" onmouseenter="enter('2646557500991236375');" onmouseout="out('2646557500991236375');" style=""> 152                 SqlNode sqlNode = operands[i];                                                           </span>
<span class="-1392891079909266942" onmouseenter="enter('-1392891079909266942');" onmouseout="out('-1392891079909266942');" style=""> 153                 SqlNode replaceNode = replaceNodeInfo(sqlNode, mappingTable, tabAlias);                  </span>
<span class="-6691505626486939275" onmouseenter="enter('-6691505626486939275');" onmouseout="out('-6691505626486939275');" style=""> 154                 operands[i] = replaceNode;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156         }                                                                                                </span>
<span class="-8940717730733442812" onmouseenter="enter('-8940717730733442812');" onmouseout="out('-8940717730733442812');" style=""> 157         return conditionNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158     }                                                                                                    </span>
<span  style=""> 159                                                                                                          </span>
<span class="1058141930756888295" onmouseenter="enter('1058141930756888295');" onmouseout="out('1058141930756888295');" style=""><abbr title=" 160     public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 160     public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappiðŸ”µ</abbr></span>
<span class="4686929255097782287" onmouseenter="enter('4686929255097782287');" onmouseout="out('4686929255097782287');" style=""> 161         if (parseNode.getKind() == IDENTIFIER) {                                                         </span>
<span class="-7456553899637280302" onmouseenter="enter('-7456553899637280302');" onmouseout="out('-7456553899637280302');" style=""> 162             SqlIdentifier sqlIdentifier = (SqlIdentifier) parseNode;                                     </span>
<span  style=""> 163                                                                                                          </span>
<span  style=""> 164                                                                                                          </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style=""> 165             return sqlIdentifier;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166         }                                                                                                </span>
<span class="122290553065118475" onmouseenter="enter('122290553065118475');" onmouseout="out('122290553065118475');" style=""> 167         return parseNode;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168     }                                                                                                    </span>
<span  style=""> 169                                                                                                          </span>
<span class="626206119569915815" onmouseenter="enter('626206119569915815');" onmouseout="out('626206119569915815');" style=""><abbr title=" 170     public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, String[] fieldNames, String tableAlias) {"> 170     public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, StrinðŸ”µ</abbr></span>
<span class="-3471330630840227009" onmouseenter="enter('-3471330630840227009');" onmouseout="out('-3471330630840227009');" style=""> 171         Arrays.asList(fieldNames).forEach(fieldName -&gt; {                                                 </span>
<span class="-7416205975638868401" onmouseenter="enter('-7416205975638868401');" onmouseout="out('-7416205975638868401');" style=""> 172             String mappingTableName = dealDuplicateFieldName(midTableMapping, fieldName);                </span>
<span class="3363087492913779829" onmouseenter="enter('3363087492913779829');" onmouseout="out('3363087492913779829');" style=""> 173             midTableMapping.put(tableAlias, fieldName, mappingTableName);                                </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 174         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175     }                                                                                                    </span>
<span  style=""> 176                                                                                                          </span>
<span class="2815826266140221064" onmouseenter="enter('2815826266140221064');" onmouseout="out('2815826266140221064');" style=""><abbr title=" 177     public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, String fieldName) {"> 177     public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, StriðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 178         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 179         int index = 1;                                                                                   </span>
<span class="-5569680917805777016" onmouseenter="enter('-5569680917805777016');" onmouseout="out('-5569680917805777016');" style=""> 180         while (!mappingTable.column(mappingFieldName).isEmpty()) {                                       </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 181             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 182             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183         }                                                                                                </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 184         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185     }                                                                                                    </span>
<span  style=""> 186                                                                                                          </span>
<span class="4071999149795017902" onmouseenter="enter('4071999149795017902');" onmouseout="out('4071999149795017902');" style=""><abbr title=" 187     public static String dealDuplicateFieldName(HashBiMap&lt;String, String&gt; refFieldMap, String fieldName) {"> 187     public static String dealDuplicateFieldName(HashBiMap&lt;String, String&gt; refFieldMap, String fieldName) ðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 188         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 189         int index = 1;                                                                                   </span>
<span class="7964221408726640438" onmouseenter="enter('7964221408726640438');" onmouseout="out('7964221408726640438');" style=""> 190         while (refFieldMap.inverse().get(mappingFieldName) != null ) {                                   </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 191             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 192             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193         }                                                                                                </span>
<span  style=""> 194                                                                                                          </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 195         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196     }                                                                                                    </span>
<span  style=""> 197                                                                                                          </span>
<span class="1346113709067717957" onmouseenter="enter('1346113709067717957');" onmouseout="out('1346113709067717957');" style=""> 198     public static String dealDuplicateFieldName(Map&lt;String, String&gt; refFieldMap, String fieldName) {     </span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 199         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 200         int index = 1;                                                                                   </span>
<span class="6879974033114480599" onmouseenter="enter('6879974033114480599');" onmouseout="out('6879974033114480599');" style=""> 201         while (refFieldMap.containsKey(mappingFieldName)){                                               </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 202             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 203             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204         }                                                                                                </span>
<span  style=""> 205                                                                                                          </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 206         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="6380836709912317411" onmouseenter="enter('6380836709912317411');" onmouseout="out('6380836709912317411');" style=""> 209     public static String suffixWithChar(String str, char padChar, int repeat){                           </span>
<span class="-8241727008197568941" onmouseenter="enter('-8241727008197568941');" onmouseout="out('-8241727008197568941');" style=""> 210         StringBuilder stringBuilder = new StringBuilder(str);                                            </span>
<span class="-1977172212247055708" onmouseenter="enter('-1977172212247055708');" onmouseout="out('-1977172212247055708');" style=""> 211         for(int i=0; i&lt;repeat; i++){                                                                     </span>
<span class="1578383770707062340" onmouseenter="enter('1578383770707062340');" onmouseout="out('1578383770707062340');" style=""> 212             stringBuilder.append(padChar);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213         }                                                                                                </span>
<span  style=""> 214                                                                                                          </span>
<span class="2110628210250377389" onmouseenter="enter('2110628210250377389');" onmouseout="out('2110628210250377389');" style=""> 215         return stringBuilder.toString();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">  19 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">  20  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">  21  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">  22  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">  23  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">  24  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">  25  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">  26  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  27  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  28  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  29  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  30  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  31  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  32  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  33  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  34  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  35  */                                                                                                      </span>
<span  style="">  36                                                                                                          </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  37 package com.dtstack.flink.sql.util;                                                                      </span>
<span  style="">  38                                                                                                          </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  39 import com.google.common.collect.HashBasedTable;                                                         </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="">  40 import com.google.common.collect.HashBiMap;                                                              </span>
<span  style="">  41                                                                                                          </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  42 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  43 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  44 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  45 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  46 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  47 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  48 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span  style="">  49                                                                                                          </span>
<span class="196713859697444637" onmouseenter="enter('196713859697444637');" onmouseout="out('196713859697444637');" style="">  50 import java.util.*;                                                                                      </span>
<span  style="">  51                                                                                                          </span>
<span class="-1580562890124813833" onmouseenter="enter('-1580562890124813833');" onmouseout="out('-1580562890124813833');" style="">  52 import static org.apache.calcite.sql.SqlKind.AS;                                                         </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="">  53 import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                 </span>
<span class="-1728920721125829339" onmouseenter="enter('-1728920721125829339');" onmouseout="out('-1728920721125829339');" style="">  54 import static org.apache.calcite.sql.SqlKind.JOIN;                                                       </span>
<span  style="">  55                                                                                                          </span>
<span  style="">  56                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  57 /**                                                                                                      </span>
<span class="-5495386940022079489" onmouseenter="enter('-5495386940022079489');" onmouseout="out('-5495386940022079489');" style="">  58  * @Auther: jiangjunjie                                                                                  </span>
<span class="-5787409337524476693" onmouseenter="enter('-5787409337524476693');" onmouseout="out('-5787409337524476693');" style="">  59  * @Date: 2019-06-30 14:57                                                                               </span>
<span class="-5284392641623597580" onmouseenter="enter('-5284392641623597580');" onmouseout="out('-5284392641623597580');" style="">  60  * @Description:                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61  */                                                                                                      </span>
<span class="-1866530984685416906" onmouseenter="enter('-1866530984685416906');" onmouseout="out('-1866530984685416906');" style="">  62 public class ParseUtils {                                                                                </span>
<span class="8890655695211200116" onmouseenter="enter('8890655695211200116');" onmouseout="out('8890655695211200116');" style="">  63     public static void parseAnd(SqlNode conditionNode, List&lt;SqlNode&gt; sqlNodeList) {                      </span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title="  64         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {">  64         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().sizðŸ”µ</abbr></span>
<span class="1148725245245949994" onmouseenter="enter('1148725245245949994');" onmouseout="out('1148725245245949994');" style="">  65             parseAnd(((SqlBasicCall) conditionNode).getOperands()[0], sqlNodeList);                      </span>
<span class="-3813321520044694485" onmouseenter="enter('-3813321520044694485');" onmouseout="out('-3813321520044694485');" style="">  66             sqlNodeList.add(((SqlBasicCall) conditionNode).getOperands()[1]);                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  67         } else {                                                                                         </span>
<span class="6614631290047043163" onmouseenter="enter('6614631290047043163');" onmouseout="out('6614631290047043163');" style="">  68             sqlNodeList.add(conditionNode);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70     }                                                                                                    </span>
<span  style="">  71                                                                                                          </span>
<span class="-1060545560500196395" onmouseenter="enter('-1060545560500196395');" onmouseout="out('-1060545560500196395');" style="">  72     public static void parseJoinCompareOperate(SqlNode condition, List&lt;String&gt; sqlJoinCompareOperate) {  </span>
<span class="-2746361559719659334" onmouseenter="enter('-2746361559719659334');" onmouseout="out('-2746361559719659334');" style="">  73         SqlBasicCall joinCondition = (SqlBasicCall) condition;                                           </span>
<span class="6074868054083144054" onmouseenter="enter('6074868054083144054');" onmouseout="out('6074868054083144054');" style="">  74         if (joinCondition.getKind() == SqlKind.AND) {                                                    </span>
<span class="-4754031241214130165" onmouseenter="enter('-4754031241214130165');" onmouseout="out('-4754031241214130165');" style="">  75             List&lt;SqlNode&gt; operandList = joinCondition.getOperandList();                                  </span>
<span class="5346589125395085803" onmouseenter="enter('5346589125395085803');" onmouseout="out('5346589125395085803');" style="">  76             for (SqlNode sqlNode : operandList) {                                                        </span>
<span class="-2292733210455866502" onmouseenter="enter('-2292733210455866502');" onmouseout="out('-2292733210455866502');" style="">  77                 parseJoinCompareOperate(sqlNode, sqlJoinCompareOperate);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  79         } else {                                                                                         </span>
<span class="-1600941433765614522" onmouseenter="enter('-1600941433765614522');" onmouseout="out('-1600941433765614522');" style="">  80             String operator = transformNotEqualsOperator(joinCondition.getKind());                       </span>
<span class="4282383423815043500" onmouseenter="enter('4282383423815043500');" onmouseout="out('4282383423815043500');" style="">  81             sqlJoinCompareOperate.add(operator);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83     }                                                                                                    </span>
<span  style="">  84                                                                                                          </span>
<span class="1701523092530860818" onmouseenter="enter('1701523092530860818');" onmouseout="out('1701523092530860818');" style="">  85     public static String transformNotEqualsOperator(SqlKind sqlKind) {                                   </span>
<span class="-5519640728565052860" onmouseenter="enter('-5519640728565052860');" onmouseout="out('-5519640728565052860');" style="">  86         if (StringUtils.equalsIgnoreCase(sqlKind.toString(), &quot;NOT_EQUALS&quot;)) {                            </span>
<span class="-3530763381623721293" onmouseenter="enter('-3530763381623721293');" onmouseout="out('-3530763381623721293');" style="">  87             return &quot;!=&quot;;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88         }                                                                                                </span>
<span class="4075145857114168205" onmouseenter="enter('4075145857114168205');" onmouseout="out('4075145857114168205');" style="">  89         return sqlKind.sql;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90     }                                                                                                    </span>
<span  style="">  91                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  92     /**                                                                                                  </span>
<span class="-4264902615967480616" onmouseenter="enter('-4264902615967480616');" onmouseout="out('-4264902615967480616');" style="">  93      *  parse multi join table name, child query RealTabName is null                                     </span>
<span class="-5476579727084261436" onmouseenter="enter('-5476579727084261436');" onmouseout="out('-5476579727084261436');" style="">  94      * @param leftJoin                                                                                   </span>
<span class="-2372480317946695008" onmouseenter="enter('-2372480317946695008');" onmouseout="out('-2372480317946695008');" style="">  95      * @param aliasAndRealTabName                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  96      */                                                                                                  </span>
<span class="6979857197640908692" onmouseenter="enter('6979857197640908692');" onmouseout="out('6979857197640908692');" style=""><abbr title="  97     public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealTabName, Set&lt;String&gt; sideTableSet) {">  97     public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealðŸ”µ</abbr></span>
<span class="6808100454525620158" onmouseenter="enter('6808100454525620158');" onmouseout="out('6808100454525620158');" style="">  98         if (leftJoin.getKind() == IDENTIFIER) {                                                          </span>
<span class="-1751511746861335268" onmouseenter="enter('-1751511746861335268');" onmouseout="out('-1751511746861335268');" style="">  99             SqlIdentifier sqlIdentifier = (SqlIdentifier) leftJoin;                                      </span>
<span class="3343920246496917235" onmouseenter="enter('3343920246496917235');" onmouseout="out('3343920246496917235');" style=""> 100             if (sqlIdentifier.names.size() == 1 &amp;&amp; !sideTableSet.contains(sqlIdentifier.names.get(0))) { </span>
<span class="4912958075808673473" onmouseenter="enter('4912958075808673473');" onmouseout="out('4912958075808673473');" style=""><abbr title=" 101                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(0)));"> 101                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102             }                                                                                            </span>
<span class="-1513716574707047223" onmouseenter="enter('-1513716574707047223');" onmouseout="out('-1513716574707047223');" style=""> 103         } else if (leftJoin.getKind() == AS) {                                                           </span>
<span class="4921062408152466061" onmouseenter="enter('4921062408152466061');" onmouseout="out('4921062408152466061');" style=""> 104             SqlNode sqlNode = ((SqlBasicCall) leftJoin).getOperands()[0];                                </span>
<span class="-4716376852598925886" onmouseenter="enter('-4716376852598925886');" onmouseout="out('-4716376852598925886');" style=""> 105             if (sideTableSet.contains(sqlNode.toString())) {                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 106                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107             }                                                                                            </span>
<span class="-8871371884329332565" onmouseenter="enter('-8871371884329332565');" onmouseout="out('-8871371884329332565');" style=""> 108             if (sqlNode.getKind() == IDENTIFIER) {                                                       </span>
<span class="-8670728232596214008" onmouseenter="enter('-8670728232596214008');" onmouseout="out('-8670728232596214008');" style=""><abbr title=" 109                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), sqlNode.toString()));"> 109                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 110             } else {                                                                                     </span>
<span class="-562388873889266871" onmouseenter="enter('-562388873889266871');" onmouseout="out('-562388873889266871');" style=""> 111                 // child query                                                                           </span>
<span class="-2358139277705514143" onmouseenter="enter('-2358139277705514143');" onmouseout="out('-2358139277705514143');" style=""><abbr title=" 112                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), null));"> 112                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113             }                                                                                            </span>
<span class="-7673228552561235105" onmouseenter="enter('-7673228552561235105');" onmouseout="out('-7673228552561235105');" style=""> 114         } else if (leftJoin.getKind() == JOIN) {                                                         </span>
<span class="-3633036192623665744" onmouseenter="enter('-3633036192623665744');" onmouseout="out('-3633036192623665744');" style=""> 115             parseLeftNodeTableName(((SqlJoin) leftJoin).getLeft(), aliasAndRealTabName, sideTableSet);   </span>
<span class="7552580298604746031" onmouseenter="enter('7552580298604746031');" onmouseout="out('7552580298604746031');" style=""> 116             parseLeftNodeTableName(((SqlJoin) leftJoin).getRight(), aliasAndRealTabName, sideTableSet);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118     }                                                                                                    </span>
<span  style=""> 119                                                                                                          </span>
<span class="-1209813794856912353" onmouseenter="enter('-1209813794856912353');" onmouseout="out('-1209813794856912353');" style=""><abbr title=" 120     public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 120     public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, StrinðŸ”µ</abbr></span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title=" 121         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {"> 121         if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().sizðŸ”µ</abbr></span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 122             SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                           </span>
<span class="-7266522834447768289" onmouseenter="enter('-7266522834447768289');" onmouseout="out('-7266522834447768289');" style=""><abbr title=" 123             Arrays.stream(operands).forEach(op -&gt; replaceJoinConditionTabName(op, mappingTable, tabAlias));"> 123             Arrays.stream(operands).forEach(op -&gt; replaceJoinConditionTabName(op, mappingTable, tabAlias)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 124         } else {                                                                                         </span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 125             SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                           </span>
<span class="-6080469922932827331" onmouseenter="enter('-6080469922932827331');" onmouseout="out('-6080469922932827331');" style=""> 126             for (int i = 0; i &lt; operands.length; i++) {                                                  </span>
<span class="2646557500991236375" onmouseenter="enter('2646557500991236375');" onmouseout="out('2646557500991236375');" style=""> 127                 SqlNode sqlNode = operands[i];                                                           </span>
<span class="-1392891079909266942" onmouseenter="enter('-1392891079909266942');" onmouseout="out('-1392891079909266942');" style=""> 128                 SqlNode replaceNode = replaceNodeInfo(sqlNode, mappingTable, tabAlias);                  </span>
<span class="-6691505626486939275" onmouseenter="enter('-6691505626486939275');" onmouseout="out('-6691505626486939275');" style=""> 129                 operands[i] = replaceNode;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131         }                                                                                                </span>
<span class="-8940717730733442812" onmouseenter="enter('-8940717730733442812');" onmouseout="out('-8940717730733442812');" style=""> 132         return conditionNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133     }                                                                                                    </span>
<span  style=""> 134                                                                                                          </span>
<span class="1058141930756888295" onmouseenter="enter('1058141930756888295');" onmouseout="out('1058141930756888295');" style=""><abbr title=" 135     public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 135     public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappiðŸ”µ</abbr></span>
<span class="4686929255097782287" onmouseenter="enter('4686929255097782287');" onmouseout="out('4686929255097782287');" style=""> 136         if (parseNode.getKind() == IDENTIFIER) {                                                         </span>
<span class="-7456553899637280302" onmouseenter="enter('-7456553899637280302');" onmouseout="out('-7456553899637280302');" style=""> 137             SqlIdentifier sqlIdentifier = (SqlIdentifier) parseNode;                                     </span>
<span  style=""> 138                                                                                                          </span>
<span  style=""> 139                                                                                                          </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style=""> 140             return sqlIdentifier;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141         }                                                                                                </span>
<span class="122290553065118475" onmouseenter="enter('122290553065118475');" onmouseout="out('122290553065118475');" style=""> 142         return parseNode;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143     }                                                                                                    </span>
<span  style=""> 144                                                                                                          </span>
<span class="626206119569915815" onmouseenter="enter('626206119569915815');" onmouseout="out('626206119569915815');" style=""><abbr title=" 145     public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, String[] fieldNames, String tableAlias) {"> 145     public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, StrinðŸ”µ</abbr></span>
<span class="-3471330630840227009" onmouseenter="enter('-3471330630840227009');" onmouseout="out('-3471330630840227009');" style=""> 146         Arrays.asList(fieldNames).forEach(fieldName -&gt; {                                                 </span>
<span class="-7416205975638868401" onmouseenter="enter('-7416205975638868401');" onmouseout="out('-7416205975638868401');" style=""> 147             String mappingTableName = dealDuplicateFieldName(midTableMapping, fieldName);                </span>
<span class="3363087492913779829" onmouseenter="enter('3363087492913779829');" onmouseout="out('3363087492913779829');" style=""> 148             midTableMapping.put(tableAlias, fieldName, mappingTableName);                                </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 149         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150     }                                                                                                    </span>
<span  style=""> 151                                                                                                          </span>
<span class="2815826266140221064" onmouseenter="enter('2815826266140221064');" onmouseout="out('2815826266140221064');" style=""><abbr title=" 152     public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, String fieldName) {"> 152     public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, StriðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 153         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 154         int index = 1;                                                                                   </span>
<span class="-5569680917805777016" onmouseenter="enter('-5569680917805777016');" onmouseout="out('-5569680917805777016');" style=""> 155         while (!mappingTable.column(mappingFieldName).isEmpty()) {                                       </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 156             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 157             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158         }                                                                                                </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 159         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160     }                                                                                                    </span>
<span  style=""> 161                                                                                                          </span>
<span class="4071999149795017902" onmouseenter="enter('4071999149795017902');" onmouseout="out('4071999149795017902');" style=""><abbr title=" 162     public static String dealDuplicateFieldName(HashBiMap&lt;String, String&gt; refFieldMap, String fieldName) {"> 162     public static String dealDuplicateFieldName(HashBiMap&lt;String, String&gt; refFieldMap, String fieldName) ðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 163         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 164         int index = 1;                                                                                   </span>
<span class="7964221408726640438" onmouseenter="enter('7964221408726640438');" onmouseout="out('7964221408726640438');" style=""> 165         while (refFieldMap.inverse().get(mappingFieldName) != null ) {                                   </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 166             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 167             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168         }                                                                                                </span>
<span  style=""> 169                                                                                                          </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 170         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171     }                                                                                                    </span>
<span  style=""> 172                                                                                                          </span>
<span class="1346113709067717957" onmouseenter="enter('1346113709067717957');" onmouseout="out('1346113709067717957');" style=""> 173     public static String dealDuplicateFieldName(Map&lt;String, String&gt; refFieldMap, String fieldName) {     </span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 174         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 175         int index = 1;                                                                                   </span>
<span class="6879974033114480599" onmouseenter="enter('6879974033114480599');" onmouseout="out('6879974033114480599');" style=""> 176         while (refFieldMap.containsKey(mappingFieldName)){                                               </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 177             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 178             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179         }                                                                                                </span>
<span  style=""> 180                                                                                                          </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 181         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182     }                                                                                                    </span>
<span  style=""> 183                                                                                                          </span>
<span class="6380836709912317411" onmouseenter="enter('6380836709912317411');" onmouseout="out('6380836709912317411');" style=""> 184     public static String suffixWithChar(String str, char padChar, int repeat){                           </span>
<span class="-8241727008197568941" onmouseenter="enter('-8241727008197568941');" onmouseout="out('-8241727008197568941');" style=""> 185         StringBuilder stringBuilder = new StringBuilder(str);                                            </span>
<span class="-1977172212247055708" onmouseenter="enter('-1977172212247055708');" onmouseout="out('-1977172212247055708');" style=""> 186         for(int i=0; i&lt;repeat; i++){                                                                     </span>
<span class="1578383770707062340" onmouseenter="enter('1578383770707062340');" onmouseout="out('1578383770707062340');" style=""> 187             stringBuilder.append(padChar);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span  style=""> 189                                                                                                          </span>
<span class="2110628210250377389" onmouseenter="enter('2110628210250377389');" onmouseout="out('2110628210250377389');" style=""> 190         return stringBuilder.toString();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192 }                                                                                                        </span>























</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  18 package com.dtstack.flink.sql.util;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  20 import com.google.common.collect.HashBasedTable;                                                         </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="">  21 import com.google.common.collect.HashBiMap;                                                              </span>
<span class="196713859697444637" onmouseenter="enter('196713859697444637');" onmouseout="out('196713859697444637');" style="">  22 import java.util.*;                                                                                      </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  23 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  24 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  25 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  26 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  27 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  28 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  29 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="-1580562890124813833" onmouseenter="enter('-1580562890124813833');" onmouseout="out('-1580562890124813833');" style="">  30 import static org.apache.calcite.sql.SqlKind.AS;                                                         </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="">  31 import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                 </span>
<span class="-1728920721125829339" onmouseenter="enter('-1728920721125829339');" onmouseout="out('-1728920721125829339');" style="">  32 import static org.apache.calcite.sql.SqlKind.JOIN;                                                       </span>
<span  style="">  33                                                                                                          </span>
<span  style="">  34                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  35 /**                                                                                                      </span>
<span class="-5495386940022079489" onmouseenter="enter('-5495386940022079489');" onmouseout="out('-5495386940022079489');" style="">  36  * @Auther: jiangjunjie                                                                                  </span>
<span class="-5787409337524476693" onmouseenter="enter('-5787409337524476693');" onmouseout="out('-5787409337524476693');" style="">  37  * @Date: 2019-06-30 14:57                                                                               </span>
<span class="-5284392641623597580" onmouseenter="enter('-5284392641623597580');" onmouseout="out('-5284392641623597580');" style="">  38  * @Description:                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  39  */                                                                                                      </span>
<span class="-1866530984685416906" onmouseenter="enter('-1866530984685416906');" onmouseout="out('-1866530984685416906');" style="">  40 public class ParseUtils {                                                                                </span>
<span class="8890655695211200116" onmouseenter="enter('8890655695211200116');" onmouseout="out('8890655695211200116');" style="">  41     public static void parseAnd(SqlNode conditionNode, List&lt;SqlNode&gt; sqlNodeList) {                      </span>
<span class="3223928795117429715" onmouseenter="enter('3223928795117429715');" onmouseout="out('3223928795117429715');" style=""><abbr title="  42         if ((conditionNode.getKind() == SqlKind.AND) &amp;&amp; (((SqlBasicCall) (conditionNode)).getOperandList().size() == 2)) {">  42         if ((conditionNode.getKind() == SqlKind.AND) &amp;&amp; (((SqlBasicCall) (conditionNode)).getOperandList(ðŸ”µ</abbr></span>
<span class="-6187435779079008380" onmouseenter="enter('-6187435779079008380');" onmouseout="out('-6187435779079008380');" style="">  43             parseAnd(((SqlBasicCall) (conditionNode)).getOperands()[0], sqlNodeList);                    </span>
<span class="-2476701878343248111" onmouseenter="enter('-2476701878343248111');" onmouseout="out('-2476701878343248111');" style="">  44             sqlNodeList.add(((SqlBasicCall) (conditionNode)).getOperands()[1]);                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  45         } else {                                                                                         </span>
<span class="6614631290047043163" onmouseenter="enter('6614631290047043163');" onmouseout="out('6614631290047043163');" style="">  46             sqlNodeList.add(conditionNode);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  47         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  48     }                                                                                                    </span>
<span  style="">  49                                                                                                          </span>
<span class="-1060545560500196395" onmouseenter="enter('-1060545560500196395');" onmouseout="out('-1060545560500196395');" style="">  50     public static void parseJoinCompareOperate(SqlNode condition, List&lt;String&gt; sqlJoinCompareOperate) {  </span>
<span class="857709277749288927" onmouseenter="enter('857709277749288927');" onmouseout="out('857709277749288927');" style="">  51         SqlBasicCall joinCondition = ((SqlBasicCall) (condition));                                       </span>
<span class="6074868054083144054" onmouseenter="enter('6074868054083144054');" onmouseout="out('6074868054083144054');" style="">  52         if (joinCondition.getKind() == SqlKind.AND) {                                                    </span>
<span class="-4754031241214130165" onmouseenter="enter('-4754031241214130165');" onmouseout="out('-4754031241214130165');" style="">  53             List&lt;SqlNode&gt; operandList = joinCondition.getOperandList();                                  </span>
<span class="5346589125395085803" onmouseenter="enter('5346589125395085803');" onmouseout="out('5346589125395085803');" style="">  54             for (SqlNode sqlNode : operandList) {                                                        </span>
<span class="-2292733210455866502" onmouseenter="enter('-2292733210455866502');" onmouseout="out('-2292733210455866502');" style="">  55                 parseJoinCompareOperate(sqlNode, sqlJoinCompareOperate);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  56             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  57         } else {                                                                                         </span>
<span class="-1600941433765614522" onmouseenter="enter('-1600941433765614522');" onmouseout="out('-1600941433765614522');" style="">  58             String operator = transformNotEqualsOperator(joinCondition.getKind());                       </span>
<span class="4282383423815043500" onmouseenter="enter('4282383423815043500');" onmouseout="out('4282383423815043500');" style="">  59             sqlJoinCompareOperate.add(operator);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  60         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  61     }                                                                                                    </span>
<span  style="">  62                                                                                                          </span>
<span class="1701523092530860818" onmouseenter="enter('1701523092530860818');" onmouseout="out('1701523092530860818');" style="">  63     public static String transformNotEqualsOperator(SqlKind sqlKind) {                                   </span>
<span class="-5519640728565052860" onmouseenter="enter('-5519640728565052860');" onmouseout="out('-5519640728565052860');" style="">  64         if (StringUtils.equalsIgnoreCase(sqlKind.toString(), &quot;NOT_EQUALS&quot;)) {                            </span>
<span class="-3530763381623721293" onmouseenter="enter('-3530763381623721293');" onmouseout="out('-3530763381623721293');" style="">  65             return &quot;!=&quot;;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  66         }                                                                                                </span>
<span class="4075145857114168205" onmouseenter="enter('4075145857114168205');" onmouseout="out('4075145857114168205');" style="">  67         return sqlKind.sql;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  68     }                                                                                                    </span>
<span  style="">  69                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  70     /**                                                                                                  </span>
<span class="-4264902615967480616" onmouseenter="enter('-4264902615967480616');" onmouseout="out('-4264902615967480616');" style="">  71      *  parse multi join table name, child query RealTabName is null                                     </span>
<span class="-5476579727084261436" onmouseenter="enter('-5476579727084261436');" onmouseout="out('-5476579727084261436');" style="">  72      * @param leftJoin                                                                                   </span>
<span class="-2372480317946695008" onmouseenter="enter('-2372480317946695008');" onmouseout="out('-2372480317946695008');" style="">  73      * @param aliasAndRealTabName                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  74      */                                                                                                  </span>
<span class="6979857197640908692" onmouseenter="enter('6979857197640908692');" onmouseout="out('6979857197640908692');" style=""><abbr title="  75     public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealTabName, Set&lt;String&gt; sideTableSet) {">  75     public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealðŸ”µ</abbr></span>
<span class="6808100454525620158" onmouseenter="enter('6808100454525620158');" onmouseout="out('6808100454525620158');" style="">  76         if (leftJoin.getKind() == IDENTIFIER) {                                                          </span>
<span class="-7988315652468179269" onmouseenter="enter('-7988315652468179269');" onmouseout="out('-7988315652468179269');" style="">  77             SqlIdentifier sqlIdentifier = ((SqlIdentifier) (leftJoin));                                  </span>
<span class="-2780779404470296058" onmouseenter="enter('-2780779404470296058');" onmouseout="out('-2780779404470296058');" style=""><abbr title="  78             if ((sqlIdentifier.names.size() == 1) &amp;&amp; (!sideTableSet.contains(sqlIdentifier.names.get(0)))) {">  78             if ((sqlIdentifier.names.size() == 1) &amp;&amp; (!sideTableSet.contains(sqlIdentifier.names.get(0)))ðŸ”µ</abbr></span>
<span class="4912958075808673473" onmouseenter="enter('4912958075808673473');" onmouseout="out('4912958075808673473');" style=""><abbr title="  79                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(0)));">  79                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80             }                                                                                            </span>
<span class="-1513716574707047223" onmouseenter="enter('-1513716574707047223');" onmouseout="out('-1513716574707047223');" style="">  81         } else if (leftJoin.getKind() == AS) {                                                           </span>
<span class="3174530827416514101" onmouseenter="enter('3174530827416514101');" onmouseout="out('3174530827416514101');" style="">  82             SqlNode sqlNode = ((SqlBasicCall) (leftJoin)).getOperands()[0];                              </span>
<span class="-4716376852598925886" onmouseenter="enter('-4716376852598925886');" onmouseout="out('-4716376852598925886');" style="">  83             if (sideTableSet.contains(sqlNode.toString())) {                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  84                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85             }                                                                                            </span>
<span class="-8871371884329332565" onmouseenter="enter('-8871371884329332565');" onmouseout="out('-8871371884329332565');" style="">  86             if (sqlNode.getKind() == IDENTIFIER) {                                                       </span>
<span class="746509718229466992" onmouseenter="enter('746509718229466992');" onmouseout="out('746509718229466992');" style=""><abbr title="  87                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) (leftJoin)).getOperands()[1].toString(), sqlNode.toString()));">  87                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) (leftJoin)).getOperands()[1].toStrinðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  88             } else {                                                                                     </span>
<span class="-562388873889266871" onmouseenter="enter('-562388873889266871');" onmouseout="out('-562388873889266871');" style="">  89                 // child query                                                                           </span>
<span class="2653283997766065192" onmouseenter="enter('2653283997766065192');" onmouseout="out('2653283997766065192');" style=""><abbr title="  90                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) (leftJoin)).getOperands()[1].toString(), null));">  90                 aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) (leftJoin)).getOperands()[1].toStrinðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91             }                                                                                            </span>
<span class="-7673228552561235105" onmouseenter="enter('-7673228552561235105');" onmouseout="out('-7673228552561235105');" style="">  92         } else if (leftJoin.getKind() == JOIN) {                                                         </span>
<span class="-2966979082134113632" onmouseenter="enter('-2966979082134113632');" onmouseout="out('-2966979082134113632');" style="">  93             parseLeftNodeTableName(((SqlJoin) (leftJoin)).getLeft(), aliasAndRealTabName, sideTableSet); </span>
<span class="-4801011956012789018" onmouseenter="enter('-4801011956012789018');" onmouseout="out('-4801011956012789018');" style="">  94             parseLeftNodeTableName(((SqlJoin) (leftJoin)).getRight(), aliasAndRealTabName, sideTableSet);</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96     }                                                                                                    </span>
<span  style="">  97                                                                                                          </span>
<span class="-1209813794856912353" onmouseenter="enter('-1209813794856912353');" onmouseout="out('-1209813794856912353');" style=""><abbr title="  98     public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {">  98     public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, StrinðŸ”µ</abbr></span>
<span class="3223928795117429715" onmouseenter="enter('3223928795117429715');" onmouseout="out('3223928795117429715');" style=""><abbr title="  99         if ((conditionNode.getKind() == SqlKind.AND) &amp;&amp; (((SqlBasicCall) (conditionNode)).getOperandList().size() == 2)) {">  99         if ((conditionNode.getKind() == SqlKind.AND) &amp;&amp; (((SqlBasicCall) (conditionNode)).getOperandList(ðŸ”µ</abbr></span>
<span class="-8359963304724154146" onmouseenter="enter('-8359963304724154146');" onmouseout="out('-8359963304724154146');" style=""> 100             SqlNode[] operands = ((SqlBasicCall) (conditionNode)).getOperands();                         </span>
<span class="-5617714235642849710" onmouseenter="enter('-5617714235642849710');" onmouseout="out('-5617714235642849710');" style=""><abbr title=" 101             Arrays.stream(operands).forEach(( op) -&gt; replaceJoinConditionTabName(op, mappingTable, tabAlias));"> 101             Arrays.stream(operands).forEach(( op) -&gt; replaceJoinConditionTabName(op, mappingTable, tabAliðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 102         } else {                                                                                         </span>
<span class="-8359963304724154146" onmouseenter="enter('-8359963304724154146');" onmouseout="out('-8359963304724154146');" style=""> 103             SqlNode[] operands = ((SqlBasicCall) (conditionNode)).getOperands();                         </span>
<span class="-6080469922932827331" onmouseenter="enter('-6080469922932827331');" onmouseout="out('-6080469922932827331');" style=""> 104             for (int i = 0; i &lt; operands.length; i++) {                                                  </span>
<span class="2646557500991236375" onmouseenter="enter('2646557500991236375');" onmouseout="out('2646557500991236375');" style=""> 105                 SqlNode sqlNode = operands[i];                                                           </span>
<span class="-1392891079909266942" onmouseenter="enter('-1392891079909266942');" onmouseout="out('-1392891079909266942');" style=""> 106                 SqlNode replaceNode = replaceNodeInfo(sqlNode, mappingTable, tabAlias);                  </span>
<span class="-6691505626486939275" onmouseenter="enter('-6691505626486939275');" onmouseout="out('-6691505626486939275');" style=""> 107                 operands[i] = replaceNode;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109         }                                                                                                </span>
<span class="-8940717730733442812" onmouseenter="enter('-8940717730733442812');" onmouseout="out('-8940717730733442812');" style=""> 110         return conditionNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111     }                                                                                                    </span>
<span  style=""> 112                                                                                                          </span>
<span class="1058141930756888295" onmouseenter="enter('1058141930756888295');" onmouseout="out('1058141930756888295');" style=""><abbr title=" 113     public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 113     public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappiðŸ”µ</abbr></span>
<span class="4686929255097782287" onmouseenter="enter('4686929255097782287');" onmouseout="out('4686929255097782287');" style=""> 114         if (parseNode.getKind() == IDENTIFIER) {                                                         </span>
<span class="2748433791732753666" onmouseenter="enter('2748433791732753666');" onmouseout="out('2748433791732753666');" style=""> 115             SqlIdentifier sqlIdentifier = ((SqlIdentifier) (parseNode));                                 </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style=""> 116             return sqlIdentifier;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117         }                                                                                                </span>
<span class="122290553065118475" onmouseenter="enter('122290553065118475');" onmouseout="out('122290553065118475');" style=""> 118         return parseNode;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119     }                                                                                                    </span>
<span  style=""> 120                                                                                                          </span>
<span class="626206119569915815" onmouseenter="enter('626206119569915815');" onmouseout="out('626206119569915815');" style=""><abbr title=" 121     public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, String[] fieldNames, String tableAlias) {"> 121     public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, StrinðŸ”µ</abbr></span>
<span class="-3471330630840227009" onmouseenter="enter('-3471330630840227009');" onmouseout="out('-3471330630840227009');" style=""> 122         Arrays.asList(fieldNames).forEach(fieldName -&gt; {                                                 </span>
<span class="-7416205975638868401" onmouseenter="enter('-7416205975638868401');" onmouseout="out('-7416205975638868401');" style=""> 123             String mappingTableName = dealDuplicateFieldName(midTableMapping, fieldName);                </span>
<span class="3363087492913779829" onmouseenter="enter('3363087492913779829');" onmouseout="out('3363087492913779829');" style=""> 124             midTableMapping.put(tableAlias, fieldName, mappingTableName);                                </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 125         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126     }                                                                                                    </span>
<span  style=""> 127                                                                                                          </span>
<span class="2815826266140221064" onmouseenter="enter('2815826266140221064');" onmouseout="out('2815826266140221064');" style=""><abbr title=" 128     public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, String fieldName) {"> 128     public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, StriðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 129         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 130         int index = 1;                                                                                   </span>
<span class="-5569680917805777016" onmouseenter="enter('-5569680917805777016');" onmouseout="out('-5569680917805777016');" style=""> 131         while (!mappingTable.column(mappingFieldName).isEmpty()) {                                       </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 132             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 133             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134         }                                                                                                </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 135         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136     }                                                                                                    </span>
<span  style=""> 137                                                                                                          </span>
<span class="4071999149795017902" onmouseenter="enter('4071999149795017902');" onmouseout="out('4071999149795017902');" style=""><abbr title=" 138     public static String dealDuplicateFieldName(HashBiMap&lt;String, String&gt; refFieldMap, String fieldName) {"> 138     public static String dealDuplicateFieldName(HashBiMap&lt;String, String&gt; refFieldMap, String fieldName) ðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 139         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 140         int index = 1;                                                                                   </span>
<span class="7964221408726640438" onmouseenter="enter('7964221408726640438');" onmouseout="out('7964221408726640438');" style=""> 141         while (refFieldMap.inverse().get(mappingFieldName) != null ) {                                   </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 142             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 143             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144         }                                                                                                </span>
<span  style=""> 145                                                                                                          </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 146         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147     }                                                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="1346113709067717957" onmouseenter="enter('1346113709067717957');" onmouseout="out('1346113709067717957');" style=""> 149     public static String dealDuplicateFieldName(Map&lt;String, String&gt; refFieldMap, String fieldName) {     </span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 150         String mappingFieldName = fieldName;                                                             </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style=""> 151         int index = 1;                                                                                   </span>
<span class="6879974033114480599" onmouseenter="enter('6879974033114480599');" onmouseout="out('6879974033114480599');" style=""> 152         while (refFieldMap.containsKey(mappingFieldName)){                                               </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style=""> 153             mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                    </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 154             index++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155         }                                                                                                </span>
<span  style=""> 156                                                                                                          </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 157         return mappingFieldName;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158     }                                                                                                    </span>
<span  style=""> 159                                                                                                          </span>
<span class="6380836709912317411" onmouseenter="enter('6380836709912317411');" onmouseout="out('6380836709912317411');" style=""> 160     public static String suffixWithChar(String str, char padChar, int repeat){                           </span>
<span class="-8241727008197568941" onmouseenter="enter('-8241727008197568941');" onmouseout="out('-8241727008197568941');" style=""> 161         StringBuilder stringBuilder = new StringBuilder(str);                                            </span>
<span class="-1977172212247055708" onmouseenter="enter('-1977172212247055708');" onmouseout="out('-1977172212247055708');" style=""> 162         for(int i=0; i&lt;repeat; i++){                                                                     </span>
<span class="1578383770707062340" onmouseenter="enter('1578383770707062340');" onmouseout="out('1578383770707062340');" style=""> 163             stringBuilder.append(padChar);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164         }                                                                                                </span>
<span  style=""> 165                                                                                                          </span>
<span class="2110628210250377389" onmouseenter="enter('2110628210250377389');" onmouseout="out('2110628210250377389');" style=""> 166         return stringBuilder.toString();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168 }                                                                                                        </span>















































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">  19  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">  20   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">  21   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">  22   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">  23   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">  24   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">  25   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">  26   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  27   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  28   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  29   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  30   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  31   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  32   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  33   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  34   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  35   */                                                                                                               </span>
<span  style="">  36                                                                                                                    </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  37  package com.dtstack.flink.sql.util;                                                                               </span>
<span  style="">  38                                                                                                                    </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  39  import com.google.common.collect.HashBasedTable;                                                                  </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +import com.google.common.collect.HashBiMap;                                                                       </span>
<span class="5169042772451251702" onmouseenter="enter('5169042772451251702');" onmouseout="out('5169042772451251702');" style="">  41  import org.apache.calcite.sql.*;                                                                                  </span>






<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  42  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  43  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span  style="">  44                                                                                                                    </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import java.util.Arrays;                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import java.util.Map;                                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import java.util.Set;                                                                                             </span>
<span class="196713859697444637" onmouseenter="enter('196713859697444637');" onmouseout="out('196713859697444637');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +import java.util.*;                                                                                               </span>
<span  style="">  50                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  51  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>




<span  style="">  52                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  53  /**                                                                                                               </span>
<span class="-5495386940022079489" onmouseenter="enter('-5495386940022079489');" onmouseout="out('-5495386940022079489');" style="">  54   * @Auther: jiangjunjie                                                                                           </span>
<span class="-5787409337524476693" onmouseenter="enter('-5787409337524476693');" onmouseout="out('-5787409337524476693');" style="">  55   * @Date: 2019-06-30 14:57                                                                                        </span>
<span class="-5284392641623597580" onmouseenter="enter('-5284392641623597580');" onmouseout="out('-5284392641623597580');" style="">  56   * @Description:                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57   */                                                                                                               </span>
<span class="-1866530984685416906" onmouseenter="enter('-1866530984685416906');" onmouseout="out('-1866530984685416906');" style="">  58  public class ParseUtils {                                                                                         </span>
<span class="8890655695211200116" onmouseenter="enter('8890655695211200116');" onmouseout="out('8890655695211200116');" style="">  59      public static void parseAnd(SqlNode conditionNode, List&lt;SqlNode&gt; sqlNodeList) {                               </span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title="  60          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {">  60          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2)ðŸ”µ</abbr></span>
<span class="1148725245245949994" onmouseenter="enter('1148725245245949994');" onmouseout="out('1148725245245949994');" style="">  61              parseAnd(((SqlBasicCall) conditionNode).getOperands()[0], sqlNodeList);                               </span>
<span class="-3813321520044694485" onmouseenter="enter('-3813321520044694485');" onmouseout="out('-3813321520044694485');" style="">  62              sqlNodeList.add(((SqlBasicCall) conditionNode).getOperands()[1]);                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  63          } else {                                                                                                  </span>
<span class="6614631290047043163" onmouseenter="enter('6614631290047043163');" onmouseout="out('6614631290047043163');" style="">  64              sqlNodeList.add(conditionNode);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  66      }                                                                                                             </span>
<span  style="">  67                                                                                                                    </span>
<span class="-1060545560500196395" onmouseenter="enter('-1060545560500196395');" onmouseout="out('-1060545560500196395');" style="">  68      public static void parseJoinCompareOperate(SqlNode condition, List&lt;String&gt; sqlJoinCompareOperate) {           </span>
<span class="-2746361559719659334" onmouseenter="enter('-2746361559719659334');" onmouseout="out('-2746361559719659334');" style="">  69          SqlBasicCall joinCondition = (SqlBasicCall) condition;                                                    </span>
<span class="6074868054083144054" onmouseenter="enter('6074868054083144054');" onmouseout="out('6074868054083144054');" style="">  70          if (joinCondition.getKind() == SqlKind.AND) {                                                             </span>
<span class="-4754031241214130165" onmouseenter="enter('-4754031241214130165');" onmouseout="out('-4754031241214130165');" style="">  71              List&lt;SqlNode&gt; operandList = joinCondition.getOperandList();                                           </span>
<span class="5346589125395085803" onmouseenter="enter('5346589125395085803');" onmouseout="out('5346589125395085803');" style="">  72              for (SqlNode sqlNode : operandList) {                                                                 </span>
<span class="-2292733210455866502" onmouseenter="enter('-2292733210455866502');" onmouseout="out('-2292733210455866502');" style="">  73                  parseJoinCompareOperate(sqlNode, sqlJoinCompareOperate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  75          } else {                                                                                                  </span>
<span class="-1600941433765614522" onmouseenter="enter('-1600941433765614522');" onmouseout="out('-1600941433765614522');" style="">  76              String operator = transformNotEqualsOperator(joinCondition.getKind());                                </span>
<span class="4282383423815043500" onmouseenter="enter('4282383423815043500');" onmouseout="out('4282383423815043500');" style="">  77              sqlJoinCompareOperate.add(operator);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79      }                                                                                                             </span>
<span  style="">  80                                                                                                                    </span>
<span class="1701523092530860818" onmouseenter="enter('1701523092530860818');" onmouseout="out('1701523092530860818');" style="">  81      public static String transformNotEqualsOperator(SqlKind sqlKind) {                                            </span>
<span class="-5519640728565052860" onmouseenter="enter('-5519640728565052860');" onmouseout="out('-5519640728565052860');" style="">  82          if (StringUtils.equalsIgnoreCase(sqlKind.toString(), &quot;NOT_EQUALS&quot;)) {                                     </span>
<span class="-3530763381623721293" onmouseenter="enter('-3530763381623721293');" onmouseout="out('-3530763381623721293');" style="">  83              return &quot;!=&quot;;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84          }                                                                                                         </span>
<span class="4075145857114168205" onmouseenter="enter('4075145857114168205');" onmouseout="out('4075145857114168205');" style="">  85          return sqlKind.sql;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86      }                                                                                                             </span>
<span  style="">  87                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  88      /**                                                                                                           </span>
<span class="-4264902615967480616" onmouseenter="enter('-4264902615967480616');" onmouseout="out('-4264902615967480616');" style="">  89       *  parse multi join table name, child query RealTabName is null                                              </span>
<span class="-5476579727084261436" onmouseenter="enter('-5476579727084261436');" onmouseout="out('-5476579727084261436');" style="">  90       * @param leftJoin                                                                                            </span>
<span class="-2372480317946695008" onmouseenter="enter('-2372480317946695008');" onmouseout="out('-2372480317946695008');" style="">  91       * @param aliasAndRealTabName                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  92       */                                                                                                           </span>
<span class="6979857197640908692" onmouseenter="enter('6979857197640908692');" onmouseout="out('6979857197640908692');" style=""><abbr title="  93      public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealTabName, Set&lt;String&gt; sideTableSet) {">  93      public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealTabName, ðŸ”µ</abbr></span>
<span class="6808100454525620158" onmouseenter="enter('6808100454525620158');" onmouseout="out('6808100454525620158');" style="">  94          if (leftJoin.getKind() == IDENTIFIER) {                                                                   </span>
<span class="-1751511746861335268" onmouseenter="enter('-1751511746861335268');" onmouseout="out('-1751511746861335268');" style="">  95              SqlIdentifier sqlIdentifier = (SqlIdentifier) leftJoin;                                               </span>
<span class="3343920246496917235" onmouseenter="enter('3343920246496917235');" onmouseout="out('3343920246496917235');" style="">  96              if (sqlIdentifier.names.size() == 1 &amp;&amp; !sideTableSet.contains(sqlIdentifier.names.get(0))) {          </span>
<span class="4912958075808673473" onmouseenter="enter('4912958075808673473');" onmouseout="out('4912958075808673473');" style="">  97                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(0)));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98              }                                                                                                     </span>
<span class="-1513716574707047223" onmouseenter="enter('-1513716574707047223');" onmouseout="out('-1513716574707047223');" style="">  99          } else if (leftJoin.getKind() == AS) {                                                                    </span>
<span class="4921062408152466061" onmouseenter="enter('4921062408152466061');" onmouseout="out('4921062408152466061');" style=""> 100              SqlNode sqlNode = ((SqlBasicCall) leftJoin).getOperands()[0];                                         </span>
<span class="-4716376852598925886" onmouseenter="enter('-4716376852598925886');" onmouseout="out('-4716376852598925886');" style=""> 101              if (sideTableSet.contains(sqlNode.toString())) {                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 102                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103              }                                                                                                     </span>
<span class="-8871371884329332565" onmouseenter="enter('-8871371884329332565');" onmouseout="out('-8871371884329332565');" style=""> 104              if (sqlNode.getKind() == IDENTIFIER) {                                                                </span>
<span class="-8670728232596214008" onmouseenter="enter('-8670728232596214008');" onmouseout="out('-8670728232596214008');" style=""><abbr title=" 105                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), sqlNode.toString()));"> 105                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), sqlNodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 106              } else {                                                                                              </span>
<span class="-562388873889266871" onmouseenter="enter('-562388873889266871');" onmouseout="out('-562388873889266871');" style=""> 107                  // child query                                                                                    </span>
<span class="-2358139277705514143" onmouseenter="enter('-2358139277705514143');" onmouseout="out('-2358139277705514143');" style=""><abbr title=" 108                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), null));"> 108                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), null))ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109              }                                                                                                     </span>
<span class="-7673228552561235105" onmouseenter="enter('-7673228552561235105');" onmouseout="out('-7673228552561235105');" style=""> 110          } else if (leftJoin.getKind() == JOIN) {                                                                  </span>
<span class="-3633036192623665744" onmouseenter="enter('-3633036192623665744');" onmouseout="out('-3633036192623665744');" style=""> 111              parseLeftNodeTableName(((SqlJoin) leftJoin).getLeft(), aliasAndRealTabName, sideTableSet);            </span>
<span class="7552580298604746031" onmouseenter="enter('7552580298604746031');" onmouseout="out('7552580298604746031');" style=""> 112              parseLeftNodeTableName(((SqlJoin) leftJoin).getRight(), aliasAndRealTabName, sideTableSet);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114      }                                                                                                             </span>
<span  style=""> 115                                                                                                                    </span>
<span class="-1209813794856912353" onmouseenter="enter('-1209813794856912353');" onmouseout="out('-1209813794856912353');" style=""><abbr title=" 116      public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 116      public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, String, StringðŸ”µ</abbr></span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title=" 117          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {"> 117          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2)ðŸ”µ</abbr></span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 118              SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                                    </span>
<span class="-7266522834447768289" onmouseenter="enter('-7266522834447768289');" onmouseout="out('-7266522834447768289');" style=""> 119              Arrays.stream(operands).forEach(op -&gt; replaceJoinConditionTabName(op, mappingTable, tabAlias));       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 120          } else {                                                                                                  </span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 121              SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                                    </span>
<span class="-6080469922932827331" onmouseenter="enter('-6080469922932827331');" onmouseout="out('-6080469922932827331');" style=""> 122              for (int i = 0; i &lt; operands.length; i++) {                                                           </span>
<span class="2646557500991236375" onmouseenter="enter('2646557500991236375');" onmouseout="out('2646557500991236375');" style=""> 123                  SqlNode sqlNode = operands[i];                                                                    </span>
<span class="-1392891079909266942" onmouseenter="enter('-1392891079909266942');" onmouseout="out('-1392891079909266942');" style=""> 124                  SqlNode replaceNode = replaceNodeInfo(sqlNode, mappingTable, tabAlias);                           </span>
<span class="-6691505626486939275" onmouseenter="enter('-6691505626486939275');" onmouseout="out('-6691505626486939275');" style=""> 125                  operands[i] = replaceNode;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127          }                                                                                                         </span>
<span class="-8940717730733442812" onmouseenter="enter('-8940717730733442812');" onmouseout="out('-8940717730733442812');" style=""> 128          return conditionNode;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129      }                                                                                                             </span>
<span  style=""> 130                                                                                                                    </span>
<span class="1058141930756888295" onmouseenter="enter('1058141930756888295');" onmouseout="out('1058141930756888295');" style=""><abbr title=" 131      public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 131      public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappingTable, ðŸ”µ</abbr></span>
<span class="4686929255097782287" onmouseenter="enter('4686929255097782287');" onmouseout="out('4686929255097782287');" style=""> 132          if (parseNode.getKind() == IDENTIFIER) {                                                                  </span>
<span class="-7456553899637280302" onmouseenter="enter('-7456553899637280302');" onmouseout="out('-7456553899637280302');" style=""> 133              SqlIdentifier sqlIdentifier = (SqlIdentifier) parseNode;                                              </span>
<span  style=""> 134                                                                                                                    </span>
<span  style=""> 135                                                                                                                    </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style=""> 136              return sqlIdentifier;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137          }                                                                                                         </span>
<span class="122290553065118475" onmouseenter="enter('122290553065118475');" onmouseout="out('122290553065118475');" style=""> 138          return parseNode;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139      }                                                                                                             </span>
<span  style=""> 140                                                                                                                    </span>
<span class="626206119569915815" onmouseenter="enter('626206119569915815');" onmouseout="out('626206119569915815');" style=""><abbr title=" 141      public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, String[] fieldNames, String tableAlias) {"> 141      public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, String[] fieldðŸ”µ</abbr></span>
<span class="-3471330630840227009" onmouseenter="enter('-3471330630840227009');" onmouseout="out('-3471330630840227009');" style=""> 142          Arrays.asList(fieldNames).forEach(fieldName -&gt; {                                                          </span>
<span class="-7416205975638868401" onmouseenter="enter('-7416205975638868401');" onmouseout="out('-7416205975638868401');" style=""> 143              String mappingTableName = dealDuplicateFieldName(midTableMapping, fieldName);                         </span>
<span class="3363087492913779829" onmouseenter="enter('3363087492913779829');" onmouseout="out('3363087492913779829');" style=""> 144              midTableMapping.put(tableAlias, fieldName, mappingTableName);                                         </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 145          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146      }                                                                                                             </span>
<span  style=""> 147                                                                                                                    </span>
<span class="2815826266140221064" onmouseenter="enter('2815826266140221064');" onmouseout="out('2815826266140221064');" style=""><abbr title=" 148      public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, String fieldName) {"> 148      public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, String fieldNðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 149          String mappingFieldName = fieldName;                                                                      </span>
<span class="7424479410662112456" onmouseenter="enter('7424479410662112456');" onmouseout="out('7424479410662112456');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -        int index = 0;                                                                                            </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +        int index = 1;                                                                                            </span>
<span class="-5569680917805777016" onmouseenter="enter('-5569680917805777016');" onmouseout="out('-5569680917805777016');" style=""> 152          while (!mappingTable.column(mappingFieldName).isEmpty()) {                                                </span>
<span class="-3583037894463034536" onmouseenter="enter('-3583037894463034536');" onmouseout="out('-3583037894463034536');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -            mappingFieldName = mappingFieldName + index;                                                          </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +            mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                             </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 155              index++;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156          }                                                                                                         </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 157          return mappingFieldName;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158      }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +                                                                                                                  </span>
<span class="4071999149795017902" onmouseenter="enter('4071999149795017902');" onmouseout="out('4071999149795017902');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +    public static String dealDuplicateFieldName(HashBiMap&lt;String, String&gt; refFieldMap, String fieldName) {        </span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +        String mappingFieldName = fieldName;                                                                      </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +        int index = 1;                                                                                            </span>
<span class="7964221408726640438" onmouseenter="enter('7964221408726640438');" onmouseout="out('7964221408726640438');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +        while (refFieldMap.inverse().get(mappingFieldName) != null ) {                                            </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +            mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                             </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +            index++;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +                                                                                                                  </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +        return mappingFieldName;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +                                                                                                                  </span>
<span class="1346113709067717957" onmouseenter="enter('1346113709067717957');" onmouseout="out('1346113709067717957');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 171 +    public static String dealDuplicateFieldName(Map&lt;String, String&gt; refFieldMap, String fieldName) {              </span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +        String mappingFieldName = fieldName;                                                                      </span>
<span class="-1720742682728154508" onmouseenter="enter('-1720742682728154508');" onmouseout="out('-1720742682728154508');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 173 +        int index = 1;                                                                                            </span>
<span class="6879974033114480599" onmouseenter="enter('6879974033114480599');" onmouseout="out('6879974033114480599');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +        while (refFieldMap.containsKey(mappingFieldName)){                                                        </span>
<span class="-8781560679476852456" onmouseenter="enter('-8781560679476852456');" onmouseout="out('-8781560679476852456');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +            mappingFieldName = suffixWithChar(fieldName, &#x27;0&#x27;, index);                                             </span>
<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +            index++;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 178 +                                                                                                                  </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 179 +        return mappingFieldName;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 180 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 181 +                                                                                                                  </span>
<span class="6380836709912317411" onmouseenter="enter('6380836709912317411');" onmouseout="out('6380836709912317411');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +    public static String suffixWithChar(String str, char padChar, int repeat){                                    </span>
<span class="-8241727008197568941" onmouseenter="enter('-8241727008197568941');" onmouseout="out('-8241727008197568941');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +        StringBuilder stringBuilder = new StringBuilder(str);                                                     </span>
<span class="-1977172212247055708" onmouseenter="enter('-1977172212247055708');" onmouseout="out('-1977172212247055708');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 184 +        for(int i=0; i&lt;repeat; i++){                                                                              </span>
<span class="1578383770707062340" onmouseenter="enter('1578383770707062340');" onmouseout="out('1578383770707062340');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +            stringBuilder.append(padChar);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 186 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 187 +                                                                                                                  </span>
<span class="2110628210250377389" onmouseenter="enter('2110628210250377389');" onmouseout="out('2110628210250377389');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 188 +        return stringBuilder.toString();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 189 +    }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">  19  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">  20   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">  21   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">  22   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">  23   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">  24   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">  25   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">  26   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  27   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  28   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  29   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  30   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  31   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  32   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  33   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  34   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  35   */                                                                                                               </span>
<span  style="">  36                                                                                                                    </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  37  package com.dtstack.flink.sql.util;                                                                               </span>
<span  style="">  38                                                                                                                    </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  39  import com.google.common.collect.HashBasedTable;                                                                  </span>

<span class="5169042772451251702" onmouseenter="enter('5169042772451251702');" onmouseout="out('5169042772451251702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import org.apache.calcite.sql.*;                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +                                                                                                                  </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  43 +import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  47  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  48  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span  style="">  49                                                                                                                    </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  50  import java.util.Arrays;                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  51  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import java.util.Map;                                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  53  import java.util.Set;                                                                                             </span>

<span  style="">  54                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span class="-1580562890124813833" onmouseenter="enter('-1580562890124813833');" onmouseout="out('-1580562890124813833');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +import static org.apache.calcite.sql.SqlKind.AS;                                                                  </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                          </span>
<span class="-1728920721125829339" onmouseenter="enter('-1728920721125829339');" onmouseout="out('-1728920721125829339');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +import static org.apache.calcite.sql.SqlKind.JOIN;                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                                                                                                                  </span>
<span  style="">  60                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  61  /**                                                                                                               </span>
<span class="-5495386940022079489" onmouseenter="enter('-5495386940022079489');" onmouseout="out('-5495386940022079489');" style="">  62   * @Auther: jiangjunjie                                                                                           </span>
<span class="-5787409337524476693" onmouseenter="enter('-5787409337524476693');" onmouseout="out('-5787409337524476693');" style="">  63   * @Date: 2019-06-30 14:57                                                                                        </span>
<span class="-5284392641623597580" onmouseenter="enter('-5284392641623597580');" onmouseout="out('-5284392641623597580');" style="">  64   * @Description:                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  65   */                                                                                                               </span>
<span class="-1866530984685416906" onmouseenter="enter('-1866530984685416906');" onmouseout="out('-1866530984685416906');" style="">  66  public class ParseUtils {                                                                                         </span>
<span class="8890655695211200116" onmouseenter="enter('8890655695211200116');" onmouseout="out('8890655695211200116');" style="">  67      public static void parseAnd(SqlNode conditionNode, List&lt;SqlNode&gt; sqlNodeList) {                               </span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title="  68          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {">  68          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2)ðŸ”µ</abbr></span>
<span class="1148725245245949994" onmouseenter="enter('1148725245245949994');" onmouseout="out('1148725245245949994');" style="">  69              parseAnd(((SqlBasicCall) conditionNode).getOperands()[0], sqlNodeList);                               </span>
<span class="-3813321520044694485" onmouseenter="enter('-3813321520044694485');" onmouseout="out('-3813321520044694485');" style="">  70              sqlNodeList.add(((SqlBasicCall) conditionNode).getOperands()[1]);                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  71          } else {                                                                                                  </span>
<span class="6614631290047043163" onmouseenter="enter('6614631290047043163');" onmouseout="out('6614631290047043163');" style="">  72              sqlNodeList.add(conditionNode);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  73          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74      }                                                                                                             </span>
<span  style="">  75                                                                                                                    </span>
<span class="-1060545560500196395" onmouseenter="enter('-1060545560500196395');" onmouseout="out('-1060545560500196395');" style="">  76      public static void parseJoinCompareOperate(SqlNode condition, List&lt;String&gt; sqlJoinCompareOperate) {           </span>
<span class="-2746361559719659334" onmouseenter="enter('-2746361559719659334');" onmouseout="out('-2746361559719659334');" style="">  77          SqlBasicCall joinCondition = (SqlBasicCall) condition;                                                    </span>
<span class="6074868054083144054" onmouseenter="enter('6074868054083144054');" onmouseout="out('6074868054083144054');" style="">  78          if (joinCondition.getKind() == SqlKind.AND) {                                                             </span>
<span class="-4754031241214130165" onmouseenter="enter('-4754031241214130165');" onmouseout="out('-4754031241214130165');" style="">  79              List&lt;SqlNode&gt; operandList = joinCondition.getOperandList();                                           </span>
<span class="5346589125395085803" onmouseenter="enter('5346589125395085803');" onmouseout="out('5346589125395085803');" style="">  80              for (SqlNode sqlNode : operandList) {                                                                 </span>
<span class="-2292733210455866502" onmouseenter="enter('-2292733210455866502');" onmouseout="out('-2292733210455866502');" style="">  81                  parseJoinCompareOperate(sqlNode, sqlJoinCompareOperate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  83          } else {                                                                                                  </span>
<span class="-1600941433765614522" onmouseenter="enter('-1600941433765614522');" onmouseout="out('-1600941433765614522');" style="">  84              String operator = transformNotEqualsOperator(joinCondition.getKind());                                </span>
<span class="4282383423815043500" onmouseenter="enter('4282383423815043500');" onmouseout="out('4282383423815043500');" style="">  85              sqlJoinCompareOperate.add(operator);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87      }                                                                                                             </span>
<span  style="">  88                                                                                                                    </span>
<span class="1701523092530860818" onmouseenter="enter('1701523092530860818');" onmouseout="out('1701523092530860818');" style="">  89      public static String transformNotEqualsOperator(SqlKind sqlKind) {                                            </span>
<span class="-5519640728565052860" onmouseenter="enter('-5519640728565052860');" onmouseout="out('-5519640728565052860');" style="">  90          if (StringUtils.equalsIgnoreCase(sqlKind.toString(), &quot;NOT_EQUALS&quot;)) {                                     </span>
<span class="-3530763381623721293" onmouseenter="enter('-3530763381623721293');" onmouseout="out('-3530763381623721293');" style="">  91              return &quot;!=&quot;;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92          }                                                                                                         </span>
<span class="4075145857114168205" onmouseenter="enter('4075145857114168205');" onmouseout="out('4075145857114168205');" style="">  93          return sqlKind.sql;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94      }                                                                                                             </span>
<span  style="">  95                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  96      /**                                                                                                           </span>
<span class="-4264902615967480616" onmouseenter="enter('-4264902615967480616');" onmouseout="out('-4264902615967480616');" style="">  97       *  parse multi join table name, child query RealTabName is null                                              </span>
<span class="-5476579727084261436" onmouseenter="enter('-5476579727084261436');" onmouseout="out('-5476579727084261436');" style="">  98       * @param leftJoin                                                                                            </span>
<span class="-2372480317946695008" onmouseenter="enter('-2372480317946695008');" onmouseout="out('-2372480317946695008');" style="">  99       * @param aliasAndRealTabName                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 100       */                                                                                                           </span>
<span class="6979857197640908692" onmouseenter="enter('6979857197640908692');" onmouseout="out('6979857197640908692');" style=""><abbr title=" 101      public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealTabName, Set&lt;String&gt; sideTableSet) {"> 101      public static void parseLeftNodeTableName(SqlNode leftJoin, List&lt;Tuple2&lt;String, String&gt;&gt; aliasAndRealTabName, ðŸ”µ</abbr></span>
<span class="6808100454525620158" onmouseenter="enter('6808100454525620158');" onmouseout="out('6808100454525620158');" style=""> 102          if (leftJoin.getKind() == IDENTIFIER) {                                                                   </span>
<span class="-1751511746861335268" onmouseenter="enter('-1751511746861335268');" onmouseout="out('-1751511746861335268');" style=""> 103              SqlIdentifier sqlIdentifier = (SqlIdentifier) leftJoin;                                               </span>
<span class="3343920246496917235" onmouseenter="enter('3343920246496917235');" onmouseout="out('3343920246496917235');" style=""> 104              if (sqlIdentifier.names.size() == 1 &amp;&amp; !sideTableSet.contains(sqlIdentifier.names.get(0))) {          </span>
<span class="4912958075808673473" onmouseenter="enter('4912958075808673473');" onmouseout="out('4912958075808673473');" style=""> 105                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(sqlIdentifier.names.get(0), sqlIdentifier.names.get(0)));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106              }                                                                                                     </span>
<span class="-1513716574707047223" onmouseenter="enter('-1513716574707047223');" onmouseout="out('-1513716574707047223');" style=""> 107          } else if (leftJoin.getKind() == AS) {                                                                    </span>
<span class="4921062408152466061" onmouseenter="enter('4921062408152466061');" onmouseout="out('4921062408152466061');" style=""> 108              SqlNode sqlNode = ((SqlBasicCall) leftJoin).getOperands()[0];                                         </span>
<span class="-4716376852598925886" onmouseenter="enter('-4716376852598925886');" onmouseout="out('-4716376852598925886');" style=""> 109              if (sideTableSet.contains(sqlNode.toString())) {                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 110                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111              }                                                                                                     </span>
<span class="-8871371884329332565" onmouseenter="enter('-8871371884329332565');" onmouseout="out('-8871371884329332565');" style=""> 112              if (sqlNode.getKind() == IDENTIFIER) {                                                                </span>
<span class="-8670728232596214008" onmouseenter="enter('-8670728232596214008');" onmouseout="out('-8670728232596214008');" style=""><abbr title=" 113                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), sqlNode.toString()));"> 113                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), sqlNodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 114              } else {                                                                                              </span>
<span class="-562388873889266871" onmouseenter="enter('-562388873889266871');" onmouseout="out('-562388873889266871');" style=""> 115                  // child query                                                                                    </span>
<span class="-2358139277705514143" onmouseenter="enter('-2358139277705514143');" onmouseout="out('-2358139277705514143');" style=""><abbr title=" 116                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), null));"> 116                  aliasAndRealTabName.add(new Tuple2&lt;&gt;(((SqlBasicCall) leftJoin).getOperands()[1].toString(), null))ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117              }                                                                                                     </span>
<span class="-7673228552561235105" onmouseenter="enter('-7673228552561235105');" onmouseout="out('-7673228552561235105');" style=""> 118          } else if (leftJoin.getKind() == JOIN) {                                                                  </span>
<span class="-3633036192623665744" onmouseenter="enter('-3633036192623665744');" onmouseout="out('-3633036192623665744');" style=""> 119              parseLeftNodeTableName(((SqlJoin) leftJoin).getLeft(), aliasAndRealTabName, sideTableSet);            </span>
<span class="7552580298604746031" onmouseenter="enter('7552580298604746031');" onmouseout="out('7552580298604746031');" style=""> 120              parseLeftNodeTableName(((SqlJoin) leftJoin).getRight(), aliasAndRealTabName, sideTableSet);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122      }                                                                                                             </span>
<span  style=""> 123                                                                                                                    </span>
<span class="-1209813794856912353" onmouseenter="enter('-1209813794856912353');" onmouseout="out('-1209813794856912353');" style=""><abbr title=" 124      public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 124      public static SqlNode replaceJoinConditionTabName(SqlNode conditionNode, HashBasedTable&lt;String, String, StringðŸ”µ</abbr></span>
<span class="-931096604759418571" onmouseenter="enter('-931096604759418571');" onmouseout="out('-931096604759418571');" style=""><abbr title=" 125          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2) {"> 125          if (conditionNode.getKind() == SqlKind.AND &amp;&amp; ((SqlBasicCall) conditionNode).getOperandList().size() == 2)ðŸ”µ</abbr></span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 126              SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                                    </span>
<span class="-7266522834447768289" onmouseenter="enter('-7266522834447768289');" onmouseout="out('-7266522834447768289');" style=""> 127              Arrays.stream(operands).forEach(op -&gt; replaceJoinConditionTabName(op, mappingTable, tabAlias));       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 128          } else {                                                                                                  </span>
<span class="1402560578556561470" onmouseenter="enter('1402560578556561470');" onmouseout="out('1402560578556561470');" style=""> 129              SqlNode[] operands = ((SqlBasicCall) conditionNode).getOperands();                                    </span>
<span class="-6080469922932827331" onmouseenter="enter('-6080469922932827331');" onmouseout="out('-6080469922932827331');" style=""> 130              for (int i = 0; i &lt; operands.length; i++) {                                                           </span>
<span class="2646557500991236375" onmouseenter="enter('2646557500991236375');" onmouseout="out('2646557500991236375');" style=""> 131                  SqlNode sqlNode = operands[i];                                                                    </span>
<span class="-1392891079909266942" onmouseenter="enter('-1392891079909266942');" onmouseout="out('-1392891079909266942');" style=""> 132                  SqlNode replaceNode = replaceNodeInfo(sqlNode, mappingTable, tabAlias);                           </span>
<span class="-6691505626486939275" onmouseenter="enter('-6691505626486939275');" onmouseout="out('-6691505626486939275');" style=""> 133                  operands[i] = replaceNode;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135          }                                                                                                         </span>
<span class="-8940717730733442812" onmouseenter="enter('-8940717730733442812');" onmouseout="out('-8940717730733442812');" style=""> 136          return conditionNode;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137      }                                                                                                             </span>
<span  style=""> 138                                                                                                                    </span>
<span class="1058141930756888295" onmouseenter="enter('1058141930756888295');" onmouseout="out('1058141930756888295');" style=""><abbr title=" 139      public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappingTable, String tabAlias) {"> 139      public static SqlNode replaceNodeInfo(SqlNode parseNode, HashBasedTable&lt;String, String, String&gt; mappingTable, ðŸ”µ</abbr></span>
<span class="4686929255097782287" onmouseenter="enter('4686929255097782287');" onmouseout="out('4686929255097782287');" style=""> 140          if (parseNode.getKind() == IDENTIFIER) {                                                                  </span>
<span class="-7456553899637280302" onmouseenter="enter('-7456553899637280302');" onmouseout="out('-7456553899637280302');" style=""> 141              SqlIdentifier sqlIdentifier = (SqlIdentifier) parseNode;                                              </span>
<span  style=""> 142                                                                                                                    </span>
<span  style=""> 143                                                                                                                    </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style=""> 144              return sqlIdentifier;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145          }                                                                                                         </span>
<span class="122290553065118475" onmouseenter="enter('122290553065118475');" onmouseout="out('122290553065118475');" style=""> 146          return parseNode;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147      }                                                                                                             </span>
<span  style=""> 148                                                                                                                    </span>
<span class="626206119569915815" onmouseenter="enter('626206119569915815');" onmouseout="out('626206119569915815');" style=""><abbr title=" 149      public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, String[] fieldNames, String tableAlias) {"> 149      public static void fillFieldNameMapping(HashBasedTable&lt;String, String, String&gt; midTableMapping, String[] fieldðŸ”µ</abbr></span>
<span class="-3471330630840227009" onmouseenter="enter('-3471330630840227009');" onmouseout="out('-3471330630840227009');" style=""> 150          Arrays.asList(fieldNames).forEach(fieldName -&gt; {                                                          </span>
<span class="-7416205975638868401" onmouseenter="enter('-7416205975638868401');" onmouseout="out('-7416205975638868401');" style=""> 151              String mappingTableName = dealDuplicateFieldName(midTableMapping, fieldName);                         </span>
<span class="3363087492913779829" onmouseenter="enter('3363087492913779829');" onmouseout="out('3363087492913779829');" style=""> 152              midTableMapping.put(tableAlias, fieldName, mappingTableName);                                         </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 153          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154      }                                                                                                             </span>
<span  style=""> 155                                                                                                                    </span>
<span class="2815826266140221064" onmouseenter="enter('2815826266140221064');" onmouseout="out('2815826266140221064');" style=""><abbr title=" 156      public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, String fieldName) {"> 156      public static String dealDuplicateFieldName(HashBasedTable&lt;String, String, String&gt; mappingTable, String fieldNðŸ”µ</abbr></span>
<span class="-6420314926751446876" onmouseenter="enter('-6420314926751446876');" onmouseout="out('-6420314926751446876');" style=""> 157          String mappingFieldName = fieldName;                                                                      </span>
<span class="7424479410662112456" onmouseenter="enter('7424479410662112456');" onmouseout="out('7424479410662112456');" style=""> 158          int index = 0;                                                                                            </span>

<span class="-5569680917805777016" onmouseenter="enter('-5569680917805777016');" onmouseout="out('-5569680917805777016');" style=""> 159          while (!mappingTable.column(mappingFieldName).isEmpty()) {                                                </span>
<span class="-3583037894463034536" onmouseenter="enter('-3583037894463034536');" onmouseout="out('-3583037894463034536');" style=""> 160              mappingFieldName = mappingFieldName + index;                                                          </span>

<span class="8743575581853771534" onmouseenter="enter('8743575581853771534');" onmouseout="out('8743575581853771534');" style=""> 161              index++;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162          }                                                                                                         </span>
<span class="-4200432239489773068" onmouseenter="enter('-4200432239489773068');" onmouseout="out('-4200432239489773068');" style=""> 163          return mappingFieldName;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164      }                                                                                                             </span>































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            