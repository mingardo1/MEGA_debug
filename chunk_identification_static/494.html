<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>494</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    494
                    <a href="493.html">prev</a>
                    <a href="495.html">next</a>
                    <a href="494_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_658a6401f4f487101aa34499ee28925ef80ffac3_oracle/oracle-sink/src/main/java/com/dtstack/flink/sql/sink/oracle/OracleSink.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;658a6401f4f487101aa34499ee28925ef80ffac3:oracle/oracle-sink/src/main/java/com/dtstack/flink/sql/sink/oracle/OracleSink.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;658a6401f4f487101aa34499ee28925ef80ffac3^1:oracle/oracle-sink/src/main/java/com/dtstack/flink/sql/sink/oracle/OracleSink.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;658a6401f4f487101aa34499ee28925ef80ffac3^2:oracle/oracle-sink/src/main/java/com/dtstack/flink/sql/sink/oracle/OracleSink.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;0e612c38ef73e0fe86c07e0b47c41fb3ae2d0f0b:oracle/oracle-sink/src/main/java/com/dtstack/flink/sql/sink/oracle/OracleSink.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [j]], subset: [[b], [b], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">   1 /**                                                                                                      </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">   9  * &lt;p&gt;                                                                                                   </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="">  10  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">  11  * &lt;p&gt;                                                                                                   </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-2253359631429602227" onmouseenter="enter('-2253359631429602227');" onmouseout="out('-2253359631429602227');" style="">  18 package com.dtstack.flink.sql.sink.oracle;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="4803045475512582181" onmouseenter="enter('4803045475512582181');" onmouseout="out('4803045475512582181');" style="">  20 import com.dtstack.flink.sql.sink.IStreamSinkGener;                                                      </span>
<span class="-1939464442458751974" onmouseenter="enter('-1939464442458751974');" onmouseout="out('-1939464442458751974');" style="">  21 import com.dtstack.flink.sql.sink.rdb.JDBCOptions;                                                       </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="">  22 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  23 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-5442145780383345859" onmouseenter="enter('-5442145780383345859');" onmouseout="out('-5442145780383345859');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24 import com.dtstack.flink.sql.sink.rdb.format.JDBCUpsertOutputFormat;                                     </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  25 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-7401794377783277488" onmouseenter="enter('-7401794377783277488');" onmouseout="out('-7401794377783277488');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import com.dtstack.flink.sql.sink.rdb.format.ExtendOutputFormat;                                         </span>
<span class="-3668756496717035038" onmouseenter="enter('-3668756496717035038');" onmouseout="out('-3668756496717035038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import com.dtstack.flink.sql.sink.rdb.format.RetractJDBCOutputFormat;                                    </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import com.dtstack.flink.sql.util.DtStringUtil;                                                          </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import com.google.common.collect.Lists;                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import java.util.ArrayList;                                                                              </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import java.util.Iterator;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import java.util.Map;                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38  * Reason:                                                                                               </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  39 =======                                                                                                  </span>
<span class="-7401794377783277488" onmouseenter="enter('-7401794377783277488');" onmouseout="out('-7401794377783277488');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  40 import com.dtstack.flink.sql.sink.rdb.format.ExtendOutputFormat;                                         </span>
<span class="-3668756496717035038" onmouseenter="enter('-3668756496717035038');" onmouseout="out('-3668756496717035038');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  41 import com.dtstack.flink.sql.sink.rdb.format.RetractJDBCOutputFormat;                                    </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  42 import com.dtstack.flink.sql.table.TableInfo;                                                            </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  43 import com.dtstack.flink.sql.util.DtStringUtil;                                                          </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  44 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  45 import com.google.common.collect.Lists;                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  46                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  47 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  48 import java.util.Arrays;                                                                                 </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  49 import java.util.Iterator;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  50 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  51 import java.util.Map;                                                                                    </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  52 import java.util.stream.Collectors;                                                                      </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  53 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  54                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  56  * Reason:                                                                                               </span>
<span class="-7160430037745834680" onmouseenter="enter('-7160430037745834680');" onmouseout="out('-7160430037745834680');" style="">  57  * Date: 2018/11/27                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  58  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  59  *                                                                                                       </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  60  * @author maqi                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61  */                                                                                                      </span>
<span class="2611011457150738077" onmouseenter="enter('2611011457150738077');" onmouseout="out('2611011457150738077');" style="">  62 public class OracleSink extends RdbSink implements IStreamSinkGener&lt;RdbSink&gt; {                           </span>
<span  style="">  63                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  64 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-398713087459741601" onmouseenter="enter('-398713087459741601');" onmouseout="out('-398713087459741601');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  65     public OracleSink() {                                                                                </span>
<span class="7770783172935343952" onmouseenter="enter('7770783172935343952');" onmouseout="out('7770783172935343952');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  66         super(new OracleDialect());                                                                      </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  67 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68  * Reason:                                                                                               </span>
<span class="-7160430037745834680" onmouseenter="enter('-7160430037745834680');" onmouseout="out('-7160430037745834680');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69  * Date: 2018/11/27                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71  *                                                                                                       </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72  * @author maqi                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73  */                                                                                                      </span>
<span class="2611011457150738077" onmouseenter="enter('2611011457150738077');" onmouseout="out('2611011457150738077');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74 public class OracleSink extends RdbSink implements IStreamSinkGener&lt;RdbSink&gt; {                           </span>
<span class="861987037276076228" onmouseenter="enter('861987037276076228');" onmouseout="out('861987037276076228');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75     private static final String ORACLE_DRIVER = &quot;oracle.jdbc.driver.OracleDriver&quot;;                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77     @Override                                                                                            </span>
<span class="-6285937779854901319" onmouseenter="enter('-6285937779854901319');" onmouseout="out('-6285937779854901319');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78     public String getDriverName() {                                                                      </span>
<span class="-777861104070616824" onmouseenter="enter('-777861104070616824');" onmouseout="out('-777861104070616824');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79         return ORACLE_DRIVER;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82     @Override                                                                                            </span>
<span class="4592416120083530810" onmouseenter="enter('4592416120083530810');" onmouseout="out('4592416120083530810');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83     public RetractJDBCOutputFormat getOutputFormat() {                                                   </span>
<span class="-6159588922513713824" onmouseenter="enter('-6159588922513713824');" onmouseout="out('-6159588922513713824');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84         return new ExtendOutputFormat();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  87 =======                                                                                                  </span>
<span class="-1529170609948698125" onmouseenter="enter('-1529170609948698125');" onmouseout="out('-1529170609948698125');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  88     private final String SQL_DEFAULT_PLACEHOLDER = &quot; ? &quot;;                                                </span>
<span class="7352343122951932120" onmouseenter="enter('7352343122951932120');" onmouseout="out('7352343122951932120');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  89     private final String DEAL_CHAR_KEY = &quot;char&quot;;                                                         </span>
<span class="8886052743601418284" onmouseenter="enter('8886052743601418284');" onmouseout="out('8886052743601418284');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  90     private String RPAD_FORMAT = &quot; rpad(?, %d, &#x27; &#x27;) &quot;;                                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  91                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  92     @Override                                                                                            </span>
<span class="-6285937779854901319" onmouseenter="enter('-6285937779854901319');" onmouseout="out('-6285937779854901319');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  93     public String getDriverName() {                                                                      </span>
<span class="-777861104070616824" onmouseenter="enter('-777861104070616824');" onmouseout="out('-777861104070616824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  94         return ORACLE_DRIVER;                                                                            </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  95 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96     }                                                                                                    </span>
<span  style="">  97                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  98     @Override                                                                                            </span>
<span class="3183352647356165326" onmouseenter="enter('3183352647356165326');" onmouseout="out('3183352647356165326');" style="">  99     public JDBCUpsertOutputFormat getOutputFormat() {                                                    </span>
<span class="-2508721101508451262" onmouseenter="enter('-2508721101508451262');" onmouseout="out('-2508721101508451262');" style=""> 100         JDBCOptions jdbcOptions = JDBCOptions.builder()                                                  </span>
<span class="5323545738466546663" onmouseenter="enter('5323545738466546663');" onmouseout="out('5323545738466546663');" style=""> 101                 .setDBUrl(dbURL)                                                                         </span>
<span class="-7332916600162149171" onmouseenter="enter('-7332916600162149171');" onmouseout="out('-7332916600162149171');" style=""> 102                 .setDialect(jdbcDialect)                                                                 </span>
<span class="-7037630186561348371" onmouseenter="enter('-7037630186561348371');" onmouseout="out('-7037630186561348371');" style=""> 103                 .setUsername(userName)                                                                   </span>
<span class="-2481549878346251880" onmouseenter="enter('-2481549878346251880');" onmouseout="out('-2481549878346251880');" style=""> 104                 .setPassword(password)                                                                   </span>
<span class="4677905518999681494" onmouseenter="enter('4677905518999681494');" onmouseout="out('4677905518999681494');" style=""> 105                 .setTableName(tableName)                                                                 </span>
<span class="3176233490856296822" onmouseenter="enter('3176233490856296822');" onmouseout="out('3176233490856296822');" style=""> 106                 .setSchema(schema)                                                                       </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 107                 .build();                                                                                </span>
<span  style=""> 108                                                                                                          </span>
<span class="7694112001464858989" onmouseenter="enter('7694112001464858989');" onmouseout="out('7694112001464858989');" style=""> 109         return JDBCUpsertOutputFormat.builder()                                                          </span>
<span class="3915100677969557350" onmouseenter="enter('3915100677969557350');" onmouseout="out('3915100677969557350');" style=""> 110                 .setOptions(jdbcOptions)                                                                 </span>
<span class="5317822644183641377" onmouseenter="enter('5317822644183641377');" onmouseout="out('5317822644183641377');" style=""> 111                 .setFieldNames(fieldNames)                                                               </span>
<span class="406509933490516206" onmouseenter="enter('406509933490516206');" onmouseout="out('406509933490516206');" style=""> 112                 .setFlushMaxSize(batchNum)                                                               </span>
<span class="-4643021943327871915" onmouseenter="enter('-4643021943327871915');" onmouseout="out('-4643021943327871915');" style=""> 113                 .setFlushIntervalMills(batchWaitInterval)                                                </span>
<span class="-3304044833850102579" onmouseenter="enter('-3304044833850102579');" onmouseout="out('-3304044833850102579');" style=""> 114                 .setFieldTypes(sqlTypes)                                                                 </span>
<span class="7269083421896541185" onmouseenter="enter('7269083421896541185');" onmouseout="out('7269083421896541185');" style=""> 115                 .setKeyFields(primaryKeys)                                                               </span>
<span class="-3198836865486470520" onmouseenter="enter('-3198836865486470520');" onmouseout="out('-3198836865486470520');" style=""> 116                 .setAllReplace(allReplace)                                                               </span>
<span class="-3780921149933763842" onmouseenter="enter('-3780921149933763842');" onmouseout="out('-3780921149933763842');" style=""> 117                 .setUpdateMode(updateMode)                                                               </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 118                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119     }                                                                                                    </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 120 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 121 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122                                                                                                          </span>
<span class="-8377763913641381740" onmouseenter="enter('-8377763913641381740');" onmouseout="out('-8377763913641381740');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123         tableName = DtStringUtil.getTableFullPath(scheam,tableName);                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124                                                                                                          </span>
<span class="-6386418325773855668" onmouseenter="enter('-6386418325773855668');" onmouseout="out('-6386418325773855668');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125         String sqlTmp = &quot;insert into &quot; + tableName + &quot; (${fields}) values (${placeholder})&quot;;             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126                                                                                                          </span>
<span class="-752846631279319252" onmouseenter="enter('-752846631279319252');" onmouseout="out('-752846631279319252');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127         List&lt;String&gt; adaptFields = Lists.newArrayList();                                                 </span>
<span class="7513612055737243762" onmouseenter="enter('7513612055737243762');" onmouseout="out('7513612055737243762');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128         fields.forEach(field -&gt; adaptFields.add(DtStringUtil.addQuoteForStr(field)));                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129                                                                                                          </span>
<span class="6018290364540433461" onmouseenter="enter('6018290364540433461');" onmouseout="out('6018290364540433461');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130         String fieldsStr = StringUtils.join(adaptFields, &quot;,&quot;);                                           </span>
<span class="7207616802584770505" onmouseenter="enter('7207616802584770505');" onmouseout="out('7207616802584770505');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131         String placeholder = &quot;&quot;;                                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132                                                                                                          </span>
<span class="7441558426822677806" onmouseenter="enter('7441558426822677806');" onmouseout="out('7441558426822677806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133         for (String fieldName : fields) {                                                                </span>
<span class="-839022092547168808" onmouseenter="enter('-839022092547168808');" onmouseout="out('-839022092547168808');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134             placeholder += &quot;,?&quot;;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135         }                                                                                                </span>
<span class="137764301552879118" onmouseenter="enter('137764301552879118');" onmouseout="out('137764301552879118');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136         placeholder = placeholder.replaceFirst(&quot;,&quot;, &quot;&quot;);                                                 </span>
<span class="8602636202257802452" onmouseenter="enter('8602636202257802452');" onmouseout="out('8602636202257802452');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137         sqlTmp = sqlTmp.replace(&quot;${fields}&quot;, fieldsStr).replace(&quot;${placeholder}&quot;, placeholder);          </span>
<span class="-209996468548512928" onmouseenter="enter('-209996468548512928');" onmouseout="out('-209996468548512928');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138         this.sql = sqlTmp;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141     /**                                                                                                  </span>
<span class="5989464972696360028" onmouseenter="enter('5989464972696360028');" onmouseout="out('5989464972696360028');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142      *   use MERGE INTO build oracle replace into sql                                                    </span>
<span class="2657030427749225592" onmouseenter="enter('2657030427749225592');" onmouseout="out('2657030427749225592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143      * @param tableName                                                                                  </span>
<span class="-4355202742850218899" onmouseenter="enter('-4355202742850218899');" onmouseout="out('-4355202742850218899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144      * @param fieldNames   create table contained  column columns                                        </span>
<span class="705647872134606405" onmouseenter="enter('705647872134606405');" onmouseout="out('705647872134606405');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145      * @param realIndexes  &lt;key: indexName, value: index contains columns &gt;                              </span>
<span class="8198574845540233151" onmouseenter="enter('8198574845540233151');" onmouseout="out('8198574845540233151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146      * @param fullField    real columns , query from db                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149     @Override                                                                                            </span>
<span class="-6185259647507913401" onmouseenter="enter('-6185259647507913401');" onmouseout="out('-6185259647507913401');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 150     public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, List&lt;String&gt;&gt; realIndexes, List&lt;String&gt; fullField) {"> 150     public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, LiðŸ”µ</abbr></span>
<span class="7405646242542620498" onmouseenter="enter('7405646242542620498');" onmouseout="out('7405646242542620498');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151         tableName = DtStringUtil.getTableFullPath(scheam, tableName);                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152                                                                                                          </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153         StringBuilder sb = new StringBuilder();                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154                                                                                                          </span>
<span class="2938821612601543702" onmouseenter="enter('2938821612601543702');" onmouseout="out('2938821612601543702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155         sb.append(&quot;MERGE INTO &quot; + tableName + &quot; T1 USING &quot;                                               </span>
<span class="-1182907477885241404" onmouseenter="enter('-1182907477885241404');" onmouseout="out('-1182907477885241404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156                 + &quot;(&quot; + makeValues(fieldNames) + &quot;) T2 ON (&quot;                                             </span>
<span class="-5209122200497205787" onmouseenter="enter('-5209122200497205787');" onmouseout="out('-5209122200497205787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157                 + updateKeySql(realIndexes) + &quot;) &quot;);                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159                                                                                                          </span>
<span class="-2221299233031819531" onmouseenter="enter('-2221299233031819531');" onmouseout="out('-2221299233031819531');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160         String updateSql = getUpdateSql(fieldNames, fullField, &quot;T1&quot;, &quot;T2&quot;, keyColList(realIndexes));     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161                                                                                                          </span>
<span class="6422759429489704925" onmouseenter="enter('6422759429489704925');" onmouseout="out('6422759429489704925');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162         if (StringUtils.isNotEmpty(updateSql)) {                                                         </span>
<span class="6152333201645698109" onmouseenter="enter('6152333201645698109');" onmouseout="out('6152333201645698109');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163             sb.append(&quot; WHEN MATCHED THEN UPDATE SET &quot;);                                                 </span>
<span class="4166851158031797633" onmouseenter="enter('4166851158031797633');" onmouseout="out('4166851158031797633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164             sb.append(updateSql);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166                                                                                                          </span>
<span class="-1965157879900816529" onmouseenter="enter('-1965157879900816529');" onmouseout="out('-1965157879900816529');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167         sb.append(&quot; WHEN NOT MATCHED THEN &quot;                                                              </span>
<span class="9057593788759472328" onmouseenter="enter('9057593788759472328');" onmouseout="out('9057593788759472328');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168                 + &quot;INSERT (&quot; + quoteColumns(fieldNames) + &quot;) VALUES (&quot;                                   </span>
<span class="-7469785771621248975" onmouseenter="enter('-7469785771621248975');" onmouseout="out('-7469785771621248975');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169                 + quoteColumns(fieldNames, &quot;T2&quot;) + &quot;)&quot;);                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170                                                                                                          </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174                                                                                                          </span>
<span class="-4080466173805024278" onmouseenter="enter('-4080466173805024278');" onmouseout="out('-4080466173805024278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175     public String quoteColumns(List&lt;String&gt; column) {                                                    </span>
<span class="-8426110352703718076" onmouseenter="enter('-8426110352703718076');" onmouseout="out('-8426110352703718076');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176         return quoteColumns(column, null);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178                                                                                                          </span>
<span class="4574215083583081979" onmouseenter="enter('4574215083583081979');" onmouseout="out('4574215083583081979');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179     public String quoteColumns(List&lt;String&gt; column, String table) {                                      </span>
<span class="4360281778169176138" onmouseenter="enter('4360281778169176138');" onmouseout="out('4360281778169176138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180         String prefix = StringUtils.isBlank(table) ? &quot;&quot; : DtStringUtil.addQuoteForStr(table) + &quot;.&quot;;      </span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181         List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                           </span>
<span class="4421989271291403617" onmouseenter="enter('4421989271291403617');" onmouseout="out('4421989271291403617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182         for (String col : column) {                                                                      </span>
<span class="-2727674971566545378" onmouseenter="enter('-2727674971566545378');" onmouseout="out('-2727674971566545378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183             list.add(prefix + DtStringUtil.addQuoteForStr(col));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184         }                                                                                                </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185         return StringUtils.join(list, &quot;,&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188     /**                                                                                                  </span>
<span class="-3491939024194433966" onmouseenter="enter('-3491939024194433966');" onmouseout="out('-3491939024194433966');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189      *  extract all distinct index column                                                                </span>
<span class="7646821668124511820" onmouseenter="enter('7646821668124511820');" onmouseout="out('7646821668124511820');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190      * @param realIndexes                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192      */                                                                                                  </span>
<span class="-4733258826364304965" onmouseenter="enter('-4733258826364304965');" onmouseout="out('-4733258826364304965');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193     protected List&lt;String&gt; keyColList(Map&lt;String, List&lt;String&gt;&gt; realIndexes) {                           </span>
<span class="6022924223568239029" onmouseenter="enter('6022924223568239029');" onmouseout="out('6022924223568239029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194         List&lt;String&gt; keyCols = new ArrayList&lt;&gt;();                                                        </span>
<span class="-4323381374115382804" onmouseenter="enter('-4323381374115382804');" onmouseout="out('-4323381374115382804');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195         for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : realIndexes.entrySet()) {                           </span>
<span class="1272286775280672187" onmouseenter="enter('1272286775280672187');" onmouseout="out('1272286775280672187');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196             List&lt;String&gt; list = entry.getValue();                                                        </span>
<span class="-7304126229485894611" onmouseenter="enter('-7304126229485894611');" onmouseout="out('-7304126229485894611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197             for (String col : list) {                                                                    </span>
<span class="-5106301287557609956" onmouseenter="enter('-5106301287557609956');" onmouseout="out('-5106301287557609956');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198                 if (!containsIgnoreCase(keyCols,col)) {                                                  </span>
<span class="-1395190118586303951" onmouseenter="enter('-1395190118586303951');" onmouseout="out('-1395190118586303951');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199                     keyCols.add(col);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202         }                                                                                                </span>
<span class="-1090262708785055191" onmouseenter="enter('-1090262708785055191');" onmouseout="out('-1090262708785055191');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203         return keyCols;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206     /**                                                                                                  </span>
<span class="-1052175730959538235" onmouseenter="enter('-1052175730959538235');" onmouseout="out('-1052175730959538235');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207      *  build update sql , such as UPDATE SET &quot;T1&quot;.A=&quot;T2&quot;.A                                              </span>
<span class="2467740145437264520" onmouseenter="enter('2467740145437264520');" onmouseout="out('2467740145437264520');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208      * @param updateColumn       create table contained  column columns                                  </span>
<span class="505413377481967192" onmouseenter="enter('505413377481967192');" onmouseout="out('505413377481967192');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209      * @param fullColumn   real columns , query from db                                                  </span>
<span class="-1639056716730495582" onmouseenter="enter('-1639056716730495582');" onmouseout="out('-1639056716730495582');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210      * @param leftTable    alias                                                                         </span>
<span class="1568921935413810095" onmouseenter="enter('1568921935413810095');" onmouseout="out('1568921935413810095');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211      * @param rightTable   alias                                                                         </span>
<span class="5552964805890434291" onmouseenter="enter('5552964805890434291');" onmouseout="out('5552964805890434291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212      * @param indexCols   index column                                                                   </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214      */                                                                                                  </span>
<span class="-3131879143125851992" onmouseenter="enter('-3131879143125851992');" onmouseout="out('-3131879143125851992');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 215     public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, String rightTable, List&lt;String&gt; indexCols) {"> 215     public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, StriðŸ”µ</abbr></span>
<span class="5568918734230938748" onmouseenter="enter('5568918734230938748');" onmouseout="out('5568918734230938748');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 216         String prefixLeft = StringUtils.isBlank(leftTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(leftTable) + &quot;.&quot;;"> 216         String prefixLeft = StringUtils.isBlank(leftTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(leftTable) ðŸ”µ</abbr></span>
<span class="6560637626238822188" onmouseenter="enter('6560637626238822188');" onmouseout="out('6560637626238822188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 217         String prefixRight = StringUtils.isBlank(rightTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(rightTable) + &quot;.&quot;;"> 217         String prefixRight = StringUtils.isBlank(rightTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(rightTablðŸ”µ</abbr></span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218         List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                           </span>
<span class="-5703916391868920729" onmouseenter="enter('-5703916391868920729');" onmouseout="out('-5703916391868920729');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219         for (String col : fullColumn) {                                                                  </span>
<span class="-7041229774411553852" onmouseenter="enter('-7041229774411553852');" onmouseout="out('-7041229774411553852');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220             // filter index column                                                                       </span>
<span class="936093506231949478" onmouseenter="enter('936093506231949478');" onmouseout="out('936093506231949478');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221             if (indexCols == null || indexCols.size() == 0 || containsIgnoreCase(indexCols,col)) {       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222                 continue;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223             }                                                                                            </span>
<span class="1420340402197706315" onmouseenter="enter('1420340402197706315');" onmouseout="out('1420340402197706315');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224             if (containsIgnoreCase(updateColumn,col)) {                                                  </span>
<span class="4067190976922901817" onmouseenter="enter('4067190976922901817');" onmouseout="out('4067190976922901817');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 225                 list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtil.addQuoteForStr(col));"> 225                 list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtilðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226             } else {                                                                                     </span>
<span class="6820225821702721566" onmouseenter="enter('6820225821702721566');" onmouseout="out('6820225821702721566');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227                 list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=null&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229         }                                                                                                </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230         return StringUtils.join(list, &quot;,&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234     /**                                                                                                  </span>
<span class="8080177348492659646" onmouseenter="enter('8080177348492659646');" onmouseout="out('8080177348492659646');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235      *  build connect sql by index column, such as    T1.&quot;A&quot;=T2.&quot;A&quot;                                      </span>
<span class="5816800269056281083" onmouseenter="enter('5816800269056281083');" onmouseout="out('5816800269056281083');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236      * @param updateKey                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238      */                                                                                                  </span>
<span class="-4727578639187442469" onmouseenter="enter('-4727578639187442469');" onmouseout="out('-4727578639187442469');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239     public String updateKeySql(Map&lt;String, List&lt;String&gt;&gt; updateKey) {                                    </span>
<span class="-879576992792083731" onmouseenter="enter('-879576992792083731');" onmouseout="out('-879576992792083731');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240         List&lt;String&gt; exprList = new ArrayList&lt;&gt;();                                                       </span>
<span class="7983049359913687449" onmouseenter="enter('7983049359913687449');" onmouseout="out('7983049359913687449');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241         for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : updateKey.entrySet()) {                             </span>
<span class="-5705519554331620080" onmouseenter="enter('-5705519554331620080');" onmouseout="out('-5705519554331620080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242             List&lt;String&gt; colList = new ArrayList&lt;&gt;();                                                    </span>
<span class="-372418316657134656" onmouseenter="enter('-372418316657134656');" onmouseout="out('-372418316657134656');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243             for (String col : entry.getValue()) {                                                        </span>
<span class="-6525921181139286934" onmouseenter="enter('-6525921181139286934');" onmouseout="out('-6525921181139286934');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 244                 colList.add(&quot;T1.&quot; + DtStringUtil.addQuoteForStr(col) + &quot;=T2.&quot; + DtStringUtil.addQuoteForStr(col));"> 244                 colList.add(&quot;T1.&quot; + DtStringUtil.addQuoteForStr(col) + &quot;=T2.&quot; + DtStringUtil.addQuoteForSðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245             }                                                                                            </span>
<span class="-7435413672046533924" onmouseenter="enter('-7435413672046533924');" onmouseout="out('-7435413672046533924');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246             exprList.add(StringUtils.join(colList, &quot; AND &quot;));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247         }                                                                                                </span>
<span class="6352339037656687213" onmouseenter="enter('6352339037656687213');" onmouseout="out('6352339037656687213');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248         return StringUtils.join(exprList, &quot; OR &quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251     /**                                                                                                  </span>
<span class="-5073079208141361803" onmouseenter="enter('-5073079208141361803');" onmouseout="out('-5073079208141361803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252      *   build select sql , such as (SELECT ? &quot;A&quot;,? &quot;B&quot; FROM DUAL)                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253      *                                                                                                   </span>
<span class="2733362584390294511" onmouseenter="enter('2733362584390294511');" onmouseout="out('2733362584390294511');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254      * @param column   destination column                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256      */                                                                                                  </span>
<span class="5856097247233352187" onmouseenter="enter('5856097247233352187');" onmouseout="out('5856097247233352187');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257     public String makeValues(List&lt;String&gt; column) {                                                      </span>
<span class="-2635042055210068208" onmouseenter="enter('-2635042055210068208');" onmouseout="out('-2635042055210068208');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258         StringBuilder sb = new StringBuilder(&quot;SELECT &quot;);                                                 </span>
<span class="3068556352458269270" onmouseenter="enter('3068556352458269270');" onmouseout="out('3068556352458269270');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259         for (int i = 0; i &lt; column.size(); ++i) {                                                        </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260             if (i != 0) {                                                                                </span>
<span class="6725018595534739120" onmouseenter="enter('6725018595534739120');" onmouseout="out('6725018595534739120');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                 sb.append(&quot;,&quot;);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262             }                                                                                            </span>
<span class="-3673811614858718637" onmouseenter="enter('-3673811614858718637');" onmouseout="out('-3673811614858718637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263             sb.append(&quot;? &quot; + DtStringUtil.addQuoteForStr(column.get(i)));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264         }                                                                                                </span>
<span class="8758606174200052329" onmouseenter="enter('8758606174200052329');" onmouseout="out('8758606174200052329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265         sb.append(&quot; FROM DUAL&quot;);                                                                         </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                                                                                                          </span>
<span class="646576776050271477" onmouseenter="enter('646576776050271477');" onmouseout="out('646576776050271477');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269     public boolean containsIgnoreCase(List&lt;String&gt; l, String s) {                                        </span>
<span class="-8953592638041442966" onmouseenter="enter('-8953592638041442966');" onmouseout="out('-8953592638041442966');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270         Iterator&lt;String&gt; it = l.iterator();                                                              </span>
<span class="4048167142311273380" onmouseenter="enter('4048167142311273380');" onmouseout="out('4048167142311273380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271         while (it.hasNext()) {                                                                           </span>
<span class="8240971832826416161" onmouseenter="enter('8240971832826416161');" onmouseout="out('8240971832826416161');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272             if (it.next().equalsIgnoreCase(s))                                                           </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 281 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 282                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 283     @Override                                                                                            </span>
<span class="6837493756783400173" onmouseenter="enter('6837493756783400173');" onmouseout="out('6837493756783400173');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284     public void buildSql(String scheam, String tableName, List&lt;String&gt; fields) {                         </span>
<span class="-8333377776642109462" onmouseenter="enter('-8333377776642109462');" onmouseout="out('-8333377776642109462');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 285         buildInsertSql(scheam, tableName, fields);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 286     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 287                                                                                                          </span>
<span class="-6165312922508865881" onmouseenter="enter('-6165312922508865881');" onmouseout="out('-6165312922508865881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 288     private void buildInsertSql(String scheam, String tableName, List&lt;String&gt; fields) {                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 289                                                                                                          </span>
<span class="-8377763913641381740" onmouseenter="enter('-8377763913641381740');" onmouseout="out('-8377763913641381740');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 290         tableName = DtStringUtil.getTableFullPath(scheam,tableName);                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 291                                                                                                          </span>
<span class="-6386418325773855668" onmouseenter="enter('-6386418325773855668');" onmouseout="out('-6386418325773855668');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292         String sqlTmp = &quot;insert into &quot; + tableName + &quot; (${fields}) values (${placeholder})&quot;;             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293                                                                                                          </span>
<span class="-752846631279319252" onmouseenter="enter('-752846631279319252');" onmouseout="out('-752846631279319252');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 294         List&lt;String&gt; adaptFields = Lists.newArrayList();                                                 </span>
<span class="7513612055737243762" onmouseenter="enter('7513612055737243762');" onmouseout="out('7513612055737243762');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295         fields.forEach(field -&gt; adaptFields.add(DtStringUtil.addQuoteForStr(field)));                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296                                                                                                          </span>
<span class="6018290364540433461" onmouseenter="enter('6018290364540433461');" onmouseout="out('6018290364540433461');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297         String fieldsStr = StringUtils.join(adaptFields, &quot;,&quot;);                                           </span>
<span class="7207616802584770505" onmouseenter="enter('7207616802584770505');" onmouseout="out('7207616802584770505');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298         String placeholder = &quot;&quot;;                                                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 299                                                                                                          </span>
<span class="7441558426822677806" onmouseenter="enter('7441558426822677806');" onmouseout="out('7441558426822677806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 300         for (String fieldName : fields) {                                                                </span>
<span class="-839022092547168808" onmouseenter="enter('-839022092547168808');" onmouseout="out('-839022092547168808');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 301             placeholder += &quot;,?&quot;;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302         }                                                                                                </span>
<span class="137764301552879118" onmouseenter="enter('137764301552879118');" onmouseout="out('137764301552879118');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303         placeholder = placeholder.replaceFirst(&quot;,&quot;, &quot;&quot;);                                                 </span>
<span class="8602636202257802452" onmouseenter="enter('8602636202257802452');" onmouseout="out('8602636202257802452');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304         sqlTmp = sqlTmp.replace(&quot;${fields}&quot;, fieldsStr).replace(&quot;${placeholder}&quot;, placeholder);          </span>
<span class="-209996468548512928" onmouseenter="enter('-209996468548512928');" onmouseout="out('-209996468548512928');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305         this.sql = sqlTmp;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 308     /**                                                                                                  </span>
<span class="5989464972696360028" onmouseenter="enter('5989464972696360028');" onmouseout="out('5989464972696360028');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 309      *   use MERGE INTO build oracle replace into sql                                                    </span>
<span class="2657030427749225592" onmouseenter="enter('2657030427749225592');" onmouseout="out('2657030427749225592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 310      * @param tableName                                                                                  </span>
<span class="-4355202742850218899" onmouseenter="enter('-4355202742850218899');" onmouseout="out('-4355202742850218899');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 311      * @param fieldNames   create table contained  column columns                                        </span>
<span class="705647872134606405" onmouseenter="enter('705647872134606405');" onmouseout="out('705647872134606405');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312      * @param realIndexes  &lt;key: indexName, value: index contains columns &gt;                              </span>
<span class="8198574845540233151" onmouseenter="enter('8198574845540233151');" onmouseout="out('8198574845540233151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 313      * @param fullField    real columns , query from db                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 314      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 316     @Override                                                                                            </span>
<span class="-6185259647507913401" onmouseenter="enter('-6185259647507913401');" onmouseout="out('-6185259647507913401');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 317     public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, List&lt;String&gt;&gt; realIndexes, List&lt;String&gt; fullField) {"> 317     public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, LiðŸ”µ</abbr></span>
<span class="7405646242542620498" onmouseenter="enter('7405646242542620498');" onmouseout="out('7405646242542620498');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318         tableName = DtStringUtil.getTableFullPath(scheam, tableName);                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319                                                                                                          </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320         StringBuilder sb = new StringBuilder();                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321                                                                                                          </span>
<span class="2938821612601543702" onmouseenter="enter('2938821612601543702');" onmouseout="out('2938821612601543702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322         sb.append(&quot;MERGE INTO &quot; + tableName + &quot; T1 USING &quot;                                               </span>
<span class="-1182907477885241404" onmouseenter="enter('-1182907477885241404');" onmouseout="out('-1182907477885241404');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323                 + &quot;(&quot; + makeValues(fieldNames) + &quot;) T2 ON (&quot;                                             </span>
<span class="-5209122200497205787" onmouseenter="enter('-5209122200497205787');" onmouseout="out('-5209122200497205787');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 324                 + updateKeySql(realIndexes) + &quot;) &quot;);                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 325                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 326                                                                                                          </span>
<span class="-2221299233031819531" onmouseenter="enter('-2221299233031819531');" onmouseout="out('-2221299233031819531');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 327         String updateSql = getUpdateSql(fieldNames, fullField, &quot;T1&quot;, &quot;T2&quot;, keyColList(realIndexes));     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 328                                                                                                          </span>
<span class="6422759429489704925" onmouseenter="enter('6422759429489704925');" onmouseout="out('6422759429489704925');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 329         if (StringUtils.isNotEmpty(updateSql)) {                                                         </span>
<span class="6152333201645698109" onmouseenter="enter('6152333201645698109');" onmouseout="out('6152333201645698109');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 330             sb.append(&quot; WHEN MATCHED THEN UPDATE SET &quot;);                                                 </span>
<span class="4166851158031797633" onmouseenter="enter('4166851158031797633');" onmouseout="out('4166851158031797633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331             sb.append(updateSql);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 332         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333                                                                                                          </span>
<span class="-1965157879900816529" onmouseenter="enter('-1965157879900816529');" onmouseout="out('-1965157879900816529');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 334         sb.append(&quot; WHEN NOT MATCHED THEN &quot;                                                              </span>
<span class="9057593788759472328" onmouseenter="enter('9057593788759472328');" onmouseout="out('9057593788759472328');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 335                 + &quot;INSERT (&quot; + quoteColumns(fieldNames) + &quot;) VALUES (&quot;                                   </span>
<span class="-7469785771621248975" onmouseenter="enter('-7469785771621248975');" onmouseout="out('-7469785771621248975');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336                 + quoteColumns(fieldNames, &quot;T2&quot;) + &quot;)&quot;);                                                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 337                                                                                                          </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 338         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 339     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 340                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 341                                                                                                          </span>
<span class="-4080466173805024278" onmouseenter="enter('-4080466173805024278');" onmouseout="out('-4080466173805024278');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 342     public String quoteColumns(List&lt;String&gt; column) {                                                    </span>
<span class="-8426110352703718076" onmouseenter="enter('-8426110352703718076');" onmouseout="out('-8426110352703718076');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 343         return quoteColumns(column, null);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 344     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 345                                                                                                          </span>
<span class="4574215083583081979" onmouseenter="enter('4574215083583081979');" onmouseout="out('4574215083583081979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 346     public String quoteColumns(List&lt;String&gt; column, String table) {                                      </span>
<span class="4360281778169176138" onmouseenter="enter('4360281778169176138');" onmouseout="out('4360281778169176138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 347         String prefix = StringUtils.isBlank(table) ? &quot;&quot; : DtStringUtil.addQuoteForStr(table) + &quot;.&quot;;      </span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 348         List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                           </span>
<span class="4421989271291403617" onmouseenter="enter('4421989271291403617');" onmouseout="out('4421989271291403617');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 349         for (String col : column) {                                                                      </span>
<span class="-2727674971566545378" onmouseenter="enter('-2727674971566545378');" onmouseout="out('-2727674971566545378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 350             list.add(prefix + DtStringUtil.addQuoteForStr(col));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 351         }                                                                                                </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 352         return StringUtils.join(list, &quot;,&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 353     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 354                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 355     /**                                                                                                  </span>
<span class="-3491939024194433966" onmouseenter="enter('-3491939024194433966');" onmouseout="out('-3491939024194433966');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 356      *  extract all distinct index column                                                                </span>
<span class="7646821668124511820" onmouseenter="enter('7646821668124511820');" onmouseout="out('7646821668124511820');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 357      * @param realIndexes                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 358      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 359      */                                                                                                  </span>
<span class="-4733258826364304965" onmouseenter="enter('-4733258826364304965');" onmouseout="out('-4733258826364304965');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 360     protected List&lt;String&gt; keyColList(Map&lt;String, List&lt;String&gt;&gt; realIndexes) {                           </span>
<span class="6022924223568239029" onmouseenter="enter('6022924223568239029');" onmouseout="out('6022924223568239029');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 361         List&lt;String&gt; keyCols = new ArrayList&lt;&gt;();                                                        </span>
<span class="-4323381374115382804" onmouseenter="enter('-4323381374115382804');" onmouseout="out('-4323381374115382804');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 362         for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : realIndexes.entrySet()) {                           </span>
<span class="1272286775280672187" onmouseenter="enter('1272286775280672187');" onmouseout="out('1272286775280672187');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 363             List&lt;String&gt; list = entry.getValue();                                                        </span>
<span class="-7304126229485894611" onmouseenter="enter('-7304126229485894611');" onmouseout="out('-7304126229485894611');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 364             for (String col : list) {                                                                    </span>
<span class="-5106301287557609956" onmouseenter="enter('-5106301287557609956');" onmouseout="out('-5106301287557609956');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 365                 if (!containsIgnoreCase(keyCols,col)) {                                                  </span>
<span class="-1395190118586303951" onmouseenter="enter('-1395190118586303951');" onmouseout="out('-1395190118586303951');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 366                     keyCols.add(col);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 367                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 368             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 369         }                                                                                                </span>
<span class="-1090262708785055191" onmouseenter="enter('-1090262708785055191');" onmouseout="out('-1090262708785055191');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370         return keyCols;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 372                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 373     /**                                                                                                  </span>
<span class="-1052175730959538235" onmouseenter="enter('-1052175730959538235');" onmouseout="out('-1052175730959538235');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 374      *  build update sql , such as UPDATE SET &quot;T1&quot;.A=&quot;T2&quot;.A                                              </span>
<span class="2467740145437264520" onmouseenter="enter('2467740145437264520');" onmouseout="out('2467740145437264520');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 375      * @param updateColumn       create table contained  column columns                                  </span>
<span class="505413377481967192" onmouseenter="enter('505413377481967192');" onmouseout="out('505413377481967192');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 376      * @param fullColumn   real columns , query from db                                                  </span>
<span class="-1639056716730495582" onmouseenter="enter('-1639056716730495582');" onmouseout="out('-1639056716730495582');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377      * @param leftTable    alias                                                                         </span>
<span class="1568921935413810095" onmouseenter="enter('1568921935413810095');" onmouseout="out('1568921935413810095');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 378      * @param rightTable   alias                                                                         </span>
<span class="5552964805890434291" onmouseenter="enter('5552964805890434291');" onmouseout="out('5552964805890434291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379      * @param indexCols   index column                                                                   </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 381      */                                                                                                  </span>
<span class="-3131879143125851992" onmouseenter="enter('-3131879143125851992');" onmouseout="out('-3131879143125851992');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 382     public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, String rightTable, List&lt;String&gt; indexCols) {"> 382     public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, StriðŸ”µ</abbr></span>
<span class="5568918734230938748" onmouseenter="enter('5568918734230938748');" onmouseout="out('5568918734230938748');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 383         String prefixLeft = StringUtils.isBlank(leftTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(leftTable) + &quot;.&quot;;"> 383         String prefixLeft = StringUtils.isBlank(leftTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(leftTable) ðŸ”µ</abbr></span>
<span class="6560637626238822188" onmouseenter="enter('6560637626238822188');" onmouseout="out('6560637626238822188');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 384         String prefixRight = StringUtils.isBlank(rightTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(rightTable) + &quot;.&quot;;"> 384         String prefixRight = StringUtils.isBlank(rightTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(rightTablðŸ”µ</abbr></span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 385         List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                           </span>
<span class="-5703916391868920729" onmouseenter="enter('-5703916391868920729');" onmouseout="out('-5703916391868920729');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 386         for (String col : fullColumn) {                                                                  </span>
<span class="-7041229774411553852" onmouseenter="enter('-7041229774411553852');" onmouseout="out('-7041229774411553852');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 387             // filter index column                                                                       </span>
<span class="936093506231949478" onmouseenter="enter('936093506231949478');" onmouseout="out('936093506231949478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 388             if (indexCols == null || indexCols.size() == 0 || containsIgnoreCase(indexCols,col)) {       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 389                 continue;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 390             }                                                                                            </span>
<span class="1420340402197706315" onmouseenter="enter('1420340402197706315');" onmouseout="out('1420340402197706315');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 391             if (containsIgnoreCase(updateColumn,col)) {                                                  </span>
<span class="4067190976922901817" onmouseenter="enter('4067190976922901817');" onmouseout="out('4067190976922901817');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 392                 list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtil.addQuoteForStr(col));"> 392                 list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtilðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 393             } else {                                                                                     </span>
<span class="6820225821702721566" onmouseenter="enter('6820225821702721566');" onmouseout="out('6820225821702721566');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 394                 list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=null&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 395             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396         }                                                                                                </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 397         return StringUtils.join(list, &quot;,&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 398     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 399                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 400                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 401     /**                                                                                                  </span>
<span class="8080177348492659646" onmouseenter="enter('8080177348492659646');" onmouseout="out('8080177348492659646');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 402      *  build connect sql by index column, such as    T1.&quot;A&quot;=T2.&quot;A&quot;                                      </span>
<span class="5816800269056281083" onmouseenter="enter('5816800269056281083');" onmouseout="out('5816800269056281083');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 403      * @param updateKey                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 404      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 405      */                                                                                                  </span>
<span class="-4727578639187442469" onmouseenter="enter('-4727578639187442469');" onmouseout="out('-4727578639187442469');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406     public String updateKeySql(Map&lt;String, List&lt;String&gt;&gt; updateKey) {                                    </span>
<span class="-879576992792083731" onmouseenter="enter('-879576992792083731');" onmouseout="out('-879576992792083731');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 407         List&lt;String&gt; exprList = new ArrayList&lt;&gt;();                                                       </span>
<span class="7983049359913687449" onmouseenter="enter('7983049359913687449');" onmouseout="out('7983049359913687449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 408         for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : updateKey.entrySet()) {                             </span>
<span class="-5705519554331620080" onmouseenter="enter('-5705519554331620080');" onmouseout="out('-5705519554331620080');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 409             List&lt;String&gt; colList = new ArrayList&lt;&gt;();                                                    </span>
<span class="-372418316657134656" onmouseenter="enter('-372418316657134656');" onmouseout="out('-372418316657134656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 410             for (String col : entry.getValue()) {                                                        </span>
<span class="-6525921181139286934" onmouseenter="enter('-6525921181139286934');" onmouseout="out('-6525921181139286934');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 411                 colList.add(&quot;T1.&quot; + DtStringUtil.addQuoteForStr(col) + &quot;=T2.&quot; + DtStringUtil.addQuoteForStr(col));"> 411                 colList.add(&quot;T1.&quot; + DtStringUtil.addQuoteForStr(col) + &quot;=T2.&quot; + DtStringUtil.addQuoteForSðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 412             }                                                                                            </span>
<span class="-7435413672046533924" onmouseenter="enter('-7435413672046533924');" onmouseout="out('-7435413672046533924');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 413             exprList.add(StringUtils.join(colList, &quot; AND &quot;));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 414         }                                                                                                </span>
<span class="6352339037656687213" onmouseenter="enter('6352339037656687213');" onmouseout="out('6352339037656687213');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 415         return StringUtils.join(exprList, &quot; OR &quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 416     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 417                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 418     /**                                                                                                  </span>
<span class="-5073079208141361803" onmouseenter="enter('-5073079208141361803');" onmouseout="out('-5073079208141361803');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 419      *   build select sql , such as (SELECT ? &quot;A&quot;,? &quot;B&quot; FROM DUAL)                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 420      *                                                                                                   </span>
<span class="2733362584390294511" onmouseenter="enter('2733362584390294511');" onmouseout="out('2733362584390294511');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 421      * @param column   destination column                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 422      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 423      */                                                                                                  </span>
<span class="5856097247233352187" onmouseenter="enter('5856097247233352187');" onmouseout="out('5856097247233352187');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 424     public String makeValues(List&lt;String&gt; column) {                                                      </span>
<span class="-2635042055210068208" onmouseenter="enter('-2635042055210068208');" onmouseout="out('-2635042055210068208');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 425         StringBuilder sb = new StringBuilder(&quot;SELECT &quot;);                                                 </span>
<span class="-1380995094886913988" onmouseenter="enter('-1380995094886913988');" onmouseout="out('-1380995094886913988');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 426         String collect = column.stream()                                                                 </span>
<span class="7118252085230150505" onmouseenter="enter('7118252085230150505');" onmouseout="out('7118252085230150505');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 427                 .map(col -&gt; wrapperPlaceholder(col) + DtStringUtil.addQuoteForStr(col))                  </span>
<span class="-209499088310020597" onmouseenter="enter('-209499088310020597');" onmouseout="out('-209499088310020597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 428                 .collect(Collectors.joining(&quot;, &quot;));                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 429                                                                                                          </span>
<span class="4357287995142570467" onmouseenter="enter('4357287995142570467');" onmouseout="out('4357287995142570467');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 430         sb.append(collect).append(&quot; FROM DUAL&quot;);                                                         </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 431         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 432     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 433                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 434     /**                                                                                                  </span>
<span class="8577614299282921891" onmouseenter="enter('8577614299282921891');" onmouseout="out('8577614299282921891');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 435      *  char type is wrapped with rpad                                                                   </span>
<span class="3732359556928566541" onmouseenter="enter('3732359556928566541');" onmouseout="out('3732359556928566541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 436      * @param fieldName                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 437      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 438      */                                                                                                  </span>
<span class="3724662352341080156" onmouseenter="enter('3724662352341080156');" onmouseout="out('3724662352341080156');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 439     public String wrapperPlaceholder(String fieldName) {                                                 </span>
<span class="3089396533136063285" onmouseenter="enter('3089396533136063285');" onmouseout="out('3089396533136063285');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 440         int pos = rdbTableInfo.getFieldList().indexOf(fieldName);                                        </span>
<span class="8178345063195459895" onmouseenter="enter('8178345063195459895');" onmouseout="out('8178345063195459895');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 441         String type = rdbTableInfo.getFieldTypeList().get(pos);                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 442                                                                                                          </span>
<span class="2915795009395395975" onmouseenter="enter('2915795009395395975');" onmouseout="out('2915795009395395975');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 443         if (StringUtils.contains(type.toLowerCase(), DEAL_CHAR_KEY)) {                                   </span>
<span class="-216152585265222403" onmouseenter="enter('-216152585265222403');" onmouseout="out('-216152585265222403');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 444             TableInfo.FieldExtraInfo fieldExtraInfo = rdbTableInfo.getFieldExtraInfoList().get(pos);     </span>
<span class="-8199785686170933034" onmouseenter="enter('-8199785686170933034');" onmouseout="out('-8199785686170933034');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 445             int charLength = fieldExtraInfo == null ? 0 : fieldExtraInfo.getLength();                    </span>
<span class="-1856378201733845477" onmouseenter="enter('-1856378201733845477');" onmouseout="out('-1856378201733845477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 446             if (charLength &gt; 0) {                                                                        </span>
<span class="-1695718684906993049" onmouseenter="enter('-1695718684906993049');" onmouseout="out('-1695718684906993049');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 447                 return String.format(RPAD_FORMAT, charLength);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 448             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 449         }                                                                                                </span>
<span class="1392930129674783043" onmouseenter="enter('1392930129674783043');" onmouseout="out('1392930129674783043');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 450         return SQL_DEFAULT_PLACEHOLDER;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 451     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 452                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 453                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 454                                                                                                          </span>
<span class="646576776050271477" onmouseenter="enter('646576776050271477');" onmouseout="out('646576776050271477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 455     public boolean containsIgnoreCase(List&lt;String&gt; l, String s) {                                        </span>
<span class="-8953592638041442966" onmouseenter="enter('-8953592638041442966');" onmouseout="out('-8953592638041442966');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 456         Iterator&lt;String&gt; it = l.iterator();                                                              </span>
<span class="4048167142311273380" onmouseenter="enter('4048167142311273380');" onmouseout="out('4048167142311273380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 457         while (it.hasNext()) {                                                                           </span>
<span class="8240971832826416161" onmouseenter="enter('8240971832826416161');" onmouseout="out('8240971832826416161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 458             if (it.next().equalsIgnoreCase(s))                                                           </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 459                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 460         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 461         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 462     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 463                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 464                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 465                                                                                                          </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 466 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467 }                                                                                                        </span></pre></td>
                            <td><pre><span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">   1 /**                                                                                                      </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">   9  * &lt;p&gt;                                                                                                   </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="">  10  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">  11  * &lt;p&gt;                                                                                                   </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-2253359631429602227" onmouseenter="enter('-2253359631429602227');" onmouseout="out('-2253359631429602227');" style="">  18 package com.dtstack.flink.sql.sink.oracle;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="4803045475512582181" onmouseenter="enter('4803045475512582181');" onmouseout="out('4803045475512582181');" style="">  20 import com.dtstack.flink.sql.sink.IStreamSinkGener;                                                      </span>
<span class="-1939464442458751974" onmouseenter="enter('-1939464442458751974');" onmouseout="out('-1939464442458751974');" style="">  21 import com.dtstack.flink.sql.sink.rdb.JDBCOptions;                                                       </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="">  22 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="-5442145780383345859" onmouseenter="enter('-5442145780383345859');" onmouseout="out('-5442145780383345859');" style="">  23 import com.dtstack.flink.sql.sink.rdb.format.JDBCUpsertOutputFormat;                                     </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="">  24 import com.dtstack.flink.sql.table.TableInfo;                                                            </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  25 import java.util.Arrays;                                                                                 </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  26 import java.util.stream.Collectors;                                                                      </span>
<span  style="">  27                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  28 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  29  * Reason:                                                                                               </span>
<span class="-7160430037745834680" onmouseenter="enter('-7160430037745834680');" onmouseout="out('-7160430037745834680');" style="">  30  * Date: 2018/11/27                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  31  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  32  *                                                                                                       </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  33  * @author maqi                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  34  */                                                                                                      </span>
<span class="2611011457150738077" onmouseenter="enter('2611011457150738077');" onmouseout="out('2611011457150738077');" style="">  35 public class OracleSink extends RdbSink implements IStreamSinkGener&lt;RdbSink&gt; {                           </span>
<span  style="">  36                                                                                                          </span>
<span class="-398713087459741601" onmouseenter="enter('-398713087459741601');" onmouseout="out('-398713087459741601');" style="">  37     public OracleSink() {                                                                                </span>
<span class="7770783172935343952" onmouseenter="enter('7770783172935343952');" onmouseout="out('7770783172935343952');" style="">  38         super(new OracleDialect());                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  39     }                                                                                                    </span>
<span  style="">  40                                                                                                          </span>
<span class="-1529170609948698125" onmouseenter="enter('-1529170609948698125');" onmouseout="out('-1529170609948698125');" style="">  41     private final String SQL_DEFAULT_PLACEHOLDER = &quot; ? &quot;;                                                </span>
<span class="7352343122951932120" onmouseenter="enter('7352343122951932120');" onmouseout="out('7352343122951932120');" style="">  42     private final String DEAL_CHAR_KEY = &quot;char&quot;;                                                         </span>
<span class="8886052743601418284" onmouseenter="enter('8886052743601418284');" onmouseout="out('8886052743601418284');" style="">  43     private String RPAD_FORMAT = &quot; rpad(?, %d, &#x27; &#x27;) &quot;;                                                   </span>
<span  style="">  44                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  45     @Override                                                                                            </span>
<span class="3183352647356165326" onmouseenter="enter('3183352647356165326');" onmouseout="out('3183352647356165326');" style="">  46     public JDBCUpsertOutputFormat getOutputFormat() {                                                    </span>
<span class="-2508721101508451262" onmouseenter="enter('-2508721101508451262');" onmouseout="out('-2508721101508451262');" style="">  47         JDBCOptions jdbcOptions = JDBCOptions.builder()                                                  </span>
<span class="5323545738466546663" onmouseenter="enter('5323545738466546663');" onmouseout="out('5323545738466546663');" style="">  48                 .setDBUrl(dbURL)                                                                         </span>
<span class="-7332916600162149171" onmouseenter="enter('-7332916600162149171');" onmouseout="out('-7332916600162149171');" style="">  49                 .setDialect(jdbcDialect)                                                                 </span>
<span class="-7037630186561348371" onmouseenter="enter('-7037630186561348371');" onmouseout="out('-7037630186561348371');" style="">  50                 .setUsername(userName)                                                                   </span>
<span class="-2481549878346251880" onmouseenter="enter('-2481549878346251880');" onmouseout="out('-2481549878346251880');" style="">  51                 .setPassword(password)                                                                   </span>
<span class="4677905518999681494" onmouseenter="enter('4677905518999681494');" onmouseout="out('4677905518999681494');" style="">  52                 .setTableName(tableName)                                                                 </span>
<span class="3176233490856296822" onmouseenter="enter('3176233490856296822');" onmouseout="out('3176233490856296822');" style="">  53                 .setSchema(schema)                                                                       </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style="">  54                 .build();                                                                                </span>
<span  style="">  55                                                                                                          </span>
<span class="7694112001464858989" onmouseenter="enter('7694112001464858989');" onmouseout="out('7694112001464858989');" style="">  56         return JDBCUpsertOutputFormat.builder()                                                          </span>
<span class="3915100677969557350" onmouseenter="enter('3915100677969557350');" onmouseout="out('3915100677969557350');" style="">  57                 .setOptions(jdbcOptions)                                                                 </span>
<span class="5317822644183641377" onmouseenter="enter('5317822644183641377');" onmouseout="out('5317822644183641377');" style="">  58                 .setFieldNames(fieldNames)                                                               </span>
<span class="406509933490516206" onmouseenter="enter('406509933490516206');" onmouseout="out('406509933490516206');" style="">  59                 .setFlushMaxSize(batchNum)                                                               </span>
<span class="-4643021943327871915" onmouseenter="enter('-4643021943327871915');" onmouseout="out('-4643021943327871915');" style="">  60                 .setFlushIntervalMills(batchWaitInterval)                                                </span>
<span class="-3304044833850102579" onmouseenter="enter('-3304044833850102579');" onmouseout="out('-3304044833850102579');" style="">  61                 .setFieldTypes(sqlTypes)                                                                 </span>
<span class="7269083421896541185" onmouseenter="enter('7269083421896541185');" onmouseout="out('7269083421896541185');" style="">  62                 .setKeyFields(primaryKeys)                                                               </span>
<span class="-3198836865486470520" onmouseenter="enter('-3198836865486470520');" onmouseout="out('-3198836865486470520');" style="">  63                 .setAllReplace(allReplace)                                                               </span>
<span class="-3780921149933763842" onmouseenter="enter('-3780921149933763842');" onmouseout="out('-3780921149933763842');" style="">  64                 .setUpdateMode(updateMode)                                                               </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style="">  65                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  66     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  67 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  68 ||||||| BASE                                                                                             </span>
<span class="5856097247233352187" onmouseenter="enter('5856097247233352187');" onmouseout="out('5856097247233352187');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69 public String makeValues(List&lt;String&gt; column) {                                                          </span>
<span class="-2635042055210068208" onmouseenter="enter('-2635042055210068208');" onmouseout="out('-2635042055210068208');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70         StringBuilder sb = new StringBuilder(&quot;SELECT &quot;);                                                 </span>
<span class="3068556352458269270" onmouseenter="enter('3068556352458269270');" onmouseout="out('3068556352458269270');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71         for (int i = 0; i &lt; column.size(); ++i) {                                                        </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72             if (i != 0) {                                                                                </span>
<span class="6725018595534739120" onmouseenter="enter('6725018595534739120');" onmouseout="out('6725018595534739120');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73                 sb.append(&quot;,&quot;);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74             }                                                                                            </span>
<span class="-3673811614858718637" onmouseenter="enter('-3673811614858718637');" onmouseout="out('-3673811614858718637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75             sb.append(&quot;? &quot; + DtStringUtil.addQuoteForStr(column.get(i)));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76         }                                                                                                </span>
<span class="8758606174200052329" onmouseenter="enter('8758606174200052329');" onmouseout="out('8758606174200052329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77         sb.append(&quot; FROM DUAL&quot;);                                                                         </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  80 =======                                                                                                  </span>
<span class="5856097247233352187" onmouseenter="enter('5856097247233352187');" onmouseout="out('5856097247233352187');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  81 public String makeValues(List&lt;String&gt; column) {                                                          </span>
<span class="-2635042055210068208" onmouseenter="enter('-2635042055210068208');" onmouseout="out('-2635042055210068208');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  82         StringBuilder sb = new StringBuilder(&quot;SELECT &quot;);                                                 </span>
<span class="-1380995094886913988" onmouseenter="enter('-1380995094886913988');" onmouseout="out('-1380995094886913988');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  83         String collect = column.stream()                                                                 </span>
<span class="7118252085230150505" onmouseenter="enter('7118252085230150505');" onmouseout="out('7118252085230150505');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  84                 .map(col -&gt; wrapperPlaceholder(col) + DtStringUtil.addQuoteForStr(col))                  </span>
<span class="-209499088310020597" onmouseenter="enter('-209499088310020597');" onmouseout="out('-209499088310020597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  85                 .collect(Collectors.joining(&quot;, &quot;));                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  86                                                                                                          </span>
<span class="4357287995142570467" onmouseenter="enter('4357287995142570467');" onmouseout="out('4357287995142570467');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  87         sb.append(collect).append(&quot; FROM DUAL&quot;);                                                         </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  88         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  89     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  90 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style="">  91                                                                                                          </span>
<span  style="">  92                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  93     /**                                                                                                  </span>
<span class="8577614299282921891" onmouseenter="enter('8577614299282921891');" onmouseout="out('8577614299282921891');" style="">  94      *  char type is wrapped with rpad                                                                   </span>
<span class="3732359556928566541" onmouseenter="enter('3732359556928566541');" onmouseout="out('3732359556928566541');" style="">  95      * @param fieldName                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  96      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  97      */                                                                                                  </span>
<span class="3724662352341080156" onmouseenter="enter('3724662352341080156');" onmouseout="out('3724662352341080156');" style="">  98     public String wrapperPlaceholder(String fieldName) {                                                 </span>
<span class="3089396533136063285" onmouseenter="enter('3089396533136063285');" onmouseout="out('3089396533136063285');" style="">  99         int pos = rdbTableInfo.getFieldList().indexOf(fieldName);                                        </span>
<span class="8178345063195459895" onmouseenter="enter('8178345063195459895');" onmouseout="out('8178345063195459895');" style=""> 100         String type = rdbTableInfo.getFieldTypeList().get(pos);                                          </span>
<span  style=""> 101                                                                                                          </span>
<span class="2915795009395395975" onmouseenter="enter('2915795009395395975');" onmouseout="out('2915795009395395975');" style=""> 102         if (StringUtils.contains(type.toLowerCase(), DEAL_CHAR_KEY)) {                                   </span>
<span class="-216152585265222403" onmouseenter="enter('-216152585265222403');" onmouseout="out('-216152585265222403');" style=""> 103             TableInfo.FieldExtraInfo fieldExtraInfo = rdbTableInfo.getFieldExtraInfoList().get(pos);     </span>
<span class="-8199785686170933034" onmouseenter="enter('-8199785686170933034');" onmouseout="out('-8199785686170933034');" style=""> 104             int charLength = fieldExtraInfo == null ? 0 : fieldExtraInfo.getLength();                    </span>
<span class="-1856378201733845477" onmouseenter="enter('-1856378201733845477');" onmouseout="out('-1856378201733845477');" style=""> 105             if (charLength &gt; 0) {                                                                        </span>
<span class="-1695718684906993049" onmouseenter="enter('-1695718684906993049');" onmouseout="out('-1695718684906993049');" style=""> 106                 return String.format(RPAD_FORMAT, charLength);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108         }                                                                                                </span>
<span class="1392930129674783043" onmouseenter="enter('1392930129674783043');" onmouseout="out('1392930129674783043');" style=""> 109         return SQL_DEFAULT_PLACEHOLDER;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111 }                                                                                                        </span>


































































































































































































































































































































































</pre></td>
                            <td><pre><span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">   1 /**                                                                                                      </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">   9  * &lt;p&gt;                                                                                                   </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="">  10  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">  11  * &lt;p&gt;                                                                                                   </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-2253359631429602227" onmouseenter="enter('-2253359631429602227');" onmouseout="out('-2253359631429602227');" style="">  18 package com.dtstack.flink.sql.sink.oracle;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="4803045475512582181" onmouseenter="enter('4803045475512582181');" onmouseout="out('4803045475512582181');" style="">  20 import com.dtstack.flink.sql.sink.IStreamSinkGener;                                                      </span>
<span class="-1939464442458751974" onmouseenter="enter('-1939464442458751974');" onmouseout="out('-1939464442458751974');" style="">  21 import com.dtstack.flink.sql.sink.rdb.JDBCOptions;                                                       </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="">  22 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="-5442145780383345859" onmouseenter="enter('-5442145780383345859');" onmouseout="out('-5442145780383345859');" style="">  23 import com.dtstack.flink.sql.sink.rdb.format.JDBCUpsertOutputFormat;                                     </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="">  24 import com.dtstack.flink.sql.table.TableInfo;                                                            </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  25 import java.util.Arrays;                                                                                 </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  26 import java.util.stream.Collectors;                                                                      </span>
<span  style="">  27                                                                                                          </span>
<span  style="">  28                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  29 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  30  * Reason:                                                                                               </span>
<span class="-7160430037745834680" onmouseenter="enter('-7160430037745834680');" onmouseout="out('-7160430037745834680');" style="">  31  * Date: 2018/11/27                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  32  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  33  *                                                                                                       </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  34  * @author maqi                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  35  */                                                                                                      </span>
<span class="2611011457150738077" onmouseenter="enter('2611011457150738077');" onmouseout="out('2611011457150738077');" style="">  36 public class OracleSink extends RdbSink implements IStreamSinkGener&lt;RdbSink&gt; {                           </span>
<span class="-398713087459741601" onmouseenter="enter('-398713087459741601');" onmouseout="out('-398713087459741601');" style="">  37     public OracleSink() {                                                                                </span>
<span class="7770783172935343952" onmouseenter="enter('7770783172935343952');" onmouseout="out('7770783172935343952');" style="">  38         super(new OracleDialect());                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  39     }                                                                                                    </span>
<span  style="">  40                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  41     @Override                                                                                            </span>
<span class="3183352647356165326" onmouseenter="enter('3183352647356165326');" onmouseout="out('3183352647356165326');" style="">  42     public JDBCUpsertOutputFormat getOutputFormat() {                                                    </span>
<span class="8622692744038286215" onmouseenter="enter('8622692744038286215');" onmouseout="out('8622692744038286215');" style=""><abbr title="  43         JDBCOptions jdbcOptions = JDBCOptions.builder().setDBUrl(dbURL).setDialect(jdbcDialect).setUsername(userName).setPassword(password).setTableName(tableName).setSchema(schema).build();">  43         JDBCOptions jdbcOptions = JDBCOptions.builder().setDBUrl(dbURL).setDialect(jdbcDialect).setUsernaðŸ”µ</abbr></span>
<span class="-8155153311095509134" onmouseenter="enter('-8155153311095509134');" onmouseout="out('-8155153311095509134');" style=""><abbr title="  44         return JDBCUpsertOutputFormat.builder().setOptions(jdbcOptions).setFieldNames(fieldNames).setFlushMaxSize(batchNum).setFlushIntervalMills(batchWaitInterval).setFieldTypes(sqlTypes).setKeyFields(primaryKeys).setAllReplace(allReplace).setUpdateMode(updateMode).build();">  44         return JDBCUpsertOutputFormat.builder().setOptions(jdbcOptions).setFieldNames(fieldNames).setFlusðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  45     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  46 }                                                                                                        </span>



































































































































































































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">   1  /**                                                                                                               </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">   9   * &lt;p&gt;                                                                                                            </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="">  10   * http://www.apache.org/licenses/LICENSE-2.0                                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">  11   * &lt;p&gt;                                                                                                            </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-2253359631429602227" onmouseenter="enter('-2253359631429602227');" onmouseout="out('-2253359631429602227');" style="">  18  package com.dtstack.flink.sql.sink.oracle;                                                                        </span>
<span  style="">  19                                                                                                                    </span>
<span class="4803045475512582181" onmouseenter="enter('4803045475512582181');" onmouseout="out('4803045475512582181');" style="">  20  import com.dtstack.flink.sql.sink.IStreamSinkGener;                                                               </span>
<span class="-1939464442458751974" onmouseenter="enter('-1939464442458751974');" onmouseout="out('-1939464442458751974');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  21 +import com.dtstack.flink.sql.sink.rdb.JDBCOptions;                                                                </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="">  22  import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                                    </span>
<span class="-7401794377783277488" onmouseenter="enter('-7401794377783277488');" onmouseout="out('-7401794377783277488');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.dtstack.flink.sql.sink.rdb.format.ExtendOutputFormat;                                                  </span>
<span class="-3668756496717035038" onmouseenter="enter('-3668756496717035038');" onmouseout="out('-3668756496717035038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import com.dtstack.flink.sql.sink.rdb.format.RetractJDBCOutputFormat;                                             </span>

<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.dtstack.flink.sql.util.DtStringUtil;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import com.google.common.collect.Lists;                                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -                                                                                                                  </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import java.util.ArrayList;                                                                                       </span>

<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import java.util.Iterator;                                                                                        </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import java.util.Map;                                                                                             </span>
<span class="-5442145780383345859" onmouseenter="enter('-5442145780383345859');" onmouseout="out('-5442145780383345859');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +import com.dtstack.flink.sql.sink.rdb.format.JDBCUpsertOutputFormat;                                              </span>
<span  style="">  34                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  35  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  36   * Reason:                                                                                                        </span>
<span class="-7160430037745834680" onmouseenter="enter('-7160430037745834680');" onmouseout="out('-7160430037745834680');" style="">  37   * Date: 2018/11/27                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  38   * Company: www.dtstack.com                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  39   *                                                                                                                </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  40   * @author maqi                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  41   */                                                                                                               </span>
<span class="2611011457150738077" onmouseenter="enter('2611011457150738077');" onmouseout="out('2611011457150738077');" style="">  42  public class OracleSink extends RdbSink implements IStreamSinkGener&lt;RdbSink&gt; {                                    </span>
<span class="861987037276076228" onmouseenter="enter('861987037276076228');" onmouseout="out('861987037276076228');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -    private static final String ORACLE_DRIVER = &quot;oracle.jdbc.driver.OracleDriver&quot;;                                </span>
<span  style="">  44                                                                                                                    </span>




<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -    @Override                                                                                                     </span>
<span class="-6285937779854901319" onmouseenter="enter('-6285937779854901319');" onmouseout="out('-6285937779854901319');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -    public String getDriverName() {                                                                               </span>
<span class="-777861104070616824" onmouseenter="enter('-777861104070616824');" onmouseout="out('-777861104070616824');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -        return ORACLE_DRIVER;                                                                                     </span>
<span class="-398713087459741601" onmouseenter="enter('-398713087459741601');" onmouseout="out('-398713087459741601');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +    public OracleSink() {                                                                                         </span>
<span class="7770783172935343952" onmouseenter="enter('7770783172935343952');" onmouseout="out('7770783172935343952');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +        super(new OracleDialect());                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  50      }                                                                                                             </span>
<span  style="">  51                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  52      @Override                                                                                                     </span>
<span class="4592416120083530810" onmouseenter="enter('4592416120083530810');" onmouseout="out('4592416120083530810');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -    public RetractJDBCOutputFormat getOutputFormat() {                                                            </span>
<span class="-6159588922513713824" onmouseenter="enter('-6159588922513713824');" onmouseout="out('-6159588922513713824');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -        return new ExtendOutputFormat();                                                                          </span>
<span class="3183352647356165326" onmouseenter="enter('3183352647356165326');" onmouseout="out('3183352647356165326');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +    public JDBCUpsertOutputFormat getOutputFormat() {                                                             </span>
<span class="-2508721101508451262" onmouseenter="enter('-2508721101508451262');" onmouseout="out('-2508721101508451262');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +        JDBCOptions jdbcOptions = JDBCOptions.builder()                                                           </span>
<span class="5323545738466546663" onmouseenter="enter('5323545738466546663');" onmouseout="out('5323545738466546663');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +                .setDBUrl(dbURL)                                                                                  </span>
<span class="-7332916600162149171" onmouseenter="enter('-7332916600162149171');" onmouseout="out('-7332916600162149171');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +                .setDialect(jdbcDialect)                                                                          </span>
<span class="-7037630186561348371" onmouseenter="enter('-7037630186561348371');" onmouseout="out('-7037630186561348371');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                .setUsername(userName)                                                                            </span>
<span class="-2481549878346251880" onmouseenter="enter('-2481549878346251880');" onmouseout="out('-2481549878346251880');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +                .setPassword(password)                                                                            </span>
<span class="4677905518999681494" onmouseenter="enter('4677905518999681494');" onmouseout="out('4677905518999681494');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +                .setTableName(tableName)                                                                          </span>
<span class="3176233490856296822" onmouseenter="enter('3176233490856296822');" onmouseout="out('3176233490856296822');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +                .setSchema(schema)                                                                                </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +                .build();                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +                                                                                                                  </span>
<span class="7694112001464858989" onmouseenter="enter('7694112001464858989');" onmouseout="out('7694112001464858989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +        return JDBCUpsertOutputFormat.builder()                                                                   </span>
<span class="3915100677969557350" onmouseenter="enter('3915100677969557350');" onmouseout="out('3915100677969557350');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +                .setOptions(jdbcOptions)                                                                          </span>
<span class="5317822644183641377" onmouseenter="enter('5317822644183641377');" onmouseout="out('5317822644183641377');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                .setFieldNames(fieldNames)                                                                        </span>
<span class="406509933490516206" onmouseenter="enter('406509933490516206');" onmouseout="out('406509933490516206');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +                .setFlushMaxSize(batchNum)                                                                        </span>
<span class="-4643021943327871915" onmouseenter="enter('-4643021943327871915');" onmouseout="out('-4643021943327871915');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +                .setFlushIntervalMills(batchWaitInterval)                                                         </span>
<span class="-3304044833850102579" onmouseenter="enter('-3304044833850102579');" onmouseout="out('-3304044833850102579');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +                .setFieldTypes(sqlTypes)                                                                          </span>
<span class="7269083421896541185" onmouseenter="enter('7269083421896541185');" onmouseout="out('7269083421896541185');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +                .setKeyFields(primaryKeys)                                                                        </span>
<span class="-3198836865486470520" onmouseenter="enter('-3198836865486470520');" onmouseout="out('-3198836865486470520');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +                .setAllReplace(allReplace)                                                                        </span>
<span class="-3780921149933763842" onmouseenter="enter('-3780921149933763842');" onmouseout="out('-3780921149933763842');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +                .setUpdateMode(updateMode)                                                                        </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +                .build();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75      }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -    @Override                                                                                                     </span>
<span class="6837493756783400173" onmouseenter="enter('6837493756783400173');" onmouseout="out('6837493756783400173');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -    public void buildSql(String scheam, String tableName, List&lt;String&gt; fields) {                                  </span>
<span class="-8333377776642109462" onmouseenter="enter('-8333377776642109462');" onmouseout="out('-8333377776642109462');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -        buildInsertSql(scheam, tableName, fields);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -                                                                                                                  </span>
<span class="-6165312922508865881" onmouseenter="enter('-6165312922508865881');" onmouseout="out('-6165312922508865881');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -    private void buildInsertSql(String scheam, String tableName, List&lt;String&gt; fields) {                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -                                                                                                                  </span>
<span class="-8377763913641381740" onmouseenter="enter('-8377763913641381740');" onmouseout="out('-8377763913641381740');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -        tableName = DtStringUtil.getTableFullPath(scheam,tableName);                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -                                                                                                                  </span>
<span class="-6386418325773855668" onmouseenter="enter('-6386418325773855668');" onmouseout="out('-6386418325773855668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -        String sqlTmp = &quot;insert into &quot; + tableName + &quot; (${fields}) values (${placeholder})&quot;;                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -                                                                                                                  </span>
<span class="-752846631279319252" onmouseenter="enter('-752846631279319252');" onmouseout="out('-752846631279319252');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -        List&lt;String&gt; adaptFields = Lists.newArrayList();                                                          </span>
<span class="7513612055737243762" onmouseenter="enter('7513612055737243762');" onmouseout="out('7513612055737243762');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -        fields.forEach(field -&gt; adaptFields.add(DtStringUtil.addQuoteForStr(field)));                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -                                                                                                                  </span>
<span class="6018290364540433461" onmouseenter="enter('6018290364540433461');" onmouseout="out('6018290364540433461');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -        String fieldsStr = StringUtils.join(adaptFields, &quot;,&quot;);                                                    </span>
<span class="7207616802584770505" onmouseenter="enter('7207616802584770505');" onmouseout="out('7207616802584770505');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -        String placeholder = &quot;&quot;;                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -                                                                                                                  </span>
<span class="7441558426822677806" onmouseenter="enter('7441558426822677806');" onmouseout="out('7441558426822677806');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -        for (String fieldName : fields) {                                                                         </span>
<span class="-839022092547168808" onmouseenter="enter('-839022092547168808');" onmouseout="out('-839022092547168808');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -            placeholder += &quot;,?&quot;;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -        }                                                                                                         </span>
<span class="137764301552879118" onmouseenter="enter('137764301552879118');" onmouseout="out('137764301552879118');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -        placeholder = placeholder.replaceFirst(&quot;,&quot;, &quot;&quot;);                                                          </span>
<span class="8602636202257802452" onmouseenter="enter('8602636202257802452');" onmouseout="out('8602636202257802452');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -        sqlTmp = sqlTmp.replace(&quot;${fields}&quot;, fieldsStr).replace(&quot;${placeholder}&quot;, placeholder);                   </span>
<span class="-209996468548512928" onmouseenter="enter('-209996468548512928');" onmouseout="out('-209996468548512928');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -        this.sql = sqlTmp;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -    /**                                                                                                           </span>
<span class="5989464972696360028" onmouseenter="enter('5989464972696360028');" onmouseout="out('5989464972696360028');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -     *   use MERGE INTO build oracle replace into sql                                                             </span>
<span class="2657030427749225592" onmouseenter="enter('2657030427749225592');" onmouseout="out('2657030427749225592');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -     * @param tableName                                                                                           </span>
<span class="-4355202742850218899" onmouseenter="enter('-4355202742850218899');" onmouseout="out('-4355202742850218899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -     * @param fieldNames   create table contained  column columns                                                 </span>
<span class="705647872134606405" onmouseenter="enter('705647872134606405');" onmouseout="out('705647872134606405');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -     * @param realIndexes  &lt;key: indexName, value: index contains columns &gt;                                       </span>
<span class="8198574845540233151" onmouseenter="enter('8198574845540233151');" onmouseout="out('8198574845540233151');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -     * @param fullField    real columns , query from db                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -     */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -    @Override                                                                                                     </span>
<span class="-6185259647507913401" onmouseenter="enter('-6185259647507913401');" onmouseout="out('-6185259647507913401');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 111 -    public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, List&lt;String&gt;&gt; realIndexes, List&lt;String&gt; fullField) {"> 111 -    public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, List&lt;StringðŸ”µ</abbr></span>
<span class="7405646242542620498" onmouseenter="enter('7405646242542620498');" onmouseout="out('7405646242542620498');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -        tableName = DtStringUtil.getTableFullPath(scheam, tableName);                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -                                                                                                                  </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -        StringBuilder sb = new StringBuilder();                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -                                                                                                                  </span>
<span class="2938821612601543702" onmouseenter="enter('2938821612601543702');" onmouseout="out('2938821612601543702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -        sb.append(&quot;MERGE INTO &quot; + tableName + &quot; T1 USING &quot;                                                        </span>
<span class="-1182907477885241404" onmouseenter="enter('-1182907477885241404');" onmouseout="out('-1182907477885241404');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -                + &quot;(&quot; + makeValues(fieldNames) + &quot;) T2 ON (&quot;                                                      </span>
<span class="-5209122200497205787" onmouseenter="enter('-5209122200497205787');" onmouseout="out('-5209122200497205787');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -                + updateKeySql(realIndexes) + &quot;) &quot;);                                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -                                                                                                                  </span>
<span class="-2221299233031819531" onmouseenter="enter('-2221299233031819531');" onmouseout="out('-2221299233031819531');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -        String updateSql = getUpdateSql(fieldNames, fullField, &quot;T1&quot;, &quot;T2&quot;, keyColList(realIndexes));              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -                                                                                                                  </span>
<span class="6422759429489704925" onmouseenter="enter('6422759429489704925');" onmouseout="out('6422759429489704925');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -        if (StringUtils.isNotEmpty(updateSql)) {                                                                  </span>
<span class="6152333201645698109" onmouseenter="enter('6152333201645698109');" onmouseout="out('6152333201645698109');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -            sb.append(&quot; WHEN MATCHED THEN UPDATE SET &quot;);                                                          </span>
<span class="4166851158031797633" onmouseenter="enter('4166851158031797633');" onmouseout="out('4166851158031797633');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -            sb.append(updateSql);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -                                                                                                                  </span>
<span class="-1965157879900816529" onmouseenter="enter('-1965157879900816529');" onmouseout="out('-1965157879900816529');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -        sb.append(&quot; WHEN NOT MATCHED THEN &quot;                                                                       </span>
<span class="9057593788759472328" onmouseenter="enter('9057593788759472328');" onmouseout="out('9057593788759472328');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -                + &quot;INSERT (&quot; + quoteColumns(fieldNames) + &quot;) VALUES (&quot;                                            </span>
<span class="-7469785771621248975" onmouseenter="enter('-7469785771621248975');" onmouseout="out('-7469785771621248975');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -                + quoteColumns(fieldNames, &quot;T2&quot;) + &quot;)&quot;);                                                          </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -                                                                                                                  </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -                                                                                                                  </span>
<span class="-4080466173805024278" onmouseenter="enter('-4080466173805024278');" onmouseout="out('-4080466173805024278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -    public String quoteColumns(List&lt;String&gt; column) {                                                             </span>
<span class="-8426110352703718076" onmouseenter="enter('-8426110352703718076');" onmouseout="out('-8426110352703718076');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -        return quoteColumns(column, null);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -                                                                                                                  </span>
<span class="4574215083583081979" onmouseenter="enter('4574215083583081979');" onmouseout="out('4574215083583081979');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -    public String quoteColumns(List&lt;String&gt; column, String table) {                                               </span>
<span class="4360281778169176138" onmouseenter="enter('4360281778169176138');" onmouseout="out('4360281778169176138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -        String prefix = StringUtils.isBlank(table) ? &quot;&quot; : DtStringUtil.addQuoteForStr(table) + &quot;.&quot;;               </span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                                    </span>
<span class="4421989271291403617" onmouseenter="enter('4421989271291403617');" onmouseout="out('4421989271291403617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -        for (String col : column) {                                                                               </span>
<span class="-2727674971566545378" onmouseenter="enter('-2727674971566545378');" onmouseout="out('-2727674971566545378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -            list.add(prefix + DtStringUtil.addQuoteForStr(col));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -        }                                                                                                         </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -        return StringUtils.join(list, &quot;,&quot;);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -    /**                                                                                                           </span>
<span class="-3491939024194433966" onmouseenter="enter('-3491939024194433966');" onmouseout="out('-3491939024194433966');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -     *  extract all distinct index column                                                                         </span>
<span class="7646821668124511820" onmouseenter="enter('7646821668124511820');" onmouseout="out('7646821668124511820');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -     * @param realIndexes                                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -     */                                                                                                           </span>
<span class="-4733258826364304965" onmouseenter="enter('-4733258826364304965');" onmouseout="out('-4733258826364304965');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -    protected List&lt;String&gt; keyColList(Map&lt;String, List&lt;String&gt;&gt; realIndexes) {                                    </span>
<span class="6022924223568239029" onmouseenter="enter('6022924223568239029');" onmouseout="out('6022924223568239029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -        List&lt;String&gt; keyCols = new ArrayList&lt;&gt;();                                                                 </span>
<span class="-4323381374115382804" onmouseenter="enter('-4323381374115382804');" onmouseout="out('-4323381374115382804');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -        for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : realIndexes.entrySet()) {                                    </span>
<span class="1272286775280672187" onmouseenter="enter('1272286775280672187');" onmouseout="out('1272286775280672187');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -            List&lt;String&gt; list = entry.getValue();                                                                 </span>
<span class="-7304126229485894611" onmouseenter="enter('-7304126229485894611');" onmouseout="out('-7304126229485894611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -            for (String col : list) {                                                                             </span>
<span class="-5106301287557609956" onmouseenter="enter('-5106301287557609956');" onmouseout="out('-5106301287557609956');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -                if (!containsIgnoreCase(keyCols,col)) {                                                           </span>
<span class="-1395190118586303951" onmouseenter="enter('-1395190118586303951');" onmouseout="out('-1395190118586303951');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -                    keyCols.add(col);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -        }                                                                                                         </span>
<span class="-1090262708785055191" onmouseenter="enter('-1090262708785055191');" onmouseout="out('-1090262708785055191');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -        return keyCols;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -    /**                                                                                                           </span>
<span class="-1052175730959538235" onmouseenter="enter('-1052175730959538235');" onmouseout="out('-1052175730959538235');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -     *  build update sql , such as UPDATE SET &quot;T1&quot;.A=&quot;T2&quot;.A                                                       </span>
<span class="2467740145437264520" onmouseenter="enter('2467740145437264520');" onmouseout="out('2467740145437264520');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -     * @param updateColumn       create table contained  column columns                                           </span>
<span class="505413377481967192" onmouseenter="enter('505413377481967192');" onmouseout="out('505413377481967192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -     * @param fullColumn   real columns , query from db                                                           </span>
<span class="-1639056716730495582" onmouseenter="enter('-1639056716730495582');" onmouseout="out('-1639056716730495582');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -     * @param leftTable    alias                                                                                  </span>
<span class="1568921935413810095" onmouseenter="enter('1568921935413810095');" onmouseout="out('1568921935413810095');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -     * @param rightTable   alias                                                                                  </span>
<span class="5552964805890434291" onmouseenter="enter('5552964805890434291');" onmouseout="out('5552964805890434291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -     * @param indexCols   index column                                                                            </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -     */                                                                                                           </span>
<span class="-3131879143125851992" onmouseenter="enter('-3131879143125851992');" onmouseout="out('-3131879143125851992');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 176 -    public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, String rightTable, List&lt;String&gt; indexCols) {"> 176 -    public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, String rightTðŸ”µ</abbr></span>
<span class="5568918734230938748" onmouseenter="enter('5568918734230938748');" onmouseout="out('5568918734230938748');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -        String prefixLeft = StringUtils.isBlank(leftTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(leftTable) + &quot;.&quot;;   </span>
<span class="6560637626238822188" onmouseenter="enter('6560637626238822188');" onmouseout="out('6560637626238822188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -        String prefixRight = StringUtils.isBlank(rightTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(rightTable) + &quot;.&quot;;</span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -        List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                                    </span>
<span class="-5703916391868920729" onmouseenter="enter('-5703916391868920729');" onmouseout="out('-5703916391868920729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -        for (String col : fullColumn) {                                                                           </span>
<span class="-7041229774411553852" onmouseenter="enter('-7041229774411553852');" onmouseout="out('-7041229774411553852');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -            // filter index column                                                                                </span>
<span class="936093506231949478" onmouseenter="enter('936093506231949478');" onmouseout="out('936093506231949478');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -            if (indexCols == null || indexCols.size() == 0 || containsIgnoreCase(indexCols,col)) {                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                continue;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -            }                                                                                                     </span>
<span class="1420340402197706315" onmouseenter="enter('1420340402197706315');" onmouseout="out('1420340402197706315');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -            if (containsIgnoreCase(updateColumn,col)) {                                                           </span>
<span class="4067190976922901817" onmouseenter="enter('4067190976922901817');" onmouseout="out('4067190976922901817');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 186 -                list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtil.addQuoteForStr(col));"> 186 -                list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtil.addQuoteðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -            } else {                                                                                              </span>
<span class="6820225821702721566" onmouseenter="enter('6820225821702721566');" onmouseout="out('6820225821702721566');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=null&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -        }                                                                                                         </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -        return StringUtils.join(list, &quot;,&quot;);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -    /**                                                                                                           </span>
<span class="8080177348492659646" onmouseenter="enter('8080177348492659646');" onmouseout="out('8080177348492659646');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -     *  build connect sql by index column, such as    T1.&quot;A&quot;=T2.&quot;A&quot;                                               </span>
<span class="5816800269056281083" onmouseenter="enter('5816800269056281083');" onmouseout="out('5816800269056281083');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -     * @param updateKey                                                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -     */                                                                                                           </span>
<span class="-4727578639187442469" onmouseenter="enter('-4727578639187442469');" onmouseout="out('-4727578639187442469');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -    public String updateKeySql(Map&lt;String, List&lt;String&gt;&gt; updateKey) {                                             </span>
<span class="-879576992792083731" onmouseenter="enter('-879576992792083731');" onmouseout="out('-879576992792083731');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -        List&lt;String&gt; exprList = new ArrayList&lt;&gt;();                                                                </span>
<span class="7983049359913687449" onmouseenter="enter('7983049359913687449');" onmouseout="out('7983049359913687449');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -        for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : updateKey.entrySet()) {                                      </span>
<span class="-5705519554331620080" onmouseenter="enter('-5705519554331620080');" onmouseout="out('-5705519554331620080');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -            List&lt;String&gt; colList = new ArrayList&lt;&gt;();                                                             </span>
<span class="-372418316657134656" onmouseenter="enter('-372418316657134656');" onmouseout="out('-372418316657134656');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -            for (String col : entry.getValue()) {                                                                 </span>
<span class="-6525921181139286934" onmouseenter="enter('-6525921181139286934');" onmouseout="out('-6525921181139286934');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                colList.add(&quot;T1.&quot; + DtStringUtil.addQuoteForStr(col) + &quot;=T2.&quot; + DtStringUtil.addQuoteForStr(col));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -            }                                                                                                     </span>
<span class="-7435413672046533924" onmouseenter="enter('-7435413672046533924');" onmouseout="out('-7435413672046533924');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -            exprList.add(StringUtils.join(colList, &quot; AND &quot;));                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -        }                                                                                                         </span>
<span class="6352339037656687213" onmouseenter="enter('6352339037656687213');" onmouseout="out('6352339037656687213');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        return StringUtils.join(exprList, &quot; OR &quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -    /**                                                                                                           </span>
<span class="-5073079208141361803" onmouseenter="enter('-5073079208141361803');" onmouseout="out('-5073079208141361803');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -     *   build select sql , such as (SELECT ? &quot;A&quot;,? &quot;B&quot; FROM DUAL)                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -     *                                                                                                            </span>
<span class="2733362584390294511" onmouseenter="enter('2733362584390294511');" onmouseout="out('2733362584390294511');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -     * @param column   destination column                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -     */                                                                                                           </span>
<span class="5856097247233352187" onmouseenter="enter('5856097247233352187');" onmouseout="out('5856097247233352187');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -    public String makeValues(List&lt;String&gt; column) {                                                               </span>
<span class="-2635042055210068208" onmouseenter="enter('-2635042055210068208');" onmouseout="out('-2635042055210068208');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -        StringBuilder sb = new StringBuilder(&quot;SELECT &quot;);                                                          </span>
<span class="3068556352458269270" onmouseenter="enter('3068556352458269270');" onmouseout="out('3068556352458269270');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -        for (int i = 0; i &lt; column.size(); ++i) {                                                                 </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -            if (i != 0) {                                                                                         </span>
<span class="6725018595534739120" onmouseenter="enter('6725018595534739120');" onmouseout="out('6725018595534739120');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -                sb.append(&quot;,&quot;);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -            }                                                                                                     </span>
<span class="-3673811614858718637" onmouseenter="enter('-3673811614858718637');" onmouseout="out('-3673811614858718637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -            sb.append(&quot;? &quot; + DtStringUtil.addQuoteForStr(column.get(i)));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -        }                                                                                                         </span>
<span class="8758606174200052329" onmouseenter="enter('8758606174200052329');" onmouseout="out('8758606174200052329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -        sb.append(&quot; FROM DUAL&quot;);                                                                                  </span>





<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -    }                                                                                                             </span>





















<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -                                                                                                                  </span>
<span class="646576776050271477" onmouseenter="enter('646576776050271477');" onmouseout="out('646576776050271477');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -    public boolean containsIgnoreCase(List&lt;String&gt; l, String s) {                                                 </span>
<span class="-8953592638041442966" onmouseenter="enter('-8953592638041442966');" onmouseout="out('-8953592638041442966');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -        Iterator&lt;String&gt; it = l.iterator();                                                                       </span>
<span class="4048167142311273380" onmouseenter="enter('4048167142311273380');" onmouseout="out('4048167142311273380');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -        while (it.hasNext()) {                                                                                    </span>
<span class="8240971832826416161" onmouseenter="enter('8240971832826416161');" onmouseout="out('8240971832826416161');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -            if (it.next().equalsIgnoreCase(s))                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 234 -                return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -        }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -        return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">   1  /**                                                                                                               </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">   9   * &lt;p&gt;                                                                                                            </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="">  10   * http://www.apache.org/licenses/LICENSE-2.0                                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="">  11   * &lt;p&gt;                                                                                                            </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-2253359631429602227" onmouseenter="enter('-2253359631429602227');" onmouseout="out('-2253359631429602227');" style="">  18  package com.dtstack.flink.sql.sink.oracle;                                                                        </span>
<span  style="">  19                                                                                                                    </span>
<span class="4803045475512582181" onmouseenter="enter('4803045475512582181');" onmouseout="out('4803045475512582181');" style="">  20  import com.dtstack.flink.sql.sink.IStreamSinkGener;                                                               </span>

<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="">  21  import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                                    </span>
<span class="-7401794377783277488" onmouseenter="enter('-7401794377783277488');" onmouseout="out('-7401794377783277488');" style="">  22  import com.dtstack.flink.sql.sink.rdb.format.ExtendOutputFormat;                                                  </span>
<span class="-3668756496717035038" onmouseenter="enter('-3668756496717035038');" onmouseout="out('-3668756496717035038');" style="">  23  import com.dtstack.flink.sql.sink.rdb.format.RetractJDBCOutputFormat;                                             </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import com.dtstack.flink.sql.table.TableInfo;                                                                     </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="">  25  import com.dtstack.flink.sql.util.DtStringUtil;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  27  import com.google.common.collect.Lists;                                                                           </span>
<span  style="">  28                                                                                                                    </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  29  import java.util.ArrayList;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +import java.util.Arrays;                                                                                          </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="">  31  import java.util.Iterator;                                                                                        </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  32  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  33  import java.util.Map;                                                                                             </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  34 +import java.util.stream.Collectors;                                                                               </span>
<span  style="">  35                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  36  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  37   * Reason:                                                                                                        </span>
<span class="-7160430037745834680" onmouseenter="enter('-7160430037745834680');" onmouseout="out('-7160430037745834680');" style="">  38   * Date: 2018/11/27                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  39   * Company: www.dtstack.com                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  40   *                                                                                                                </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  41   * @author maqi                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  42   */                                                                                                               </span>
<span class="2611011457150738077" onmouseenter="enter('2611011457150738077');" onmouseout="out('2611011457150738077');" style="">  43  public class OracleSink extends RdbSink implements IStreamSinkGener&lt;RdbSink&gt; {                                    </span>
<span class="861987037276076228" onmouseenter="enter('861987037276076228');" onmouseout="out('861987037276076228');" style="">  44      private static final String ORACLE_DRIVER = &quot;oracle.jdbc.driver.OracleDriver&quot;;                                </span>
<span  style="">  45                                                                                                                    </span>
<span class="-1529170609948698125" onmouseenter="enter('-1529170609948698125');" onmouseout="out('-1529170609948698125');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +    private final String SQL_DEFAULT_PLACEHOLDER = &quot; ? &quot;;                                                         </span>
<span class="7352343122951932120" onmouseenter="enter('7352343122951932120');" onmouseout="out('7352343122951932120');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +    private final String DEAL_CHAR_KEY = &quot;char&quot;;                                                                  </span>
<span class="8886052743601418284" onmouseenter="enter('8886052743601418284');" onmouseout="out('8886052743601418284');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +    private String RPAD_FORMAT = &quot; rpad(?, %d, &#x27; &#x27;) &quot;;                                                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  50      @Override                                                                                                     </span>
<span class="-6285937779854901319" onmouseenter="enter('-6285937779854901319');" onmouseout="out('-6285937779854901319');" style="">  51      public String getDriverName() {                                                                               </span>
<span class="-777861104070616824" onmouseenter="enter('-777861104070616824');" onmouseout="out('-777861104070616824');" style="">  52          return ORACLE_DRIVER;                                                                                     </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53      }                                                                                                             </span>
<span  style="">  54                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  55      @Override                                                                                                     </span>
<span class="4592416120083530810" onmouseenter="enter('4592416120083530810');" onmouseout="out('4592416120083530810');" style="">  56      public RetractJDBCOutputFormat getOutputFormat() {                                                            </span>
<span class="-6159588922513713824" onmouseenter="enter('-6159588922513713824');" onmouseout="out('-6159588922513713824');" style="">  57          return new ExtendOutputFormat();                                                                          </span>




















<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58      }                                                                                                             </span>
<span  style="">  59                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  60      @Override                                                                                                     </span>
<span class="6837493756783400173" onmouseenter="enter('6837493756783400173');" onmouseout="out('6837493756783400173');" style="">  61      public void buildSql(String scheam, String tableName, List&lt;String&gt; fields) {                                  </span>
<span class="-8333377776642109462" onmouseenter="enter('-8333377776642109462');" onmouseout="out('-8333377776642109462');" style="">  62          buildInsertSql(scheam, tableName, fields);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  63      }                                                                                                             </span>
<span  style="">  64                                                                                                                    </span>
<span class="-6165312922508865881" onmouseenter="enter('-6165312922508865881');" onmouseout="out('-6165312922508865881');" style="">  65      private void buildInsertSql(String scheam, String tableName, List&lt;String&gt; fields) {                           </span>
<span  style="">  66                                                                                                                    </span>
<span class="-8377763913641381740" onmouseenter="enter('-8377763913641381740');" onmouseout="out('-8377763913641381740');" style="">  67          tableName = DtStringUtil.getTableFullPath(scheam,tableName);                                              </span>
<span  style="">  68                                                                                                                    </span>
<span class="-6386418325773855668" onmouseenter="enter('-6386418325773855668');" onmouseout="out('-6386418325773855668');" style="">  69          String sqlTmp = &quot;insert into &quot; + tableName + &quot; (${fields}) values (${placeholder})&quot;;                      </span>
<span  style="">  70                                                                                                                    </span>
<span class="-752846631279319252" onmouseenter="enter('-752846631279319252');" onmouseout="out('-752846631279319252');" style="">  71          List&lt;String&gt; adaptFields = Lists.newArrayList();                                                          </span>
<span class="7513612055737243762" onmouseenter="enter('7513612055737243762');" onmouseout="out('7513612055737243762');" style="">  72          fields.forEach(field -&gt; adaptFields.add(DtStringUtil.addQuoteForStr(field)));                             </span>
<span  style="">  73                                                                                                                    </span>
<span class="6018290364540433461" onmouseenter="enter('6018290364540433461');" onmouseout="out('6018290364540433461');" style="">  74          String fieldsStr = StringUtils.join(adaptFields, &quot;,&quot;);                                                    </span>
<span class="7207616802584770505" onmouseenter="enter('7207616802584770505');" onmouseout="out('7207616802584770505');" style="">  75          String placeholder = &quot;&quot;;                                                                                  </span>
<span  style="">  76                                                                                                                    </span>
<span class="7441558426822677806" onmouseenter="enter('7441558426822677806');" onmouseout="out('7441558426822677806');" style="">  77          for (String fieldName : fields) {                                                                         </span>
<span class="-839022092547168808" onmouseenter="enter('-839022092547168808');" onmouseout="out('-839022092547168808');" style="">  78              placeholder += &quot;,?&quot;;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79          }                                                                                                         </span>
<span class="137764301552879118" onmouseenter="enter('137764301552879118');" onmouseout="out('137764301552879118');" style="">  80          placeholder = placeholder.replaceFirst(&quot;,&quot;, &quot;&quot;);                                                          </span>
<span class="8602636202257802452" onmouseenter="enter('8602636202257802452');" onmouseout="out('8602636202257802452');" style="">  81          sqlTmp = sqlTmp.replace(&quot;${fields}&quot;, fieldsStr).replace(&quot;${placeholder}&quot;, placeholder);                   </span>
<span class="-209996468548512928" onmouseenter="enter('-209996468548512928');" onmouseout="out('-209996468548512928');" style="">  82          this.sql = sqlTmp;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83      }                                                                                                             </span>
<span  style="">  84                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  85      /**                                                                                                           </span>
<span class="5989464972696360028" onmouseenter="enter('5989464972696360028');" onmouseout="out('5989464972696360028');" style="">  86       *   use MERGE INTO build oracle replace into sql                                                             </span>
<span class="2657030427749225592" onmouseenter="enter('2657030427749225592');" onmouseout="out('2657030427749225592');" style="">  87       * @param tableName                                                                                           </span>
<span class="-4355202742850218899" onmouseenter="enter('-4355202742850218899');" onmouseout="out('-4355202742850218899');" style="">  88       * @param fieldNames   create table contained  column columns                                                 </span>
<span class="705647872134606405" onmouseenter="enter('705647872134606405');" onmouseout="out('705647872134606405');" style="">  89       * @param realIndexes  &lt;key: indexName, value: index contains columns &gt;                                       </span>
<span class="8198574845540233151" onmouseenter="enter('8198574845540233151');" onmouseout="out('8198574845540233151');" style="">  90       * @param fullField    real columns , query from db                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  91       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  92       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  93      @Override                                                                                                     </span>
<span class="-6185259647507913401" onmouseenter="enter('-6185259647507913401');" onmouseout="out('-6185259647507913401');" style=""><abbr title="  94      public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, List&lt;String&gt;&gt; realIndexes, List&lt;String&gt; fullField) {">  94      public String buildUpdateSql(String scheam, String tableName, List&lt;String&gt; fieldNames, Map&lt;String, List&lt;StringðŸ”µ</abbr></span>
<span class="7405646242542620498" onmouseenter="enter('7405646242542620498');" onmouseout="out('7405646242542620498');" style="">  95          tableName = DtStringUtil.getTableFullPath(scheam, tableName);                                             </span>
<span  style="">  96                                                                                                                    </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="">  97          StringBuilder sb = new StringBuilder();                                                                   </span>
<span  style="">  98                                                                                                                    </span>
<span class="2938821612601543702" onmouseenter="enter('2938821612601543702');" onmouseout="out('2938821612601543702');" style="">  99          sb.append(&quot;MERGE INTO &quot; + tableName + &quot; T1 USING &quot;                                                        </span>
<span class="-1182907477885241404" onmouseenter="enter('-1182907477885241404');" onmouseout="out('-1182907477885241404');" style=""> 100                  + &quot;(&quot; + makeValues(fieldNames) + &quot;) T2 ON (&quot;                                                      </span>
<span class="-5209122200497205787" onmouseenter="enter('-5209122200497205787');" onmouseout="out('-5209122200497205787');" style=""> 101                  + updateKeySql(realIndexes) + &quot;) &quot;);                                                              </span>
<span  style=""> 102                                                                                                                    </span>
<span  style=""> 103                                                                                                                    </span>
<span class="-2221299233031819531" onmouseenter="enter('-2221299233031819531');" onmouseout="out('-2221299233031819531');" style=""> 104          String updateSql = getUpdateSql(fieldNames, fullField, &quot;T1&quot;, &quot;T2&quot;, keyColList(realIndexes));              </span>
<span  style=""> 105                                                                                                                    </span>
<span class="6422759429489704925" onmouseenter="enter('6422759429489704925');" onmouseout="out('6422759429489704925');" style=""> 106          if (StringUtils.isNotEmpty(updateSql)) {                                                                  </span>
<span class="6152333201645698109" onmouseenter="enter('6152333201645698109');" onmouseout="out('6152333201645698109');" style=""> 107              sb.append(&quot; WHEN MATCHED THEN UPDATE SET &quot;);                                                          </span>
<span class="4166851158031797633" onmouseenter="enter('4166851158031797633');" onmouseout="out('4166851158031797633');" style=""> 108              sb.append(updateSql);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109          }                                                                                                         </span>
<span  style=""> 110                                                                                                                    </span>
<span class="-1965157879900816529" onmouseenter="enter('-1965157879900816529');" onmouseout="out('-1965157879900816529');" style=""> 111          sb.append(&quot; WHEN NOT MATCHED THEN &quot;                                                                       </span>
<span class="9057593788759472328" onmouseenter="enter('9057593788759472328');" onmouseout="out('9057593788759472328');" style=""> 112                  + &quot;INSERT (&quot; + quoteColumns(fieldNames) + &quot;) VALUES (&quot;                                            </span>
<span class="-7469785771621248975" onmouseenter="enter('-7469785771621248975');" onmouseout="out('-7469785771621248975');" style=""> 113                  + quoteColumns(fieldNames, &quot;T2&quot;) + &quot;)&quot;);                                                          </span>
<span  style=""> 114                                                                                                                    </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 115          return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116      }                                                                                                             </span>
<span  style=""> 117                                                                                                                    </span>
<span  style=""> 118                                                                                                                    </span>
<span class="-4080466173805024278" onmouseenter="enter('-4080466173805024278');" onmouseout="out('-4080466173805024278');" style=""> 119      public String quoteColumns(List&lt;String&gt; column) {                                                             </span>
<span class="-8426110352703718076" onmouseenter="enter('-8426110352703718076');" onmouseout="out('-8426110352703718076');" style=""> 120          return quoteColumns(column, null);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121      }                                                                                                             </span>
<span  style=""> 122                                                                                                                    </span>
<span class="4574215083583081979" onmouseenter="enter('4574215083583081979');" onmouseout="out('4574215083583081979');" style=""> 123      public String quoteColumns(List&lt;String&gt; column, String table) {                                               </span>
<span class="4360281778169176138" onmouseenter="enter('4360281778169176138');" onmouseout="out('4360281778169176138');" style=""> 124          String prefix = StringUtils.isBlank(table) ? &quot;&quot; : DtStringUtil.addQuoteForStr(table) + &quot;.&quot;;               </span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style=""> 125          List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                                    </span>
<span class="4421989271291403617" onmouseenter="enter('4421989271291403617');" onmouseout="out('4421989271291403617');" style=""> 126          for (String col : column) {                                                                               </span>
<span class="-2727674971566545378" onmouseenter="enter('-2727674971566545378');" onmouseout="out('-2727674971566545378');" style=""> 127              list.add(prefix + DtStringUtil.addQuoteForStr(col));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128          }                                                                                                         </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style=""> 129          return StringUtils.join(list, &quot;,&quot;);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130      }                                                                                                             </span>
<span  style=""> 131                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 132      /**                                                                                                           </span>
<span class="-3491939024194433966" onmouseenter="enter('-3491939024194433966');" onmouseout="out('-3491939024194433966');" style=""> 133       *  extract all distinct index column                                                                         </span>
<span class="7646821668124511820" onmouseenter="enter('7646821668124511820');" onmouseout="out('7646821668124511820');" style=""> 134       * @param realIndexes                                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 135       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 136       */                                                                                                           </span>
<span class="-4733258826364304965" onmouseenter="enter('-4733258826364304965');" onmouseout="out('-4733258826364304965');" style=""> 137      protected List&lt;String&gt; keyColList(Map&lt;String, List&lt;String&gt;&gt; realIndexes) {                                    </span>
<span class="6022924223568239029" onmouseenter="enter('6022924223568239029');" onmouseout="out('6022924223568239029');" style=""> 138          List&lt;String&gt; keyCols = new ArrayList&lt;&gt;();                                                                 </span>
<span class="-4323381374115382804" onmouseenter="enter('-4323381374115382804');" onmouseout="out('-4323381374115382804');" style=""> 139          for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : realIndexes.entrySet()) {                                    </span>
<span class="1272286775280672187" onmouseenter="enter('1272286775280672187');" onmouseout="out('1272286775280672187');" style=""> 140              List&lt;String&gt; list = entry.getValue();                                                                 </span>
<span class="-7304126229485894611" onmouseenter="enter('-7304126229485894611');" onmouseout="out('-7304126229485894611');" style=""> 141              for (String col : list) {                                                                             </span>
<span class="-5106301287557609956" onmouseenter="enter('-5106301287557609956');" onmouseout="out('-5106301287557609956');" style=""> 142                  if (!containsIgnoreCase(keyCols,col)) {                                                           </span>
<span class="-1395190118586303951" onmouseenter="enter('-1395190118586303951');" onmouseout="out('-1395190118586303951');" style=""> 143                      keyCols.add(col);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146          }                                                                                                         </span>
<span class="-1090262708785055191" onmouseenter="enter('-1090262708785055191');" onmouseout="out('-1090262708785055191');" style=""> 147          return keyCols;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148      }                                                                                                             </span>
<span  style=""> 149                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 150      /**                                                                                                           </span>
<span class="-1052175730959538235" onmouseenter="enter('-1052175730959538235');" onmouseout="out('-1052175730959538235');" style=""> 151       *  build update sql , such as UPDATE SET &quot;T1&quot;.A=&quot;T2&quot;.A                                                       </span>
<span class="2467740145437264520" onmouseenter="enter('2467740145437264520');" onmouseout="out('2467740145437264520');" style=""> 152       * @param updateColumn       create table contained  column columns                                           </span>
<span class="505413377481967192" onmouseenter="enter('505413377481967192');" onmouseout="out('505413377481967192');" style=""> 153       * @param fullColumn   real columns , query from db                                                           </span>
<span class="-1639056716730495582" onmouseenter="enter('-1639056716730495582');" onmouseout="out('-1639056716730495582');" style=""> 154       * @param leftTable    alias                                                                                  </span>
<span class="1568921935413810095" onmouseenter="enter('1568921935413810095');" onmouseout="out('1568921935413810095');" style=""> 155       * @param rightTable   alias                                                                                  </span>
<span class="5552964805890434291" onmouseenter="enter('5552964805890434291');" onmouseout="out('5552964805890434291');" style=""> 156       * @param indexCols   index column                                                                            </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 157       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 158       */                                                                                                           </span>
<span class="-3131879143125851992" onmouseenter="enter('-3131879143125851992');" onmouseout="out('-3131879143125851992');" style=""><abbr title=" 159      public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, String rightTable, List&lt;String&gt; indexCols) {"> 159      public String getUpdateSql(List&lt;String&gt; updateColumn, List&lt;String&gt; fullColumn, String leftTable, String rightTðŸ”µ</abbr></span>
<span class="5568918734230938748" onmouseenter="enter('5568918734230938748');" onmouseout="out('5568918734230938748');" style=""> 160          String prefixLeft = StringUtils.isBlank(leftTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(leftTable) + &quot;.&quot;;   </span>
<span class="6560637626238822188" onmouseenter="enter('6560637626238822188');" onmouseout="out('6560637626238822188');" style=""> 161          String prefixRight = StringUtils.isBlank(rightTable) ? &quot;&quot; : DtStringUtil.addQuoteForStr(rightTable) + &quot;.&quot;;</span>
<span class="-7196029539789365900" onmouseenter="enter('-7196029539789365900');" onmouseout="out('-7196029539789365900');" style=""> 162          List&lt;String&gt; list = new ArrayList&lt;&gt;();                                                                    </span>
<span class="-5703916391868920729" onmouseenter="enter('-5703916391868920729');" onmouseout="out('-5703916391868920729');" style=""> 163          for (String col : fullColumn) {                                                                           </span>
<span class="-7041229774411553852" onmouseenter="enter('-7041229774411553852');" onmouseout="out('-7041229774411553852');" style=""> 164              // filter index column                                                                                </span>
<span class="936093506231949478" onmouseenter="enter('936093506231949478');" onmouseout="out('936093506231949478');" style=""> 165              if (indexCols == null || indexCols.size() == 0 || containsIgnoreCase(indexCols,col)) {                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 166                  continue;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167              }                                                                                                     </span>
<span class="1420340402197706315" onmouseenter="enter('1420340402197706315');" onmouseout="out('1420340402197706315');" style=""> 168              if (containsIgnoreCase(updateColumn,col)) {                                                           </span>
<span class="4067190976922901817" onmouseenter="enter('4067190976922901817');" onmouseout="out('4067190976922901817');" style=""><abbr title=" 169                  list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtil.addQuoteForStr(col));"> 169                  list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=&quot; + prefixRight + DtStringUtil.addQuoteðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 170              } else {                                                                                              </span>
<span class="6820225821702721566" onmouseenter="enter('6820225821702721566');" onmouseout="out('6820225821702721566');" style=""> 171                  list.add(prefixLeft + DtStringUtil.addQuoteForStr(col) + &quot;=null&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173          }                                                                                                         </span>
<span class="-6404557011257033088" onmouseenter="enter('-6404557011257033088');" onmouseout="out('-6404557011257033088');" style=""> 174          return StringUtils.join(list, &quot;,&quot;);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175      }                                                                                                             </span>
<span  style=""> 176                                                                                                                    </span>
<span  style=""> 177                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 178      /**                                                                                                           </span>
<span class="8080177348492659646" onmouseenter="enter('8080177348492659646');" onmouseout="out('8080177348492659646');" style=""> 179       *  build connect sql by index column, such as    T1.&quot;A&quot;=T2.&quot;A&quot;                                               </span>
<span class="5816800269056281083" onmouseenter="enter('5816800269056281083');" onmouseout="out('5816800269056281083');" style=""> 180       * @param updateKey                                                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 181       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 182       */                                                                                                           </span>
<span class="-4727578639187442469" onmouseenter="enter('-4727578639187442469');" onmouseout="out('-4727578639187442469');" style=""> 183      public String updateKeySql(Map&lt;String, List&lt;String&gt;&gt; updateKey) {                                             </span>
<span class="-879576992792083731" onmouseenter="enter('-879576992792083731');" onmouseout="out('-879576992792083731');" style=""> 184          List&lt;String&gt; exprList = new ArrayList&lt;&gt;();                                                                </span>
<span class="7983049359913687449" onmouseenter="enter('7983049359913687449');" onmouseout="out('7983049359913687449');" style=""> 185          for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : updateKey.entrySet()) {                                      </span>
<span class="-5705519554331620080" onmouseenter="enter('-5705519554331620080');" onmouseout="out('-5705519554331620080');" style=""> 186              List&lt;String&gt; colList = new ArrayList&lt;&gt;();                                                             </span>
<span class="-372418316657134656" onmouseenter="enter('-372418316657134656');" onmouseout="out('-372418316657134656');" style=""> 187              for (String col : entry.getValue()) {                                                                 </span>
<span class="-6525921181139286934" onmouseenter="enter('-6525921181139286934');" onmouseout="out('-6525921181139286934');" style=""> 188                  colList.add(&quot;T1.&quot; + DtStringUtil.addQuoteForStr(col) + &quot;=T2.&quot; + DtStringUtil.addQuoteForStr(col));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189              }                                                                                                     </span>
<span class="-7435413672046533924" onmouseenter="enter('-7435413672046533924');" onmouseout="out('-7435413672046533924');" style=""> 190              exprList.add(StringUtils.join(colList, &quot; AND &quot;));                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191          }                                                                                                         </span>
<span class="6352339037656687213" onmouseenter="enter('6352339037656687213');" onmouseout="out('6352339037656687213');" style=""> 192          return StringUtils.join(exprList, &quot; OR &quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193      }                                                                                                             </span>
<span  style=""> 194                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 195      /**                                                                                                           </span>
<span class="-5073079208141361803" onmouseenter="enter('-5073079208141361803');" onmouseout="out('-5073079208141361803');" style=""> 196       *   build select sql , such as (SELECT ? &quot;A&quot;,? &quot;B&quot; FROM DUAL)                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 197       *                                                                                                            </span>
<span class="2733362584390294511" onmouseenter="enter('2733362584390294511');" onmouseout="out('2733362584390294511');" style=""> 198       * @param column   destination column                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 199       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 200       */                                                                                                           </span>
<span class="5856097247233352187" onmouseenter="enter('5856097247233352187');" onmouseout="out('5856097247233352187');" style=""> 201      public String makeValues(List&lt;String&gt; column) {                                                               </span>
<span class="-2635042055210068208" onmouseenter="enter('-2635042055210068208');" onmouseout="out('-2635042055210068208');" style=""> 202          StringBuilder sb = new StringBuilder(&quot;SELECT &quot;);                                                          </span>
<span class="3068556352458269270" onmouseenter="enter('3068556352458269270');" onmouseout="out('3068556352458269270');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -        for (int i = 0; i &lt; column.size(); ++i) {                                                                 </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -            if (i != 0) {                                                                                         </span>
<span class="6725018595534739120" onmouseenter="enter('6725018595534739120');" onmouseout="out('6725018595534739120');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                sb.append(&quot;,&quot;);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -            }                                                                                                     </span>
<span class="-3673811614858718637" onmouseenter="enter('-3673811614858718637');" onmouseout="out('-3673811614858718637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -            sb.append(&quot;? &quot; + DtStringUtil.addQuoteForStr(column.get(i)));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -        }                                                                                                         </span>
<span class="8758606174200052329" onmouseenter="enter('8758606174200052329');" onmouseout="out('8758606174200052329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        sb.append(&quot; FROM DUAL&quot;);                                                                                  </span>
<span class="-1380995094886913988" onmouseenter="enter('-1380995094886913988');" onmouseout="out('-1380995094886913988');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +        String collect = column.stream()                                                                          </span>
<span class="7118252085230150505" onmouseenter="enter('7118252085230150505');" onmouseout="out('7118252085230150505');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 211 +                .map(col -&gt; wrapperPlaceholder(col) + DtStringUtil.addQuoteForStr(col))                           </span>
<span class="-209499088310020597" onmouseenter="enter('-209499088310020597');" onmouseout="out('-209499088310020597');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +                .collect(Collectors.joining(&quot;, &quot;));                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +                                                                                                                  </span>
<span class="4357287995142570467" onmouseenter="enter('4357287995142570467');" onmouseout="out('4357287995142570467');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +        sb.append(collect).append(&quot; FROM DUAL&quot;);                                                                  </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 215          return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216      }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 218 +    /**                                                                                                           </span>
<span class="8577614299282921891" onmouseenter="enter('8577614299282921891');" onmouseout="out('8577614299282921891');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 219 +     *  char type is wrapped with rpad                                                                            </span>
<span class="3732359556928566541" onmouseenter="enter('3732359556928566541');" onmouseout="out('3732359556928566541');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +     * @param fieldName                                                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +     */                                                                                                           </span>
<span class="3724662352341080156" onmouseenter="enter('3724662352341080156');" onmouseout="out('3724662352341080156');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 223 +    public String wrapperPlaceholder(String fieldName) {                                                          </span>
<span class="3089396533136063285" onmouseenter="enter('3089396533136063285');" onmouseout="out('3089396533136063285');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 224 +        int pos = rdbTableInfo.getFieldList().indexOf(fieldName);                                                 </span>
<span class="8178345063195459895" onmouseenter="enter('8178345063195459895');" onmouseout="out('8178345063195459895');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 225 +        String type = rdbTableInfo.getFieldTypeList().get(pos);                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 226 +                                                                                                                  </span>
<span class="2915795009395395975" onmouseenter="enter('2915795009395395975');" onmouseout="out('2915795009395395975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 227 +        if (StringUtils.contains(type.toLowerCase(), DEAL_CHAR_KEY)) {                                            </span>
<span class="-216152585265222403" onmouseenter="enter('-216152585265222403');" onmouseout="out('-216152585265222403');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 228 +            TableInfo.FieldExtraInfo fieldExtraInfo = rdbTableInfo.getFieldExtraInfoList().get(pos);              </span>
<span class="-8199785686170933034" onmouseenter="enter('-8199785686170933034');" onmouseout="out('-8199785686170933034');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 229 +            int charLength = fieldExtraInfo == null ? 0 : fieldExtraInfo.getLength();                             </span>
<span class="-1856378201733845477" onmouseenter="enter('-1856378201733845477');" onmouseout="out('-1856378201733845477');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 230 +            if (charLength &gt; 0) {                                                                                 </span>
<span class="-1695718684906993049" onmouseenter="enter('-1695718684906993049');" onmouseout="out('-1695718684906993049');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 231 +                return String.format(RPAD_FORMAT, charLength);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 232 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 233 +        }                                                                                                         </span>
<span class="1392930129674783043" onmouseenter="enter('1392930129674783043');" onmouseout="out('1392930129674783043');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 234 +        return SQL_DEFAULT_PLACEHOLDER;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 235 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 236 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 237 +                                                                                                                  </span>
<span  style=""> 238                                                                                                                    </span>
<span class="646576776050271477" onmouseenter="enter('646576776050271477');" onmouseout="out('646576776050271477');" style=""> 239      public boolean containsIgnoreCase(List&lt;String&gt; l, String s) {                                                 </span>
<span class="-8953592638041442966" onmouseenter="enter('-8953592638041442966');" onmouseout="out('-8953592638041442966');" style=""> 240          Iterator&lt;String&gt; it = l.iterator();                                                                       </span>
<span class="4048167142311273380" onmouseenter="enter('4048167142311273380');" onmouseout="out('4048167142311273380');" style=""> 241          while (it.hasNext()) {                                                                                    </span>
<span class="8240971832826416161" onmouseenter="enter('8240971832826416161');" onmouseout="out('8240971832826416161');" style=""> 242              if (it.next().equalsIgnoreCase(s))                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 243                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 245          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span  style=""> 248                                                                                                                    </span>
<span  style=""> 249                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            