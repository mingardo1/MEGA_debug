<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>579</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    579
                    <a href="578.html">prev</a>
                    <a href="580.html">next</a>
                    <a href="579_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Freeyourgadget/Gadgetbridge_6c993d40aae9a15c0568828a164fc74d671c0f24_app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/ExternalPebbleJSActivity.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;6c993d40aae9a15c0568828a164fc74d671c0f24:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/ExternalPebbleJSActivity.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;6c993d40aae9a15c0568828a164fc74d671c0f24^1:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/ExternalPebbleJSActivity.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;6c993d40aae9a15c0568828a164fc74d671c0f24^2:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/ExternalPebbleJSActivity.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;2eb43fa74087ebf9107e470486c3b53b4e5e366d:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/ExternalPebbleJSActivity.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [j]], subset: [[b], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-7393740638519443947" onmouseenter="enter('-7393740638519443947');" onmouseout="out('-7393740638519443947');" style="">   1 package nodomain.freeyourgadget.gadgetbridge.activities;                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="3857212678176399715" onmouseenter="enter('3857212678176399715');" onmouseout="out('3857212678176399715');" style="">   3 import android.Manifest;                                                                                 </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5 import android.content.Intent;                                                                           </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   6 import android.content.pm.PackageManager;                                                                </span>
<span class="907171826859240605" onmouseenter="enter('907171826859240605');" onmouseout="out('907171826859240605');" style="">   7 import android.location.Criteria;                                                                        </span>
<span class="-4559785959657295211" onmouseenter="enter('-4559785959657295211');" onmouseout="out('-4559785959657295211');" style="">   8 import android.location.Location;                                                                        </span>
<span class="8236022111747117642" onmouseenter="enter('8236022111747117642');" onmouseout="out('8236022111747117642');" style="">   9 import android.location.LocationManager;                                                                 </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  10 import android.net.Uri;                                                                                  </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  11 import android.os.Build;                                                                                 </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  12 import android.os.Bundle;                                                                                </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="">  13 import android.support.v4.app.ActivityCompat;                                                            </span>
<span class="6797968843617414504" onmouseenter="enter('6797968843617414504');" onmouseout="out('6797968843617414504');" style="">  14 import android.support.v4.app.NavUtils;                                                                  </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  15 import android.view.MenuItem;                                                                            </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  16 import android.view.View;                                                                                </span>
<span class="-6388096999790135816" onmouseenter="enter('-6388096999790135816');" onmouseout="out('-6388096999790135816');" style="">  17 import android.webkit.JavascriptInterface;                                                               </span>
<span class="-1234144701745247801" onmouseenter="enter('-1234144701745247801');" onmouseout="out('-1234144701745247801');" style="">  18 import android.webkit.ValueCallback;                                                                     </span>
<span class="2723690893492346945" onmouseenter="enter('2723690893492346945');" onmouseout="out('2723690893492346945');" style="">  19 import android.webkit.WebView;                                                                           </span>
<span class="619404646788779253" onmouseenter="enter('619404646788779253');" onmouseout="out('619404646788779253');" style="">  20 import android.widget.FrameLayout;                                                                       </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  21 import android.widget.Toast;                                                                             </span>
<span  style="">  22                                                                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  23 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  24 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  25                                                                                                          </span>
<span class="2390503830490498598" onmouseenter="enter('2390503830490498598');" onmouseout="out('2390503830490498598');" style="">  26 import java.util.UUID;                                                                                   </span>
<span  style="">  27                                                                                                          </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  28 import nodomain.freeyourgadget.gadgetbridge.R;                                                           </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  29 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  30 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  31 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  32 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-425744571032727695" onmouseenter="enter('-425744571032727695');" onmouseout="out('-425744571032727695');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  33 import nodomain.freeyourgadget.gadgetbridge.util.WebViewSingleton;                                       </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  34 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import java.io.IOException;                                                                              </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import java.io.UnsupportedEncodingException;                                                             </span>
<span class="7630846594806589523" onmouseenter="enter('7630846594806589523');" onmouseout="out('7630846594806589523');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import java.io.Writer;                                                                                   </span>
<span class="6381430938828950472" onmouseenter="enter('6381430938828950472');" onmouseout="out('6381430938828950472');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import java.security.MessageDigest;                                                                      </span>
<span class="-1748023591259675388" onmouseenter="enter('-1748023591259675388');" onmouseout="out('-1748023591259675388');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import java.security.NoSuchAlgorithmException;                                                           </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import java.util.Iterator;                                                                               </span>
<span class="-6589962362033146913" onmouseenter="enter('-6589962362033146913');" onmouseout="out('-6589962362033146913');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 import java.util.Scanner;                                                                                </span>
<span class="2390503830490498598" onmouseenter="enter('2390503830490498598');" onmouseout="out('2390503830490498598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 import java.util.UUID;                                                                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43                                                                                                          </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44 import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                               </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import nodomain.freeyourgadget.gadgetbridge.R;                                                           </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="4645284583739884744" onmouseenter="enter('4645284583739884744');" onmouseout="out('4645284583739884744');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50 import nodomain.freeyourgadget.gadgetbridge.util.PebbleUtils;                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51                                                                                                          </span>
<span class="8425816362509139849" onmouseenter="enter('8425816362509139849');" onmouseout="out('8425816362509139849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 public class ExternalPebbleJSActivity extends GBActivity {                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53                                                                                                          </span>
<span class="8136098019960083823" onmouseenter="enter('8136098019960083823');" onmouseout="out('8136098019960083823');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54     private static final Logger LOG = LoggerFactory.getLogger(ExternalPebbleJSActivity.class);           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55                                                                                                          </span>
<span class="3065437899111201345" onmouseenter="enter('3065437899111201345');" onmouseout="out('3065437899111201345');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56     private UUID appUuid;                                                                                </span>
<span class="9027266421678696690" onmouseenter="enter('9027266421678696690');" onmouseout="out('9027266421678696690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57     private Uri confUri;                                                                                 </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  58 =======                                                                                                  </span>
<span class="4645284583739884744" onmouseenter="enter('4645284583739884744');" onmouseout="out('4645284583739884744');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  59 import nodomain.freeyourgadget.gadgetbridge.util.PebbleUtils;                                            </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  60 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  61 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  62                                                                                                          </span>
<span class="8425816362509139849" onmouseenter="enter('8425816362509139849');" onmouseout="out('8425816362509139849');" style="">  63 public class ExternalPebbleJSActivity extends GBActivity {                                               </span>
<span  style="">  64                                                                                                          </span>
<span class="8136098019960083823" onmouseenter="enter('8136098019960083823');" onmouseout="out('8136098019960083823');" style="">  65     private static final Logger LOG = LoggerFactory.getLogger(ExternalPebbleJSActivity.class);           </span>
<span  style="">  66                                                                                                          </span>
<span class="3065437899111201345" onmouseenter="enter('3065437899111201345');" onmouseout="out('3065437899111201345');" style="">  67     private UUID appUuid;                                                                                </span>
<span class="9027266421678696690" onmouseenter="enter('9027266421678696690');" onmouseout="out('9027266421678696690');" style="">  68     private Uri confUri;                                                                                 </span>
<span class="-5535852384441440556" onmouseenter="enter('-5535852384441440556');" onmouseout="out('-5535852384441440556');" style="">  69     private GBDevice mGBDevice = null;                                                                   </span>
<span class="6615780427500382937" onmouseenter="enter('6615780427500382937');" onmouseout="out('6615780427500382937');" style="">  70     private WebView myWebView;                                                                           </span>
<span  style="">  71                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  72     @Override                                                                                            </span>
<span class="6892052666771236398" onmouseenter="enter('6892052666771236398');" onmouseout="out('6892052666771236398');" style="">  73     protected void onCreate(Bundle savedInstanceState) {                                                 </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style="">  74         super.onCreate(savedInstanceState);                                                              </span>
<span  style="">  75                                                                                                          </span>
<span class="-871894361009470891" onmouseenter="enter('-871894361009470891');" onmouseout="out('-871894361009470891');" style="">  76         Bundle extras = getIntent().getExtras();                                                         </span>
<span class="8849338589512660035" onmouseenter="enter('8849338589512660035');" onmouseout="out('8849338589512660035');" style="">  77         if (extras != null) {                                                                            </span>
<span class="3724295817671341281" onmouseenter="enter('3724295817671341281');" onmouseout="out('3724295817671341281');" style="">  78             mGBDevice = extras.getParcelable(GBDevice.EXTRA_DEVICE);                                     </span>
<span class="2716088159317727473" onmouseenter="enter('2716088159317727473');" onmouseout="out('2716088159317727473');" style="">  79             appUuid = (UUID) extras.getSerializable(DeviceService.EXTRA_APP_UUID);                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  80         } else {                                                                                         </span>
<span class="496962713155353134" onmouseenter="enter('496962713155353134');" onmouseout="out('496962713155353134');" style="">  81             throw new IllegalArgumentException(&quot;Must provide a device when invoking this activity&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82         }                                                                                                </span>
<span  style="">  83                                                                                                          </span>
<span class="8370604561035257296" onmouseenter="enter('8370604561035257296');" onmouseout="out('8370604561035257296');" style="">  84         setContentView(R.layout.activity_external_pebble_js);                                            </span>
<span  style="">  85                                                                                                          </span>
<span class="8982719199826339359" onmouseenter="enter('8982719199826339359');" onmouseout="out('8982719199826339359');" style="">  86         myWebView = WebViewSingleton.getorInitWebView(this, mGBDevice, appUuid);                         </span>
<span class="6894061798627554793" onmouseenter="enter('6894061798627554793');" onmouseout="out('6894061798627554793');" style="">  87         myWebView.setWillNotDraw(false);                                                                 </span>
<span class="-8818851797244187743" onmouseenter="enter('-8818851797244187743');" onmouseout="out('-8818851797244187743');" style=""><abbr title="  88         myWebView.addJavascriptInterface(new ActivityJSInterface(ExternalPebbleJSActivity.this), &quot;GBActivity&quot;);">  88         myWebView.addJavascriptInterface(new ActivityJSInterface(ExternalPebbleJSActivity.this), &quot;GBActivðŸ”µ</abbr></span>
<span class="7079593887772041495" onmouseenter="enter('7079593887772041495');" onmouseout="out('7079593887772041495');" style="">  89         FrameLayout fl = (FrameLayout) findViewById(R.id.webview_placeholder);                           </span>
<span class="-4001555273714846720" onmouseenter="enter('-4001555273714846720');" onmouseout="out('-4001555273714846720');" style="">  90         fl.addView(myWebView);                                                                           </span>
<span  style="">  91                                                                                                          </span>
<span  style="">  92                                                                                                          </span>
<span class="5697070782885285202" onmouseenter="enter('5697070782885285202');" onmouseout="out('5697070782885285202');" style="">  93         myWebView.addOnAttachStateChangeListener(new View.OnAttachStateChangeListener() {                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  94             @Override                                                                                    </span>
<span class="-5576845663046859066" onmouseenter="enter('-5576845663046859066');" onmouseout="out('-5576845663046859066');" style="">  95             public void onViewAttachedToWindow(View v) {                                                 </span>
<span  style="">  96                                                                                                          </span>
<span  style="">  97                                                                                                          </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style="">  98                 if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                               </span>
<span class="4771517920709256525" onmouseenter="enter('4771517920709256525');" onmouseout="out('4771517920709256525');" style="">  99                     // chromium, enable hardware acceleration                                            </span>
<span class="-8172250518187697323" onmouseenter="enter('-8172250518187697323');" onmouseout="out('-8172250518187697323');" style=""> 100                     v.setLayerType(View.LAYER_TYPE_HARDWARE, null);                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 101                 } else {                                                                                 </span>
<span class="-1721106037310283892" onmouseenter="enter('-1721106037310283892');" onmouseout="out('-1721106037310283892');" style=""> 102                     // older android version, disable hardware acceleration                              </span>
<span class="1424411202877530232" onmouseenter="enter('1424411202877530232');" onmouseout="out('1424411202877530232');" style=""> 103                     v.setLayerType(View.LAYER_TYPE_SOFTWARE, null);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104                 }                                                                                        </span>
<span  style=""> 105                                                                                                          </span>
<span  style=""> 106                                                                                                          </span>
<span class="-1033981458626162610" onmouseenter="enter('-1033981458626162610');" onmouseout="out('-1033981458626162610');" style=""> 107                 String queryString = &quot;&quot;;                                                                 </span>
<span class="-2276587090849303814" onmouseenter="enter('-2276587090849303814');" onmouseout="out('-2276587090849303814');" style=""> 108                 if (confUri != null) {                                                                   </span>
<span class="-1088791743364895452" onmouseenter="enter('-1088791743364895452');" onmouseout="out('-1088791743364895452');" style=""> 109                     //getting back with configuration data                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 110                     try {                                                                                </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style=""> 111                         appUuid = UUID.fromString(confUri.getHost());                                    </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style=""> 112                         queryString = confUri.getEncodedQuery();                                         </span>
<span class="-1471183022667940231" onmouseenter="enter('-1471183022667940231');" onmouseout="out('-1471183022667940231');" style=""> 113                     } catch (IllegalArgumentException e) {                                               </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style=""> 114                         GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115                     }                                                                                    </span>
<span class="-6006476350816960216" onmouseenter="enter('-6006476350816960216');" onmouseout="out('-6006476350816960216');" style=""><abbr title=" 116                     ((WebView) v).loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);"> 116                     ((WebView) v).loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryStrinðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 117                 } else {                                                                                 </span>
<span class="1099762347578046525" onmouseenter="enter('1099762347578046525');" onmouseout="out('1099762347578046525');" style=""> 118                     //show configuration                                                                 </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style=""> 119                     if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                           </span>
<span class="-7229150094009232298" onmouseenter="enter('-7229150094009232298');" onmouseout="out('-7229150094009232298');" style=""><abbr title=" 120                         myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCallback&lt;String&gt;() {"> 120                         myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCaðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 121                             @Override                                                                    </span>
<span class="-64379824841031564" onmouseenter="enter('-64379824841031564');" onmouseout="out('-64379824841031564');" style=""> 122                             public void onReceiveValue(String s) {                                       </span>
<span class="2263921439611640529" onmouseenter="enter('2263921439611640529');" onmouseout="out('2263921439611640529');" style=""> 123                                 LOG.debug(&quot;Callback from showConfiguration&quot;, s);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124                             }                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 125                         });                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 126                     } else {                                                                             </span>
<span class="9200735872565889787" onmouseenter="enter('9200735872565889787');" onmouseout="out('9200735872565889787');" style=""> 127                         ((WebView) v).loadUrl(&quot;javascript:Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129                 }                                                                                        </span>
<span  style=""> 130                                                                                                          </span>
<span  style=""> 131                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132             }                                                                                            </span>
<span  style=""> 133                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 134             @Override                                                                                    </span>
<span class="111214959032469638" onmouseenter="enter('111214959032469638');" onmouseout="out('111214959032469638');" style=""> 135             public void onViewDetachedFromWindow(View v) {                                               </span>
<span class="-700130854651119442" onmouseenter="enter('-700130854651119442');" onmouseout="out('-700130854651119442');" style=""> 136                 myWebView.removeJavascriptInterface(&quot;GBActivity&quot;);                                       </span>
<span class="2583010823854911475" onmouseenter="enter('2583010823854911475');" onmouseout="out('2583010823854911475');" style=""> 137                 myWebView.setWillNotDraw(true);                                                          </span>
<span class="7079593887772041495" onmouseenter="enter('7079593887772041495');" onmouseout="out('7079593887772041495');" style=""> 138                 FrameLayout fl = (FrameLayout) findViewById(R.id.webview_placeholder);                   </span>
<span class="4691548091453242641" onmouseenter="enter('4691548091453242641');" onmouseout="out('4691548091453242641');" style=""> 139                 fl.removeAllViews();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 141         });                                                                                              </span>
<span  style=""> 142                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143     }                                                                                                    </span>
<span  style=""> 144                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 145     @Override                                                                                            </span>
<span class="-6302640138359785349" onmouseenter="enter('-6302640138359785349');" onmouseout="out('-6302640138359785349');" style=""> 146     protected void onNewIntent(Intent incoming) {                                                        </span>
<span class="-8811924227565660535" onmouseenter="enter('-8811924227565660535');" onmouseout="out('-8811924227565660535');" style=""> 147         incoming.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);              </span>
<span class="3914907222764799912" onmouseenter="enter('3914907222764799912');" onmouseout="out('3914907222764799912');" style=""> 148         super.onNewIntent(incoming);                                                                     </span>
<span class="9221581554438190622" onmouseenter="enter('9221581554438190622');" onmouseout="out('9221581554438190622');" style=""> 149         confUri = incoming.getData();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150     }                                                                                                    </span>
<span  style=""> 151                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 152     @Override                                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 153 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 154 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155                 appUuid = UUID.fromString(confUri.getHost());                                            </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156                 queryString = confUri.getEncodedQuery();                                                 </span>
<span class="-1471183022667940231" onmouseenter="enter('-1471183022667940231');" onmouseout="out('-1471183022667940231');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157             } catch (IllegalArgumentException e) {                                                       </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158                 GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159             }                                                                                            </span>
<span class="-2988483940896729254" onmouseenter="enter('-2988483940896729254');" onmouseout="out('-2988483940896729254');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160             myWebView.loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164                                                                                                          </span>
<span class="769030667235534270" onmouseenter="enter('769030667235534270');" onmouseout="out('769030667235534270');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165     private JSONObject getAppConfigurationKeys() {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166         try {                                                                                            </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167             File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                     </span>
<span class="7281362543496976323" onmouseenter="enter('7281362543496976323');" onmouseout="out('7281362543496976323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168             File configurationFile = new File(destDir, appUuid.toString() + &quot;.json&quot;);                    </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169             if (configurationFile.exists()) {                                                            </span>
<span class="5694613783798252219" onmouseenter="enter('5694613783798252219');" onmouseout="out('5694613783798252219');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170                 String jsonstring = FileUtils.getStringFromFile(configurationFile);                      </span>
<span class="3207864232207206976" onmouseenter="enter('3207864232207206976');" onmouseout="out('3207864232207206976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171                 JSONObject json = new JSONObject(jsonstring);                                            </span>
<span class="-8008487347845491336" onmouseenter="enter('-8008487347845491336');" onmouseout="out('-8008487347845491336');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172                 return json.getJSONObject(&quot;appKeys&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173             }                                                                                            </span>
<span class="-5708376673499870750" onmouseenter="enter('-5708376673499870750');" onmouseout="out('-5708376673499870750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174         } catch (IOException | JSONException e) {                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176         }                                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179                                                                                                          </span>
<span class="489042004245109682" onmouseenter="enter('489042004245109682');" onmouseout="out('489042004245109682');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180     private class GBChromeClient extends WebChromeClient {                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181         @Override                                                                                        </span>
<span class="-3208398659097747584" onmouseenter="enter('-3208398659097747584');" onmouseout="out('-3208398659097747584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182         public boolean onConsoleMessage(ConsoleMessage consoleMessage) {                                 </span>
<span class="-2287224413451901168" onmouseenter="enter('-2287224413451901168');" onmouseout="out('-2287224413451901168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183             if (ConsoleMessage.MessageLevel.ERROR.equals(consoleMessage.messageLevel())) {               </span>
<span class="3323572400278979475" onmouseenter="enter('3323572400278979475');" onmouseout="out('3323572400278979475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184                 GB.toast(consoleMessage.message(), Toast.LENGTH_LONG, GB.ERROR);                         </span>
<span class="-6164745287293097307" onmouseenter="enter('-6164745287293097307');" onmouseout="out('-6164745287293097307');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185                 //TODO: show error page                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186             }                                                                                            </span>
<span class="8867653795588053101" onmouseenter="enter('8867653795588053101');" onmouseout="out('8867653795588053101');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187             return super.onConsoleMessage(consoleMessage);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                                                                                                          </span>
<span class="932716910050395867" onmouseenter="enter('932716910050395867');" onmouseout="out('932716910050395867');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192     private class GBWebClient extends WebViewClient {                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193         @Override                                                                                        </span>
<span class="-5389283987146508641" onmouseenter="enter('-5389283987146508641');" onmouseout="out('-5389283987146508641');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194         public boolean shouldOverrideUrlLoading(WebView view, String url) {                              </span>
<span class="-4470283582819493832" onmouseenter="enter('-4470283582819493832');" onmouseout="out('-4470283582819493832');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195             if (url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;)) {                               </span>
<span class="-6889520962166578594" onmouseenter="enter('-6889520962166578594');" onmouseout="out('-6889520962166578594');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                 Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(url));                               </span>
<span class="-83312019167722588" onmouseenter="enter('-83312019167722588');" onmouseout="out('-83312019167722588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                 i.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);             </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198                 startActivity(i);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199             } else {                                                                                     </span>
<span class="7355344190067323951" onmouseenter="enter('7355344190067323951');" onmouseout="out('7355344190067323951');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 200                 url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.html?config=true&amp;json=&quot;);"> 200                 url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.ðŸ”µ</abbr></span>
<span class="901384492729237222" onmouseenter="enter('901384492729237222');" onmouseout="out('901384492729237222');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201                 view.loadUrl(url);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203                                                                                                          </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204             return true;                                                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208                                                                                                          </span>
<span class="255546914543038546" onmouseenter="enter('255546914543038546');" onmouseout="out('255546914543038546');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209     private class JSInterface {                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210                                                                                                          </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211         Context mContext;                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212                                                                                                          </span>
<span class="6103178023340228960" onmouseenter="enter('6103178023340228960');" onmouseout="out('6103178023340228960');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213         public JSInterface(Context c) {                                                                  </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214             mContext = c;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217         @JavascriptInterface                                                                             </span>
<span class="778974974852788407" onmouseenter="enter('778974974852788407');" onmouseout="out('778974974852788407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218         public void gbLog(String msg) {                                                                  </span>
<span class="3027670622554237141" onmouseenter="enter('3027670622554237141');" onmouseout="out('3027670622554237141');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219             Log.d(&quot;WEBVIEW&quot;, msg);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222         @JavascriptInterface                                                                             </span>
<span class="-4624663689886901579" onmouseenter="enter('-4624663689886901579');" onmouseout="out('-4624663689886901579');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223         public void sendAppMessage(String msg) {                                                         </span>
<span class="-6201194628403629089" onmouseenter="enter('-6201194628403629089');" onmouseout="out('-6201194628403629089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224             LOG.debug(&quot;from WEBVIEW: &quot; + msg);                                                           </span>
<span class="-7234772518000694242" onmouseenter="enter('-7234772518000694242');" onmouseout="out('-7234772518000694242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225             JSONObject knownKeys = getAppConfigurationKeys();                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227             try {                                                                                        </span>
<span class="8379171825524475613" onmouseenter="enter('8379171825524475613');" onmouseout="out('8379171825524475613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228                 JSONObject in = new JSONObject(msg);                                                     </span>
<span class="3835181569981110952" onmouseenter="enter('3835181569981110952');" onmouseout="out('3835181569981110952');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229                 JSONObject out = new JSONObject();                                                       </span>
<span class="-5432090303292230287" onmouseenter="enter('-5432090303292230287');" onmouseout="out('-5432090303292230287');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230                 String inKey, outKey;                                                                    </span>
<span class="-6755195952504918332" onmouseenter="enter('-6755195952504918332');" onmouseout="out('-6755195952504918332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231                 boolean passKey;                                                                         </span>
<span class="195888856154758018" onmouseenter="enter('195888856154758018');" onmouseout="out('195888856154758018');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232                 for (Iterator&lt;String&gt; key = in.keys(); key.hasNext(); ) {                                </span>
<span class="35427419901421521" onmouseenter="enter('35427419901421521');" onmouseout="out('35427419901421521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                     passKey = false;                                                                     </span>
<span class="7300242526186641878" onmouseenter="enter('7300242526186641878');" onmouseout="out('7300242526186641878');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234                     inKey = key.next();                                                                  </span>
<span class="1625279893230829750" onmouseenter="enter('1625279893230829750');" onmouseout="out('1625279893230829750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235                     outKey = null;                                                                       </span>
<span class="-8000058323286219252" onmouseenter="enter('-8000058323286219252');" onmouseout="out('-8000058323286219252');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236                     int pebbleAppIndex = knownKeys.optInt(inKey, -1);                                    </span>
<span class="1318599845650471336" onmouseenter="enter('1318599845650471336');" onmouseout="out('1318599845650471336');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237                     if (pebbleAppIndex != -1) {                                                          </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238                         passKey = true;                                                                  </span>
<span class="6093149884609226755" onmouseenter="enter('6093149884609226755');" onmouseout="out('6093149884609226755');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239                         outKey = String.valueOf(pebbleAppIndex);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240                     } else {                                                                             </span>
<span class="1471897956818349080" onmouseenter="enter('1471897956818349080');" onmouseout="out('1471897956818349080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 241                         //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-pebblekit-js/ )"> 241                         //do not discard integer keys (see https://developer.pebble.com/guides/communicatðŸ”µ</abbr></span>
<span class="9182410012949841341" onmouseenter="enter('9182410012949841341');" onmouseout="out('9182410012949841341');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242                         Scanner scanner = new Scanner(inKey);                                            </span>
<span class="3432714770914509184" onmouseenter="enter('3432714770914509184');" onmouseout="out('3432714770914509184');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                         if (scanner.hasNextInt() &amp;&amp; inKey.equals(&quot;&quot; + scanner.nextInt())) {              </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                             passKey = true;                                                              </span>
<span class="633307466455829355" onmouseenter="enter('633307466455829355');" onmouseout="out('633307466455829355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                             outKey = inKey;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247                     }                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                                                                                                          </span>
<span class="7100715742750083788" onmouseenter="enter('7100715742750083788');" onmouseout="out('7100715742750083788');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249                     if (passKey) {                                                                       </span>
<span class="-1814814172109868162" onmouseenter="enter('-1814814172109868162');" onmouseout="out('-1814814172109868162');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                         Object obj = in.get(inKey);                                                      </span>
<span class="-2516604200979810702" onmouseenter="enter('-2516604200979810702');" onmouseout="out('-2516604200979810702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                         if (obj instanceof Boolean) {                                                    </span>
<span class="3988738952494779303" onmouseenter="enter('3988738952494779303');" onmouseout="out('3988738952494779303');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                             obj = ((Boolean) obj) ? &quot;true&quot; : &quot;false&quot;;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                         }                                                                                </span>
<span class="7889737448406399667" onmouseenter="enter('7889737448406399667');" onmouseout="out('7889737448406399667');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                         out.put(outKey, obj);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                     } else {                                                                             </span>
<span class="-2054330584630270669" onmouseenter="enter('-2054330584630270669');" onmouseout="out('-2054330584630270669');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 256                         GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an integer key.&quot;, Toast.LENGTH_SHORT, GB.WARN);"> 256                         GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and iðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                     }                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259                 }                                                                                        </span>
<span class="-881732067758657379" onmouseenter="enter('-881732067758657379');" onmouseout="out('-881732067758657379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                 LOG.info(out.toString());                                                                </span>
<span class="-2343027273789634583" onmouseenter="enter('-2343027273789634583');" onmouseout="out('-2343027273789634583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                 GBApplication.deviceService().onAppConfiguration(appUuid, out.toString());               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                                                                                                          </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263             } catch (JSONException e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268         @JavascriptInterface                                                                             </span>
<span class="-5632539219238112893" onmouseenter="enter('-5632539219238112893');" onmouseout="out('-5632539219238112893');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269         public String getActiveWatchInfo() {                                                             </span>
<span class="-843298888064131140" onmouseenter="enter('-843298888064131140');" onmouseout="out('-843298888064131140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270             JSONObject wi = new JSONObject();                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271             try {                                                                                        </span>
<span class="-7073207729972829278" onmouseenter="enter('-7073207729972829278');" onmouseout="out('-7073207729972829278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272                 wi.put(&quot;firmware&quot;, mGBDevice.getFirmwareVersion());                                      </span>
<span class="1619143394428866421" onmouseenter="enter('1619143394428866421');" onmouseout="out('1619143394428866421');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273                 wi.put(&quot;platform&quot;, PebbleUtils.getPlatformName(mGBDevice.getModel()));                   </span>
<span class="-5437394903337435394" onmouseenter="enter('-5437394903337435394');" onmouseout="out('-5437394903337435394');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274                 wi.put(&quot;model&quot;, PebbleUtils.getModel(mGBDevice.getModel()));                             </span>
<span class="6629264299746547541" onmouseenter="enter('6629264299746547541');" onmouseout="out('6629264299746547541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275                 //TODO: use real info                                                                    </span>
<span class="118738678871371777" onmouseenter="enter('118738678871371777');" onmouseout="out('118738678871371777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276                 wi.put(&quot;language&quot;, &quot;en&quot;);                                                                </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277             } catch (JSONException e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279             }                                                                                            </span>
<span class="2996545006566015873" onmouseenter="enter('2996545006566015873');" onmouseout="out('2996545006566015873');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280             //Json not supported apparently, we need to cast back and forth                              </span>
<span class="5839065679891034244" onmouseenter="enter('5839065679891034244');" onmouseout="out('5839065679891034244');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281             return wi.toString();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284         @JavascriptInterface                                                                             </span>
<span class="-856046329422320734" onmouseenter="enter('-856046329422320734');" onmouseout="out('-856046329422320734');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285         public String getAppConfigurationFile() {                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286             try {                                                                                        </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                 File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                 </span>
<span class="-6190799366778164723" onmouseenter="enter('-6190799366778164723');" onmouseout="out('-6190799366778164723');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                 File configurationFile = new File(destDir, appUuid.toString() + &quot;_config.js&quot;);           </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289                 if (configurationFile.exists()) {                                                        </span>
<span class="-736461147530501961" onmouseenter="enter('-736461147530501961');" onmouseout="out('-736461147530501961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                     return &quot;file:///&quot; + configurationFile.getAbsolutePath();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291                 }                                                                                        </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292             } catch (IOException e) {                                                                    </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298         @JavascriptInterface                                                                             </span>
<span class="7186673836371686422" onmouseenter="enter('7186673836371686422');" onmouseout="out('7186673836371686422');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299         public String getAppStoredPreset() {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300             try {                                                                                        </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301                 File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                 </span>
<span class="-1650511077982903195" onmouseenter="enter('-1650511077982903195');" onmouseout="out('-1650511077982903195');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302                 File configurationFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);         </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303                 if (configurationFile.exists()) {                                                        </span>
<span class="-4631811320466918610" onmouseenter="enter('-4631811320466918610');" onmouseout="out('-4631811320466918610');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304                     return FileUtils.getStringFromFile(configurationFile);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305                 }                                                                                        </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306             } catch (IOException e) {                                                                    </span>
<span class="-1248445865590398413" onmouseenter="enter('-1248445865590398413');" onmouseout="out('-1248445865590398413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307                 GB.toast(&quot;Error reading presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313         @JavascriptInterface                                                                             </span>
<span class="-6701887776194876087" onmouseenter="enter('-6701887776194876087');" onmouseout="out('-6701887776194876087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314         public void saveAppStoredPreset(String msg) {                                                    </span>
<span class="-192245887358676257" onmouseenter="enter('-192245887358676257');" onmouseout="out('-192245887358676257');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315             Writer writer;                                                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 317             try {                                                                                        </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 318                 File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                 </span>
<span class="3603668645457989644" onmouseenter="enter('3603668645457989644');" onmouseout="out('3603668645457989644');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 319                 File presetsFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);               </span>
<span class="-2643535316378223379" onmouseenter="enter('-2643535316378223379');" onmouseout="out('-2643535316378223379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 320                 writer = new BufferedWriter(new FileWriter(presetsFile));                                </span>
<span class="-5700221122508670675" onmouseenter="enter('-5700221122508670675');" onmouseout="out('-5700221122508670675');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 321                 writer.write(msg);                                                                       </span>
<span class="4330639758910844474" onmouseenter="enter('4330639758910844474');" onmouseout="out('4330639758910844474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 322                 writer.close();                                                                          </span>
<span class="-850015778348175113" onmouseenter="enter('-850015778348175113');" onmouseout="out('-850015778348175113');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 323                 GB.toast(&quot;Presets stored&quot;, Toast.LENGTH_SHORT, GB.INFO);                                 </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 324             } catch (IOException e) {                                                                    </span>
<span class="-4875214328390419177" onmouseenter="enter('-4875214328390419177');" onmouseout="out('-4875214328390419177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325                 GB.toast(&quot;Error storing presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330         @JavascriptInterface                                                                             </span>
<span class="-8118311426044261956" onmouseenter="enter('-8118311426044261956');" onmouseout="out('-8118311426044261956');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331         public String getAppUUID() {                                                                     </span>
<span class="-5609100198503319527" onmouseenter="enter('-5609100198503319527');" onmouseout="out('-5609100198503319527');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332             return appUuid.toString();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335         @JavascriptInterface                                                                             </span>
<span class="-2024961006635561560" onmouseenter="enter('-2024961006635561560');" onmouseout="out('-2024961006635561560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336         public String getAppLocalstoragePrefix() {                                                       </span>
<span class="-139042831100003478" onmouseenter="enter('-139042831100003478');" onmouseout="out('-139042831100003478');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 337             String prefix = mGBDevice.getAddress() + appUuid.toString();                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338             try {                                                                                        </span>
<span class="1589472625916860471" onmouseenter="enter('1589472625916860471');" onmouseout="out('1589472625916860471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339                 MessageDigest digest = MessageDigest.getInstance(&quot;SHA-1&quot;);                               </span>
<span class="-1715536820593379285" onmouseenter="enter('-1715536820593379285');" onmouseout="out('-1715536820593379285');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340                 byte[] bytes = prefix.getBytes(&quot;UTF-8&quot;);                                                 </span>
<span class="-6693486492020146741" onmouseenter="enter('-6693486492020146741');" onmouseout="out('-6693486492020146741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 341                 digest.update(bytes, 0, bytes.length);                                                   </span>
<span class="-4062246525168346439" onmouseenter="enter('-4062246525168346439');" onmouseout="out('-4062246525168346439');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342                 bytes = digest.digest();                                                                 </span>
<span class="1334999931346445764" onmouseenter="enter('1334999931346445764');" onmouseout="out('1334999931346445764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343                 final StringBuilder sb = new StringBuilder();                                            </span>
<span class="-7387509961039532833" onmouseenter="enter('-7387509961039532833');" onmouseout="out('-7387509961039532833');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344                 for (int i = 0; i &lt; bytes.length; i++) {                                                 </span>
<span class="7651397204661452382" onmouseenter="enter('7651397204661452382');" onmouseout="out('7651397204661452382');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345                     sb.append(String.format(&quot;%02X&quot;, bytes[i]));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346                 }                                                                                        </span>
<span class="6091843332607413306" onmouseenter="enter('6091843332607413306');" onmouseout="out('6091843332607413306');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347                 return sb.toString().toLowerCase();                                                      </span>
<span class="5663120823918718146" onmouseenter="enter('5663120823918718146');" onmouseout="out('5663120823918718146');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348             } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349                 e.printStackTrace();                                                                     </span>
<span class="-5295149366119702820" onmouseenter="enter('-5295149366119702820');" onmouseout="out('-5295149366119702820');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 350                 return prefix;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 354         @JavascriptInterface                                                                             </span>
<span class="6682389599781806833" onmouseenter="enter('6682389599781806833');" onmouseout="out('6682389599781806833');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 355         public String getWatchToken() {                                                                  </span>
<span class="588975967419017208" onmouseenter="enter('588975967419017208');" onmouseout="out('588975967419017208');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 356             //specification says: A string that is guaranteed to be identical for each Pebble device for the same app across different mobile devices. The token is unique to your app and cannot be used to track Pebble devices across applications. see https://developer.pebble.com/docs/js/Pebble/"> 356             //specification says: A string that is guaranteed to be identical for each Pebble device for ðŸ”µ</abbr></span>
<span class="1141582625581442566" onmouseenter="enter('1141582625581442566');" onmouseout="out('1141582625581442566');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 357             return &quot;gb&quot; + appUuid.toString();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 358         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 359                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 360         @JavascriptInterface                                                                             </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361         public void closeActivity() {                                                                    </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362             NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 366     @Override                                                                                            </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 367     public boolean onOptionsItemSelected(MenuItem item) {                                                </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368         switch (item.getItemId()) {                                                                      </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 369             case android.R.id.home:                                                                      </span>
<span class="-1694655592982141021" onmouseenter="enter('-1694655592982141021');" onmouseout="out('-1694655592982141021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 370                 NavUtils.navigateUpFromSameTask(this);                                                   </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 371                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 372         }                                                                                                </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 373         return super.onOptionsItemSelected(item);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 374     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 375                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 376                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 377 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 378 =======                                                                                                  </span>
<span class="302393315460284103" onmouseenter="enter('302393315460284103');" onmouseout="out('302393315460284103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379     protected void onResume() {                                                                          </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380         super.onResume();                                                                                </span>
<span class="-1033981458626162610" onmouseenter="enter('-1033981458626162610');" onmouseout="out('-1033981458626162610');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 381         String queryString = &quot;&quot;;                                                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 382                                                                                                          </span>
<span class="-2276587090849303814" onmouseenter="enter('-2276587090849303814');" onmouseout="out('-2276587090849303814');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 383         if (confUri != null) {                                                                           </span>
<span class="-1088791743364895452" onmouseenter="enter('-1088791743364895452');" onmouseout="out('-1088791743364895452');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 384             //getting back with configuration data                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 385             try {                                                                                        </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 386                 appUuid = UUID.fromString(confUri.getHost());                                            </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 387                 queryString = confUri.getEncodedQuery();                                                 </span>
<span class="-1471183022667940231" onmouseenter="enter('-1471183022667940231');" onmouseout="out('-1471183022667940231');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 388             } catch (IllegalArgumentException e) {                                                       </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 389                 GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 390             }                                                                                            </span>
<span class="-2988483940896729254" onmouseenter="enter('-2988483940896729254');" onmouseout="out('-2988483940896729254');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 391             myWebView.loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 392         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 393                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 394     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 395                                                                                                          </span>
<span class="769030667235534270" onmouseenter="enter('769030667235534270');" onmouseout="out('769030667235534270');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396     private JSONObject getAppConfigurationKeys() {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 397         try {                                                                                            </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 398             File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                     </span>
<span class="7281362543496976323" onmouseenter="enter('7281362543496976323');" onmouseout="out('7281362543496976323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 399             File configurationFile = new File(destDir, appUuid.toString() + &quot;.json&quot;);                    </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 400             if (configurationFile.exists()) {                                                            </span>
<span class="5694613783798252219" onmouseenter="enter('5694613783798252219');" onmouseout="out('5694613783798252219');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 401                 String jsonstring = FileUtils.getStringFromFile(configurationFile);                      </span>
<span class="3207864232207206976" onmouseenter="enter('3207864232207206976');" onmouseout="out('3207864232207206976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 402                 JSONObject json = new JSONObject(jsonstring);                                            </span>
<span class="-8008487347845491336" onmouseenter="enter('-8008487347845491336');" onmouseout="out('-8008487347845491336');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 403                 return json.getJSONObject(&quot;appKeys&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 404             }                                                                                            </span>
<span class="-5708376673499870750" onmouseenter="enter('-5708376673499870750');" onmouseout="out('-5708376673499870750');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 405         } catch (IOException | JSONException e) {                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 407         }                                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 408         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 409     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 410                                                                                                          </span>
<span class="-8943595674098220959" onmouseenter="enter('-8943595674098220959');" onmouseout="out('-8943595674098220959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 411     private boolean isLocationEnabledForWatchApp() {                                                     </span>
<span class="939192678715537627" onmouseenter="enter('939192678715537627');" onmouseout="out('939192678715537627');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 412         return true; //as long as we don&#x27;t give watchapp internet access it&#x27;s not a problem              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 413     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 414                                                                                                          </span>
<span class="489042004245109682" onmouseenter="enter('489042004245109682');" onmouseout="out('489042004245109682');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 415     private class GBChromeClient extends WebChromeClient {                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 416         @Override                                                                                        </span>
<span class="-3208398659097747584" onmouseenter="enter('-3208398659097747584');" onmouseout="out('-3208398659097747584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 417         public boolean onConsoleMessage(ConsoleMessage consoleMessage) {                                 </span>
<span class="-2287224413451901168" onmouseenter="enter('-2287224413451901168');" onmouseout="out('-2287224413451901168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 418             if (ConsoleMessage.MessageLevel.ERROR.equals(consoleMessage.messageLevel())) {               </span>
<span class="3323572400278979475" onmouseenter="enter('3323572400278979475');" onmouseout="out('3323572400278979475');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 419                 GB.toast(consoleMessage.message(), Toast.LENGTH_LONG, GB.ERROR);                         </span>
<span class="-6164745287293097307" onmouseenter="enter('-6164745287293097307');" onmouseout="out('-6164745287293097307');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 420                 //TODO: show error page                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 421             }                                                                                            </span>
<span class="8867653795588053101" onmouseenter="enter('8867653795588053101');" onmouseout="out('8867653795588053101');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 422             return super.onConsoleMessage(consoleMessage);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 423         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 424                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 425     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 426                                                                                                          </span>
<span class="932716910050395867" onmouseenter="enter('932716910050395867');" onmouseout="out('932716910050395867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 427     private class GBWebClient extends WebViewClient {                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 428         @Override                                                                                        </span>
<span class="-5389283987146508641" onmouseenter="enter('-5389283987146508641');" onmouseout="out('-5389283987146508641');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 429         public boolean shouldOverrideUrlLoading(WebView view, String url) {                              </span>
<span class="-4470283582819493832" onmouseenter="enter('-4470283582819493832');" onmouseout="out('-4470283582819493832');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 430             if (url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;)) {                               </span>
<span class="-6889520962166578594" onmouseenter="enter('-6889520962166578594');" onmouseout="out('-6889520962166578594');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 431                 Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(url));                               </span>
<span class="-83312019167722588" onmouseenter="enter('-83312019167722588');" onmouseout="out('-83312019167722588');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 432                 i.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);             </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 433                 startActivity(i);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 434             } else {                                                                                     </span>
<span class="7355344190067323951" onmouseenter="enter('7355344190067323951');" onmouseout="out('7355344190067323951');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 435                 url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.html?config=true&amp;json=&quot;);"> 435                 url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.ðŸ”µ</abbr></span>
<span class="901384492729237222" onmouseenter="enter('901384492729237222');" onmouseout="out('901384492729237222');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 436                 view.loadUrl(url);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 437             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 438                                                                                                          </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 439             return true;                                                                                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 440                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 441         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 442     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 443                                                                                                          </span>
<span class="255546914543038546" onmouseenter="enter('255546914543038546');" onmouseout="out('255546914543038546');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 444     private class JSInterface {                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 445                                                                                                          </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 446         Context mContext;                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 447                                                                                                          </span>
<span class="6103178023340228960" onmouseenter="enter('6103178023340228960');" onmouseout="out('6103178023340228960');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 448         public JSInterface(Context c) {                                                                  </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 449             mContext = c;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 450         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 451                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 452         @JavascriptInterface                                                                             </span>
<span class="778974974852788407" onmouseenter="enter('778974974852788407');" onmouseout="out('778974974852788407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 453         public void gbLog(String msg) {                                                                  </span>
<span class="3027670622554237141" onmouseenter="enter('3027670622554237141');" onmouseout="out('3027670622554237141');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 454             Log.d(&quot;WEBVIEW&quot;, msg);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 455         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 456                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 457         @JavascriptInterface                                                                             </span>
<span class="-4624663689886901579" onmouseenter="enter('-4624663689886901579');" onmouseout="out('-4624663689886901579');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 458         public void sendAppMessage(String msg) {                                                         </span>
<span class="-6201194628403629089" onmouseenter="enter('-6201194628403629089');" onmouseout="out('-6201194628403629089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 459             LOG.debug(&quot;from WEBVIEW: &quot; + msg);                                                           </span>
<span class="-7234772518000694242" onmouseenter="enter('-7234772518000694242');" onmouseout="out('-7234772518000694242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 460             JSONObject knownKeys = getAppConfigurationKeys();                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 461                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 462             try {                                                                                        </span>
<span class="8379171825524475613" onmouseenter="enter('8379171825524475613');" onmouseout="out('8379171825524475613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 463                 JSONObject in = new JSONObject(msg);                                                     </span>
<span class="3835181569981110952" onmouseenter="enter('3835181569981110952');" onmouseout="out('3835181569981110952');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 464                 JSONObject out = new JSONObject();                                                       </span>
<span class="-5432090303292230287" onmouseenter="enter('-5432090303292230287');" onmouseout="out('-5432090303292230287');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 465                 String inKey, outKey;                                                                    </span>
<span class="-6755195952504918332" onmouseenter="enter('-6755195952504918332');" onmouseout="out('-6755195952504918332');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 466                 boolean passKey;                                                                         </span>
<span class="195888856154758018" onmouseenter="enter('195888856154758018');" onmouseout="out('195888856154758018');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 467                 for (Iterator&lt;String&gt; key = in.keys(); key.hasNext(); ) {                                </span>
<span class="35427419901421521" onmouseenter="enter('35427419901421521');" onmouseout="out('35427419901421521');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 468                     passKey = false;                                                                     </span>
<span class="7300242526186641878" onmouseenter="enter('7300242526186641878');" onmouseout="out('7300242526186641878');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 469                     inKey = key.next();                                                                  </span>
<span class="1625279893230829750" onmouseenter="enter('1625279893230829750');" onmouseout="out('1625279893230829750');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 470                     outKey = null;                                                                       </span>
<span class="-8000058323286219252" onmouseenter="enter('-8000058323286219252');" onmouseout="out('-8000058323286219252');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 471                     int pebbleAppIndex = knownKeys.optInt(inKey, -1);                                    </span>
<span class="1318599845650471336" onmouseenter="enter('1318599845650471336');" onmouseout="out('1318599845650471336');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 472                     if (pebbleAppIndex != -1) {                                                          </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 473                         passKey = true;                                                                  </span>
<span class="6093149884609226755" onmouseenter="enter('6093149884609226755');" onmouseout="out('6093149884609226755');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 474                         outKey = String.valueOf(pebbleAppIndex);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 475                     } else {                                                                             </span>
<span class="1471897956818349080" onmouseenter="enter('1471897956818349080');" onmouseout="out('1471897956818349080');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 476                         //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-pebblekit-js/ )"> 476                         //do not discard integer keys (see https://developer.pebble.com/guides/communicatðŸ”µ</abbr></span>
<span class="9182410012949841341" onmouseenter="enter('9182410012949841341');" onmouseout="out('9182410012949841341');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 477                         Scanner scanner = new Scanner(inKey);                                            </span>
<span class="3432714770914509184" onmouseenter="enter('3432714770914509184');" onmouseout="out('3432714770914509184');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 478                         if (scanner.hasNextInt() &amp;&amp; inKey.equals(&quot;&quot; + scanner.nextInt())) {              </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 479                             passKey = true;                                                              </span>
<span class="633307466455829355" onmouseenter="enter('633307466455829355');" onmouseout="out('633307466455829355');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 480                             outKey = inKey;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 481                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 482                     }                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 483                                                                                                          </span>
<span class="7100715742750083788" onmouseenter="enter('7100715742750083788');" onmouseout="out('7100715742750083788');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 484                     if (passKey) {                                                                       </span>
<span class="-1814814172109868162" onmouseenter="enter('-1814814172109868162');" onmouseout="out('-1814814172109868162');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 485                         Object obj = in.get(inKey);                                                      </span>
<span class="-2516604200979810702" onmouseenter="enter('-2516604200979810702');" onmouseout="out('-2516604200979810702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 486                         if (obj instanceof Boolean) {                                                    </span>
<span class="3988738952494779303" onmouseenter="enter('3988738952494779303');" onmouseout="out('3988738952494779303');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 487                             obj = ((Boolean) obj) ? &quot;true&quot; : &quot;false&quot;;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 488                         }                                                                                </span>
<span class="7889737448406399667" onmouseenter="enter('7889737448406399667');" onmouseout="out('7889737448406399667');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 489                         out.put(outKey, obj);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 490                     } else {                                                                             </span>
<span class="-2054330584630270669" onmouseenter="enter('-2054330584630270669');" onmouseout="out('-2054330584630270669');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 491                         GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an integer key.&quot;, Toast.LENGTH_SHORT, GB.WARN);"> 491                         GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and iðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 492                     }                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 493                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 494                 }                                                                                        </span>
<span class="-881732067758657379" onmouseenter="enter('-881732067758657379');" onmouseout="out('-881732067758657379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 495                 LOG.info(out.toString());                                                                </span>
<span class="-2343027273789634583" onmouseenter="enter('-2343027273789634583');" onmouseout="out('-2343027273789634583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 496                 GBApplication.deviceService().onAppConfiguration(appUuid, out.toString());               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 497                                                                                                          </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 498             } catch (JSONException e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 499                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 500             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 501         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 502                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 503         @JavascriptInterface                                                                             </span>
<span class="-5632539219238112893" onmouseenter="enter('-5632539219238112893');" onmouseout="out('-5632539219238112893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 504         public String getActiveWatchInfo() {                                                             </span>
<span class="-843298888064131140" onmouseenter="enter('-843298888064131140');" onmouseout="out('-843298888064131140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 505             JSONObject wi = new JSONObject();                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 506             try {                                                                                        </span>
<span class="-7073207729972829278" onmouseenter="enter('-7073207729972829278');" onmouseout="out('-7073207729972829278');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507                 wi.put(&quot;firmware&quot;, mGBDevice.getFirmwareVersion());                                      </span>
<span class="1619143394428866421" onmouseenter="enter('1619143394428866421');" onmouseout="out('1619143394428866421');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508                 wi.put(&quot;platform&quot;, PebbleUtils.getPlatformName(mGBDevice.getModel()));                   </span>
<span class="-5437394903337435394" onmouseenter="enter('-5437394903337435394');" onmouseout="out('-5437394903337435394');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509                 wi.put(&quot;model&quot;, PebbleUtils.getModel(mGBDevice.getModel()));                             </span>
<span class="6629264299746547541" onmouseenter="enter('6629264299746547541');" onmouseout="out('6629264299746547541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510                 //TODO: use real info                                                                    </span>
<span class="118738678871371777" onmouseenter="enter('118738678871371777');" onmouseout="out('118738678871371777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511                 wi.put(&quot;language&quot;, &quot;en&quot;);                                                                </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512             } catch (JSONException e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514             }                                                                                            </span>
<span class="2996545006566015873" onmouseenter="enter('2996545006566015873');" onmouseout="out('2996545006566015873');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515             //Json not supported apparently, we need to cast back and forth                              </span>
<span class="5839065679891034244" onmouseenter="enter('5839065679891034244');" onmouseout="out('5839065679891034244');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516             return wi.toString();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519         @JavascriptInterface                                                                             </span>
<span class="-856046329422320734" onmouseenter="enter('-856046329422320734');" onmouseout="out('-856046329422320734');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520         public String getAppConfigurationFile() {                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521             try {                                                                                        </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522                 File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                 </span>
<span class="-6190799366778164723" onmouseenter="enter('-6190799366778164723');" onmouseout="out('-6190799366778164723');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523                 File configurationFile = new File(destDir, appUuid.toString() + &quot;_config.js&quot;);           </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524                 if (configurationFile.exists()) {                                                        </span>
<span class="-736461147530501961" onmouseenter="enter('-736461147530501961');" onmouseout="out('-736461147530501961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525                     return &quot;file:///&quot; + configurationFile.getAbsolutePath();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526                 }                                                                                        </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527             } catch (IOException e) {                                                                    </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533         @JavascriptInterface                                                                             </span>
<span class="7186673836371686422" onmouseenter="enter('7186673836371686422');" onmouseout="out('7186673836371686422');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534         public String getAppStoredPreset() {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 535             try {                                                                                        </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 536                 File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                 </span>
<span class="-1650511077982903195" onmouseenter="enter('-1650511077982903195');" onmouseout="out('-1650511077982903195');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 537                 File configurationFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);         </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538                 if (configurationFile.exists()) {                                                        </span>
<span class="-4631811320466918610" onmouseenter="enter('-4631811320466918610');" onmouseout="out('-4631811320466918610');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 539                     return FileUtils.getStringFromFile(configurationFile);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 540                 }                                                                                        </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 541             } catch (IOException e) {                                                                    </span>
<span class="-1248445865590398413" onmouseenter="enter('-1248445865590398413');" onmouseout="out('-1248445865590398413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542                 GB.toast(&quot;Error reading presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 544             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 545             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 546         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 547                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 548         @JavascriptInterface                                                                             </span>
<span class="-6701887776194876087" onmouseenter="enter('-6701887776194876087');" onmouseout="out('-6701887776194876087');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 549         public void saveAppStoredPreset(String msg) {                                                    </span>
<span class="-192245887358676257" onmouseenter="enter('-192245887358676257');" onmouseout="out('-192245887358676257');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 550             Writer writer;                                                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552             try {                                                                                        </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553                 File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                 </span>
<span class="3603668645457989644" onmouseenter="enter('3603668645457989644');" onmouseout="out('3603668645457989644');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 554                 File presetsFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);               </span>
<span class="-2643535316378223379" onmouseenter="enter('-2643535316378223379');" onmouseout="out('-2643535316378223379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555                 writer = new BufferedWriter(new FileWriter(presetsFile));                                </span>
<span class="-5700221122508670675" onmouseenter="enter('-5700221122508670675');" onmouseout="out('-5700221122508670675');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 556                 writer.write(msg);                                                                       </span>
<span class="4330639758910844474" onmouseenter="enter('4330639758910844474');" onmouseout="out('4330639758910844474');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557                 writer.close();                                                                          </span>
<span class="-850015778348175113" onmouseenter="enter('-850015778348175113');" onmouseout="out('-850015778348175113');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558                 GB.toast(&quot;Presets stored&quot;, Toast.LENGTH_SHORT, GB.INFO);                                 </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559             } catch (IOException e) {                                                                    </span>
<span class="-4875214328390419177" onmouseenter="enter('-4875214328390419177');" onmouseout="out('-4875214328390419177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 560                 GB.toast(&quot;Error storing presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565         @JavascriptInterface                                                                             </span>
<span class="-8118311426044261956" onmouseenter="enter('-8118311426044261956');" onmouseout="out('-8118311426044261956');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566         public String getAppUUID() {                                                                     </span>
<span class="-5609100198503319527" onmouseenter="enter('-5609100198503319527');" onmouseout="out('-5609100198503319527');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567             return appUuid.toString();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570         @JavascriptInterface                                                                             </span>
<span class="-2024961006635561560" onmouseenter="enter('-2024961006635561560');" onmouseout="out('-2024961006635561560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571         public String getAppLocalstoragePrefix() {                                                       </span>
<span class="-139042831100003478" onmouseenter="enter('-139042831100003478');" onmouseout="out('-139042831100003478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 572             String prefix = mGBDevice.getAddress() + appUuid.toString();                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573             try {                                                                                        </span>
<span class="1589472625916860471" onmouseenter="enter('1589472625916860471');" onmouseout="out('1589472625916860471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574                 MessageDigest digest = MessageDigest.getInstance(&quot;SHA-1&quot;);                               </span>
<span class="-1715536820593379285" onmouseenter="enter('-1715536820593379285');" onmouseout="out('-1715536820593379285');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575                 byte[] bytes = prefix.getBytes(&quot;UTF-8&quot;);                                                 </span>
<span class="-6693486492020146741" onmouseenter="enter('-6693486492020146741');" onmouseout="out('-6693486492020146741');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576                 digest.update(bytes, 0, bytes.length);                                                   </span>
<span class="-4062246525168346439" onmouseenter="enter('-4062246525168346439');" onmouseout="out('-4062246525168346439');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577                 bytes = digest.digest();                                                                 </span>
<span class="1334999931346445764" onmouseenter="enter('1334999931346445764');" onmouseout="out('1334999931346445764');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578                 final StringBuilder sb = new StringBuilder();                                            </span>
<span class="-7387509961039532833" onmouseenter="enter('-7387509961039532833');" onmouseout="out('-7387509961039532833');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 579                 for (int i = 0; i &lt; bytes.length; i++) {                                                 </span>
<span class="7651397204661452382" onmouseenter="enter('7651397204661452382');" onmouseout="out('7651397204661452382');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580                     sb.append(String.format(&quot;%02X&quot;, bytes[i]));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581                 }                                                                                        </span>
<span class="6091843332607413306" onmouseenter="enter('6091843332607413306');" onmouseout="out('6091843332607413306');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582                 return sb.toString().toLowerCase();                                                      </span>
<span class="5663120823918718146" onmouseenter="enter('5663120823918718146');" onmouseout="out('5663120823918718146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583             } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584                 e.printStackTrace();                                                                     </span>
<span class="-5295149366119702820" onmouseenter="enter('-5295149366119702820');" onmouseout="out('-5295149366119702820');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585                 return prefix;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 587         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589         @JavascriptInterface                                                                             </span>
<span class="6682389599781806833" onmouseenter="enter('6682389599781806833');" onmouseout="out('6682389599781806833');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590         public String getWatchToken() {                                                                  </span>
<span class="588975967419017208" onmouseenter="enter('588975967419017208');" onmouseout="out('588975967419017208');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 591             //specification says: A string that is guaranteed to be identical for each Pebble device for the same app across different mobile devices. The token is unique to your app and cannot be used to track Pebble devices across applications. see https://developer.pebble.com/docs/js/Pebble/"> 591             //specification says: A string that is guaranteed to be identical for each Pebble device for ðŸ”µ</abbr></span>
<span class="1141582625581442566" onmouseenter="enter('1141582625581442566');" onmouseout="out('1141582625581442566');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592             return &quot;gb&quot; + appUuid.toString();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 595         @JavascriptInterface                                                                             </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 596         public void closeActivity() {                                                                    </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 597             NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 598         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 599                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 600                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 601         @JavascriptInterface                                                                             </span>
<span class="-5039914046281084423" onmouseenter="enter('-5039914046281084423');" onmouseout="out('-5039914046281084423');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 602         public String getCurrentPosition() {                                                             </span>
<span class="-149413150381439412" onmouseenter="enter('-149413150381439412');" onmouseout="out('-149413150381439412');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 603             if (!isLocationEnabledForWatchApp()) {                                                       </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 604                 return &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 605             }                                                                                            </span>
<span class="8227519164768398763" onmouseenter="enter('8227519164768398763');" onmouseout="out('8227519164768398763');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 606             //we need to override this because the coarse location is not enough for the android webview, we should add the permission for fine location."> 606             //we need to override this because the coarse location is not enough for the android webview,ðŸ”µ</abbr></span>
<span class="7572894489807780729" onmouseenter="enter('7572894489807780729');" onmouseout="out('7572894489807780729');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 607             JSONObject geoPosition = new JSONObject();                                                   </span>
<span class="-8852470018621524217" onmouseenter="enter('-8852470018621524217');" onmouseout="out('-8852470018621524217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 608             JSONObject coords = new JSONObject();                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 609             try {                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 610                                                                                                          </span>
<span class="7576815700871527587" onmouseenter="enter('7576815700871527587');" onmouseout="out('7576815700871527587');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 611                 Prefs prefs = GBApplication.getPrefs();                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 612                                                                                                          </span>
<span class="-2804823070089201012" onmouseenter="enter('-2804823070089201012');" onmouseout="out('-2804823070089201012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 613                 geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know this value is really old"> 613                 geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know ðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 614                                                                                                          </span>
<span class="6245247748368740564" onmouseenter="enter('6245247748368740564');" onmouseout="out('6245247748368740564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615                 coords.put(&quot;latitude&quot;, prefs.getFloat(&quot;location_latitude&quot;, 0));                          </span>
<span class="-2550975770164595754" onmouseenter="enter('-2550975770164595754');" onmouseout="out('-2550975770164595754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616                 coords.put(&quot;longitude&quot;, prefs.getFloat(&quot;location_longitude&quot;, 0));                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617                                                                                                          </span>
<span class="-2595111342414270158" onmouseenter="enter('-2595111342414270158');" onmouseout="out('-2595111342414270158');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 618                 if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED &amp;&amp;"> 618                 if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESðŸ”µ</abbr></span>
<span class="-6892731487308770176" onmouseenter="enter('-6892731487308770176');" onmouseout="out('-6892731487308770176');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619                         prefs.getBoolean(&quot;use_updated_location_if_available&quot;, false)) {                  </span>
<span class="3465319766909019165" onmouseenter="enter('3465319766909019165');" onmouseout="out('3465319766909019165');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 620                     LocationManager locationManager = (LocationManager) getApplicationContext().getSystemService(Context.LOCATION_SERVICE);"> 620                     LocationManager locationManager = (LocationManager) getApplicationContext().getSystemðŸ”µ</abbr></span>
<span class="-840377409278335695" onmouseenter="enter('-840377409278335695');" onmouseout="out('-840377409278335695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 621                     Criteria criteria = new Criteria();                                                  </span>
<span class="6446985192446327745" onmouseenter="enter('6446985192446327745');" onmouseout="out('6446985192446327745');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 622                     String provider = locationManager.getBestProvider(criteria, false);                  </span>
<span class="-8436409377687209859" onmouseenter="enter('-8436409377687209859');" onmouseout="out('-8436409377687209859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 623                     if (provider != null) {                                                              </span>
<span class="-7314446287342572990" onmouseenter="enter('-7314446287342572990');" onmouseout="out('-7314446287342572990');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 624                         Location lastKnownLocation = locationManager.getLastKnownLocation(provider);     </span>
<span class="8333098492219571100" onmouseenter="enter('8333098492219571100');" onmouseout="out('8333098492219571100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 625                         if (lastKnownLocation != null) {                                                 </span>
<span class="5858379750545562426" onmouseenter="enter('5858379750545562426');" onmouseout="out('5858379750545562426');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 626                             geoPosition.put(&quot;timestamp&quot;, lastKnownLocation.getTime());                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 627                                                                                                          </span>
<span class="-3886576221552081470" onmouseenter="enter('-3886576221552081470');" onmouseout="out('-3886576221552081470');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628                             coords.put(&quot;latitude&quot;, (float) lastKnownLocation.getLatitude());             </span>
<span class="1780277249580908945" onmouseenter="enter('1780277249580908945');" onmouseout="out('1780277249580908945');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629                             coords.put(&quot;longitude&quot;, (float) lastKnownLocation.getLongitude());           </span>
<span class="1952651036571300684" onmouseenter="enter('1952651036571300684');" onmouseout="out('1952651036571300684');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630                             coords.put(&quot;accuracy&quot;, lastKnownLocation.getAccuracy());                     </span>
<span class="-3774793511471938680" onmouseenter="enter('-3774793511471938680');" onmouseout="out('-3774793511471938680');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631                             coords.put(&quot;altitude&quot;, lastKnownLocation.getAltitude());                     </span>
<span class="-8837886391810921688" onmouseenter="enter('-8837886391810921688');" onmouseout="out('-8837886391810921688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632                             coords.put(&quot;speed&quot;, lastKnownLocation.getSpeed());                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 633                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636                                                                                                          </span>
<span class="7469381851935855362" onmouseenter="enter('7469381851935855362');" onmouseout="out('7469381851935855362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637                 geoPosition.put(&quot;coords&quot;, coords);                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638                                                                                                          </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639             } catch (JSONException e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641             }                                                                                            </span>
<span class="-2910369541796689888" onmouseenter="enter('-2910369541796689888');" onmouseout="out('-2910369541796689888');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642             return geoPosition.toString();                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646     @Override                                                                                            </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 647 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 648     public boolean onOptionsItemSelected(MenuItem item) {                                                </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 649         switch (item.getItemId()) {                                                                      </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 650             case android.R.id.home:                                                                      </span>
<span class="-1694655592982141021" onmouseenter="enter('-1694655592982141021');" onmouseout="out('-1694655592982141021');" style=""> 651                 NavUtils.navigateUpFromSameTask(this);                                                   </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 652                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 653         }                                                                                                </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 654         return super.onOptionsItemSelected(item);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 655     }                                                                                                    </span>
<span  style=""> 656                                                                                                          </span>
<span class="2223760692968598534" onmouseenter="enter('2223760692968598534');" onmouseout="out('2223760692968598534');" style=""> 657     private class ActivityJSInterface {                                                                  </span>
<span  style=""> 658                                                                                                          </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style=""> 659         Context mContext;                                                                                </span>
<span  style=""> 660                                                                                                          </span>
<span class="2859735092534969408" onmouseenter="enter('2859735092534969408');" onmouseout="out('2859735092534969408');" style=""> 661         public ActivityJSInterface(Context c) {                                                          </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style=""> 662             mContext = c;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 663         }                                                                                                </span>
<span  style=""> 664                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 665         @JavascriptInterface                                                                             </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style=""> 666         public void closeActivity() {                                                                    </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style=""> 667             NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 668         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 669     }                                                                                                    </span>
<span  style=""> 670                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 671 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-7393740638519443947" onmouseenter="enter('-7393740638519443947');" onmouseout="out('-7393740638519443947');" style="">   1 package nodomain.freeyourgadget.gadgetbridge.activities;                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="3857212678176399715" onmouseenter="enter('3857212678176399715');" onmouseout="out('3857212678176399715');" style="">   3 import android.Manifest;                                                                                 </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5 import android.content.Intent;                                                                           </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   6 import android.content.pm.PackageManager;                                                                </span>
<span class="907171826859240605" onmouseenter="enter('907171826859240605');" onmouseout="out('907171826859240605');" style="">   7 import android.location.Criteria;                                                                        </span>
<span class="-4559785959657295211" onmouseenter="enter('-4559785959657295211');" onmouseout="out('-4559785959657295211');" style="">   8 import android.location.Location;                                                                        </span>
<span class="8236022111747117642" onmouseenter="enter('8236022111747117642');" onmouseout="out('8236022111747117642');" style="">   9 import android.location.LocationManager;                                                                 </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  10 import android.net.Uri;                                                                                  </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  11 import android.os.Build;                                                                                 </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  12 import android.os.Bundle;                                                                                </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="">  13 import android.support.v4.app.ActivityCompat;                                                            </span>
<span class="6797968843617414504" onmouseenter="enter('6797968843617414504');" onmouseout="out('6797968843617414504');" style="">  14 import android.support.v4.app.NavUtils;                                                                  </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  15 import android.view.MenuItem;                                                                            </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  16 import android.view.View;                                                                                </span>
<span class="-6388096999790135816" onmouseenter="enter('-6388096999790135816');" onmouseout="out('-6388096999790135816');" style="">  17 import android.webkit.JavascriptInterface;                                                               </span>
<span class="-1234144701745247801" onmouseenter="enter('-1234144701745247801');" onmouseout="out('-1234144701745247801');" style="">  18 import android.webkit.ValueCallback;                                                                     </span>
<span class="2723690893492346945" onmouseenter="enter('2723690893492346945');" onmouseout="out('2723690893492346945');" style="">  19 import android.webkit.WebView;                                                                           </span>
<span class="619404646788779253" onmouseenter="enter('619404646788779253');" onmouseout="out('619404646788779253');" style="">  20 import android.widget.FrameLayout;                                                                       </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  21 import android.widget.Toast;                                                                             </span>
<span  style="">  22                                                                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  23 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  24 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  25                                                                                                          </span>
<span class="2390503830490498598" onmouseenter="enter('2390503830490498598');" onmouseout="out('2390503830490498598');" style="">  26 import java.util.UUID;                                                                                   </span>
<span  style="">  27                                                                                                          </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  28 import nodomain.freeyourgadget.gadgetbridge.R;                                                           </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  29 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  30 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  31 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-425744571032727695" onmouseenter="enter('-425744571032727695');" onmouseout="out('-425744571032727695');" style="">  32 import nodomain.freeyourgadget.gadgetbridge.util.WebViewSingleton;                                       </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  33 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span  style="">  34                                                                                                          </span>
<span class="8425816362509139849" onmouseenter="enter('8425816362509139849');" onmouseout="out('8425816362509139849');" style="">  35 public class ExternalPebbleJSActivity extends GBActivity {                                               </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  36 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  37                                                                                                          </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  38 ||||||| BASE                                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40                                                                                                          </span>
<span class="255546914543038546" onmouseenter="enter('255546914543038546');" onmouseout="out('255546914543038546');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41   private class JSInterface {                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42                                                                                                          </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43     Context mContext;                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44                                                                                                          </span>
<span class="6103178023340228960" onmouseenter="enter('6103178023340228960');" onmouseout="out('6103178023340228960');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45     public JSInterface(Context c) {                                                                      </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46       mContext = c;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49     @JavascriptInterface                                                                                 </span>
<span class="778974974852788407" onmouseenter="enter('778974974852788407');" onmouseout="out('778974974852788407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50     public void gbLog(String msg) {                                                                      </span>
<span class="3027670622554237141" onmouseenter="enter('3027670622554237141');" onmouseout="out('3027670622554237141');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51       Log.d(&quot;WEBVIEW&quot;, msg);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54     @JavascriptInterface                                                                                 </span>
<span class="-4624663689886901579" onmouseenter="enter('-4624663689886901579');" onmouseout="out('-4624663689886901579');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55     public void sendAppMessage(String msg) {                                                             </span>
<span class="-6201194628403629089" onmouseenter="enter('-6201194628403629089');" onmouseout="out('-6201194628403629089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56       LOG.debug(&quot;from WEBVIEW: &quot; + msg);                                                                 </span>
<span class="-7234772518000694242" onmouseenter="enter('-7234772518000694242');" onmouseout="out('-7234772518000694242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57       JSONObject knownKeys = getAppConfigurationKeys();                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59       try {                                                                                              </span>
<span class="8379171825524475613" onmouseenter="enter('8379171825524475613');" onmouseout="out('8379171825524475613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60         JSONObject in = new JSONObject(msg);                                                             </span>
<span class="3835181569981110952" onmouseenter="enter('3835181569981110952');" onmouseout="out('3835181569981110952');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61         JSONObject out = new JSONObject();                                                               </span>
<span class="-5432090303292230287" onmouseenter="enter('-5432090303292230287');" onmouseout="out('-5432090303292230287');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62         String inKey, outKey;                                                                            </span>
<span class="-6755195952504918332" onmouseenter="enter('-6755195952504918332');" onmouseout="out('-6755195952504918332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63         boolean passKey;                                                                                 </span>
<span class="195888856154758018" onmouseenter="enter('195888856154758018');" onmouseout="out('195888856154758018');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64         for (Iterator&lt;String&gt; key = in.keys(); key.hasNext(); ) {                                        </span>
<span class="35427419901421521" onmouseenter="enter('35427419901421521');" onmouseout="out('35427419901421521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65           passKey = false;                                                                               </span>
<span class="7300242526186641878" onmouseenter="enter('7300242526186641878');" onmouseout="out('7300242526186641878');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66           inKey = key.next();                                                                            </span>
<span class="1625279893230829750" onmouseenter="enter('1625279893230829750');" onmouseout="out('1625279893230829750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67           outKey = null;                                                                                 </span>
<span class="-8000058323286219252" onmouseenter="enter('-8000058323286219252');" onmouseout="out('-8000058323286219252');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68           int pebbleAppIndex = knownKeys.optInt(inKey, -1);                                              </span>
<span class="1318599845650471336" onmouseenter="enter('1318599845650471336');" onmouseout="out('1318599845650471336');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69           if (pebbleAppIndex != -1) {                                                                    </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70             passKey = true;                                                                              </span>
<span class="6093149884609226755" onmouseenter="enter('6093149884609226755');" onmouseout="out('6093149884609226755');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71             outKey = String.valueOf(pebbleAppIndex);                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72           } else {                                                                                       </span>
<span class="1471897956818349080" onmouseenter="enter('1471897956818349080');" onmouseout="out('1471897956818349080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  73             //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-pebblekit-js/ )">  73             //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-peðŸ”µ</abbr></span>
<span class="9182410012949841341" onmouseenter="enter('9182410012949841341');" onmouseout="out('9182410012949841341');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74             Scanner scanner = new Scanner(inKey);                                                        </span>
<span class="3432714770914509184" onmouseenter="enter('3432714770914509184');" onmouseout="out('3432714770914509184');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75             if (scanner.hasNextInt() &amp;&amp; inKey.equals(&quot;&quot; + scanner.nextInt())) {                          </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76               passKey = true;                                                                            </span>
<span class="633307466455829355" onmouseenter="enter('633307466455829355');" onmouseout="out('633307466455829355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77               outKey = inKey;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79           }                                                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80                                                                                                          </span>
<span class="7100715742750083788" onmouseenter="enter('7100715742750083788');" onmouseout="out('7100715742750083788');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81           if (passKey) {                                                                                 </span>
<span class="-1814814172109868162" onmouseenter="enter('-1814814172109868162');" onmouseout="out('-1814814172109868162');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82             Object obj = in.get(inKey);                                                                  </span>
<span class="-2516604200979810702" onmouseenter="enter('-2516604200979810702');" onmouseout="out('-2516604200979810702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83             if (obj instanceof Boolean) {                                                                </span>
<span class="3988738952494779303" onmouseenter="enter('3988738952494779303');" onmouseout="out('3988738952494779303');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84               obj = ((Boolean) obj) ? &quot;true&quot; : &quot;false&quot;;                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85             }                                                                                            </span>
<span class="7889737448406399667" onmouseenter="enter('7889737448406399667');" onmouseout="out('7889737448406399667');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86             out.put(outKey, obj);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87           } else {                                                                                       </span>
<span class="-2054330584630270669" onmouseenter="enter('-2054330584630270669');" onmouseout="out('-2054330584630270669');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  88             GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an integer key.&quot;, Toast.LENGTH_SHORT, GB.WARN);">  88             GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an intðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89           }                                                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91         }                                                                                                </span>
<span class="-881732067758657379" onmouseenter="enter('-881732067758657379');" onmouseout="out('-881732067758657379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92         LOG.info(out.toString());                                                                        </span>
<span class="-2343027273789634583" onmouseenter="enter('-2343027273789634583');" onmouseout="out('-2343027273789634583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93         GBApplication.deviceService().onAppConfiguration(appUuid, out.toString());                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94                                                                                                          </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95       } catch (JSONException e) {                                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100     @JavascriptInterface                                                                                 </span>
<span class="-5632539219238112893" onmouseenter="enter('-5632539219238112893');" onmouseout="out('-5632539219238112893');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101     public String getActiveWatchInfo() {                                                                 </span>
<span class="-843298888064131140" onmouseenter="enter('-843298888064131140');" onmouseout="out('-843298888064131140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102       JSONObject wi = new JSONObject();                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103       try {                                                                                              </span>
<span class="-7073207729972829278" onmouseenter="enter('-7073207729972829278');" onmouseout="out('-7073207729972829278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104         wi.put(&quot;firmware&quot;, mGBDevice.getFirmwareVersion());                                              </span>
<span class="1619143394428866421" onmouseenter="enter('1619143394428866421');" onmouseout="out('1619143394428866421');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105         wi.put(&quot;platform&quot;, PebbleUtils.getPlatformName(mGBDevice.getModel()));                           </span>
<span class="-5437394903337435394" onmouseenter="enter('-5437394903337435394');" onmouseout="out('-5437394903337435394');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106         wi.put(&quot;model&quot;, PebbleUtils.getModel(mGBDevice.getModel()));                                     </span>
<span class="6629264299746547541" onmouseenter="enter('6629264299746547541');" onmouseout="out('6629264299746547541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107         //TODO: use real info                                                                            </span>
<span class="118738678871371777" onmouseenter="enter('118738678871371777');" onmouseout="out('118738678871371777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108         wi.put(&quot;language&quot;, &quot;en&quot;);                                                                        </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109       } catch (JSONException e) {                                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111       }                                                                                                  </span>
<span class="2996545006566015873" onmouseenter="enter('2996545006566015873');" onmouseout="out('2996545006566015873');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112       //Json not supported apparently, we need to cast back and forth                                    </span>
<span class="5839065679891034244" onmouseenter="enter('5839065679891034244');" onmouseout="out('5839065679891034244');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113       return wi.toString();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116     @JavascriptInterface                                                                                 </span>
<span class="-856046329422320734" onmouseenter="enter('-856046329422320734');" onmouseout="out('-856046329422320734');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117     public String getAppConfigurationFile() {                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118       try {                                                                                              </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119         File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                         </span>
<span class="-6190799366778164723" onmouseenter="enter('-6190799366778164723');" onmouseout="out('-6190799366778164723');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120         File configurationFile = new File(destDir, appUuid.toString() + &quot;_config.js&quot;);                   </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121         if (configurationFile.exists()) {                                                                </span>
<span class="-736461147530501961" onmouseenter="enter('-736461147530501961');" onmouseout="out('-736461147530501961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122           return &quot;file:///&quot; + configurationFile.getAbsolutePath();                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123         }                                                                                                </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124       } catch (IOException e) {                                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126       }                                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127       return null;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130     @JavascriptInterface                                                                                 </span>
<span class="7186673836371686422" onmouseenter="enter('7186673836371686422');" onmouseout="out('7186673836371686422');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131     public String getAppStoredPreset() {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132       try {                                                                                              </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133         File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                         </span>
<span class="-1650511077982903195" onmouseenter="enter('-1650511077982903195');" onmouseout="out('-1650511077982903195');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134         File configurationFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                 </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135         if (configurationFile.exists()) {                                                                </span>
<span class="-4631811320466918610" onmouseenter="enter('-4631811320466918610');" onmouseout="out('-4631811320466918610');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136           return FileUtils.getStringFromFile(configurationFile);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137         }                                                                                                </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138       } catch (IOException e) {                                                                          </span>
<span class="-1248445865590398413" onmouseenter="enter('-1248445865590398413');" onmouseout="out('-1248445865590398413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139         GB.toast(&quot;Error reading presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141       }                                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142       return null;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145     @JavascriptInterface                                                                                 </span>
<span class="-6701887776194876087" onmouseenter="enter('-6701887776194876087');" onmouseout="out('-6701887776194876087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146     public void saveAppStoredPreset(String msg) {                                                        </span>
<span class="-192245887358676257" onmouseenter="enter('-192245887358676257');" onmouseout="out('-192245887358676257');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147       Writer writer;                                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149       try {                                                                                              </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150         File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                         </span>
<span class="3603668645457989644" onmouseenter="enter('3603668645457989644');" onmouseout="out('3603668645457989644');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151         File presetsFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                       </span>
<span class="-2643535316378223379" onmouseenter="enter('-2643535316378223379');" onmouseout="out('-2643535316378223379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152         writer = new BufferedWriter(new FileWriter(presetsFile));                                        </span>
<span class="-5700221122508670675" onmouseenter="enter('-5700221122508670675');" onmouseout="out('-5700221122508670675');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153         writer.write(msg);                                                                               </span>
<span class="4330639758910844474" onmouseenter="enter('4330639758910844474');" onmouseout="out('4330639758910844474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154         writer.close();                                                                                  </span>
<span class="-850015778348175113" onmouseenter="enter('-850015778348175113');" onmouseout="out('-850015778348175113');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155         GB.toast(&quot;Presets stored&quot;, Toast.LENGTH_SHORT, GB.INFO);                                         </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156       } catch (IOException e) {                                                                          </span>
<span class="-4875214328390419177" onmouseenter="enter('-4875214328390419177');" onmouseout="out('-4875214328390419177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157         GB.toast(&quot;Error storing presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162     @JavascriptInterface                                                                                 </span>
<span class="-8118311426044261956" onmouseenter="enter('-8118311426044261956');" onmouseout="out('-8118311426044261956');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163     public String getAppUUID() {                                                                         </span>
<span class="-5609100198503319527" onmouseenter="enter('-5609100198503319527');" onmouseout="out('-5609100198503319527');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164       return appUuid.toString();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167     @JavascriptInterface                                                                                 </span>
<span class="-2024961006635561560" onmouseenter="enter('-2024961006635561560');" onmouseout="out('-2024961006635561560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168     public String getAppLocalstoragePrefix() {                                                           </span>
<span class="-139042831100003478" onmouseenter="enter('-139042831100003478');" onmouseout="out('-139042831100003478');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169       String prefix = mGBDevice.getAddress() + appUuid.toString();                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170       try {                                                                                              </span>
<span class="1589472625916860471" onmouseenter="enter('1589472625916860471');" onmouseout="out('1589472625916860471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171         MessageDigest digest = MessageDigest.getInstance(&quot;SHA-1&quot;);                                       </span>
<span class="-1715536820593379285" onmouseenter="enter('-1715536820593379285');" onmouseout="out('-1715536820593379285');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172         byte[] bytes = prefix.getBytes(&quot;UTF-8&quot;);                                                         </span>
<span class="-6693486492020146741" onmouseenter="enter('-6693486492020146741');" onmouseout="out('-6693486492020146741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173         digest.update(bytes, 0, bytes.length);                                                           </span>
<span class="-4062246525168346439" onmouseenter="enter('-4062246525168346439');" onmouseout="out('-4062246525168346439');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174         bytes = digest.digest();                                                                         </span>
<span class="1334999931346445764" onmouseenter="enter('1334999931346445764');" onmouseout="out('1334999931346445764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175         final StringBuilder sb = new StringBuilder();                                                    </span>
<span class="-7387509961039532833" onmouseenter="enter('-7387509961039532833');" onmouseout="out('-7387509961039532833');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176         for (int i = 0; i &lt; bytes.length; i++) {                                                         </span>
<span class="7651397204661452382" onmouseenter="enter('7651397204661452382');" onmouseout="out('7651397204661452382');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177           sb.append(String.format(&quot;%02X&quot;, bytes[i]));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178         }                                                                                                </span>
<span class="6091843332607413306" onmouseenter="enter('6091843332607413306');" onmouseout="out('6091843332607413306');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179         return sb.toString().toLowerCase();                                                              </span>
<span class="5663120823918718146" onmouseenter="enter('5663120823918718146');" onmouseout="out('5663120823918718146');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180       } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {                              </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181         e.printStackTrace();                                                                             </span>
<span class="-5295149366119702820" onmouseenter="enter('-5295149366119702820');" onmouseout="out('-5295149366119702820');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182         return prefix;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186     @JavascriptInterface                                                                                 </span>
<span class="6682389599781806833" onmouseenter="enter('6682389599781806833');" onmouseout="out('6682389599781806833');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187     public String getWatchToken() {                                                                      </span>
<span class="588975967419017208" onmouseenter="enter('588975967419017208');" onmouseout="out('588975967419017208');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 188       //specification says: A string that is guaranteed to be identical for each Pebble device for the same app across different mobile devices. The token is unique to your app and cannot be used to track Pebble devices across applications. see https://developer.pebble.com/docs/js/Pebble/"> 188       //specification says: A string that is guaranteed to be identical for each Pebble device for the saðŸ”µ</abbr></span>
<span class="1141582625581442566" onmouseenter="enter('1141582625581442566');" onmouseout="out('1141582625581442566');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189       return &quot;gb&quot; + appUuid.toString();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192     @JavascriptInterface                                                                                 </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193     public void closeActivity() {                                                                        </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194       NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196   }                                                                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 197 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 198                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 199                                                                                                          </span>
<span class="255546914543038546" onmouseenter="enter('255546914543038546');" onmouseout="out('255546914543038546');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 200   private class JSInterface {                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 201                                                                                                          </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 202     Context mContext;                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 203                                                                                                          </span>
<span class="6103178023340228960" onmouseenter="enter('6103178023340228960');" onmouseout="out('6103178023340228960');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 204     public JSInterface(Context c) {                                                                      </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 205       mContext = c;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 206     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 207                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 208     @JavascriptInterface                                                                                 </span>
<span class="778974974852788407" onmouseenter="enter('778974974852788407');" onmouseout="out('778974974852788407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 209     public void gbLog(String msg) {                                                                      </span>
<span class="3027670622554237141" onmouseenter="enter('3027670622554237141');" onmouseout="out('3027670622554237141');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 210       Log.d(&quot;WEBVIEW&quot;, msg);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 211     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213     @JavascriptInterface                                                                                 </span>
<span class="-4624663689886901579" onmouseenter="enter('-4624663689886901579');" onmouseout="out('-4624663689886901579');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214     public void sendAppMessage(String msg) {                                                             </span>
<span class="-6201194628403629089" onmouseenter="enter('-6201194628403629089');" onmouseout="out('-6201194628403629089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215       LOG.debug(&quot;from WEBVIEW: &quot; + msg);                                                                 </span>
<span class="-7234772518000694242" onmouseenter="enter('-7234772518000694242');" onmouseout="out('-7234772518000694242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216       JSONObject knownKeys = getAppConfigurationKeys();                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218       try {                                                                                              </span>
<span class="8379171825524475613" onmouseenter="enter('8379171825524475613');" onmouseout="out('8379171825524475613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219         JSONObject in = new JSONObject(msg);                                                             </span>
<span class="3835181569981110952" onmouseenter="enter('3835181569981110952');" onmouseout="out('3835181569981110952');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220         JSONObject out = new JSONObject();                                                               </span>
<span class="-5432090303292230287" onmouseenter="enter('-5432090303292230287');" onmouseout="out('-5432090303292230287');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221         String inKey, outKey;                                                                            </span>
<span class="-6755195952504918332" onmouseenter="enter('-6755195952504918332');" onmouseout="out('-6755195952504918332');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 222         boolean passKey;                                                                                 </span>
<span class="195888856154758018" onmouseenter="enter('195888856154758018');" onmouseout="out('195888856154758018');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223         for (Iterator&lt;String&gt; key = in.keys(); key.hasNext(); ) {                                        </span>
<span class="35427419901421521" onmouseenter="enter('35427419901421521');" onmouseout="out('35427419901421521');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224           passKey = false;                                                                               </span>
<span class="7300242526186641878" onmouseenter="enter('7300242526186641878');" onmouseout="out('7300242526186641878');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225           inKey = key.next();                                                                            </span>
<span class="1625279893230829750" onmouseenter="enter('1625279893230829750');" onmouseout="out('1625279893230829750');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226           outKey = null;                                                                                 </span>
<span class="-8000058323286219252" onmouseenter="enter('-8000058323286219252');" onmouseout="out('-8000058323286219252');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227           int pebbleAppIndex = knownKeys.optInt(inKey, -1);                                              </span>
<span class="1318599845650471336" onmouseenter="enter('1318599845650471336');" onmouseout="out('1318599845650471336');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228           if (pebbleAppIndex != -1) {                                                                    </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229             passKey = true;                                                                              </span>
<span class="6093149884609226755" onmouseenter="enter('6093149884609226755');" onmouseout="out('6093149884609226755');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230             outKey = String.valueOf(pebbleAppIndex);                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231           } else {                                                                                       </span>
<span class="1471897956818349080" onmouseenter="enter('1471897956818349080');" onmouseout="out('1471897956818349080');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 232             //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-pebblekit-js/ )"> 232             //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-peðŸ”µ</abbr></span>
<span class="9182410012949841341" onmouseenter="enter('9182410012949841341');" onmouseout="out('9182410012949841341');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233             Scanner scanner = new Scanner(inKey);                                                        </span>
<span class="3432714770914509184" onmouseenter="enter('3432714770914509184');" onmouseout="out('3432714770914509184');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234             if (scanner.hasNextInt() &amp;&amp; inKey.equals(&quot;&quot; + scanner.nextInt())) {                          </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235               passKey = true;                                                                            </span>
<span class="633307466455829355" onmouseenter="enter('633307466455829355');" onmouseout="out('633307466455829355');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236               outKey = inKey;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238           }                                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239                                                                                                          </span>
<span class="7100715742750083788" onmouseenter="enter('7100715742750083788');" onmouseout="out('7100715742750083788');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240           if (passKey) {                                                                                 </span>
<span class="-1814814172109868162" onmouseenter="enter('-1814814172109868162');" onmouseout="out('-1814814172109868162');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241             Object obj = in.get(inKey);                                                                  </span>
<span class="-2516604200979810702" onmouseenter="enter('-2516604200979810702');" onmouseout="out('-2516604200979810702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242             if (obj instanceof Boolean) {                                                                </span>
<span class="3988738952494779303" onmouseenter="enter('3988738952494779303');" onmouseout="out('3988738952494779303');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243               obj = ((Boolean) obj) ? &quot;true&quot; : &quot;false&quot;;                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244             }                                                                                            </span>
<span class="7889737448406399667" onmouseenter="enter('7889737448406399667');" onmouseout="out('7889737448406399667');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245             out.put(outKey, obj);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246           } else {                                                                                       </span>
<span class="-2054330584630270669" onmouseenter="enter('-2054330584630270669');" onmouseout="out('-2054330584630270669');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 247             GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an integer key.&quot;, Toast.LENGTH_SHORT, GB.WARN);"> 247             GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an intðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248           }                                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 249                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250         }                                                                                                </span>
<span class="-881732067758657379" onmouseenter="enter('-881732067758657379');" onmouseout="out('-881732067758657379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251         LOG.info(out.toString());                                                                        </span>
<span class="-2343027273789634583" onmouseenter="enter('-2343027273789634583');" onmouseout="out('-2343027273789634583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252         GBApplication.deviceService().onAppConfiguration(appUuid, out.toString());                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253                                                                                                          </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254       } catch (JSONException e) {                                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259     @JavascriptInterface                                                                                 </span>
<span class="-5632539219238112893" onmouseenter="enter('-5632539219238112893');" onmouseout="out('-5632539219238112893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 260     public String getActiveWatchInfo() {                                                                 </span>
<span class="-843298888064131140" onmouseenter="enter('-843298888064131140');" onmouseout="out('-843298888064131140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261       JSONObject wi = new JSONObject();                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262       try {                                                                                              </span>
<span class="-7073207729972829278" onmouseenter="enter('-7073207729972829278');" onmouseout="out('-7073207729972829278');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263         wi.put(&quot;firmware&quot;, mGBDevice.getFirmwareVersion());                                              </span>
<span class="1619143394428866421" onmouseenter="enter('1619143394428866421');" onmouseout="out('1619143394428866421');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264         wi.put(&quot;platform&quot;, PebbleUtils.getPlatformName(mGBDevice.getModel()));                           </span>
<span class="-5437394903337435394" onmouseenter="enter('-5437394903337435394');" onmouseout="out('-5437394903337435394');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265         wi.put(&quot;model&quot;, PebbleUtils.getModel(mGBDevice.getModel()));                                     </span>
<span class="6629264299746547541" onmouseenter="enter('6629264299746547541');" onmouseout="out('6629264299746547541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 266         //TODO: use real info                                                                            </span>
<span class="118738678871371777" onmouseenter="enter('118738678871371777');" onmouseout="out('118738678871371777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 267         wi.put(&quot;language&quot;, &quot;en&quot;);                                                                        </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 268       } catch (JSONException e) {                                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 269         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 270       }                                                                                                  </span>
<span class="2996545006566015873" onmouseenter="enter('2996545006566015873');" onmouseout="out('2996545006566015873');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 271       //Json not supported apparently, we need to cast back and forth                                    </span>
<span class="5839065679891034244" onmouseenter="enter('5839065679891034244');" onmouseout="out('5839065679891034244');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 272       return wi.toString();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 273     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 274                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 275     @JavascriptInterface                                                                                 </span>
<span class="-856046329422320734" onmouseenter="enter('-856046329422320734');" onmouseout="out('-856046329422320734');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 276     public String getAppConfigurationFile() {                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 277       try {                                                                                              </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 278         File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                         </span>
<span class="-6190799366778164723" onmouseenter="enter('-6190799366778164723');" onmouseout="out('-6190799366778164723');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 279         File configurationFile = new File(destDir, appUuid.toString() + &quot;_config.js&quot;);                   </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 280         if (configurationFile.exists()) {                                                                </span>
<span class="-736461147530501961" onmouseenter="enter('-736461147530501961');" onmouseout="out('-736461147530501961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 281           return &quot;file:///&quot; + configurationFile.getAbsolutePath();                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 282         }                                                                                                </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 283       } catch (IOException e) {                                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 285       }                                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 286       return null;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 287     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 288                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 289     @JavascriptInterface                                                                                 </span>
<span class="7186673836371686422" onmouseenter="enter('7186673836371686422');" onmouseout="out('7186673836371686422');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 290     public String getAppStoredPreset() {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 291       try {                                                                                              </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292         File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                         </span>
<span class="-1650511077982903195" onmouseenter="enter('-1650511077982903195');" onmouseout="out('-1650511077982903195');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293         File configurationFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                 </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 294         if (configurationFile.exists()) {                                                                </span>
<span class="-4631811320466918610" onmouseenter="enter('-4631811320466918610');" onmouseout="out('-4631811320466918610');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295           return FileUtils.getStringFromFile(configurationFile);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296         }                                                                                                </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297       } catch (IOException e) {                                                                          </span>
<span class="-1248445865590398413" onmouseenter="enter('-1248445865590398413');" onmouseout="out('-1248445865590398413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298         GB.toast(&quot;Error reading presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 299         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 300       }                                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 301       return null;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304     @JavascriptInterface                                                                                 </span>
<span class="-6701887776194876087" onmouseenter="enter('-6701887776194876087');" onmouseout="out('-6701887776194876087');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305     public void saveAppStoredPreset(String msg) {                                                        </span>
<span class="-192245887358676257" onmouseenter="enter('-192245887358676257');" onmouseout="out('-192245887358676257');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306       Writer writer;                                                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 308       try {                                                                                              </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 309         File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                         </span>
<span class="3603668645457989644" onmouseenter="enter('3603668645457989644');" onmouseout="out('3603668645457989644');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 310         File presetsFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                       </span>
<span class="-2643535316378223379" onmouseenter="enter('-2643535316378223379');" onmouseout="out('-2643535316378223379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 311         writer = new BufferedWriter(new FileWriter(presetsFile));                                        </span>
<span class="-5700221122508670675" onmouseenter="enter('-5700221122508670675');" onmouseout="out('-5700221122508670675');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312         writer.write(msg);                                                                               </span>
<span class="4330639758910844474" onmouseenter="enter('4330639758910844474');" onmouseout="out('4330639758910844474');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 313         writer.close();                                                                                  </span>
<span class="-850015778348175113" onmouseenter="enter('-850015778348175113');" onmouseout="out('-850015778348175113');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 314         GB.toast(&quot;Presets stored&quot;, Toast.LENGTH_SHORT, GB.INFO);                                         </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315       } catch (IOException e) {                                                                          </span>
<span class="-4875214328390419177" onmouseenter="enter('-4875214328390419177');" onmouseout="out('-4875214328390419177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 316         GB.toast(&quot;Error storing presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 317         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321     @JavascriptInterface                                                                                 </span>
<span class="-8118311426044261956" onmouseenter="enter('-8118311426044261956');" onmouseout="out('-8118311426044261956');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322     public String getAppUUID() {                                                                         </span>
<span class="-5609100198503319527" onmouseenter="enter('-5609100198503319527');" onmouseout="out('-5609100198503319527');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323       return appUuid.toString();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 324     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 325                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 326     @JavascriptInterface                                                                                 </span>
<span class="-2024961006635561560" onmouseenter="enter('-2024961006635561560');" onmouseout="out('-2024961006635561560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 327     public String getAppLocalstoragePrefix() {                                                           </span>
<span class="-139042831100003478" onmouseenter="enter('-139042831100003478');" onmouseout="out('-139042831100003478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 328       String prefix = mGBDevice.getAddress() + appUuid.toString();                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 329       try {                                                                                              </span>
<span class="1589472625916860471" onmouseenter="enter('1589472625916860471');" onmouseout="out('1589472625916860471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 330         MessageDigest digest = MessageDigest.getInstance(&quot;SHA-1&quot;);                                       </span>
<span class="-1715536820593379285" onmouseenter="enter('-1715536820593379285');" onmouseout="out('-1715536820593379285');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331         byte[] bytes = prefix.getBytes(&quot;UTF-8&quot;);                                                         </span>
<span class="-6693486492020146741" onmouseenter="enter('-6693486492020146741');" onmouseout="out('-6693486492020146741');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 332         digest.update(bytes, 0, bytes.length);                                                           </span>
<span class="-4062246525168346439" onmouseenter="enter('-4062246525168346439');" onmouseout="out('-4062246525168346439');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333         bytes = digest.digest();                                                                         </span>
<span class="1334999931346445764" onmouseenter="enter('1334999931346445764');" onmouseout="out('1334999931346445764');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 334         final StringBuilder sb = new StringBuilder();                                                    </span>
<span class="-7387509961039532833" onmouseenter="enter('-7387509961039532833');" onmouseout="out('-7387509961039532833');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 335         for (int i = 0; i &lt; bytes.length; i++) {                                                         </span>
<span class="7651397204661452382" onmouseenter="enter('7651397204661452382');" onmouseout="out('7651397204661452382');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336           sb.append(String.format(&quot;%02X&quot;, bytes[i]));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 337         }                                                                                                </span>
<span class="6091843332607413306" onmouseenter="enter('6091843332607413306');" onmouseout="out('6091843332607413306');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 338         return sb.toString().toLowerCase();                                                              </span>
<span class="5663120823918718146" onmouseenter="enter('5663120823918718146');" onmouseout="out('5663120823918718146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 339       } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {                              </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 340         e.printStackTrace();                                                                             </span>
<span class="-5295149366119702820" onmouseenter="enter('-5295149366119702820');" onmouseout="out('-5295149366119702820');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 341         return prefix;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 342       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 343     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 344                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 345     @JavascriptInterface                                                                                 </span>
<span class="6682389599781806833" onmouseenter="enter('6682389599781806833');" onmouseout="out('6682389599781806833');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 346     public String getWatchToken() {                                                                      </span>
<span class="588975967419017208" onmouseenter="enter('588975967419017208');" onmouseout="out('588975967419017208');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 347       //specification says: A string that is guaranteed to be identical for each Pebble device for the same app across different mobile devices. The token is unique to your app and cannot be used to track Pebble devices across applications. see https://developer.pebble.com/docs/js/Pebble/"> 347       //specification says: A string that is guaranteed to be identical for each Pebble device for the saðŸ”µ</abbr></span>
<span class="1141582625581442566" onmouseenter="enter('1141582625581442566');" onmouseout="out('1141582625581442566');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 348       return &quot;gb&quot; + appUuid.toString();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 349     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 350                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 351     @JavascriptInterface                                                                                 </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 352     public void closeActivity() {                                                                        </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 353       NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 354     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 355                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 356                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 357     @JavascriptInterface                                                                                 </span>
<span class="-5039914046281084423" onmouseenter="enter('-5039914046281084423');" onmouseout="out('-5039914046281084423');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 358     public String getCurrentPosition() {                                                                 </span>
<span class="-149413150381439412" onmouseenter="enter('-149413150381439412');" onmouseout="out('-149413150381439412');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 359       if (!isLocationEnabledForWatchApp()) {                                                             </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 360         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 361       }                                                                                                  </span>
<span class="8227519164768398763" onmouseenter="enter('8227519164768398763');" onmouseout="out('8227519164768398763');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 362       //we need to override this because the coarse location is not enough for the android webview, we should add the permission for fine location."> 362       //we need to override this because the coarse location is not enough for the android webview, we shðŸ”µ</abbr></span>
<span class="7572894489807780729" onmouseenter="enter('7572894489807780729');" onmouseout="out('7572894489807780729');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 363       JSONObject geoPosition = new JSONObject();                                                         </span>
<span class="-8852470018621524217" onmouseenter="enter('-8852470018621524217');" onmouseout="out('-8852470018621524217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 364       JSONObject coords = new JSONObject();                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 365       try {                                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 366                                                                                                          </span>
<span class="7576815700871527587" onmouseenter="enter('7576815700871527587');" onmouseout="out('7576815700871527587');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 367         Prefs prefs = GBApplication.getPrefs();                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 368                                                                                                          </span>
<span class="-2804823070089201012" onmouseenter="enter('-2804823070089201012');" onmouseout="out('-2804823070089201012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 369         geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know this value is really old"> 369         geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know this valðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370                                                                                                          </span>
<span class="6245247748368740564" onmouseenter="enter('6245247748368740564');" onmouseout="out('6245247748368740564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371         coords.put(&quot;latitude&quot;, prefs.getFloat(&quot;location_latitude&quot;, 0));                                  </span>
<span class="-2550975770164595754" onmouseenter="enter('-2550975770164595754');" onmouseout="out('-2550975770164595754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 372         coords.put(&quot;longitude&quot;, prefs.getFloat(&quot;location_longitude&quot;, 0));                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 373                                                                                                          </span>
<span class="-2595111342414270158" onmouseenter="enter('-2595111342414270158');" onmouseout="out('-2595111342414270158');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 374         if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED &amp;&amp;"> 374         if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESS_COARSEðŸ”µ</abbr></span>
<span class="-6892731487308770176" onmouseenter="enter('-6892731487308770176');" onmouseout="out('-6892731487308770176');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 375             prefs.getBoolean(&quot;use_updated_location_if_available&quot;, false)) {                              </span>
<span class="3465319766909019165" onmouseenter="enter('3465319766909019165');" onmouseout="out('3465319766909019165');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 376           LocationManager locationManager = (LocationManager) getApplicationContext().getSystemService(Context.LOCATION_SERVICE);"> 376           LocationManager locationManager = (LocationManager) getApplicationContext().getSystemService(CoðŸ”µ</abbr></span>
<span class="-840377409278335695" onmouseenter="enter('-840377409278335695');" onmouseout="out('-840377409278335695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377           Criteria criteria = new Criteria();                                                            </span>
<span class="6446985192446327745" onmouseenter="enter('6446985192446327745');" onmouseout="out('6446985192446327745');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 378           String provider = locationManager.getBestProvider(criteria, false);                            </span>
<span class="-8436409377687209859" onmouseenter="enter('-8436409377687209859');" onmouseout="out('-8436409377687209859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379           if (provider != null) {                                                                        </span>
<span class="-7314446287342572990" onmouseenter="enter('-7314446287342572990');" onmouseout="out('-7314446287342572990');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380             Location lastKnownLocation = locationManager.getLastKnownLocation(provider);                 </span>
<span class="8333098492219571100" onmouseenter="enter('8333098492219571100');" onmouseout="out('8333098492219571100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 381             if (lastKnownLocation != null) {                                                             </span>
<span class="5858379750545562426" onmouseenter="enter('5858379750545562426');" onmouseout="out('5858379750545562426');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 382               geoPosition.put(&quot;timestamp&quot;, lastKnownLocation.getTime());                                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 383                                                                                                          </span>
<span class="-3886576221552081470" onmouseenter="enter('-3886576221552081470');" onmouseout="out('-3886576221552081470');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 384               coords.put(&quot;latitude&quot;, (float) lastKnownLocation.getLatitude());                           </span>
<span class="1780277249580908945" onmouseenter="enter('1780277249580908945');" onmouseout="out('1780277249580908945');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 385               coords.put(&quot;longitude&quot;, (float) lastKnownLocation.getLongitude());                         </span>
<span class="1952651036571300684" onmouseenter="enter('1952651036571300684');" onmouseout="out('1952651036571300684');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 386               coords.put(&quot;accuracy&quot;, lastKnownLocation.getAccuracy());                                   </span>
<span class="-3774793511471938680" onmouseenter="enter('-3774793511471938680');" onmouseout="out('-3774793511471938680');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 387               coords.put(&quot;altitude&quot;, lastKnownLocation.getAltitude());                                   </span>
<span class="-8837886391810921688" onmouseenter="enter('-8837886391810921688');" onmouseout="out('-8837886391810921688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 388               coords.put(&quot;speed&quot;, lastKnownLocation.getSpeed());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 389             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 390           }                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 391         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 392                                                                                                          </span>
<span class="7469381851935855362" onmouseenter="enter('7469381851935855362');" onmouseout="out('7469381851935855362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 393         geoPosition.put(&quot;coords&quot;, coords);                                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 394                                                                                                          </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 395       } catch (JSONException e) {                                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396         e.printStackTrace();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 397       }                                                                                                  </span>
<span class="-2910369541796689888" onmouseenter="enter('-2910369541796689888');" onmouseout="out('-2910369541796689888');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 398       return geoPosition.toString();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 399     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 400   }                                                                                                      </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 401 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 402                                                                                                          </span>
<span class="8136098019960083823" onmouseenter="enter('8136098019960083823');" onmouseout="out('8136098019960083823');" style=""> 403     private static final Logger LOG = LoggerFactory.getLogger(ExternalPebbleJSActivity.class);           </span>
<span  style=""> 404                                                                                                          </span>
<span class="3065437899111201345" onmouseenter="enter('3065437899111201345');" onmouseout="out('3065437899111201345');" style=""> 405     private UUID appUuid;                                                                                </span>
<span class="9027266421678696690" onmouseenter="enter('9027266421678696690');" onmouseout="out('9027266421678696690');" style=""> 406     private Uri confUri;                                                                                 </span>
<span class="-5535852384441440556" onmouseenter="enter('-5535852384441440556');" onmouseout="out('-5535852384441440556');" style=""> 407     private GBDevice mGBDevice = null;                                                                   </span>
<span class="6615780427500382937" onmouseenter="enter('6615780427500382937');" onmouseout="out('6615780427500382937');" style=""> 408     private WebView myWebView;                                                                           </span>
<span  style=""> 409                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 410     @Override                                                                                            </span>
<span class="6892052666771236398" onmouseenter="enter('6892052666771236398');" onmouseout="out('6892052666771236398');" style=""> 411     protected void onCreate(Bundle savedInstanceState) {                                                 </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 412         super.onCreate(savedInstanceState);                                                              </span>
<span  style=""> 413                                                                                                          </span>
<span class="-871894361009470891" onmouseenter="enter('-871894361009470891');" onmouseout="out('-871894361009470891');" style=""> 414         Bundle extras = getIntent().getExtras();                                                         </span>
<span class="8849338589512660035" onmouseenter="enter('8849338589512660035');" onmouseout="out('8849338589512660035');" style=""> 415         if (extras != null) {                                                                            </span>
<span class="3724295817671341281" onmouseenter="enter('3724295817671341281');" onmouseout="out('3724295817671341281');" style=""> 416             mGBDevice = extras.getParcelable(GBDevice.EXTRA_DEVICE);                                     </span>
<span class="2716088159317727473" onmouseenter="enter('2716088159317727473');" onmouseout="out('2716088159317727473');" style=""> 417             appUuid = (UUID) extras.getSerializable(DeviceService.EXTRA_APP_UUID);                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 418         } else {                                                                                         </span>
<span class="496962713155353134" onmouseenter="enter('496962713155353134');" onmouseout="out('496962713155353134');" style=""> 419             throw new IllegalArgumentException(&quot;Must provide a device when invoking this activity&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420         }                                                                                                </span>
<span  style=""> 421                                                                                                          </span>
<span class="8370604561035257296" onmouseenter="enter('8370604561035257296');" onmouseout="out('8370604561035257296');" style=""> 422         setContentView(R.layout.activity_external_pebble_js);                                            </span>
<span  style=""> 423                                                                                                          </span>
<span class="8982719199826339359" onmouseenter="enter('8982719199826339359');" onmouseout="out('8982719199826339359');" style=""> 424         myWebView = WebViewSingleton.getorInitWebView(this, mGBDevice, appUuid);                         </span>
<span class="6894061798627554793" onmouseenter="enter('6894061798627554793');" onmouseout="out('6894061798627554793');" style=""> 425         myWebView.setWillNotDraw(false);                                                                 </span>
<span class="-8818851797244187743" onmouseenter="enter('-8818851797244187743');" onmouseout="out('-8818851797244187743');" style=""><abbr title=" 426         myWebView.addJavascriptInterface(new ActivityJSInterface(ExternalPebbleJSActivity.this), &quot;GBActivity&quot;);"> 426         myWebView.addJavascriptInterface(new ActivityJSInterface(ExternalPebbleJSActivity.this), &quot;GBActivðŸ”µ</abbr></span>
<span class="7079593887772041495" onmouseenter="enter('7079593887772041495');" onmouseout="out('7079593887772041495');" style=""> 427         FrameLayout fl = (FrameLayout) findViewById(R.id.webview_placeholder);                           </span>
<span class="-4001555273714846720" onmouseenter="enter('-4001555273714846720');" onmouseout="out('-4001555273714846720');" style=""> 428         fl.addView(myWebView);                                                                           </span>
<span  style=""> 429                                                                                                          </span>
<span  style=""> 430                                                                                                          </span>
<span class="5697070782885285202" onmouseenter="enter('5697070782885285202');" onmouseout="out('5697070782885285202');" style=""> 431         myWebView.addOnAttachStateChangeListener(new View.OnAttachStateChangeListener() {                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 432             @Override                                                                                    </span>
<span class="-5576845663046859066" onmouseenter="enter('-5576845663046859066');" onmouseout="out('-5576845663046859066');" style=""> 433             public void onViewAttachedToWindow(View v) {                                                 </span>
<span  style=""> 434                                                                                                          </span>
<span  style=""> 435                                                                                                          </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style=""> 436                 if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                               </span>
<span class="4771517920709256525" onmouseenter="enter('4771517920709256525');" onmouseout="out('4771517920709256525');" style=""> 437                     // chromium, enable hardware acceleration                                            </span>
<span class="-8172250518187697323" onmouseenter="enter('-8172250518187697323');" onmouseout="out('-8172250518187697323');" style=""> 438                     v.setLayerType(View.LAYER_TYPE_HARDWARE, null);                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 439                 } else {                                                                                 </span>
<span class="-1721106037310283892" onmouseenter="enter('-1721106037310283892');" onmouseout="out('-1721106037310283892');" style=""> 440                     // older android version, disable hardware acceleration                              </span>
<span class="1424411202877530232" onmouseenter="enter('1424411202877530232');" onmouseout="out('1424411202877530232');" style=""> 441                     v.setLayerType(View.LAYER_TYPE_SOFTWARE, null);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442                 }                                                                                        </span>
<span  style=""> 443                                                                                                          </span>
<span  style=""> 444                                                                                                          </span>
<span class="-1033981458626162610" onmouseenter="enter('-1033981458626162610');" onmouseout="out('-1033981458626162610');" style=""> 445                 String queryString = &quot;&quot;;                                                                 </span>
<span class="-2276587090849303814" onmouseenter="enter('-2276587090849303814');" onmouseout="out('-2276587090849303814');" style=""> 446                 if (confUri != null) {                                                                   </span>
<span class="-1088791743364895452" onmouseenter="enter('-1088791743364895452');" onmouseout="out('-1088791743364895452');" style=""> 447                     //getting back with configuration data                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 448                     try {                                                                                </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style=""> 449                         appUuid = UUID.fromString(confUri.getHost());                                    </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style=""> 450                         queryString = confUri.getEncodedQuery();                                         </span>
<span class="-1471183022667940231" onmouseenter="enter('-1471183022667940231');" onmouseout="out('-1471183022667940231');" style=""> 451                     } catch (IllegalArgumentException e) {                                               </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style=""> 452                         GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453                     }                                                                                    </span>
<span class="-6006476350816960216" onmouseenter="enter('-6006476350816960216');" onmouseout="out('-6006476350816960216');" style=""><abbr title=" 454                     ((WebView) v).loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);"> 454                     ((WebView) v).loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryStrinðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 455                 } else {                                                                                 </span>
<span class="1099762347578046525" onmouseenter="enter('1099762347578046525');" onmouseout="out('1099762347578046525');" style=""> 456                     //show configuration                                                                 </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style=""> 457                     if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                           </span>
<span class="-7229150094009232298" onmouseenter="enter('-7229150094009232298');" onmouseout="out('-7229150094009232298');" style=""><abbr title=" 458                         myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCallback&lt;String&gt;() {"> 458                         myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCaðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 459                             @Override                                                                    </span>
<span class="-64379824841031564" onmouseenter="enter('-64379824841031564');" onmouseout="out('-64379824841031564');" style=""> 460                             public void onReceiveValue(String s) {                                       </span>
<span class="2263921439611640529" onmouseenter="enter('2263921439611640529');" onmouseout="out('2263921439611640529');" style=""> 461                                 LOG.debug(&quot;Callback from showConfiguration&quot;, s);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462                             }                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 463                         });                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 464                     } else {                                                                             </span>
<span class="9200735872565889787" onmouseenter="enter('9200735872565889787');" onmouseout="out('9200735872565889787');" style=""> 465                         ((WebView) v).loadUrl(&quot;javascript:Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467                 }                                                                                        </span>
<span  style=""> 468                                                                                                          </span>
<span  style=""> 469                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470             }                                                                                            </span>
<span  style=""> 471                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 472             @Override                                                                                    </span>
<span class="111214959032469638" onmouseenter="enter('111214959032469638');" onmouseout="out('111214959032469638');" style=""> 473             public void onViewDetachedFromWindow(View v) {                                               </span>
<span class="-700130854651119442" onmouseenter="enter('-700130854651119442');" onmouseout="out('-700130854651119442');" style=""> 474                 myWebView.removeJavascriptInterface(&quot;GBActivity&quot;);                                       </span>
<span class="2583010823854911475" onmouseenter="enter('2583010823854911475');" onmouseout="out('2583010823854911475');" style=""> 475                 myWebView.setWillNotDraw(true);                                                          </span>
<span class="7079593887772041495" onmouseenter="enter('7079593887772041495');" onmouseout="out('7079593887772041495');" style=""> 476                 FrameLayout fl = (FrameLayout) findViewById(R.id.webview_placeholder);                   </span>
<span class="4691548091453242641" onmouseenter="enter('4691548091453242641');" onmouseout="out('4691548091453242641');" style=""> 477                 fl.removeAllViews();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 479         });                                                                                              </span>
<span  style=""> 480                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481     }                                                                                                    </span>
<span  style=""> 482                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 483     @Override                                                                                            </span>
<span class="-6302640138359785349" onmouseenter="enter('-6302640138359785349');" onmouseout="out('-6302640138359785349');" style=""> 484     protected void onNewIntent(Intent incoming) {                                                        </span>
<span class="-8811924227565660535" onmouseenter="enter('-8811924227565660535');" onmouseout="out('-8811924227565660535');" style=""> 485         incoming.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);              </span>
<span class="3914907222764799912" onmouseenter="enter('3914907222764799912');" onmouseout="out('3914907222764799912');" style=""> 486         super.onNewIntent(incoming);                                                                     </span>
<span class="9221581554438190622" onmouseenter="enter('9221581554438190622');" onmouseout="out('9221581554438190622');" style=""> 487         confUri = incoming.getData();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488     }                                                                                                    </span>
<span  style=""> 489                                                                                                          </span>
<span class="-8943595674098220959" onmouseenter="enter('-8943595674098220959');" onmouseout="out('-8943595674098220959');" style=""> 490     private boolean isLocationEnabledForWatchApp() {                                                     </span>
<span class="939192678715537627" onmouseenter="enter('939192678715537627');" onmouseout="out('939192678715537627');" style=""> 491         return true; //as long as we don&#x27;t give watchapp internet access it&#x27;s not a problem              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492     }                                                                                                    </span>
<span  style=""> 493                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 494     @Override                                                                                            </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 495     public boolean onOptionsItemSelected(MenuItem item) {                                                </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 496         switch (item.getItemId()) {                                                                      </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 497             case android.R.id.home:                                                                      </span>
<span class="-1694655592982141021" onmouseenter="enter('-1694655592982141021');" onmouseout="out('-1694655592982141021');" style=""> 498                 NavUtils.navigateUpFromSameTask(this);                                                   </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 499                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500         }                                                                                                </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 501         return super.onOptionsItemSelected(item);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502     }                                                                                                    </span>
<span  style=""> 503                                                                                                          </span>
<span class="2223760692968598534" onmouseenter="enter('2223760692968598534');" onmouseout="out('2223760692968598534');" style=""> 504     private class ActivityJSInterface {                                                                  </span>
<span  style=""> 505                                                                                                          </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style=""> 506         Context mContext;                                                                                </span>
<span  style=""> 507                                                                                                          </span>
<span class="2859735092534969408" onmouseenter="enter('2859735092534969408');" onmouseout="out('2859735092534969408');" style=""> 508         public ActivityJSInterface(Context c) {                                                          </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style=""> 509             mContext = c;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510         }                                                                                                </span>
<span  style=""> 511                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 512         @JavascriptInterface                                                                             </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style=""> 513         public void closeActivity() {                                                                    </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style=""> 514             NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 515         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516     }                                                                                                    </span>
<span  style=""> 517                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518 }                                                                                                        </span>























































































































































</pre></td>
                            <td><pre><span class="-7393740638519443947" onmouseenter="enter('-7393740638519443947');" onmouseout="out('-7393740638519443947');" style="">   1 package nodomain.freeyourgadget.gadgetbridge.activities;                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="3857212678176399715" onmouseenter="enter('3857212678176399715');" onmouseout="out('3857212678176399715');" style="">   3 import android.Manifest;                                                                                 </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5 import android.content.Intent;                                                                           </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   6 import android.content.pm.PackageManager;                                                                </span>
<span class="907171826859240605" onmouseenter="enter('907171826859240605');" onmouseout="out('907171826859240605');" style="">   7 import android.location.Criteria;                                                                        </span>
<span class="-4559785959657295211" onmouseenter="enter('-4559785959657295211');" onmouseout="out('-4559785959657295211');" style="">   8 import android.location.Location;                                                                        </span>
<span class="8236022111747117642" onmouseenter="enter('8236022111747117642');" onmouseout="out('8236022111747117642');" style="">   9 import android.location.LocationManager;                                                                 </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  10 import android.net.Uri;                                                                                  </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  11 import android.os.Build;                                                                                 </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  12 import android.os.Bundle;                                                                                </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="">  13 import android.support.v4.app.ActivityCompat;                                                            </span>
<span class="6797968843617414504" onmouseenter="enter('6797968843617414504');" onmouseout="out('6797968843617414504');" style="">  14 import android.support.v4.app.NavUtils;                                                                  </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  15 import android.view.MenuItem;                                                                            </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  16 import android.view.View;                                                                                </span>
<span class="-6388096999790135816" onmouseenter="enter('-6388096999790135816');" onmouseout="out('-6388096999790135816');" style="">  17 import android.webkit.JavascriptInterface;                                                               </span>
<span class="-1234144701745247801" onmouseenter="enter('-1234144701745247801');" onmouseout="out('-1234144701745247801');" style="">  18 import android.webkit.ValueCallback;                                                                     </span>
<span class="2723690893492346945" onmouseenter="enter('2723690893492346945');" onmouseout="out('2723690893492346945');" style="">  19 import android.webkit.WebView;                                                                           </span>
<span class="619404646788779253" onmouseenter="enter('619404646788779253');" onmouseout="out('619404646788779253');" style="">  20 import android.widget.FrameLayout;                                                                       </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  21 import android.widget.Toast;                                                                             </span>
<span class="2390503830490498598" onmouseenter="enter('2390503830490498598');" onmouseout="out('2390503830490498598');" style="">  22 import java.util.UUID;                                                                                   </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  23 import nodomain.freeyourgadget.gadgetbridge.R;                                                           </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  24 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  25 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  26 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  27 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span class="-425744571032727695" onmouseenter="enter('-425744571032727695');" onmouseout="out('-425744571032727695');" style="">  28 import nodomain.freeyourgadget.gadgetbridge.util.WebViewSingleton;                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  29 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  30 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  31                                                                                                          </span>
<span  style="">  32                                                                                                          </span>
<span class="8425816362509139849" onmouseenter="enter('8425816362509139849');" onmouseout="out('8425816362509139849');" style="">  33 public class ExternalPebbleJSActivity extends GBActivity {                                               </span>
<span class="8136098019960083823" onmouseenter="enter('8136098019960083823');" onmouseout="out('8136098019960083823');" style="">  34     private static final Logger LOG = LoggerFactory.getLogger(ExternalPebbleJSActivity.class);           </span>
<span  style="">  35                                                                                                          </span>
<span class="3065437899111201345" onmouseenter="enter('3065437899111201345');" onmouseout="out('3065437899111201345');" style="">  36     private UUID appUuid;                                                                                </span>
<span  style="">  37                                                                                                          </span>
<span class="9027266421678696690" onmouseenter="enter('9027266421678696690');" onmouseout="out('9027266421678696690');" style="">  38     private Uri confUri;                                                                                 </span>
<span  style="">  39                                                                                                          </span>
<span class="-5535852384441440556" onmouseenter="enter('-5535852384441440556');" onmouseout="out('-5535852384441440556');" style="">  40     private GBDevice mGBDevice = null;                                                                   </span>
<span  style="">  41                                                                                                          </span>
<span class="6615780427500382937" onmouseenter="enter('6615780427500382937');" onmouseout="out('6615780427500382937');" style="">  42     private WebView myWebView;                                                                           </span>
<span  style="">  43                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  44     @Override                                                                                            </span>
<span class="6892052666771236398" onmouseenter="enter('6892052666771236398');" onmouseout="out('6892052666771236398');" style="">  45     protected void onCreate(Bundle savedInstanceState) {                                                 </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style="">  46         super.onCreate(savedInstanceState);                                                              </span>
<span class="-871894361009470891" onmouseenter="enter('-871894361009470891');" onmouseout="out('-871894361009470891');" style="">  47         Bundle extras = getIntent().getExtras();                                                         </span>
<span class="8849338589512660035" onmouseenter="enter('8849338589512660035');" onmouseout="out('8849338589512660035');" style="">  48         if (extras != null) {                                                                            </span>
<span class="3724295817671341281" onmouseenter="enter('3724295817671341281');" onmouseout="out('3724295817671341281');" style="">  49             mGBDevice = extras.getParcelable(GBDevice.EXTRA_DEVICE);                                     </span>
<span class="2795937831365355817" onmouseenter="enter('2795937831365355817');" onmouseout="out('2795937831365355817');" style="">  50             appUuid = ((UUID) (extras.getSerializable(DeviceService.EXTRA_APP_UUID)));                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  51         } else {                                                                                         </span>
<span class="496962713155353134" onmouseenter="enter('496962713155353134');" onmouseout="out('496962713155353134');" style="">  52             throw new IllegalArgumentException(&quot;Must provide a device when invoking this activity&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53         }                                                                                                </span>
<span class="8370604561035257296" onmouseenter="enter('8370604561035257296');" onmouseout="out('8370604561035257296');" style="">  54         setContentView(R.layout.activity_external_pebble_js);                                            </span>
<span class="8982719199826339359" onmouseenter="enter('8982719199826339359');" onmouseout="out('8982719199826339359');" style="">  55         myWebView = WebViewSingleton.getorInitWebView(this, mGBDevice, appUuid);                         </span>
<span class="6894061798627554793" onmouseenter="enter('6894061798627554793');" onmouseout="out('6894061798627554793');" style="">  56         myWebView.setWillNotDraw(false);                                                                 </span>
<span class="621661899868089717" onmouseenter="enter('621661899868089717');" onmouseout="out('621661899868089717');" style="">  57         myWebView.addJavascriptInterface(new ActivityJSInterface(this), &quot;GBActivity&quot;);                   </span>
<span class="7286064812918875152" onmouseenter="enter('7286064812918875152');" onmouseout="out('7286064812918875152');" style="">  58         FrameLayout fl = ((FrameLayout) (findViewById(R.id.webview_placeholder)));                       </span>
<span class="-4001555273714846720" onmouseenter="enter('-4001555273714846720');" onmouseout="out('-4001555273714846720');" style="">  59         fl.addView(myWebView);                                                                           </span>
<span class="5697070782885285202" onmouseenter="enter('5697070782885285202');" onmouseout="out('5697070782885285202');" style="">  60         myWebView.addOnAttachStateChangeListener(new View.OnAttachStateChangeListener() {                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  61             @Override                                                                                    </span>
<span class="-5576845663046859066" onmouseenter="enter('-5576845663046859066');" onmouseout="out('-5576845663046859066');" style="">  62             public void onViewAttachedToWindow(View v) {                                                 </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style="">  63                 if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                               </span>
<span class="4771517920709256525" onmouseenter="enter('4771517920709256525');" onmouseout="out('4771517920709256525');" style="">  64                     // chromium, enable hardware acceleration                                            </span>
<span class="-8172250518187697323" onmouseenter="enter('-8172250518187697323');" onmouseout="out('-8172250518187697323');" style="">  65                     v.setLayerType(View.LAYER_TYPE_HARDWARE, null);                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  66                 } else {                                                                                 </span>
<span class="-1721106037310283892" onmouseenter="enter('-1721106037310283892');" onmouseout="out('-1721106037310283892');" style="">  67                     // older android version, disable hardware acceleration                              </span>
<span class="1424411202877530232" onmouseenter="enter('1424411202877530232');" onmouseout="out('1424411202877530232');" style="">  68                     v.setLayerType(View.LAYER_TYPE_SOFTWARE, null);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69                 }                                                                                        </span>
<span class="-1033981458626162610" onmouseenter="enter('-1033981458626162610');" onmouseout="out('-1033981458626162610');" style="">  70                 String queryString = &quot;&quot;;                                                                 </span>
<span class="-2276587090849303814" onmouseenter="enter('-2276587090849303814');" onmouseout="out('-2276587090849303814');" style="">  71                 if (confUri != null) {                                                                   </span>
<span class="8272566007988823821" onmouseenter="enter('8272566007988823821');" onmouseout="out('8272566007988823821');" style="">  72                     // getting back with configuration data                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  73                     try {                                                                                </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style="">  74                         appUuid = UUID.fromString(confUri.getHost());                                    </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style="">  75                         queryString = confUri.getEncodedQuery();                                         </span>
<span class="7040782648503474034" onmouseenter="enter('7040782648503474034');" onmouseout="out('7040782648503474034');" style="">  76                     } catch (java.lang.IllegalArgumentException e) {                                     </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style="">  77                         GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78                     }                                                                                    </span>
<span class="-5188961348684919259" onmouseenter="enter('-5188961348684919259');" onmouseout="out('-5188961348684919259');" style=""><abbr title="  79                     ((WebView) (v)).loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);">  79                     ((WebView) (v)).loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryStrðŸ”µ</abbr></span>
<span class="5022618591603902370" onmouseenter="enter('5022618591603902370');" onmouseout="out('5022618591603902370');" style="">  80                 } else //show configuration                                                              </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style="">  81                 if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                               </span>
<span class="-7229150094009232298" onmouseenter="enter('-7229150094009232298');" onmouseout="out('-7229150094009232298');" style=""><abbr title="  82                     myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCallback&lt;String&gt;() {">  82                     myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCallbaðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83                         @Override                                                                        </span>
<span class="-64379824841031564" onmouseenter="enter('-64379824841031564');" onmouseout="out('-64379824841031564');" style="">  84                         public void onReceiveValue(String s) {                                           </span>
<span class="2263921439611640529" onmouseenter="enter('2263921439611640529');" onmouseout="out('2263921439611640529');" style="">  85                             LOG.debug(&quot;Callback from showConfiguration&quot;, s);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86                         }                                                                                </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="">  87                     });                                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  88                 } else {                                                                                 </span>
<span class="2757475139564398283" onmouseenter="enter('2757475139564398283');" onmouseout="out('2757475139564398283');" style="">  89                     ((WebView) (v)).loadUrl(&quot;javascript:Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91             }                                                                                            </span>
<span  style="">  92                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  93             @Override                                                                                    </span>
<span class="111214959032469638" onmouseenter="enter('111214959032469638');" onmouseout="out('111214959032469638');" style="">  94             public void onViewDetachedFromWindow(View v) {                                               </span>
<span class="-700130854651119442" onmouseenter="enter('-700130854651119442');" onmouseout="out('-700130854651119442');" style="">  95                 myWebView.removeJavascriptInterface(&quot;GBActivity&quot;);                                       </span>
<span class="2583010823854911475" onmouseenter="enter('2583010823854911475');" onmouseout="out('2583010823854911475');" style="">  96                 myWebView.setWillNotDraw(true);                                                          </span>
<span class="7286064812918875152" onmouseenter="enter('7286064812918875152');" onmouseout="out('7286064812918875152');" style="">  97                 FrameLayout fl = ((FrameLayout) (findViewById(R.id.webview_placeholder)));               </span>
<span class="4691548091453242641" onmouseenter="enter('4691548091453242641');" onmouseout="out('4691548091453242641');" style="">  98                 fl.removeAllViews();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 100         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101     }                                                                                                    </span>
<span  style=""> 102                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 103     @Override                                                                                            </span>
<span class="-6302640138359785349" onmouseenter="enter('-6302640138359785349');" onmouseout="out('-6302640138359785349');" style=""> 104     protected void onNewIntent(Intent incoming) {                                                        </span>
<span class="-8811924227565660535" onmouseenter="enter('-8811924227565660535');" onmouseout="out('-8811924227565660535');" style=""> 105         incoming.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);              </span>
<span class="3914907222764799912" onmouseenter="enter('3914907222764799912');" onmouseout="out('3914907222764799912');" style=""> 106         super.onNewIntent(incoming);                                                                     </span>
<span class="9221581554438190622" onmouseenter="enter('9221581554438190622');" onmouseout="out('9221581554438190622');" style=""> 107         confUri = incoming.getData();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110     @Override                                                                                            </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 111     public boolean onOptionsItemSelected(MenuItem item) {                                                </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 112         switch (item.getItemId()) {                                                                      </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 113             case android.R.id.home:                                                                      </span>
<span class="-1694655592982141021" onmouseenter="enter('-1694655592982141021');" onmouseout="out('-1694655592982141021');" style=""> 114                 NavUtils.navigateUpFromSameTask(this);                                                   </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 115                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116         }                                                                                                </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 117         return super.onOptionsItemSelected(item);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118     }                                                                                                    </span>
<span  style=""> 119                                                                                                          </span>
<span class="2223760692968598534" onmouseenter="enter('2223760692968598534');" onmouseout="out('2223760692968598534');" style=""> 120     private class ActivityJSInterface {                                                                  </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style=""> 121         Context mContext;                                                                                </span>
<span  style=""> 122                                                                                                          </span>
<span class="2859735092534969408" onmouseenter="enter('2859735092534969408');" onmouseout="out('2859735092534969408');" style=""> 123         public ActivityJSInterface(Context c) {                                                          </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style=""> 124             mContext = c;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125         }                                                                                                </span>
<span  style=""> 126                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 127         @JavascriptInterface                                                                             </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style=""> 128         public void closeActivity() {                                                                    </span>
<span class="-2212458775060067845" onmouseenter="enter('-2212458775060067845');" onmouseout="out('-2212458775060067845');" style=""> 129             NavUtils.navigateUpFromSameTask(((ExternalPebbleJSActivity) (mContext)));                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130         }                                                                                                </span>
<span  style=""> 131                                                                                                          </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 132         @JavascriptInterface                                                                             </span>
<span class="-5039914046281084423" onmouseenter="enter('-5039914046281084423');" onmouseout="out('-5039914046281084423');" style=""> 133         public String getCurrentPosition() {                                                             </span>
<span class="-149413150381439412" onmouseenter="enter('-149413150381439412');" onmouseout="out('-149413150381439412');" style=""> 134             if (!isLocationEnabledForWatchApp()) {                                                       </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 135                 return &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136             }                                                                                            </span>
<span class="8227519164768398763" onmouseenter="enter('8227519164768398763');" onmouseout="out('8227519164768398763');" style=""><abbr title=" 137             //we need to override this because the coarse location is not enough for the android webview, we should add the permission for fine location."> 137             //we need to override this because the coarse location is not enough for the android webview,ðŸ”µ</abbr></span>
<span class="7572894489807780729" onmouseenter="enter('7572894489807780729');" onmouseout="out('7572894489807780729');" style=""> 138             JSONObject geoPosition = new JSONObject();                                                   </span>
<span class="-8852470018621524217" onmouseenter="enter('-8852470018621524217');" onmouseout="out('-8852470018621524217');" style=""> 139             JSONObject coords = new JSONObject();                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 140             try {                                                                                        </span>
<span  style=""> 141                                                                                                          </span>
<span class="7576815700871527587" onmouseenter="enter('7576815700871527587');" onmouseout="out('7576815700871527587');" style=""> 142                 Prefs prefs = GBApplication.getPrefs();                                                  </span>
<span  style=""> 143                                                                                                          </span>
<span class="-2804823070089201012" onmouseenter="enter('-2804823070089201012');" onmouseout="out('-2804823070089201012');" style=""><abbr title=" 144                 geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know this value is really old"> 144                 geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know ðŸ”µ</abbr></span>
<span  style=""> 145                                                                                                          </span>
<span class="6245247748368740564" onmouseenter="enter('6245247748368740564');" onmouseout="out('6245247748368740564');" style=""> 146                 coords.put(&quot;latitude&quot;, prefs.getFloat(&quot;location_latitude&quot;, 0));                          </span>
<span class="-2550975770164595754" onmouseenter="enter('-2550975770164595754');" onmouseout="out('-2550975770164595754');" style=""> 147                 coords.put(&quot;longitude&quot;, prefs.getFloat(&quot;location_longitude&quot;, 0));                        </span>
<span  style=""> 148                                                                                                          </span>
<span class="-2595111342414270158" onmouseenter="enter('-2595111342414270158');" onmouseout="out('-2595111342414270158');" style=""><abbr title=" 149                 if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED &amp;&amp;"> 149                 if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESðŸ”µ</abbr></span>
<span class="-6892731487308770176" onmouseenter="enter('-6892731487308770176');" onmouseout="out('-6892731487308770176');" style=""> 150                         prefs.getBoolean(&quot;use_updated_location_if_available&quot;, false)) {                  </span>
<span class="3465319766909019165" onmouseenter="enter('3465319766909019165');" onmouseout="out('3465319766909019165');" style=""><abbr title=" 151                     LocationManager locationManager = (LocationManager) getApplicationContext().getSystemService(Context.LOCATION_SERVICE);"> 151                     LocationManager locationManager = (LocationManager) getApplicationContext().getSystemðŸ”µ</abbr></span>
<span class="-840377409278335695" onmouseenter="enter('-840377409278335695');" onmouseout="out('-840377409278335695');" style=""> 152                     Criteria criteria = new Criteria();                                                  </span>
<span class="6446985192446327745" onmouseenter="enter('6446985192446327745');" onmouseout="out('6446985192446327745');" style=""> 153                     String provider = locationManager.getBestProvider(criteria, false);                  </span>
<span class="-8436409377687209859" onmouseenter="enter('-8436409377687209859');" onmouseout="out('-8436409377687209859');" style=""> 154                     if (provider != null) {                                                              </span>
<span class="-7314446287342572990" onmouseenter="enter('-7314446287342572990');" onmouseout="out('-7314446287342572990');" style=""> 155                         Location lastKnownLocation = locationManager.getLastKnownLocation(provider);     </span>
<span class="8333098492219571100" onmouseenter="enter('8333098492219571100');" onmouseout="out('8333098492219571100');" style=""> 156                         if (lastKnownLocation != null) {                                                 </span>
<span class="5858379750545562426" onmouseenter="enter('5858379750545562426');" onmouseout="out('5858379750545562426');" style=""> 157                             geoPosition.put(&quot;timestamp&quot;, lastKnownLocation.getTime());                   </span>
<span  style=""> 158                                                                                                          </span>
<span class="-3886576221552081470" onmouseenter="enter('-3886576221552081470');" onmouseout="out('-3886576221552081470');" style=""> 159                             coords.put(&quot;latitude&quot;, (float) lastKnownLocation.getLatitude());             </span>
<span class="1780277249580908945" onmouseenter="enter('1780277249580908945');" onmouseout="out('1780277249580908945');" style=""> 160                             coords.put(&quot;longitude&quot;, (float) lastKnownLocation.getLongitude());           </span>
<span class="1952651036571300684" onmouseenter="enter('1952651036571300684');" onmouseout="out('1952651036571300684');" style=""> 161                             coords.put(&quot;accuracy&quot;, lastKnownLocation.getAccuracy());                     </span>
<span class="-3774793511471938680" onmouseenter="enter('-3774793511471938680');" onmouseout="out('-3774793511471938680');" style=""> 162                             coords.put(&quot;altitude&quot;, lastKnownLocation.getAltitude());                     </span>
<span class="-8837886391810921688" onmouseenter="enter('-8837886391810921688');" onmouseout="out('-8837886391810921688');" style=""> 163                             coords.put(&quot;speed&quot;, lastKnownLocation.getSpeed());                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166                 }                                                                                        </span>
<span  style=""> 167                                                                                                          </span>
<span class="7469381851935855362" onmouseenter="enter('7469381851935855362');" onmouseout="out('7469381851935855362');" style=""> 168                 geoPosition.put(&quot;coords&quot;, coords);                                                       </span>
<span  style=""> 169                                                                                                          </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 170             } catch (JSONException e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 171                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172             }                                                                                            </span>
<span class="-2910369541796689888" onmouseenter="enter('-2910369541796689888');" onmouseout="out('-2910369541796689888');" style=""> 173             return geoPosition.toString();                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176 }                                                                                                        </span>













































































































































































































































































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-7393740638519443947" onmouseenter="enter('-7393740638519443947');" onmouseout="out('-7393740638519443947');" style="">   1  package nodomain.freeyourgadget.gadgetbridge.activities;                                                          </span>
<span  style="">   2                                                                                                                    </span>

<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   3  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   4  import android.content.Intent;                                                                                    </span>




<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   5  import android.net.Uri;                                                                                           </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   6 +import android.os.Build;                                                                                          </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">   7  import android.os.Bundle;                                                                                         </span>

<span class="6797968843617414504" onmouseenter="enter('6797968843617414504');" onmouseout="out('6797968843617414504');" style="">   8  import android.support.v4.app.NavUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   9 -import android.util.Log;                                                                                          </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  10  import android.view.MenuItem;                                                                                     </span>
<span class="4354626559660197873" onmouseenter="enter('4354626559660197873');" onmouseout="out('4354626559660197873');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  11 -import android.webkit.ConsoleMessage;                                                                             </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  12 +import android.view.View;                                                                                         </span>
<span class="-6388096999790135816" onmouseenter="enter('-6388096999790135816');" onmouseout="out('-6388096999790135816');" style="">  13  import android.webkit.JavascriptInterface;                                                                        </span>
<span class="-8622242184377527379" onmouseenter="enter('-8622242184377527379');" onmouseout="out('-8622242184377527379');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  14 -import android.webkit.WebChromeClient;                                                                            </span>
<span class="-5080310458335134854" onmouseenter="enter('-5080310458335134854');" onmouseout="out('-5080310458335134854');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  15 -import android.webkit.WebSettings;                                                                                </span>
<span class="-1234144701745247801" onmouseenter="enter('-1234144701745247801');" onmouseout="out('-1234144701745247801');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  16 +import android.webkit.ValueCallback;                                                                              </span>
<span class="2723690893492346945" onmouseenter="enter('2723690893492346945');" onmouseout="out('2723690893492346945');" style="">  17  import android.webkit.WebView;                                                                                    </span>
<span class="-3167847991483127041" onmouseenter="enter('-3167847991483127041');" onmouseout="out('-3167847991483127041');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  18 -import android.webkit.WebViewClient;                                                                              </span>
<span class="619404646788779253" onmouseenter="enter('619404646788779253');" onmouseout="out('619404646788779253');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  19 +import android.widget.FrameLayout;                                                                                </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  20  import android.widget.Toast;                                                                                      </span>
<span  style="">  21                                                                                                                    </span>
<span class="-8573375701834280359" onmouseenter="enter('-8573375701834280359');" onmouseout="out('-8573375701834280359');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import org.json.JSONException;                                                                                    </span>
<span class="7232075261178918144" onmouseenter="enter('7232075261178918144');" onmouseout="out('7232075261178918144');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import org.json.JSONObject;                                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  24  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  25  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  26                                                                                                                    </span>
<span class="-6983162919371453239" onmouseenter="enter('-6983162919371453239');" onmouseout="out('-6983162919371453239');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import java.io.BufferedWriter;                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import java.io.File;                                                                                              </span>
<span class="4914725365521379617" onmouseenter="enter('4914725365521379617');" onmouseout="out('4914725365521379617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import java.io.FileWriter;                                                                                        </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import java.io.IOException;                                                                                       </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import java.io.UnsupportedEncodingException;                                                                      </span>
<span class="7630846594806589523" onmouseenter="enter('7630846594806589523');" onmouseout="out('7630846594806589523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import java.io.Writer;                                                                                            </span>
<span class="6381430938828950472" onmouseenter="enter('6381430938828950472');" onmouseout="out('6381430938828950472');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import java.security.MessageDigest;                                                                               </span>
<span class="-1748023591259675388" onmouseenter="enter('-1748023591259675388');" onmouseout="out('-1748023591259675388');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import java.security.NoSuchAlgorithmException;                                                                    </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import java.util.Iterator;                                                                                        </span>
<span class="-6589962362033146913" onmouseenter="enter('-6589962362033146913');" onmouseout="out('-6589962362033146913');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import java.util.Scanner;                                                                                         </span>
<span class="2390503830490498598" onmouseenter="enter('2390503830490498598');" onmouseout="out('2390503830490498598');" style="">  37  import java.util.UUID;                                                                                            </span>
<span  style="">  38                                                                                                                    </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                                        </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  40  import nodomain.freeyourgadget.gadgetbridge.R;                                                                    </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  41  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  42  import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                                  </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                                       </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  44  import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                              </span>
<span class="4645284583739884744" onmouseenter="enter('4645284583739884744');" onmouseout="out('4645284583739884744');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import nodomain.freeyourgadget.gadgetbridge.util.PebbleUtils;                                                     </span>
<span class="-425744571032727695" onmouseenter="enter('-425744571032727695');" onmouseout="out('-425744571032727695');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +import nodomain.freeyourgadget.gadgetbridge.util.WebViewSingleton;                                                </span>
<span  style="">  47                                                                                                                    </span>
<span class="8425816362509139849" onmouseenter="enter('8425816362509139849');" onmouseout="out('8425816362509139849');" style="">  48  public class ExternalPebbleJSActivity extends GBActivity {                                                        </span>
<span  style="">  49                                                                                                                    </span>
<span class="8136098019960083823" onmouseenter="enter('8136098019960083823');" onmouseout="out('8136098019960083823');" style="">  50      private static final Logger LOG = LoggerFactory.getLogger(ExternalPebbleJSActivity.class);                    </span>
<span  style="">  51                                                                                                                    </span>
<span class="3065437899111201345" onmouseenter="enter('3065437899111201345');" onmouseout="out('3065437899111201345');" style="">  52      private UUID appUuid;                                                                                         </span>
<span class="9027266421678696690" onmouseenter="enter('9027266421678696690');" onmouseout="out('9027266421678696690');" style="">  53      private Uri confUri;                                                                                          </span>
<span class="-5535852384441440556" onmouseenter="enter('-5535852384441440556');" onmouseout="out('-5535852384441440556');" style="">  54      private GBDevice mGBDevice = null;                                                                            </span>
<span class="6615780427500382937" onmouseenter="enter('6615780427500382937');" onmouseout="out('6615780427500382937');" style="">  55      private WebView myWebView;                                                                                    </span>
<span  style="">  56                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  57      @Override                                                                                                     </span>
<span class="6892052666771236398" onmouseenter="enter('6892052666771236398');" onmouseout="out('6892052666771236398');" style="">  58      protected void onCreate(Bundle savedInstanceState) {                                                          </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style="">  59          super.onCreate(savedInstanceState);                                                                       </span>
<span  style="">  60                                                                                                                    </span>
<span class="-871894361009470891" onmouseenter="enter('-871894361009470891');" onmouseout="out('-871894361009470891');" style="">  61          Bundle extras = getIntent().getExtras();                                                                  </span>
<span class="8849338589512660035" onmouseenter="enter('8849338589512660035');" onmouseout="out('8849338589512660035');" style="">  62          if (extras != null) {                                                                                     </span>
<span class="3724295817671341281" onmouseenter="enter('3724295817671341281');" onmouseout="out('3724295817671341281');" style="">  63              mGBDevice = extras.getParcelable(GBDevice.EXTRA_DEVICE);                                              </span>
<span class="2716088159317727473" onmouseenter="enter('2716088159317727473');" onmouseout="out('2716088159317727473');" style="">  64              appUuid = (UUID) extras.getSerializable(DeviceService.EXTRA_APP_UUID);                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  65          } else {                                                                                                  </span>
<span class="496962713155353134" onmouseenter="enter('496962713155353134');" onmouseout="out('496962713155353134');" style="">  66              throw new IllegalArgumentException(&quot;Must provide a device when invoking this activity&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67          }                                                                                                         </span>
<span  style="">  68                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -                                                                                                                  </span>
<span class="8370604561035257296" onmouseenter="enter('8370604561035257296');" onmouseout="out('8370604561035257296');" style="">  70          setContentView(R.layout.activity_external_pebble_js);                                                     </span>
<span  style="">  71                                                                                                                    </span>
<span class="3269004064107631113" onmouseenter="enter('3269004064107631113');" onmouseout="out('3269004064107631113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -        myWebView = (WebView) findViewById(R.id.configureWebview);                                                </span>
<span class="6951369669181364933" onmouseenter="enter('6951369669181364933');" onmouseout="out('6951369669181364933');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -        myWebView.clearCache(true);                                                                               </span>
<span class="-5098710959804433945" onmouseenter="enter('-5098710959804433945');" onmouseout="out('-5098710959804433945');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -        myWebView.setWebViewClient(new GBWebClient());                                                            </span>
<span class="-2143743775779870741" onmouseenter="enter('-2143743775779870741');" onmouseout="out('-2143743775779870741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -        myWebView.setWebChromeClient(new GBChromeClient());                                                       </span>
<span class="5965560249615903209" onmouseenter="enter('5965560249615903209');" onmouseout="out('5965560249615903209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -        WebSettings webSettings = myWebView.getSettings();                                                        </span>
<span class="-1279216538078347487" onmouseenter="enter('-1279216538078347487');" onmouseout="out('-1279216538078347487');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -        webSettings.setJavaScriptEnabled(true);                                                                   </span>
<span class="-2569197401274859417" onmouseenter="enter('-2569197401274859417');" onmouseout="out('-2569197401274859417');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -        //needed to access the DOM                                                                                </span>
<span class="2427407921833264579" onmouseenter="enter('2427407921833264579');" onmouseout="out('2427407921833264579');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -        webSettings.setDomStorageEnabled(true);                                                                   </span>
<span class="1207861921184281084" onmouseenter="enter('1207861921184281084');" onmouseout="out('1207861921184281084');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -        //needed for localstorage                                                                                 </span>
<span class="-5630325944023181441" onmouseenter="enter('-5630325944023181441');" onmouseout="out('-5630325944023181441');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -        webSettings.setDatabaseEnabled(true);                                                                     </span>
<span class="8982719199826339359" onmouseenter="enter('8982719199826339359');" onmouseout="out('8982719199826339359');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +        myWebView = WebViewSingleton.getorInitWebView(this, mGBDevice, appUuid);                                  </span>
<span class="6894061798627554793" onmouseenter="enter('6894061798627554793');" onmouseout="out('6894061798627554793');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +        myWebView.setWillNotDraw(false);                                                                          </span>
<span class="-8818851797244187743" onmouseenter="enter('-8818851797244187743');" onmouseout="out('-8818851797244187743');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +        myWebView.addJavascriptInterface(new ActivityJSInterface(ExternalPebbleJSActivity.this), &quot;GBActivity&quot;);   </span>
<span class="7079593887772041495" onmouseenter="enter('7079593887772041495');" onmouseout="out('7079593887772041495');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +        FrameLayout fl = (FrameLayout) findViewById(R.id.webview_placeholder);                                    </span>
<span class="-4001555273714846720" onmouseenter="enter('-4001555273714846720');" onmouseout="out('-4001555273714846720');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +        fl.addView(myWebView);                                                                                    </span>
<span  style="">  87                                                                                                                    </span>
<span class="8665171849228936593" onmouseenter="enter('8665171849228936593');" onmouseout="out('8665171849228936593');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -        JSInterface gbJSInterface = new JSInterface(this);                                                        </span>
<span class="4777223995400399502" onmouseenter="enter('4777223995400399502');" onmouseout="out('4777223995400399502');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -        myWebView.addJavascriptInterface(gbJSInterface, &quot;GBjs&quot;);                                                  </span>
<span  style="">  90                                                                                                                    </span>
<span class="-1759263916770348713" onmouseenter="enter('-1759263916770348713');" onmouseout="out('-1759263916770348713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -        myWebView.loadUrl(&quot;file:///android_asset/app_config/configure.html&quot;);                                     </span>
<span class="5697070782885285202" onmouseenter="enter('5697070782885285202');" onmouseout="out('5697070782885285202');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  92 +        myWebView.addOnAttachStateChangeListener(new View.OnAttachStateChangeListener() {                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +            @Override                                                                                             </span>
<span class="-5576845663046859066" onmouseenter="enter('-5576845663046859066');" onmouseout="out('-5576845663046859066');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +            public void onViewAttachedToWindow(View v) {                                                          </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +                                                                                                                  </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  97 +                if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                                        </span>
<span class="4771517920709256525" onmouseenter="enter('4771517920709256525');" onmouseout="out('4771517920709256525');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +                    // chromium, enable hardware acceleration                                                     </span>
<span class="-8172250518187697323" onmouseenter="enter('-8172250518187697323');" onmouseout="out('-8172250518187697323');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +                    v.setLayerType(View.LAYER_TYPE_HARDWARE, null);                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +                } else {                                                                                          </span>
<span class="-1721106037310283892" onmouseenter="enter('-1721106037310283892');" onmouseout="out('-1721106037310283892');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +                    // older android version, disable hardware acceleration                                       </span>
<span class="1424411202877530232" onmouseenter="enter('1424411202877530232');" onmouseout="out('1424411202877530232');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 102 +                    v.setLayerType(View.LAYER_TYPE_SOFTWARE, null);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 103 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 105 +                                                                                                                  </span>
<span class="-1033981458626162610" onmouseenter="enter('-1033981458626162610');" onmouseout="out('-1033981458626162610');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +                String queryString = &quot;&quot;;                                                                          </span>
<span class="-2276587090849303814" onmouseenter="enter('-2276587090849303814');" onmouseout="out('-2276587090849303814');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +                if (confUri != null) {                                                                            </span>
<span class="-1088791743364895452" onmouseenter="enter('-1088791743364895452');" onmouseout="out('-1088791743364895452');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 108 +                    //getting back with configuration data                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +                    try {                                                                                         </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +                        appUuid = UUID.fromString(confUri.getHost());                                             </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +                        queryString = confUri.getEncodedQuery();                                                  </span>
<span class="-1471183022667940231" onmouseenter="enter('-1471183022667940231');" onmouseout="out('-1471183022667940231');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +                    } catch (IllegalArgumentException e) {                                                        </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +                        GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +                    }                                                                                             </span>
<span class="-6006476350816960216" onmouseenter="enter('-6006476350816960216');" onmouseout="out('-6006476350816960216');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +                    ((WebView) v).loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +                } else {                                                                                          </span>
<span class="1099762347578046525" onmouseenter="enter('1099762347578046525');" onmouseout="out('1099762347578046525');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +                    //show configuration                                                                          </span>
<span class="-611000332437619731" onmouseenter="enter('-611000332437619731');" onmouseout="out('-611000332437619731');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {                                    </span>
<span class="-7229150094009232298" onmouseenter="enter('-7229150094009232298');" onmouseout="out('-7229150094009232298');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 119 +                        myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCallback&lt;String&gt;() {"> 119 +                        myWebView.evaluateJavascript(&quot;Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;, new ValueCallback&lt;StðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +                            @Override                                                                             </span>
<span class="-64379824841031564" onmouseenter="enter('-64379824841031564');" onmouseout="out('-64379824841031564');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +                            public void onReceiveValue(String s) {                                                </span>
<span class="2263921439611640529" onmouseenter="enter('2263921439611640529');" onmouseout="out('2263921439611640529');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +                                LOG.debug(&quot;Callback from showConfiguration&quot;, s);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +                            }                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +                        });                                                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +                    } else {                                                                                      </span>
<span class="9200735872565889787" onmouseenter="enter('9200735872565889787');" onmouseout="out('9200735872565889787');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +                        ((WebView) v).loadUrl(&quot;javascript:Pebble.evaluate(&#x27;showConfiguration&#x27;);&quot;);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +            @Override                                                                                             </span>
<span class="111214959032469638" onmouseenter="enter('111214959032469638');" onmouseout="out('111214959032469638');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +            public void onViewDetachedFromWindow(View v) {                                                        </span>
<span class="-700130854651119442" onmouseenter="enter('-700130854651119442');" onmouseout="out('-700130854651119442');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +                myWebView.removeJavascriptInterface(&quot;GBActivity&quot;);                                                </span>
<span class="2583010823854911475" onmouseenter="enter('2583010823854911475');" onmouseout="out('2583010823854911475');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 136 +                myWebView.setWillNotDraw(true);                                                                   </span>
<span class="7079593887772041495" onmouseenter="enter('7079593887772041495');" onmouseout="out('7079593887772041495');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +                FrameLayout fl = (FrameLayout) findViewById(R.id.webview_placeholder);                            </span>
<span class="4691548091453242641" onmouseenter="enter('4691548091453242641');" onmouseout="out('4691548091453242641');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +                fl.removeAllViews();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +            }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +        });                                                                                                       </span>
<span  style=""> 141                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142      }                                                                                                             </span>
<span  style=""> 143                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 144      @Override                                                                                                     </span>
<span class="-6302640138359785349" onmouseenter="enter('-6302640138359785349');" onmouseout="out('-6302640138359785349');" style=""> 145      protected void onNewIntent(Intent incoming) {                                                                 </span>
<span class="-8811924227565660535" onmouseenter="enter('-8811924227565660535');" onmouseout="out('-8811924227565660535');" style=""> 146          incoming.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);                       </span>
<span class="3914907222764799912" onmouseenter="enter('3914907222764799912');" onmouseout="out('3914907222764799912');" style=""> 147          super.onNewIntent(incoming);                                                                              </span>
<span class="9221581554438190622" onmouseenter="enter('9221581554438190622');" onmouseout="out('9221581554438190622');" style=""> 148          confUri = incoming.getData();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -    @Override                                                                                                     </span>
<span class="302393315460284103" onmouseenter="enter('302393315460284103');" onmouseout="out('302393315460284103');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -    protected void onResume() {                                                                                   </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -        super.onResume();                                                                                         </span>
<span class="-1033981458626162610" onmouseenter="enter('-1033981458626162610');" onmouseout="out('-1033981458626162610');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -        String queryString = &quot;&quot;;                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -                                                                                                                  </span>
<span class="-2276587090849303814" onmouseenter="enter('-2276587090849303814');" onmouseout="out('-2276587090849303814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -        if (confUri != null) {                                                                                    </span>
<span class="-1088791743364895452" onmouseenter="enter('-1088791743364895452');" onmouseout="out('-1088791743364895452');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -            //getting back with configuration data                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -            try {                                                                                                 </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -                appUuid = UUID.fromString(confUri.getHost());                                                     </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -                queryString = confUri.getEncodedQuery();                                                          </span>
<span class="-1471183022667940231" onmouseenter="enter('-1471183022667940231');" onmouseout="out('-1471183022667940231');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -            } catch (IllegalArgumentException e) {                                                                </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -                GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -            }                                                                                                     </span>
<span class="-2988483940896729254" onmouseenter="enter('-2988483940896729254');" onmouseout="out('-2988483940896729254');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -            myWebView.loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -                                                                                                                  </span>
<span class="769030667235534270" onmouseenter="enter('769030667235534270');" onmouseout="out('769030667235534270');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -    private JSONObject getAppConfigurationKeys() {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -        try {                                                                                                     </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -            File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                              </span>
<span class="7281362543496976323" onmouseenter="enter('7281362543496976323');" onmouseout="out('7281362543496976323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -            File configurationFile = new File(destDir, appUuid.toString() + &quot;.json&quot;);                             </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -            if (configurationFile.exists()) {                                                                     </span>
<span class="5694613783798252219" onmouseenter="enter('5694613783798252219');" onmouseout="out('5694613783798252219');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -                String jsonstring = FileUtils.getStringFromFile(configurationFile);                               </span>
<span class="3207864232207206976" onmouseenter="enter('3207864232207206976');" onmouseout="out('3207864232207206976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -                JSONObject json = new JSONObject(jsonstring);                                                     </span>
<span class="-8008487347845491336" onmouseenter="enter('-8008487347845491336');" onmouseout="out('-8008487347845491336');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -                return json.getJSONObject(&quot;appKeys&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -            }                                                                                                     </span>
<span class="-5708376673499870750" onmouseenter="enter('-5708376673499870750');" onmouseout="out('-5708376673499870750');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -        } catch (IOException | JSONException e) {                                                                 </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -            e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -        }                                                                                                         </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -        return null;                                                                                              </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                                                                                                                  </span>
<span class="489042004245109682" onmouseenter="enter('489042004245109682');" onmouseout="out('489042004245109682');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -    private class GBChromeClient extends WebChromeClient {                                                        </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -        @Override                                                                                                 </span>
<span class="-3208398659097747584" onmouseenter="enter('-3208398659097747584');" onmouseout="out('-3208398659097747584');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -        public boolean onConsoleMessage(ConsoleMessage consoleMessage) {                                          </span>
<span class="-2287224413451901168" onmouseenter="enter('-2287224413451901168');" onmouseout="out('-2287224413451901168');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -            if (ConsoleMessage.MessageLevel.ERROR.equals(consoleMessage.messageLevel())) {                        </span>
<span class="3323572400278979475" onmouseenter="enter('3323572400278979475');" onmouseout="out('3323572400278979475');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                GB.toast(consoleMessage.message(), Toast.LENGTH_LONG, GB.ERROR);                                  </span>
<span class="-6164745287293097307" onmouseenter="enter('-6164745287293097307');" onmouseout="out('-6164745287293097307');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                //TODO: show error page                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -            }                                                                                                     </span>
<span class="8867653795588053101" onmouseenter="enter('8867653795588053101');" onmouseout="out('8867653795588053101');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -            return super.onConsoleMessage(consoleMessage);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -                                                                                                                  </span>
<span class="932716910050395867" onmouseenter="enter('932716910050395867');" onmouseout="out('932716910050395867');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -    private class GBWebClient extends WebViewClient {                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -        @Override                                                                                                 </span>
<span class="-5389283987146508641" onmouseenter="enter('-5389283987146508641');" onmouseout="out('-5389283987146508641');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -        public boolean shouldOverrideUrlLoading(WebView view, String url) {                                       </span>
<span class="-4470283582819493832" onmouseenter="enter('-4470283582819493832');" onmouseout="out('-4470283582819493832');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -            if (url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;)) {                                        </span>
<span class="-6889520962166578594" onmouseenter="enter('-6889520962166578594');" onmouseout="out('-6889520962166578594');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -                Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(url));                                        </span>
<span class="-83312019167722588" onmouseenter="enter('-83312019167722588');" onmouseout="out('-83312019167722588');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -                i.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);                      </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                startActivity(i);                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -            } else {                                                                                              </span>
<span class="7355344190067323951" onmouseenter="enter('7355344190067323951');" onmouseout="out('7355344190067323951');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 204 -                url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.html?config=true&amp;json=&quot;);"> 204 -                url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.html?confðŸ”µ</abbr></span>
<span class="901384492729237222" onmouseenter="enter('901384492729237222');" onmouseout="out('901384492729237222');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                view.loadUrl(url);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -                                                                                                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -            return true;                                                                                          </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -                                                                                                                  </span>
<span class="255546914543038546" onmouseenter="enter('255546914543038546');" onmouseout="out('255546914543038546');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -    private class JSInterface {                                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -                                                                                                                  </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -        Context mContext;                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -                                                                                                                  </span>
<span class="6103178023340228960" onmouseenter="enter('6103178023340228960');" onmouseout="out('6103178023340228960');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -        public JSInterface(Context c) {                                                                           </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -            mContext = c;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -        @JavascriptInterface                                                                                      </span>
<span class="778974974852788407" onmouseenter="enter('778974974852788407');" onmouseout="out('778974974852788407');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -        public void gbLog(String msg) {                                                                           </span>
<span class="3027670622554237141" onmouseenter="enter('3027670622554237141');" onmouseout="out('3027670622554237141');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -            Log.d(&quot;WEBVIEW&quot;, msg);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -        @JavascriptInterface                                                                                      </span>
<span class="-4624663689886901579" onmouseenter="enter('-4624663689886901579');" onmouseout="out('-4624663689886901579');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -        public void sendAppMessage(String msg) {                                                                  </span>
<span class="-6201194628403629089" onmouseenter="enter('-6201194628403629089');" onmouseout="out('-6201194628403629089');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -            LOG.debug(&quot;from WEBVIEW: &quot; + msg);                                                                    </span>
<span class="-7234772518000694242" onmouseenter="enter('-7234772518000694242');" onmouseout="out('-7234772518000694242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -            JSONObject knownKeys = getAppConfigurationKeys();                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -                                                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -            try {                                                                                                 </span>
<span class="8379171825524475613" onmouseenter="enter('8379171825524475613');" onmouseout="out('8379171825524475613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -                JSONObject in = new JSONObject(msg);                                                              </span>
<span class="3835181569981110952" onmouseenter="enter('3835181569981110952');" onmouseout="out('3835181569981110952');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -                JSONObject out = new JSONObject();                                                                </span>
<span class="-5432090303292230287" onmouseenter="enter('-5432090303292230287');" onmouseout="out('-5432090303292230287');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 234 -                String inKey, outKey;                                                                             </span>
<span class="-6755195952504918332" onmouseenter="enter('-6755195952504918332');" onmouseout="out('-6755195952504918332');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -                boolean passKey;                                                                                  </span>
<span class="195888856154758018" onmouseenter="enter('195888856154758018');" onmouseout="out('195888856154758018');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -                for (Iterator&lt;String&gt; key = in.keys(); key.hasNext(); ) {                                         </span>
<span class="35427419901421521" onmouseenter="enter('35427419901421521');" onmouseout="out('35427419901421521');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -                    passKey = false;                                                                              </span>
<span class="7300242526186641878" onmouseenter="enter('7300242526186641878');" onmouseout="out('7300242526186641878');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -                    inKey = key.next();                                                                           </span>
<span class="1625279893230829750" onmouseenter="enter('1625279893230829750');" onmouseout="out('1625279893230829750');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -                    outKey = null;                                                                                </span>
<span class="-8000058323286219252" onmouseenter="enter('-8000058323286219252');" onmouseout="out('-8000058323286219252');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -                    int pebbleAppIndex = knownKeys.optInt(inKey, -1);                                             </span>
<span class="1318599845650471336" onmouseenter="enter('1318599845650471336');" onmouseout="out('1318599845650471336');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -                    if (pebbleAppIndex != -1) {                                                                   </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -                        passKey = true;                                                                           </span>
<span class="6093149884609226755" onmouseenter="enter('6093149884609226755');" onmouseout="out('6093149884609226755');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -                        outKey = String.valueOf(pebbleAppIndex);                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -                    } else {                                                                                      </span>
<span class="1471897956818349080" onmouseenter="enter('1471897956818349080');" onmouseout="out('1471897956818349080');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 245 -                        //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-pebblekit-js/ )"> 245 -                        //do not discard integer keys (see https://developer.pebble.com/guides/communication/usingðŸ”µ</abbr></span>
<span class="9182410012949841341" onmouseenter="enter('9182410012949841341');" onmouseout="out('9182410012949841341');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -                        Scanner scanner = new Scanner(inKey);                                                     </span>
<span class="3432714770914509184" onmouseenter="enter('3432714770914509184');" onmouseout="out('3432714770914509184');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -                        if (scanner.hasNextInt() &amp;&amp; inKey.equals(&quot;&quot; + scanner.nextInt())) {                       </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -                            passKey = true;                                                                       </span>
<span class="633307466455829355" onmouseenter="enter('633307466455829355');" onmouseout="out('633307466455829355');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 249 -                            outKey = inKey;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                    }                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                                                                                                                  </span>
<span class="7100715742750083788" onmouseenter="enter('7100715742750083788');" onmouseout="out('7100715742750083788');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                    if (passKey) {                                                                                </span>
<span class="-1814814172109868162" onmouseenter="enter('-1814814172109868162');" onmouseout="out('-1814814172109868162');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -                        Object obj = in.get(inKey);                                                               </span>
<span class="-2516604200979810702" onmouseenter="enter('-2516604200979810702');" onmouseout="out('-2516604200979810702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                        if (obj instanceof Boolean) {                                                             </span>
<span class="3988738952494779303" onmouseenter="enter('3988738952494779303');" onmouseout="out('3988738952494779303');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -                            obj = ((Boolean) obj) ? &quot;true&quot; : &quot;false&quot;;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -                        }                                                                                         </span>
<span class="7889737448406399667" onmouseenter="enter('7889737448406399667');" onmouseout="out('7889737448406399667');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                        out.put(outKey, obj);                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -                    } else {                                                                                      </span>
<span class="-2054330584630270669" onmouseenter="enter('-2054330584630270669');" onmouseout="out('-2054330584630270669');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 260 -                        GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an integer key.&quot;, Toast.LENGTH_SHORT, GB.WARN);"> 260 -                        GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -                    }                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -                }                                                                                                 </span>
<span class="-881732067758657379" onmouseenter="enter('-881732067758657379');" onmouseout="out('-881732067758657379');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -                LOG.info(out.toString());                                                                         </span>
<span class="-2343027273789634583" onmouseenter="enter('-2343027273789634583');" onmouseout="out('-2343027273789634583');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                GBApplication.deviceService().onAppConfiguration(appUuid, out.toString());                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -                                                                                                                  </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -            } catch (JSONException e) {                                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -                e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 271 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -        @JavascriptInterface                                                                                      </span>
<span class="-5632539219238112893" onmouseenter="enter('-5632539219238112893');" onmouseout="out('-5632539219238112893');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -        public String getActiveWatchInfo() {                                                                      </span>
<span class="-843298888064131140" onmouseenter="enter('-843298888064131140');" onmouseout="out('-843298888064131140');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -            JSONObject wi = new JSONObject();                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -            try {                                                                                                 </span>
<span class="-7073207729972829278" onmouseenter="enter('-7073207729972829278');" onmouseout="out('-7073207729972829278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 276 -                wi.put(&quot;firmware&quot;, mGBDevice.getFirmwareVersion());                                               </span>
<span class="1619143394428866421" onmouseenter="enter('1619143394428866421');" onmouseout="out('1619143394428866421');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -                wi.put(&quot;platform&quot;, PebbleUtils.getPlatformName(mGBDevice.getModel()));                            </span>
<span class="-5437394903337435394" onmouseenter="enter('-5437394903337435394');" onmouseout="out('-5437394903337435394');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -                wi.put(&quot;model&quot;, PebbleUtils.getModel(mGBDevice.getModel()));                                      </span>
<span class="6629264299746547541" onmouseenter="enter('6629264299746547541');" onmouseout="out('6629264299746547541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -                //TODO: use real info                                                                             </span>
<span class="118738678871371777" onmouseenter="enter('118738678871371777');" onmouseout="out('118738678871371777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -                wi.put(&quot;language&quot;, &quot;en&quot;);                                                                         </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -            } catch (JSONException e) {                                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 282 -                e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -            }                                                                                                     </span>
<span class="2996545006566015873" onmouseenter="enter('2996545006566015873');" onmouseout="out('2996545006566015873');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -            //Json not supported apparently, we need to cast back and forth                                       </span>
<span class="5839065679891034244" onmouseenter="enter('5839065679891034244');" onmouseout="out('5839065679891034244');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -            return wi.toString();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -        @JavascriptInterface                                                                                      </span>
<span class="-856046329422320734" onmouseenter="enter('-856046329422320734');" onmouseout="out('-856046329422320734');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -        public String getAppConfigurationFile() {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -            try {                                                                                                 </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -                File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                          </span>
<span class="-6190799366778164723" onmouseenter="enter('-6190799366778164723');" onmouseout="out('-6190799366778164723');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -                File configurationFile = new File(destDir, appUuid.toString() + &quot;_config.js&quot;);                    </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -                if (configurationFile.exists()) {                                                                 </span>
<span class="-736461147530501961" onmouseenter="enter('-736461147530501961');" onmouseout="out('-736461147530501961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -                    return &quot;file:///&quot; + configurationFile.getAbsolutePath();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -                }                                                                                                 </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -            } catch (IOException e) {                                                                             </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -                e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -            }                                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -            return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -        @JavascriptInterface                                                                                      </span>
<span class="7186673836371686422" onmouseenter="enter('7186673836371686422');" onmouseout="out('7186673836371686422');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -        public String getAppStoredPreset() {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 304 -            try {                                                                                                 </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 305 -                File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                          </span>
<span class="-1650511077982903195" onmouseenter="enter('-1650511077982903195');" onmouseout="out('-1650511077982903195');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 306 -                File configurationFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                  </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 307 -                if (configurationFile.exists()) {                                                                 </span>
<span class="-4631811320466918610" onmouseenter="enter('-4631811320466918610');" onmouseout="out('-4631811320466918610');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 308 -                    return FileUtils.getStringFromFile(configurationFile);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 309 -                }                                                                                                 </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 310 -            } catch (IOException e) {                                                                             </span>
<span class="-1248445865590398413" onmouseenter="enter('-1248445865590398413');" onmouseout="out('-1248445865590398413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 311 -                GB.toast(&quot;Error reading presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 312 -                e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 313 -            }                                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 314 -            return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 315 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 316 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 317 -        @JavascriptInterface                                                                                      </span>
<span class="-6701887776194876087" onmouseenter="enter('-6701887776194876087');" onmouseout="out('-6701887776194876087');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 318 -        public void saveAppStoredPreset(String msg) {                                                             </span>
<span class="-192245887358676257" onmouseenter="enter('-192245887358676257');" onmouseout="out('-192245887358676257');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 319 -            Writer writer;                                                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 320 -                                                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 321 -            try {                                                                                                 </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 322 -                File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                          </span>
<span class="3603668645457989644" onmouseenter="enter('3603668645457989644');" onmouseout="out('3603668645457989644');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 323 -                File presetsFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                        </span>
<span class="-2643535316378223379" onmouseenter="enter('-2643535316378223379');" onmouseout="out('-2643535316378223379');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 324 -                writer = new BufferedWriter(new FileWriter(presetsFile));                                         </span>
<span class="-5700221122508670675" onmouseenter="enter('-5700221122508670675');" onmouseout="out('-5700221122508670675');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 325 -                writer.write(msg);                                                                                </span>
<span class="4330639758910844474" onmouseenter="enter('4330639758910844474');" onmouseout="out('4330639758910844474');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 326 -                writer.close();                                                                                   </span>
<span class="-850015778348175113" onmouseenter="enter('-850015778348175113');" onmouseout="out('-850015778348175113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 327 -                GB.toast(&quot;Presets stored&quot;, Toast.LENGTH_SHORT, GB.INFO);                                          </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 328 -            } catch (IOException e) {                                                                             </span>
<span class="-4875214328390419177" onmouseenter="enter('-4875214328390419177');" onmouseout="out('-4875214328390419177');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 329 -                GB.toast(&quot;Error storing presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 330 -                e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 331 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 332 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 333 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 334 -        @JavascriptInterface                                                                                      </span>
<span class="-8118311426044261956" onmouseenter="enter('-8118311426044261956');" onmouseout="out('-8118311426044261956');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 335 -        public String getAppUUID() {                                                                              </span>
<span class="-5609100198503319527" onmouseenter="enter('-5609100198503319527');" onmouseout="out('-5609100198503319527');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 336 -            return appUuid.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 337 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 338 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 339 -        @JavascriptInterface                                                                                      </span>
<span class="-2024961006635561560" onmouseenter="enter('-2024961006635561560');" onmouseout="out('-2024961006635561560');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 340 -        public String getAppLocalstoragePrefix() {                                                                </span>
<span class="-139042831100003478" onmouseenter="enter('-139042831100003478');" onmouseout="out('-139042831100003478');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 341 -            String prefix = mGBDevice.getAddress() + appUuid.toString();                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 342 -            try {                                                                                                 </span>
<span class="1589472625916860471" onmouseenter="enter('1589472625916860471');" onmouseout="out('1589472625916860471');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 343 -                MessageDigest digest = MessageDigest.getInstance(&quot;SHA-1&quot;);                                        </span>
<span class="-1715536820593379285" onmouseenter="enter('-1715536820593379285');" onmouseout="out('-1715536820593379285');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 344 -                byte[] bytes = prefix.getBytes(&quot;UTF-8&quot;);                                                          </span>
<span class="-6693486492020146741" onmouseenter="enter('-6693486492020146741');" onmouseout="out('-6693486492020146741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 345 -                digest.update(bytes, 0, bytes.length);                                                            </span>
<span class="-4062246525168346439" onmouseenter="enter('-4062246525168346439');" onmouseout="out('-4062246525168346439');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 346 -                bytes = digest.digest();                                                                          </span>
<span class="1334999931346445764" onmouseenter="enter('1334999931346445764');" onmouseout="out('1334999931346445764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 347 -                final StringBuilder sb = new StringBuilder();                                                     </span>
<span class="-7387509961039532833" onmouseenter="enter('-7387509961039532833');" onmouseout="out('-7387509961039532833');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 348 -                for (int i = 0; i &lt; bytes.length; i++) {                                                          </span>
<span class="7651397204661452382" onmouseenter="enter('7651397204661452382');" onmouseout="out('7651397204661452382');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 349 -                    sb.append(String.format(&quot;%02X&quot;, bytes[i]));                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 350 -                }                                                                                                 </span>
<span class="6091843332607413306" onmouseenter="enter('6091843332607413306');" onmouseout="out('6091843332607413306');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 351 -                return sb.toString().toLowerCase();                                                               </span>
<span class="5663120823918718146" onmouseenter="enter('5663120823918718146');" onmouseout="out('5663120823918718146');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 352 -            } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {                                 </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 353 -                e.printStackTrace();                                                                              </span>
<span class="-5295149366119702820" onmouseenter="enter('-5295149366119702820');" onmouseout="out('-5295149366119702820');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 354 -                return prefix;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 355 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 356 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 357 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 358 -        @JavascriptInterface                                                                                      </span>
<span class="6682389599781806833" onmouseenter="enter('6682389599781806833');" onmouseout="out('6682389599781806833');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 359 -        public String getWatchToken() {                                                                           </span>
<span class="588975967419017208" onmouseenter="enter('588975967419017208');" onmouseout="out('588975967419017208');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 360 -            //specification says: A string that is guaranteed to be identical for each Pebble device for the same app across different mobile devices. The token is unique to your app and cannot be used to track Pebble devices across applications. see https://developer.pebble.com/docs/js/Pebble/"> 360 -            //specification says: A string that is guaranteed to be identical for each Pebble device for the same ðŸ”µ</abbr></span>
<span class="1141582625581442566" onmouseenter="enter('1141582625581442566');" onmouseout="out('1141582625581442566');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 361 -            return &quot;gb&quot; + appUuid.toString();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 362 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 363 -                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 364 -        @JavascriptInterface                                                                                      </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 365 -        public void closeActivity() {                                                                             </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 366 -            NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 367 -        }                                                                                                         </span>













































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368      }                                                                                                             </span>
<span  style=""> 369                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 370      @Override                                                                                                     </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 371      public boolean onOptionsItemSelected(MenuItem item) {                                                         </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 372          switch (item.getItemId()) {                                                                               </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 373              case android.R.id.home:                                                                               </span>
<span class="-1694655592982141021" onmouseenter="enter('-1694655592982141021');" onmouseout="out('-1694655592982141021');" style=""> 374                  NavUtils.navigateUpFromSameTask(this);                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 375                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 376          }                                                                                                         </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 377          return super.onOptionsItemSelected(item);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378      }                                                                                                             </span>
<span  style=""> 379                                                                                                                    </span>
<span class="2223760692968598534" onmouseenter="enter('2223760692968598534');" onmouseout="out('2223760692968598534');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 380 +    private class ActivityJSInterface {                                                                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 381 +                                                                                                                  </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 382 +        Context mContext;                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 383 +                                                                                                                  </span>
<span class="2859735092534969408" onmouseenter="enter('2859735092534969408');" onmouseout="out('2859735092534969408');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 384 +        public ActivityJSInterface(Context c) {                                                                   </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 385 +            mContext = c;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 386 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 387 +                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 388 +        @JavascriptInterface                                                                                      </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 389 +        public void closeActivity() {                                                                             </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 390 +            NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 391 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 392 +    }                                                                                                             </span>
<span  style=""> 393                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="-7393740638519443947" onmouseenter="enter('-7393740638519443947');" onmouseout="out('-7393740638519443947');" style="">   1  package nodomain.freeyourgadget.gadgetbridge.activities;                                                          </span>
<span  style="">   2                                                                                                                    </span>
<span class="3857212678176399715" onmouseenter="enter('3857212678176399715');" onmouseout="out('3857212678176399715');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   3 +import android.Manifest;                                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5  import android.content.Intent;                                                                                    </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   6 +import android.content.pm.PackageManager;                                                                         </span>
<span class="907171826859240605" onmouseenter="enter('907171826859240605');" onmouseout="out('907171826859240605');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   7 +import android.location.Criteria;                                                                                 </span>
<span class="-4559785959657295211" onmouseenter="enter('-4559785959657295211');" onmouseout="out('-4559785959657295211');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   8 +import android.location.Location;                                                                                 </span>
<span class="8236022111747117642" onmouseenter="enter('8236022111747117642');" onmouseout="out('8236022111747117642');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 +import android.location.LocationManager;                                                                          </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  10  import android.net.Uri;                                                                                           </span>

<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  11  import android.os.Bundle;                                                                                         </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  12 +import android.support.v4.app.ActivityCompat;                                                                     </span>
<span class="6797968843617414504" onmouseenter="enter('6797968843617414504');" onmouseout="out('6797968843617414504');" style="">  13  import android.support.v4.app.NavUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  14  import android.util.Log;                                                                                          </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  15  import android.view.MenuItem;                                                                                     </span>
<span class="4354626559660197873" onmouseenter="enter('4354626559660197873');" onmouseout="out('4354626559660197873');" style="">  16  import android.webkit.ConsoleMessage;                                                                             </span>

<span class="-6388096999790135816" onmouseenter="enter('-6388096999790135816');" onmouseout="out('-6388096999790135816');" style="">  17  import android.webkit.JavascriptInterface;                                                                        </span>
<span class="-8622242184377527379" onmouseenter="enter('-8622242184377527379');" onmouseout="out('-8622242184377527379');" style="">  18  import android.webkit.WebChromeClient;                                                                            </span>
<span class="-5080310458335134854" onmouseenter="enter('-5080310458335134854');" onmouseout="out('-5080310458335134854');" style="">  19  import android.webkit.WebSettings;                                                                                </span>

<span class="2723690893492346945" onmouseenter="enter('2723690893492346945');" onmouseout="out('2723690893492346945');" style="">  20  import android.webkit.WebView;                                                                                    </span>
<span class="-3167847991483127041" onmouseenter="enter('-3167847991483127041');" onmouseout="out('-3167847991483127041');" style="">  21  import android.webkit.WebViewClient;                                                                              </span>

<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  22  import android.widget.Toast;                                                                                      </span>
<span  style="">  23                                                                                                                    </span>
<span class="-8573375701834280359" onmouseenter="enter('-8573375701834280359');" onmouseout="out('-8573375701834280359');" style="">  24  import org.json.JSONException;                                                                                    </span>
<span class="7232075261178918144" onmouseenter="enter('7232075261178918144');" onmouseout="out('7232075261178918144');" style="">  25  import org.json.JSONObject;                                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  26  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  27  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  28                                                                                                                    </span>
<span class="-6983162919371453239" onmouseenter="enter('-6983162919371453239');" onmouseout="out('-6983162919371453239');" style="">  29  import java.io.BufferedWriter;                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  30  import java.io.File;                                                                                              </span>
<span class="4914725365521379617" onmouseenter="enter('4914725365521379617');" onmouseout="out('4914725365521379617');" style="">  31  import java.io.FileWriter;                                                                                        </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  32  import java.io.IOException;                                                                                       </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  33  import java.io.UnsupportedEncodingException;                                                                      </span>
<span class="7630846594806589523" onmouseenter="enter('7630846594806589523');" onmouseout="out('7630846594806589523');" style="">  34  import java.io.Writer;                                                                                            </span>
<span class="6381430938828950472" onmouseenter="enter('6381430938828950472');" onmouseout="out('6381430938828950472');" style="">  35  import java.security.MessageDigest;                                                                               </span>
<span class="-1748023591259675388" onmouseenter="enter('-1748023591259675388');" onmouseout="out('-1748023591259675388');" style="">  36  import java.security.NoSuchAlgorithmException;                                                                    </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="">  37  import java.util.Iterator;                                                                                        </span>
<span class="-6589962362033146913" onmouseenter="enter('-6589962362033146913');" onmouseout="out('-6589962362033146913');" style="">  38  import java.util.Scanner;                                                                                         </span>
<span class="2390503830490498598" onmouseenter="enter('2390503830490498598');" onmouseout="out('2390503830490498598');" style="">  39  import java.util.UUID;                                                                                            </span>
<span  style="">  40                                                                                                                    </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="">  41  import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                                        </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  42  import nodomain.freeyourgadget.gadgetbridge.R;                                                                    </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  43  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  44  import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                                  </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  45  import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                                       </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  46  import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                              </span>
<span class="4645284583739884744" onmouseenter="enter('4645284583739884744');" onmouseout="out('4645284583739884744');" style="">  47  import nodomain.freeyourgadget.gadgetbridge.util.PebbleUtils;                                                     </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                           </span>
<span  style="">  49                                                                                                                    </span>
<span class="8425816362509139849" onmouseenter="enter('8425816362509139849');" onmouseout="out('8425816362509139849');" style="">  50  public class ExternalPebbleJSActivity extends GBActivity {                                                        </span>
<span  style="">  51                                                                                                                    </span>
<span class="8136098019960083823" onmouseenter="enter('8136098019960083823');" onmouseout="out('8136098019960083823');" style="">  52      private static final Logger LOG = LoggerFactory.getLogger(ExternalPebbleJSActivity.class);                    </span>
<span  style="">  53                                                                                                                    </span>
<span class="3065437899111201345" onmouseenter="enter('3065437899111201345');" onmouseout="out('3065437899111201345');" style="">  54      private UUID appUuid;                                                                                         </span>
<span class="9027266421678696690" onmouseenter="enter('9027266421678696690');" onmouseout="out('9027266421678696690');" style="">  55      private Uri confUri;                                                                                          </span>
<span class="-5535852384441440556" onmouseenter="enter('-5535852384441440556');" onmouseout="out('-5535852384441440556');" style="">  56      private GBDevice mGBDevice = null;                                                                            </span>
<span class="6615780427500382937" onmouseenter="enter('6615780427500382937');" onmouseout="out('6615780427500382937');" style="">  57      private WebView myWebView;                                                                                    </span>
<span  style="">  58                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  59      @Override                                                                                                     </span>
<span class="6892052666771236398" onmouseenter="enter('6892052666771236398');" onmouseout="out('6892052666771236398');" style="">  60      protected void onCreate(Bundle savedInstanceState) {                                                          </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style="">  61          super.onCreate(savedInstanceState);                                                                       </span>
<span  style="">  62                                                                                                                    </span>
<span class="-871894361009470891" onmouseenter="enter('-871894361009470891');" onmouseout="out('-871894361009470891');" style="">  63          Bundle extras = getIntent().getExtras();                                                                  </span>
<span class="8849338589512660035" onmouseenter="enter('8849338589512660035');" onmouseout="out('8849338589512660035');" style="">  64          if (extras != null) {                                                                                     </span>
<span class="3724295817671341281" onmouseenter="enter('3724295817671341281');" onmouseout="out('3724295817671341281');" style="">  65              mGBDevice = extras.getParcelable(GBDevice.EXTRA_DEVICE);                                              </span>
<span class="2716088159317727473" onmouseenter="enter('2716088159317727473');" onmouseout="out('2716088159317727473');" style="">  66              appUuid = (UUID) extras.getSerializable(DeviceService.EXTRA_APP_UUID);                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  67          } else {                                                                                                  </span>
<span class="496962713155353134" onmouseenter="enter('496962713155353134');" onmouseout="out('496962713155353134');" style="">  68              throw new IllegalArgumentException(&quot;Must provide a device when invoking this activity&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69          }                                                                                                         </span>
<span  style="">  70                                                                                                                    </span>
<span  style="">  71                                                                                                                    </span>
<span class="8370604561035257296" onmouseenter="enter('8370604561035257296');" onmouseout="out('8370604561035257296');" style="">  72          setContentView(R.layout.activity_external_pebble_js);                                                     </span>
<span  style="">  73                                                                                                                    </span>
<span class="3269004064107631113" onmouseenter="enter('3269004064107631113');" onmouseout="out('3269004064107631113');" style="">  74          myWebView = (WebView) findViewById(R.id.configureWebview);                                                </span>
<span class="6951369669181364933" onmouseenter="enter('6951369669181364933');" onmouseout="out('6951369669181364933');" style="">  75          myWebView.clearCache(true);                                                                               </span>
<span class="-5098710959804433945" onmouseenter="enter('-5098710959804433945');" onmouseout="out('-5098710959804433945');" style="">  76          myWebView.setWebViewClient(new GBWebClient());                                                            </span>
<span class="-2143743775779870741" onmouseenter="enter('-2143743775779870741');" onmouseout="out('-2143743775779870741');" style="">  77          myWebView.setWebChromeClient(new GBChromeClient());                                                       </span>
<span class="5965560249615903209" onmouseenter="enter('5965560249615903209');" onmouseout="out('5965560249615903209');" style="">  78          WebSettings webSettings = myWebView.getSettings();                                                        </span>
<span class="-1279216538078347487" onmouseenter="enter('-1279216538078347487');" onmouseout="out('-1279216538078347487');" style="">  79          webSettings.setJavaScriptEnabled(true);                                                                   </span>
<span class="-2569197401274859417" onmouseenter="enter('-2569197401274859417');" onmouseout="out('-2569197401274859417');" style="">  80          //needed to access the DOM                                                                                </span>
<span class="2427407921833264579" onmouseenter="enter('2427407921833264579');" onmouseout="out('2427407921833264579');" style="">  81          webSettings.setDomStorageEnabled(true);                                                                   </span>
<span class="1207861921184281084" onmouseenter="enter('1207861921184281084');" onmouseout="out('1207861921184281084');" style="">  82          //needed for localstorage                                                                                 </span>
<span class="-5630325944023181441" onmouseenter="enter('-5630325944023181441');" onmouseout="out('-5630325944023181441');" style="">  83          webSettings.setDatabaseEnabled(true);                                                                     </span>





<span  style="">  84                                                                                                                    </span>
<span class="8665171849228936593" onmouseenter="enter('8665171849228936593');" onmouseout="out('8665171849228936593');" style="">  85          JSInterface gbJSInterface = new JSInterface(this);                                                        </span>
<span class="4777223995400399502" onmouseenter="enter('4777223995400399502');" onmouseout="out('4777223995400399502');" style="">  86          myWebView.addJavascriptInterface(gbJSInterface, &quot;GBjs&quot;);                                                  </span>
<span  style="">  87                                                                                                                    </span>
<span class="-1759263916770348713" onmouseenter="enter('-1759263916770348713');" onmouseout="out('-1759263916770348713');" style="">  88          myWebView.loadUrl(&quot;file:///android_asset/app_config/configure.html&quot;);                                     </span>

















































<span  style="">  89                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90      }                                                                                                             </span>
<span  style="">  91                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  92      @Override                                                                                                     </span>
<span class="-6302640138359785349" onmouseenter="enter('-6302640138359785349');" onmouseout="out('-6302640138359785349');" style="">  93      protected void onNewIntent(Intent incoming) {                                                                 </span>
<span class="-8811924227565660535" onmouseenter="enter('-8811924227565660535');" onmouseout="out('-8811924227565660535');" style="">  94          incoming.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);                       </span>
<span class="3914907222764799912" onmouseenter="enter('3914907222764799912');" onmouseout="out('3914907222764799912');" style="">  95          super.onNewIntent(incoming);                                                                              </span>
<span class="9221581554438190622" onmouseenter="enter('9221581554438190622');" onmouseout="out('9221581554438190622');" style="">  96          confUri = incoming.getData();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97      }                                                                                                             </span>
<span  style="">  98                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  99      @Override                                                                                                     </span>
<span class="302393315460284103" onmouseenter="enter('302393315460284103');" onmouseout="out('302393315460284103');" style=""> 100      protected void onResume() {                                                                                   </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style=""> 101          super.onResume();                                                                                         </span>
<span class="-1033981458626162610" onmouseenter="enter('-1033981458626162610');" onmouseout="out('-1033981458626162610');" style=""> 102          String queryString = &quot;&quot;;                                                                                  </span>
<span  style=""> 103                                                                                                                    </span>
<span class="-2276587090849303814" onmouseenter="enter('-2276587090849303814');" onmouseout="out('-2276587090849303814');" style=""> 104          if (confUri != null) {                                                                                    </span>
<span class="-1088791743364895452" onmouseenter="enter('-1088791743364895452');" onmouseout="out('-1088791743364895452');" style=""> 105              //getting back with configuration data                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 106              try {                                                                                                 </span>
<span class="-4798819128469600693" onmouseenter="enter('-4798819128469600693');" onmouseout="out('-4798819128469600693');" style=""> 107                  appUuid = UUID.fromString(confUri.getHost());                                                     </span>
<span class="-8576165483268077857" onmouseenter="enter('-8576165483268077857');" onmouseout="out('-8576165483268077857');" style=""> 108                  queryString = confUri.getEncodedQuery();                                                          </span>
<span class="-1471183022667940231" onmouseenter="enter('-1471183022667940231');" onmouseout="out('-1471183022667940231');" style=""> 109              } catch (IllegalArgumentException e) {                                                                </span>
<span class="511443036290852821" onmouseenter="enter('511443036290852821');" onmouseout="out('511443036290852821');" style=""> 110                  GB.toast(&quot;returned uri: &quot; + confUri.toString(), Toast.LENGTH_LONG, GB.ERROR);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111              }                                                                                                     </span>
<span class="-2988483940896729254" onmouseenter="enter('-2988483940896729254');" onmouseout="out('-2988483940896729254');" style=""> 112              myWebView.loadUrl(&quot;file:///android_asset/app_config/configure.html?&quot; + queryString);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113          }                                                                                                         </span>
<span  style=""> 114                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115      }                                                                                                             </span>
<span  style=""> 116                                                                                                                    </span>
<span class="769030667235534270" onmouseenter="enter('769030667235534270');" onmouseout="out('769030667235534270');" style=""> 117      private JSONObject getAppConfigurationKeys() {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 118          try {                                                                                                     </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style=""> 119              File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                              </span>
<span class="7281362543496976323" onmouseenter="enter('7281362543496976323');" onmouseout="out('7281362543496976323');" style=""> 120              File configurationFile = new File(destDir, appUuid.toString() + &quot;.json&quot;);                             </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style=""> 121              if (configurationFile.exists()) {                                                                     </span>
<span class="5694613783798252219" onmouseenter="enter('5694613783798252219');" onmouseout="out('5694613783798252219');" style=""> 122                  String jsonstring = FileUtils.getStringFromFile(configurationFile);                               </span>
<span class="3207864232207206976" onmouseenter="enter('3207864232207206976');" onmouseout="out('3207864232207206976');" style=""> 123                  JSONObject json = new JSONObject(jsonstring);                                                     </span>
<span class="-8008487347845491336" onmouseenter="enter('-8008487347845491336');" onmouseout="out('-8008487347845491336');" style=""> 124                  return json.getJSONObject(&quot;appKeys&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125              }                                                                                                     </span>
<span class="-5708376673499870750" onmouseenter="enter('-5708376673499870750');" onmouseout="out('-5708376673499870750');" style=""> 126          } catch (IOException | JSONException e) {                                                                 </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 127              e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128          }                                                                                                         </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 129          return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +                                                                                                                  </span>
<span class="-8943595674098220959" onmouseenter="enter('-8943595674098220959');" onmouseout="out('-8943595674098220959');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +    private boolean isLocationEnabledForWatchApp() {                                                              </span>
<span class="939192678715537627" onmouseenter="enter('939192678715537627');" onmouseout="out('939192678715537627');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +        return true; //as long as we don&#x27;t give watchapp internet access it&#x27;s not a problem                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134      }                                                                                                             </span>
<span  style=""> 135                                                                                                                    </span>
<span class="489042004245109682" onmouseenter="enter('489042004245109682');" onmouseout="out('489042004245109682');" style=""> 136      private class GBChromeClient extends WebChromeClient {                                                        </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 137          @Override                                                                                                 </span>
<span class="-3208398659097747584" onmouseenter="enter('-3208398659097747584');" onmouseout="out('-3208398659097747584');" style=""> 138          public boolean onConsoleMessage(ConsoleMessage consoleMessage) {                                          </span>
<span class="-2287224413451901168" onmouseenter="enter('-2287224413451901168');" onmouseout="out('-2287224413451901168');" style=""> 139              if (ConsoleMessage.MessageLevel.ERROR.equals(consoleMessage.messageLevel())) {                        </span>
<span class="3323572400278979475" onmouseenter="enter('3323572400278979475');" onmouseout="out('3323572400278979475');" style=""> 140                  GB.toast(consoleMessage.message(), Toast.LENGTH_LONG, GB.ERROR);                                  </span>
<span class="-6164745287293097307" onmouseenter="enter('-6164745287293097307');" onmouseout="out('-6164745287293097307');" style=""> 141                  //TODO: show error page                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142              }                                                                                                     </span>
<span class="8867653795588053101" onmouseenter="enter('8867653795588053101');" onmouseout="out('8867653795588053101');" style=""> 143              return super.onConsoleMessage(consoleMessage);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144          }                                                                                                         </span>
<span  style=""> 145                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146      }                                                                                                             </span>
<span  style=""> 147                                                                                                                    </span>
<span class="932716910050395867" onmouseenter="enter('932716910050395867');" onmouseout="out('932716910050395867');" style=""> 148      private class GBWebClient extends WebViewClient {                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 149          @Override                                                                                                 </span>
<span class="-5389283987146508641" onmouseenter="enter('-5389283987146508641');" onmouseout="out('-5389283987146508641');" style=""> 150          public boolean shouldOverrideUrlLoading(WebView view, String url) {                                       </span>
<span class="-4470283582819493832" onmouseenter="enter('-4470283582819493832');" onmouseout="out('-4470283582819493832');" style=""> 151              if (url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;)) {                                        </span>
<span class="-6889520962166578594" onmouseenter="enter('-6889520962166578594');" onmouseout="out('-6889520962166578594');" style=""> 152                  Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(url));                                        </span>
<span class="-83312019167722588" onmouseenter="enter('-83312019167722588');" onmouseout="out('-83312019167722588');" style=""> 153                  i.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);                      </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style=""> 154                  startActivity(i);                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 155              } else {                                                                                              </span>
<span class="7355344190067323951" onmouseenter="enter('7355344190067323951');" onmouseout="out('7355344190067323951');" style=""><abbr title=" 156                  url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.html?config=true&amp;json=&quot;);"> 156                  url = url.replaceFirst(&quot;^pebblejs://close#&quot;, &quot;file:///android_asset/app_config/configure.html?confðŸ”µ</abbr></span>
<span class="901384492729237222" onmouseenter="enter('901384492729237222');" onmouseout="out('901384492729237222');" style=""> 157                  view.loadUrl(url);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158              }                                                                                                     </span>
<span  style=""> 159                                                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 160              return true;                                                                                          </span>
<span  style=""> 161                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163      }                                                                                                             </span>
<span  style=""> 164                                                                                                                    </span>
<span class="255546914543038546" onmouseenter="enter('255546914543038546');" onmouseout="out('255546914543038546');" style=""> 165      private class JSInterface {                                                                                   </span>
<span  style=""> 166                                                                                                                    </span>
<span class="-5996057254067063760" onmouseenter="enter('-5996057254067063760');" onmouseout="out('-5996057254067063760');" style=""> 167          Context mContext;                                                                                         </span>
<span  style=""> 168                                                                                                                    </span>
<span class="6103178023340228960" onmouseenter="enter('6103178023340228960');" onmouseout="out('6103178023340228960');" style=""> 169          public JSInterface(Context c) {                                                                           </span>
<span class="-8710869144070412829" onmouseenter="enter('-8710869144070412829');" onmouseout="out('-8710869144070412829');" style=""> 170              mContext = c;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171          }                                                                                                         </span>
<span  style=""> 172                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 173          @JavascriptInterface                                                                                      </span>
<span class="778974974852788407" onmouseenter="enter('778974974852788407');" onmouseout="out('778974974852788407');" style=""> 174          public void gbLog(String msg) {                                                                           </span>
<span class="3027670622554237141" onmouseenter="enter('3027670622554237141');" onmouseout="out('3027670622554237141');" style=""> 175              Log.d(&quot;WEBVIEW&quot;, msg);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176          }                                                                                                         </span>
<span  style=""> 177                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 178          @JavascriptInterface                                                                                      </span>
<span class="-4624663689886901579" onmouseenter="enter('-4624663689886901579');" onmouseout="out('-4624663689886901579');" style=""> 179          public void sendAppMessage(String msg) {                                                                  </span>
<span class="-6201194628403629089" onmouseenter="enter('-6201194628403629089');" onmouseout="out('-6201194628403629089');" style=""> 180              LOG.debug(&quot;from WEBVIEW: &quot; + msg);                                                                    </span>
<span class="-7234772518000694242" onmouseenter="enter('-7234772518000694242');" onmouseout="out('-7234772518000694242');" style=""> 181              JSONObject knownKeys = getAppConfigurationKeys();                                                     </span>
<span  style=""> 182                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 183              try {                                                                                                 </span>
<span class="8379171825524475613" onmouseenter="enter('8379171825524475613');" onmouseout="out('8379171825524475613');" style=""> 184                  JSONObject in = new JSONObject(msg);                                                              </span>
<span class="3835181569981110952" onmouseenter="enter('3835181569981110952');" onmouseout="out('3835181569981110952');" style=""> 185                  JSONObject out = new JSONObject();                                                                </span>
<span class="-5432090303292230287" onmouseenter="enter('-5432090303292230287');" onmouseout="out('-5432090303292230287');" style=""> 186                  String inKey, outKey;                                                                             </span>
<span class="-6755195952504918332" onmouseenter="enter('-6755195952504918332');" onmouseout="out('-6755195952504918332');" style=""> 187                  boolean passKey;                                                                                  </span>
<span class="195888856154758018" onmouseenter="enter('195888856154758018');" onmouseout="out('195888856154758018');" style=""> 188                  for (Iterator&lt;String&gt; key = in.keys(); key.hasNext(); ) {                                         </span>
<span class="35427419901421521" onmouseenter="enter('35427419901421521');" onmouseout="out('35427419901421521');" style=""> 189                      passKey = false;                                                                              </span>
<span class="7300242526186641878" onmouseenter="enter('7300242526186641878');" onmouseout="out('7300242526186641878');" style=""> 190                      inKey = key.next();                                                                           </span>
<span class="1625279893230829750" onmouseenter="enter('1625279893230829750');" onmouseout="out('1625279893230829750');" style=""> 191                      outKey = null;                                                                                </span>
<span class="-8000058323286219252" onmouseenter="enter('-8000058323286219252');" onmouseout="out('-8000058323286219252');" style=""> 192                      int pebbleAppIndex = knownKeys.optInt(inKey, -1);                                             </span>
<span class="1318599845650471336" onmouseenter="enter('1318599845650471336');" onmouseout="out('1318599845650471336');" style=""> 193                      if (pebbleAppIndex != -1) {                                                                   </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style=""> 194                          passKey = true;                                                                           </span>
<span class="6093149884609226755" onmouseenter="enter('6093149884609226755');" onmouseout="out('6093149884609226755');" style=""> 195                          outKey = String.valueOf(pebbleAppIndex);                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 196                      } else {                                                                                      </span>
<span class="1471897956818349080" onmouseenter="enter('1471897956818349080');" onmouseout="out('1471897956818349080');" style=""><abbr title=" 197                          //do not discard integer keys (see https://developer.pebble.com/guides/communication/using-pebblekit-js/ )"> 197                          //do not discard integer keys (see https://developer.pebble.com/guides/communication/usingðŸ”µ</abbr></span>
<span class="9182410012949841341" onmouseenter="enter('9182410012949841341');" onmouseout="out('9182410012949841341');" style=""> 198                          Scanner scanner = new Scanner(inKey);                                                     </span>
<span class="3432714770914509184" onmouseenter="enter('3432714770914509184');" onmouseout="out('3432714770914509184');" style=""> 199                          if (scanner.hasNextInt() &amp;&amp; inKey.equals(&quot;&quot; + scanner.nextInt())) {                       </span>
<span class="-8904812256919369169" onmouseenter="enter('-8904812256919369169');" onmouseout="out('-8904812256919369169');" style=""> 200                              passKey = true;                                                                       </span>
<span class="633307466455829355" onmouseenter="enter('633307466455829355');" onmouseout="out('633307466455829355');" style=""> 201                              outKey = inKey;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203                      }                                                                                             </span>
<span  style=""> 204                                                                                                                    </span>
<span class="7100715742750083788" onmouseenter="enter('7100715742750083788');" onmouseout="out('7100715742750083788');" style=""> 205                      if (passKey) {                                                                                </span>
<span class="-1814814172109868162" onmouseenter="enter('-1814814172109868162');" onmouseout="out('-1814814172109868162');" style=""> 206                          Object obj = in.get(inKey);                                                               </span>
<span class="-2516604200979810702" onmouseenter="enter('-2516604200979810702');" onmouseout="out('-2516604200979810702');" style=""> 207                          if (obj instanceof Boolean) {                                                             </span>
<span class="3988738952494779303" onmouseenter="enter('3988738952494779303');" onmouseout="out('3988738952494779303');" style=""> 208                              obj = ((Boolean) obj) ? &quot;true&quot; : &quot;false&quot;;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209                          }                                                                                         </span>
<span class="7889737448406399667" onmouseenter="enter('7889737448406399667');" onmouseout="out('7889737448406399667');" style=""> 210                          out.put(outKey, obj);                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 211                      } else {                                                                                      </span>
<span class="-2054330584630270669" onmouseenter="enter('-2054330584630270669');" onmouseout="out('-2054330584630270669');" style=""><abbr title=" 212                          GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an integer key.&quot;, Toast.LENGTH_SHORT, GB.WARN);"> 212                          GB.toast(&quot;Discarded key &quot; + inKey + &quot;, not found in the local configuration and is not an ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213                      }                                                                                             </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215                  }                                                                                                 </span>
<span class="-881732067758657379" onmouseenter="enter('-881732067758657379');" onmouseout="out('-881732067758657379');" style=""> 216                  LOG.info(out.toString());                                                                         </span>
<span class="-2343027273789634583" onmouseenter="enter('-2343027273789634583');" onmouseout="out('-2343027273789634583');" style=""> 217                  GBApplication.deviceService().onAppConfiguration(appUuid, out.toString());                        </span>
<span  style=""> 218                                                                                                                    </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 219              } catch (JSONException e) {                                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 220                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222          }                                                                                                         </span>
<span  style=""> 223                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 224          @JavascriptInterface                                                                                      </span>
<span class="-5632539219238112893" onmouseenter="enter('-5632539219238112893');" onmouseout="out('-5632539219238112893');" style=""> 225          public String getActiveWatchInfo() {                                                                      </span>
<span class="-843298888064131140" onmouseenter="enter('-843298888064131140');" onmouseout="out('-843298888064131140');" style=""> 226              JSONObject wi = new JSONObject();                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 227              try {                                                                                                 </span>
<span class="-7073207729972829278" onmouseenter="enter('-7073207729972829278');" onmouseout="out('-7073207729972829278');" style=""> 228                  wi.put(&quot;firmware&quot;, mGBDevice.getFirmwareVersion());                                               </span>
<span class="1619143394428866421" onmouseenter="enter('1619143394428866421');" onmouseout="out('1619143394428866421');" style=""> 229                  wi.put(&quot;platform&quot;, PebbleUtils.getPlatformName(mGBDevice.getModel()));                            </span>
<span class="-5437394903337435394" onmouseenter="enter('-5437394903337435394');" onmouseout="out('-5437394903337435394');" style=""> 230                  wi.put(&quot;model&quot;, PebbleUtils.getModel(mGBDevice.getModel()));                                      </span>
<span class="6629264299746547541" onmouseenter="enter('6629264299746547541');" onmouseout="out('6629264299746547541');" style=""> 231                  //TODO: use real info                                                                             </span>
<span class="118738678871371777" onmouseenter="enter('118738678871371777');" onmouseout="out('118738678871371777');" style=""> 232                  wi.put(&quot;language&quot;, &quot;en&quot;);                                                                         </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 233              } catch (JSONException e) {                                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 234                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235              }                                                                                                     </span>
<span class="2996545006566015873" onmouseenter="enter('2996545006566015873');" onmouseout="out('2996545006566015873');" style=""> 236              //Json not supported apparently, we need to cast back and forth                                       </span>
<span class="5839065679891034244" onmouseenter="enter('5839065679891034244');" onmouseout="out('5839065679891034244');" style=""> 237              return wi.toString();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238          }                                                                                                         </span>
<span  style=""> 239                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 240          @JavascriptInterface                                                                                      </span>
<span class="-856046329422320734" onmouseenter="enter('-856046329422320734');" onmouseout="out('-856046329422320734');" style=""> 241          public String getAppConfigurationFile() {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 242              try {                                                                                                 </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style=""> 243                  File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                          </span>
<span class="-6190799366778164723" onmouseenter="enter('-6190799366778164723');" onmouseout="out('-6190799366778164723');" style=""> 244                  File configurationFile = new File(destDir, appUuid.toString() + &quot;_config.js&quot;);                    </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style=""> 245                  if (configurationFile.exists()) {                                                                 </span>
<span class="-736461147530501961" onmouseenter="enter('-736461147530501961');" onmouseout="out('-736461147530501961');" style=""> 246                      return &quot;file:///&quot; + configurationFile.getAbsolutePath();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247                  }                                                                                                 </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 248              } catch (IOException e) {                                                                             </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 249                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250              }                                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 251              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252          }                                                                                                         </span>
<span  style=""> 253                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 254          @JavascriptInterface                                                                                      </span>
<span class="7186673836371686422" onmouseenter="enter('7186673836371686422');" onmouseout="out('7186673836371686422');" style=""> 255          public String getAppStoredPreset() {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 256              try {                                                                                                 </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style=""> 257                  File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                          </span>
<span class="-1650511077982903195" onmouseenter="enter('-1650511077982903195');" onmouseout="out('-1650511077982903195');" style=""> 258                  File configurationFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                  </span>
<span class="-3533847811571109168" onmouseenter="enter('-3533847811571109168');" onmouseout="out('-3533847811571109168');" style=""> 259                  if (configurationFile.exists()) {                                                                 </span>
<span class="-4631811320466918610" onmouseenter="enter('-4631811320466918610');" onmouseout="out('-4631811320466918610');" style=""> 260                      return FileUtils.getStringFromFile(configurationFile);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261                  }                                                                                                 </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 262              } catch (IOException e) {                                                                             </span>
<span class="-1248445865590398413" onmouseenter="enter('-1248445865590398413');" onmouseout="out('-1248445865590398413');" style=""> 263                  GB.toast(&quot;Error reading presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 264                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265              }                                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 266              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267          }                                                                                                         </span>
<span  style=""> 268                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 269          @JavascriptInterface                                                                                      </span>
<span class="-6701887776194876087" onmouseenter="enter('-6701887776194876087');" onmouseout="out('-6701887776194876087');" style=""> 270          public void saveAppStoredPreset(String msg) {                                                             </span>
<span class="-192245887358676257" onmouseenter="enter('-192245887358676257');" onmouseout="out('-192245887358676257');" style=""> 271              Writer writer;                                                                                        </span>
<span  style=""> 272                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 273              try {                                                                                                 </span>
<span class="-7251832751153678236" onmouseenter="enter('-7251832751153678236');" onmouseout="out('-7251832751153678236');" style=""> 274                  File destDir = new File(FileUtils.getExternalFilesDir() + &quot;/pbw-cache&quot;);                          </span>
<span class="3603668645457989644" onmouseenter="enter('3603668645457989644');" onmouseout="out('3603668645457989644');" style=""> 275                  File presetsFile = new File(destDir, appUuid.toString() + &quot;_preset.json&quot;);                        </span>
<span class="-2643535316378223379" onmouseenter="enter('-2643535316378223379');" onmouseout="out('-2643535316378223379');" style=""> 276                  writer = new BufferedWriter(new FileWriter(presetsFile));                                         </span>
<span class="-5700221122508670675" onmouseenter="enter('-5700221122508670675');" onmouseout="out('-5700221122508670675');" style=""> 277                  writer.write(msg);                                                                                </span>
<span class="4330639758910844474" onmouseenter="enter('4330639758910844474');" onmouseout="out('4330639758910844474');" style=""> 278                  writer.close();                                                                                   </span>
<span class="-850015778348175113" onmouseenter="enter('-850015778348175113');" onmouseout="out('-850015778348175113');" style=""> 279                  GB.toast(&quot;Presets stored&quot;, Toast.LENGTH_SHORT, GB.INFO);                                          </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 280              } catch (IOException e) {                                                                             </span>
<span class="-4875214328390419177" onmouseenter="enter('-4875214328390419177');" onmouseout="out('-4875214328390419177');" style=""> 281                  GB.toast(&quot;Error storing presets&quot;, Toast.LENGTH_LONG, GB.ERROR);                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 282                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284          }                                                                                                         </span>
<span  style=""> 285                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 286          @JavascriptInterface                                                                                      </span>
<span class="-8118311426044261956" onmouseenter="enter('-8118311426044261956');" onmouseout="out('-8118311426044261956');" style=""> 287          public String getAppUUID() {                                                                              </span>
<span class="-5609100198503319527" onmouseenter="enter('-5609100198503319527');" onmouseout="out('-5609100198503319527');" style=""> 288              return appUuid.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289          }                                                                                                         </span>
<span  style=""> 290                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 291          @JavascriptInterface                                                                                      </span>
<span class="-2024961006635561560" onmouseenter="enter('-2024961006635561560');" onmouseout="out('-2024961006635561560');" style=""> 292          public String getAppLocalstoragePrefix() {                                                                </span>
<span class="-139042831100003478" onmouseenter="enter('-139042831100003478');" onmouseout="out('-139042831100003478');" style=""> 293              String prefix = mGBDevice.getAddress() + appUuid.toString();                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 294              try {                                                                                                 </span>
<span class="1589472625916860471" onmouseenter="enter('1589472625916860471');" onmouseout="out('1589472625916860471');" style=""> 295                  MessageDigest digest = MessageDigest.getInstance(&quot;SHA-1&quot;);                                        </span>
<span class="-1715536820593379285" onmouseenter="enter('-1715536820593379285');" onmouseout="out('-1715536820593379285');" style=""> 296                  byte[] bytes = prefix.getBytes(&quot;UTF-8&quot;);                                                          </span>
<span class="-6693486492020146741" onmouseenter="enter('-6693486492020146741');" onmouseout="out('-6693486492020146741');" style=""> 297                  digest.update(bytes, 0, bytes.length);                                                            </span>
<span class="-4062246525168346439" onmouseenter="enter('-4062246525168346439');" onmouseout="out('-4062246525168346439');" style=""> 298                  bytes = digest.digest();                                                                          </span>
<span class="1334999931346445764" onmouseenter="enter('1334999931346445764');" onmouseout="out('1334999931346445764');" style=""> 299                  final StringBuilder sb = new StringBuilder();                                                     </span>
<span class="-7387509961039532833" onmouseenter="enter('-7387509961039532833');" onmouseout="out('-7387509961039532833');" style=""> 300                  for (int i = 0; i &lt; bytes.length; i++) {                                                          </span>
<span class="7651397204661452382" onmouseenter="enter('7651397204661452382');" onmouseout="out('7651397204661452382');" style=""> 301                      sb.append(String.format(&quot;%02X&quot;, bytes[i]));                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302                  }                                                                                                 </span>
<span class="6091843332607413306" onmouseenter="enter('6091843332607413306');" onmouseout="out('6091843332607413306');" style=""> 303                  return sb.toString().toLowerCase();                                                               </span>
<span class="5663120823918718146" onmouseenter="enter('5663120823918718146');" onmouseout="out('5663120823918718146');" style=""> 304              } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {                                 </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 305                  e.printStackTrace();                                                                              </span>
<span class="-5295149366119702820" onmouseenter="enter('-5295149366119702820');" onmouseout="out('-5295149366119702820');" style=""> 306                  return prefix;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308          }                                                                                                         </span>
<span  style=""> 309                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 310          @JavascriptInterface                                                                                      </span>
<span class="6682389599781806833" onmouseenter="enter('6682389599781806833');" onmouseout="out('6682389599781806833');" style=""> 311          public String getWatchToken() {                                                                           </span>
<span class="588975967419017208" onmouseenter="enter('588975967419017208');" onmouseout="out('588975967419017208');" style=""><abbr title=" 312              //specification says: A string that is guaranteed to be identical for each Pebble device for the same app across different mobile devices. The token is unique to your app and cannot be used to track Pebble devices across applications. see https://developer.pebble.com/docs/js/Pebble/"> 312              //specification says: A string that is guaranteed to be identical for each Pebble device for the same ðŸ”µ</abbr></span>
<span class="1141582625581442566" onmouseenter="enter('1141582625581442566');" onmouseout="out('1141582625581442566');" style=""> 313              return &quot;gb&quot; + appUuid.toString();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314          }                                                                                                         </span>
<span  style=""> 315                                                                                                                    </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style=""> 316          @JavascriptInterface                                                                                      </span>
<span class="-2679833985970443362" onmouseenter="enter('-2679833985970443362');" onmouseout="out('-2679833985970443362');" style=""> 317          public void closeActivity() {                                                                             </span>
<span class="970189932822709547" onmouseenter="enter('970189932822709547');" onmouseout="out('970189932822709547');" style=""> 318              NavUtils.navigateUpFromSameTask((ExternalPebbleJSActivity) mContext);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319          }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 320 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 321 +                                                                                                                  </span>
<span class="-6717080132706209696" onmouseenter="enter('-6717080132706209696');" onmouseout="out('-6717080132706209696');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 322 +        @JavascriptInterface                                                                                      </span>
<span class="-5039914046281084423" onmouseenter="enter('-5039914046281084423');" onmouseout="out('-5039914046281084423');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 323 +        public String getCurrentPosition() {                                                                      </span>
<span class="-149413150381439412" onmouseenter="enter('-149413150381439412');" onmouseout="out('-149413150381439412');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 324 +            if (!isLocationEnabledForWatchApp()) {                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 325 +                return &quot;&quot;;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 326 +            }                                                                                                     </span>
<span class="8227519164768398763" onmouseenter="enter('8227519164768398763');" onmouseout="out('8227519164768398763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 327 +            //we need to override this because the coarse location is not enough for the android webview, we should add the permission for fine location."> 327 +            //we need to override this because the coarse location is not enough for the android webview, we shoulðŸ”µ</abbr></span>
<span class="7572894489807780729" onmouseenter="enter('7572894489807780729');" onmouseout="out('7572894489807780729');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 328 +            JSONObject geoPosition = new JSONObject();                                                            </span>
<span class="-8852470018621524217" onmouseenter="enter('-8852470018621524217');" onmouseout="out('-8852470018621524217');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 329 +            JSONObject coords = new JSONObject();                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 330 +            try {                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 331 +                                                                                                                  </span>
<span class="7576815700871527587" onmouseenter="enter('7576815700871527587');" onmouseout="out('7576815700871527587');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 332 +                Prefs prefs = GBApplication.getPrefs();                                                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 333 +                                                                                                                  </span>
<span class="-2804823070089201012" onmouseenter="enter('-2804823070089201012');" onmouseout="out('-2804823070089201012');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 334 +                geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know this value is really old"> 334 +                geoPosition.put(&quot;timestamp&quot;, (System.currentTimeMillis() / 1000) - 86400); //let JS know this valuðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 335 +                                                                                                                  </span>
<span class="6245247748368740564" onmouseenter="enter('6245247748368740564');" onmouseout="out('6245247748368740564');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 336 +                coords.put(&quot;latitude&quot;, prefs.getFloat(&quot;location_latitude&quot;, 0));                                   </span>
<span class="-2550975770164595754" onmouseenter="enter('-2550975770164595754');" onmouseout="out('-2550975770164595754');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 337 +                coords.put(&quot;longitude&quot;, prefs.getFloat(&quot;location_longitude&quot;, 0));                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 338 +                                                                                                                  </span>
<span class="-2595111342414270158" onmouseenter="enter('-2595111342414270158');" onmouseout="out('-2595111342414270158');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 339 +                if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED &amp;&amp;"> 339 +                if (ActivityCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.ACCESS_COARSE_ðŸ”µ</abbr></span>
<span class="-6892731487308770176" onmouseenter="enter('-6892731487308770176');" onmouseout="out('-6892731487308770176');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 340 +                        prefs.getBoolean(&quot;use_updated_location_if_available&quot;, false)) {                           </span>
<span class="3465319766909019165" onmouseenter="enter('3465319766909019165');" onmouseout="out('3465319766909019165');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 341 +                    LocationManager locationManager = (LocationManager) getApplicationContext().getSystemService(Context.LOCATION_SERVICE);"> 341 +                    LocationManager locationManager = (LocationManager) getApplicationContext().getSystemService(CðŸ”µ</abbr></span>
<span class="-840377409278335695" onmouseenter="enter('-840377409278335695');" onmouseout="out('-840377409278335695');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 342 +                    Criteria criteria = new Criteria();                                                           </span>
<span class="6446985192446327745" onmouseenter="enter('6446985192446327745');" onmouseout="out('6446985192446327745');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 343 +                    String provider = locationManager.getBestProvider(criteria, false);                           </span>
<span class="-8436409377687209859" onmouseenter="enter('-8436409377687209859');" onmouseout="out('-8436409377687209859');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 344 +                    if (provider != null) {                                                                       </span>
<span class="-7314446287342572990" onmouseenter="enter('-7314446287342572990');" onmouseout="out('-7314446287342572990');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 345 +                        Location lastKnownLocation = locationManager.getLastKnownLocation(provider);              </span>
<span class="8333098492219571100" onmouseenter="enter('8333098492219571100');" onmouseout="out('8333098492219571100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 346 +                        if (lastKnownLocation != null) {                                                          </span>
<span class="5858379750545562426" onmouseenter="enter('5858379750545562426');" onmouseout="out('5858379750545562426');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 347 +                            geoPosition.put(&quot;timestamp&quot;, lastKnownLocation.getTime());                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 348 +                                                                                                                  </span>
<span class="-3886576221552081470" onmouseenter="enter('-3886576221552081470');" onmouseout="out('-3886576221552081470');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 349 +                            coords.put(&quot;latitude&quot;, (float) lastKnownLocation.getLatitude());                      </span>
<span class="1780277249580908945" onmouseenter="enter('1780277249580908945');" onmouseout="out('1780277249580908945');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 350 +                            coords.put(&quot;longitude&quot;, (float) lastKnownLocation.getLongitude());                    </span>
<span class="1952651036571300684" onmouseenter="enter('1952651036571300684');" onmouseout="out('1952651036571300684');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 351 +                            coords.put(&quot;accuracy&quot;, lastKnownLocation.getAccuracy());                              </span>
<span class="-3774793511471938680" onmouseenter="enter('-3774793511471938680');" onmouseout="out('-3774793511471938680');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 352 +                            coords.put(&quot;altitude&quot;, lastKnownLocation.getAltitude());                              </span>
<span class="-8837886391810921688" onmouseenter="enter('-8837886391810921688');" onmouseout="out('-8837886391810921688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 353 +                            coords.put(&quot;speed&quot;, lastKnownLocation.getSpeed());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 354 +                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 355 +                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 356 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 357 +                                                                                                                  </span>
<span class="7469381851935855362" onmouseenter="enter('7469381851935855362');" onmouseout="out('7469381851935855362');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 358 +                geoPosition.put(&quot;coords&quot;, coords);                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 359 +                                                                                                                  </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 360 +            } catch (JSONException e) {                                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 361 +                e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 362 +            }                                                                                                     </span>
<span class="-2910369541796689888" onmouseenter="enter('-2910369541796689888');" onmouseout="out('-2910369541796689888');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 363 +            return geoPosition.toString();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 364 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365      }                                                                                                             </span>
<span  style=""> 366                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 367      @Override                                                                                                     </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 368      public boolean onOptionsItemSelected(MenuItem item) {                                                         </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 369          switch (item.getItemId()) {                                                                               </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 370              case android.R.id.home:                                                                               </span>
<span class="-1694655592982141021" onmouseenter="enter('-1694655592982141021');" onmouseout="out('-1694655592982141021');" style=""> 371                  NavUtils.navigateUpFromSameTask(this);                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 372                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373          }                                                                                                         </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 374          return super.onOptionsItemSelected(item);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375      }                                                                                                             </span>
<span  style=""> 376                                                                                                                    </span>













<span  style=""> 377                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            