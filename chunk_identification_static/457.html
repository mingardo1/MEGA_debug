<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>457</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    457
                    <a href="456.html">prev</a>
                    <a href="458.html">next</a>
                    <a href="457_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_b43aec0679d705647015fd4416ad6dc326ea7890_core/src/main/java/com/dtstack/flink/sql/side/SideSqlExec.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890:core/src/main/java/com/dtstack/flink/sql/side/SideSqlExec.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890^1:core/src/main/java/com/dtstack/flink/sql/side/SideSqlExec.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890^2:core/src/main/java/com/dtstack/flink/sql/side/SideSqlExec.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;6159bb9bb9904f950c489b50fb7dcbe399c3d327:core/src/main/java/com/dtstack/flink/sql/side/SideSqlExec.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj], [bsj], [b], [b], [b], [b], [j], [j], [j], [j], [j]], subset: [[bj], [bsj], [bj], [bj], [bj], [bj], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  23 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  24 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  25 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="">  26 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="">  27 import org.apache.flink.table.api.StreamQueryConfig;                                                     </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  28 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-8888728238394280005" onmouseenter="enter('-8888728238394280005');" onmouseout="out('-8888728238394280005');" style="">  29 import org.apache.flink.table.api.TableSchema;                                                           </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="">  30 import org.apache.flink.table.api.java.StreamTableEnvironment;                                           </span>
<span class="-6266446094177003082" onmouseenter="enter('-6266446094177003082');" onmouseout="out('-6266446094177003082');" style="">  31 import org.apache.flink.table.runtime.CRowKeySelector;                                                   </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  32 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="5605277811729025111" onmouseenter="enter('5605277811729025111');" onmouseout="out('5605277811729025111');" style="">  33 import org.apache.flink.table.runtime.types.CRowTypeInfo;                                                </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  34 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  35 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  36                                                                                                          </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  37 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="">  38 import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                          </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="">  39 import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                </span>
<span class="7697893187981436175" onmouseenter="enter('7697893187981436175');" onmouseout="out('7697893187981436175');" style="">  40 import com.dtstack.flink.sql.side.operator.SideAsyncOperator;                                            </span>
<span class="-7456990469468101750" onmouseenter="enter('-7456990469468101750');" onmouseout="out('-7456990469468101750');" style="">  41 import com.dtstack.flink.sql.side.operator.SideWithAllCacheOperator;                                     </span>
<span class="4874498590411064411" onmouseenter="enter('4874498590411064411');" onmouseout="out('4874498590411064411');" style="">  42 import com.dtstack.flink.sql.util.ClassUtil;                                                             </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  43 import com.dtstack.flink.sql.util.ParseUtils;                                                            </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  44 import com.dtstack.flink.sql.util.TableUtils;                                                            </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  45 import com.google.common.base.Preconditions;                                                             </span>
<span class="1793459060364841943" onmouseenter="enter('1793459060364841943');" onmouseout="out('1793459060364841943');" style="">  46 import com.google.common.collect.*;                                                                      </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  47 import org.apache.calcite.sql.SqlAsOperator;                                                             </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  48 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  49 import org.apache.calcite.sql.SqlDataTypeSpec;                                                           </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  50 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  51 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  52 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  53 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  54 import org.apache.calcite.sql.SqlLiteral;                                                                </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  55 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  56 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  57 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  58 import org.apache.calcite.sql.SqlOrderBy;                                                                </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  59 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  60 import org.apache.calcite.sql.SqlWithItem;                                                               </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  61 import org.apache.calcite.sql.fun.SqlCase;                                                               </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  62 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  63 import org.apache.calcite.sql.parser.SqlParserPos;                                                       </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  64 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  65 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  66 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  67 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  68                                                                                                          </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  69 import java.sql.Timestamp;                                                                               </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  70 import java.util.Arrays;                                                                                 </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  71 import java.util.Collection;                                                                             </span>
<span class="2644117295780670879" onmouseenter="enter('2644117295780670879');" onmouseout="out('2644117295780670879');" style="">  72 import java.util.LinkedList;                                                                             </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  73 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  74 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  75 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  76 import java.util.Set;                                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  78 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span  style="">  79                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  80 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  81  * Reason:                                                                                               </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  82  * Date: 2018/7/24                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  83  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  84  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  85  */                                                                                                      </span>
<span  style="">  86                                                                                                          </span>
<span class="-5079038956292767116" onmouseenter="enter('-5079038956292767116');" onmouseout="out('-5079038956292767116');" style="">  87 public class SideSqlExec {                                                                               </span>
<span  style="">  88                                                                                                          </span>
<span class="-8991898280301588076" onmouseenter="enter('-8991898280301588076');" onmouseout="out('-8991898280301588076');" style="">  89     private static final Logger LOG = LoggerFactory.getLogger(SideSqlExec.class);                        </span>
<span  style="">  90                                                                                                          </span>
<span class="-6334022460956670337" onmouseenter="enter('-6334022460956670337');" onmouseout="out('-6334022460956670337');" style="">  91     private String localSqlPluginPath = null;                                                            </span>
<span  style="">  92                                                                                                          </span>
<span class="-863593709646632598" onmouseenter="enter('-863593709646632598');" onmouseout="out('-863593709646632598');" style="">  93     private String tmpFields = null;                                                                     </span>
<span  style="">  94                                                                                                          </span>
<span class="8878309237265342483" onmouseenter="enter('8878309237265342483');" onmouseout="out('8878309237265342483');" style="">  95     private SidePredicatesParser sidePredicatesParser = new SidePredicatesParser();                      </span>
<span  style="">  96                                                                                                          </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  97     private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                      </span>
<span  style="">  98                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  99 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5235405798143461797" onmouseenter="enter('5235405798143461797');" onmouseout="out('5235405798143461797');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 100     public void exec(String sql,                                                                         </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 101                      Map&lt;String, SideTableInfo&gt; sideTableMap,                                            </span>
<span class="4244108408582304218" onmouseenter="enter('4244108408582304218');" onmouseout="out('4244108408582304218');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 102                      StreamTableEnvironment tableEnv,                                                    </span>
<span class="-1493383746124052329" onmouseenter="enter('-1493383746124052329');" onmouseout="out('-1493383746124052329');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 103                      Map&lt;String, Table&gt; tableCache,                                                      </span>
<span class="-6398864087192215060" onmouseenter="enter('-6398864087192215060');" onmouseout="out('-6398864087192215060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 104                      StreamQueryConfig queryConfig,                                                      </span>
<span class="3861087795237990091" onmouseenter="enter('3861087795237990091');" onmouseout="out('3861087795237990091');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 105                      CreateTmpTableParser.SqlParserResult createView) throws Exception {                 </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 106 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107                                                                                                          </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108     private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109                                                                                                          </span>
<span class="-1078000254446854726" onmouseenter="enter('-1078000254446854726');" onmouseout="out('-1078000254446854726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 110     public void exec(String sql, Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,"> 110     public void exec(String sql, Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv🔵</abbr></span>
<span class="1000260034925957386" onmouseenter="enter('1000260034925957386');" onmouseout="out('1000260034925957386');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 111                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserResult createView) throws Exception {"> 111                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.S🔵</abbr></span>
<span class="-7184346740499807144" onmouseenter="enter('-7184346740499807144');" onmouseout="out('-7184346740499807144');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112         if(localSqlPluginPath == null){                                                                  </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 113 =======                                                                                                  </span>
<span class="-2568962717532337416" onmouseenter="enter('-2568962717532337416');" onmouseout="out('-2568962717532337416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 114     public void exec(String sql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,"> 114     public void exec(String sql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment 🔵</abbr></span>
<span class="1000260034925957386" onmouseenter="enter('1000260034925957386');" onmouseout="out('1000260034925957386');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 115                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserResult createView) throws Exception {"> 115                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.S🔵</abbr></span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 116 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-7184346740499807144" onmouseenter="enter('-7184346740499807144');" onmouseout="out('-7184346740499807144');" style=""> 117         if(localSqlPluginPath == null){                                                                  </span>
<span class="4243357528698157424" onmouseenter="enter('4243357528698157424');" onmouseout="out('4243357528698157424');" style=""> 118             throw new RuntimeException(&quot;need to set localSqlPluginPath&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119         }                                                                                                </span>
<span  style=""> 120                                                                                                          </span>
<span class="-6307578536739293325" onmouseenter="enter('-6307578536739293325');" onmouseout="out('-6307578536739293325');" style=""> 121         localTableCache.putAll(tableCache);                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 122         try {                                                                                            </span>
<span class="-7778408363768085476" onmouseenter="enter('-7778408363768085476');" onmouseout="out('-7778408363768085476');" style=""> 123             sidePredicatesParser.fillPredicatesForSideTable(sql, sideTableMap);                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 124         } catch (Exception e) {                                                                          </span>
<span class="-6535415982741029210" onmouseenter="enter('-6535415982741029210');" onmouseout="out('-6535415982741029210');" style=""> 125             LOG.error(&quot;fill predicates for sideTable fail &quot;, e);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span  style=""> 127                                                                                                          </span>
<span class="5869130575145188486" onmouseenter="enter('5869130575145188486');" onmouseout="out('5869130575145188486');" style=""> 128         if(createView != null){                                                                          </span>
<span class="-5051922790285322929" onmouseenter="enter('-5051922790285322929');" onmouseout="out('-5051922790285322929');" style=""> 129             LOG.warn(&quot;create view info\n&quot;);                                                              </span>
<span class="4994977519661454238" onmouseenter="enter('4994977519661454238');" onmouseout="out('4994977519661454238');" style=""> 130             LOG.warn(createView.getExecSql());                                                           </span>
<span class="-6048507734051622776" onmouseenter="enter('-6048507734051622776');" onmouseout="out('-6048507734051622776');" style=""> 131             LOG.warn(&quot;-----------------&quot;);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132         }                                                                                                </span>
<span  style=""> 133                                                                                                          </span>
<span class="3272289589011229925" onmouseenter="enter('3272289589011229925');" onmouseout="out('3272289589011229925');" style=""> 134         SideSQLParser sideSQLParser = new SideSQLParser();                                               </span>
<span class="9221221341975786732" onmouseenter="enter('9221221341975786732');" onmouseout="out('9221221341975786732');" style=""> 135         sideSQLParser.setLocalTableCache(localTableCache);                                               </span>
<span class="-1577132173025596093" onmouseenter="enter('-1577132173025596093');" onmouseout="out('-1577132173025596093');" style=""> 136         Queue&lt;Object&gt; exeQueue = sideSQLParser.getExeQueue(sql, sideTableMap.keySet());                  </span>
<span class="1917635497637273504" onmouseenter="enter('1917635497637273504');" onmouseout="out('1917635497637273504');" style=""> 137         Object pollObj = null;                                                                           </span>
<span  style=""> 138                                                                                                          </span>
<span class="6128441282435403378" onmouseenter="enter('6128441282435403378');" onmouseout="out('6128441282435403378');" style=""> 139         while((pollObj = exeQueue.poll()) != null){                                                      </span>
<span  style=""> 140                                                                                                          </span>
<span class="138624831707193108" onmouseenter="enter('138624831707193108');" onmouseout="out('138624831707193108');" style=""> 141             if(pollObj instanceof SqlNode){                                                              </span>
<span class="-8817010307772649906" onmouseenter="enter('-8817010307772649906');" onmouseout="out('-8817010307772649906');" style=""> 142                 SqlNode pollSqlNode = (SqlNode) pollObj;                                                 </span>
<span  style=""> 143                                                                                                          </span>
<span  style=""> 144                                                                                                          </span>
<span class="-2885719311179922220" onmouseenter="enter('-2885719311179922220');" onmouseout="out('-2885719311179922220');" style=""> 145                 if(pollSqlNode.getKind() == INSERT){                                                     </span>
<span class="-7041171683301857607" onmouseenter="enter('-7041171683301857607');" onmouseout="out('-7041171683301857607');" style=""> 146                     FlinkSQLExec.sqlUpdate(tableEnv, pollSqlNode.toString(), queryConfig);               </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style=""> 147                     if(LOG.isInfoEnabled()){                                                             </span>
<span class="-5986232783970891998" onmouseenter="enter('-5986232783970891998');" onmouseout="out('-5986232783970891998');" style=""> 148                         LOG.info(&quot;----------real exec sql-----------\n{}&quot;, pollSqlNode.toString());      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149                     }                                                                                    </span>
<span  style=""> 150                                                                                                          </span>
<span class="4666687505712980858" onmouseenter="enter('4666687505712980858');" onmouseout="out('4666687505712980858');" style=""> 151                 }else if(pollSqlNode.getKind() == AS){                                                   </span>
<span class="3037765200739894050" onmouseenter="enter('3037765200739894050');" onmouseout="out('3037765200739894050');" style=""> 152                     dealAsSourceTable(tableEnv, pollSqlNode, tableCache);                                </span>
<span  style=""> 153                                                                                                          </span>
<span class="4581342471671871622" onmouseenter="enter('4581342471671871622');" onmouseout="out('4581342471671871622');" style=""> 154                 } else if (pollSqlNode.getKind() == WITH_ITEM) {                                         </span>
<span class="9089825500288046356" onmouseenter="enter('9089825500288046356');" onmouseout="out('9089825500288046356');" style=""> 155                     SqlWithItem sqlWithItem = (SqlWithItem) pollSqlNode;                                 </span>
<span class="-7674640876687845363" onmouseenter="enter('-7674640876687845363');" onmouseout="out('-7674640876687845363');" style=""> 156                     String TableAlias = sqlWithItem.name.toString();                                     </span>
<span class="2573668668184904794" onmouseenter="enter('2573668668184904794');" onmouseout="out('2573668668184904794');" style=""> 157                     Table table = tableEnv.sqlQuery(sqlWithItem.query.toString());                       </span>
<span class="2341577843786962651" onmouseenter="enter('2341577843786962651');" onmouseout="out('2341577843786962651');" style=""> 158                     tableEnv.registerTable(TableAlias, table);                                           </span>
<span  style=""> 159                                                                                                          </span>
<span class="-8892059869421071039" onmouseenter="enter('-8892059869421071039');" onmouseout="out('-8892059869421071039');" style=""> 160                 } else if (pollSqlNode.getKind() == SELECT){                                             </span>
<span class="-1344441018307209750" onmouseenter="enter('-1344441018307209750');" onmouseout="out('-1344441018307209750');" style=""><abbr title=" 161                     Preconditions.checkState(createView != null, &quot;select sql must included by create view&quot;);"> 161                     Preconditions.checkState(createView != null, &quot;select sql must included by create view🔵</abbr></span>
<span class="1694293925390283740" onmouseenter="enter('1694293925390283740');" onmouseout="out('1694293925390283740');" style=""> 162                     Table table = tableEnv.sqlQuery(pollObj.toString());                                 </span>
<span  style=""> 163                                                                                                          </span>
<span class="-5832165917407529739" onmouseenter="enter('-5832165917407529739');" onmouseout="out('-5832165917407529739');" style=""> 164                     if (createView.getFieldsInfoStr() == null){                                          </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 165                         tableEnv.registerTable(createView.getTableName(), table);                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 166                     } else {                                                                             </span>
<span class="5288384657559945705" onmouseenter="enter('5288384657559945705');" onmouseout="out('5288384657559945705');" style=""> 167                         if (checkFieldsInfo(createView, table)){                                         </span>
<span class="-9109211084540213069" onmouseenter="enter('-9109211084540213069');" onmouseout="out('-9109211084540213069');" style=""> 168                             table = table.as(tmpFields);                                                 </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 169                             tableEnv.registerTable(createView.getTableName(), table);                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 170                         } else {                                                                         </span>
<span class="-4180003952862210397" onmouseenter="enter('-4180003952862210397');" onmouseout="out('-4180003952862210397');" style=""> 171                             throw new RuntimeException(&quot;Fields mismatch&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173                     }                                                                                    </span>
<span  style=""> 174                                                                                                          </span>
<span class="-5831701022468144749" onmouseenter="enter('-5831701022468144749');" onmouseout="out('-5831701022468144749');" style=""> 175                     localTableCache.put(createView.getTableName(), table);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176                 }                                                                                        </span>
<span  style=""> 177                                                                                                          </span>
<span class="2267959141426380188" onmouseenter="enter('2267959141426380188');" onmouseout="out('2267959141426380188');" style=""> 178             }else if (pollObj instanceof JoinInfo){                                                      </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 179 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-6732469083744011720" onmouseenter="enter('-6732469083744011720');" onmouseout="out('-6732469083744011720');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 180                 System.out.println(&quot;----------exec join info----------&quot;);                                </span>
<span class="6437130050258637649" onmouseenter="enter('6437130050258637649');" onmouseout="out('6437130050258637649');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 181                 System.out.println(pollObj.toString());                                                  </span>
<span class="-3518617829078174884" onmouseenter="enter('-3518617829078174884');" onmouseout="out('-3518617829078174884');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 182                 joinFun(pollObj, localTableCache, sideTableMap, tableEnv);                               </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 183 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="5288384657559945705" onmouseenter="enter('5288384657559945705');" onmouseout="out('5288384657559945705');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184                         if (checkFieldsInfo(createView, table)){                                         </span>
<span class="-9109211084540213069" onmouseenter="enter('-9109211084540213069');" onmouseout="out('-9109211084540213069');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185                             table = table.as(tmpFields);                                                 </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186                             tableEnv.registerTable(createView.getTableName(), table);                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187                         } else {                                                                         </span>
<span class="-4180003952862210397" onmouseenter="enter('-4180003952862210397');" onmouseout="out('-4180003952862210397');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188                             throw new RuntimeException(&quot;Fields mismatch&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                     }                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                                                                                                          </span>
<span class="-5831701022468144749" onmouseenter="enter('-5831701022468144749');" onmouseout="out('-5831701022468144749');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                     localTableCache.put(createView.getTableName(), table);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194                                                                                                          </span>
<span class="2267959141426380188" onmouseenter="enter('2267959141426380188');" onmouseout="out('2267959141426380188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195             }else if (pollObj instanceof JoinInfo){                                                      </span>
<span class="-6732469083744011720" onmouseenter="enter('-6732469083744011720');" onmouseout="out('-6732469083744011720');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                 System.out.println(&quot;----------exec join info----------&quot;);                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 197 =======                                                                                                  </span>
<span class="-6196622619540139248" onmouseenter="enter('-6196622619540139248');" onmouseout="out('-6196622619540139248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 198                 LOG.info(&quot;----------exec join info----------\n{}&quot;, pollObj.toString());                  </span>
<span class="-4508108017455823844" onmouseenter="enter('-4508108017455823844');" onmouseout="out('-4508108017455823844');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 199                 preIsSideJoin = true;                                                                    </span>
<span class="-9158044292308775618" onmouseenter="enter('-9158044292308775618');" onmouseout="out('-9158044292308775618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 200                 joinFun(pollObj, localTableCache, sideTableMap, tableEnv, replaceInfoList);              </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 201 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203         }                                                                                                </span>
<span  style=""> 204                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205     }                                                                                                    </span>
<span  style=""> 206                                                                                                          </span>
<span  style=""> 207                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 208     /**                                                                                                  </span>
<span class="-7226459799151937672" onmouseenter="enter('-7226459799151937672');" onmouseout="out('-7226459799151937672');" style=""> 209      * 解析出as查询的表和字段的关系                                                                                   </span>
<span class="-4711911052088894915" onmouseenter="enter('-4711911052088894915');" onmouseout="out('-4711911052088894915');" style=""> 210      * @param asSqlNode                                                                                  </span>
<span class="-8172984871762282794" onmouseenter="enter('-8172984871762282794');" onmouseout="out('-8172984871762282794');" style=""> 211      * @param tableCache                                                                                 </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 212      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 213      */                                                                                                  </span>
<span class="-8315666616430025383" onmouseenter="enter('-8315666616430025383');" onmouseout="out('-8315666616430025383');" style=""> 214     private FieldReplaceInfo parseAsQuery(SqlBasicCall asSqlNode, Map&lt;String, Table&gt; tableCache){        </span>
<span class="-4950849472737015743" onmouseenter="enter('-4950849472737015743');" onmouseout="out('-4950849472737015743');" style=""> 215         SqlNode info = asSqlNode.getOperands()[0];                                                       </span>
<span class="-6049998703041327008" onmouseenter="enter('-6049998703041327008');" onmouseout="out('-6049998703041327008');" style=""> 216         SqlNode alias = asSqlNode.getOperands()[1];                                                      </span>
<span  style=""> 217                                                                                                          </span>
<span class="6169254144825097648" onmouseenter="enter('6169254144825097648');" onmouseout="out('6169254144825097648');" style=""> 218         SqlKind infoKind = info.getKind();                                                               </span>
<span class="-8998816044463313680" onmouseenter="enter('-8998816044463313680');" onmouseout="out('-8998816044463313680');" style=""> 219         if(infoKind != SELECT){                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 220             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221         }                                                                                                </span>
<span  style=""> 222                                                                                                          </span>
<span class="1448651332248375248" onmouseenter="enter('1448651332248375248');" onmouseout="out('1448651332248375248');" style=""> 223         List&lt;FieldInfo&gt; extractFieldList = TableUtils.parserSelectField((SqlSelect) info, tableCache);   </span>
<span  style=""> 224                                                                                                          </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style=""> 225         HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                   </span>
<span class="-5476396715494077219" onmouseenter="enter('-5476396715494077219');" onmouseout="out('-5476396715494077219');" style=""> 226         for (FieldInfo fieldInfo : extractFieldList) {                                                   </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 227             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 228             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style=""> 229             String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);        </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style=""> 230             mappingTable.put(tableName, fieldName, mappingFieldName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231         }                                                                                                </span>
<span  style=""> 232                                                                                                          </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 233         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 234         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="9115675088981905484" onmouseenter="enter('9115675088981905484');" onmouseout="out('9115675088981905484');" style=""> 235         replaceInfo.setTargetTableName(alias.toString());                                                </span>
<span class="-6295883374697236710" onmouseenter="enter('-6295883374697236710');" onmouseout="out('-6295883374697236710');" style=""> 236         replaceInfo.setTargetTableAlias(alias.toString());                                               </span>
<span class="2754859294214862032" onmouseenter="enter('2754859294214862032');" onmouseout="out('2754859294214862032');" style=""> 237         return replaceInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238     }                                                                                                    </span>
<span  style=""> 239                                                                                                          </span>
<span  style=""> 240                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 241 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="73834954090191073" onmouseenter="enter('73834954090191073');" onmouseout="out('73834954090191073');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 242     public AliasInfo parseASNode(SqlNode sqlNode) throws SqlParseException {                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 243 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245             String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);        </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246             mappingTable.put(tableName, fieldName, mappingFieldName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                                                                                                          </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="9115675088981905484" onmouseenter="enter('9115675088981905484');" onmouseout="out('9115675088981905484');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251         replaceInfo.setTargetTableName(alias.toString());                                                </span>
<span class="-6295883374697236710" onmouseenter="enter('-6295883374697236710');" onmouseout="out('-6295883374697236710');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252         replaceInfo.setTargetTableAlias(alias.toString());                                               </span>
<span class="2754859294214862032" onmouseenter="enter('2754859294214862032');" onmouseout="out('2754859294214862032');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253         return replaceInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257     /**                                                                                                  </span>
<span class="-3820374652196669145" onmouseenter="enter('-3820374652196669145');" onmouseout="out('-3820374652196669145');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258      * 添加字段别名                                                                                            </span>
<span class="9038438555178000204" onmouseenter="enter('9038438555178000204');" onmouseout="out('9038438555178000204');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259      * @param pollSqlNode                                                                                </span>
<span class="-5133777749030939729" onmouseenter="enter('-5133777749030939729');" onmouseout="out('-5133777749030939729');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260      * @param fieldList                                                                                  </span>
<span class="-2002961180008195570" onmouseenter="enter('-2002961180008195570');" onmouseout="out('-2002961180008195570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261      * @param mappingTable                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262      */                                                                                                  </span>
<span class="-3955444104111901697" onmouseenter="enter('-3955444104111901697');" onmouseout="out('-3955444104111901697');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 263     private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 263     private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String,🔵</abbr></span>
<span class="-663927235385144722" onmouseenter="enter('-663927235385144722');" onmouseout="out('-663927235385144722');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264         SqlKind sqlKind = pollSqlNode.getKind();                                                         </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266             case INSERT:                                                                                 </span>
<span class="-3657774864843651643" onmouseenter="enter('-3657774864843651643');" onmouseout="out('-3657774864843651643');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                 SqlNode source = ((SqlInsert) pollSqlNode).getSource();                                  </span>
<span class="6134982029327154291" onmouseenter="enter('6134982029327154291');" onmouseout="out('6134982029327154291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                 addAliasForFieldNode(source, fieldList, mappingTable);                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270             case AS:                                                                                     </span>
<span class="-6853425371672212621" onmouseenter="enter('-6853425371672212621');" onmouseout="out('-6853425371672212621');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 271                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTable);"> 271                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTab🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273             case SELECT:                                                                                 </span>
<span class="-345466278028982068" onmouseenter="enter('-345466278028982068');" onmouseout="out('-345466278028982068');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274                 SqlNodeList selectList = ((SqlSelect) pollSqlNode).getSelectList();                      </span>
<span class="-4478316650227403681" onmouseenter="enter('-4478316650227403681');" onmouseout="out('-4478316650227403681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275                 selectList.getList().forEach(node -&gt; {                                                   </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280                         }                                                                                </span>
<span class="-4986679521926317286" onmouseenter="enter('-4986679521926317286');" onmouseout="out('-4986679521926317286');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281                         // save real field                                                               </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                         String fieldName = sqlIdentifier.names.get(1);                                   </span>
<span class="-5921041769209732806" onmouseenter="enter('-5921041769209732806');" onmouseout="out('-5921041769209732806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 283                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().containsKey(fieldName)) {"> 283                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap🔵</abbr></span>
<span class="-2287024865944183458" onmouseenter="enter('-2287024865944183458');" onmouseout="out('-2287024865944183458');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                             fieldList.add(fieldName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                 });                                                                                      </span>
<span class="-8923237898045704845" onmouseenter="enter('-8923237898045704845');" onmouseout="out('-8923237898045704845');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289                 for (int i = 0; i &lt; selectList.getList().size(); i++) {                                  </span>
<span class="-4321294484021988020" onmouseenter="enter('-4321294484021988020');" onmouseout="out('-4321294484021988020');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                     SqlNode node = selectList.get(i);                                                    </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                         }                                                                                </span>
<span class="-170655463018543442" onmouseenter="enter('-170655463018543442');" onmouseout="out('-170655463018543442');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296                         String name = sqlIdentifier.names.get(1);                                        </span>
<span class="-3204699988614579440" onmouseenter="enter('-3204699988614579440');" onmouseout="out('-3204699988614579440');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297                         // avoid real field pv0 convert pv                                               </span>
<span class="6166166284113505247" onmouseenter="enter('6166166284113505247');" onmouseout="out('6166166284113505247');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 298                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring(0, name.length() - 1))) {"> 298                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299                             SqlOperator operator = new SqlAsOperator();                                  </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300                             SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301                                                                                                          </span>
<span class="-2138283127011244558" onmouseenter="enter('-2138283127011244558');" onmouseout="out('-2138283127011244558');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 302                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() - 1), null, sqlParserPos);"> 302                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.l🔵</abbr></span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303                             SqlNode[] sqlNodes = new SqlNode[2];                                         </span>
<span class="-2939555014928254235" onmouseenter="enter('-2939555014928254235');" onmouseout="out('-2939555014928254235');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304                             sqlNodes[0] = sqlIdentifier;                                                 </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305                             sqlNodes[1] = sqlIdentifierAlias;                                            </span>
<span class="172920197577317623" onmouseenter="enter('172920197577317623');" onmouseout="out('172920197577317623');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 306                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos);"> 306                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307                                                                                                          </span>
<span class="-6513758114426947797" onmouseenter="enter('-6513758114426947797');" onmouseout="out('-6513758114426947797');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                             selectList.set(i, sqlBasicCall);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 317 =======                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318     /**                                                                                                  </span>
<span class="-3820374652196669145" onmouseenter="enter('-3820374652196669145');" onmouseout="out('-3820374652196669145');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319      * 添加字段别名                                                                                            </span>
<span class="9038438555178000204" onmouseenter="enter('9038438555178000204');" onmouseout="out('9038438555178000204');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320      * @param pollSqlNode                                                                                </span>
<span class="-5133777749030939729" onmouseenter="enter('-5133777749030939729');" onmouseout="out('-5133777749030939729');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321      * @param fieldList                                                                                  </span>
<span class="-2002961180008195570" onmouseenter="enter('-2002961180008195570');" onmouseout="out('-2002961180008195570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322      * @param mappingTable                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323      */                                                                                                  </span>
<span class="-3955444104111901697" onmouseenter="enter('-3955444104111901697');" onmouseout="out('-3955444104111901697');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 324     private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 324     private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String,🔵</abbr></span>
<span class="-663927235385144722" onmouseenter="enter('-663927235385144722');" onmouseout="out('-663927235385144722');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 325         SqlKind sqlKind = pollSqlNode.getKind();                                                         </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 326         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 327             case INSERT:                                                                                 </span>
<span class="-3657774864843651643" onmouseenter="enter('-3657774864843651643');" onmouseout="out('-3657774864843651643');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 328                 SqlNode source = ((SqlInsert) pollSqlNode).getSource();                                  </span>
<span class="6134982029327154291" onmouseenter="enter('6134982029327154291');" onmouseout="out('6134982029327154291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 329                 addAliasForFieldNode(source, fieldList, mappingTable);                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 330                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331             case AS:                                                                                     </span>
<span class="-6853425371672212621" onmouseenter="enter('-6853425371672212621');" onmouseout="out('-6853425371672212621');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 332                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTable);"> 332                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTab🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 334             case SELECT:                                                                                 </span>
<span class="-345466278028982068" onmouseenter="enter('-345466278028982068');" onmouseout="out('-345466278028982068');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 335                 SqlNodeList selectList = ((SqlSelect) pollSqlNode).getSelectList();                      </span>
<span class="-4478316650227403681" onmouseenter="enter('-4478316650227403681');" onmouseout="out('-4478316650227403681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336                 selectList.getList().forEach(node -&gt; {                                                   </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 337                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 338                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 339                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 340                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 341                         }                                                                                </span>
<span class="-4986679521926317286" onmouseenter="enter('-4986679521926317286');" onmouseout="out('-4986679521926317286');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 342                         // save real field                                                               </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 343                         String fieldName = sqlIdentifier.names.get(1);                                   </span>
<span class="-5921041769209732806" onmouseenter="enter('-5921041769209732806');" onmouseout="out('-5921041769209732806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 344                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().containsKey(fieldName)) {"> 344                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap🔵</abbr></span>
<span class="-2287024865944183458" onmouseenter="enter('-2287024865944183458');" onmouseout="out('-2287024865944183458');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 345                             fieldList.add(fieldName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 346                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 347                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 348                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 349                 });                                                                                      </span>
<span class="-8923237898045704845" onmouseenter="enter('-8923237898045704845');" onmouseout="out('-8923237898045704845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 350                 for (int i = 0; i &lt; selectList.getList().size(); i++) {                                  </span>
<span class="-4321294484021988020" onmouseenter="enter('-4321294484021988020');" onmouseout="out('-4321294484021988020');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 351                     SqlNode node = selectList.get(i);                                                    </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 352                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 353                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 354                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 355                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 356                         }                                                                                </span>
<span class="-170655463018543442" onmouseenter="enter('-170655463018543442');" onmouseout="out('-170655463018543442');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 357                         String name = sqlIdentifier.names.get(1);                                        </span>
<span class="-3204699988614579440" onmouseenter="enter('-3204699988614579440');" onmouseout="out('-3204699988614579440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 358                         // avoid real field pv0 convert pv                                               </span>
<span class="6166166284113505247" onmouseenter="enter('6166166284113505247');" onmouseout="out('6166166284113505247');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 359                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring(0, name.length() - 1))) {"> 359                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 360                             SqlOperator operator = new SqlAsOperator();                                  </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 361                             SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 362                                                                                                          </span>
<span class="-2138283127011244558" onmouseenter="enter('-2138283127011244558');" onmouseout="out('-2138283127011244558');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 363                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() - 1), null, sqlParserPos);"> 363                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.l🔵</abbr></span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 364                             SqlNode[] sqlNodes = new SqlNode[2];                                         </span>
<span class="-2939555014928254235" onmouseenter="enter('-2939555014928254235');" onmouseout="out('-2939555014928254235');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 365                             sqlNodes[0] = sqlIdentifier;                                                 </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 366                             sqlNodes[1] = sqlIdentifierAlias;                                            </span>
<span class="172920197577317623" onmouseenter="enter('172920197577317623');" onmouseout="out('172920197577317623');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 367                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos);"> 367                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 368                                                                                                          </span>
<span class="-6513758114426947797" onmouseenter="enter('-6513758114426947797');" onmouseout="out('-6513758114426947797');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 369                             selectList.set(i, sqlBasicCall);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 372                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 373                 break;                                                                                   </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 374             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 375                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 376         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 378                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379                                                                                                          </span>
<span class="3897594848566528823" onmouseenter="enter('3897594848566528823');" onmouseout="out('3897594848566528823');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380     public AliasInfo parseAsNode(SqlNode sqlNode) throws SqlParseException {                             </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 381 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 382         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="3363188275491767702" onmouseenter="enter('3363188275491767702');" onmouseout="out('3363188275491767702');" style=""> 383         if(sqlKind != AS){                                                                               </span>
<span class="1088430228081547460" onmouseenter="enter('1088430228081547460');" onmouseout="out('1088430228081547460');" style=""> 384             throw new RuntimeException(sqlNode + &quot; is not &#x27;as&#x27; operator&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385         }                                                                                                </span>
<span  style=""> 386                                                                                                          </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 387         SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                         </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 388         SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                       </span>
<span  style=""> 389                                                                                                          </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 390         AliasInfo aliasInfo = new AliasInfo();                                                           </span>
<span class="-5109084571101185803" onmouseenter="enter('-5109084571101185803');" onmouseout="out('-5109084571101185803');" style=""> 391         aliasInfo.setName(info.toString());                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 392         aliasInfo.setAlias(alias.toString());                                                            </span>
<span  style=""> 393                                                                                                          </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 394         return aliasInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395     }                                                                                                    </span>
<span  style=""> 396                                                                                                          </span>
<span class="4707165697759746048" onmouseenter="enter('4707165697759746048');" onmouseout="out('4707165697759746048');" style=""> 397     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo,                            </span>
<span class="244517366126553103" onmouseenter="enter('244517366126553103');" onmouseout="out('244517366126553103');" style=""> 398                                            HashBasedTable&lt;String, String, String&gt; mappingTable) {        </span>
<span class="-3566414926414695948" onmouseenter="enter('-3566414926414695948');" onmouseout="out('-3566414926414695948');" style=""> 399         TypeInformation[] sideOutTypes = new TypeInformation[sideJoinFieldInfo.size()];                  </span>
<span class="-637166731779412769" onmouseenter="enter('-637166731779412769');" onmouseout="out('-637166731779412769');" style=""> 400         String[] sideOutNames = new String[sideJoinFieldInfo.size()];                                    </span>
<span class="7438730024850909889" onmouseenter="enter('7438730024850909889');" onmouseout="out('7438730024850909889');" style=""> 401         for (int i = 0; i &lt; sideJoinFieldInfo.size(); i++) {                                             </span>
<span class="2207877773063469724" onmouseenter="enter('2207877773063469724');" onmouseout="out('2207877773063469724');" style=""> 402             FieldInfo fieldInfo = sideJoinFieldInfo.get(i);                                              </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 403             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 404             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span  style=""> 405                                                                                                          </span>
<span class="3640983111807923268" onmouseenter="enter('3640983111807923268');" onmouseout="out('3640983111807923268');" style=""> 406             String mappingFieldName = mappingTable.get(tableName, fieldName);                            </span>
<span class="-4165873345254348507" onmouseenter="enter('-4165873345254348507');" onmouseout="out('-4165873345254348507');" style=""><abbr title=" 407             Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be frame bug&quot;);"> 407             Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be f🔵</abbr></span>
<span  style=""> 408                                                                                                          </span>
<span class="4913645198555706594" onmouseenter="enter('4913645198555706594');" onmouseout="out('4913645198555706594');" style=""> 409             sideOutTypes[i] = fieldInfo.getTypeInformation();                                            </span>
<span class="6276485717663783154" onmouseenter="enter('6276485717663783154');" onmouseout="out('6276485717663783154');" style=""> 410             sideOutNames[i] = mappingFieldName;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411         }                                                                                                </span>
<span class="2691939759498133513" onmouseenter="enter('2691939759498133513');" onmouseout="out('2691939759498133513');" style=""> 412         return new RowTypeInfo(sideOutTypes, sideOutNames);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413     }                                                                                                    </span>
<span  style=""> 414                                                                                                          </span>
<span  style=""> 415                                                                                                          </span>
<span  style=""> 416                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 417     /**                                                                                                  </span>
<span class="4027944609056411189" onmouseenter="enter('4027944609056411189');" onmouseout="out('4027944609056411189');" style=""> 418      *  对时间类型进行类型转换                                                                                      </span>
<span class="-7981851073621455488" onmouseenter="enter('-7981851073621455488');" onmouseout="out('-7981851073621455488');" style=""> 419      * @param leftTypeInfo                                                                               </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 420      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 421      */                                                                                                  </span>
<span class="109255438874014135" onmouseenter="enter('109255438874014135');" onmouseout="out('109255438874014135');" style=""> 422     private RowTypeInfo buildLeftTableOutType(RowTypeInfo leftTypeInfo) {                                </span>
<span class="5269317691380571116" onmouseenter="enter('5269317691380571116');" onmouseout="out('5269317691380571116');" style=""> 423         TypeInformation[] sideOutTypes = new TypeInformation[leftTypeInfo.getFieldNames().length];       </span>
<span class="357447233987634249" onmouseenter="enter('357447233987634249');" onmouseout="out('357447233987634249');" style=""> 424         TypeInformation&lt;?&gt;[] fieldTypes = leftTypeInfo.getFieldTypes();                                  </span>
<span class="-7313385440196867180" onmouseenter="enter('-7313385440196867180');" onmouseout="out('-7313385440196867180');" style=""> 425         for (int i = 0; i &lt; sideOutTypes.length; i++) {                                                  </span>
<span class="-314833607359598646" onmouseenter="enter('-314833607359598646');" onmouseout="out('-314833607359598646');" style=""> 426             sideOutTypes[i] = convertTimeAttributeType(fieldTypes[i]);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427         }                                                                                                </span>
<span class="-6446480870466684625" onmouseenter="enter('-6446480870466684625');" onmouseout="out('-6446480870466684625');" style=""> 428         RowTypeInfo rowTypeInfo = new RowTypeInfo(sideOutTypes, leftTypeInfo.getFieldNames());           </span>
<span class="6189116692514123920" onmouseenter="enter('6189116692514123920');" onmouseout="out('6189116692514123920');" style=""> 429         return rowTypeInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430     }                                                                                                    </span>
<span  style=""> 431                                                                                                          </span>
<span class="2471506251995792847" onmouseenter="enter('2471506251995792847');" onmouseout="out('2471506251995792847');" style=""> 432     private TypeInformation convertTimeAttributeType(TypeInformation typeInformation) {                  </span>
<span class="2997926285576198837" onmouseenter="enter('2997926285576198837');" onmouseout="out('2997926285576198837');" style=""> 433         if (typeInformation instanceof TimeIndicatorTypeInfo) {                                          </span>
<span class="-6249974448261972874" onmouseenter="enter('-6249974448261972874');" onmouseout="out('-6249974448261972874');" style=""> 434             return TypeInformation.of(Timestamp.class);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435         }                                                                                                </span>
<span class="6871348106862514693" onmouseenter="enter('6871348106862514693');" onmouseout="out('6871348106862514693');" style=""> 436         return typeInformation;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 437     }                                                                                                    </span>
<span  style=""> 438                                                                                                          </span>
<span  style=""> 439                                                                                                          </span>
<span  style=""> 440                                                                                                          </span>
<span  style=""> 441                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 442 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 443 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444                             sqlNodes[1] = sqlIdentifierAlias;                                            </span>
<span class="172920197577317623" onmouseenter="enter('172920197577317623');" onmouseout="out('172920197577317623');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 445                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos);"> 445                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446                                                                                                          </span>
<span class="-6513758114426947797" onmouseenter="enter('-6513758114426947797');" onmouseout="out('-6513758114426947797');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447                             selectList.set(i, sqlBasicCall);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 451                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 452         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 453     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 454                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 455                                                                                                          </span>
<span class="73834954090191073" onmouseenter="enter('73834954090191073');" onmouseout="out('73834954090191073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 456     public AliasInfo parseASNode(SqlNode sqlNode) throws SqlParseException {                             </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 457         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="3363188275491767702" onmouseenter="enter('3363188275491767702');" onmouseout="out('3363188275491767702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 458         if(sqlKind != AS){                                                                               </span>
<span class="1088430228081547460" onmouseenter="enter('1088430228081547460');" onmouseout="out('1088430228081547460');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 459             throw new RuntimeException(sqlNode + &quot; is not &#x27;as&#x27; operator&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 460         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 461                                                                                                          </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 462         SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                         </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 463         SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 464                                                                                                          </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 465         AliasInfo aliasInfo = new AliasInfo();                                                           </span>
<span class="-5109084571101185803" onmouseenter="enter('-5109084571101185803');" onmouseout="out('-5109084571101185803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 466         aliasInfo.setName(info.toString());                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 467         aliasInfo.setAlias(alias.toString());                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 468                                                                                                          </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 469         return aliasInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 470     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 471                                                                                                          </span>
<span class="-8689302297966137516" onmouseenter="enter('-8689302297966137516');" onmouseout="out('-8689302297966137516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 472     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 472     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, Stri🔵</abbr></span>
<span class="-3566414926414695948" onmouseenter="enter('-3566414926414695948');" onmouseout="out('-3566414926414695948');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 473         TypeInformation[] sideOutTypes = new TypeInformation[sideJoinFieldInfo.size()];                  </span>
<span class="-637166731779412769" onmouseenter="enter('-637166731779412769');" onmouseout="out('-637166731779412769');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 474         String[] sideOutNames = new String[sideJoinFieldInfo.size()];                                    </span>
<span class="7438730024850909889" onmouseenter="enter('7438730024850909889');" onmouseout="out('7438730024850909889');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 475         for (int i = 0; i &lt; sideJoinFieldInfo.size(); i++) {                                             </span>
<span class="2207877773063469724" onmouseenter="enter('2207877773063469724');" onmouseout="out('2207877773063469724');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 476             FieldInfo fieldInfo = sideJoinFieldInfo.get(i);                                              </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 477             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 478             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 479             String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);        </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 480             mappingTable.put(tableName, fieldName, mappingFieldName);                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 481                                                                                                          </span>
<span class="4913645198555706594" onmouseenter="enter('4913645198555706594');" onmouseout="out('4913645198555706594');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 482             sideOutTypes[i] = fieldInfo.getTypeInformation();                                            </span>
<span class="6276485717663783154" onmouseenter="enter('6276485717663783154');" onmouseout="out('6276485717663783154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 483             sideOutNames[i] = mappingFieldName;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 484         }                                                                                                </span>
<span class="2691939759498133513" onmouseenter="enter('2691939759498133513');" onmouseout="out('2691939759498133513');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 485         return new RowTypeInfo(sideOutTypes, sideOutNames);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 486     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 487                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 488                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 489                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 490     /**                                                                                                  </span>
<span class="4027944609056411189" onmouseenter="enter('4027944609056411189');" onmouseout="out('4027944609056411189');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 491      *  对时间类型进行类型转换                                                                                      </span>
<span class="-7981851073621455488" onmouseenter="enter('-7981851073621455488');" onmouseout="out('-7981851073621455488');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 492      * @param leftTypeInfo                                                                               </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 493      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 494      */                                                                                                  </span>
<span class="109255438874014135" onmouseenter="enter('109255438874014135');" onmouseout="out('109255438874014135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 495     private RowTypeInfo buildLeftTableOutType(RowTypeInfo leftTypeInfo) {                                </span>
<span class="5269317691380571116" onmouseenter="enter('5269317691380571116');" onmouseout="out('5269317691380571116');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 496         TypeInformation[] sideOutTypes = new TypeInformation[leftTypeInfo.getFieldNames().length];       </span>
<span class="357447233987634249" onmouseenter="enter('357447233987634249');" onmouseout="out('357447233987634249');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 497         TypeInformation&lt;?&gt;[] fieldTypes = leftTypeInfo.getFieldTypes();                                  </span>
<span class="-7313385440196867180" onmouseenter="enter('-7313385440196867180');" onmouseout="out('-7313385440196867180');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 498         for (int i = 0; i &lt; sideOutTypes.length; i++) {                                                  </span>
<span class="-314833607359598646" onmouseenter="enter('-314833607359598646');" onmouseout="out('-314833607359598646');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 499             sideOutTypes[i] = convertTimeAttributeType(fieldTypes[i]);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 500         }                                                                                                </span>
<span class="-6446480870466684625" onmouseenter="enter('-6446480870466684625');" onmouseout="out('-6446480870466684625');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 501         RowTypeInfo rowTypeInfo = new RowTypeInfo(sideOutTypes, leftTypeInfo.getFieldNames());           </span>
<span class="6189116692514123920" onmouseenter="enter('6189116692514123920');" onmouseout="out('6189116692514123920');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 502         return rowTypeInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 503     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 504                                                                                                          </span>
<span class="2471506251995792847" onmouseenter="enter('2471506251995792847');" onmouseout="out('2471506251995792847');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 505     private TypeInformation convertTimeAttributeType(TypeInformation typeInformation) {                  </span>
<span class="2997926285576198837" onmouseenter="enter('2997926285576198837');" onmouseout="out('2997926285576198837');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 506         if (typeInformation instanceof TimeIndicatorTypeInfo) {                                          </span>
<span class="-6249974448261972874" onmouseenter="enter('-6249974448261972874');" onmouseout="out('-6249974448261972874');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 507             return TypeInformation.of(Timestamp.class);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 508         }                                                                                                </span>
<span class="6871348106862514693" onmouseenter="enter('6871348106862514693');" onmouseout="out('6871348106862514693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 509         return typeInformation;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 510     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 511                                                                                                          </span>
<span class="4184261108342886546" onmouseenter="enter('4184261108342886546');" onmouseout="out('4184261108342886546');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 512     //需要考虑更多的情况                                                                                          </span>
<span class="-5866348515582828073" onmouseenter="enter('-5866348515582828073');" onmouseout="out('-5866348515582828073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 513     private void replaceFieldName(SqlNode sqlNode, FieldReplaceInfo replaceInfo) {                       </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 514         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 515         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 516             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 517                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="3539579188210716047" onmouseenter="enter('3539579188210716047');" onmouseout="out('3539579188210716047');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 518                 replaceFieldName(sqlSource, replaceInfo);                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 519                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 520             case AS:                                                                                     </span>
<span class="-2471580703701460163" onmouseenter="enter('-2471580703701460163');" onmouseout="out('-2471580703701460163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 521                 SqlNode asNode = ((SqlBasicCall) sqlNode).getOperands()[0];                              </span>
<span class="2382936847570265491" onmouseenter="enter('2382936847570265491');" onmouseout="out('2382936847570265491');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 522                 replaceFieldName(asNode, replaceInfo);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 523                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 524             case SELECT:                                                                                 </span>
<span class="7730902652365827282" onmouseenter="enter('7730902652365827282');" onmouseout="out('7730902652365827282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 525                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName());"> 525                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTarget🔵</abbr></span>
<span class="-1465070514376240276" onmouseenter="enter('-1465070514376240276');" onmouseout="out('-1465070514376240276');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 526                 if(sqlSelect == null){                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 527                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 528                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 529                                                                                                          </span>
<span class="-7911431356156617515" onmouseenter="enter('-7911431356156617515');" onmouseout="out('-7911431356156617515');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 530                 SqlNode sqlSource1 = sqlSelect.getFrom();                                                </span>
<span class="-4060139958118865814" onmouseenter="enter('-4060139958118865814');" onmouseout="out('-4060139958118865814');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 531                 if(sqlSource1.getKind() == AS){                                                          </span>
<span class="7708153722582291408" onmouseenter="enter('7708153722582291408');" onmouseout="out('7708153722582291408');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 532                     String tableName = ((SqlBasicCall)sqlSource1).getOperands()[0].toString();           </span>
<span class="-7976662112993336650" onmouseenter="enter('-7976662112993336650');" onmouseout="out('-7976662112993336650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 533                     if(tableName.equalsIgnoreCase(replaceInfo.getTargetTableName())){                    </span>
<span class="5036423329776629809" onmouseenter="enter('5036423329776629809');" onmouseout="out('5036423329776629809');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 534                         SqlNodeList sqlSelectList = sqlSelect.getSelectList();                           </span>
<span class="4783458191183529265" onmouseenter="enter('4783458191183529265');" onmouseout="out('4783458191183529265');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 535                         SqlNode whereNode = sqlSelect.getWhere();                                        </span>
<span class="6069356713975423578" onmouseenter="enter('6069356713975423578');" onmouseout="out('6069356713975423578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 536                         SqlNodeList sqlGroup = sqlSelect.getGroup();                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 537                                                                                                          </span>
<span class="2024933395694494313" onmouseenter="enter('2024933395694494313');" onmouseout="out('2024933395694494313');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 538                         //TODO 暂时不处理having                                                               </span>
<span class="-2928778695763881832" onmouseenter="enter('-2928778695763881832');" onmouseout="out('-2928778695763881832');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 539                         SqlNode sqlHaving = sqlSelect.getHaving();                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 540                                                                                                          </span>
<span class="-3614471078991347107" onmouseenter="enter('-3614471078991347107');" onmouseout="out('-3614471078991347107');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 541                         List&lt;SqlNode&gt; newSelectNodeList = Lists.newArrayList();                          </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 542                         for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                            </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 543                             SqlNode selectNode = sqlSelectList.getList().get(i);                         </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 544                             //特殊处理 isStar的标识                                                             </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 545                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){"> 545                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar(🔵</abbr></span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 546                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);"> 546                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, re🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 547                                 newSelectNodeList.addAll(replaceNodeList);                               </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 548                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 549                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 550                                                                                                          </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 551                             SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);       </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 552                             if(replaceNode == null){                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 553                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 554                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 555                                                                                                          </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 556                             //sqlSelectList.set(i, replaceNode);                                         </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 557                             newSelectNodeList.add(replaceNode);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 558                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 559                                                                                                          </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 560                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());"> 560                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getP🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 561                         sqlSelect.setSelectList(newSelectList);                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 562                                                                                                          </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 563                         //where                                                                          </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 564                         if(whereNode != null){                                                           </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 565                             SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();             </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 566                             for(int i =0; i&lt;sqlNodeList.length; i++) {                                   </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 567                                 SqlNode whereSqlNode = sqlNodeList[i];                                   </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 568                                 SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);        </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 569                                 sqlNodeList[i] = replaceNode;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 570                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 571                         }                                                                                </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 572                         if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){          </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 573                             for( int i=0; i&lt;sqlGroup.getList().size(); i++){                             </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 574                                 SqlNode selectNode = sqlGroup.getList().get(i);                          </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 575                                 SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);          </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 576                                 sqlGroup.set(i, replaceNode);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 577                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 578                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 579                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 580                 }else{                                                                                   </span>
<span class="5468885380070811563" onmouseenter="enter('5468885380070811563');" onmouseout="out('5468885380070811563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 581                     //TODO                                                                               </span>
<span class="-7176218527101706664" onmouseenter="enter('-7176218527101706664');" onmouseout="out('-7176218527101706664');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 582                     System.out.println(sqlNode);                                                         </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 583                     throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 584                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 585                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 586                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 587             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 588                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 589                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 590                 replaceFieldName(unionLeft, replaceInfo);                                                </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 591                 replaceFieldName(unionRight, replaceInfo);                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 592                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 593                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 594             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 595                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 596                 replaceFieldName(sqlOrderBy.query, replaceInfo);                                         </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 597                 SqlNodeList orderFiledList = sqlOrderBy.orderList;                                       </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 598                 for (int i=0 ;i&lt;orderFiledList.size();i++) {                                             </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 599                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());"> 599                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getT🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 600                     orderFiledList.set(i, replaceNode);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 601                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 602                                                                                                          </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 603             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 604                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 605         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 606     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 607                                                                                                          </span>
<span class="-4529709500477233937" onmouseenter="enter('-4529709500477233937');" onmouseout="out('-4529709500477233937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 608     private SqlNode replaceOrderByTableName(SqlNode orderNode, String tableAlias) {                      </span>
<span class="-8843072586907859237" onmouseenter="enter('-8843072586907859237');" onmouseout="out('-8843072586907859237');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 609         if(orderNode.getKind() == IDENTIFIER){                                                           </span>
<span class="1286019212722079849" onmouseenter="enter('1286019212722079849');" onmouseout="out('1286019212722079849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 610             SqlIdentifier sqlIdentifier = (SqlIdentifier) orderNode;                                     </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 611             if (sqlIdentifier.names.size() == 1) {                                                       </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 612                 return orderNode;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 613             }                                                                                            </span>
<span class="4987076328947336547" onmouseenter="enter('4987076328947336547');" onmouseout="out('4987076328947336547');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 614             return sqlIdentifier.setName(0, tableAlias);                                                 </span>
<span class="6164370744345420381" onmouseenter="enter('6164370744345420381');" onmouseout="out('6164370744345420381');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 615         } else if (orderNode instanceof  SqlBasicCall) {                                                 </span>
<span class="4197878478620092735" onmouseenter="enter('4197878478620092735');" onmouseout="out('4197878478620092735');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 616             SqlBasicCall sqlBasicCall = (SqlBasicCall) orderNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 617             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 618                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="-7345169450449378118" onmouseenter="enter('-7345169450449378118');" onmouseout="out('-7345169450449378118');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 619                 sqlBasicCall.getOperands()[i] = replaceOrderByTableName(sqlNode , tableAlias);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 620             }                                                                                            </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 621             return sqlBasicCall;                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 622         } else {                                                                                         </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 623             return orderNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 624         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 625     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 626                                                                                                          </span>
<span class="4620342074554351588" onmouseenter="enter('4620342074554351588');" onmouseout="out('4620342074554351588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 627     private SqlNode replaceNodeInfo(SqlNode groupNode, FieldReplaceInfo replaceInfo){                    </span>
<span class="-8006552962557562934" onmouseenter="enter('-8006552962557562934');" onmouseout="out('-8006552962557562934');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 628         if(groupNode.getKind() == IDENTIFIER){                                                           </span>
<span class="3769318911409416973" onmouseenter="enter('3769318911409416973');" onmouseout="out('3769318911409416973');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 629             SqlIdentifier sqlIdentifier = (SqlIdentifier) groupNode;                                     </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 630             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 631                 return sqlIdentifier;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 632             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 633                                                                                                          </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 634             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 634             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="1289832806545417263" onmouseenter="enter('1289832806545417263');" onmouseout="out('1289832806545417263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 635             if(mappingFieldName == null){                                                                </span>
<span class="-3862759337385230883" onmouseenter="enter('-3862759337385230883');" onmouseout="out('-3862759337385230883');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 636                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + sqlIdentifier.toString() ); </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 637             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 638                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 639             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2521832232004155291" onmouseenter="enter('2521832232004155291');" onmouseout="out('2521832232004155291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 640             return sqlIdentifier.setName(1, mappingFieldName);                                           </span>
<span class="6819015395036995114" onmouseenter="enter('6819015395036995114');" onmouseout="out('6819015395036995114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 641         }else if(groupNode instanceof  SqlBasicCall){                                                    </span>
<span class="8961639140694724649" onmouseenter="enter('8961639140694724649');" onmouseout="out('8961639140694724649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 642             SqlBasicCall sqlBasicCall = (SqlBasicCall) groupNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 643             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 644                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 645                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 646                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 647             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 648                                                                                                          </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 649             return sqlBasicCall;                                                                         </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 650         }else{                                                                                           </span>
<span class="-2985482133144580062" onmouseenter="enter('-2985482133144580062');" onmouseout="out('-2985482133144580062');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 651             return groupNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 652         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 653     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 654                                                                                                          </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 655     public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 656                                                                                                          </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 657         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 658         switch (sqlKind){                                                                                </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 659             case SELECT:                                                                                 </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 660                 SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                       </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 661                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){"> 661                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDE🔵</abbr></span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 662                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){"> 662                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableN🔵</abbr></span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 663                         return sqlNode;                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 664                     }else{                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 665                         return null;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 666                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 667                 }else{                                                                                   </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 668                     return filterNodeWithTargetName(fromNode, targetTableName);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 669                 }                                                                                        </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 670             case AS:                                                                                     </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 671                 SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 672                 return filterNodeWithTargetName(childNode, targetTableName);                             </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 673             case JOIN:                                                                                   </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 674                 SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                         </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 675                 SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                      </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 676                 SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);            </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 677                 SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 678                                                                                                          </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 679                 if(leftReturnNode != null) {                                                             </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 680                     return leftReturnNode;                                                               </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 681                 }else if(rightReturnNode != null){                                                       </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 682                     return rightReturnNode;                                                              </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 683                 }else{                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 684                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 685                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 686         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 687                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 688         return null;                                                                                     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 689 =======                                                                                                  </span>
<span class="-3614471078991347107" onmouseenter="enter('-3614471078991347107');" onmouseout="out('-3614471078991347107');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690                         List&lt;SqlNode&gt; newSelectNodeList = Lists.newArrayList();                          </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 691                         for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                            </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692                             SqlNode selectNode = sqlSelectList.getList().get(i);                         </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693                             //特殊处理 isStar的标识                                                             </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 694                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){"> 694                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar(🔵</abbr></span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 695                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);"> 695                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, re🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 696                                 newSelectNodeList.addAll(replaceNodeList);                               </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 697                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 699                                                                                                          </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                             SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);       </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701                             if(replaceNode == null){                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 702                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704                                                                                                          </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705                             //sqlSelectList.set(i, replaceNode);                                         </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 706                             newSelectNodeList.add(replaceNode);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708                                                                                                          </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 709                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());"> 709                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getP🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710                         sqlSelect.setSelectList(newSelectList);                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711                                                                                                          </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712                         //where                                                                          </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713                         if(whereNode != null){                                                           </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714                             SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();             </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715                             for(int i =0; i&lt;sqlNodeList.length; i++) {                                   </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716                                 SqlNode whereSqlNode = sqlNodeList[i];                                   </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717                                 SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);        </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718                                 sqlNodeList[i] = replaceNode;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 719                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720                         }                                                                                </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721                         if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){          </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722                             for( int i=0; i&lt;sqlGroup.getList().size(); i++){                             </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 723                                 SqlNode selectNode = sqlGroup.getList().get(i);                          </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724                                 SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);          </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725                                 sqlGroup.set(i, replaceNode);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 728                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729                 }else{                                                                                   </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                     throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 735                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 736                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 737                 replaceFieldName(unionLeft, replaceInfo);                                                </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 738                 replaceFieldName(unionRight, replaceInfo);                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 739                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 740                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 741             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743                 replaceFieldName(sqlOrderBy.query, replaceInfo);                                         </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 744                 SqlNodeList orderFiledList = sqlOrderBy.orderList;                                       </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 745                 for (int i=0 ;i&lt;orderFiledList.size();i++) {                                             </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 746                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());"> 746                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getT🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 747                     orderFiledList.set(i, replaceNode);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 748                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 749                                                                                                          </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 750             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 751                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 752         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 753     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 754                                                                                                          </span>
<span class="-4529709500477233937" onmouseenter="enter('-4529709500477233937');" onmouseout="out('-4529709500477233937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 755     private SqlNode replaceOrderByTableName(SqlNode orderNode, String tableAlias) {                      </span>
<span class="-8843072586907859237" onmouseenter="enter('-8843072586907859237');" onmouseout="out('-8843072586907859237');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 756         if(orderNode.getKind() == IDENTIFIER){                                                           </span>
<span class="1286019212722079849" onmouseenter="enter('1286019212722079849');" onmouseout="out('1286019212722079849');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 757             SqlIdentifier sqlIdentifier = (SqlIdentifier) orderNode;                                     </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 758             if (sqlIdentifier.names.size() == 1) {                                                       </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 759                 return orderNode;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 760             }                                                                                            </span>
<span class="4987076328947336547" onmouseenter="enter('4987076328947336547');" onmouseout="out('4987076328947336547');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 761             return sqlIdentifier.setName(0, tableAlias);                                                 </span>
<span class="6164370744345420381" onmouseenter="enter('6164370744345420381');" onmouseout="out('6164370744345420381');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 762         } else if (orderNode instanceof  SqlBasicCall) {                                                 </span>
<span class="4197878478620092735" onmouseenter="enter('4197878478620092735');" onmouseout="out('4197878478620092735');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 763             SqlBasicCall sqlBasicCall = (SqlBasicCall) orderNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 764             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 765                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="-7345169450449378118" onmouseenter="enter('-7345169450449378118');" onmouseout="out('-7345169450449378118');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 766                 sqlBasicCall.getOperands()[i] = replaceOrderByTableName(sqlNode , tableAlias);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 767             }                                                                                            </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 768             return sqlBasicCall;                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 769         } else {                                                                                         </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 770             return orderNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 771         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 772     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 773                                                                                                          </span>
<span class="4620342074554351588" onmouseenter="enter('4620342074554351588');" onmouseout="out('4620342074554351588');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 774     private SqlNode replaceNodeInfo(SqlNode groupNode, FieldReplaceInfo replaceInfo){                    </span>
<span class="-8006552962557562934" onmouseenter="enter('-8006552962557562934');" onmouseout="out('-8006552962557562934');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 775         if(groupNode.getKind() == IDENTIFIER){                                                           </span>
<span class="3769318911409416973" onmouseenter="enter('3769318911409416973');" onmouseout="out('3769318911409416973');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 776             SqlIdentifier sqlIdentifier = (SqlIdentifier) groupNode;                                     </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 777             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 778                 return sqlIdentifier;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 779             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 780                                                                                                          </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 781             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 781             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="1289832806545417263" onmouseenter="enter('1289832806545417263');" onmouseout="out('1289832806545417263');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 782             if(mappingFieldName == null){                                                                </span>
<span class="-3862759337385230883" onmouseenter="enter('-3862759337385230883');" onmouseout="out('-3862759337385230883');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 783                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + sqlIdentifier.toString() ); </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 784             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 785                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 786             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2521832232004155291" onmouseenter="enter('2521832232004155291');" onmouseout="out('2521832232004155291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 787             return sqlIdentifier.setName(1, mappingFieldName);                                           </span>
<span class="6819015395036995114" onmouseenter="enter('6819015395036995114');" onmouseout="out('6819015395036995114');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 788         }else if(groupNode instanceof  SqlBasicCall){                                                    </span>
<span class="8961639140694724649" onmouseenter="enter('8961639140694724649');" onmouseout="out('8961639140694724649');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 789             SqlBasicCall sqlBasicCall = (SqlBasicCall) groupNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 790             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 791                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 792                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 793                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 794             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 795                                                                                                          </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 796             return sqlBasicCall;                                                                         </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 797         }else{                                                                                           </span>
<span class="-2985482133144580062" onmouseenter="enter('-2985482133144580062');" onmouseout="out('-2985482133144580062');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 798             return groupNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 799         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 800     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 801                                                                                                          </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 802     public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 803                                                                                                          </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 804         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 805         switch (sqlKind){                                                                                </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 806             case SELECT:                                                                                 </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 807                 SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                       </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 808                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){"> 808                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDE🔵</abbr></span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 809                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){"> 809                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableN🔵</abbr></span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 810                         return sqlNode;                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 811                     }else{                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 812                         return null;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 813                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 814                 }else{                                                                                   </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 815                     return filterNodeWithTargetName(fromNode, targetTableName);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 816                 }                                                                                        </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 817             case AS:                                                                                     </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 818                 SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 819                 return filterNodeWithTargetName(childNode, targetTableName);                             </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 820             case JOIN:                                                                                   </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 821                 SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                         </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 822                 SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                      </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 823                 SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);            </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 824                 SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 825                                                                                                          </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 826                 if(leftReturnNode != null) {                                                             </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 827                     return leftReturnNode;                                                               </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 828                 }else if(rightReturnNode != null){                                                       </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 829                     return rightReturnNode;                                                              </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 830                 }else{                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 831                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 832                 }                                                                                        </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 833             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 834                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 835         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 836                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 837         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 838     }                                                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 839 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 840                                                                                                          </span>
<span  style=""> 841                                                                                                          </span>
<span class="-6722855011181273565" onmouseenter="enter('-6722855011181273565');" onmouseout="out('-6722855011181273565');" style=""> 842     public void setLocalSqlPluginPath(String localSqlPluginPath) {                                       </span>
<span class="6258662942576926140" onmouseenter="enter('6258662942576926140');" onmouseout="out('6258662942576926140');" style=""> 843         this.localSqlPluginPath = localSqlPluginPath;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 844     }                                                                                                    </span>
<span  style=""> 845                                                                                                          </span>
<span class="2277905399441322839" onmouseenter="enter('2277905399441322839');" onmouseout="out('2277905399441322839');" style=""><abbr title=" 846     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableName){"> 846     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableNa🔵</abbr></span>
<span class="-6301156236825066460" onmouseenter="enter('-6301156236825066460');" onmouseout="out('-6301156236825066460');" style=""> 847         Table table = localTableCache.get(tableAlias);                                                   </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 848         if(table == null){                                                                               </span>
<span class="-5960895848666330323" onmouseenter="enter('-5960895848666330323');" onmouseout="out('-5960895848666330323');" style=""> 849             table = localTableCache.get(tableName);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 850         }                                                                                                </span>
<span  style=""> 851                                                                                                          </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 852         if(table == null){                                                                               </span>
<span class="4627225224916806199" onmouseenter="enter('4627225224916806199');" onmouseout="out('4627225224916806199');" style=""> 853             throw new RuntimeException(&quot;not register table &quot; + tableAlias);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 854         }                                                                                                </span>
<span  style=""> 855                                                                                                          </span>
<span class="-6017334383208509278" onmouseenter="enter('-6017334383208509278');" onmouseout="out('-6017334383208509278');" style=""> 856         return table;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 857     }                                                                                                    </span>
<span  style=""> 858                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 859 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 860 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 861         SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 862                                                                                                          </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 863         AliasInfo aliasInfo = new AliasInfo();                                                           </span>
<span class="-5109084571101185803" onmouseenter="enter('-5109084571101185803');" onmouseout="out('-5109084571101185803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 864         aliasInfo.setName(info.toString());                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 865         aliasInfo.setAlias(alias.toString());                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 866                                                                                                          </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 867         return aliasInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 868     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 869                                                                                                          </span>
<span class="-8689302297966137516" onmouseenter="enter('-8689302297966137516');" onmouseout="out('-8689302297966137516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 870     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 870     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, Stri🔵</abbr></span>
<span class="-3566414926414695948" onmouseenter="enter('-3566414926414695948');" onmouseout="out('-3566414926414695948');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 871         TypeInformation[] sideOutTypes = new TypeInformation[sideJoinFieldInfo.size()];                  </span>
<span class="-637166731779412769" onmouseenter="enter('-637166731779412769');" onmouseout="out('-637166731779412769');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 872         String[] sideOutNames = new String[sideJoinFieldInfo.size()];                                    </span>
<span class="7438730024850909889" onmouseenter="enter('7438730024850909889');" onmouseout="out('7438730024850909889');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 873         for (int i = 0; i &lt; sideJoinFieldInfo.size(); i++) {                                             </span>
<span class="2207877773063469724" onmouseenter="enter('2207877773063469724');" onmouseout="out('2207877773063469724');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 874             FieldInfo fieldInfo = sideJoinFieldInfo.get(i);                                              </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 875             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 876             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 877             String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);        </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 878             mappingTable.put(tableName, fieldName, mappingFieldName);                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 879                                                                                                          </span>
<span class="4913645198555706594" onmouseenter="enter('4913645198555706594');" onmouseout="out('4913645198555706594');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 880             sideOutTypes[i] = fieldInfo.getTypeInformation();                                            </span>
<span class="6276485717663783154" onmouseenter="enter('6276485717663783154');" onmouseout="out('6276485717663783154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 881             sideOutNames[i] = mappingFieldName;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 882         }                                                                                                </span>
<span class="2691939759498133513" onmouseenter="enter('2691939759498133513');" onmouseout="out('2691939759498133513');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 883         return new RowTypeInfo(sideOutTypes, sideOutNames);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 884     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 885                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 886                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 887                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 888     /**                                                                                                  </span>
<span class="4027944609056411189" onmouseenter="enter('4027944609056411189');" onmouseout="out('4027944609056411189');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 889      *  对时间类型进行类型转换                                                                                      </span>
<span class="-7981851073621455488" onmouseenter="enter('-7981851073621455488');" onmouseout="out('-7981851073621455488');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 890      * @param leftTypeInfo                                                                               </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 891      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 892      */                                                                                                  </span>
<span class="109255438874014135" onmouseenter="enter('109255438874014135');" onmouseout="out('109255438874014135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 893     private RowTypeInfo buildLeftTableOutType(RowTypeInfo leftTypeInfo) {                                </span>
<span class="5269317691380571116" onmouseenter="enter('5269317691380571116');" onmouseout="out('5269317691380571116');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 894         TypeInformation[] sideOutTypes = new TypeInformation[leftTypeInfo.getFieldNames().length];       </span>
<span class="357447233987634249" onmouseenter="enter('357447233987634249');" onmouseout="out('357447233987634249');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 895         TypeInformation&lt;?&gt;[] fieldTypes = leftTypeInfo.getFieldTypes();                                  </span>
<span class="-7313385440196867180" onmouseenter="enter('-7313385440196867180');" onmouseout="out('-7313385440196867180');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 896         for (int i = 0; i &lt; sideOutTypes.length; i++) {                                                  </span>
<span class="-314833607359598646" onmouseenter="enter('-314833607359598646');" onmouseout="out('-314833607359598646');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 897             sideOutTypes[i] = convertTimeAttributeType(fieldTypes[i]);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 898         }                                                                                                </span>
<span class="-6446480870466684625" onmouseenter="enter('-6446480870466684625');" onmouseout="out('-6446480870466684625');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 899         RowTypeInfo rowTypeInfo = new RowTypeInfo(sideOutTypes, leftTypeInfo.getFieldNames());           </span>
<span class="6189116692514123920" onmouseenter="enter('6189116692514123920');" onmouseout="out('6189116692514123920');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 900         return rowTypeInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 901     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 902                                                                                                          </span>
<span class="2471506251995792847" onmouseenter="enter('2471506251995792847');" onmouseout="out('2471506251995792847');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 903     private TypeInformation convertTimeAttributeType(TypeInformation typeInformation) {                  </span>
<span class="2997926285576198837" onmouseenter="enter('2997926285576198837');" onmouseout="out('2997926285576198837');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 904         if (typeInformation instanceof TimeIndicatorTypeInfo) {                                          </span>
<span class="-6249974448261972874" onmouseenter="enter('-6249974448261972874');" onmouseout="out('-6249974448261972874');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 905             return TypeInformation.of(Timestamp.class);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 906         }                                                                                                </span>
<span class="6871348106862514693" onmouseenter="enter('6871348106862514693');" onmouseout="out('6871348106862514693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 907         return typeInformation;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 908     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 909                                                                                                          </span>
<span class="4184261108342886546" onmouseenter="enter('4184261108342886546');" onmouseout="out('4184261108342886546');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 910     //需要考虑更多的情况                                                                                          </span>
<span class="-5866348515582828073" onmouseenter="enter('-5866348515582828073');" onmouseout="out('-5866348515582828073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 911     private void replaceFieldName(SqlNode sqlNode, FieldReplaceInfo replaceInfo) {                       </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 912         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 913         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 914             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 915                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="3539579188210716047" onmouseenter="enter('3539579188210716047');" onmouseout="out('3539579188210716047');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 916                 replaceFieldName(sqlSource, replaceInfo);                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 917                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 918             case AS:                                                                                     </span>
<span class="-2471580703701460163" onmouseenter="enter('-2471580703701460163');" onmouseout="out('-2471580703701460163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 919                 SqlNode asNode = ((SqlBasicCall) sqlNode).getOperands()[0];                              </span>
<span class="2382936847570265491" onmouseenter="enter('2382936847570265491');" onmouseout="out('2382936847570265491');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 920                 replaceFieldName(asNode, replaceInfo);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 921                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 922             case SELECT:                                                                                 </span>
<span class="7730902652365827282" onmouseenter="enter('7730902652365827282');" onmouseout="out('7730902652365827282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 923                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName());"> 923                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTarget🔵</abbr></span>
<span class="-1465070514376240276" onmouseenter="enter('-1465070514376240276');" onmouseout="out('-1465070514376240276');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 924                 if(sqlSelect == null){                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 925                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 926                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 927                                                                                                          </span>
<span class="-7911431356156617515" onmouseenter="enter('-7911431356156617515');" onmouseout="out('-7911431356156617515');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 928                 SqlNode sqlSource1 = sqlSelect.getFrom();                                                </span>
<span class="-4060139958118865814" onmouseenter="enter('-4060139958118865814');" onmouseout="out('-4060139958118865814');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 929                 if(sqlSource1.getKind() == AS){                                                          </span>
<span class="7708153722582291408" onmouseenter="enter('7708153722582291408');" onmouseout="out('7708153722582291408');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 930                     String tableName = ((SqlBasicCall)sqlSource1).getOperands()[0].toString();           </span>
<span class="-7976662112993336650" onmouseenter="enter('-7976662112993336650');" onmouseout="out('-7976662112993336650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 931                     if(tableName.equalsIgnoreCase(replaceInfo.getTargetTableName())){                    </span>
<span class="5036423329776629809" onmouseenter="enter('5036423329776629809');" onmouseout="out('5036423329776629809');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 932                         SqlNodeList sqlSelectList = sqlSelect.getSelectList();                           </span>
<span class="4783458191183529265" onmouseenter="enter('4783458191183529265');" onmouseout="out('4783458191183529265');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 933                         SqlNode whereNode = sqlSelect.getWhere();                                        </span>
<span class="6069356713975423578" onmouseenter="enter('6069356713975423578');" onmouseout="out('6069356713975423578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 934                         SqlNodeList sqlGroup = sqlSelect.getGroup();                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 935                                                                                                          </span>
<span class="2024933395694494313" onmouseenter="enter('2024933395694494313');" onmouseout="out('2024933395694494313');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 936                         //TODO 暂时不处理having                                                               </span>
<span class="-2928778695763881832" onmouseenter="enter('-2928778695763881832');" onmouseout="out('-2928778695763881832');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 937                         SqlNode sqlHaving = sqlSelect.getHaving();                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 938                                                                                                          </span>
<span class="-3614471078991347107" onmouseenter="enter('-3614471078991347107');" onmouseout="out('-3614471078991347107');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 939                         List&lt;SqlNode&gt; newSelectNodeList = Lists.newArrayList();                          </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 940                         for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                            </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 941                             SqlNode selectNode = sqlSelectList.getList().get(i);                         </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 942                             //特殊处理 isStar的标识                                                             </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 943                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){"> 943                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar(🔵</abbr></span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 944                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);"> 944                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, re🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 945                                 newSelectNodeList.addAll(replaceNodeList);                               </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 946                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 947                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 948                                                                                                          </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 949                             SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);       </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 950                             if(replaceNode == null){                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 951                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 952                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 953                                                                                                          </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 954                             //sqlSelectList.set(i, replaceNode);                                         </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 955                             newSelectNodeList.add(replaceNode);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 956                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 957                                                                                                          </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 958                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());"> 958                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getP🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 959                         sqlSelect.setSelectList(newSelectList);                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 960                                                                                                          </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 961                         //where                                                                          </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 962                         if(whereNode != null){                                                           </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 963                             SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();             </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 964                             for(int i =0; i&lt;sqlNodeList.length; i++) {                                   </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 965                                 SqlNode whereSqlNode = sqlNodeList[i];                                   </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 966                                 SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);        </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 967                                 sqlNodeList[i] = replaceNode;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 968                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 969                         }                                                                                </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 970                         if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){          </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 971                             for( int i=0; i&lt;sqlGroup.getList().size(); i++){                             </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 972                                 SqlNode selectNode = sqlGroup.getList().get(i);                          </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 973                                 SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);          </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 974                                 sqlGroup.set(i, replaceNode);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 975                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 976                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 977                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 978                 }else{                                                                                   </span>
<span class="5468885380070811563" onmouseenter="enter('5468885380070811563');" onmouseout="out('5468885380070811563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 979                     //TODO                                                                               </span>
<span class="-7176218527101706664" onmouseenter="enter('-7176218527101706664');" onmouseout="out('-7176218527101706664');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 980                     System.out.println(sqlNode);                                                         </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 981                     throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 982                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 983                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 984                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 985             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 986                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 987                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 988                 replaceFieldName(unionLeft, replaceInfo);                                                </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 989                 replaceFieldName(unionRight, replaceInfo);                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 990                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 991                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 992             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 993                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 994                 replaceFieldName(sqlOrderBy.query, replaceInfo);                                         </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 995                 SqlNodeList orderFiledList = sqlOrderBy.orderList;                                       </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 996                 for (int i=0 ;i&lt;orderFiledList.size();i++) {                                             </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 997                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());"> 997                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getT🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 998                     orderFiledList.set(i, replaceNode);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 999                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1000                                                                                                          </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1001             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1002                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1003         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1004     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1005                                                                                                          </span>
<span class="-4529709500477233937" onmouseenter="enter('-4529709500477233937');" onmouseout="out('-4529709500477233937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1006     private SqlNode replaceOrderByTableName(SqlNode orderNode, String tableAlias) {                      </span>
<span class="-8843072586907859237" onmouseenter="enter('-8843072586907859237');" onmouseout="out('-8843072586907859237');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1007         if(orderNode.getKind() == IDENTIFIER){                                                           </span>
<span class="1286019212722079849" onmouseenter="enter('1286019212722079849');" onmouseout="out('1286019212722079849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1008             SqlIdentifier sqlIdentifier = (SqlIdentifier) orderNode;                                     </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1009             if (sqlIdentifier.names.size() == 1) {                                                       </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1010                 return orderNode;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1011             }                                                                                            </span>
<span class="4987076328947336547" onmouseenter="enter('4987076328947336547');" onmouseout="out('4987076328947336547');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1012             return sqlIdentifier.setName(0, tableAlias);                                                 </span>
<span class="6164370744345420381" onmouseenter="enter('6164370744345420381');" onmouseout="out('6164370744345420381');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1013         } else if (orderNode instanceof  SqlBasicCall) {                                                 </span>
<span class="4197878478620092735" onmouseenter="enter('4197878478620092735');" onmouseout="out('4197878478620092735');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1014             SqlBasicCall sqlBasicCall = (SqlBasicCall) orderNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1015             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1016                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="-7345169450449378118" onmouseenter="enter('-7345169450449378118');" onmouseout="out('-7345169450449378118');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1017                 sqlBasicCall.getOperands()[i] = replaceOrderByTableName(sqlNode , tableAlias);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1018             }                                                                                            </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1019             return sqlBasicCall;                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1020         } else {                                                                                         </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1021             return orderNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1022         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1023     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1024                                                                                                          </span>
<span class="4620342074554351588" onmouseenter="enter('4620342074554351588');" onmouseout="out('4620342074554351588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1025     private SqlNode replaceNodeInfo(SqlNode groupNode, FieldReplaceInfo replaceInfo){                    </span>
<span class="-8006552962557562934" onmouseenter="enter('-8006552962557562934');" onmouseout="out('-8006552962557562934');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1026         if(groupNode.getKind() == IDENTIFIER){                                                           </span>
<span class="3769318911409416973" onmouseenter="enter('3769318911409416973');" onmouseout="out('3769318911409416973');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1027             SqlIdentifier sqlIdentifier = (SqlIdentifier) groupNode;                                     </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1028             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1029                 return sqlIdentifier;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1030             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1031                                                                                                          </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1032             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());">1032             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="1289832806545417263" onmouseenter="enter('1289832806545417263');" onmouseout="out('1289832806545417263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1033             if(mappingFieldName == null){                                                                </span>
<span class="-3862759337385230883" onmouseenter="enter('-3862759337385230883');" onmouseout="out('-3862759337385230883');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1034                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + sqlIdentifier.toString() ); </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1035             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1036                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1037             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2521832232004155291" onmouseenter="enter('2521832232004155291');" onmouseout="out('2521832232004155291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1038             return sqlIdentifier.setName(1, mappingFieldName);                                           </span>
<span class="6819015395036995114" onmouseenter="enter('6819015395036995114');" onmouseout="out('6819015395036995114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1039         }else if(groupNode instanceof  SqlBasicCall){                                                    </span>
<span class="8961639140694724649" onmouseenter="enter('8961639140694724649');" onmouseout="out('8961639140694724649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1040             SqlBasicCall sqlBasicCall = (SqlBasicCall) groupNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1041             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1042                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1043                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1044                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1045             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1046                                                                                                          </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1047             return sqlBasicCall;                                                                         </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1048         }else{                                                                                           </span>
<span class="-2985482133144580062" onmouseenter="enter('-2985482133144580062');" onmouseout="out('-2985482133144580062');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1049             return groupNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1050         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1051     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1052                                                                                                          </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1053     public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1054                                                                                                          </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1055         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1056         switch (sqlKind){                                                                                </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1057             case SELECT:                                                                                 </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1058                 SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                       </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1059                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){">1059                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDE🔵</abbr></span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1060                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){">1060                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableN🔵</abbr></span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1061                         return sqlNode;                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1062                     }else{                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1063                         return null;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1064                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1065                 }else{                                                                                   </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1066                     return filterNodeWithTargetName(fromNode, targetTableName);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1067                 }                                                                                        </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1068             case AS:                                                                                     </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1069                 SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1070                 return filterNodeWithTargetName(childNode, targetTableName);                             </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1071             case JOIN:                                                                                   </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1072                 SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                         </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1073                 SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                      </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1074                 SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);            </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1075                 SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1076                                                                                                          </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1077                 if(leftReturnNode != null) {                                                             </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1078                     return leftReturnNode;                                                               </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1079                 }else if(rightReturnNode != null){                                                       </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1080                     return rightReturnNode;                                                              </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1081                 }else{                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1082                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1083                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1084         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1085                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1086         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1087     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1088                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1089                                                                                                          </span>
<span class="-6722855011181273565" onmouseenter="enter('-6722855011181273565');" onmouseout="out('-6722855011181273565');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1090     public void setLocalSqlPluginPath(String localSqlPluginPath) {                                       </span>
<span class="6258662942576926140" onmouseenter="enter('6258662942576926140');" onmouseout="out('6258662942576926140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1091         this.localSqlPluginPath = localSqlPluginPath;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1092     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1093                                                                                                          </span>
<span class="2277905399441322839" onmouseenter="enter('2277905399441322839');" onmouseout="out('2277905399441322839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1094     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableName){">1094     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableNa🔵</abbr></span>
<span class="-6301156236825066460" onmouseenter="enter('-6301156236825066460');" onmouseout="out('-6301156236825066460');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1095         Table table = localTableCache.get(tableAlias);                                                   </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1096         if(table == null){                                                                               </span>
<span class="-5960895848666330323" onmouseenter="enter('-5960895848666330323');" onmouseout="out('-5960895848666330323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1097             table = localTableCache.get(tableName);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1098         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1099                                                                                                          </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1100         if(table == null){                                                                               </span>
<span class="-2825016904896826066" onmouseenter="enter('-2825016904896826066');" onmouseout="out('-2825016904896826066');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1101             throw new RuntimeException(&quot;not register table &quot; + tableName);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1102         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1103                                                                                                          </span>
<span class="-6017334383208509278" onmouseenter="enter('-6017334383208509278');" onmouseout="out('-6017334383208509278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1104         return table;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1105     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1106                                                                                                          </span>
<span class="-8696523049985644897" onmouseenter="enter('-8696523049985644897');" onmouseout="out('-8696523049985644897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1107     private List&lt;SqlNode&gt; replaceSelectStarFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo){  </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1108         SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                        </span>
<span class="-376697531199676299" onmouseenter="enter('-376697531199676299');" onmouseout="out('-376697531199676299');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1109         List&lt;SqlNode&gt; sqlNodes = Lists.newArrayList();                                                   </span>
<span class="-3220711380851181839" onmouseenter="enter('-3220711380851181839');" onmouseout="out('-3220711380851181839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1110         if(sqlIdentifier.isStar()){//处理 [* or table.*]                                                   </span>
<span class="-8760640117888015743" onmouseenter="enter('-8760640117888015743');" onmouseout="out('-8760640117888015743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1111             int identifierSize = sqlIdentifier.names.size();                                             </span>
<span class="-737230567623922483" onmouseenter="enter('-737230567623922483');" onmouseout="out('-737230567623922483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1112             Collection&lt;String&gt; columns = null;                                                           </span>
<span class="-3878600943817580523" onmouseenter="enter('-3878600943817580523');" onmouseout="out('-3878600943817580523');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1113             if(identifierSize == 1){                                                                     </span>
<span class="439489357590017604" onmouseenter="enter('439489357590017604');" onmouseout="out('439489357590017604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1114                 columns = replaceInfo.getMappingTable().values();                                        </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1115             }else{                                                                                       </span>
<span class="-6967503276601174325" onmouseenter="enter('-6967503276601174325');" onmouseout="out('-6967503276601174325');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1116                 columns = replaceInfo.getMappingTable().row(sqlIdentifier.names.get(0)).values();        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1117             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1118                                                                                                          </span>
<span class="-8621425588629763030" onmouseenter="enter('-8621425588629763030');" onmouseout="out('-8621425588629763030');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1119             for(String colAlias : columns){                                                              </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1120                 SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                      </span>
<span class="7376564429850475234" onmouseenter="enter('7376564429850475234');" onmouseout="out('7376564429850475234');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1121                 List&lt;String&gt; columnInfo = Lists.newArrayList();                                          </span>
<span class="-7580690826400610936" onmouseenter="enter('-7580690826400610936');" onmouseout="out('-7580690826400610936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1122                 columnInfo.add(replaceInfo.getTargetTableAlias());                                       </span>
<span class="8071016449845654104" onmouseenter="enter('8071016449845654104');" onmouseout="out('8071016449845654104');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1123                 columnInfo.add(colAlias);                                                                </span>
<span class="-2937163626106946341" onmouseenter="enter('-2937163626106946341');" onmouseout="out('-2937163626106946341');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1124                 SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(columnInfo, sqlParserPos);          </span>
<span class="6977395894616298454" onmouseenter="enter('6977395894616298454');" onmouseout="out('6977395894616298454');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1125                 sqlNodes.add(sqlIdentifierAlias);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1126             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1127                                                                                                          </span>
<span class="-2192274943977569589" onmouseenter="enter('-2192274943977569589');" onmouseout="out('-2192274943977569589');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1128             return sqlNodes;                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1129         }else{                                                                                           </span>
<span class="-8039826041817422769" onmouseenter="enter('-8039826041817422769');" onmouseout="out('-8039826041817422769');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1130             throw new RuntimeException(&quot;is not a star select field.&quot; + selectNode);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1131         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1132     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1133                                                                                                          </span>
<span class="-5931652736394605669" onmouseenter="enter('-5931652736394605669');" onmouseout="out('-5931652736394605669');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1134     private SqlNode replaceSelectFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo) {           </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1135         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1136             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-1521486087941699086" onmouseenter="enter('-1521486087941699086');" onmouseout="out('-1521486087941699086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1137             SqlNode replaceNode = replaceSelectFieldName(leftNode, replaceInfo);                         </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1138             if (replaceNode != null) {                                                                   </span>
<span class="44744548385893691" onmouseenter="enter('44744548385893691');" onmouseout="out('44744548385893691');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1139                 ((SqlBasicCall) selectNode).getOperands()[0] = replaceNode;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1140             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1141                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1142             return selectNode;                                                                           </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1143         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1144             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1145                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1146             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1147                 return selectNode;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1148             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1149                                                                                                          </span>
<span class="5152547743275588251" onmouseenter="enter('5152547743275588251');" onmouseout="out('5152547743275588251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1150             //Same level mappingTable                                                                    </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1151             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());">1151             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="-6523721893364253351" onmouseenter="enter('-6523721893364253351');" onmouseout="out('-6523721893364253351');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1152             if (mappingFieldName == null) {                                                              </span>
<span class="8276130366719222706" onmouseenter="enter('8276130366719222706');" onmouseout="out('8276130366719222706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1153                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + selectNode.toString() );    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1154             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1155                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1156             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2571352877158902005" onmouseenter="enter('2571352877158902005');" onmouseout="out('2571352877158902005');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1157             sqlIdentifier = sqlIdentifier.setName(1, mappingFieldName);                                  </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1158             return sqlIdentifier;                                                                        </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1159         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1160             return selectNode;                                                                           </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1161         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1162                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1163                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1164                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1165                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1166                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1167                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1168                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1169                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1170                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1171                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1172                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1173                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1174                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1175                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1176                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1177                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1178                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1179                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1180                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1181                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1182                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1183                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1184                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1185                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1186                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1187                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1188                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1189                 || selectNode.getKind() == LIKE                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1190                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1191                 ){                                                                                       </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1192             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1193             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1194                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1195                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1196                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1197                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1198                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1199                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1200                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1201                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1202                                                                                                          </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1203                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1204                 if(replaceNode == null){                                                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1205                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1206                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1207                                                                                                          </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1208                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1209             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1210                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1211             return selectNode;                                                                           </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1212         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-6113591358780745482" onmouseenter="enter('-6113591358780745482');" onmouseout="out('-6113591358780745482');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1213             System.out.println(&quot;selectNode&quot;);                                                            </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1214             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1215             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1216             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1217             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1218                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1219             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1220                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1221                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1222                 if (replaceNode != null) {                                                               </span>
<span class="827753515492975605" onmouseenter="enter('827753515492975605');" onmouseout="out('827753515492975605');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1223                     whenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1224                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1225             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1226                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1227             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1228                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1229                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1230                 if (replaceNode != null) {                                                               </span>
<span class="-4947674979480974151" onmouseenter="enter('-4947674979480974151');" onmouseout="out('-4947674979480974151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1231                     thenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1232                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1233             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1234                                                                                                          </span>
<span class="-1702904876822094161" onmouseenter="enter('-1702904876822094161');" onmouseout="out('-1702904876822094161');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1235             ((SqlCase) selectNode).setOperand(3, replaceSelectFieldName(elseNode, replaceInfo));         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1236             return selectNode;                                                                           </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1237         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1238             //不处理                                                                                        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1239             return selectNode;                                                                           </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1240         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1241             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));">1241             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">1242 =======                                                                                                  </span>
<span class="-8696523049985644897" onmouseenter="enter('-8696523049985644897');" onmouseout="out('-8696523049985644897');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1243     private List&lt;SqlNode&gt; replaceSelectStarFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo){  </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1244         SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                        </span>
<span class="-376697531199676299" onmouseenter="enter('-376697531199676299');" onmouseout="out('-376697531199676299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1245         List&lt;SqlNode&gt; sqlNodes = Lists.newArrayList();                                                   </span>
<span class="-3220711380851181839" onmouseenter="enter('-3220711380851181839');" onmouseout="out('-3220711380851181839');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1246         if(sqlIdentifier.isStar()){//处理 [* or table.*]                                                   </span>
<span class="-8760640117888015743" onmouseenter="enter('-8760640117888015743');" onmouseout="out('-8760640117888015743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1247             int identifierSize = sqlIdentifier.names.size();                                             </span>
<span class="-737230567623922483" onmouseenter="enter('-737230567623922483');" onmouseout="out('-737230567623922483');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1248             Collection&lt;String&gt; columns = null;                                                           </span>
<span class="-3878600943817580523" onmouseenter="enter('-3878600943817580523');" onmouseout="out('-3878600943817580523');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1249             if(identifierSize == 1){                                                                     </span>
<span class="439489357590017604" onmouseenter="enter('439489357590017604');" onmouseout="out('439489357590017604');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1250                 columns = replaceInfo.getMappingTable().values();                                        </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1251             }else{                                                                                       </span>
<span class="-6967503276601174325" onmouseenter="enter('-6967503276601174325');" onmouseout="out('-6967503276601174325');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1252                 columns = replaceInfo.getMappingTable().row(sqlIdentifier.names.get(0)).values();        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1253             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1254                                                                                                          </span>
<span class="-8621425588629763030" onmouseenter="enter('-8621425588629763030');" onmouseout="out('-8621425588629763030');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1255             for(String colAlias : columns){                                                              </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1256                 SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                      </span>
<span class="7376564429850475234" onmouseenter="enter('7376564429850475234');" onmouseout="out('7376564429850475234');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1257                 List&lt;String&gt; columnInfo = Lists.newArrayList();                                          </span>
<span class="-7580690826400610936" onmouseenter="enter('-7580690826400610936');" onmouseout="out('-7580690826400610936');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1258                 columnInfo.add(replaceInfo.getTargetTableAlias());                                       </span>
<span class="8071016449845654104" onmouseenter="enter('8071016449845654104');" onmouseout="out('8071016449845654104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1259                 columnInfo.add(colAlias);                                                                </span>
<span class="-2937163626106946341" onmouseenter="enter('-2937163626106946341');" onmouseout="out('-2937163626106946341');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1260                 SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(columnInfo, sqlParserPos);          </span>
<span class="6977395894616298454" onmouseenter="enter('6977395894616298454');" onmouseout="out('6977395894616298454');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1261                 sqlNodes.add(sqlIdentifierAlias);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1262             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1263                                                                                                          </span>
<span class="-2192274943977569589" onmouseenter="enter('-2192274943977569589');" onmouseout="out('-2192274943977569589');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1264             return sqlNodes;                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1265         }else{                                                                                           </span>
<span class="-8039826041817422769" onmouseenter="enter('-8039826041817422769');" onmouseout="out('-8039826041817422769');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1266             throw new RuntimeException(&quot;is not a star select field.&quot; + selectNode);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1267         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1268     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1269                                                                                                          </span>
<span class="-5931652736394605669" onmouseenter="enter('-5931652736394605669');" onmouseout="out('-5931652736394605669');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1270     private SqlNode replaceSelectFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo) {           </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1271         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1272             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-1521486087941699086" onmouseenter="enter('-1521486087941699086');" onmouseout="out('-1521486087941699086');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1273             SqlNode replaceNode = replaceSelectFieldName(leftNode, replaceInfo);                         </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1274             if (replaceNode != null) {                                                                   </span>
<span class="44744548385893691" onmouseenter="enter('44744548385893691');" onmouseout="out('44744548385893691');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1275                 ((SqlBasicCall) selectNode).getOperands()[0] = replaceNode;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1276             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1277                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1278             return selectNode;                                                                           </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1279         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1280             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1281                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1282             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1283                 return selectNode;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1284             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1285                                                                                                          </span>
<span class="5152547743275588251" onmouseenter="enter('5152547743275588251');" onmouseout="out('5152547743275588251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1286             //Same level mappingTable                                                                    </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1287             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());">1287             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="-6523721893364253351" onmouseenter="enter('-6523721893364253351');" onmouseout="out('-6523721893364253351');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1288             if (mappingFieldName == null) {                                                              </span>
<span class="8276130366719222706" onmouseenter="enter('8276130366719222706');" onmouseout="out('8276130366719222706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1289                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + selectNode.toString() );    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1290             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1291                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1292             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2571352877158902005" onmouseenter="enter('2571352877158902005');" onmouseout="out('2571352877158902005');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1293             sqlIdentifier = sqlIdentifier.setName(1, mappingFieldName);                                  </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1294             return sqlIdentifier;                                                                        </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1295         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1296             return selectNode;                                                                           </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1297         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1298                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1299                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1300                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1301                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1302                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1303                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1304                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1305                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1306                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1307                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1308                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1309                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1310                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1311                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1312                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1313                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1314                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1315                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1316                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1317                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1318                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1319                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1320                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1321                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1322                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1323                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1324                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1325                 || selectNode.getKind() == LIKE                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1326                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1327                 ){                                                                                       </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1328             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1329             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1330                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1331                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1332                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1333                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1334                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1335                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1336                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1337                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1338                                                                                                          </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1339                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1340                 if(replaceNode == null){                                                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1341                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1342                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1343                                                                                                          </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1344                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1345             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1346                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1347             return selectNode;                                                                           </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1348         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1349             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1350             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1351             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1352             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1353                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1354             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1355                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1356                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1357                 if (replaceNode != null) {                                                               </span>
<span class="827753515492975605" onmouseenter="enter('827753515492975605');" onmouseout="out('827753515492975605');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1358                     whenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1359                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1360             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1361                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1362             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1363                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1364                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1365                 if (replaceNode != null) {                                                               </span>
<span class="-4947674979480974151" onmouseenter="enter('-4947674979480974151');" onmouseout="out('-4947674979480974151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1366                     thenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1367                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1368             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1369                                                                                                          </span>
<span class="-1702904876822094161" onmouseenter="enter('-1702904876822094161');" onmouseout="out('-1702904876822094161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1370             ((SqlCase) selectNode).setOperand(3, replaceSelectFieldName(elseNode, replaceInfo));         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1371             return selectNode;                                                                           </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1372         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1373             //不处理                                                                                        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1374             return selectNode;                                                                           </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1375         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1376             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));">1376             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1377         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1378     }                                                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">1379 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">1380                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1381     /**                                                                                                  </span>
<span class="5196638318686351881" onmouseenter="enter('5196638318686351881');" onmouseout="out('5196638318686351881');" style=""><abbr title="1382      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension table is the primary key definition">1382      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., d🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1383      *                                                                                                   </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">1384      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1385      */                                                                                                  </span>
<span class="4488554625343324946" onmouseenter="enter('4488554625343324946');" onmouseout="out('4488554625343324946');" style=""><abbr title="1386     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInfo sideTableInfo) {">1386     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInf🔵</abbr></span>
<span class="-6710736308674703771" onmouseenter="enter('-6710736308674703771');" onmouseout="out('-6710736308674703771');" style="">1387         List&lt;String&gt; conditionFields = getConditionFields(conditionNode, sideTableAlias, sideTableInfo); </span>
<span class="-3924194481322428470" onmouseenter="enter('-3924194481322428470');" onmouseout="out('-3924194481322428470');" style="">1388         if(CollectionUtils.isEqualCollection(conditionFields, convertPrimaryAlias(sideTableInfo))){      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">1389             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1390         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1391         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1392     }                                                                                                    </span>
<span  style="">1393                                                                                                          </span>
<span class="572998504046101497" onmouseenter="enter('572998504046101497');" onmouseout="out('572998504046101497');" style="">1394     private List&lt;String&gt; convertPrimaryAlias(AbstractSideTableInfo sideTableInfo) {                      </span>
<span class="-6700733268022775520" onmouseenter="enter('-6700733268022775520');" onmouseout="out('-6700733268022775520');" style="">1395         List&lt;String&gt; res = Lists.newArrayList();                                                         </span>
<span class="-1517278133900331130" onmouseenter="enter('-1517278133900331130');" onmouseout="out('-1517278133900331130');" style="">1396         sideTableInfo.getPrimaryKeys().forEach(field -&gt; {                                                </span>
<span class="2991641550935988694" onmouseenter="enter('2991641550935988694');" onmouseout="out('2991641550935988694');" style="">1397             res.add(sideTableInfo.getPhysicalFields().getOrDefault(field, field));                       </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="">1398         });                                                                                              </span>
<span class="1866624461241282949" onmouseenter="enter('1866624461241282949');" onmouseout="out('1866624461241282949');" style="">1399         return res;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1400     }                                                                                                    </span>
<span  style="">1401                                                                                                          </span>
<span class="-958139939083183834" onmouseenter="enter('-958139939083183834');" onmouseout="out('-958139939083183834');" style=""><abbr title="1402     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTableInfo sideTableInfo){">1402     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTa🔵</abbr></span>
<span class="-5667062641477778387" onmouseenter="enter('-5667062641477778387');" onmouseout="out('-5667062641477778387');" style="">1403         List&lt;SqlNode&gt; sqlNodeList = Lists.newArrayList();                                                </span>
<span class="5003747983397221043" onmouseenter="enter('5003747983397221043');" onmouseout="out('5003747983397221043');" style="">1404         ParseUtils.parseAnd(conditionNode, sqlNodeList);                                                 </span>
<span class="331902561671078290" onmouseenter="enter('331902561671078290');" onmouseout="out('331902561671078290');" style="">1405         List&lt;String&gt; conditionFields = Lists.newArrayList();                                             </span>
<span class="-2336842894952786561" onmouseenter="enter('-2336842894952786561');" onmouseout="out('-2336842894952786561');" style="">1406         for(SqlNode sqlNode : sqlNodeList){                                                              </span>
<span class="-1235221313035004193" onmouseenter="enter('-1235221313035004193');" onmouseout="out('-1235221313035004193');" style="">1407             if (!SqlKind.COMPARISON.contains(sqlNode.getKind())) {                                       </span>
<span class="4238811186041433324" onmouseenter="enter('4238811186041433324');" onmouseout="out('4238811186041433324');" style="">1408                 throw new RuntimeException(&quot;not compare operator.&quot;);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1409             }                                                                                            </span>
<span  style="">1410                                                                                                          </span>
<span class="-7359051973666627295" onmouseenter="enter('-7359051973666627295');" onmouseout="out('-7359051973666627295');" style="">1411             SqlIdentifier left = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];                </span>
<span class="3465298874779506196" onmouseenter="enter('3465298874779506196');" onmouseout="out('3465298874779506196');" style="">1412             SqlIdentifier right = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];               </span>
<span  style="">1413                                                                                                          </span>
<span class="-2670749344655178863" onmouseenter="enter('-2670749344655178863');" onmouseout="out('-2670749344655178863');" style="">1414             String leftTableName = left.getComponent(0).getSimple();                                     </span>
<span class="5188110590184041827" onmouseenter="enter('5188110590184041827');" onmouseout="out('5188110590184041827');" style="">1415             String rightTableName = right.getComponent(0).getSimple();                                   </span>
<span  style="">1416                                                                                                          </span>
<span class="8082853509369418918" onmouseenter="enter('8082853509369418918');" onmouseout="out('8082853509369418918');" style="">1417             String tableCol = &quot;&quot;;                                                                        </span>
<span class="3869855333927982135" onmouseenter="enter('3869855333927982135');" onmouseout="out('3869855333927982135');" style="">1418             if(leftTableName.equalsIgnoreCase(specifyTableName)){                                        </span>
<span class="4527748628163402760" onmouseenter="enter('4527748628163402760');" onmouseout="out('4527748628163402760');" style="">1419                 tableCol = left.getComponent(1).getSimple();                                             </span>
<span class="5068195286258055415" onmouseenter="enter('5068195286258055415');" onmouseout="out('5068195286258055415');" style="">1420             }else if(rightTableName.equalsIgnoreCase(specifyTableName)){                                 </span>
<span class="4462633703217831544" onmouseenter="enter('4462633703217831544');" onmouseout="out('4462633703217831544');" style="">1421                 tableCol = right.getComponent(1).getSimple();                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="">1422             }else{                                                                                       </span>
<span class="3783543445731730404" onmouseenter="enter('3783543445731730404');" onmouseout="out('3783543445731730404');" style=""><abbr title="1423                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName));">1423                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specify🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1424             }                                                                                            </span>
<span class="-2325401555704525047" onmouseenter="enter('-2325401555704525047');" onmouseout="out('-2325401555704525047');" style="">1425             tableCol = sideTableInfo.getPhysicalFields().getOrDefault(tableCol, tableCol);               </span>
<span class="-4552234441929070616" onmouseenter="enter('-4552234441929070616');" onmouseout="out('-4552234441929070616');" style="">1426             conditionFields.add(tableCol);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1427         }                                                                                                </span>
<span  style="">1428                                                                                                          </span>
<span class="4950082808497882460" onmouseenter="enter('4950082808497882460');" onmouseout="out('4950082808497882460');" style="">1429         return conditionFields;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1430     }                                                                                                    </span>
<span  style="">1431                                                                                                          </span>
<span class="-8173208587282838964" onmouseenter="enter('-8173208587282838964');" onmouseout="out('-8173208587282838964');" style="">1432     protected void dealAsSourceTable(StreamTableEnvironment tableEnv,                                    </span>
<span class="9126592535894268017" onmouseenter="enter('9126592535894268017');" onmouseout="out('9126592535894268017');" style="">1433                                      SqlNode pollSqlNode,                                                </span>
<span class="-4636178628928660306" onmouseenter="enter('-4636178628928660306');" onmouseout="out('-4636178628928660306');" style="">1434                                      Map&lt;String, Table&gt; tableCache) throws SqlParseException {           </span>
<span  style="">1435                                                                                                          </span>
<span class="7772412594103241573" onmouseenter="enter('7772412594103241573');" onmouseout="out('7772412594103241573');" style="">1436         AliasInfo aliasInfo = parseAsNode(pollSqlNode);                                                  </span>
<span class="2461088292100865778" onmouseenter="enter('2461088292100865778');" onmouseout="out('2461088292100865778');" style="">1437         if (localTableCache.containsKey(aliasInfo.getName())) {                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1438             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1439         }                                                                                                </span>
<span  style="">1440                                                                                                          </span>
<span class="-3390660419579622283" onmouseenter="enter('-3390660419579622283');" onmouseout="out('-3390660419579622283');" style="">1441         Table table = tableEnv.sqlQuery(aliasInfo.getName());                                            </span>
<span class="5901087968051131557" onmouseenter="enter('5901087968051131557');" onmouseout="out('5901087968051131557');" style="">1442         tableEnv.registerTable(aliasInfo.getAlias(), table);                                             </span>
<span class="1100939894023116874" onmouseenter="enter('1100939894023116874');" onmouseout="out('1100939894023116874');" style="">1443         localTableCache.put(aliasInfo.getAlias(), table);                                                </span>
<span  style="">1444                                                                                                          </span>
<span class="7353361537117728269" onmouseenter="enter('7353361537117728269');" onmouseout="out('7353361537117728269');" style="">1445         LOG.info(&quot;Register Table {} by {}&quot;, aliasInfo.getAlias(), aliasInfo.getName());                  </span>
<span  style="">1446                                                                                                          </span>
<span class="-8665165690117838262" onmouseenter="enter('-8665165690117838262');" onmouseout="out('-8665165690117838262');" style="">1447         FieldReplaceInfo fieldReplaceInfo = parseAsQuery((SqlBasicCall) pollSqlNode, tableCache);        </span>
<span class="-7633956211129533821" onmouseenter="enter('-7633956211129533821');" onmouseout="out('-7633956211129533821');" style="">1448         if(fieldReplaceInfo == null){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1449            return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1450         }                                                                                                </span>
<span  style="">1451                                                                                                          </span>
<span class="-6438671410831308886" onmouseenter="enter('-6438671410831308886');" onmouseout="out('-6438671410831308886');" style="">1452         //as 的源表                                                                                         </span>
<span class="-7252441079357822746" onmouseenter="enter('-7252441079357822746');" onmouseout="out('-7252441079357822746');" style="">1453         Set&lt;String&gt; fromTableNameSet = Sets.newHashSet();                                                </span>
<span class="-1390965398492412473" onmouseenter="enter('-1390965398492412473');" onmouseout="out('-1390965398492412473');" style="">1454         SqlNode fromNode = ((SqlBasicCall)pollSqlNode).getOperands()[0];                                 </span>
<span class="8218826531385538687" onmouseenter="enter('8218826531385538687');" onmouseout="out('8218826531385538687');" style="">1455         TableUtils.getFromTableInfo(fromNode, fromTableNameSet);                                         </span>
<span  style="">1456                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1457     }                                                                                                    </span>
<span  style="">1458                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">1459 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-894097875121841059" onmouseenter="enter('-894097875121841059');" onmouseout="out('-894097875121841059');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1460     private void joinFun(Object pollObj,                                                                 </span>
<span class="6823594550750748067" onmouseenter="enter('6823594550750748067');" onmouseout="out('6823594550750748067');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1461                          Map&lt;String, Table&gt; localTableCache,                                             </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1462                          Map&lt;String, SideTableInfo&gt; sideTableMap,                                        </span>
<span class="-1170693753985315194" onmouseenter="enter('-1170693753985315194');" onmouseout="out('-1170693753985315194');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1463                          StreamTableEnvironment tableEnv) throws Exception{                              </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">1464 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1465                         for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                            </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1466                             SqlNode selectNode = sqlSelectList.getList().get(i);                         </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1467                             //特殊处理 isStar的标识                                                             </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1468                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){">1468                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar(🔵</abbr></span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1469                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);">1469                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, re🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1470                                 newSelectNodeList.addAll(replaceNodeList);                               </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1471                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1472                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1473                                                                                                          </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1474                             SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);       </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1475                             if(replaceNode == null){                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1476                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1477                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1478                                                                                                          </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1479                             //sqlSelectList.set(i, replaceNode);                                         </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1480                             newSelectNodeList.add(replaceNode);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1481                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1482                                                                                                          </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1483                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());">1483                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getP🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1484                         sqlSelect.setSelectList(newSelectList);                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1485                                                                                                          </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1486                         //where                                                                          </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1487                         if(whereNode != null){                                                           </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1488                             SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();             </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1489                             for(int i =0; i&lt;sqlNodeList.length; i++) {                                   </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1490                                 SqlNode whereSqlNode = sqlNodeList[i];                                   </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1491                                 SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);        </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1492                                 sqlNodeList[i] = replaceNode;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1493                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1494                         }                                                                                </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1495                         if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){          </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1496                             for( int i=0; i&lt;sqlGroup.getList().size(); i++){                             </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1497                                 SqlNode selectNode = sqlGroup.getList().get(i);                          </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1498                                 SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);          </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1499                                 sqlGroup.set(i, replaceNode);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1500                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1501                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1502                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1503                 }else{                                                                                   </span>
<span class="5468885380070811563" onmouseenter="enter('5468885380070811563');" onmouseout="out('5468885380070811563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1504                     //TODO                                                                               </span>
<span class="-7176218527101706664" onmouseenter="enter('-7176218527101706664');" onmouseout="out('-7176218527101706664');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1505                     System.out.println(sqlNode);                                                         </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1506                     throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1507                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1508                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1509                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1510             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1511                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1512                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1513                 replaceFieldName(unionLeft, replaceInfo);                                                </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1514                 replaceFieldName(unionRight, replaceInfo);                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1515                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1516                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1517             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1518                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1519                 replaceFieldName(sqlOrderBy.query, replaceInfo);                                         </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1520                 SqlNodeList orderFiledList = sqlOrderBy.orderList;                                       </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1521                 for (int i=0 ;i&lt;orderFiledList.size();i++) {                                             </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1522                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());">1522                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getT🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1523                     orderFiledList.set(i, replaceNode);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1524                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1525                                                                                                          </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1526             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1527                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1528         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1529     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1530                                                                                                          </span>
<span class="-4529709500477233937" onmouseenter="enter('-4529709500477233937');" onmouseout="out('-4529709500477233937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1531     private SqlNode replaceOrderByTableName(SqlNode orderNode, String tableAlias) {                      </span>
<span class="-8843072586907859237" onmouseenter="enter('-8843072586907859237');" onmouseout="out('-8843072586907859237');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1532         if(orderNode.getKind() == IDENTIFIER){                                                           </span>
<span class="1286019212722079849" onmouseenter="enter('1286019212722079849');" onmouseout="out('1286019212722079849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1533             SqlIdentifier sqlIdentifier = (SqlIdentifier) orderNode;                                     </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1534             if (sqlIdentifier.names.size() == 1) {                                                       </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1535                 return orderNode;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1536             }                                                                                            </span>
<span class="4987076328947336547" onmouseenter="enter('4987076328947336547');" onmouseout="out('4987076328947336547');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1537             return sqlIdentifier.setName(0, tableAlias);                                                 </span>
<span class="6164370744345420381" onmouseenter="enter('6164370744345420381');" onmouseout="out('6164370744345420381');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1538         } else if (orderNode instanceof  SqlBasicCall) {                                                 </span>
<span class="4197878478620092735" onmouseenter="enter('4197878478620092735');" onmouseout="out('4197878478620092735');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1539             SqlBasicCall sqlBasicCall = (SqlBasicCall) orderNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1540             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1541                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="-7345169450449378118" onmouseenter="enter('-7345169450449378118');" onmouseout="out('-7345169450449378118');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1542                 sqlBasicCall.getOperands()[i] = replaceOrderByTableName(sqlNode , tableAlias);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1543             }                                                                                            </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1544             return sqlBasicCall;                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1545         } else {                                                                                         </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1546             return orderNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1547         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1548     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1549                                                                                                          </span>
<span class="4620342074554351588" onmouseenter="enter('4620342074554351588');" onmouseout="out('4620342074554351588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1550     private SqlNode replaceNodeInfo(SqlNode groupNode, FieldReplaceInfo replaceInfo){                    </span>
<span class="-8006552962557562934" onmouseenter="enter('-8006552962557562934');" onmouseout="out('-8006552962557562934');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1551         if(groupNode.getKind() == IDENTIFIER){                                                           </span>
<span class="3769318911409416973" onmouseenter="enter('3769318911409416973');" onmouseout="out('3769318911409416973');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1552             SqlIdentifier sqlIdentifier = (SqlIdentifier) groupNode;                                     </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1553             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1554                 return sqlIdentifier;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1555             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1556                                                                                                          </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1557             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());">1557             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="1289832806545417263" onmouseenter="enter('1289832806545417263');" onmouseout="out('1289832806545417263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1558             if(mappingFieldName == null){                                                                </span>
<span class="-3862759337385230883" onmouseenter="enter('-3862759337385230883');" onmouseout="out('-3862759337385230883');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1559                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + sqlIdentifier.toString() ); </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1560             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1561                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1562             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2521832232004155291" onmouseenter="enter('2521832232004155291');" onmouseout="out('2521832232004155291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1563             return sqlIdentifier.setName(1, mappingFieldName);                                           </span>
<span class="6819015395036995114" onmouseenter="enter('6819015395036995114');" onmouseout="out('6819015395036995114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1564         }else if(groupNode instanceof  SqlBasicCall){                                                    </span>
<span class="8961639140694724649" onmouseenter="enter('8961639140694724649');" onmouseout="out('8961639140694724649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1565             SqlBasicCall sqlBasicCall = (SqlBasicCall) groupNode;                                        </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1566             for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                   </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1567                 SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                  </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1568                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1569                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1570             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1571                                                                                                          </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1572             return sqlBasicCall;                                                                         </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1573         }else{                                                                                           </span>
<span class="-2985482133144580062" onmouseenter="enter('-2985482133144580062');" onmouseout="out('-2985482133144580062');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1574             return groupNode;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1575         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1576     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1577                                                                                                          </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1578     public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1579                                                                                                          </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1580         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1581         switch (sqlKind){                                                                                </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1582             case SELECT:                                                                                 </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1583                 SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                       </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1584                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){">1584                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDE🔵</abbr></span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1585                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){">1585                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableN🔵</abbr></span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1586                         return sqlNode;                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1587                     }else{                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1588                         return null;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1589                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1590                 }else{                                                                                   </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1591                     return filterNodeWithTargetName(fromNode, targetTableName);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1592                 }                                                                                        </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1593             case AS:                                                                                     </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1594                 SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1595                 return filterNodeWithTargetName(childNode, targetTableName);                             </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1596             case JOIN:                                                                                   </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1597                 SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                         </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1598                 SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                      </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1599                 SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);            </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1600                 SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1601                                                                                                          </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1602                 if(leftReturnNode != null) {                                                             </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1603                     return leftReturnNode;                                                               </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1604                 }else if(rightReturnNode != null){                                                       </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1605                     return rightReturnNode;                                                              </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1606                 }else{                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1607                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1608                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1609         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1610                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1611         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1612     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1613                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1614                                                                                                          </span>
<span class="-6722855011181273565" onmouseenter="enter('-6722855011181273565');" onmouseout="out('-6722855011181273565');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1615     public void setLocalSqlPluginPath(String localSqlPluginPath) {                                       </span>
<span class="6258662942576926140" onmouseenter="enter('6258662942576926140');" onmouseout="out('6258662942576926140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1616         this.localSqlPluginPath = localSqlPluginPath;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1617     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1618                                                                                                          </span>
<span class="2277905399441322839" onmouseenter="enter('2277905399441322839');" onmouseout="out('2277905399441322839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1619     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableName){">1619     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableNa🔵</abbr></span>
<span class="-6301156236825066460" onmouseenter="enter('-6301156236825066460');" onmouseout="out('-6301156236825066460');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1620         Table table = localTableCache.get(tableAlias);                                                   </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1621         if(table == null){                                                                               </span>
<span class="-5960895848666330323" onmouseenter="enter('-5960895848666330323');" onmouseout="out('-5960895848666330323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1622             table = localTableCache.get(tableName);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1623         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1624                                                                                                          </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1625         if(table == null){                                                                               </span>
<span class="-2825016904896826066" onmouseenter="enter('-2825016904896826066');" onmouseout="out('-2825016904896826066');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1626             throw new RuntimeException(&quot;not register table &quot; + tableName);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1627         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1628                                                                                                          </span>
<span class="-6017334383208509278" onmouseenter="enter('-6017334383208509278');" onmouseout="out('-6017334383208509278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1629         return table;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1630     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1631                                                                                                          </span>
<span class="-8696523049985644897" onmouseenter="enter('-8696523049985644897');" onmouseout="out('-8696523049985644897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1632     private List&lt;SqlNode&gt; replaceSelectStarFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo){  </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1633         SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                        </span>
<span class="-376697531199676299" onmouseenter="enter('-376697531199676299');" onmouseout="out('-376697531199676299');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1634         List&lt;SqlNode&gt; sqlNodes = Lists.newArrayList();                                                   </span>
<span class="-3220711380851181839" onmouseenter="enter('-3220711380851181839');" onmouseout="out('-3220711380851181839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1635         if(sqlIdentifier.isStar()){//处理 [* or table.*]                                                   </span>
<span class="-8760640117888015743" onmouseenter="enter('-8760640117888015743');" onmouseout="out('-8760640117888015743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1636             int identifierSize = sqlIdentifier.names.size();                                             </span>
<span class="-737230567623922483" onmouseenter="enter('-737230567623922483');" onmouseout="out('-737230567623922483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1637             Collection&lt;String&gt; columns = null;                                                           </span>
<span class="-3878600943817580523" onmouseenter="enter('-3878600943817580523');" onmouseout="out('-3878600943817580523');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1638             if(identifierSize == 1){                                                                     </span>
<span class="439489357590017604" onmouseenter="enter('439489357590017604');" onmouseout="out('439489357590017604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1639                 columns = replaceInfo.getMappingTable().values();                                        </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1640             }else{                                                                                       </span>
<span class="-6967503276601174325" onmouseenter="enter('-6967503276601174325');" onmouseout="out('-6967503276601174325');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1641                 columns = replaceInfo.getMappingTable().row(sqlIdentifier.names.get(0)).values();        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1642             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1643                                                                                                          </span>
<span class="-8621425588629763030" onmouseenter="enter('-8621425588629763030');" onmouseout="out('-8621425588629763030');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1644             for(String colAlias : columns){                                                              </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1645                 SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                      </span>
<span class="7376564429850475234" onmouseenter="enter('7376564429850475234');" onmouseout="out('7376564429850475234');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1646                 List&lt;String&gt; columnInfo = Lists.newArrayList();                                          </span>
<span class="-7580690826400610936" onmouseenter="enter('-7580690826400610936');" onmouseout="out('-7580690826400610936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1647                 columnInfo.add(replaceInfo.getTargetTableAlias());                                       </span>
<span class="8071016449845654104" onmouseenter="enter('8071016449845654104');" onmouseout="out('8071016449845654104');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1648                 columnInfo.add(colAlias);                                                                </span>
<span class="-2937163626106946341" onmouseenter="enter('-2937163626106946341');" onmouseout="out('-2937163626106946341');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1649                 SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(columnInfo, sqlParserPos);          </span>
<span class="6977395894616298454" onmouseenter="enter('6977395894616298454');" onmouseout="out('6977395894616298454');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1650                 sqlNodes.add(sqlIdentifierAlias);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1651             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1652                                                                                                          </span>
<span class="-2192274943977569589" onmouseenter="enter('-2192274943977569589');" onmouseout="out('-2192274943977569589');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1653             return sqlNodes;                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1654         }else{                                                                                           </span>
<span class="-8039826041817422769" onmouseenter="enter('-8039826041817422769');" onmouseout="out('-8039826041817422769');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1655             throw new RuntimeException(&quot;is not a star select field.&quot; + selectNode);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1656         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1657     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1658                                                                                                          </span>
<span class="-5931652736394605669" onmouseenter="enter('-5931652736394605669');" onmouseout="out('-5931652736394605669');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1659     private SqlNode replaceSelectFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo) {           </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1660         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1661             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-1521486087941699086" onmouseenter="enter('-1521486087941699086');" onmouseout="out('-1521486087941699086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1662             SqlNode replaceNode = replaceSelectFieldName(leftNode, replaceInfo);                         </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1663             if (replaceNode != null) {                                                                   </span>
<span class="44744548385893691" onmouseenter="enter('44744548385893691');" onmouseout="out('44744548385893691');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1664                 ((SqlBasicCall) selectNode).getOperands()[0] = replaceNode;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1665             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1666                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1667             return selectNode;                                                                           </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1668         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1669             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1670                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1671             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1672                 return selectNode;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1673             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1674                                                                                                          </span>
<span class="5152547743275588251" onmouseenter="enter('5152547743275588251');" onmouseout="out('5152547743275588251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1675             //Same level mappingTable                                                                    </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1676             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());">1676             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="-6523721893364253351" onmouseenter="enter('-6523721893364253351');" onmouseout="out('-6523721893364253351');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1677             if (mappingFieldName == null) {                                                              </span>
<span class="8276130366719222706" onmouseenter="enter('8276130366719222706');" onmouseout="out('8276130366719222706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1678                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + selectNode.toString() );    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1679             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1680                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1681             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2571352877158902005" onmouseenter="enter('2571352877158902005');" onmouseout="out('2571352877158902005');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1682             sqlIdentifier = sqlIdentifier.setName(1, mappingFieldName);                                  </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1683             return sqlIdentifier;                                                                        </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1684         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1685             return selectNode;                                                                           </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1686         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1687                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1688                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1689                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1690                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1691                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1692                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1693                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1694                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1695                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1696                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1697                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1698                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1699                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1700                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1701                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1702                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1703                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1704                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1705                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1706                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1707                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1708                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1709                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1710                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1711                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1712                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1713                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1714                 || selectNode.getKind() == LIKE                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1715                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1716                 ){                                                                                       </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1717             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1718             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1719                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1720                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1721                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1722                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1723                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1724                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1725                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1726                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1727                                                                                                          </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1728                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1729                 if(replaceNode == null){                                                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1730                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1731                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1732                                                                                                          </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1733                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1734             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1735                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1736             return selectNode;                                                                           </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1737         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-6113591358780745482" onmouseenter="enter('-6113591358780745482');" onmouseout="out('-6113591358780745482');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1738             System.out.println(&quot;selectNode&quot;);                                                            </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1739             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1740             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1741             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1742             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1743                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1744             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1745                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1746                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1747                 if (replaceNode != null) {                                                               </span>
<span class="827753515492975605" onmouseenter="enter('827753515492975605');" onmouseout="out('827753515492975605');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1748                     whenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1749                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1750             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1751                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1752             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1753                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1754                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1755                 if (replaceNode != null) {                                                               </span>
<span class="-4947674979480974151" onmouseenter="enter('-4947674979480974151');" onmouseout="out('-4947674979480974151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1756                     thenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1757                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1758             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1759                                                                                                          </span>
<span class="-1702904876822094161" onmouseenter="enter('-1702904876822094161');" onmouseout="out('-1702904876822094161');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1760             ((SqlCase) selectNode).setOperand(3, replaceSelectFieldName(elseNode, replaceInfo));         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1761             return selectNode;                                                                           </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1762         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1763             //不处理                                                                                        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1764             return selectNode;                                                                           </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1765         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1766             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));">1766             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1767         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1768     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1769                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1770     /**                                                                                                  </span>
<span class="5196638318686351881" onmouseenter="enter('5196638318686351881');" onmouseout="out('5196638318686351881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1771      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension table is the primary key definition">1771      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., d🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1772      *                                                                                                   </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1773      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1774      */                                                                                                  </span>
<span class="6839043037696086936" onmouseenter="enter('6839043037696086936');" onmouseout="out('6839043037696086936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1775     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, SideTableInfo sideTableInfo) {">1775     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, SideTableInfo sideTa🔵</abbr></span>
<span class="-6710736308674703771" onmouseenter="enter('-6710736308674703771');" onmouseout="out('-6710736308674703771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1776         List&lt;String&gt; conditionFields = getConditionFields(conditionNode, sideTableAlias, sideTableInfo); </span>
<span class="-3924194481322428470" onmouseenter="enter('-3924194481322428470');" onmouseout="out('-3924194481322428470');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1777         if(CollectionUtils.isEqualCollection(conditionFields, convertPrimaryAlias(sideTableInfo))){      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1778             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1779         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1780         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1781     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1782                                                                                                          </span>
<span class="-142104979032699627" onmouseenter="enter('-142104979032699627');" onmouseout="out('-142104979032699627');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1783     private List&lt;String&gt; convertPrimaryAlias(SideTableInfo sideTableInfo) {                              </span>
<span class="-6700733268022775520" onmouseenter="enter('-6700733268022775520');" onmouseout="out('-6700733268022775520');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1784         List&lt;String&gt; res = Lists.newArrayList();                                                         </span>
<span class="-1517278133900331130" onmouseenter="enter('-1517278133900331130');" onmouseout="out('-1517278133900331130');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1785         sideTableInfo.getPrimaryKeys().forEach(field -&gt; {                                                </span>
<span class="2991641550935988694" onmouseenter="enter('2991641550935988694');" onmouseout="out('2991641550935988694');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1786             res.add(sideTableInfo.getPhysicalFields().getOrDefault(field, field));                       </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1787         });                                                                                              </span>
<span class="1866624461241282949" onmouseenter="enter('1866624461241282949');" onmouseout="out('1866624461241282949');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1788         return res;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1789     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1790                                                                                                          </span>
<span class="-1424472995770428534" onmouseenter="enter('-1424472995770428534');" onmouseout="out('-1424472995770428534');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1791     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, SideTableInfo sideTableInfo){">1791     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, SideTableInfo 🔵</abbr></span>
<span class="-5667062641477778387" onmouseenter="enter('-5667062641477778387');" onmouseout="out('-5667062641477778387');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1792         List&lt;SqlNode&gt; sqlNodeList = Lists.newArrayList();                                                </span>
<span class="5003747983397221043" onmouseenter="enter('5003747983397221043');" onmouseout="out('5003747983397221043');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1793         ParseUtils.parseAnd(conditionNode, sqlNodeList);                                                 </span>
<span class="331902561671078290" onmouseenter="enter('331902561671078290');" onmouseout="out('331902561671078290');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1794         List&lt;String&gt; conditionFields = Lists.newArrayList();                                             </span>
<span class="-2336842894952786561" onmouseenter="enter('-2336842894952786561');" onmouseout="out('-2336842894952786561');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1795         for(SqlNode sqlNode : sqlNodeList){                                                              </span>
<span class="-1235221313035004193" onmouseenter="enter('-1235221313035004193');" onmouseout="out('-1235221313035004193');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1796             if (!SqlKind.COMPARISON.contains(sqlNode.getKind())) {                                       </span>
<span class="4238811186041433324" onmouseenter="enter('4238811186041433324');" onmouseout="out('4238811186041433324');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1797                 throw new RuntimeException(&quot;not compare operator.&quot;);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1798             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1799                                                                                                          </span>
<span class="-7359051973666627295" onmouseenter="enter('-7359051973666627295');" onmouseout="out('-7359051973666627295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1800             SqlIdentifier left = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];                </span>
<span class="3465298874779506196" onmouseenter="enter('3465298874779506196');" onmouseout="out('3465298874779506196');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1801             SqlIdentifier right = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1802                                                                                                          </span>
<span class="-2670749344655178863" onmouseenter="enter('-2670749344655178863');" onmouseout="out('-2670749344655178863');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1803             String leftTableName = left.getComponent(0).getSimple();                                     </span>
<span class="5188110590184041827" onmouseenter="enter('5188110590184041827');" onmouseout="out('5188110590184041827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1804             String rightTableName = right.getComponent(0).getSimple();                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1805                                                                                                          </span>
<span class="8082853509369418918" onmouseenter="enter('8082853509369418918');" onmouseout="out('8082853509369418918');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1806             String tableCol = &quot;&quot;;                                                                        </span>
<span class="3869855333927982135" onmouseenter="enter('3869855333927982135');" onmouseout="out('3869855333927982135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1807             if(leftTableName.equalsIgnoreCase(specifyTableName)){                                        </span>
<span class="4527748628163402760" onmouseenter="enter('4527748628163402760');" onmouseout="out('4527748628163402760');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1808                 tableCol = left.getComponent(1).getSimple();                                             </span>
<span class="5068195286258055415" onmouseenter="enter('5068195286258055415');" onmouseout="out('5068195286258055415');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1809             }else if(rightTableName.equalsIgnoreCase(specifyTableName)){                                 </span>
<span class="4462633703217831544" onmouseenter="enter('4462633703217831544');" onmouseout="out('4462633703217831544');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1810                 tableCol = right.getComponent(1).getSimple();                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1811             }else{                                                                                       </span>
<span class="3783543445731730404" onmouseenter="enter('3783543445731730404');" onmouseout="out('3783543445731730404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1812                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName));">1812                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specify🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1813             }                                                                                            </span>
<span class="-2325401555704525047" onmouseenter="enter('-2325401555704525047');" onmouseout="out('-2325401555704525047');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1814             tableCol = sideTableInfo.getPhysicalFields().getOrDefault(tableCol, tableCol);               </span>
<span class="-4552234441929070616" onmouseenter="enter('-4552234441929070616');" onmouseout="out('-4552234441929070616');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1815             conditionFields.add(tableCol);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1816         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1817                                                                                                          </span>
<span class="4950082808497882460" onmouseenter="enter('4950082808497882460');" onmouseout="out('4950082808497882460');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1818         return conditionFields;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1819     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1820                                                                                                          </span>
<span class="-8173208587282838964" onmouseenter="enter('-8173208587282838964');" onmouseout="out('-8173208587282838964');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1821     protected void dealAsSourceTable(StreamTableEnvironment tableEnv,                                    </span>
<span class="9126592535894268017" onmouseenter="enter('9126592535894268017');" onmouseout="out('9126592535894268017');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1822                                      SqlNode pollSqlNode,                                                </span>
<span class="-1493383746124052329" onmouseenter="enter('-1493383746124052329');" onmouseout="out('-1493383746124052329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1823                                      Map&lt;String, Table&gt; tableCache,                                      </span>
<span class="-3293670501905922467" onmouseenter="enter('-3293670501905922467');" onmouseout="out('-3293670501905922467');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1824                                      List&lt;FieldReplaceInfo&gt; replaceInfoList) throws SqlParseException {  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1825                                                                                                          </span>
<span class="-7364020242551640527" onmouseenter="enter('-7364020242551640527');" onmouseout="out('-7364020242551640527');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1826         AliasInfo aliasInfo = parseASNode(pollSqlNode);                                                  </span>
<span class="2461088292100865778" onmouseenter="enter('2461088292100865778');" onmouseout="out('2461088292100865778');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1827         if (localTableCache.containsKey(aliasInfo.getName())) {                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1828             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1829         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1830                                                                                                          </span>
<span class="-3390660419579622283" onmouseenter="enter('-3390660419579622283');" onmouseout="out('-3390660419579622283');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1831         Table table = tableEnv.sqlQuery(aliasInfo.getName());                                            </span>
<span class="5901087968051131557" onmouseenter="enter('5901087968051131557');" onmouseout="out('5901087968051131557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1832         tableEnv.registerTable(aliasInfo.getAlias(), table);                                             </span>
<span class="1100939894023116874" onmouseenter="enter('1100939894023116874');" onmouseout="out('1100939894023116874');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1833         localTableCache.put(aliasInfo.getAlias(), table);                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1834                                                                                                          </span>
<span class="7353361537117728269" onmouseenter="enter('7353361537117728269');" onmouseout="out('7353361537117728269');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1835         LOG.info(&quot;Register Table {} by {}&quot;, aliasInfo.getAlias(), aliasInfo.getName());                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1836                                                                                                          </span>
<span class="-8665165690117838262" onmouseenter="enter('-8665165690117838262');" onmouseout="out('-8665165690117838262');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1837         FieldReplaceInfo fieldReplaceInfo = parseAsQuery((SqlBasicCall) pollSqlNode, tableCache);        </span>
<span class="-7633956211129533821" onmouseenter="enter('-7633956211129533821');" onmouseout="out('-7633956211129533821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1838         if(fieldReplaceInfo == null){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1839            return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1840         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1841                                                                                                          </span>
<span class="-6438671410831308886" onmouseenter="enter('-6438671410831308886');" onmouseout="out('-6438671410831308886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1842         //as 的源表                                                                                         </span>
<span class="-7252441079357822746" onmouseenter="enter('-7252441079357822746');" onmouseout="out('-7252441079357822746');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1843         Set&lt;String&gt; fromTableNameSet = Sets.newHashSet();                                                </span>
<span class="-1390965398492412473" onmouseenter="enter('-1390965398492412473');" onmouseout="out('-1390965398492412473');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1844         SqlNode fromNode = ((SqlBasicCall)pollSqlNode).getOperands()[0];                                 </span>
<span class="8218826531385538687" onmouseenter="enter('8218826531385538687');" onmouseout="out('8218826531385538687');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1845         TableUtils.getFromTableInfo(fromNode, fromTableNameSet);                                         </span>
<span class="3962421982275373463" onmouseenter="enter('3962421982275373463');" onmouseout="out('3962421982275373463');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1846         for(FieldReplaceInfo tmp : replaceInfoList){                                                     </span>
<span class="7807393280391431617" onmouseenter="enter('7807393280391431617');" onmouseout="out('7807393280391431617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1847             if(fromTableNameSet.contains(tmp.getTargetTableName())                                       </span>
<span class="-8987246733617074829" onmouseenter="enter('-8987246733617074829');" onmouseout="out('-8987246733617074829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1848                     || fromTableNameSet.contains(tmp.getTargetTableAlias())){                            </span>
<span class="-8130963267335023429" onmouseenter="enter('-8130963267335023429');" onmouseout="out('-8130963267335023429');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1849                 fieldReplaceInfo.setPreNode(tmp);                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1850                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1851             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1852         }                                                                                                </span>
<span class="2047826278835391080" onmouseenter="enter('2047826278835391080');" onmouseout="out('2047826278835391080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1853         replaceInfoList.add(fieldReplaceInfo);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1854     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1855                                                                                                          </span>
<span class="4197581530070317287" onmouseenter="enter('4197581530070317287');" onmouseout="out('4197581530070317287');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1856     private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache,                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">1857 =======                                                                                                  </span>
<span class="4197581530070317287" onmouseenter="enter('4197581530070317287');" onmouseout="out('4197581530070317287');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1858     private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache,                             </span>
<span class="-7423850058561480692" onmouseenter="enter('-7423850058561480692');" onmouseout="out('-7423850058561480692');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1859                          Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,">1859                          Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv🔵</abbr></span>
<span class="-2956355081691304387" onmouseenter="enter('-2956355081691304387');" onmouseout="out('-2956355081691304387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1860                          List&lt;FieldReplaceInfo&gt; replaceInfoList) throws Exception{                       </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">1861 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-3106951960183426296" onmouseenter="enter('-3106951960183426296');" onmouseout="out('-3106951960183426296');" style="">1862         JoinInfo joinInfo = (JoinInfo) pollObj;                                                          </span>
<span  style="">1863                                                                                                          </span>
<span class="-4580559439294190862" onmouseenter="enter('-4580559439294190862');" onmouseout="out('-4580559439294190862');" style="">1864         JoinScope joinScope = new JoinScope();                                                           </span>
<span class="-6383140859888654083" onmouseenter="enter('-6383140859888654083');" onmouseout="out('-6383140859888654083');" style="">1865         JoinScope.ScopeChild leftScopeChild = new JoinScope.ScopeChild();                                </span>
<span class="-5401707331330951256" onmouseenter="enter('-5401707331330951256');" onmouseout="out('-5401707331330951256');" style="">1866         leftScopeChild.setAlias(joinInfo.getLeftTableAlias());                                           </span>
<span class="5108424867732442426" onmouseenter="enter('5108424867732442426');" onmouseout="out('5108424867732442426');" style="">1867         leftScopeChild.setTableName(joinInfo.getLeftTableName());                                        </span>
<span  style="">1868                                                                                                          </span>
<span class="-2402361542513321069" onmouseenter="enter('-2402361542513321069');" onmouseout="out('-2402361542513321069');" style=""><abbr title="1869         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableName());">1869         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLe🔵</abbr></span>
<span class="5224542232803887157" onmouseenter="enter('5224542232803887157');" onmouseout="out('5224542232803887157');" style=""><abbr title="1870         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColumnNames());">1870         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema(🔵</abbr></span>
<span class="-5303860989220332569" onmouseenter="enter('-5303860989220332569');" onmouseout="out('-5303860989220332569');" style="">1871         leftScopeChild.setRowTypeInfo(leftTypeInfo);                                                     </span>
<span  style="">1872                                                                                                          </span>
<span class="3043795906382715340" onmouseenter="enter('3043795906382715340');" onmouseout="out('3043795906382715340');" style="">1873         JoinScope.ScopeChild rightScopeChild = new JoinScope.ScopeChild();                               </span>
<span class="2585249270397691815" onmouseenter="enter('2585249270397691815');" onmouseout="out('2585249270397691815');" style="">1874         rightScopeChild.setAlias(joinInfo.getRightTableAlias());                                         </span>
<span class="-5072747544386586876" onmouseenter="enter('-5072747544386586876');" onmouseout="out('-5072747544386586876');" style="">1875         rightScopeChild.setTableName(joinInfo.getRightTableName());                                      </span>
<span class="-6382774479188932768" onmouseenter="enter('-6382774479188932768');" onmouseout="out('-6382774479188932768');" style="">1876         AbstractSideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());            </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="">1877         if(sideTableInfo == null){                                                                       </span>
<span class="-5396801098824602905" onmouseenter="enter('-5396801098824602905');" onmouseout="out('-5396801098824602905');" style="">1878             sideTableInfo = sideTableMap.get(joinInfo.getRightTableAlias());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1879         }                                                                                                </span>
<span  style="">1880                                                                                                          </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="">1881         if(sideTableInfo == null){                                                                       </span>
<span class="450947362076537032" onmouseenter="enter('450947362076537032');" onmouseout="out('450947362076537032');" style="">1882             throw new RuntimeException(&quot;can&#x27;t not find side table:&quot; + joinInfo.getRightTableName());     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1883         }                                                                                                </span>
<span  style="">1884                                                                                                          </span>
<span class="6668906180521634363" onmouseenter="enter('6668906180521634363');" onmouseout="out('6668906180521634363');" style="">1885 //        if(!checkJoinCondition(joinInfo.getCondition(), joinInfo.getRightTableAlias(), sideTableInfo)){</span>
<span class="2570085130586631416" onmouseenter="enter('2570085130586631416');" onmouseout="out('2570085130586631416');" style="">1886 //            throw new RuntimeException(&quot;ON condition must contain all equal fields!!!&quot;);               </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style="">1887 //        }                                                                                              </span>
<span  style="">1888                                                                                                          </span>
<span class="-1562873445908102884" onmouseenter="enter('-1562873445908102884');" onmouseout="out('-1562873445908102884');" style="">1889         rightScopeChild.setRowTypeInfo(sideTableInfo.getRowTypeInfo());                                  </span>
<span  style="">1890                                                                                                          </span>
<span class="-5776192160472100987" onmouseenter="enter('-5776192160472100987');" onmouseout="out('-5776192160472100987');" style="">1891         joinScope.addScope(leftScopeChild);                                                              </span>
<span class="6805588345897841594" onmouseenter="enter('6805588345897841594');" onmouseout="out('6805588345897841594');" style="">1892         joinScope.addScope(rightScopeChild);                                                             </span>
<span  style="">1893                                                                                                          </span>
<span class="2226908158928528195" onmouseenter="enter('2226908158928528195');" onmouseout="out('2226908158928528195');" style="">1894         HashBasedTable&lt;String, String, String&gt; mappingTable = ((JoinInfo) pollObj).getTableFieldRef();   </span>
<span  style="">1895                                                                                                          </span>
<span class="-816440763270240777" onmouseenter="enter('-816440763270240777');" onmouseout="out('-816440763270240777');" style="">1896         //获取两个表的所有字段                                                                                     </span>
<span class="-6198283029075022684" onmouseenter="enter('-6198283029075022684');" onmouseout="out('-6198283029075022684');" style=""><abbr title="1897         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, true);">1897         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), join🔵</abbr></span>
<span class="5016458903510526292" onmouseenter="enter('5016458903510526292');" onmouseout="out('5016458903510526292');" style="">1898         //通过join的查询字段信息过滤出需要的字段信息                                                                        </span>
<span class="5211893312708517501" onmouseenter="enter('5211893312708517501');" onmouseout="out('5211893312708517501');" style=""><abbr title="1899         sideJoinFieldInfo.removeIf(tmpFieldInfo -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldInfo.getFieldName()) == null);">1899         sideJoinFieldInfo.removeIf(tmpFieldInfo -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldInfo🔵</abbr></span>
<span  style="">1900                                                                                                          </span>
<span class="-1467815726997680818" onmouseenter="enter('-1467815726997680818');" onmouseout="out('-1467815726997680818');" style="">1901         String leftTableAlias = joinInfo.getLeftTableAlias();                                            </span>
<span class="-6434853421912213287" onmouseenter="enter('-6434853421912213287');" onmouseout="out('-6434853421912213287');" style="">1902         Table targetTable = localTableCache.get(leftTableAlias);                                         </span>
<span class="-6749372432358522016" onmouseenter="enter('-6749372432358522016');" onmouseout="out('-6749372432358522016');" style="">1903         if(targetTable == null){                                                                         </span>
<span class="8734197217231436839" onmouseenter="enter('8734197217231436839');" onmouseout="out('8734197217231436839');" style="">1904             targetTable = localTableCache.get(joinInfo.getLeftTableName());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1905         }                                                                                                </span>
<span  style="">1906                                                                                                          </span>
<span class="3450476289809538439" onmouseenter="enter('3450476289809538439');" onmouseout="out('3450476289809538439');" style=""><abbr title="1907         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColumnNames());">1907         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema(🔵</abbr></span>
<span  style="">1908                                                                                                          </span>
<span class="-3004779098663820792" onmouseenter="enter('-3004779098663820792');" onmouseout="out('-3004779098663820792');" style=""><abbr title="1909         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.class)">1909         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.c🔵</abbr></span>
<span class="3479563451496228205" onmouseenter="enter('3479563451496228205');" onmouseout="out('3479563451496228205');" style="">1910                 .map((Tuple2&lt;Boolean, Row&gt; tp2) -&gt; {                                                     </span>
<span class="7833906289428987345" onmouseenter="enter('7833906289428987345');" onmouseout="out('7833906289428987345');" style="">1911                     return new CRow(tp2.f1, tp2.f0);                                                     </span>
<span class="-8730504840947162971" onmouseenter="enter('-8730504840947162971');" onmouseout="out('-8730504840947162971');" style="">1912                 }).returns(CRow.class);                                                                  </span>
<span  style="">1913                                                                                                          </span>
<span  style="">1914                                                                                                          </span>
<span class="-6082173173678345991" onmouseenter="enter('-6082173173678345991');" onmouseout="out('-6082173173678345991');" style="">1915         //join side table before keyby ===&gt; Reducing the size of each dimension table cache of async     </span>
<span class="6301552848628110191" onmouseenter="enter('6301552848628110191');" onmouseout="out('6301552848628110191');" style="">1916         if (sideTableInfo.isPartitionedJoin()) {                                                         </span>
<span class="-4638861421651181765" onmouseenter="enter('-4638861421651181765');" onmouseout="out('-4638861421651181765');" style=""><abbr title="1917             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(), sideTableInfo);">1917             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTa🔵</abbr></span>
<span class="-1086375650130423707" onmouseenter="enter('-1086375650130423707');" onmouseout="out('-1086375650130423707');" style="">1918             List&lt;String&gt; fieldNames = Arrays.asList(targetTable.getSchema().getFieldNames());            </span>
<span class="2517152886952033206" onmouseenter="enter('2517152886952033206');" onmouseout="out('2517152886952033206');" style="">1919             int[] keyIndex = leftJoinColList.stream().mapToInt(fieldNames::indexOf).toArray();           </span>
<span class="-7482412719932836963" onmouseenter="enter('-7482412719932836963');" onmouseout="out('-7482412719932836963');" style=""><abbr title="1920             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.getSchema())));">1920             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, tar🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1921         }                                                                                                </span>
<span  style="">1922                                                                                                          </span>
<span class="-1065289666164106717" onmouseenter="enter('-1065289666164106717');" onmouseout="out('-1065289666164106717');" style="">1923         DataStream&lt;CRow&gt; dsOut = null;                                                                   </span>
<span class="3901580925108094660" onmouseenter="enter('3901580925108094660');" onmouseout="out('3901580925108094660');" style="">1924         if(ECacheType.ALL.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="7101184136852303035" onmouseenter="enter('7101184136852303035');" onmouseout="out('7101184136852303035');" style=""><abbr title="1925             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1925             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), 🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="">1926         }else{                                                                                           </span>
<span class="7683243294616380271" onmouseenter="enter('7683243294616380271');" onmouseout="out('7683243294616380271');" style=""><abbr title="1927             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1927             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSq🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1928         }                                                                                                </span>
<span  style="">1929                                                                                                          </span>
<span class="2474148199265091642" onmouseenter="enter('2474148199265091642');" onmouseout="out('2474148199265091642');" style="">1930         RowTypeInfo sideOutTypeInfo = buildOutRowTypeInfo(sideJoinFieldInfo, mappingTable);              </span>
<span  style="">1931                                                                                                          </span>
<span class="-1611735526649110750" onmouseenter="enter('-1611735526649110750');" onmouseout="out('-1611735526649110750');" style="">1932         CRowTypeInfo cRowTypeInfo = new CRowTypeInfo(sideOutTypeInfo);                                   </span>
<span class="-4428554219841205830" onmouseenter="enter('-4428554219841205830');" onmouseout="out('-4428554219841205830');" style="">1933         dsOut.getTransformation().setOutputType(cRowTypeInfo);                                           </span>
<span  style="">1934                                                                                                          </span>
<span class="4836712590888983064" onmouseenter="enter('4836712590888983064');" onmouseout="out('4836712590888983064');" style="">1935         String targetTableName = joinInfo.getNewTableName();                                             </span>
<span class="-3094587764130774762" onmouseenter="enter('-3094587764130774762');" onmouseout="out('-3094587764130774762');" style="">1936         String targetTableAlias = joinInfo.getNewTableAlias();                                           </span>
<span  style="">1937                                                                                                          </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style="">1938         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style="">1939         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="8710576405434192583" onmouseenter="enter('8710576405434192583');" onmouseout="out('8710576405434192583');" style="">1940         replaceInfo.setTargetTableName(targetTableName);                                                 </span>
<span class="-6613112199475906839" onmouseenter="enter('-6613112199475906839');" onmouseout="out('-6613112199475906839');" style="">1941         replaceInfo.setTargetTableAlias(targetTableAlias);                                               </span>
<span  style="">1942                                                                                                          </span>
<span class="1268462607712077740" onmouseenter="enter('1268462607712077740');" onmouseout="out('1268462607712077740');" style="">1943         if (!tableEnv.isRegistered(joinInfo.getNewTableName())){                                         </span>
<span class="-9057257427162955657" onmouseenter="enter('-9057257427162955657');" onmouseout="out('-9057257427162955657');" style="">1944             Table joinTable = tableEnv.fromDataStream(dsOut);                                            </span>
<span class="-7674974637599312088" onmouseenter="enter('-7674974637599312088');" onmouseout="out('-7674974637599312088');" style="">1945             tableEnv.registerTable(joinInfo.getNewTableName(), joinTable);                               </span>
<span class="5569875846259576593" onmouseenter="enter('5569875846259576593');" onmouseout="out('5569875846259576593');" style="">1946             localTableCache.put(joinInfo.getNewTableName(), joinTable);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1947         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1948     }                                                                                                    </span>
<span  style="">1949                                                                                                          </span>
<span class="2503560481488678812" onmouseenter="enter('2503560481488678812');" onmouseout="out('2503560481488678812');" style="">1950     private TypeInformation&lt;Row&gt; projectedTypeInfo(int[] fields, TableSchema schema) {                   </span>
<span class="-934325254904626531" onmouseenter="enter('-934325254904626531');" onmouseout="out('-934325254904626531');" style="">1951         String[] fieldNames = schema.getFieldNames();                                                    </span>
<span class="4556717060829301814" onmouseenter="enter('4556717060829301814');" onmouseout="out('4556717060829301814');" style="">1952         TypeInformation&lt;?&gt;[] fieldTypes = schema.getFieldTypes();                                        </span>
<span  style="">1953                                                                                                          </span>
<span class="424178526470659793" onmouseenter="enter('424178526470659793');" onmouseout="out('424178526470659793');" style=""><abbr title="1954         String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::new);">1954         String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::ne🔵</abbr></span>
<span class="5411397013359382914" onmouseenter="enter('5411397013359382914');" onmouseout="out('5411397013359382914');" style=""><abbr title="1955         TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(TypeInformation[]::new);">1955         TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(Typ🔵</abbr></span>
<span class="-5627838059420262860" onmouseenter="enter('-5627838059420262860');" onmouseout="out('-5627838059420262860');" style="">1956         return new RowTypeInfo(projectedTypes, projectedNames);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1957     }                                                                                                    </span>
<span  style="">1958                                                                                                          </span>
<span  style="">1959                                                                                                          </span>
<span class="-410103274617159114" onmouseenter="enter('-410103274617159114');" onmouseout="out('-410103274617159114');" style="">1960     private boolean checkFieldsInfo(CreateTmpTableParser.SqlParserResult result, Table table) {          </span>
<span class="8925867441251499081" onmouseenter="enter('8925867441251499081');" onmouseout="out('8925867441251499081');" style="">1961         List&lt;String&gt; fieldNames = new LinkedList&lt;&gt;();                                                    </span>
<span class="-5553816012496774052" onmouseenter="enter('-5553816012496774052');" onmouseout="out('-5553816012496774052');" style="">1962         String fieldsInfo = result.getFieldsInfoStr();                                                   </span>
<span class="-5855731071361337066" onmouseenter="enter('-5855731071361337066');" onmouseout="out('-5855731071361337066');" style="">1963         String[] fields = StringUtils.split(fieldsInfo, &quot;,&quot;);                                            </span>
<span class="8167763809890058258" onmouseenter="enter('8167763809890058258');" onmouseout="out('8167763809890058258');" style="">1964         for (int i = 0; i &lt; fields.length; i++) {                                                        </span>
<span class="2947314498030065040" onmouseenter="enter('2947314498030065040');" onmouseout="out('2947314498030065040');" style="">1965             String[] filed = fields[i].split(&quot;\\s&quot;);                                                     </span>
<span class="-1166806966413379737" onmouseenter="enter('-1166806966413379737');" onmouseout="out('-1166806966413379737');" style="">1966             if (filed.length &lt; 2 || fields.length != table.getSchema().getColumnNames().length){         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1967                 return false;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1968             } else {                                                                                     </span>
<span class="-7518627407039835792" onmouseenter="enter('-7518627407039835792');" onmouseout="out('-7518627407039835792');" style="">1969                 String[] filedNameArr = new String[filed.length - 1];                                    </span>
<span class="6064994574122217386" onmouseenter="enter('6064994574122217386');" onmouseout="out('6064994574122217386');" style="">1970                 System.arraycopy(filed, 0, filedNameArr, 0, filed.length - 1);                           </span>
<span class="-3029457015937137256" onmouseenter="enter('-3029457015937137256');" onmouseout="out('-3029457015937137256');" style="">1971                 String fieldName = String.join(&quot; &quot;, filedNameArr);                                       </span>
<span class="-8037943253867791720" onmouseenter="enter('-8037943253867791720');" onmouseout="out('-8037943253867791720');" style="">1972                 fieldNames.add(fieldName);                                                               </span>
<span class="516386479555957316" onmouseenter="enter('516386479555957316');" onmouseout="out('516386479555957316');" style="">1973                 String fieldType = filed[filed.length - 1 ].trim();                                      </span>
<span class="-8511761590344571010" onmouseenter="enter('-8511761590344571010');" onmouseout="out('-8511761590344571010');" style="">1974                 Class fieldClass = ClassUtil.stringConvertClass(fieldType);                              </span>
<span class="-351203522969775469" onmouseenter="enter('-351203522969775469');" onmouseout="out('-351203522969775469');" style="">1975                 Class tableField = table.getSchema().getFieldType(i).get().getTypeClass();               </span>
<span class="9126336856345087988" onmouseenter="enter('9126336856345087988');" onmouseout="out('9126336856345087988');" style="">1976                 if (fieldClass == tableField){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1977                     continue;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1978                 } else {                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1979                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1980                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1981             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1982         }                                                                                                </span>
<span class="-7181802501759976675" onmouseenter="enter('-7181802501759976675');" onmouseout="out('-7181802501759976675');" style="">1983         tmpFields = String.join(&quot;,&quot;, fieldNames);                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">1984         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1985     }                                                                                                    </span>
<span  style="">1986                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1987 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  23 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  24 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  25 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="">  26 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="">  27 import org.apache.flink.table.api.StreamQueryConfig;                                                     </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  28 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-8888728238394280005" onmouseenter="enter('-8888728238394280005');" onmouseout="out('-8888728238394280005');" style="">  29 import org.apache.flink.table.api.TableSchema;                                                           </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="">  30 import org.apache.flink.table.api.java.StreamTableEnvironment;                                           </span>
<span class="-6266446094177003082" onmouseenter="enter('-6266446094177003082');" onmouseout="out('-6266446094177003082');" style="">  31 import org.apache.flink.table.runtime.CRowKeySelector;                                                   </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  32 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="5605277811729025111" onmouseenter="enter('5605277811729025111');" onmouseout="out('5605277811729025111');" style="">  33 import org.apache.flink.table.runtime.types.CRowTypeInfo;                                                </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  34 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  35 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  36                                                                                                          </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  37 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="">  38 import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                          </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="">  39 import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                </span>
<span class="7697893187981436175" onmouseenter="enter('7697893187981436175');" onmouseout="out('7697893187981436175');" style="">  40 import com.dtstack.flink.sql.side.operator.SideAsyncOperator;                                            </span>
<span class="-7456990469468101750" onmouseenter="enter('-7456990469468101750');" onmouseout="out('-7456990469468101750');" style="">  41 import com.dtstack.flink.sql.side.operator.SideWithAllCacheOperator;                                     </span>
<span class="4874498590411064411" onmouseenter="enter('4874498590411064411');" onmouseout="out('4874498590411064411');" style="">  42 import com.dtstack.flink.sql.util.ClassUtil;                                                             </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  43 import com.dtstack.flink.sql.util.ParseUtils;                                                            </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  44 import com.dtstack.flink.sql.util.TableUtils;                                                            </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  45 import com.google.common.base.Preconditions;                                                             </span>
<span class="1793459060364841943" onmouseenter="enter('1793459060364841943');" onmouseout="out('1793459060364841943');" style="">  46 import com.google.common.collect.*;                                                                      </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  47 import org.apache.calcite.sql.SqlAsOperator;                                                             </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  48 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  49 import org.apache.calcite.sql.SqlDataTypeSpec;                                                           </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  50 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  51 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  52 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  53 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  54 import org.apache.calcite.sql.SqlLiteral;                                                                </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  55 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  56 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  57 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  58 import org.apache.calcite.sql.SqlOrderBy;                                                                </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  59 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  60 import org.apache.calcite.sql.SqlWithItem;                                                               </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  61 import org.apache.calcite.sql.fun.SqlCase;                                                               </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  62 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  63 import org.apache.calcite.sql.parser.SqlParserPos;                                                       </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  64 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  65 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  66 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  67 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  68                                                                                                          </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  69 import java.sql.Timestamp;                                                                               </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  70 import java.util.Arrays;                                                                                 </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  71 import java.util.Collection;                                                                             </span>
<span class="2644117295780670879" onmouseenter="enter('2644117295780670879');" onmouseout="out('2644117295780670879');" style="">  72 import java.util.LinkedList;                                                                             </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  73 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  74 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  75 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  76 import java.util.Set;                                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  78 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span  style="">  79                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  80 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  81  * Reason:                                                                                               </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  82  * Date: 2018/7/24                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  83  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  84  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  85  */                                                                                                      </span>
<span  style="">  86                                                                                                          </span>
<span class="-5079038956292767116" onmouseenter="enter('-5079038956292767116');" onmouseout="out('-5079038956292767116');" style="">  87 public class SideSqlExec {                                                                               </span>
<span  style="">  88                                                                                                          </span>
<span class="-8991898280301588076" onmouseenter="enter('-8991898280301588076');" onmouseout="out('-8991898280301588076');" style="">  89     private static final Logger LOG = LoggerFactory.getLogger(SideSqlExec.class);                        </span>
<span  style="">  90                                                                                                          </span>
<span class="-6334022460956670337" onmouseenter="enter('-6334022460956670337');" onmouseout="out('-6334022460956670337');" style="">  91     private String localSqlPluginPath = null;                                                            </span>
<span  style="">  92                                                                                                          </span>
<span class="-863593709646632598" onmouseenter="enter('-863593709646632598');" onmouseout="out('-863593709646632598');" style="">  93     private String tmpFields = null;                                                                     </span>
<span  style="">  94                                                                                                          </span>
<span class="8878309237265342483" onmouseenter="enter('8878309237265342483');" onmouseout="out('8878309237265342483');" style="">  95     private SidePredicatesParser sidePredicatesParser = new SidePredicatesParser();                      </span>
<span  style="">  96                                                                                                          </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  97     private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                      </span>
<span  style="">  98                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  99 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="5235405798143461797" onmouseenter="enter('5235405798143461797');" onmouseout="out('5235405798143461797');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 100 public void exec(String sql,                                                                             </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 101                      Map&lt;String, SideTableInfo&gt; sideTableMap,                                            </span>
<span class="4244108408582304218" onmouseenter="enter('4244108408582304218');" onmouseout="out('4244108408582304218');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 102                      StreamTableEnvironment tableEnv,                                                    </span>
<span class="-1493383746124052329" onmouseenter="enter('-1493383746124052329');" onmouseout="out('-1493383746124052329');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 103                      Map&lt;String, Table&gt; tableCache,                                                      </span>
<span class="-6398864087192215060" onmouseenter="enter('-6398864087192215060');" onmouseout="out('-6398864087192215060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 104                      StreamQueryConfig queryConfig,                                                      </span>
<span class="3861087795237990091" onmouseenter="enter('3861087795237990091');" onmouseout="out('3861087795237990091');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 105                      CreateTmpTableParser.SqlParserResult createView) throws Exception {                 </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 106 ||||||| BASE                                                                                             </span>
<span class="-1078000254446854726" onmouseenter="enter('-1078000254446854726');" onmouseout="out('-1078000254446854726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107 public void exec(String sql, Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,   </span>
<span class="1000260034925957386" onmouseenter="enter('1000260034925957386');" onmouseout="out('1000260034925957386');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 108                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserResult createView) throws Exception {"> 108                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.S🔵</abbr></span>
<span class="-7184346740499807144" onmouseenter="enter('-7184346740499807144');" onmouseout="out('-7184346740499807144');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109         if(localSqlPluginPath == null){                                                                  </span>
<span class="4243357528698157424" onmouseenter="enter('4243357528698157424');" onmouseout="out('4243357528698157424');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110             throw new RuntimeException(&quot;need to set localSqlPluginPath&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 113 =======                                                                                                  </span>
<span class="-2568962717532337416" onmouseenter="enter('-2568962717532337416');" onmouseout="out('-2568962717532337416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 114 public void exec(String sql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,"> 114 public void exec(String sql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tabl🔵</abbr></span>
<span class="1000260034925957386" onmouseenter="enter('1000260034925957386');" onmouseout="out('1000260034925957386');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 115                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserResult createView) throws Exception {"> 115                      Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.S🔵</abbr></span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 116 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-7184346740499807144" onmouseenter="enter('-7184346740499807144');" onmouseout="out('-7184346740499807144');" style=""> 117         if(localSqlPluginPath == null){                                                                  </span>
<span class="4243357528698157424" onmouseenter="enter('4243357528698157424');" onmouseout="out('4243357528698157424');" style=""> 118             throw new RuntimeException(&quot;need to set localSqlPluginPath&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119         }                                                                                                </span>
<span  style=""> 120                                                                                                          </span>
<span class="-6307578536739293325" onmouseenter="enter('-6307578536739293325');" onmouseout="out('-6307578536739293325');" style=""> 121         localTableCache.putAll(tableCache);                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 122         try {                                                                                            </span>
<span class="-7778408363768085476" onmouseenter="enter('-7778408363768085476');" onmouseout="out('-7778408363768085476');" style=""> 123             sidePredicatesParser.fillPredicatesForSideTable(sql, sideTableMap);                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 124         } catch (Exception e) {                                                                          </span>
<span class="-6535415982741029210" onmouseenter="enter('-6535415982741029210');" onmouseout="out('-6535415982741029210');" style=""> 125             LOG.error(&quot;fill predicates for sideTable fail &quot;, e);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span  style=""> 127                                                                                                          </span>
<span class="5869130575145188486" onmouseenter="enter('5869130575145188486');" onmouseout="out('5869130575145188486');" style=""> 128         if(createView != null){                                                                          </span>
<span class="-5051922790285322929" onmouseenter="enter('-5051922790285322929');" onmouseout="out('-5051922790285322929');" style=""> 129             LOG.warn(&quot;create view info\n&quot;);                                                              </span>
<span class="4994977519661454238" onmouseenter="enter('4994977519661454238');" onmouseout="out('4994977519661454238');" style=""> 130             LOG.warn(createView.getExecSql());                                                           </span>
<span class="-6048507734051622776" onmouseenter="enter('-6048507734051622776');" onmouseout="out('-6048507734051622776');" style=""> 131             LOG.warn(&quot;-----------------&quot;);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132         }                                                                                                </span>
<span  style=""> 133                                                                                                          </span>
<span class="3272289589011229925" onmouseenter="enter('3272289589011229925');" onmouseout="out('3272289589011229925');" style=""> 134         SideSQLParser sideSQLParser = new SideSQLParser();                                               </span>
<span class="9221221341975786732" onmouseenter="enter('9221221341975786732');" onmouseout="out('9221221341975786732');" style=""> 135         sideSQLParser.setLocalTableCache(localTableCache);                                               </span>
<span class="-1577132173025596093" onmouseenter="enter('-1577132173025596093');" onmouseout="out('-1577132173025596093');" style=""> 136         Queue&lt;Object&gt; exeQueue = sideSQLParser.getExeQueue(sql, sideTableMap.keySet());                  </span>
<span class="1917635497637273504" onmouseenter="enter('1917635497637273504');" onmouseout="out('1917635497637273504');" style=""> 137         Object pollObj = null;                                                                           </span>
<span  style=""> 138                                                                                                          </span>
<span class="6128441282435403378" onmouseenter="enter('6128441282435403378');" onmouseout="out('6128441282435403378');" style=""> 139         while((pollObj = exeQueue.poll()) != null){                                                      </span>
<span  style=""> 140                                                                                                          </span>
<span class="138624831707193108" onmouseenter="enter('138624831707193108');" onmouseout="out('138624831707193108');" style=""> 141             if(pollObj instanceof SqlNode){                                                              </span>
<span class="-8817010307772649906" onmouseenter="enter('-8817010307772649906');" onmouseout="out('-8817010307772649906');" style=""> 142                 SqlNode pollSqlNode = (SqlNode) pollObj;                                                 </span>
<span  style=""> 143                                                                                                          </span>
<span  style=""> 144                                                                                                          </span>
<span class="-2885719311179922220" onmouseenter="enter('-2885719311179922220');" onmouseout="out('-2885719311179922220');" style=""> 145                 if(pollSqlNode.getKind() == INSERT){                                                     </span>
<span class="-7041171683301857607" onmouseenter="enter('-7041171683301857607');" onmouseout="out('-7041171683301857607');" style=""> 146                     FlinkSQLExec.sqlUpdate(tableEnv, pollSqlNode.toString(), queryConfig);               </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style=""> 147                     if(LOG.isInfoEnabled()){                                                             </span>
<span class="-5986232783970891998" onmouseenter="enter('-5986232783970891998');" onmouseout="out('-5986232783970891998');" style=""> 148                         LOG.info(&quot;----------real exec sql-----------\n{}&quot;, pollSqlNode.toString());      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149                     }                                                                                    </span>
<span  style=""> 150                                                                                                          </span>
<span class="4666687505712980858" onmouseenter="enter('4666687505712980858');" onmouseout="out('4666687505712980858');" style=""> 151                 }else if(pollSqlNode.getKind() == AS){                                                   </span>
<span class="3037765200739894050" onmouseenter="enter('3037765200739894050');" onmouseout="out('3037765200739894050');" style=""> 152                     dealAsSourceTable(tableEnv, pollSqlNode, tableCache);                                </span>
<span  style=""> 153                                                                                                          </span>
<span class="4581342471671871622" onmouseenter="enter('4581342471671871622');" onmouseout="out('4581342471671871622');" style=""> 154                 } else if (pollSqlNode.getKind() == WITH_ITEM) {                                         </span>
<span class="9089825500288046356" onmouseenter="enter('9089825500288046356');" onmouseout="out('9089825500288046356');" style=""> 155                     SqlWithItem sqlWithItem = (SqlWithItem) pollSqlNode;                                 </span>
<span class="-7674640876687845363" onmouseenter="enter('-7674640876687845363');" onmouseout="out('-7674640876687845363');" style=""> 156                     String TableAlias = sqlWithItem.name.toString();                                     </span>
<span class="2573668668184904794" onmouseenter="enter('2573668668184904794');" onmouseout="out('2573668668184904794');" style=""> 157                     Table table = tableEnv.sqlQuery(sqlWithItem.query.toString());                       </span>
<span class="2341577843786962651" onmouseenter="enter('2341577843786962651');" onmouseout="out('2341577843786962651');" style=""> 158                     tableEnv.registerTable(TableAlias, table);                                           </span>
<span  style=""> 159                                                                                                          </span>
<span class="-8892059869421071039" onmouseenter="enter('-8892059869421071039');" onmouseout="out('-8892059869421071039');" style=""> 160                 } else if (pollSqlNode.getKind() == SELECT){                                             </span>
<span class="-1344441018307209750" onmouseenter="enter('-1344441018307209750');" onmouseout="out('-1344441018307209750');" style=""><abbr title=" 161                     Preconditions.checkState(createView != null, &quot;select sql must included by create view&quot;);"> 161                     Preconditions.checkState(createView != null, &quot;select sql must included by create view🔵</abbr></span>
<span class="1694293925390283740" onmouseenter="enter('1694293925390283740');" onmouseout="out('1694293925390283740');" style=""> 162                     Table table = tableEnv.sqlQuery(pollObj.toString());                                 </span>
<span  style=""> 163                                                                                                          </span>
<span class="-5832165917407529739" onmouseenter="enter('-5832165917407529739');" onmouseout="out('-5832165917407529739');" style=""> 164                     if (createView.getFieldsInfoStr() == null){                                          </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 165                         tableEnv.registerTable(createView.getTableName(), table);                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 166                     } else {                                                                             </span>
<span class="5288384657559945705" onmouseenter="enter('5288384657559945705');" onmouseout="out('5288384657559945705');" style=""> 167                         if (checkFieldsInfo(createView, table)){                                         </span>
<span class="-9109211084540213069" onmouseenter="enter('-9109211084540213069');" onmouseout="out('-9109211084540213069');" style=""> 168                             table = table.as(tmpFields);                                                 </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 169                             tableEnv.registerTable(createView.getTableName(), table);                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 170                         } else {                                                                         </span>
<span class="-4180003952862210397" onmouseenter="enter('-4180003952862210397');" onmouseout="out('-4180003952862210397');" style=""> 171                             throw new RuntimeException(&quot;Fields mismatch&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173                     }                                                                                    </span>
<span  style=""> 174                                                                                                          </span>
<span class="-5831701022468144749" onmouseenter="enter('-5831701022468144749');" onmouseout="out('-5831701022468144749');" style=""> 175                     localTableCache.put(createView.getTableName(), table);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176                 }                                                                                        </span>
<span  style=""> 177                                                                                                          </span>
<span class="2267959141426380188" onmouseenter="enter('2267959141426380188');" onmouseout="out('2267959141426380188');" style=""> 178             }else if (pollObj instanceof JoinInfo){                                                      </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 179 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-6732469083744011720" onmouseenter="enter('-6732469083744011720');" onmouseout="out('-6732469083744011720');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 180                 System.out.println(&quot;----------exec join info----------&quot;);                                </span>
<span class="6437130050258637649" onmouseenter="enter('6437130050258637649');" onmouseout="out('6437130050258637649');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 181                 System.out.println(pollObj.toString());                                                  </span>
<span class="-3518617829078174884" onmouseenter="enter('-3518617829078174884');" onmouseout="out('-3518617829078174884');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 182                 joinFun(pollObj, localTableCache, sideTableMap, tableEnv);                               </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 183 ||||||| BASE                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184                         } else {                                                                         </span>
<span class="-4180003952862210397" onmouseenter="enter('-4180003952862210397');" onmouseout="out('-4180003952862210397');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185                             throw new RuntimeException(&quot;Fields mismatch&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187                     }                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188                                                                                                          </span>
<span class="-5831701022468144749" onmouseenter="enter('-5831701022468144749');" onmouseout="out('-5831701022468144749');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                     localTableCache.put(createView.getTableName(), table);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                                                                                                          </span>
<span class="2267959141426380188" onmouseenter="enter('2267959141426380188');" onmouseout="out('2267959141426380188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192             }else if (pollObj instanceof JoinInfo){                                                      </span>
<span class="-6732469083744011720" onmouseenter="enter('-6732469083744011720');" onmouseout="out('-6732469083744011720');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                 System.out.println(&quot;----------exec join info----------&quot;);                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 194 =======                                                                                                  </span>
<span class="-6196622619540139248" onmouseenter="enter('-6196622619540139248');" onmouseout="out('-6196622619540139248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 195                 LOG.info(&quot;----------exec join info----------\n{}&quot;, pollObj.toString());                  </span>
<span class="-4508108017455823844" onmouseenter="enter('-4508108017455823844');" onmouseout="out('-4508108017455823844');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 196                 preIsSideJoin = true;                                                                    </span>
<span class="-9158044292308775618" onmouseenter="enter('-9158044292308775618');" onmouseout="out('-9158044292308775618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 197                 joinFun(pollObj, localTableCache, sideTableMap, tableEnv, replaceInfoList);              </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 198 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200         }                                                                                                </span>
<span  style=""> 201                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202     }                                                                                                    </span>
<span  style=""> 203                                                                                                          </span>
<span  style=""> 204                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 205     /**                                                                                                  </span>
<span class="-7226459799151937672" onmouseenter="enter('-7226459799151937672');" onmouseout="out('-7226459799151937672');" style=""> 206      * 解析出as查询的表和字段的关系                                                                                   </span>
<span class="-4711911052088894915" onmouseenter="enter('-4711911052088894915');" onmouseout="out('-4711911052088894915');" style=""> 207      * @param asSqlNode                                                                                  </span>
<span class="-8172984871762282794" onmouseenter="enter('-8172984871762282794');" onmouseout="out('-8172984871762282794');" style=""> 208      * @param tableCache                                                                                 </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 209      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 210      */                                                                                                  </span>
<span class="-8315666616430025383" onmouseenter="enter('-8315666616430025383');" onmouseout="out('-8315666616430025383');" style=""> 211     private FieldReplaceInfo parseAsQuery(SqlBasicCall asSqlNode, Map&lt;String, Table&gt; tableCache){        </span>
<span class="-4950849472737015743" onmouseenter="enter('-4950849472737015743');" onmouseout="out('-4950849472737015743');" style=""> 212         SqlNode info = asSqlNode.getOperands()[0];                                                       </span>
<span class="-6049998703041327008" onmouseenter="enter('-6049998703041327008');" onmouseout="out('-6049998703041327008');" style=""> 213         SqlNode alias = asSqlNode.getOperands()[1];                                                      </span>
<span  style=""> 214                                                                                                          </span>
<span class="6169254144825097648" onmouseenter="enter('6169254144825097648');" onmouseout="out('6169254144825097648');" style=""> 215         SqlKind infoKind = info.getKind();                                                               </span>
<span class="-8998816044463313680" onmouseenter="enter('-8998816044463313680');" onmouseout="out('-8998816044463313680');" style=""> 216         if(infoKind != SELECT){                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 217             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218         }                                                                                                </span>
<span  style=""> 219                                                                                                          </span>
<span class="1448651332248375248" onmouseenter="enter('1448651332248375248');" onmouseout="out('1448651332248375248');" style=""> 220         List&lt;FieldInfo&gt; extractFieldList = TableUtils.parserSelectField((SqlSelect) info, tableCache);   </span>
<span  style=""> 221                                                                                                          </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style=""> 222         HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                   </span>
<span class="-5476396715494077219" onmouseenter="enter('-5476396715494077219');" onmouseout="out('-5476396715494077219');" style=""> 223         for (FieldInfo fieldInfo : extractFieldList) {                                                   </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 224             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 225             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style=""> 226             String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);        </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style=""> 227             mappingTable.put(tableName, fieldName, mappingFieldName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228         }                                                                                                </span>
<span  style=""> 229                                                                                                          </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 230         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 231         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="9115675088981905484" onmouseenter="enter('9115675088981905484');" onmouseout="out('9115675088981905484');" style=""> 232         replaceInfo.setTargetTableName(alias.toString());                                                </span>
<span class="-6295883374697236710" onmouseenter="enter('-6295883374697236710');" onmouseout="out('-6295883374697236710');" style=""> 233         replaceInfo.setTargetTableAlias(alias.toString());                                               </span>
<span class="2754859294214862032" onmouseenter="enter('2754859294214862032');" onmouseout="out('2754859294214862032');" style=""> 234         return replaceInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 236 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 237 ||||||| BASE                                                                                             </span>
<span class="-3955444104111901697" onmouseenter="enter('-3955444104111901697');" onmouseout="out('-3955444104111901697');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 238 private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 238 private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, Str🔵</abbr></span>
<span class="-663927235385144722" onmouseenter="enter('-663927235385144722');" onmouseout="out('-663927235385144722');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239         SqlKind sqlKind = pollSqlNode.getKind();                                                         </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241             case INSERT:                                                                                 </span>
<span class="-3657774864843651643" onmouseenter="enter('-3657774864843651643');" onmouseout="out('-3657774864843651643');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242                 SqlNode source = ((SqlInsert) pollSqlNode).getSource();                                  </span>
<span class="6134982029327154291" onmouseenter="enter('6134982029327154291');" onmouseout="out('6134982029327154291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                 addAliasForFieldNode(source, fieldList, mappingTable);                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245             case AS:                                                                                     </span>
<span class="-6853425371672212621" onmouseenter="enter('-6853425371672212621');" onmouseout="out('-6853425371672212621');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 246                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTable);"> 246                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTab🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248             case SELECT:                                                                                 </span>
<span class="-345466278028982068" onmouseenter="enter('-345466278028982068');" onmouseout="out('-345466278028982068');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249                 SqlNodeList selectList = ((SqlSelect) pollSqlNode).getSelectList();                      </span>
<span class="-4478316650227403681" onmouseenter="enter('-4478316650227403681');" onmouseout="out('-4478316650227403681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                 selectList.getList().forEach(node -&gt; {                                                   </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                         }                                                                                </span>
<span class="-4986679521926317286" onmouseenter="enter('-4986679521926317286');" onmouseout="out('-4986679521926317286');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                         // save real field                                                               </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                         String fieldName = sqlIdentifier.names.get(1);                                   </span>
<span class="-5921041769209732806" onmouseenter="enter('-5921041769209732806');" onmouseout="out('-5921041769209732806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 258                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().containsKey(fieldName)) {"> 258                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap🔵</abbr></span>
<span class="-2287024865944183458" onmouseenter="enter('-2287024865944183458');" onmouseout="out('-2287024865944183458');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259                             fieldList.add(fieldName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263                 });                                                                                      </span>
<span class="-8923237898045704845" onmouseenter="enter('-8923237898045704845');" onmouseout="out('-8923237898045704845');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                 for (int i = 0; i &lt; selectList.getList().size(); i++) {                                  </span>
<span class="-4321294484021988020" onmouseenter="enter('-4321294484021988020');" onmouseout="out('-4321294484021988020');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                     SqlNode node = selectList.get(i);                                                    </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270                         }                                                                                </span>
<span class="-170655463018543442" onmouseenter="enter('-170655463018543442');" onmouseout="out('-170655463018543442');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271                         String name = sqlIdentifier.names.get(1);                                        </span>
<span class="-3204699988614579440" onmouseenter="enter('-3204699988614579440');" onmouseout="out('-3204699988614579440');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272                         // avoid real field pv0 convert pv                                               </span>
<span class="6166166284113505247" onmouseenter="enter('6166166284113505247');" onmouseout="out('6166166284113505247');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 273                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring(0, name.length() - 1))) {"> 273                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274                             SqlOperator operator = new SqlAsOperator();                                  </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275                             SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276                                                                                                          </span>
<span class="-2138283127011244558" onmouseenter="enter('-2138283127011244558');" onmouseout="out('-2138283127011244558');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 277                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() - 1), null, sqlParserPos);"> 277                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.l🔵</abbr></span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                             SqlNode[] sqlNodes = new SqlNode[2];                                         </span>
<span class="-2939555014928254235" onmouseenter="enter('-2939555014928254235');" onmouseout="out('-2939555014928254235');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                             sqlNodes[0] = sqlIdentifier;                                                 </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280                             sqlNodes[1] = sqlIdentifierAlias;                                            </span>
<span class="172920197577317623" onmouseenter="enter('172920197577317623');" onmouseout="out('172920197577317623');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 281                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos);"> 281                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                                                                                                          </span>
<span class="-6513758114426947797" onmouseenter="enter('-6513758114426947797');" onmouseout="out('-6513758114426947797');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283                             selectList.set(i, sqlBasicCall);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 290 =======                                                                                                  </span>
<span class="-3955444104111901697" onmouseenter="enter('-3955444104111901697');" onmouseout="out('-3955444104111901697');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 291 private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 291 private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, Str🔵</abbr></span>
<span class="-663927235385144722" onmouseenter="enter('-663927235385144722');" onmouseout="out('-663927235385144722');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292         SqlKind sqlKind = pollSqlNode.getKind();                                                         </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 294             case INSERT:                                                                                 </span>
<span class="-3657774864843651643" onmouseenter="enter('-3657774864843651643');" onmouseout="out('-3657774864843651643');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295                 SqlNode source = ((SqlInsert) pollSqlNode).getSource();                                  </span>
<span class="6134982029327154291" onmouseenter="enter('6134982029327154291');" onmouseout="out('6134982029327154291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296                 addAliasForFieldNode(source, fieldList, mappingTable);                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298             case AS:                                                                                     </span>
<span class="-6853425371672212621" onmouseenter="enter('-6853425371672212621');" onmouseout="out('-6853425371672212621');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 299                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTable);"> 299                 addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTab🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 300                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 301             case SELECT:                                                                                 </span>
<span class="-345466278028982068" onmouseenter="enter('-345466278028982068');" onmouseout="out('-345466278028982068');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302                 SqlNodeList selectList = ((SqlSelect) pollSqlNode).getSelectList();                      </span>
<span class="-4478316650227403681" onmouseenter="enter('-4478316650227403681');" onmouseout="out('-4478316650227403681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303                 selectList.getList().forEach(node -&gt; {                                                   </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 308                         }                                                                                </span>
<span class="-4986679521926317286" onmouseenter="enter('-4986679521926317286');" onmouseout="out('-4986679521926317286');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 309                         // save real field                                                               </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 310                         String fieldName = sqlIdentifier.names.get(1);                                   </span>
<span class="-5921041769209732806" onmouseenter="enter('-5921041769209732806');" onmouseout="out('-5921041769209732806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 311                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().containsKey(fieldName)) {"> 311                         if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap🔵</abbr></span>
<span class="-2287024865944183458" onmouseenter="enter('-2287024865944183458');" onmouseout="out('-2287024865944183458');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312                             fieldList.add(fieldName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 313                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 314                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 316                 });                                                                                      </span>
<span class="-8923237898045704845" onmouseenter="enter('-8923237898045704845');" onmouseout="out('-8923237898045704845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 317                 for (int i = 0; i &lt; selectList.getList().size(); i++) {                                  </span>
<span class="-4321294484021988020" onmouseenter="enter('-4321294484021988020');" onmouseout="out('-4321294484021988020');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318                     SqlNode node = selectList.get(i);                                                    </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319                     if (node.getKind() == IDENTIFIER) {                                                  </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320                         SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321                         if (sqlIdentifier.names.size() == 1) {                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323                         }                                                                                </span>
<span class="-170655463018543442" onmouseenter="enter('-170655463018543442');" onmouseout="out('-170655463018543442');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 324                         String name = sqlIdentifier.names.get(1);                                        </span>
<span class="-3204699988614579440" onmouseenter="enter('-3204699988614579440');" onmouseout="out('-3204699988614579440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 325                         // avoid real field pv0 convert pv                                               </span>
<span class="6166166284113505247" onmouseenter="enter('6166166284113505247');" onmouseout="out('6166166284113505247');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 326                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring(0, name.length() - 1))) {"> 326                         if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 327                             SqlOperator operator = new SqlAsOperator();                                  </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 328                             SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 329                                                                                                          </span>
<span class="-2138283127011244558" onmouseenter="enter('-2138283127011244558');" onmouseout="out('-2138283127011244558');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 330                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() - 1), null, sqlParserPos);"> 330                             SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.l🔵</abbr></span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331                             SqlNode[] sqlNodes = new SqlNode[2];                                         </span>
<span class="-2939555014928254235" onmouseenter="enter('-2939555014928254235');" onmouseout="out('-2939555014928254235');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 332                             sqlNodes[0] = sqlIdentifier;                                                 </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333                             sqlNodes[1] = sqlIdentifierAlias;                                            </span>
<span class="172920197577317623" onmouseenter="enter('172920197577317623');" onmouseout="out('172920197577317623');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 334                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos);"> 334                             SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 335                                                                                                          </span>
<span class="-6513758114426947797" onmouseenter="enter('-6513758114426947797');" onmouseout="out('-6513758114426947797');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336                             selectList.set(i, sqlBasicCall);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 337                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 338                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 339                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 340                 break;                                                                                   </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 341             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 342                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 343         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 344     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 345 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 346                                                                                                          </span>
<span  style=""> 347                                                                                                          </span>
<span  style=""> 348                                                                                                          </span>
<span class="3897594848566528823" onmouseenter="enter('3897594848566528823');" onmouseout="out('3897594848566528823');" style=""> 349     public AliasInfo parseAsNode(SqlNode sqlNode) throws SqlParseException {                             </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 350         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="3363188275491767702" onmouseenter="enter('3363188275491767702');" onmouseout="out('3363188275491767702');" style=""> 351         if(sqlKind != AS){                                                                               </span>
<span class="1088430228081547460" onmouseenter="enter('1088430228081547460');" onmouseout="out('1088430228081547460');" style=""> 352             throw new RuntimeException(sqlNode + &quot; is not &#x27;as&#x27; operator&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353         }                                                                                                </span>
<span  style=""> 354                                                                                                          </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 355         SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                         </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 356         SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                       </span>
<span  style=""> 357                                                                                                          </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 358         AliasInfo aliasInfo = new AliasInfo();                                                           </span>
<span class="-5109084571101185803" onmouseenter="enter('-5109084571101185803');" onmouseout="out('-5109084571101185803');" style=""> 359         aliasInfo.setName(info.toString());                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 360         aliasInfo.setAlias(alias.toString());                                                            </span>
<span  style=""> 361                                                                                                          </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 362         return aliasInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363     }                                                                                                    </span>
<span  style=""> 364                                                                                                          </span>
<span class="4707165697759746048" onmouseenter="enter('4707165697759746048');" onmouseout="out('4707165697759746048');" style=""> 365     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo,                            </span>
<span class="244517366126553103" onmouseenter="enter('244517366126553103');" onmouseout="out('244517366126553103');" style=""> 366                                            HashBasedTable&lt;String, String, String&gt; mappingTable) {        </span>
<span class="-3566414926414695948" onmouseenter="enter('-3566414926414695948');" onmouseout="out('-3566414926414695948');" style=""> 367         TypeInformation[] sideOutTypes = new TypeInformation[sideJoinFieldInfo.size()];                  </span>
<span class="-637166731779412769" onmouseenter="enter('-637166731779412769');" onmouseout="out('-637166731779412769');" style=""> 368         String[] sideOutNames = new String[sideJoinFieldInfo.size()];                                    </span>
<span class="7438730024850909889" onmouseenter="enter('7438730024850909889');" onmouseout="out('7438730024850909889');" style=""> 369         for (int i = 0; i &lt; sideJoinFieldInfo.size(); i++) {                                             </span>
<span class="2207877773063469724" onmouseenter="enter('2207877773063469724');" onmouseout="out('2207877773063469724');" style=""> 370             FieldInfo fieldInfo = sideJoinFieldInfo.get(i);                                              </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 371             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 372             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span  style=""> 373                                                                                                          </span>
<span class="3640983111807923268" onmouseenter="enter('3640983111807923268');" onmouseout="out('3640983111807923268');" style=""> 374             String mappingFieldName = mappingTable.get(tableName, fieldName);                            </span>
<span class="-4165873345254348507" onmouseenter="enter('-4165873345254348507');" onmouseout="out('-4165873345254348507');" style=""><abbr title=" 375             Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be frame bug&quot;);"> 375             Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be f🔵</abbr></span>
<span  style=""> 376                                                                                                          </span>
<span class="4913645198555706594" onmouseenter="enter('4913645198555706594');" onmouseout="out('4913645198555706594');" style=""> 377             sideOutTypes[i] = fieldInfo.getTypeInformation();                                            </span>
<span class="6276485717663783154" onmouseenter="enter('6276485717663783154');" onmouseout="out('6276485717663783154');" style=""> 378             sideOutNames[i] = mappingFieldName;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379         }                                                                                                </span>
<span class="2691939759498133513" onmouseenter="enter('2691939759498133513');" onmouseout="out('2691939759498133513');" style=""> 380         return new RowTypeInfo(sideOutTypes, sideOutNames);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381     }                                                                                                    </span>
<span  style=""> 382                                                                                                          </span>
<span  style=""> 383                                                                                                          </span>
<span  style=""> 384                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 385     /**                                                                                                  </span>
<span class="4027944609056411189" onmouseenter="enter('4027944609056411189');" onmouseout="out('4027944609056411189');" style=""> 386      *  对时间类型进行类型转换                                                                                      </span>
<span class="-7981851073621455488" onmouseenter="enter('-7981851073621455488');" onmouseout="out('-7981851073621455488');" style=""> 387      * @param leftTypeInfo                                                                               </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 388      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 389      */                                                                                                  </span>
<span class="109255438874014135" onmouseenter="enter('109255438874014135');" onmouseout="out('109255438874014135');" style=""> 390     private RowTypeInfo buildLeftTableOutType(RowTypeInfo leftTypeInfo) {                                </span>
<span class="5269317691380571116" onmouseenter="enter('5269317691380571116');" onmouseout="out('5269317691380571116');" style=""> 391         TypeInformation[] sideOutTypes = new TypeInformation[leftTypeInfo.getFieldNames().length];       </span>
<span class="357447233987634249" onmouseenter="enter('357447233987634249');" onmouseout="out('357447233987634249');" style=""> 392         TypeInformation&lt;?&gt;[] fieldTypes = leftTypeInfo.getFieldTypes();                                  </span>
<span class="-7313385440196867180" onmouseenter="enter('-7313385440196867180');" onmouseout="out('-7313385440196867180');" style=""> 393         for (int i = 0; i &lt; sideOutTypes.length; i++) {                                                  </span>
<span class="-314833607359598646" onmouseenter="enter('-314833607359598646');" onmouseout="out('-314833607359598646');" style=""> 394             sideOutTypes[i] = convertTimeAttributeType(fieldTypes[i]);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395         }                                                                                                </span>
<span class="-6446480870466684625" onmouseenter="enter('-6446480870466684625');" onmouseout="out('-6446480870466684625');" style=""> 396         RowTypeInfo rowTypeInfo = new RowTypeInfo(sideOutTypes, leftTypeInfo.getFieldNames());           </span>
<span class="6189116692514123920" onmouseenter="enter('6189116692514123920');" onmouseout="out('6189116692514123920');" style=""> 397         return rowTypeInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398     }                                                                                                    </span>
<span  style=""> 399                                                                                                          </span>
<span class="2471506251995792847" onmouseenter="enter('2471506251995792847');" onmouseout="out('2471506251995792847');" style=""> 400     private TypeInformation convertTimeAttributeType(TypeInformation typeInformation) {                  </span>
<span class="2997926285576198837" onmouseenter="enter('2997926285576198837');" onmouseout="out('2997926285576198837');" style=""> 401         if (typeInformation instanceof TimeIndicatorTypeInfo) {                                          </span>
<span class="-6249974448261972874" onmouseenter="enter('-6249974448261972874');" onmouseout="out('-6249974448261972874');" style=""> 402             return TypeInformation.of(Timestamp.class);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403         }                                                                                                </span>
<span class="6871348106862514693" onmouseenter="enter('6871348106862514693');" onmouseout="out('6871348106862514693');" style=""> 404         return typeInformation;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 406 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 407 ||||||| BASE                                                                                             </span>
<span class="-5866348515582828073" onmouseenter="enter('-5866348515582828073');" onmouseout="out('-5866348515582828073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 408 private void replaceFieldName(SqlNode sqlNode, FieldReplaceInfo replaceInfo) {                           </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 409         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 410         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 411             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 412                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="3539579188210716047" onmouseenter="enter('3539579188210716047');" onmouseout="out('3539579188210716047');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 413                 replaceFieldName(sqlSource, replaceInfo);                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 414                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 415             case AS:                                                                                     </span>
<span class="-2471580703701460163" onmouseenter="enter('-2471580703701460163');" onmouseout="out('-2471580703701460163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 416                 SqlNode asNode = ((SqlBasicCall) sqlNode).getOperands()[0];                              </span>
<span class="2382936847570265491" onmouseenter="enter('2382936847570265491');" onmouseout="out('2382936847570265491');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 417                 replaceFieldName(asNode, replaceInfo);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 418                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 419             case SELECT:                                                                                 </span>
<span class="7730902652365827282" onmouseenter="enter('7730902652365827282');" onmouseout="out('7730902652365827282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 420                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName());"> 420                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTarget🔵</abbr></span>
<span class="-1465070514376240276" onmouseenter="enter('-1465070514376240276');" onmouseout="out('-1465070514376240276');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 421                 if(sqlSelect == null){                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 422                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 423                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 424                                                                                                          </span>
<span class="-7911431356156617515" onmouseenter="enter('-7911431356156617515');" onmouseout="out('-7911431356156617515');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 425                 SqlNode sqlSource1 = sqlSelect.getFrom();                                                </span>
<span class="-4060139958118865814" onmouseenter="enter('-4060139958118865814');" onmouseout="out('-4060139958118865814');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 426                 if(sqlSource1.getKind() == AS){                                                          </span>
<span class="7708153722582291408" onmouseenter="enter('7708153722582291408');" onmouseout="out('7708153722582291408');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 427                     String tableName = ((SqlBasicCall)sqlSource1).getOperands()[0].toString();           </span>
<span class="-7976662112993336650" onmouseenter="enter('-7976662112993336650');" onmouseout="out('-7976662112993336650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 428                     if(tableName.equalsIgnoreCase(replaceInfo.getTargetTableName())){                    </span>
<span class="5036423329776629809" onmouseenter="enter('5036423329776629809');" onmouseout="out('5036423329776629809');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 429                         SqlNodeList sqlSelectList = sqlSelect.getSelectList();                           </span>
<span class="4783458191183529265" onmouseenter="enter('4783458191183529265');" onmouseout="out('4783458191183529265');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 430                         SqlNode whereNode = sqlSelect.getWhere();                                        </span>
<span class="6069356713975423578" onmouseenter="enter('6069356713975423578');" onmouseout="out('6069356713975423578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 431                         SqlNodeList sqlGroup = sqlSelect.getGroup();                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 432                                                                                                          </span>
<span class="2024933395694494313" onmouseenter="enter('2024933395694494313');" onmouseout="out('2024933395694494313');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 433                         //TODO 暂时不处理having                                                               </span>
<span class="-2928778695763881832" onmouseenter="enter('-2928778695763881832');" onmouseout="out('-2928778695763881832');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 434                         SqlNode sqlHaving = sqlSelect.getHaving();                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 435                                                                                                          </span>
<span class="-3614471078991347107" onmouseenter="enter('-3614471078991347107');" onmouseout="out('-3614471078991347107');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 436                         List&lt;SqlNode&gt; newSelectNodeList = Lists.newArrayList();                          </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 437                         for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                            </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 438                             SqlNode selectNode = sqlSelectList.getList().get(i);                         </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 439                             //特殊处理 isStar的标识                                                             </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 440                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){"> 440                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar(🔵</abbr></span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 441                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);"> 441                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, re🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 442                                 newSelectNodeList.addAll(replaceNodeList);                               </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 443                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 445                                                                                                          </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446                             SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);       </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447                             if(replaceNode == null){                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450                                                                                                          </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 451                             //sqlSelectList.set(i, replaceNode);                                         </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 452                             newSelectNodeList.add(replaceNode);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 453                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 454                                                                                                          </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 455                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());"> 455                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getP🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 456                         sqlSelect.setSelectList(newSelectList);                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 457                                                                                                          </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 458                         //where                                                                          </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 459                         if(whereNode != null){                                                           </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 460                             SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();             </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 461                             for(int i =0; i&lt;sqlNodeList.length; i++) {                                   </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 462                                 SqlNode whereSqlNode = sqlNodeList[i];                                   </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 463                                 SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);        </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 464                                 sqlNodeList[i] = replaceNode;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 465                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 466                         }                                                                                </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 467                         if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){          </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 468                             for( int i=0; i&lt;sqlGroup.getList().size(); i++){                             </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 469                                 SqlNode selectNode = sqlGroup.getList().get(i);                          </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 470                                 SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);          </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 471                                 sqlGroup.set(i, replaceNode);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 472                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 473                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 474                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 475                 }else{                                                                                   </span>
<span class="5468885380070811563" onmouseenter="enter('5468885380070811563');" onmouseout="out('5468885380070811563');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 476                     //TODO                                                                               </span>
<span class="-7176218527101706664" onmouseenter="enter('-7176218527101706664');" onmouseout="out('-7176218527101706664');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 477                     System.out.println(sqlNode);                                                         </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 478                     throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 479                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 480                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 481                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 482             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 483                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 484                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 485                 replaceFieldName(unionLeft, replaceInfo);                                                </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 486                 replaceFieldName(unionRight, replaceInfo);                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 487                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 488                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 489             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 490                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 491                 replaceFieldName(sqlOrderBy.query, replaceInfo);                                         </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 492                 SqlNodeList orderFiledList = sqlOrderBy.orderList;                                       </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 493                 for (int i=0 ;i&lt;orderFiledList.size();i++) {                                             </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 494                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());"> 494                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getT🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 495                     orderFiledList.set(i, replaceNode);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 496                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 497                                                                                                          </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 498             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 499                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 500         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 501     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 502 =======                                                                                                  </span>
<span class="-5866348515582828073" onmouseenter="enter('-5866348515582828073');" onmouseout="out('-5866348515582828073');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 503 private void replaceFieldName(SqlNode sqlNode, FieldReplaceInfo replaceInfo) {                           </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 504         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 505         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 506             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="3539579188210716047" onmouseenter="enter('3539579188210716047');" onmouseout="out('3539579188210716047');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508                 replaceFieldName(sqlSource, replaceInfo);                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510             case AS:                                                                                     </span>
<span class="-2471580703701460163" onmouseenter="enter('-2471580703701460163');" onmouseout="out('-2471580703701460163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511                 SqlNode asNode = ((SqlBasicCall) sqlNode).getOperands()[0];                              </span>
<span class="2382936847570265491" onmouseenter="enter('2382936847570265491');" onmouseout="out('2382936847570265491');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512                 replaceFieldName(asNode, replaceInfo);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514             case SELECT:                                                                                 </span>
<span class="7730902652365827282" onmouseenter="enter('7730902652365827282');" onmouseout="out('7730902652365827282');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 515                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName());"> 515                 SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTarget🔵</abbr></span>
<span class="-1465070514376240276" onmouseenter="enter('-1465070514376240276');" onmouseout="out('-1465070514376240276');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516                 if(sqlSelect == null){                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519                                                                                                          </span>
<span class="-7911431356156617515" onmouseenter="enter('-7911431356156617515');" onmouseout="out('-7911431356156617515');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520                 SqlNode sqlSource1 = sqlSelect.getFrom();                                                </span>
<span class="-4060139958118865814" onmouseenter="enter('-4060139958118865814');" onmouseout="out('-4060139958118865814');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521                 if(sqlSource1.getKind() == AS){                                                          </span>
<span class="7708153722582291408" onmouseenter="enter('7708153722582291408');" onmouseout="out('7708153722582291408');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522                     String tableName = ((SqlBasicCall)sqlSource1).getOperands()[0].toString();           </span>
<span class="-7976662112993336650" onmouseenter="enter('-7976662112993336650');" onmouseout="out('-7976662112993336650');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523                     if(tableName.equalsIgnoreCase(replaceInfo.getTargetTableName())){                    </span>
<span class="5036423329776629809" onmouseenter="enter('5036423329776629809');" onmouseout="out('5036423329776629809');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524                         SqlNodeList sqlSelectList = sqlSelect.getSelectList();                           </span>
<span class="4783458191183529265" onmouseenter="enter('4783458191183529265');" onmouseout="out('4783458191183529265');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525                         SqlNode whereNode = sqlSelect.getWhere();                                        </span>
<span class="6069356713975423578" onmouseenter="enter('6069356713975423578');" onmouseout="out('6069356713975423578');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526                         SqlNodeList sqlGroup = sqlSelect.getGroup();                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527                                                                                                          </span>
<span class="2024933395694494313" onmouseenter="enter('2024933395694494313');" onmouseout="out('2024933395694494313');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528                         //TODO 暂时不处理having                                                               </span>
<span class="-2928778695763881832" onmouseenter="enter('-2928778695763881832');" onmouseout="out('-2928778695763881832');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529                         SqlNode sqlHaving = sqlSelect.getHaving();                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530                                                                                                          </span>
<span class="-3614471078991347107" onmouseenter="enter('-3614471078991347107');" onmouseout="out('-3614471078991347107');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531                         List&lt;SqlNode&gt; newSelectNodeList = Lists.newArrayList();                          </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532                         for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                            </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533                             SqlNode selectNode = sqlSelectList.getList().get(i);                         </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534                             //特殊处理 isStar的标识                                                             </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 535                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){"> 535                             if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar(🔵</abbr></span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 536                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);"> 536                                 List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, re🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 537                                 newSelectNodeList.addAll(replaceNodeList);                               </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 539                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 540                                                                                                          </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 541                             SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);       </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542                             if(replaceNode == null){                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 544                             }                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 545                                                                                                          </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 546                             //sqlSelectList.set(i, replaceNode);                                         </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 547                             newSelectNodeList.add(replaceNode);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 548                         }                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 549                                                                                                          </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 550                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());"> 550                         SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getP🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551                         sqlSelect.setSelectList(newSelectList);                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552                                                                                                          </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553                         //where                                                                          </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 554                         if(whereNode != null){                                                           </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555                             SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();             </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 556                             for(int i =0; i&lt;sqlNodeList.length; i++) {                                   </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557                                 SqlNode whereSqlNode = sqlNodeList[i];                                   </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558                                 SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);        </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559                                 sqlNodeList[i] = replaceNode;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 560                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561                         }                                                                                </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562                         if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){          </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563                             for( int i=0; i&lt;sqlGroup.getList().size(); i++){                             </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564                                 SqlNode selectNode = sqlGroup.getList().get(i);                          </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565                                 SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);          </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566                                 sqlGroup.set(i, replaceNode);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570                 }else{                                                                                   </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571                     throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 572                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578                 replaceFieldName(unionLeft, replaceInfo);                                                </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 579                 replaceFieldName(unionRight, replaceInfo);                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584                 replaceFieldName(sqlOrderBy.query, replaceInfo);                                         </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585                 SqlNodeList orderFiledList = sqlOrderBy.orderList;                                       </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586                 for (int i=0 ;i&lt;orderFiledList.size();i++) {                                             </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 587                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());"> 587                     SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getT🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588                     orderFiledList.set(i, replaceNode);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590                                                                                                          </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 591             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 595 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 596 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 597 ||||||| BASE                                                                                             </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 598 public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 599                                                                                                          </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 600         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 601         switch (sqlKind){                                                                                </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 602             case SELECT:                                                                                 </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 603                 SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                       </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 604                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){"> 604                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDE🔵</abbr></span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 605                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){"> 605                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableN🔵</abbr></span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 606                         return sqlNode;                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 607                     }else{                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 608                         return null;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 609                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 610                 }else{                                                                                   </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 611                     return filterNodeWithTargetName(fromNode, targetTableName);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 612                 }                                                                                        </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 613             case AS:                                                                                     </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 614                 SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 615                 return filterNodeWithTargetName(childNode, targetTableName);                             </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 616             case JOIN:                                                                                   </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 617                 SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                         </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 618                 SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                      </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 619                 SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);            </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 620                 SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 621                                                                                                          </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 622                 if(leftReturnNode != null) {                                                             </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 623                     return leftReturnNode;                                                               </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 624                 }else if(rightReturnNode != null){                                                       </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 625                     return rightReturnNode;                                                              </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 626                 }else{                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 627                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 628                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 629         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 630                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 631         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 632     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 633 =======                                                                                                  </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634 public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635                                                                                                          </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637         switch (sqlKind){                                                                                </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638             case SELECT:                                                                                 </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639                 SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                       </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 640                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){"> 640                 if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDE🔵</abbr></span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 641                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){"> 641                     if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableN🔵</abbr></span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642                         return sqlNode;                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643                     }else{                                                                               </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644                         return null;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646                 }else{                                                                                   </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647                     return filterNodeWithTargetName(fromNode, targetTableName);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648                 }                                                                                        </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649             case AS:                                                                                     </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650                 SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651                 return filterNodeWithTargetName(childNode, targetTableName);                             </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652             case JOIN:                                                                                   </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 653                 SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                         </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 654                 SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                      </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655                 SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);            </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656                 SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657                                                                                                          </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 658                 if(leftReturnNode != null) {                                                             </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 659                     return leftReturnNode;                                                               </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 660                 }else if(rightReturnNode != null){                                                       </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661                     return rightReturnNode;                                                              </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 662                 }else{                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 664                 }                                                                                        </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 671 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 672                                                                                                          </span>
<span  style=""> 673                                                                                                          </span>
<span  style=""> 674                                                                                                          </span>
<span  style=""> 675                                                                                                          </span>
<span  style=""> 676                                                                                                          </span>
<span  style=""> 677                                                                                                          </span>
<span  style=""> 678                                                                                                          </span>
<span class="-6722855011181273565" onmouseenter="enter('-6722855011181273565');" onmouseout="out('-6722855011181273565');" style=""> 679     public void setLocalSqlPluginPath(String localSqlPluginPath) {                                       </span>
<span class="6258662942576926140" onmouseenter="enter('6258662942576926140');" onmouseout="out('6258662942576926140');" style=""> 680         this.localSqlPluginPath = localSqlPluginPath;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 681     }                                                                                                    </span>
<span  style=""> 682                                                                                                          </span>
<span class="2277905399441322839" onmouseenter="enter('2277905399441322839');" onmouseout="out('2277905399441322839');" style=""><abbr title=" 683     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableName){"> 683     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableNa🔵</abbr></span>
<span class="-6301156236825066460" onmouseenter="enter('-6301156236825066460');" onmouseout="out('-6301156236825066460');" style=""> 684         Table table = localTableCache.get(tableAlias);                                                   </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 685         if(table == null){                                                                               </span>
<span class="-5960895848666330323" onmouseenter="enter('-5960895848666330323');" onmouseout="out('-5960895848666330323');" style=""> 686             table = localTableCache.get(tableName);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 687         }                                                                                                </span>
<span  style=""> 688                                                                                                          </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 689         if(table == null){                                                                               </span>
<span class="4627225224916806199" onmouseenter="enter('4627225224916806199');" onmouseout="out('4627225224916806199');" style=""> 690             throw new RuntimeException(&quot;not register table &quot; + tableAlias);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 691         }                                                                                                </span>
<span  style=""> 692                                                                                                          </span>
<span class="-6017334383208509278" onmouseenter="enter('-6017334383208509278');" onmouseout="out('-6017334383208509278');" style=""> 693         return table;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 694     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 695 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 696 ||||||| BASE                                                                                             </span>
<span class="-5931652736394605669" onmouseenter="enter('-5931652736394605669');" onmouseout="out('-5931652736394605669');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 697 private SqlNode replaceSelectFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo) {               </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 698         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 699             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-1521486087941699086" onmouseenter="enter('-1521486087941699086');" onmouseout="out('-1521486087941699086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 700             SqlNode replaceNode = replaceSelectFieldName(leftNode, replaceInfo);                         </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 701             if (replaceNode != null) {                                                                   </span>
<span class="44744548385893691" onmouseenter="enter('44744548385893691');" onmouseout="out('44744548385893691');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 702                 ((SqlBasicCall) selectNode).getOperands()[0] = replaceNode;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 703             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 704                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 705             return selectNode;                                                                           </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 706         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 707             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 708                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 709             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 710                 return selectNode;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 711             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 712                                                                                                          </span>
<span class="5152547743275588251" onmouseenter="enter('5152547743275588251');" onmouseout="out('5152547743275588251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 713             //Same level mappingTable                                                                    </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 714             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 714             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="-6523721893364253351" onmouseenter="enter('-6523721893364253351');" onmouseout="out('-6523721893364253351');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 715             if (mappingFieldName == null) {                                                              </span>
<span class="8276130366719222706" onmouseenter="enter('8276130366719222706');" onmouseout="out('8276130366719222706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 716                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + selectNode.toString() );    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 717             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 718                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 719             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2571352877158902005" onmouseenter="enter('2571352877158902005');" onmouseout="out('2571352877158902005');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 720             sqlIdentifier = sqlIdentifier.setName(1, mappingFieldName);                                  </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 721             return sqlIdentifier;                                                                        </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 722         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 723             return selectNode;                                                                           </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 724         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 725                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 726                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 727                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 728                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 729                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 730                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 731                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 732                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 733                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 734                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 735                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 736                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 737                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 738                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 739                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 740                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 741                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 742                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 743                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 744                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 745                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 746                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 747                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 748                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 749                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 750                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 751                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 752                 || selectNode.getKind() == LIKE                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 753                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 754                 ){                                                                                       </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 755             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 756             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 757                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 758                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 759                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 760                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 761                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 762                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 763                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 764                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 765                                                                                                          </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 766                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 767                 if(replaceNode == null){                                                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 768                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 769                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 770                                                                                                          </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 771                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 772             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 773                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 774             return selectNode;                                                                           </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 775         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-6113591358780745482" onmouseenter="enter('-6113591358780745482');" onmouseout="out('-6113591358780745482');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 776             System.out.println(&quot;selectNode&quot;);                                                            </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 777             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 778             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 779             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 780             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 781                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 782             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 783                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 784                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 785                 if (replaceNode != null) {                                                               </span>
<span class="827753515492975605" onmouseenter="enter('827753515492975605');" onmouseout="out('827753515492975605');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 786                     whenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 787                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 788             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 789                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 790             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 791                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 792                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 793                 if (replaceNode != null) {                                                               </span>
<span class="-4947674979480974151" onmouseenter="enter('-4947674979480974151');" onmouseout="out('-4947674979480974151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 794                     thenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 795                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 796             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 797                                                                                                          </span>
<span class="-1702904876822094161" onmouseenter="enter('-1702904876822094161');" onmouseout="out('-1702904876822094161');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 798             ((SqlCase) selectNode).setOperand(3, replaceSelectFieldName(elseNode, replaceInfo));         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 799             return selectNode;                                                                           </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 800         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 801             //不处理                                                                                        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 802             return selectNode;                                                                           </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 803         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 804             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 804             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 805         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 806     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 807 =======                                                                                                  </span>
<span class="-5931652736394605669" onmouseenter="enter('-5931652736394605669');" onmouseout="out('-5931652736394605669');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 808 private SqlNode replaceSelectFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo) {               </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 809         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 810             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-1521486087941699086" onmouseenter="enter('-1521486087941699086');" onmouseout="out('-1521486087941699086');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 811             SqlNode replaceNode = replaceSelectFieldName(leftNode, replaceInfo);                         </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 812             if (replaceNode != null) {                                                                   </span>
<span class="44744548385893691" onmouseenter="enter('44744548385893691');" onmouseout="out('44744548385893691');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 813                 ((SqlBasicCall) selectNode).getOperands()[0] = replaceNode;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 814             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 815                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 816             return selectNode;                                                                           </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 817         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 818             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 819                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 820             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 821                 return selectNode;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 822             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 823                                                                                                          </span>
<span class="5152547743275588251" onmouseenter="enter('5152547743275588251');" onmouseout="out('5152547743275588251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 824             //Same level mappingTable                                                                    </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 825             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 825             String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSim🔵</abbr></span>
<span class="-6523721893364253351" onmouseenter="enter('-6523721893364253351');" onmouseout="out('-6523721893364253351');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 826             if (mappingFieldName == null) {                                                              </span>
<span class="8276130366719222706" onmouseenter="enter('8276130366719222706');" onmouseout="out('8276130366719222706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 827                 throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + selectNode.toString() );    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 828             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 829                                                                                                          </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 830             sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                 </span>
<span class="2571352877158902005" onmouseenter="enter('2571352877158902005');" onmouseout="out('2571352877158902005');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 831             sqlIdentifier = sqlIdentifier.setName(1, mappingFieldName);                                  </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 832             return sqlIdentifier;                                                                        </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 833         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 834             return selectNode;                                                                           </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 835         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 836                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 837                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 838                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 839                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 840                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 841                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 842                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 843                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 844                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 845                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 846                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 847                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 848                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 849                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 850                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 851                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 852                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 853                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 854                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 855                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 856                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 857                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 858                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 859                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 860                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 861                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 862                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 863                 || selectNode.getKind() == LIKE                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 864                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 865                 ){                                                                                       </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 866             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 867             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 868                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 869                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 870                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 871                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 872                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 873                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 874                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 875                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 876                                                                                                          </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 877                 SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                      </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 878                 if(replaceNode == null){                                                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 879                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 880                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 881                                                                                                          </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 882                 sqlBasicCall.getOperands()[i] = replaceNode;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 883             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 884                                                                                                          </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 885             return selectNode;                                                                           </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 886         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 887             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 888             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 889             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 890             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 891                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 892             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 893                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 894                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 895                 if (replaceNode != null) {                                                               </span>
<span class="827753515492975605" onmouseenter="enter('827753515492975605');" onmouseout="out('827753515492975605');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 896                     whenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 897                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 898             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 899                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 900             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 901                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 902                 SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                   </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 903                 if (replaceNode != null) {                                                               </span>
<span class="-4947674979480974151" onmouseenter="enter('-4947674979480974151');" onmouseout="out('-4947674979480974151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 904                     thenOperands.set(i, replaceNode);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 905                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 906             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 907                                                                                                          </span>
<span class="-1702904876822094161" onmouseenter="enter('-1702904876822094161');" onmouseout="out('-1702904876822094161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 908             ((SqlCase) selectNode).setOperand(3, replaceSelectFieldName(elseNode, replaceInfo));         </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 909             return selectNode;                                                                           </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 910         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 911             //不处理                                                                                        </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 912             return selectNode;                                                                           </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 913         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 914             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 914             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 915         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 916     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 917 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 918                                                                                                          </span>
<span  style=""> 919                                                                                                          </span>
<span  style=""> 920                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 921     /**                                                                                                  </span>
<span class="5196638318686351881" onmouseenter="enter('5196638318686351881');" onmouseout="out('5196638318686351881');" style=""><abbr title=" 922      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension table is the primary key definition"> 922      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., d🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 923      *                                                                                                   </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 924      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 925      */                                                                                                  </span>
<span class="4488554625343324946" onmouseenter="enter('4488554625343324946');" onmouseout="out('4488554625343324946');" style=""><abbr title=" 926     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInfo sideTableInfo) {"> 926     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInf🔵</abbr></span>
<span class="-6710736308674703771" onmouseenter="enter('-6710736308674703771');" onmouseout="out('-6710736308674703771');" style=""> 927         List&lt;String&gt; conditionFields = getConditionFields(conditionNode, sideTableAlias, sideTableInfo); </span>
<span class="-3924194481322428470" onmouseenter="enter('-3924194481322428470');" onmouseout="out('-3924194481322428470');" style=""> 928         if(CollectionUtils.isEqualCollection(conditionFields, convertPrimaryAlias(sideTableInfo))){      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 929             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 930         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 931         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 932     }                                                                                                    </span>
<span  style=""> 933                                                                                                          </span>
<span class="572998504046101497" onmouseenter="enter('572998504046101497');" onmouseout="out('572998504046101497');" style=""> 934     private List&lt;String&gt; convertPrimaryAlias(AbstractSideTableInfo sideTableInfo) {                      </span>
<span class="-6700733268022775520" onmouseenter="enter('-6700733268022775520');" onmouseout="out('-6700733268022775520');" style=""> 935         List&lt;String&gt; res = Lists.newArrayList();                                                         </span>
<span class="-1517278133900331130" onmouseenter="enter('-1517278133900331130');" onmouseout="out('-1517278133900331130');" style=""> 936         sideTableInfo.getPrimaryKeys().forEach(field -&gt; {                                                </span>
<span class="2991641550935988694" onmouseenter="enter('2991641550935988694');" onmouseout="out('2991641550935988694');" style=""> 937             res.add(sideTableInfo.getPhysicalFields().getOrDefault(field, field));                       </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 938         });                                                                                              </span>
<span class="1866624461241282949" onmouseenter="enter('1866624461241282949');" onmouseout="out('1866624461241282949');" style=""> 939         return res;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 940     }                                                                                                    </span>
<span  style=""> 941                                                                                                          </span>
<span class="-958139939083183834" onmouseenter="enter('-958139939083183834');" onmouseout="out('-958139939083183834');" style=""><abbr title=" 942     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTableInfo sideTableInfo){"> 942     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTa🔵</abbr></span>
<span class="-5667062641477778387" onmouseenter="enter('-5667062641477778387');" onmouseout="out('-5667062641477778387');" style=""> 943         List&lt;SqlNode&gt; sqlNodeList = Lists.newArrayList();                                                </span>
<span class="5003747983397221043" onmouseenter="enter('5003747983397221043');" onmouseout="out('5003747983397221043');" style=""> 944         ParseUtils.parseAnd(conditionNode, sqlNodeList);                                                 </span>
<span class="331902561671078290" onmouseenter="enter('331902561671078290');" onmouseout="out('331902561671078290');" style=""> 945         List&lt;String&gt; conditionFields = Lists.newArrayList();                                             </span>
<span class="-2336842894952786561" onmouseenter="enter('-2336842894952786561');" onmouseout="out('-2336842894952786561');" style=""> 946         for(SqlNode sqlNode : sqlNodeList){                                                              </span>
<span class="-1235221313035004193" onmouseenter="enter('-1235221313035004193');" onmouseout="out('-1235221313035004193');" style=""> 947             if (!SqlKind.COMPARISON.contains(sqlNode.getKind())) {                                       </span>
<span class="4238811186041433324" onmouseenter="enter('4238811186041433324');" onmouseout="out('4238811186041433324');" style=""> 948                 throw new RuntimeException(&quot;not compare operator.&quot;);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 949             }                                                                                            </span>
<span  style=""> 950                                                                                                          </span>
<span class="-7359051973666627295" onmouseenter="enter('-7359051973666627295');" onmouseout="out('-7359051973666627295');" style=""> 951             SqlIdentifier left = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];                </span>
<span class="3465298874779506196" onmouseenter="enter('3465298874779506196');" onmouseout="out('3465298874779506196');" style=""> 952             SqlIdentifier right = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];               </span>
<span  style=""> 953                                                                                                          </span>
<span class="-2670749344655178863" onmouseenter="enter('-2670749344655178863');" onmouseout="out('-2670749344655178863');" style=""> 954             String leftTableName = left.getComponent(0).getSimple();                                     </span>
<span class="5188110590184041827" onmouseenter="enter('5188110590184041827');" onmouseout="out('5188110590184041827');" style=""> 955             String rightTableName = right.getComponent(0).getSimple();                                   </span>
<span  style=""> 956                                                                                                          </span>
<span class="8082853509369418918" onmouseenter="enter('8082853509369418918');" onmouseout="out('8082853509369418918');" style=""> 957             String tableCol = &quot;&quot;;                                                                        </span>
<span class="3869855333927982135" onmouseenter="enter('3869855333927982135');" onmouseout="out('3869855333927982135');" style=""> 958             if(leftTableName.equalsIgnoreCase(specifyTableName)){                                        </span>
<span class="4527748628163402760" onmouseenter="enter('4527748628163402760');" onmouseout="out('4527748628163402760');" style=""> 959                 tableCol = left.getComponent(1).getSimple();                                             </span>
<span class="5068195286258055415" onmouseenter="enter('5068195286258055415');" onmouseout="out('5068195286258055415');" style=""> 960             }else if(rightTableName.equalsIgnoreCase(specifyTableName)){                                 </span>
<span class="4462633703217831544" onmouseenter="enter('4462633703217831544');" onmouseout="out('4462633703217831544');" style=""> 961                 tableCol = right.getComponent(1).getSimple();                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 962             }else{                                                                                       </span>
<span class="3783543445731730404" onmouseenter="enter('3783543445731730404');" onmouseout="out('3783543445731730404');" style=""><abbr title=" 963                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName));"> 963                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specify🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 964             }                                                                                            </span>
<span class="-2325401555704525047" onmouseenter="enter('-2325401555704525047');" onmouseout="out('-2325401555704525047');" style=""> 965             tableCol = sideTableInfo.getPhysicalFields().getOrDefault(tableCol, tableCol);               </span>
<span class="-4552234441929070616" onmouseenter="enter('-4552234441929070616');" onmouseout="out('-4552234441929070616');" style=""> 966             conditionFields.add(tableCol);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 967         }                                                                                                </span>
<span  style=""> 968                                                                                                          </span>
<span class="4950082808497882460" onmouseenter="enter('4950082808497882460');" onmouseout="out('4950082808497882460');" style=""> 969         return conditionFields;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 970     }                                                                                                    </span>
<span  style=""> 971                                                                                                          </span>
<span class="-8173208587282838964" onmouseenter="enter('-8173208587282838964');" onmouseout="out('-8173208587282838964');" style=""> 972     protected void dealAsSourceTable(StreamTableEnvironment tableEnv,                                    </span>
<span class="9126592535894268017" onmouseenter="enter('9126592535894268017');" onmouseout="out('9126592535894268017');" style=""> 973                                      SqlNode pollSqlNode,                                                </span>
<span class="-4636178628928660306" onmouseenter="enter('-4636178628928660306');" onmouseout="out('-4636178628928660306');" style=""> 974                                      Map&lt;String, Table&gt; tableCache) throws SqlParseException {           </span>
<span  style=""> 975                                                                                                          </span>
<span class="7772412594103241573" onmouseenter="enter('7772412594103241573');" onmouseout="out('7772412594103241573');" style=""> 976         AliasInfo aliasInfo = parseAsNode(pollSqlNode);                                                  </span>
<span class="2461088292100865778" onmouseenter="enter('2461088292100865778');" onmouseout="out('2461088292100865778');" style=""> 977         if (localTableCache.containsKey(aliasInfo.getName())) {                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 978             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 979         }                                                                                                </span>
<span  style=""> 980                                                                                                          </span>
<span class="-3390660419579622283" onmouseenter="enter('-3390660419579622283');" onmouseout="out('-3390660419579622283');" style=""> 981         Table table = tableEnv.sqlQuery(aliasInfo.getName());                                            </span>
<span class="5901087968051131557" onmouseenter="enter('5901087968051131557');" onmouseout="out('5901087968051131557');" style=""> 982         tableEnv.registerTable(aliasInfo.getAlias(), table);                                             </span>
<span class="1100939894023116874" onmouseenter="enter('1100939894023116874');" onmouseout="out('1100939894023116874');" style=""> 983         localTableCache.put(aliasInfo.getAlias(), table);                                                </span>
<span  style=""> 984                                                                                                          </span>
<span class="7353361537117728269" onmouseenter="enter('7353361537117728269');" onmouseout="out('7353361537117728269');" style=""> 985         LOG.info(&quot;Register Table {} by {}&quot;, aliasInfo.getAlias(), aliasInfo.getName());                  </span>
<span  style=""> 986                                                                                                          </span>
<span class="-8665165690117838262" onmouseenter="enter('-8665165690117838262');" onmouseout="out('-8665165690117838262');" style=""> 987         FieldReplaceInfo fieldReplaceInfo = parseAsQuery((SqlBasicCall) pollSqlNode, tableCache);        </span>
<span class="-7633956211129533821" onmouseenter="enter('-7633956211129533821');" onmouseout="out('-7633956211129533821');" style=""> 988         if(fieldReplaceInfo == null){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 989            return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 990         }                                                                                                </span>
<span  style=""> 991                                                                                                          </span>
<span class="-6438671410831308886" onmouseenter="enter('-6438671410831308886');" onmouseout="out('-6438671410831308886');" style=""> 992         //as 的源表                                                                                         </span>
<span class="-7252441079357822746" onmouseenter="enter('-7252441079357822746');" onmouseout="out('-7252441079357822746');" style=""> 993         Set&lt;String&gt; fromTableNameSet = Sets.newHashSet();                                                </span>
<span class="-1390965398492412473" onmouseenter="enter('-1390965398492412473');" onmouseout="out('-1390965398492412473');" style=""> 994         SqlNode fromNode = ((SqlBasicCall)pollSqlNode).getOperands()[0];                                 </span>
<span class="8218826531385538687" onmouseenter="enter('8218826531385538687');" onmouseout="out('8218826531385538687');" style=""> 995         TableUtils.getFromTableInfo(fromNode, fromTableNameSet);                                         </span>
<span  style=""> 996                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 997     }                                                                                                    </span>
<span  style=""> 998                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 999 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-894097875121841059" onmouseenter="enter('-894097875121841059');" onmouseout="out('-894097875121841059');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1000     private void joinFun(Object pollObj,                                                                 </span>
<span class="6823594550750748067" onmouseenter="enter('6823594550750748067');" onmouseout="out('6823594550750748067');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1001                          Map&lt;String, Table&gt; localTableCache,                                             </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1002                          Map&lt;String, SideTableInfo&gt; sideTableMap,                                        </span>
<span class="-1170693753985315194" onmouseenter="enter('-1170693753985315194');" onmouseout="out('-1170693753985315194');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1003                          StreamTableEnvironment tableEnv) throws Exception{                              </span>
<span class="-3106951960183426296" onmouseenter="enter('-3106951960183426296');" onmouseout="out('-3106951960183426296');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1004         JoinInfo joinInfo = (JoinInfo) pollObj;                                                          </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1005                                                                                                          </span>
<span class="-4580559439294190862" onmouseenter="enter('-4580559439294190862');" onmouseout="out('-4580559439294190862');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1006         JoinScope joinScope = new JoinScope();                                                           </span>
<span class="-6383140859888654083" onmouseenter="enter('-6383140859888654083');" onmouseout="out('-6383140859888654083');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1007         JoinScope.ScopeChild leftScopeChild = new JoinScope.ScopeChild();                                </span>
<span class="-5401707331330951256" onmouseenter="enter('-5401707331330951256');" onmouseout="out('-5401707331330951256');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1008         leftScopeChild.setAlias(joinInfo.getLeftTableAlias());                                           </span>
<span class="5108424867732442426" onmouseenter="enter('5108424867732442426');" onmouseout="out('5108424867732442426');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1009         leftScopeChild.setTableName(joinInfo.getLeftTableName());                                        </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1010                                                                                                          </span>
<span class="-2402361542513321069" onmouseenter="enter('-2402361542513321069');" onmouseout="out('-2402361542513321069');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1011         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableName());">1011         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLe🔵</abbr></span>
<span class="5224542232803887157" onmouseenter="enter('5224542232803887157');" onmouseout="out('5224542232803887157');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1012         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColumnNames());">1012         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema(🔵</abbr></span>
<span class="-5303860989220332569" onmouseenter="enter('-5303860989220332569');" onmouseout="out('-5303860989220332569');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1013         leftScopeChild.setRowTypeInfo(leftTypeInfo);                                                     </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1014                                                                                                          </span>
<span class="3043795906382715340" onmouseenter="enter('3043795906382715340');" onmouseout="out('3043795906382715340');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1015         JoinScope.ScopeChild rightScopeChild = new JoinScope.ScopeChild();                               </span>
<span class="2585249270397691815" onmouseenter="enter('2585249270397691815');" onmouseout="out('2585249270397691815');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1016         rightScopeChild.setAlias(joinInfo.getRightTableAlias());                                         </span>
<span class="-5072747544386586876" onmouseenter="enter('-5072747544386586876');" onmouseout="out('-5072747544386586876');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1017         rightScopeChild.setTableName(joinInfo.getRightTableName());                                      </span>
<span class="-1752720370690577453" onmouseenter="enter('-1752720370690577453');" onmouseout="out('-1752720370690577453');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1018         SideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());                    </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1019         if(sideTableInfo == null){                                                                       </span>
<span class="-5396801098824602905" onmouseenter="enter('-5396801098824602905');" onmouseout="out('-5396801098824602905');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1020             sideTableInfo = sideTableMap.get(joinInfo.getRightTableAlias());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1021         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1022                                                                                                          </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1023         if(sideTableInfo == null){                                                                       </span>
<span class="450947362076537032" onmouseenter="enter('450947362076537032');" onmouseout="out('450947362076537032');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1024             throw new RuntimeException(&quot;can&#x27;t not find side table:&quot; + joinInfo.getRightTableName());     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1025         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1026                                                                                                          </span>
<span class="6668906180521634363" onmouseenter="enter('6668906180521634363');" onmouseout="out('6668906180521634363');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1027 //        if(!checkJoinCondition(joinInfo.getCondition(), joinInfo.getRightTableAlias(), sideTableInfo)){</span>
<span class="2570085130586631416" onmouseenter="enter('2570085130586631416');" onmouseout="out('2570085130586631416');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1028 //            throw new RuntimeException(&quot;ON condition must contain all equal fields!!!&quot;);               </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1029 //        }                                                                                              </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1030                                                                                                          </span>
<span class="-1562873445908102884" onmouseenter="enter('-1562873445908102884');" onmouseout="out('-1562873445908102884');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1031         rightScopeChild.setRowTypeInfo(sideTableInfo.getRowTypeInfo());                                  </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1032                                                                                                          </span>
<span class="-5776192160472100987" onmouseenter="enter('-5776192160472100987');" onmouseout="out('-5776192160472100987');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1033         joinScope.addScope(leftScopeChild);                                                              </span>
<span class="6805588345897841594" onmouseenter="enter('6805588345897841594');" onmouseout="out('6805588345897841594');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1034         joinScope.addScope(rightScopeChild);                                                             </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1035                                                                                                          </span>
<span class="2226908158928528195" onmouseenter="enter('2226908158928528195');" onmouseout="out('2226908158928528195');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1036         HashBasedTable&lt;String, String, String&gt; mappingTable = ((JoinInfo) pollObj).getTableFieldRef();   </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1037                                                                                                          </span>
<span class="-816440763270240777" onmouseenter="enter('-816440763270240777');" onmouseout="out('-816440763270240777');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1038         //获取两个表的所有字段                                                                                     </span>
<span class="-6198283029075022684" onmouseenter="enter('-6198283029075022684');" onmouseout="out('-6198283029075022684');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1039         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, true);">1039         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), join🔵</abbr></span>
<span class="5016458903510526292" onmouseenter="enter('5016458903510526292');" onmouseout="out('5016458903510526292');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1040         //通过join的查询字段信息过滤出需要的字段信息                                                                        </span>
<span class="5211893312708517501" onmouseenter="enter('5211893312708517501');" onmouseout="out('5211893312708517501');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1041         sideJoinFieldInfo.removeIf(tmpFieldInfo -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldInfo.getFieldName()) == null);">1041         sideJoinFieldInfo.removeIf(tmpFieldInfo -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldInfo🔵</abbr></span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1042                                                                                                          </span>
<span class="-1467815726997680818" onmouseenter="enter('-1467815726997680818');" onmouseout="out('-1467815726997680818');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1043         String leftTableAlias = joinInfo.getLeftTableAlias();                                            </span>
<span class="-6434853421912213287" onmouseenter="enter('-6434853421912213287');" onmouseout="out('-6434853421912213287');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1044         Table targetTable = localTableCache.get(leftTableAlias);                                         </span>
<span class="-6749372432358522016" onmouseenter="enter('-6749372432358522016');" onmouseout="out('-6749372432358522016');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1045         if(targetTable == null){                                                                         </span>
<span class="8734197217231436839" onmouseenter="enter('8734197217231436839');" onmouseout="out('8734197217231436839');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1046             targetTable = localTableCache.get(joinInfo.getLeftTableName());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1047         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1048                                                                                                          </span>
<span class="3450476289809538439" onmouseenter="enter('3450476289809538439');" onmouseout="out('3450476289809538439');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1049         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColumnNames());">1049         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema(🔵</abbr></span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1050                                                                                                          </span>
<span class="-3004779098663820792" onmouseenter="enter('-3004779098663820792');" onmouseout="out('-3004779098663820792');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1051         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.class)">1051         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.c🔵</abbr></span>
<span class="3479563451496228205" onmouseenter="enter('3479563451496228205');" onmouseout="out('3479563451496228205');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1052                 .map((Tuple2&lt;Boolean, Row&gt; tp2) -&gt; {                                                     </span>
<span class="7833906289428987345" onmouseenter="enter('7833906289428987345');" onmouseout="out('7833906289428987345');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1053                     return new CRow(tp2.f1, tp2.f0);                                                     </span>
<span class="-8730504840947162971" onmouseenter="enter('-8730504840947162971');" onmouseout="out('-8730504840947162971');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1054                 }).returns(CRow.class);                                                                  </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1055                                                                                                          </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1056                                                                                                          </span>
<span class="-6082173173678345991" onmouseenter="enter('-6082173173678345991');" onmouseout="out('-6082173173678345991');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1057         //join side table before keyby ===&gt; Reducing the size of each dimension table cache of async     </span>
<span class="6301552848628110191" onmouseenter="enter('6301552848628110191');" onmouseout="out('6301552848628110191');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1058         if (sideTableInfo.isPartitionedJoin()) {                                                         </span>
<span class="-4638861421651181765" onmouseenter="enter('-4638861421651181765');" onmouseout="out('-4638861421651181765');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1059             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(), sideTableInfo);">1059             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTa🔵</abbr></span>
<span class="-1086375650130423707" onmouseenter="enter('-1086375650130423707');" onmouseout="out('-1086375650130423707');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1060             List&lt;String&gt; fieldNames = Arrays.asList(targetTable.getSchema().getFieldNames());            </span>
<span class="2517152886952033206" onmouseenter="enter('2517152886952033206');" onmouseout="out('2517152886952033206');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1061             int[] keyIndex = leftJoinColList.stream().mapToInt(fieldNames::indexOf).toArray();           </span>
<span class="-7482412719932836963" onmouseenter="enter('-7482412719932836963');" onmouseout="out('-7482412719932836963');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1062             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.getSchema())));">1062             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, tar🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1063         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1064                                                                                                          </span>
<span class="-1065289666164106717" onmouseenter="enter('-1065289666164106717');" onmouseout="out('-1065289666164106717');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1065         DataStream&lt;CRow&gt; dsOut = null;                                                                   </span>
<span class="3901580925108094660" onmouseenter="enter('3901580925108094660');" onmouseout="out('3901580925108094660');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1066         if(ECacheType.ALL.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="7101184136852303035" onmouseenter="enter('7101184136852303035');" onmouseout="out('7101184136852303035');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1067             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1067             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), 🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1068         }else{                                                                                           </span>
<span class="7683243294616380271" onmouseenter="enter('7683243294616380271');" onmouseout="out('7683243294616380271');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="1069             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1069             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSq🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1070         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1071                                                                                                          </span>
<span class="2474148199265091642" onmouseenter="enter('2474148199265091642');" onmouseout="out('2474148199265091642');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1072         RowTypeInfo sideOutTypeInfo = buildOutRowTypeInfo(sideJoinFieldInfo, mappingTable);              </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1073                                                                                                          </span>
<span class="-1611735526649110750" onmouseenter="enter('-1611735526649110750');" onmouseout="out('-1611735526649110750');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1074         CRowTypeInfo cRowTypeInfo = new CRowTypeInfo(sideOutTypeInfo);                                   </span>
<span class="-4428554219841205830" onmouseenter="enter('-4428554219841205830');" onmouseout="out('-4428554219841205830');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1075         dsOut.getTransformation().setOutputType(cRowTypeInfo);                                           </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1076                                                                                                          </span>
<span class="4836712590888983064" onmouseenter="enter('4836712590888983064');" onmouseout="out('4836712590888983064');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1077         String targetTableName = joinInfo.getNewTableName();                                             </span>
<span class="-3094587764130774762" onmouseenter="enter('-3094587764130774762');" onmouseout="out('-3094587764130774762');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1078         String targetTableAlias = joinInfo.getNewTableAlias();                                           </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1079                                                                                                          </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1080         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1081         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="8710576405434192583" onmouseenter="enter('8710576405434192583');" onmouseout="out('8710576405434192583');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1082         replaceInfo.setTargetTableName(targetTableName);                                                 </span>
<span class="-6613112199475906839" onmouseenter="enter('-6613112199475906839');" onmouseout="out('-6613112199475906839');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1083         replaceInfo.setTargetTableAlias(targetTableAlias);                                               </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1084                                                                                                          </span>
<span class="1268462607712077740" onmouseenter="enter('1268462607712077740');" onmouseout="out('1268462607712077740');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1085         if (!tableEnv.isRegistered(joinInfo.getNewTableName())){                                         </span>
<span class="-9057257427162955657" onmouseenter="enter('-9057257427162955657');" onmouseout="out('-9057257427162955657');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1086             Table joinTable = tableEnv.fromDataStream(dsOut);                                            </span>
<span class="-7674974637599312088" onmouseenter="enter('-7674974637599312088');" onmouseout="out('-7674974637599312088');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1087             tableEnv.registerTable(joinInfo.getNewTableName(), joinTable);                               </span>
<span class="5569875846259576593" onmouseenter="enter('5569875846259576593');" onmouseout="out('5569875846259576593');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1088             localTableCache.put(joinInfo.getNewTableName(), joinTable);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1089         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">1090     }                                                                                                    </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">1091 ||||||| BASE                                                                                             </span>
<span class="4197581530070317287" onmouseenter="enter('4197581530070317287');" onmouseout="out('4197581530070317287');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1092     private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache,                             </span>
<span class="3515836699345174480" onmouseenter="enter('3515836699345174480');" onmouseout="out('3515836699345174480');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1093                          Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,       </span>
<span class="-2956355081691304387" onmouseenter="enter('-2956355081691304387');" onmouseout="out('-2956355081691304387');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1094                          List&lt;FieldReplaceInfo&gt; replaceInfoList) throws Exception{                       </span>
<span class="-3106951960183426296" onmouseenter="enter('-3106951960183426296');" onmouseout="out('-3106951960183426296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1095         JoinInfo joinInfo = (JoinInfo) pollObj;                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1096                                                                                                          </span>
<span class="-4580559439294190862" onmouseenter="enter('-4580559439294190862');" onmouseout="out('-4580559439294190862');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1097         JoinScope joinScope = new JoinScope();                                                           </span>
<span class="-6383140859888654083" onmouseenter="enter('-6383140859888654083');" onmouseout="out('-6383140859888654083');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1098         JoinScope.ScopeChild leftScopeChild = new JoinScope.ScopeChild();                                </span>
<span class="-5401707331330951256" onmouseenter="enter('-5401707331330951256');" onmouseout="out('-5401707331330951256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1099         leftScopeChild.setAlias(joinInfo.getLeftTableAlias());                                           </span>
<span class="5108424867732442426" onmouseenter="enter('5108424867732442426');" onmouseout="out('5108424867732442426');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1100         leftScopeChild.setTableName(joinInfo.getLeftTableName());                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1101                                                                                                          </span>
<span class="-3105793890099317611" onmouseenter="enter('-3105793890099317611');" onmouseout="out('-3105793890099317611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1102         SqlKind sqlKind = joinInfo.getLeftNode().getKind();                                              </span>
<span class="9064898697795185402" onmouseenter="enter('9064898697795185402');" onmouseout="out('9064898697795185402');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1103         if(sqlKind == AS){                                                                               </span>
<span class="17281975900406720" onmouseenter="enter('17281975900406720');" onmouseout="out('17281975900406720');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1104             dealAsSourceTable(tableEnv, joinInfo.getLeftNode(), localTableCache, replaceInfoList);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1105         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1106                                                                                                          </span>
<span class="-2402361542513321069" onmouseenter="enter('-2402361542513321069');" onmouseout="out('-2402361542513321069');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1107         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableName());">1107         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLe🔵</abbr></span>
<span class="5224542232803887157" onmouseenter="enter('5224542232803887157');" onmouseout="out('5224542232803887157');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1108         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColumnNames());">1108         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema(🔵</abbr></span>
<span class="-5303860989220332569" onmouseenter="enter('-5303860989220332569');" onmouseout="out('-5303860989220332569');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1109         leftScopeChild.setRowTypeInfo(leftTypeInfo);                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1110                                                                                                          </span>
<span class="3043795906382715340" onmouseenter="enter('3043795906382715340');" onmouseout="out('3043795906382715340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1111         JoinScope.ScopeChild rightScopeChild = new JoinScope.ScopeChild();                               </span>
<span class="2585249270397691815" onmouseenter="enter('2585249270397691815');" onmouseout="out('2585249270397691815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1112         rightScopeChild.setAlias(joinInfo.getRightTableAlias());                                         </span>
<span class="-5072747544386586876" onmouseenter="enter('-5072747544386586876');" onmouseout="out('-5072747544386586876');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1113         rightScopeChild.setTableName(joinInfo.getRightTableName());                                      </span>
<span class="-1752720370690577453" onmouseenter="enter('-1752720370690577453');" onmouseout="out('-1752720370690577453');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1114         SideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());                    </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1115         if(sideTableInfo == null){                                                                       </span>
<span class="-5396801098824602905" onmouseenter="enter('-5396801098824602905');" onmouseout="out('-5396801098824602905');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1116             sideTableInfo = sideTableMap.get(joinInfo.getRightTableAlias());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1117         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1118                                                                                                          </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1119         if(sideTableInfo == null){                                                                       </span>
<span class="450947362076537032" onmouseenter="enter('450947362076537032');" onmouseout="out('450947362076537032');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1120             throw new RuntimeException(&quot;can&#x27;t not find side table:&quot; + joinInfo.getRightTableName());     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1121         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1122                                                                                                          </span>
<span class="6668906180521634363" onmouseenter="enter('6668906180521634363');" onmouseout="out('6668906180521634363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1123 //        if(!checkJoinCondition(joinInfo.getCondition(), joinInfo.getRightTableAlias(), sideTableInfo)){</span>
<span class="2570085130586631416" onmouseenter="enter('2570085130586631416');" onmouseout="out('2570085130586631416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1124 //            throw new RuntimeException(&quot;ON condition must contain all equal fields!!!&quot;);               </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1125 //        }                                                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1126                                                                                                          </span>
<span class="-1562873445908102884" onmouseenter="enter('-1562873445908102884');" onmouseout="out('-1562873445908102884');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1127         rightScopeChild.setRowTypeInfo(sideTableInfo.getRowTypeInfo());                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1128                                                                                                          </span>
<span class="-5776192160472100987" onmouseenter="enter('-5776192160472100987');" onmouseout="out('-5776192160472100987');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1129         joinScope.addScope(leftScopeChild);                                                              </span>
<span class="6805588345897841594" onmouseenter="enter('6805588345897841594');" onmouseout="out('6805588345897841594');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1130         joinScope.addScope(rightScopeChild);                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1131                                                                                                          </span>
<span class="-816440763270240777" onmouseenter="enter('-816440763270240777');" onmouseout="out('-816440763270240777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1132         //获取两个表的所有字段                                                                                     </span>
<span class="-6198283029075022684" onmouseenter="enter('-6198283029075022684');" onmouseout="out('-6198283029075022684');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1133         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, true);">1133         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), join🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1134                                                                                                          </span>
<span class="-1467815726997680818" onmouseenter="enter('-1467815726997680818');" onmouseout="out('-1467815726997680818');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1135         String leftTableAlias = joinInfo.getLeftTableAlias();                                            </span>
<span class="-6434853421912213287" onmouseenter="enter('-6434853421912213287');" onmouseout="out('-6434853421912213287');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1136         Table targetTable = localTableCache.get(leftTableAlias);                                         </span>
<span class="-6749372432358522016" onmouseenter="enter('-6749372432358522016');" onmouseout="out('-6749372432358522016');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1137         if(targetTable == null){                                                                         </span>
<span class="8734197217231436839" onmouseenter="enter('8734197217231436839');" onmouseout="out('8734197217231436839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1138             targetTable = localTableCache.get(joinInfo.getLeftTableName());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1139         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1140                                                                                                          </span>
<span class="3450476289809538439" onmouseenter="enter('3450476289809538439');" onmouseout="out('3450476289809538439');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1141         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColumnNames());">1141         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema(🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1142                                                                                                          </span>
<span class="-3004779098663820792" onmouseenter="enter('-3004779098663820792');" onmouseout="out('-3004779098663820792');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1143         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.class)">1143         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.c🔵</abbr></span>
<span class="3479563451496228205" onmouseenter="enter('3479563451496228205');" onmouseout="out('3479563451496228205');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1144                 .map((Tuple2&lt;Boolean, Row&gt; tp2) -&gt; {                                                     </span>
<span class="7833906289428987345" onmouseenter="enter('7833906289428987345');" onmouseout="out('7833906289428987345');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1145                     return new CRow(tp2.f1, tp2.f0);                                                     </span>
<span class="-8730504840947162971" onmouseenter="enter('-8730504840947162971');" onmouseout="out('-8730504840947162971');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1146                 }).returns(CRow.class);                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1147                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1148                                                                                                          </span>
<span class="-6082173173678345991" onmouseenter="enter('-6082173173678345991');" onmouseout="out('-6082173173678345991');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1149         //join side table before keyby ===&gt; Reducing the size of each dimension table cache of async     </span>
<span class="6301552848628110191" onmouseenter="enter('6301552848628110191');" onmouseout="out('6301552848628110191');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1150         if (sideTableInfo.isPartitionedJoin()) {                                                         </span>
<span class="-4638861421651181765" onmouseenter="enter('-4638861421651181765');" onmouseout="out('-4638861421651181765');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1151             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(), sideTableInfo);">1151             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTa🔵</abbr></span>
<span class="-1086375650130423707" onmouseenter="enter('-1086375650130423707');" onmouseout="out('-1086375650130423707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1152             List&lt;String&gt; fieldNames = Arrays.asList(targetTable.getSchema().getFieldNames());            </span>
<span class="2517152886952033206" onmouseenter="enter('2517152886952033206');" onmouseout="out('2517152886952033206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1153             int[] keyIndex = leftJoinColList.stream().mapToInt(fieldNames::indexOf).toArray();           </span>
<span class="-7482412719932836963" onmouseenter="enter('-7482412719932836963');" onmouseout="out('-7482412719932836963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1154             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.getSchema())));">1154             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, tar🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1155         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1156                                                                                                          </span>
<span class="-1065289666164106717" onmouseenter="enter('-1065289666164106717');" onmouseout="out('-1065289666164106717');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1157         DataStream&lt;CRow&gt; dsOut = null;                                                                   </span>
<span class="3901580925108094660" onmouseenter="enter('3901580925108094660');" onmouseout="out('3901580925108094660');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1158         if(ECacheType.ALL.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="7101184136852303035" onmouseenter="enter('7101184136852303035');" onmouseout="out('7101184136852303035');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1159             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1159             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), 🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1160         }else{                                                                                           </span>
<span class="7683243294616380271" onmouseenter="enter('7683243294616380271');" onmouseout="out('7683243294616380271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="1161             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1161             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSq🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1162         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1163                                                                                                          </span>
<span class="1587039608171825646" onmouseenter="enter('1587039608171825646');" onmouseout="out('1587039608171825646');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1164         // TODO  将嵌套表中的字段传递过去, 去除冗余的ROWtime                                                              </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1165         HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                   </span>
<span class="2474148199265091642" onmouseenter="enter('2474148199265091642');" onmouseout="out('2474148199265091642');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1166         RowTypeInfo sideOutTypeInfo = buildOutRowTypeInfo(sideJoinFieldInfo, mappingTable);              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1167                                                                                                          </span>
<span class="-1611735526649110750" onmouseenter="enter('-1611735526649110750');" onmouseout="out('-1611735526649110750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1168         CRowTypeInfo cRowTypeInfo = new CRowTypeInfo(sideOutTypeInfo);                                   </span>
<span class="-4428554219841205830" onmouseenter="enter('-4428554219841205830');" onmouseout="out('-4428554219841205830');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1169         dsOut.getTransformation().setOutputType(cRowTypeInfo);                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1170                                                                                                          </span>
<span class="4836712590888983064" onmouseenter="enter('4836712590888983064');" onmouseout="out('4836712590888983064');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1171         String targetTableName = joinInfo.getNewTableName();                                             </span>
<span class="-3094587764130774762" onmouseenter="enter('-3094587764130774762');" onmouseout="out('-3094587764130774762');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1172         String targetTableAlias = joinInfo.getNewTableAlias();                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1173                                                                                                          </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1174         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1175         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="8710576405434192583" onmouseenter="enter('8710576405434192583');" onmouseout="out('8710576405434192583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1176         replaceInfo.setTargetTableName(targetTableName);                                                 </span>
<span class="-6613112199475906839" onmouseenter="enter('-6613112199475906839');" onmouseout="out('-6613112199475906839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1177         replaceInfo.setTargetTableAlias(targetTableAlias);                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1178                                                                                                          </span>
<span class="-3207655655806857927" onmouseenter="enter('-3207655655806857927');" onmouseout="out('-3207655655806857927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1179         //判断之前是不是被替换过,被替换过则设置之前的替换信息作为上一个节点                                                              </span>
<span class="3962421982275373463" onmouseenter="enter('3962421982275373463');" onmouseout="out('3962421982275373463');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1180         for(FieldReplaceInfo tmp : replaceInfoList){                                                     </span>
<span class="6967693276121741260" onmouseenter="enter('6967693276121741260');" onmouseout="out('6967693276121741260');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1181             if(tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableName())                    </span>
<span class="8344413733256472211" onmouseenter="enter('8344413733256472211');" onmouseout="out('8344413733256472211');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1182             ||tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableAlias())){                  </span>
<span class="-1629804985910745096" onmouseenter="enter('-1629804985910745096');" onmouseout="out('-1629804985910745096');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1183                 replaceInfo.setPreNode(tmp);                                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1184                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1185             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1186         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1187                                                                                                          </span>
<span class="2528453225163613561" onmouseenter="enter('2528453225163613561');" onmouseout="out('2528453225163613561');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1188         replaceInfoList.add(replaceInfo);                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1189                                                                                                          </span>
<span class="1268462607712077740" onmouseenter="enter('1268462607712077740');" onmouseout="out('1268462607712077740');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1190         if (!tableEnv.isRegistered(joinInfo.getNewTableName())){                                         </span>
<span class="-9057257427162955657" onmouseenter="enter('-9057257427162955657');" onmouseout="out('-9057257427162955657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1191             Table joinTable = tableEnv.fromDataStream(dsOut);                                            </span>
<span class="-7674974637599312088" onmouseenter="enter('-7674974637599312088');" onmouseout="out('-7674974637599312088');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1192             tableEnv.registerTable(joinInfo.getNewTableName(), joinTable);                               </span>
<span class="5569875846259576593" onmouseenter="enter('5569875846259576593');" onmouseout="out('5569875846259576593');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1193             localTableCache.put(joinInfo.getNewTableName(), joinTable);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1194         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">1195     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">1196 =======                                                                                                  </span>
<span class="4197581530070317287" onmouseenter="enter('4197581530070317287');" onmouseout="out('4197581530070317287');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1197     private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache,                             </span>
<span class="-7423850058561480692" onmouseenter="enter('-7423850058561480692');" onmouseout="out('-7423850058561480692');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1198                          Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,">1198                          Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv🔵</abbr></span>
<span class="-2956355081691304387" onmouseenter="enter('-2956355081691304387');" onmouseout="out('-2956355081691304387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1199                          List&lt;FieldReplaceInfo&gt; replaceInfoList) throws Exception{                       </span>
<span class="-3106951960183426296" onmouseenter="enter('-3106951960183426296');" onmouseout="out('-3106951960183426296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1200         JoinInfo joinInfo = (JoinInfo) pollObj;                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1201                                                                                                          </span>
<span class="-4580559439294190862" onmouseenter="enter('-4580559439294190862');" onmouseout="out('-4580559439294190862');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1202         JoinScope joinScope = new JoinScope();                                                           </span>
<span class="-6383140859888654083" onmouseenter="enter('-6383140859888654083');" onmouseout="out('-6383140859888654083');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1203         JoinScope.ScopeChild leftScopeChild = new JoinScope.ScopeChild();                                </span>
<span class="-5401707331330951256" onmouseenter="enter('-5401707331330951256');" onmouseout="out('-5401707331330951256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1204         leftScopeChild.setAlias(joinInfo.getLeftTableAlias());                                           </span>
<span class="5108424867732442426" onmouseenter="enter('5108424867732442426');" onmouseout="out('5108424867732442426');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1205         leftScopeChild.setTableName(joinInfo.getLeftTableName());                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1206                                                                                                          </span>
<span class="-3105793890099317611" onmouseenter="enter('-3105793890099317611');" onmouseout="out('-3105793890099317611');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1207         SqlKind sqlKind = joinInfo.getLeftNode().getKind();                                              </span>
<span class="9064898697795185402" onmouseenter="enter('9064898697795185402');" onmouseout="out('9064898697795185402');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1208         if(sqlKind == AS){                                                                               </span>
<span class="17281975900406720" onmouseenter="enter('17281975900406720');" onmouseout="out('17281975900406720');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1209             dealAsSourceTable(tableEnv, joinInfo.getLeftNode(), localTableCache, replaceInfoList);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1210         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1211                                                                                                          </span>
<span class="-2402361542513321069" onmouseenter="enter('-2402361542513321069');" onmouseout="out('-2402361542513321069');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1212         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableName());">1212         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLe🔵</abbr></span>
<span class="5224542232803887157" onmouseenter="enter('5224542232803887157');" onmouseout="out('5224542232803887157');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1213         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColumnNames());">1213         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema(🔵</abbr></span>
<span class="-5303860989220332569" onmouseenter="enter('-5303860989220332569');" onmouseout="out('-5303860989220332569');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1214         leftScopeChild.setRowTypeInfo(leftTypeInfo);                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1215                                                                                                          </span>
<span class="3043795906382715340" onmouseenter="enter('3043795906382715340');" onmouseout="out('3043795906382715340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1216         JoinScope.ScopeChild rightScopeChild = new JoinScope.ScopeChild();                               </span>
<span class="2585249270397691815" onmouseenter="enter('2585249270397691815');" onmouseout="out('2585249270397691815');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1217         rightScopeChild.setAlias(joinInfo.getRightTableAlias());                                         </span>
<span class="-5072747544386586876" onmouseenter="enter('-5072747544386586876');" onmouseout="out('-5072747544386586876');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1218         rightScopeChild.setTableName(joinInfo.getRightTableName());                                      </span>
<span class="-6382774479188932768" onmouseenter="enter('-6382774479188932768');" onmouseout="out('-6382774479188932768');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1219         AbstractSideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());            </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1220         if(sideTableInfo == null){                                                                       </span>
<span class="-5396801098824602905" onmouseenter="enter('-5396801098824602905');" onmouseout="out('-5396801098824602905');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1221             sideTableInfo = sideTableMap.get(joinInfo.getRightTableAlias());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1222         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1223                                                                                                          </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1224         if(sideTableInfo == null){                                                                       </span>
<span class="450947362076537032" onmouseenter="enter('450947362076537032');" onmouseout="out('450947362076537032');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1225             throw new RuntimeException(&quot;can&#x27;t not find side table:&quot; + joinInfo.getRightTableName());     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1226         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1227                                                                                                          </span>
<span class="6668906180521634363" onmouseenter="enter('6668906180521634363');" onmouseout="out('6668906180521634363');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1228 //        if(!checkJoinCondition(joinInfo.getCondition(), joinInfo.getRightTableAlias(), sideTableInfo)){</span>
<span class="2570085130586631416" onmouseenter="enter('2570085130586631416');" onmouseout="out('2570085130586631416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1229 //            throw new RuntimeException(&quot;ON condition must contain all equal fields!!!&quot;);               </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1230 //        }                                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1231                                                                                                          </span>
<span class="-1562873445908102884" onmouseenter="enter('-1562873445908102884');" onmouseout="out('-1562873445908102884');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1232         rightScopeChild.setRowTypeInfo(sideTableInfo.getRowTypeInfo());                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1233                                                                                                          </span>
<span class="-5776192160472100987" onmouseenter="enter('-5776192160472100987');" onmouseout="out('-5776192160472100987');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1234         joinScope.addScope(leftScopeChild);                                                              </span>
<span class="6805588345897841594" onmouseenter="enter('6805588345897841594');" onmouseout="out('6805588345897841594');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1235         joinScope.addScope(rightScopeChild);                                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1236                                                                                                          </span>
<span class="-816440763270240777" onmouseenter="enter('-816440763270240777');" onmouseout="out('-816440763270240777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1237         //获取两个表的所有字段                                                                                     </span>
<span class="-6198283029075022684" onmouseenter="enter('-6198283029075022684');" onmouseout="out('-6198283029075022684');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1238         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, true);">1238         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), join🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1239                                                                                                          </span>
<span class="-1467815726997680818" onmouseenter="enter('-1467815726997680818');" onmouseout="out('-1467815726997680818');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1240         String leftTableAlias = joinInfo.getLeftTableAlias();                                            </span>
<span class="-6434853421912213287" onmouseenter="enter('-6434853421912213287');" onmouseout="out('-6434853421912213287');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1241         Table targetTable = localTableCache.get(leftTableAlias);                                         </span>
<span class="-6749372432358522016" onmouseenter="enter('-6749372432358522016');" onmouseout="out('-6749372432358522016');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1242         if(targetTable == null){                                                                         </span>
<span class="8734197217231436839" onmouseenter="enter('8734197217231436839');" onmouseout="out('8734197217231436839');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1243             targetTable = localTableCache.get(joinInfo.getLeftTableName());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1244         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1245                                                                                                          </span>
<span class="3450476289809538439" onmouseenter="enter('3450476289809538439');" onmouseout="out('3450476289809538439');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1246         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColumnNames());">1246         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema(🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1247                                                                                                          </span>
<span class="-3004779098663820792" onmouseenter="enter('-3004779098663820792');" onmouseout="out('-3004779098663820792');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1248         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.class)">1248         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.c🔵</abbr></span>
<span class="3479563451496228205" onmouseenter="enter('3479563451496228205');" onmouseout="out('3479563451496228205');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1249                 .map((Tuple2&lt;Boolean, Row&gt; tp2) -&gt; {                                                     </span>
<span class="7833906289428987345" onmouseenter="enter('7833906289428987345');" onmouseout="out('7833906289428987345');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1250                     return new CRow(tp2.f1, tp2.f0);                                                     </span>
<span class="-8730504840947162971" onmouseenter="enter('-8730504840947162971');" onmouseout="out('-8730504840947162971');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1251                 }).returns(CRow.class);                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1252                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1253                                                                                                          </span>
<span class="-6082173173678345991" onmouseenter="enter('-6082173173678345991');" onmouseout="out('-6082173173678345991');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1254         //join side table before keyby ===&gt; Reducing the size of each dimension table cache of async     </span>
<span class="6301552848628110191" onmouseenter="enter('6301552848628110191');" onmouseout="out('6301552848628110191');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1255         if (sideTableInfo.isPartitionedJoin()) {                                                         </span>
<span class="-4638861421651181765" onmouseenter="enter('-4638861421651181765');" onmouseout="out('-4638861421651181765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1256             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(), sideTableInfo);">1256             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTa🔵</abbr></span>
<span class="-1086375650130423707" onmouseenter="enter('-1086375650130423707');" onmouseout="out('-1086375650130423707');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1257             List&lt;String&gt; fieldNames = Arrays.asList(targetTable.getSchema().getFieldNames());            </span>
<span class="2517152886952033206" onmouseenter="enter('2517152886952033206');" onmouseout="out('2517152886952033206');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1258             int[] keyIndex = leftJoinColList.stream().mapToInt(fieldNames::indexOf).toArray();           </span>
<span class="-7482412719932836963" onmouseenter="enter('-7482412719932836963');" onmouseout="out('-7482412719932836963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1259             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.getSchema())));">1259             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, tar🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1260         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1261                                                                                                          </span>
<span class="-1065289666164106717" onmouseenter="enter('-1065289666164106717');" onmouseout="out('-1065289666164106717');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1262         DataStream&lt;CRow&gt; dsOut = null;                                                                   </span>
<span class="3901580925108094660" onmouseenter="enter('3901580925108094660');" onmouseout="out('3901580925108094660');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1263         if(ECacheType.ALL.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="7101184136852303035" onmouseenter="enter('7101184136852303035');" onmouseout="out('7101184136852303035');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1264             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1264             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), 🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1265         }else{                                                                                           </span>
<span class="7683243294616380271" onmouseenter="enter('7683243294616380271');" onmouseout="out('7683243294616380271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="1266             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);">1266             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSq🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1267         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1268                                                                                                          </span>
<span class="1587039608171825646" onmouseenter="enter('1587039608171825646');" onmouseout="out('1587039608171825646');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1269         // TODO  将嵌套表中的字段传递过去, 去除冗余的ROWtime                                                              </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1270         HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                   </span>
<span class="2474148199265091642" onmouseenter="enter('2474148199265091642');" onmouseout="out('2474148199265091642');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1271         RowTypeInfo sideOutTypeInfo = buildOutRowTypeInfo(sideJoinFieldInfo, mappingTable);              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1272                                                                                                          </span>
<span class="-1611735526649110750" onmouseenter="enter('-1611735526649110750');" onmouseout="out('-1611735526649110750');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1273         CRowTypeInfo cRowTypeInfo = new CRowTypeInfo(sideOutTypeInfo);                                   </span>
<span class="-4428554219841205830" onmouseenter="enter('-4428554219841205830');" onmouseout="out('-4428554219841205830');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1274         dsOut.getTransformation().setOutputType(cRowTypeInfo);                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1275                                                                                                          </span>
<span class="4836712590888983064" onmouseenter="enter('4836712590888983064');" onmouseout="out('4836712590888983064');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1276         String targetTableName = joinInfo.getNewTableName();                                             </span>
<span class="-3094587764130774762" onmouseenter="enter('-3094587764130774762');" onmouseout="out('-3094587764130774762');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1277         String targetTableAlias = joinInfo.getNewTableAlias();                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1278                                                                                                          </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1279         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1280         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="8710576405434192583" onmouseenter="enter('8710576405434192583');" onmouseout="out('8710576405434192583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1281         replaceInfo.setTargetTableName(targetTableName);                                                 </span>
<span class="-6613112199475906839" onmouseenter="enter('-6613112199475906839');" onmouseout="out('-6613112199475906839');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1282         replaceInfo.setTargetTableAlias(targetTableAlias);                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1283                                                                                                          </span>
<span class="-3207655655806857927" onmouseenter="enter('-3207655655806857927');" onmouseout="out('-3207655655806857927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1284         //判断之前是不是被替换过,被替换过则设置之前的替换信息作为上一个节点                                                              </span>
<span class="3962421982275373463" onmouseenter="enter('3962421982275373463');" onmouseout="out('3962421982275373463');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1285         for(FieldReplaceInfo tmp : replaceInfoList){                                                     </span>
<span class="6967693276121741260" onmouseenter="enter('6967693276121741260');" onmouseout="out('6967693276121741260');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1286             if(tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableName())                    </span>
<span class="8344413733256472211" onmouseenter="enter('8344413733256472211');" onmouseout="out('8344413733256472211');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1287             ||tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableAlias())){                  </span>
<span class="-1629804985910745096" onmouseenter="enter('-1629804985910745096');" onmouseout="out('-1629804985910745096');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1288                 replaceInfo.setPreNode(tmp);                                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1289                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1290             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1291         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1292                                                                                                          </span>
<span class="2528453225163613561" onmouseenter="enter('2528453225163613561');" onmouseout="out('2528453225163613561');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1293         replaceInfoList.add(replaceInfo);                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1294                                                                                                          </span>
<span class="1268462607712077740" onmouseenter="enter('1268462607712077740');" onmouseout="out('1268462607712077740');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1295         if (!tableEnv.isRegistered(joinInfo.getNewTableName())){                                         </span>
<span class="-9057257427162955657" onmouseenter="enter('-9057257427162955657');" onmouseout="out('-9057257427162955657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1296             Table joinTable = tableEnv.fromDataStream(dsOut);                                            </span>
<span class="-7674974637599312088" onmouseenter="enter('-7674974637599312088');" onmouseout="out('-7674974637599312088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1297             tableEnv.registerTable(joinInfo.getNewTableName(), joinTable);                               </span>
<span class="5569875846259576593" onmouseenter="enter('5569875846259576593');" onmouseout="out('5569875846259576593');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1298             localTableCache.put(joinInfo.getNewTableName(), joinTable);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1299         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1300     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">1301 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style="">1302                                                                                                          </span>
<span class="2503560481488678812" onmouseenter="enter('2503560481488678812');" onmouseout="out('2503560481488678812');" style="">1303     private TypeInformation&lt;Row&gt; projectedTypeInfo(int[] fields, TableSchema schema) {                   </span>
<span class="-934325254904626531" onmouseenter="enter('-934325254904626531');" onmouseout="out('-934325254904626531');" style="">1304         String[] fieldNames = schema.getFieldNames();                                                    </span>
<span class="4556717060829301814" onmouseenter="enter('4556717060829301814');" onmouseout="out('4556717060829301814');" style="">1305         TypeInformation&lt;?&gt;[] fieldTypes = schema.getFieldTypes();                                        </span>
<span  style="">1306                                                                                                          </span>
<span class="424178526470659793" onmouseenter="enter('424178526470659793');" onmouseout="out('424178526470659793');" style=""><abbr title="1307         String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::new);">1307         String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::ne🔵</abbr></span>
<span class="5411397013359382914" onmouseenter="enter('5411397013359382914');" onmouseout="out('5411397013359382914');" style=""><abbr title="1308         TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(TypeInformation[]::new);">1308         TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(Typ🔵</abbr></span>
<span class="-5627838059420262860" onmouseenter="enter('-5627838059420262860');" onmouseout="out('-5627838059420262860');" style="">1309         return new RowTypeInfo(projectedTypes, projectedNames);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1310     }                                                                                                    </span>
<span  style="">1311                                                                                                          </span>
<span  style="">1312                                                                                                          </span>
<span class="-410103274617159114" onmouseenter="enter('-410103274617159114');" onmouseout="out('-410103274617159114');" style="">1313     private boolean checkFieldsInfo(CreateTmpTableParser.SqlParserResult result, Table table) {          </span>
<span class="8925867441251499081" onmouseenter="enter('8925867441251499081');" onmouseout="out('8925867441251499081');" style="">1314         List&lt;String&gt; fieldNames = new LinkedList&lt;&gt;();                                                    </span>
<span class="-5553816012496774052" onmouseenter="enter('-5553816012496774052');" onmouseout="out('-5553816012496774052');" style="">1315         String fieldsInfo = result.getFieldsInfoStr();                                                   </span>
<span class="-5855731071361337066" onmouseenter="enter('-5855731071361337066');" onmouseout="out('-5855731071361337066');" style="">1316         String[] fields = StringUtils.split(fieldsInfo, &quot;,&quot;);                                            </span>
<span class="8167763809890058258" onmouseenter="enter('8167763809890058258');" onmouseout="out('8167763809890058258');" style="">1317         for (int i = 0; i &lt; fields.length; i++) {                                                        </span>
<span class="2947314498030065040" onmouseenter="enter('2947314498030065040');" onmouseout="out('2947314498030065040');" style="">1318             String[] filed = fields[i].split(&quot;\\s&quot;);                                                     </span>
<span class="-1166806966413379737" onmouseenter="enter('-1166806966413379737');" onmouseout="out('-1166806966413379737');" style="">1319             if (filed.length &lt; 2 || fields.length != table.getSchema().getColumnNames().length){         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1320                 return false;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1321             } else {                                                                                     </span>
<span class="-7518627407039835792" onmouseenter="enter('-7518627407039835792');" onmouseout="out('-7518627407039835792');" style="">1322                 String[] filedNameArr = new String[filed.length - 1];                                    </span>
<span class="6064994574122217386" onmouseenter="enter('6064994574122217386');" onmouseout="out('6064994574122217386');" style="">1323                 System.arraycopy(filed, 0, filedNameArr, 0, filed.length - 1);                           </span>
<span class="-3029457015937137256" onmouseenter="enter('-3029457015937137256');" onmouseout="out('-3029457015937137256');" style="">1324                 String fieldName = String.join(&quot; &quot;, filedNameArr);                                       </span>
<span class="-8037943253867791720" onmouseenter="enter('-8037943253867791720');" onmouseout="out('-8037943253867791720');" style="">1325                 fieldNames.add(fieldName);                                                               </span>
<span class="516386479555957316" onmouseenter="enter('516386479555957316');" onmouseout="out('516386479555957316');" style="">1326                 String fieldType = filed[filed.length - 1 ].trim();                                      </span>
<span class="-8511761590344571010" onmouseenter="enter('-8511761590344571010');" onmouseout="out('-8511761590344571010');" style="">1327                 Class fieldClass = ClassUtil.stringConvertClass(fieldType);                              </span>
<span class="-351203522969775469" onmouseenter="enter('-351203522969775469');" onmouseout="out('-351203522969775469');" style="">1328                 Class tableField = table.getSchema().getFieldType(i).get().getTypeClass();               </span>
<span class="9126336856345087988" onmouseenter="enter('9126336856345087988');" onmouseout="out('9126336856345087988');" style="">1329                 if (fieldClass == tableField){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1330                     continue;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1331                 } else {                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1332                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1333                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1334             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1335         }                                                                                                </span>
<span class="-7181802501759976675" onmouseenter="enter('-7181802501759976675');" onmouseout="out('-7181802501759976675');" style="">1336         tmpFields = String.join(&quot;,&quot;, fieldNames);                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">1337         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1338     }                                                                                                    </span>
<span  style="">1339                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1340 }                                                                                                        </span>





































































































































































































































































































































































































































































































































































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  18 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  20 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="">  21 import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                          </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="">  22 import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                </span>
<span class="7697893187981436175" onmouseenter="enter('7697893187981436175');" onmouseout="out('7697893187981436175');" style="">  23 import com.dtstack.flink.sql.side.operator.SideAsyncOperator;                                            </span>
<span class="-7456990469468101750" onmouseenter="enter('-7456990469468101750');" onmouseout="out('-7456990469468101750');" style="">  24 import com.dtstack.flink.sql.side.operator.SideWithAllCacheOperator;                                     </span>
<span class="4874498590411064411" onmouseenter="enter('4874498590411064411');" onmouseout="out('4874498590411064411');" style="">  25 import com.dtstack.flink.sql.util.ClassUtil;                                                             </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  26 import com.dtstack.flink.sql.util.ParseUtils;                                                            </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  27 import com.dtstack.flink.sql.util.TableUtils;                                                            </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  28 import com.google.common.base.Preconditions;                                                             </span>
<span class="1793459060364841943" onmouseenter="enter('1793459060364841943');" onmouseout="out('1793459060364841943');" style="">  29 import com.google.common.collect.*;                                                                      </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  30 import java.sql.Timestamp;                                                                               </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  31 import java.util.Arrays;                                                                                 </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  32 import java.util.Collection;                                                                             </span>
<span class="2644117295780670879" onmouseenter="enter('2644117295780670879');" onmouseout="out('2644117295780670879');" style="">  33 import java.util.LinkedList;                                                                             </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  34 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  35 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  36 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  37 import java.util.Set;                                                                                    </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  38 import org.apache.calcite.sql.SqlAsOperator;                                                             </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  39 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  40 import org.apache.calcite.sql.SqlDataTypeSpec;                                                           </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  41 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  42 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  43 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  44 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  45 import org.apache.calcite.sql.SqlLiteral;                                                                </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  46 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  47 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  48 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  49 import org.apache.calcite.sql.SqlOrderBy;                                                                </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  50 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  51 import org.apache.calcite.sql.SqlWithItem;                                                               </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  52 import org.apache.calcite.sql.fun.SqlCase;                                                               </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  53 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  54 import org.apache.calcite.sql.parser.SqlParserPos;                                                       </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  55 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  56 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  57 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  58 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  59 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="">  60 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="">  61 import org.apache.flink.table.api.StreamQueryConfig;                                                     </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  62 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-8888728238394280005" onmouseenter="enter('-8888728238394280005');" onmouseout="out('-8888728238394280005');" style="">  63 import org.apache.flink.table.api.TableSchema;                                                           </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="">  64 import org.apache.flink.table.api.java.StreamTableEnvironment;                                           </span>
<span class="-6266446094177003082" onmouseenter="enter('-6266446094177003082');" onmouseout="out('-6266446094177003082');" style="">  65 import org.apache.flink.table.runtime.CRowKeySelector;                                                   </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  66 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="5605277811729025111" onmouseenter="enter('5605277811729025111');" onmouseout="out('5605277811729025111');" style="">  67 import org.apache.flink.table.runtime.types.CRowTypeInfo;                                                </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  68 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  69 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  70 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  71 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  72 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span  style="">  73                                                                                                          </span>
<span  style="">  74                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  75 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  76  * Reason:                                                                                               </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  77  * Date: 2018/7/24                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  78  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  79  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80  */                                                                                                      </span>
<span class="-5079038956292767116" onmouseenter="enter('-5079038956292767116');" onmouseout="out('-5079038956292767116');" style="">  81 public class SideSqlExec {                                                                               </span>
<span class="-8991898280301588076" onmouseenter="enter('-8991898280301588076');" onmouseout="out('-8991898280301588076');" style="">  82     private static final Logger LOG = LoggerFactory.getLogger(SideSqlExec.class);                        </span>
<span  style="">  83                                                                                                          </span>
<span class="-6334022460956670337" onmouseenter="enter('-6334022460956670337');" onmouseout="out('-6334022460956670337');" style="">  84     private String localSqlPluginPath = null;                                                            </span>
<span  style="">  85                                                                                                          </span>
<span class="-863593709646632598" onmouseenter="enter('-863593709646632598');" onmouseout="out('-863593709646632598');" style="">  86     private String tmpFields = null;                                                                     </span>
<span  style="">  87                                                                                                          </span>
<span class="8878309237265342483" onmouseenter="enter('8878309237265342483');" onmouseout="out('8878309237265342483');" style="">  88     private SidePredicatesParser sidePredicatesParser = new SidePredicatesParser();                      </span>
<span  style="">  89                                                                                                          </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  90     private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                      </span>
<span  style="">  91                                                                                                          </span>
<span class="-5528362515094514724" onmouseenter="enter('-5528362515094514724');" onmouseout="out('-5528362515094514724');" style=""><abbr title="  92     public void exec(String sql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv, Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserResult createView) throws Exception {">  92     public void exec(String sql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment 🔵</abbr></span>
<span class="-8459786232159972392" onmouseenter="enter('-8459786232159972392');" onmouseout="out('-8459786232159972392');" style="">  93         if (localSqlPluginPath == null) {                                                                </span>
<span class="4243357528698157424" onmouseenter="enter('4243357528698157424');" onmouseout="out('4243357528698157424');" style="">  94             throw new RuntimeException(&quot;need to set localSqlPluginPath&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95         }                                                                                                </span>
<span class="-6307578536739293325" onmouseenter="enter('-6307578536739293325');" onmouseout="out('-6307578536739293325');" style="">  96         localTableCache.putAll(tableCache);                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  97         try {                                                                                            </span>
<span class="-7778408363768085476" onmouseenter="enter('-7778408363768085476');" onmouseout="out('-7778408363768085476');" style="">  98             sidePredicatesParser.fillPredicatesForSideTable(sql, sideTableMap);                          </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style="">  99         } catch (java.lang.Exception e) {                                                                </span>
<span class="-6535415982741029210" onmouseenter="enter('-6535415982741029210');" onmouseout="out('-6535415982741029210');" style=""> 100             LOG.error(&quot;fill predicates for sideTable fail &quot;, e);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101         }                                                                                                </span>
<span class="-2666540822034943406" onmouseenter="enter('-2666540822034943406');" onmouseout="out('-2666540822034943406');" style=""> 102         if (createView != null) {                                                                        </span>
<span class="-5051922790285322929" onmouseenter="enter('-5051922790285322929');" onmouseout="out('-5051922790285322929');" style=""> 103             LOG.warn(&quot;create view info\n&quot;);                                                              </span>
<span class="4994977519661454238" onmouseenter="enter('4994977519661454238');" onmouseout="out('4994977519661454238');" style=""> 104             LOG.warn(createView.getExecSql());                                                           </span>
<span class="-6048507734051622776" onmouseenter="enter('-6048507734051622776');" onmouseout="out('-6048507734051622776');" style=""> 105             LOG.warn(&quot;-----------------&quot;);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106         }                                                                                                </span>
<span class="3272289589011229925" onmouseenter="enter('3272289589011229925');" onmouseout="out('3272289589011229925');" style=""> 107         SideSQLParser sideSQLParser = new SideSQLParser();                                               </span>
<span class="9221221341975786732" onmouseenter="enter('9221221341975786732');" onmouseout="out('9221221341975786732');" style=""> 108         sideSQLParser.setLocalTableCache(localTableCache);                                               </span>
<span class="-1577132173025596093" onmouseenter="enter('-1577132173025596093');" onmouseout="out('-1577132173025596093');" style=""> 109         Queue&lt;Object&gt; exeQueue = sideSQLParser.getExeQueue(sql, sideTableMap.keySet());                  </span>
<span class="1917635497637273504" onmouseenter="enter('1917635497637273504');" onmouseout="out('1917635497637273504');" style=""> 110         Object pollObj = null;                                                                           </span>
<span class="-5058340944145416275" onmouseenter="enter('-5058340944145416275');" onmouseout="out('-5058340944145416275');" style=""> 111         while ((pollObj = exeQueue.poll()) != null) {                                                    </span>
<span class="-2443216094467354180" onmouseenter="enter('-2443216094467354180');" onmouseout="out('-2443216094467354180');" style=""> 112             if (pollObj instanceof SqlNode) {                                                            </span>
<span class="-7928777679656459385" onmouseenter="enter('-7928777679656459385');" onmouseout="out('-7928777679656459385');" style=""> 113                 SqlNode pollSqlNode = ((SqlNode) (pollObj));                                             </span>
<span class="-1675849540725983142" onmouseenter="enter('-1675849540725983142');" onmouseout="out('-1675849540725983142');" style=""> 114                 if (pollSqlNode.getKind() == INSERT) {                                                   </span>
<span class="-7041171683301857607" onmouseenter="enter('-7041171683301857607');" onmouseout="out('-7041171683301857607');" style=""> 115                     FlinkSQLExec.sqlUpdate(tableEnv, pollSqlNode.toString(), queryConfig);               </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 116                     if (LOG.isInfoEnabled()) {                                                           </span>
<span class="-5986232783970891998" onmouseenter="enter('-5986232783970891998');" onmouseout="out('-5986232783970891998');" style=""> 117                         LOG.info(&quot;----------real exec sql-----------\n{}&quot;, pollSqlNode.toString());      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118                     }                                                                                    </span>
<span class="-2457059581629029056" onmouseenter="enter('-2457059581629029056');" onmouseout="out('-2457059581629029056');" style=""> 119                 } else if (pollSqlNode.getKind() == AS) {                                                </span>
<span class="3037765200739894050" onmouseenter="enter('3037765200739894050');" onmouseout="out('3037765200739894050');" style=""> 120                     dealAsSourceTable(tableEnv, pollSqlNode, tableCache);                                </span>
<span class="4581342471671871622" onmouseenter="enter('4581342471671871622');" onmouseout="out('4581342471671871622');" style=""> 121                 } else if (pollSqlNode.getKind() == WITH_ITEM) {                                         </span>
<span class="-5883854330896154202" onmouseenter="enter('-5883854330896154202');" onmouseout="out('-5883854330896154202');" style=""> 122                     SqlWithItem sqlWithItem = ((SqlWithItem) (pollSqlNode));                             </span>
<span class="-7674640876687845363" onmouseenter="enter('-7674640876687845363');" onmouseout="out('-7674640876687845363');" style=""> 123                     String TableAlias = sqlWithItem.name.toString();                                     </span>
<span class="2573668668184904794" onmouseenter="enter('2573668668184904794');" onmouseout="out('2573668668184904794');" style=""> 124                     Table table = tableEnv.sqlQuery(sqlWithItem.query.toString());                       </span>
<span class="2341577843786962651" onmouseenter="enter('2341577843786962651');" onmouseout="out('2341577843786962651');" style=""> 125                     tableEnv.registerTable(TableAlias, table);                                           </span>
<span class="-5550860322814932769" onmouseenter="enter('-5550860322814932769');" onmouseout="out('-5550860322814932769');" style=""> 126                 } else if (pollSqlNode.getKind() == SELECT) {                                            </span>
<span class="-1344441018307209750" onmouseenter="enter('-1344441018307209750');" onmouseout="out('-1344441018307209750');" style=""><abbr title=" 127                     Preconditions.checkState(createView != null, &quot;select sql must included by create view&quot;);"> 127                     Preconditions.checkState(createView != null, &quot;select sql must included by create view🔵</abbr></span>
<span class="1694293925390283740" onmouseenter="enter('1694293925390283740');" onmouseout="out('1694293925390283740');" style=""> 128                     Table table = tableEnv.sqlQuery(pollObj.toString());                                 </span>
<span class="2239810942967083761" onmouseenter="enter('2239810942967083761');" onmouseout="out('2239810942967083761');" style=""> 129                     if (createView.getFieldsInfoStr() == null) {                                         </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 130                         tableEnv.registerTable(createView.getTableName(), table);                        </span>
<span class="4745325120447602784" onmouseenter="enter('4745325120447602784');" onmouseout="out('4745325120447602784');" style=""> 131                     } else if (checkFieldsInfo(createView, table)) {                                     </span>
<span class="-9109211084540213069" onmouseenter="enter('-9109211084540213069');" onmouseout="out('-9109211084540213069');" style=""> 132                         table = table.as(tmpFields);                                                     </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 133                         tableEnv.registerTable(createView.getTableName(), table);                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 134                     } else {                                                                             </span>
<span class="-4180003952862210397" onmouseenter="enter('-4180003952862210397');" onmouseout="out('-4180003952862210397');" style=""> 135                         throw new RuntimeException(&quot;Fields mismatch&quot;);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136                     }                                                                                    </span>
<span class="-5831701022468144749" onmouseenter="enter('-5831701022468144749');" onmouseout="out('-5831701022468144749');" style=""> 137                     localTableCache.put(createView.getTableName(), table);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138                 }                                                                                        </span>
<span class="735190908606907144" onmouseenter="enter('735190908606907144');" onmouseout="out('735190908606907144');" style=""> 139             } else if (pollObj instanceof JoinInfo) {                                                    </span>
<span  style=""> 140                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 141 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="-6732469083744011720" onmouseenter="enter('-6732469083744011720');" onmouseout="out('-6732469083744011720');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 142                 System.out.println(&quot;----------exec join info----------&quot;);                                </span>
<span class="6437130050258637649" onmouseenter="enter('6437130050258637649');" onmouseout="out('6437130050258637649');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 143                 System.out.println(pollObj.toString());                                                  </span>
<span class="-3518617829078174884" onmouseenter="enter('-3518617829078174884');" onmouseout="out('-3518617829078174884');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144                 joinFun(pollObj, localTableCache, sideTableMap, tableEnv);                               </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145                                                                                                          </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 146 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 147 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 147 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 148 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149                                                                                                          </span>
<span class="-6196622619540139248" onmouseenter="enter('-6196622619540139248');" onmouseout="out('-6196622619540139248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150                 LOG.info(&quot;----------exec join info----------\n{}&quot;, pollObj.toString());                  </span>
<span class="-4508108017455823844" onmouseenter="enter('-4508108017455823844');" onmouseout="out('-4508108017455823844');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151                 preIsSideJoin = true;                                                                    </span>
<span class="-9158044292308775618" onmouseenter="enter('-9158044292308775618');" onmouseout="out('-9158044292308775618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152                 joinFun(pollObj, localTableCache, sideTableMap, tableEnv, replaceInfoList);              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                                                                                                          </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 154 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 159     /**                                                                                                  </span>
<span class="-7226459799151937672" onmouseenter="enter('-7226459799151937672');" onmouseout="out('-7226459799151937672');" style=""> 160      * 解析出as查询的表和字段的关系                                                                                   </span>
<span class="-4711911052088894915" onmouseenter="enter('-4711911052088894915');" onmouseout="out('-4711911052088894915');" style=""> 161      * @param asSqlNode                                                                                  </span>
<span class="-8172984871762282794" onmouseenter="enter('-8172984871762282794');" onmouseout="out('-8172984871762282794');" style=""> 162      * @param tableCache                                                                                 </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 163      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 164      */                                                                                                  </span>
<span class="1606768570861189432" onmouseenter="enter('1606768570861189432');" onmouseout="out('1606768570861189432');" style=""> 165     private FieldReplaceInfo parseAsQuery(SqlBasicCall asSqlNode, Map&lt;String, Table&gt; tableCache) {       </span>
<span class="-4950849472737015743" onmouseenter="enter('-4950849472737015743');" onmouseout="out('-4950849472737015743');" style=""> 166         SqlNode info = asSqlNode.getOperands()[0];                                                       </span>
<span class="-6049998703041327008" onmouseenter="enter('-6049998703041327008');" onmouseout="out('-6049998703041327008');" style=""> 167         SqlNode alias = asSqlNode.getOperands()[1];                                                      </span>
<span class="6169254144825097648" onmouseenter="enter('6169254144825097648');" onmouseout="out('6169254144825097648');" style=""> 168         SqlKind infoKind = info.getKind();                                                               </span>
<span class="-7038358418253063490" onmouseenter="enter('-7038358418253063490');" onmouseout="out('-7038358418253063490');" style=""> 169         if (infoKind != SELECT) {                                                                        </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 170             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171         }                                                                                                </span>
<span class="-2978908867755751484" onmouseenter="enter('-2978908867755751484');" onmouseout="out('-2978908867755751484');" style=""><abbr title=" 172         List&lt;FieldInfo&gt; extractFieldList = TableUtils.parserSelectField(((SqlSelect) (info)), tableCache);"> 172         List&lt;FieldInfo&gt; extractFieldList = TableUtils.parserSelectField(((SqlSelect) (info)), tableCache)🔵</abbr></span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style=""> 173         HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                   </span>
<span class="-5476396715494077219" onmouseenter="enter('-5476396715494077219');" onmouseout="out('-5476396715494077219');" style=""> 174         for (FieldInfo fieldInfo : extractFieldList) {                                                   </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 175             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 176             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style=""> 177             String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);        </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style=""> 178             mappingTable.put(tableName, fieldName, mappingFieldName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179         }                                                                                                </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 180         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 181         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="9115675088981905484" onmouseenter="enter('9115675088981905484');" onmouseout="out('9115675088981905484');" style=""> 182         replaceInfo.setTargetTableName(alias.toString());                                                </span>
<span class="-6295883374697236710" onmouseenter="enter('-6295883374697236710');" onmouseout="out('-6295883374697236710');" style=""> 183         replaceInfo.setTargetTableAlias(alias.toString());                                               </span>
<span class="2754859294214862032" onmouseenter="enter('2754859294214862032');" onmouseout="out('2754859294214862032');" style=""> 184         return replaceInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185     }                                                                                                    </span>
<span  style=""> 186                                                                                                          </span>
<span class="3897594848566528823" onmouseenter="enter('3897594848566528823');" onmouseout="out('3897594848566528823');" style=""> 187     public AliasInfo parseAsNode(SqlNode sqlNode) throws SqlParseException {                             </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 188         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="-2199822100243684238" onmouseenter="enter('-2199822100243684238');" onmouseout="out('-2199822100243684238');" style=""> 189         if (sqlKind != AS) {                                                                             </span>
<span class="1088430228081547460" onmouseenter="enter('1088430228081547460');" onmouseout="out('1088430228081547460');" style=""> 190             throw new RuntimeException(sqlNode + &quot; is not &#x27;as&#x27; operator&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191         }                                                                                                </span>
<span class="-2581148716866963551" onmouseenter="enter('-2581148716866963551');" onmouseout="out('-2581148716866963551');" style=""> 192         SqlNode info = ((SqlBasicCall) (sqlNode)).getOperands()[0];                                      </span>
<span class="6674876786664753496" onmouseenter="enter('6674876786664753496');" onmouseout="out('6674876786664753496');" style=""> 193         SqlNode alias = ((SqlBasicCall) (sqlNode)).getOperands()[1];                                     </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 194         AliasInfo aliasInfo = new AliasInfo();                                                           </span>
<span class="-5109084571101185803" onmouseenter="enter('-5109084571101185803');" onmouseout="out('-5109084571101185803');" style=""> 195         aliasInfo.setName(info.toString());                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 196         aliasInfo.setAlias(alias.toString());                                                            </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 197         return aliasInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198     }                                                                                                    </span>
<span  style=""> 199                                                                                                          </span>
<span class="-8689302297966137516" onmouseenter="enter('-8689302297966137516');" onmouseout="out('-8689302297966137516');" style=""><abbr title=" 200     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 200     public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, Stri🔵</abbr></span>
<span class="-3566414926414695948" onmouseenter="enter('-3566414926414695948');" onmouseout="out('-3566414926414695948');" style=""> 201         TypeInformation[] sideOutTypes = new TypeInformation[sideJoinFieldInfo.size()];                  </span>
<span class="-637166731779412769" onmouseenter="enter('-637166731779412769');" onmouseout="out('-637166731779412769');" style=""> 202         String[] sideOutNames = new String[sideJoinFieldInfo.size()];                                    </span>
<span class="7438730024850909889" onmouseenter="enter('7438730024850909889');" onmouseout="out('7438730024850909889');" style=""> 203         for (int i = 0; i &lt; sideJoinFieldInfo.size(); i++) {                                             </span>
<span class="2207877773063469724" onmouseenter="enter('2207877773063469724');" onmouseout="out('2207877773063469724');" style=""> 204             FieldInfo fieldInfo = sideJoinFieldInfo.get(i);                                              </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 205             String tableName = fieldInfo.getTable();                                                     </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 206             String fieldName = fieldInfo.getFieldName();                                                 </span>
<span class="3640983111807923268" onmouseenter="enter('3640983111807923268');" onmouseout="out('3640983111807923268');" style=""> 207             String mappingFieldName = mappingTable.get(tableName, fieldName);                            </span>
<span class="-4165873345254348507" onmouseenter="enter('-4165873345254348507');" onmouseout="out('-4165873345254348507');" style=""><abbr title=" 208             Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be frame bug&quot;);"> 208             Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be f🔵</abbr></span>
<span class="4913645198555706594" onmouseenter="enter('4913645198555706594');" onmouseout="out('4913645198555706594');" style=""> 209             sideOutTypes[i] = fieldInfo.getTypeInformation();                                            </span>
<span class="6276485717663783154" onmouseenter="enter('6276485717663783154');" onmouseout="out('6276485717663783154');" style=""> 210             sideOutNames[i] = mappingFieldName;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span class="2691939759498133513" onmouseenter="enter('2691939759498133513');" onmouseout="out('2691939759498133513');" style=""> 212         return new RowTypeInfo(sideOutTypes, sideOutNames);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 215     /**                                                                                                  </span>
<span class="4027944609056411189" onmouseenter="enter('4027944609056411189');" onmouseout="out('4027944609056411189');" style=""> 216      *  对时间类型进行类型转换                                                                                      </span>
<span class="-7981851073621455488" onmouseenter="enter('-7981851073621455488');" onmouseout="out('-7981851073621455488');" style=""> 217      * @param leftTypeInfo                                                                               </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 218      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 219      */                                                                                                  </span>
<span class="109255438874014135" onmouseenter="enter('109255438874014135');" onmouseout="out('109255438874014135');" style=""> 220     private RowTypeInfo buildLeftTableOutType(RowTypeInfo leftTypeInfo) {                                </span>
<span class="5269317691380571116" onmouseenter="enter('5269317691380571116');" onmouseout="out('5269317691380571116');" style=""> 221         TypeInformation[] sideOutTypes = new TypeInformation[leftTypeInfo.getFieldNames().length];       </span>
<span class="357447233987634249" onmouseenter="enter('357447233987634249');" onmouseout="out('357447233987634249');" style=""> 222         TypeInformation&lt;?&gt;[] fieldTypes = leftTypeInfo.getFieldTypes();                                  </span>
<span class="-7313385440196867180" onmouseenter="enter('-7313385440196867180');" onmouseout="out('-7313385440196867180');" style=""> 223         for (int i = 0; i &lt; sideOutTypes.length; i++) {                                                  </span>
<span class="-314833607359598646" onmouseenter="enter('-314833607359598646');" onmouseout="out('-314833607359598646');" style=""> 224             sideOutTypes[i] = convertTimeAttributeType(fieldTypes[i]);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225         }                                                                                                </span>
<span class="-6446480870466684625" onmouseenter="enter('-6446480870466684625');" onmouseout="out('-6446480870466684625');" style=""> 226         RowTypeInfo rowTypeInfo = new RowTypeInfo(sideOutTypes, leftTypeInfo.getFieldNames());           </span>
<span class="6189116692514123920" onmouseenter="enter('6189116692514123920');" onmouseout="out('6189116692514123920');" style=""> 227         return rowTypeInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228     }                                                                                                    </span>
<span  style=""> 229                                                                                                          </span>
<span class="2471506251995792847" onmouseenter="enter('2471506251995792847');" onmouseout="out('2471506251995792847');" style=""> 230     private TypeInformation convertTimeAttributeType(TypeInformation typeInformation) {                  </span>
<span class="2997926285576198837" onmouseenter="enter('2997926285576198837');" onmouseout="out('2997926285576198837');" style=""> 231         if (typeInformation instanceof TimeIndicatorTypeInfo) {                                          </span>
<span class="-6249974448261972874" onmouseenter="enter('-6249974448261972874');" onmouseout="out('-6249974448261972874');" style=""> 232             return TypeInformation.of(Timestamp.class);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233         }                                                                                                </span>
<span class="6871348106862514693" onmouseenter="enter('6871348106862514693');" onmouseout="out('6871348106862514693');" style=""> 234         return typeInformation;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235     }                                                                                                    </span>
<span  style=""> 236                                                                                                          </span>
<span class="-6722855011181273565" onmouseenter="enter('-6722855011181273565');" onmouseout="out('-6722855011181273565');" style=""> 237     public void setLocalSqlPluginPath(String localSqlPluginPath) {                                       </span>
<span class="6258662942576926140" onmouseenter="enter('6258662942576926140');" onmouseout="out('6258662942576926140');" style=""> 238         this.localSqlPluginPath = localSqlPluginPath;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239     }                                                                                                    </span>
<span  style=""> 240                                                                                                          </span>
<span class="6507980841648709304" onmouseenter="enter('6507980841648709304');" onmouseout="out('6507980841648709304');" style=""><abbr title=" 241     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableName) {"> 241     private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableNa🔵</abbr></span>
<span class="-6301156236825066460" onmouseenter="enter('-6301156236825066460');" onmouseout="out('-6301156236825066460');" style=""> 242         Table table = localTableCache.get(tableAlias);                                                   </span>
<span class="1637251780061381079" onmouseenter="enter('1637251780061381079');" onmouseout="out('1637251780061381079');" style=""> 243         if (table == null) {                                                                             </span>
<span class="-5960895848666330323" onmouseenter="enter('-5960895848666330323');" onmouseout="out('-5960895848666330323');" style=""> 244             table = localTableCache.get(tableName);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245         }                                                                                                </span>
<span class="1637251780061381079" onmouseenter="enter('1637251780061381079');" onmouseout="out('1637251780061381079');" style=""> 246         if (table == null) {                                                                             </span>
<span class="4627225224916806199" onmouseenter="enter('4627225224916806199');" onmouseout="out('4627225224916806199');" style=""> 247             throw new RuntimeException(&quot;not register table &quot; + tableAlias);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248         }                                                                                                </span>
<span class="-6017334383208509278" onmouseenter="enter('-6017334383208509278');" onmouseout="out('-6017334383208509278');" style=""> 249         return table;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 252     /**                                                                                                  </span>
<span class="5196638318686351881" onmouseenter="enter('5196638318686351881');" onmouseout="out('5196638318686351881');" style=""><abbr title=" 253      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension table is the primary key definition"> 253      * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., d🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 254      *                                                                                                   </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 255      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 256      */                                                                                                  </span>
<span class="4488554625343324946" onmouseenter="enter('4488554625343324946');" onmouseout="out('4488554625343324946');" style=""><abbr title=" 257     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInfo sideTableInfo) {"> 257     private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInf🔵</abbr></span>
<span class="-6710736308674703771" onmouseenter="enter('-6710736308674703771');" onmouseout="out('-6710736308674703771');" style=""> 258         List&lt;String&gt; conditionFields = getConditionFields(conditionNode, sideTableAlias, sideTableInfo); </span>
<span class="8847075305465358712" onmouseenter="enter('8847075305465358712');" onmouseout="out('8847075305465358712');" style=""> 259         if (CollectionUtils.isEqualCollection(conditionFields, convertPrimaryAlias(sideTableInfo))) {    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 260             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 262         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263     }                                                                                                    </span>
<span  style=""> 264                                                                                                          </span>
<span class="572998504046101497" onmouseenter="enter('572998504046101497');" onmouseout="out('572998504046101497');" style=""> 265     private List&lt;String&gt; convertPrimaryAlias(AbstractSideTableInfo sideTableInfo) {                      </span>
<span class="-6700733268022775520" onmouseenter="enter('-6700733268022775520');" onmouseout="out('-6700733268022775520');" style=""> 266         List&lt;String&gt; res = Lists.newArrayList();                                                         </span>
<span class="-4134441438111480008" onmouseenter="enter('-4134441438111480008');" onmouseout="out('-4134441438111480008');" style=""> 267         sideTableInfo.getPrimaryKeys().forEach(( field) -&gt; {                                             </span>
<span class="2991641550935988694" onmouseenter="enter('2991641550935988694');" onmouseout="out('2991641550935988694');" style=""> 268             res.add(sideTableInfo.getPhysicalFields().getOrDefault(field, field));                       </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 269         });                                                                                              </span>
<span class="1866624461241282949" onmouseenter="enter('1866624461241282949');" onmouseout="out('1866624461241282949');" style=""> 270         return res;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="6064840374032880755" onmouseenter="enter('6064840374032880755');" onmouseout="out('6064840374032880755');" style=""><abbr title=" 273     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTableInfo sideTableInfo) {"> 273     public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTa🔵</abbr></span>
<span class="-5667062641477778387" onmouseenter="enter('-5667062641477778387');" onmouseout="out('-5667062641477778387');" style=""> 274         List&lt;SqlNode&gt; sqlNodeList = Lists.newArrayList();                                                </span>
<span class="5003747983397221043" onmouseenter="enter('5003747983397221043');" onmouseout="out('5003747983397221043');" style=""> 275         ParseUtils.parseAnd(conditionNode, sqlNodeList);                                                 </span>
<span class="331902561671078290" onmouseenter="enter('331902561671078290');" onmouseout="out('331902561671078290');" style=""> 276         List&lt;String&gt; conditionFields = Lists.newArrayList();                                             </span>
<span class="4227493740309250661" onmouseenter="enter('4227493740309250661');" onmouseout="out('4227493740309250661');" style=""> 277         for (SqlNode sqlNode : sqlNodeList) {                                                            </span>
<span class="-1235221313035004193" onmouseenter="enter('-1235221313035004193');" onmouseout="out('-1235221313035004193');" style=""> 278             if (!SqlKind.COMPARISON.contains(sqlNode.getKind())) {                                       </span>
<span class="4238811186041433324" onmouseenter="enter('4238811186041433324');" onmouseout="out('4238811186041433324');" style=""> 279                 throw new RuntimeException(&quot;not compare operator.&quot;);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280             }                                                                                            </span>
<span class="6270705694561767590" onmouseenter="enter('6270705694561767590');" onmouseout="out('6270705694561767590');" style=""> 281             SqlIdentifier left = ((SqlIdentifier) (((SqlBasicCall) (sqlNode)).getOperands()[0]));        </span>
<span class="4075214292407725883" onmouseenter="enter('4075214292407725883');" onmouseout="out('4075214292407725883');" style=""> 282             SqlIdentifier right = ((SqlIdentifier) (((SqlBasicCall) (sqlNode)).getOperands()[1]));       </span>
<span class="-2670749344655178863" onmouseenter="enter('-2670749344655178863');" onmouseout="out('-2670749344655178863');" style=""> 283             String leftTableName = left.getComponent(0).getSimple();                                     </span>
<span class="5188110590184041827" onmouseenter="enter('5188110590184041827');" onmouseout="out('5188110590184041827');" style=""> 284             String rightTableName = right.getComponent(0).getSimple();                                   </span>
<span class="8082853509369418918" onmouseenter="enter('8082853509369418918');" onmouseout="out('8082853509369418918');" style=""> 285             String tableCol = &quot;&quot;;                                                                        </span>
<span class="-1233782311271008501" onmouseenter="enter('-1233782311271008501');" onmouseout="out('-1233782311271008501');" style=""> 286             if (leftTableName.equalsIgnoreCase(specifyTableName)) {                                      </span>
<span class="4527748628163402760" onmouseenter="enter('4527748628163402760');" onmouseout="out('4527748628163402760');" style=""> 287                 tableCol = left.getComponent(1).getSimple();                                             </span>
<span class="-2773987473156284347" onmouseenter="enter('-2773987473156284347');" onmouseout="out('-2773987473156284347');" style=""> 288             } else if (rightTableName.equalsIgnoreCase(specifyTableName)) {                              </span>
<span class="4462633703217831544" onmouseenter="enter('4462633703217831544');" onmouseout="out('4462633703217831544');" style=""> 289                 tableCol = right.getComponent(1).getSimple();                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 290             } else {                                                                                     </span>
<span class="3783543445731730404" onmouseenter="enter('3783543445731730404');" onmouseout="out('3783543445731730404');" style=""><abbr title=" 291                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName));"> 291                 throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specify🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292             }                                                                                            </span>
<span class="-2325401555704525047" onmouseenter="enter('-2325401555704525047');" onmouseout="out('-2325401555704525047');" style=""> 293             tableCol = sideTableInfo.getPhysicalFields().getOrDefault(tableCol, tableCol);               </span>
<span class="-4552234441929070616" onmouseenter="enter('-4552234441929070616');" onmouseout="out('-4552234441929070616');" style=""> 294             conditionFields.add(tableCol);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295         }                                                                                                </span>
<span class="4950082808497882460" onmouseenter="enter('4950082808497882460');" onmouseout="out('4950082808497882460');" style=""> 296         return conditionFields;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297     }                                                                                                    </span>
<span  style=""> 298                                                                                                          </span>
<span class="5919995367845636830" onmouseenter="enter('5919995367845636830');" onmouseout="out('5919995367845636830');" style=""><abbr title=" 299     protected void dealAsSourceTable(StreamTableEnvironment tableEnv, SqlNode pollSqlNode, Map&lt;String, Table&gt; tableCache) throws SqlParseException {"> 299     protected void dealAsSourceTable(StreamTableEnvironment tableEnv, SqlNode pollSqlNode, Map&lt;String, Ta🔵</abbr></span>
<span class="7772412594103241573" onmouseenter="enter('7772412594103241573');" onmouseout="out('7772412594103241573');" style=""> 300         AliasInfo aliasInfo = parseAsNode(pollSqlNode);                                                  </span>
<span class="2461088292100865778" onmouseenter="enter('2461088292100865778');" onmouseout="out('2461088292100865778');" style=""> 301         if (localTableCache.containsKey(aliasInfo.getName())) {                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 302             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303         }                                                                                                </span>
<span class="-3390660419579622283" onmouseenter="enter('-3390660419579622283');" onmouseout="out('-3390660419579622283');" style=""> 304         Table table = tableEnv.sqlQuery(aliasInfo.getName());                                            </span>
<span class="5901087968051131557" onmouseenter="enter('5901087968051131557');" onmouseout="out('5901087968051131557');" style=""> 305         tableEnv.registerTable(aliasInfo.getAlias(), table);                                             </span>
<span class="1100939894023116874" onmouseenter="enter('1100939894023116874');" onmouseout="out('1100939894023116874');" style=""> 306         localTableCache.put(aliasInfo.getAlias(), table);                                                </span>
<span class="7353361537117728269" onmouseenter="enter('7353361537117728269');" onmouseout="out('7353361537117728269');" style=""> 307         LOG.info(&quot;Register Table {} by {}&quot;, aliasInfo.getAlias(), aliasInfo.getName());                  </span>
<span class="9016797621408685274" onmouseenter="enter('9016797621408685274');" onmouseout="out('9016797621408685274');" style=""> 308         FieldReplaceInfo fieldReplaceInfo = parseAsQuery(((SqlBasicCall) (pollSqlNode)), tableCache);    </span>
<span class="7661155268446817101" onmouseenter="enter('7661155268446817101');" onmouseout="out('7661155268446817101');" style=""> 309         if (fieldReplaceInfo == null) {                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 310             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311         }                                                                                                </span>
<span class="5201289014257809146" onmouseenter="enter('5201289014257809146');" onmouseout="out('5201289014257809146');" style=""> 312         // as 的源表                                                                                        </span>
<span class="-7252441079357822746" onmouseenter="enter('-7252441079357822746');" onmouseout="out('-7252441079357822746');" style=""> 313         Set&lt;String&gt; fromTableNameSet = Sets.newHashSet();                                                </span>
<span class="-6985284674886378091" onmouseenter="enter('-6985284674886378091');" onmouseout="out('-6985284674886378091');" style=""> 314         SqlNode fromNode = ((SqlBasicCall) (pollSqlNode)).getOperands()[0];                              </span>
<span class="8218826531385538687" onmouseenter="enter('8218826531385538687');" onmouseout="out('8218826531385538687');" style=""> 315         TableUtils.getFromTableInfo(fromNode, fromTableNameSet);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="-2241580585491851593" onmouseenter="enter('-2241580585491851593');" onmouseout="out('-2241580585491851593');" style=""><abbr title=" 318     private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv) throws Exception {"> 318     private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache, Map&lt;String, AbstractSideTabl🔵</abbr></span>
<span class="2723345182979130952" onmouseenter="enter('2723345182979130952');" onmouseout="out('2723345182979130952');" style=""> 319         JoinInfo joinInfo = ((JoinInfo) (pollObj));                                                      </span>
<span class="-4580559439294190862" onmouseenter="enter('-4580559439294190862');" onmouseout="out('-4580559439294190862');" style=""> 320         JoinScope joinScope = new JoinScope();                                                           </span>
<span class="-6383140859888654083" onmouseenter="enter('-6383140859888654083');" onmouseout="out('-6383140859888654083');" style=""> 321         JoinScope.ScopeChild leftScopeChild = new JoinScope.ScopeChild();                                </span>
<span class="-5401707331330951256" onmouseenter="enter('-5401707331330951256');" onmouseout="out('-5401707331330951256');" style=""> 322         leftScopeChild.setAlias(joinInfo.getLeftTableAlias());                                           </span>
<span class="5108424867732442426" onmouseenter="enter('5108424867732442426');" onmouseout="out('5108424867732442426');" style=""> 323         leftScopeChild.setTableName(joinInfo.getLeftTableName());                                        </span>
<span class="-2402361542513321069" onmouseenter="enter('-2402361542513321069');" onmouseout="out('-2402361542513321069');" style=""><abbr title=" 324         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableName());"> 324         Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLe🔵</abbr></span>
<span class="5224542232803887157" onmouseenter="enter('5224542232803887157');" onmouseout="out('5224542232803887157');" style=""><abbr title=" 325         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColumnNames());"> 325         RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema(🔵</abbr></span>
<span class="-5303860989220332569" onmouseenter="enter('-5303860989220332569');" onmouseout="out('-5303860989220332569');" style=""> 326         leftScopeChild.setRowTypeInfo(leftTypeInfo);                                                     </span>
<span class="3043795906382715340" onmouseenter="enter('3043795906382715340');" onmouseout="out('3043795906382715340');" style=""> 327         JoinScope.ScopeChild rightScopeChild = new JoinScope.ScopeChild();                               </span>
<span class="2585249270397691815" onmouseenter="enter('2585249270397691815');" onmouseout="out('2585249270397691815');" style=""> 328         rightScopeChild.setAlias(joinInfo.getRightTableAlias());                                         </span>
<span class="-5072747544386586876" onmouseenter="enter('-5072747544386586876');" onmouseout="out('-5072747544386586876');" style=""> 329         rightScopeChild.setTableName(joinInfo.getRightTableName());                                      </span>
<span class="-6382774479188932768" onmouseenter="enter('-6382774479188932768');" onmouseout="out('-6382774479188932768');" style=""> 330         AbstractSideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());            </span>
<span class="-4894423646294599023" onmouseenter="enter('-4894423646294599023');" onmouseout="out('-4894423646294599023');" style=""> 331         if (sideTableInfo == null) {                                                                     </span>
<span class="-5396801098824602905" onmouseenter="enter('-5396801098824602905');" onmouseout="out('-5396801098824602905');" style=""> 332             sideTableInfo = sideTableMap.get(joinInfo.getRightTableAlias());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333         }                                                                                                </span>
<span class="-4894423646294599023" onmouseenter="enter('-4894423646294599023');" onmouseout="out('-4894423646294599023');" style=""> 334         if (sideTableInfo == null) {                                                                     </span>
<span class="450947362076537032" onmouseenter="enter('450947362076537032');" onmouseout="out('450947362076537032');" style=""> 335             throw new RuntimeException(&quot;can&#x27;t not find side table:&quot; + joinInfo.getRightTableName());     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336         }                                                                                                </span>
<span class="6668906180521634363" onmouseenter="enter('6668906180521634363');" onmouseout="out('6668906180521634363');" style=""> 337 //        if(!checkJoinCondition(joinInfo.getCondition(), joinInfo.getRightTableAlias(), sideTableInfo)){</span>
<span class="2570085130586631416" onmouseenter="enter('2570085130586631416');" onmouseout="out('2570085130586631416');" style=""> 338 //            throw new RuntimeException(&quot;ON condition must contain all equal fields!!!&quot;);               </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 339 //        }                                                                                              </span>
<span class="-1562873445908102884" onmouseenter="enter('-1562873445908102884');" onmouseout="out('-1562873445908102884');" style=""> 340         rightScopeChild.setRowTypeInfo(sideTableInfo.getRowTypeInfo());                                  </span>
<span class="-5776192160472100987" onmouseenter="enter('-5776192160472100987');" onmouseout="out('-5776192160472100987');" style=""> 341         joinScope.addScope(leftScopeChild);                                                              </span>
<span class="6805588345897841594" onmouseenter="enter('6805588345897841594');" onmouseout="out('6805588345897841594');" style=""> 342         joinScope.addScope(rightScopeChild);                                                             </span>
<span class="-119540861227224426" onmouseenter="enter('-119540861227224426');" onmouseout="out('-119540861227224426');" style=""> 343         HashBasedTable&lt;String, String, String&gt; mappingTable = ((JoinInfo) (pollObj)).getTableFieldRef(); </span>
<span class="-5693279157941758931" onmouseenter="enter('-5693279157941758931');" onmouseout="out('-5693279157941758931');" style=""> 344         // 获取两个表的所有字段                                                                                    </span>
<span class="-6198283029075022684" onmouseenter="enter('-6198283029075022684');" onmouseout="out('-6198283029075022684');" style=""><abbr title=" 345         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, true);"> 345         List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), join🔵</abbr></span>
<span class="5016458903510526292" onmouseenter="enter('5016458903510526292');" onmouseout="out('5016458903510526292');" style=""> 346         //通过join的查询字段信息过滤出需要的字段信息                                                                        </span>
<span class="483727955973627980" onmouseenter="enter('483727955973627980');" onmouseout="out('483727955973627980');" style=""><abbr title=" 347         sideJoinFieldInfo.removeIf(( tmpFieldInfo) -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldInfo.getFieldName()) == null);"> 347         sideJoinFieldInfo.removeIf(( tmpFieldInfo) -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldI🔵</abbr></span>
<span class="-1467815726997680818" onmouseenter="enter('-1467815726997680818');" onmouseout="out('-1467815726997680818');" style=""> 348         String leftTableAlias = joinInfo.getLeftTableAlias();                                            </span>
<span class="-6434853421912213287" onmouseenter="enter('-6434853421912213287');" onmouseout="out('-6434853421912213287');" style=""> 349         Table targetTable = localTableCache.get(leftTableAlias);                                         </span>
<span class="7125781324026312556" onmouseenter="enter('7125781324026312556');" onmouseout="out('7125781324026312556');" style=""> 350         if (targetTable == null) {                                                                       </span>
<span class="8734197217231436839" onmouseenter="enter('8734197217231436839');" onmouseout="out('8734197217231436839');" style=""> 351             targetTable = localTableCache.get(joinInfo.getLeftTableName());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352         }                                                                                                </span>
<span class="3450476289809538439" onmouseenter="enter('3450476289809538439');" onmouseout="out('3450476289809538439');" style=""><abbr title=" 353         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColumnNames());"> 353         RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema(🔵</abbr></span>
<span class="-9102476377297059951" onmouseenter="enter('-9102476377297059951');" onmouseout="out('-9102476377297059951');" style=""><abbr title=" 354         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, Row.class).map((Tuple2&lt;Boolean, Row&gt; tp2) -&gt; {"> 354         DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, Row.class).map((Tuple2&lt;Boole🔵</abbr></span>
<span class="7833906289428987345" onmouseenter="enter('7833906289428987345');" onmouseout="out('7833906289428987345');" style=""> 355             return new CRow(tp2.f1, tp2.f0);                                                             </span>
<span class="-8730504840947162971" onmouseenter="enter('-8730504840947162971');" onmouseout="out('-8730504840947162971');" style=""> 356         }).returns(CRow.class);                                                                          </span>
<span class="-6082173173678345991" onmouseenter="enter('-6082173173678345991');" onmouseout="out('-6082173173678345991');" style=""> 357         //join side table before keyby ===&gt; Reducing the size of each dimension table cache of async     </span>
<span class="6301552848628110191" onmouseenter="enter('6301552848628110191');" onmouseout="out('6301552848628110191');" style=""> 358         if (sideTableInfo.isPartitionedJoin()) {                                                         </span>
<span class="-4638861421651181765" onmouseenter="enter('-4638861421651181765');" onmouseout="out('-4638861421651181765');" style=""><abbr title=" 359             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(), sideTableInfo);"> 359             List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTa🔵</abbr></span>
<span class="-1086375650130423707" onmouseenter="enter('-1086375650130423707');" onmouseout="out('-1086375650130423707');" style=""> 360             List&lt;String&gt; fieldNames = Arrays.asList(targetTable.getSchema().getFieldNames());            </span>
<span class="2517152886952033206" onmouseenter="enter('2517152886952033206');" onmouseout="out('2517152886952033206');" style=""> 361             int[] keyIndex = leftJoinColList.stream().mapToInt(fieldNames::indexOf).toArray();           </span>
<span class="-7482412719932836963" onmouseenter="enter('-7482412719932836963');" onmouseout="out('-7482412719932836963');" style=""><abbr title=" 362             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.getSchema())));"> 362             adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, tar🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363         }                                                                                                </span>
<span class="-1065289666164106717" onmouseenter="enter('-1065289666164106717');" onmouseout="out('-1065289666164106717');" style=""> 364         DataStream&lt;CRow&gt; dsOut = null;                                                                   </span>
<span class="9130962490964334732" onmouseenter="enter('9130962490964334732');" onmouseout="out('9130962490964334732');" style=""> 365         if (ECacheType.ALL.name().equalsIgnoreCase(sideTableInfo.getCacheType())) {                      </span>
<span class="7101184136852303035" onmouseenter="enter('7101184136852303035');" onmouseout="out('7101184136852303035');" style=""><abbr title=" 366             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);"> 366             dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), 🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 367         } else {                                                                                         </span>
<span class="7683243294616380271" onmouseenter="enter('7683243294616380271');" onmouseout="out('7683243294616380271');" style=""><abbr title=" 368             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);"> 368             dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSq🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369         }                                                                                                </span>
<span class="2474148199265091642" onmouseenter="enter('2474148199265091642');" onmouseout="out('2474148199265091642');" style=""> 370         RowTypeInfo sideOutTypeInfo = buildOutRowTypeInfo(sideJoinFieldInfo, mappingTable);              </span>
<span class="-1611735526649110750" onmouseenter="enter('-1611735526649110750');" onmouseout="out('-1611735526649110750');" style=""> 371         CRowTypeInfo cRowTypeInfo = new CRowTypeInfo(sideOutTypeInfo);                                   </span>
<span class="-4428554219841205830" onmouseenter="enter('-4428554219841205830');" onmouseout="out('-4428554219841205830');" style=""> 372         dsOut.getTransformation().setOutputType(cRowTypeInfo);                                           </span>
<span class="4836712590888983064" onmouseenter="enter('4836712590888983064');" onmouseout="out('4836712590888983064');" style=""> 373         String targetTableName = joinInfo.getNewTableName();                                             </span>
<span class="-3094587764130774762" onmouseenter="enter('-3094587764130774762');" onmouseout="out('-3094587764130774762');" style=""> 374         String targetTableAlias = joinInfo.getNewTableAlias();                                           </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 375         FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                           </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 376         replaceInfo.setMappingTable(mappingTable);                                                       </span>
<span class="8710576405434192583" onmouseenter="enter('8710576405434192583');" onmouseout="out('8710576405434192583');" style=""> 377         replaceInfo.setTargetTableName(targetTableName);                                                 </span>
<span class="-6613112199475906839" onmouseenter="enter('-6613112199475906839');" onmouseout="out('-6613112199475906839');" style=""> 378         replaceInfo.setTargetTableAlias(targetTableAlias);                                               </span>
<span class="-8740803440414589002" onmouseenter="enter('-8740803440414589002');" onmouseout="out('-8740803440414589002');" style=""> 379         if (!tableEnv.isRegistered(joinInfo.getNewTableName())) {                                        </span>
<span class="-9057257427162955657" onmouseenter="enter('-9057257427162955657');" onmouseout="out('-9057257427162955657');" style=""> 380             Table joinTable = tableEnv.fromDataStream(dsOut);                                            </span>
<span class="-7674974637599312088" onmouseenter="enter('-7674974637599312088');" onmouseout="out('-7674974637599312088');" style=""> 381             tableEnv.registerTable(joinInfo.getNewTableName(), joinTable);                               </span>
<span class="5569875846259576593" onmouseenter="enter('5569875846259576593');" onmouseout="out('5569875846259576593');" style=""> 382             localTableCache.put(joinInfo.getNewTableName(), joinTable);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384     }                                                                                                    </span>
<span  style=""> 385                                                                                                          </span>
<span class="2503560481488678812" onmouseenter="enter('2503560481488678812');" onmouseout="out('2503560481488678812');" style=""> 386     private TypeInformation&lt;Row&gt; projectedTypeInfo(int[] fields, TableSchema schema) {                   </span>
<span class="-934325254904626531" onmouseenter="enter('-934325254904626531');" onmouseout="out('-934325254904626531');" style=""> 387         String[] fieldNames = schema.getFieldNames();                                                    </span>
<span class="4556717060829301814" onmouseenter="enter('4556717060829301814');" onmouseout="out('4556717060829301814');" style=""> 388         TypeInformation&lt;?&gt;[] fieldTypes = schema.getFieldTypes();                                        </span>
<span  style=""> 389                                                                                                          </span>
<span class="424178526470659793" onmouseenter="enter('424178526470659793');" onmouseout="out('424178526470659793');" style=""><abbr title=" 390         String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::new);"> 390         String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::ne🔵</abbr></span>
<span class="5411397013359382914" onmouseenter="enter('5411397013359382914');" onmouseout="out('5411397013359382914');" style=""><abbr title=" 391         TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(TypeInformation[]::new);"> 391         TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(Typ🔵</abbr></span>
<span class="-5627838059420262860" onmouseenter="enter('-5627838059420262860');" onmouseout="out('-5627838059420262860');" style=""> 392         return new RowTypeInfo(projectedTypes, projectedNames);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 393     }                                                                                                    </span>
<span  style=""> 394                                                                                                          </span>
<span class="-410103274617159114" onmouseenter="enter('-410103274617159114');" onmouseout="out('-410103274617159114');" style=""> 395     private boolean checkFieldsInfo(CreateTmpTableParser.SqlParserResult result, Table table) {          </span>
<span class="8925867441251499081" onmouseenter="enter('8925867441251499081');" onmouseout="out('8925867441251499081');" style=""> 396         List&lt;String&gt; fieldNames = new LinkedList&lt;&gt;();                                                    </span>
<span class="-5553816012496774052" onmouseenter="enter('-5553816012496774052');" onmouseout="out('-5553816012496774052');" style=""> 397         String fieldsInfo = result.getFieldsInfoStr();                                                   </span>
<span class="-5855731071361337066" onmouseenter="enter('-5855731071361337066');" onmouseout="out('-5855731071361337066');" style=""> 398         String[] fields = StringUtils.split(fieldsInfo, &quot;,&quot;);                                            </span>
<span class="8167763809890058258" onmouseenter="enter('8167763809890058258');" onmouseout="out('8167763809890058258');" style=""> 399         for (int i = 0; i &lt; fields.length; i++) {                                                        </span>
<span class="2947314498030065040" onmouseenter="enter('2947314498030065040');" onmouseout="out('2947314498030065040');" style=""> 400             String[] filed = fields[i].split(&quot;\\s&quot;);                                                     </span>
<span class="-1357624064782313893" onmouseenter="enter('-1357624064782313893');" onmouseout="out('-1357624064782313893');" style=""> 401             if ((filed.length &lt; 2) || (fields.length != table.getSchema().getColumnNames().length)) {    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 402                 return false;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 403             } else {                                                                                     </span>
<span class="-7518627407039835792" onmouseenter="enter('-7518627407039835792');" onmouseout="out('-7518627407039835792');" style=""> 404                 String[] filedNameArr = new String[filed.length - 1];                                    </span>
<span class="6064994574122217386" onmouseenter="enter('6064994574122217386');" onmouseout="out('6064994574122217386');" style=""> 405                 System.arraycopy(filed, 0, filedNameArr, 0, filed.length - 1);                           </span>
<span class="-3029457015937137256" onmouseenter="enter('-3029457015937137256');" onmouseout="out('-3029457015937137256');" style=""> 406                 String fieldName = String.join(&quot; &quot;, filedNameArr);                                       </span>
<span class="-8037943253867791720" onmouseenter="enter('-8037943253867791720');" onmouseout="out('-8037943253867791720');" style=""> 407                 fieldNames.add(fieldName);                                                               </span>
<span class="5681537301300222292" onmouseenter="enter('5681537301300222292');" onmouseout="out('5681537301300222292');" style=""> 408                 String fieldType = filed[filed.length - 1].trim();                                       </span>
<span class="-8511761590344571010" onmouseenter="enter('-8511761590344571010');" onmouseout="out('-8511761590344571010');" style=""> 409                 Class fieldClass = ClassUtil.stringConvertClass(fieldType);                              </span>
<span class="-351203522969775469" onmouseenter="enter('-351203522969775469');" onmouseout="out('-351203522969775469');" style=""> 410                 Class tableField = table.getSchema().getFieldType(i).get().getTypeClass();               </span>
<span class="-2055572975849334800" onmouseenter="enter('-2055572975849334800');" onmouseout="out('-2055572975849334800');" style=""> 411                 if (fieldClass == tableField) {                                                          </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 412                     continue;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 413                 } else {                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 414                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417         }                                                                                                </span>
<span class="-7181802501759976675" onmouseenter="enter('-7181802501759976675');" onmouseout="out('-7181802501759976675');" style=""> 418         tmpFields = String.join(&quot;,&quot;, fieldNames);                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 419         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421 }                                                                                                        </span>




























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  23  import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  24  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  25  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="">  26  import org.apache.flink.streaming.api.datastream.DataStream;                                                      </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="">  27  import org.apache.flink.table.api.StreamQueryConfig;                                                              </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  28  import org.apache.flink.table.api.Table;                                                                          </span>
<span class="-8888728238394280005" onmouseenter="enter('-8888728238394280005');" onmouseout="out('-8888728238394280005');" style="">  29  import org.apache.flink.table.api.TableSchema;                                                                    </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="">  30  import org.apache.flink.table.api.java.StreamTableEnvironment;                                                    </span>
<span class="-6266446094177003082" onmouseenter="enter('-6266446094177003082');" onmouseout="out('-6266446094177003082');" style="">  31  import org.apache.flink.table.runtime.CRowKeySelector;                                                            </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  32  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="5605277811729025111" onmouseenter="enter('5605277811729025111');" onmouseout="out('5605277811729025111');" style="">  33  import org.apache.flink.table.runtime.types.CRowTypeInfo;                                                         </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  34  import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  35  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  36                                                                                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  37  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="">  38  import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                                   </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="">  39  import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                         </span>
<span class="7697893187981436175" onmouseenter="enter('7697893187981436175');" onmouseout="out('7697893187981436175');" style="">  40  import com.dtstack.flink.sql.side.operator.SideAsyncOperator;                                                     </span>
<span class="-7456990469468101750" onmouseenter="enter('-7456990469468101750');" onmouseout="out('-7456990469468101750');" style="">  41  import com.dtstack.flink.sql.side.operator.SideWithAllCacheOperator;                                              </span>
<span class="4874498590411064411" onmouseenter="enter('4874498590411064411');" onmouseout="out('4874498590411064411');" style="">  42  import com.dtstack.flink.sql.util.ClassUtil;                                                                      </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  43  import com.dtstack.flink.sql.util.ParseUtils;                                                                     </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  44  import com.dtstack.flink.sql.util.TableUtils;                                                                     </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  45  import com.google.common.base.Preconditions;                                                                      </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -import com.google.common.collect.HashBasedTable;                                                                  </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import com.google.common.collect.Maps;                                                                            </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import com.google.common.collect.Sets;                                                                            </span>
<span class="1793459060364841943" onmouseenter="enter('1793459060364841943');" onmouseout="out('1793459060364841943');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +import com.google.common.collect.*;                                                                               </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  51  import org.apache.calcite.sql.SqlAsOperator;                                                                      </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  52  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  53  import org.apache.calcite.sql.SqlDataTypeSpec;                                                                    </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  54  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  55  import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  56  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  57  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  58  import org.apache.calcite.sql.SqlLiteral;                                                                         </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  59  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  60  import org.apache.calcite.sql.SqlNodeList;                                                                        </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  61  import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  62  import org.apache.calcite.sql.SqlOrderBy;                                                                         </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  63  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  64  import org.apache.calcite.sql.SqlWithItem;                                                                        </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  65  import org.apache.calcite.sql.fun.SqlCase;                                                                        </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  66  import org.apache.calcite.sql.parser.SqlParseException;                                                           </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  67  import org.apache.calcite.sql.parser.SqlParserPos;                                                                </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  68  import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  69  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  70  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  71  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  72                                                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  73  import java.sql.Timestamp;                                                                                        </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  74  import java.util.Arrays;                                                                                          </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  75  import java.util.Collection;                                                                                      </span>
<span class="2644117295780670879" onmouseenter="enter('2644117295780670879');" onmouseout="out('2644117295780670879');" style="">  76  import java.util.LinkedList;                                                                                      </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  77  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  78  import java.util.Map;                                                                                             </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  79  import java.util.Queue;                                                                                           </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  80  import java.util.Set;                                                                                             </span>
<span  style="">  81                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  82  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span  style="">  83                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  85   * Reason:                                                                                                        </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  86   * Date: 2018/7/24                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  87   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  88   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  89   */                                                                                                               </span>
<span  style="">  90                                                                                                                    </span>
<span class="-5079038956292767116" onmouseenter="enter('-5079038956292767116');" onmouseout="out('-5079038956292767116');" style="">  91  public class SideSqlExec {                                                                                        </span>
<span  style="">  92                                                                                                                    </span>
<span class="-8991898280301588076" onmouseenter="enter('-8991898280301588076');" onmouseout="out('-8991898280301588076');" style="">  93      private static final Logger LOG = LoggerFactory.getLogger(SideSqlExec.class);                                 </span>
<span  style="">  94                                                                                                                    </span>
<span class="-6334022460956670337" onmouseenter="enter('-6334022460956670337');" onmouseout="out('-6334022460956670337');" style="">  95      private String localSqlPluginPath = null;                                                                     </span>
<span  style="">  96                                                                                                                    </span>
<span class="-863593709646632598" onmouseenter="enter('-863593709646632598');" onmouseout="out('-863593709646632598');" style="">  97      private String tmpFields = null;                                                                              </span>
<span  style="">  98                                                                                                                    </span>
<span class="8878309237265342483" onmouseenter="enter('8878309237265342483');" onmouseout="out('8878309237265342483');" style="">  99      private SidePredicatesParser sidePredicatesParser = new SidePredicatesParser();                               </span>
<span  style=""> 100                                                                                                                    </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style=""> 101      private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                               </span>
<span  style=""> 102                                                                                                                    </span>
<span class="-1078000254446854726" onmouseenter="enter('-1078000254446854726');" onmouseout="out('-1078000254446854726');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -    public void exec(String sql, Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,        </span>

<span class="1000260034925957386" onmouseenter="enter('1000260034925957386');" onmouseout="out('1000260034925957386');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 104 -                     Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserResult createView) throws Exception {"> 104 -                     Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserR🔵</abbr></span>
<span class="5235405798143461797" onmouseenter="enter('5235405798143461797');" onmouseout="out('5235405798143461797');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 105 +    public void exec(String sql,                                                                                  </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +                     Map&lt;String, SideTableInfo&gt; sideTableMap,                                                     </span>
<span class="4244108408582304218" onmouseenter="enter('4244108408582304218');" onmouseout="out('4244108408582304218');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +                     StreamTableEnvironment tableEnv,                                                             </span>
<span class="-1493383746124052329" onmouseenter="enter('-1493383746124052329');" onmouseout="out('-1493383746124052329');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 108 +                     Map&lt;String, Table&gt; tableCache,                                                               </span>
<span class="-6398864087192215060" onmouseenter="enter('-6398864087192215060');" onmouseout="out('-6398864087192215060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +                     StreamQueryConfig queryConfig,                                                               </span>
<span class="3861087795237990091" onmouseenter="enter('3861087795237990091');" onmouseout="out('3861087795237990091');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +                     CreateTmpTableParser.SqlParserResult createView) throws Exception {                          </span>
<span class="-7184346740499807144" onmouseenter="enter('-7184346740499807144');" onmouseout="out('-7184346740499807144');" style=""> 111          if(localSqlPluginPath == null){                                                                           </span>
<span class="4243357528698157424" onmouseenter="enter('4243357528698157424');" onmouseout="out('4243357528698157424');" style=""> 112              throw new RuntimeException(&quot;need to set localSqlPluginPath&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113          }                                                                                                         </span>
<span  style=""> 114                                                                                                                    </span>
<span class="-6307578536739293325" onmouseenter="enter('-6307578536739293325');" onmouseout="out('-6307578536739293325');" style=""> 115          localTableCache.putAll(tableCache);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 116          try {                                                                                                     </span>
<span class="-7778408363768085476" onmouseenter="enter('-7778408363768085476');" onmouseout="out('-7778408363768085476');" style=""> 117              sidePredicatesParser.fillPredicatesForSideTable(sql, sideTableMap);                                   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 118          } catch (Exception e) {                                                                                   </span>
<span class="-6535415982741029210" onmouseenter="enter('-6535415982741029210');" onmouseout="out('-6535415982741029210');" style=""> 119              LOG.error(&quot;fill predicates for sideTable fail &quot;, e);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120          }                                                                                                         </span>
<span  style=""> 121                                                                                                                    </span>
<span class="5869130575145188486" onmouseenter="enter('5869130575145188486');" onmouseout="out('5869130575145188486');" style=""> 122          if(createView != null){                                                                                   </span>
<span class="-5051922790285322929" onmouseenter="enter('-5051922790285322929');" onmouseout="out('-5051922790285322929');" style=""> 123              LOG.warn(&quot;create view info\n&quot;);                                                                       </span>
<span class="4994977519661454238" onmouseenter="enter('4994977519661454238');" onmouseout="out('4994977519661454238');" style=""> 124              LOG.warn(createView.getExecSql());                                                                    </span>
<span class="-6048507734051622776" onmouseenter="enter('-6048507734051622776');" onmouseout="out('-6048507734051622776');" style=""> 125              LOG.warn(&quot;-----------------&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126          }                                                                                                         </span>
<span  style=""> 127                                                                                                                    </span>
<span class="3272289589011229925" onmouseenter="enter('3272289589011229925');" onmouseout="out('3272289589011229925');" style=""> 128          SideSQLParser sideSQLParser = new SideSQLParser();                                                        </span>
<span class="9221221341975786732" onmouseenter="enter('9221221341975786732');" onmouseout="out('9221221341975786732');" style=""> 129          sideSQLParser.setLocalTableCache(localTableCache);                                                        </span>
<span class="-1577132173025596093" onmouseenter="enter('-1577132173025596093');" onmouseout="out('-1577132173025596093');" style=""> 130          Queue&lt;Object&gt; exeQueue = sideSQLParser.getExeQueue(sql, sideTableMap.keySet());                           </span>
<span class="1917635497637273504" onmouseenter="enter('1917635497637273504');" onmouseout="out('1917635497637273504');" style=""> 131          Object pollObj = null;                                                                                    </span>
<span  style=""> 132                                                                                                                    </span>
<span class="6779353451040372641" onmouseenter="enter('6779353451040372641');" onmouseout="out('6779353451040372641');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -        //need clean                                                                                              </span>
<span class="4055483294687718975" onmouseenter="enter('4055483294687718975');" onmouseout="out('4055483294687718975');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -        boolean preIsSideJoin = false;                                                                            </span>
<span class="2266898631888830275" onmouseenter="enter('2266898631888830275');" onmouseout="out('2266898631888830275');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -        List&lt;FieldReplaceInfo&gt; replaceInfoList = Lists.newArrayList();                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -                                                                                                                  </span>
<span class="6128441282435403378" onmouseenter="enter('6128441282435403378');" onmouseout="out('6128441282435403378');" style=""> 137          while((pollObj = exeQueue.poll()) != null){                                                               </span>
<span  style=""> 138                                                                                                                    </span>
<span class="138624831707193108" onmouseenter="enter('138624831707193108');" onmouseout="out('138624831707193108');" style=""> 139              if(pollObj instanceof SqlNode){                                                                       </span>
<span class="-8817010307772649906" onmouseenter="enter('-8817010307772649906');" onmouseout="out('-8817010307772649906');" style=""> 140                  SqlNode pollSqlNode = (SqlNode) pollObj;                                                          </span>
<span  style=""> 141                                                                                                                    </span>
<span class="-3934441269421991372" onmouseenter="enter('-3934441269421991372');" onmouseout="out('-3934441269421991372');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -                if(preIsSideJoin){                                                                                </span>
<span class="313285673257348059" onmouseenter="enter('313285673257348059');" onmouseout="out('313285673257348059');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -                    preIsSideJoin = false;                                                                        </span>
<span class="-2618061440979010579" onmouseenter="enter('-2618061440979010579');" onmouseout="out('-2618061440979010579');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                    List&lt;String&gt; fieldNames = null;                                                               </span>
<span class="-7322309591596780027" onmouseenter="enter('-7322309591596780027');" onmouseout="out('-7322309591596780027');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -                    for(FieldReplaceInfo replaceInfo : replaceInfoList){                                          </span>
<span class="2418913985965727773" onmouseenter="enter('2418913985965727773');" onmouseout="out('2418913985965727773');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -                        fieldNames = Lists.newArrayList();                                                        </span>
<span class="-6690427821834278824" onmouseenter="enter('-6690427821834278824');" onmouseout="out('-6690427821834278824');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -                        replaceFieldName(pollSqlNode, replaceInfo);                                               </span>
<span class="8246822691580888265" onmouseenter="enter('8246822691580888265');" onmouseout="out('8246822691580888265');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                        addAliasForFieldNode(pollSqlNode, fieldNames, replaceInfo.getMappingTable());             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -                }                                                                                                 </span>
<span  style=""> 151                                                                                                                    </span>
<span class="-2885719311179922220" onmouseenter="enter('-2885719311179922220');" onmouseout="out('-2885719311179922220');" style=""> 152                  if(pollSqlNode.getKind() == INSERT){                                                              </span>
<span class="-377775665442624374" onmouseenter="enter('-377775665442624374');" onmouseout="out('-377775665442624374');" style=""> 153                      System.out.println(&quot;----------real exec sql-----------&quot; );                                    </span>
<span class="1909873149730143207" onmouseenter="enter('1909873149730143207');" onmouseout="out('1909873149730143207');" style=""> 154                      System.out.println(pollSqlNode.toString());                                                   </span>
<span class="-7041171683301857607" onmouseenter="enter('-7041171683301857607');" onmouseout="out('-7041171683301857607');" style=""> 155                      FlinkSQLExec.sqlUpdate(tableEnv, pollSqlNode.toString(), queryConfig);                        </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style=""> 156                      if(LOG.isInfoEnabled()){                                                                      </span>
<span class="8297270454157551832" onmouseenter="enter('8297270454157551832');" onmouseout="out('8297270454157551832');" style=""> 157                          LOG.info(&quot;exec sql: &quot; + pollSqlNode.toString());                                          </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                      }                                                                                             </span>
<span  style=""> 159                                                                                                                    </span>
<span class="4666687505712980858" onmouseenter="enter('4666687505712980858');" onmouseout="out('4666687505712980858');" style=""> 160                  }else if(pollSqlNode.getKind() == AS){                                                            </span>
<span class="-4906327517343466594" onmouseenter="enter('-4906327517343466594');" onmouseout="out('-4906327517343466594');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -                    dealAsSourceTable(tableEnv, pollSqlNode, tableCache, replaceInfoList);                        </span>
<span class="3037765200739894050" onmouseenter="enter('3037765200739894050');" onmouseout="out('3037765200739894050');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +                    dealAsSourceTable(tableEnv, pollSqlNode, tableCache);                                         </span>
<span  style=""> 163                                                                                                                    </span>
<span class="4581342471671871622" onmouseenter="enter('4581342471671871622');" onmouseout="out('4581342471671871622');" style=""> 164                  } else if (pollSqlNode.getKind() == WITH_ITEM) {                                                  </span>
<span class="9089825500288046356" onmouseenter="enter('9089825500288046356');" onmouseout="out('9089825500288046356');" style=""> 165                      SqlWithItem sqlWithItem = (SqlWithItem) pollSqlNode;                                          </span>
<span class="-7674640876687845363" onmouseenter="enter('-7674640876687845363');" onmouseout="out('-7674640876687845363');" style=""> 166                      String TableAlias = sqlWithItem.name.toString();                                              </span>
<span class="2573668668184904794" onmouseenter="enter('2573668668184904794');" onmouseout="out('2573668668184904794');" style=""> 167                      Table table = tableEnv.sqlQuery(sqlWithItem.query.toString());                                </span>
<span class="2341577843786962651" onmouseenter="enter('2341577843786962651');" onmouseout="out('2341577843786962651');" style=""> 168                      tableEnv.registerTable(TableAlias, table);                                                    </span>
<span  style=""> 169                                                                                                                    </span>
<span class="-8892059869421071039" onmouseenter="enter('-8892059869421071039');" onmouseout="out('-8892059869421071039');" style=""> 170                  } else if (pollSqlNode.getKind() == SELECT){                                                      </span>
<span class="-1344441018307209750" onmouseenter="enter('-1344441018307209750');" onmouseout="out('-1344441018307209750');" style=""> 171                      Preconditions.checkState(createView != null, &quot;select sql must included by create view&quot;);      </span>
<span class="1694293925390283740" onmouseenter="enter('1694293925390283740');" onmouseout="out('1694293925390283740');" style=""> 172                      Table table = tableEnv.sqlQuery(pollObj.toString());                                          </span>
<span  style=""> 173                                                                                                                    </span>
<span class="-5832165917407529739" onmouseenter="enter('-5832165917407529739');" onmouseout="out('-5832165917407529739');" style=""> 174                      if (createView.getFieldsInfoStr() == null){                                                   </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 175                          tableEnv.registerTable(createView.getTableName(), table);                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 176                      } else {                                                                                      </span>
<span class="5288384657559945705" onmouseenter="enter('5288384657559945705');" onmouseout="out('5288384657559945705');" style=""> 177                          if (checkFieldsInfo(createView, table)){                                                  </span>
<span class="-9109211084540213069" onmouseenter="enter('-9109211084540213069');" onmouseout="out('-9109211084540213069');" style=""> 178                              table = table.as(tmpFields);                                                          </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 179                              tableEnv.registerTable(createView.getTableName(), table);                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 180                          } else {                                                                                  </span>
<span class="-4180003952862210397" onmouseenter="enter('-4180003952862210397');" onmouseout="out('-4180003952862210397');" style=""> 181                              throw new RuntimeException(&quot;Fields mismatch&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183                      }                                                                                             </span>
<span  style=""> 184                                                                                                                    </span>
<span class="-5831701022468144749" onmouseenter="enter('-5831701022468144749');" onmouseout="out('-5831701022468144749');" style=""> 185                      localTableCache.put(createView.getTableName(), table);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186                  }                                                                                                 </span>
<span  style=""> 187                                                                                                                    </span>
<span class="2267959141426380188" onmouseenter="enter('2267959141426380188');" onmouseout="out('2267959141426380188');" style=""> 188              }else if (pollObj instanceof JoinInfo){                                                               </span>
<span class="-6732469083744011720" onmouseenter="enter('-6732469083744011720');" onmouseout="out('-6732469083744011720');" style=""> 189                  System.out.println(&quot;----------exec join info----------&quot;);                                         </span>
<span class="6437130050258637649" onmouseenter="enter('6437130050258637649');" onmouseout="out('6437130050258637649');" style=""> 190                  System.out.println(pollObj.toString());                                                           </span>

<span class="-4508108017455823844" onmouseenter="enter('-4508108017455823844');" onmouseout="out('-4508108017455823844');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -                preIsSideJoin = true;                                                                             </span>
<span class="-9158044292308775618" onmouseenter="enter('-9158044292308775618');" onmouseout="out('-9158044292308775618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -                joinFun(pollObj, localTableCache, sideTableMap, tableEnv, replaceInfoList);                       </span>
<span class="-3518617829078174884" onmouseenter="enter('-3518617829078174884');" onmouseout="out('-3518617829078174884');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +                joinFun(pollObj, localTableCache, sideTableMap, tableEnv);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195          }                                                                                                         </span>
<span  style=""> 196                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197      }                                                                                                             </span>
<span  style=""> 198                                                                                                                    </span>
<span  style=""> 199                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 200      /**                                                                                                           </span>
<span class="-7226459799151937672" onmouseenter="enter('-7226459799151937672');" onmouseout="out('-7226459799151937672');" style=""> 201       * 解析出as查询的表和字段的关系                                                                                            </span>
<span class="-4711911052088894915" onmouseenter="enter('-4711911052088894915');" onmouseout="out('-4711911052088894915');" style=""> 202       * @param asSqlNode                                                                                           </span>
<span class="-8172984871762282794" onmouseenter="enter('-8172984871762282794');" onmouseout="out('-8172984871762282794');" style=""> 203       * @param tableCache                                                                                          </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 204       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 205       */                                                                                                           </span>
<span class="-8315666616430025383" onmouseenter="enter('-8315666616430025383');" onmouseout="out('-8315666616430025383');" style=""> 206      private FieldReplaceInfo parseAsQuery(SqlBasicCall asSqlNode, Map&lt;String, Table&gt; tableCache){                 </span>
<span class="-4950849472737015743" onmouseenter="enter('-4950849472737015743');" onmouseout="out('-4950849472737015743');" style=""> 207          SqlNode info = asSqlNode.getOperands()[0];                                                                </span>
<span class="-6049998703041327008" onmouseenter="enter('-6049998703041327008');" onmouseout="out('-6049998703041327008');" style=""> 208          SqlNode alias = asSqlNode.getOperands()[1];                                                               </span>
<span  style=""> 209                                                                                                                    </span>
<span class="6169254144825097648" onmouseenter="enter('6169254144825097648');" onmouseout="out('6169254144825097648');" style=""> 210          SqlKind infoKind = info.getKind();                                                                        </span>
<span class="-8998816044463313680" onmouseenter="enter('-8998816044463313680');" onmouseout="out('-8998816044463313680');" style=""> 211          if(infoKind != SELECT){                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 212              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213          }                                                                                                         </span>
<span  style=""> 214                                                                                                                    </span>
<span class="1448651332248375248" onmouseenter="enter('1448651332248375248');" onmouseout="out('1448651332248375248');" style=""> 215          List&lt;FieldInfo&gt; extractFieldList = TableUtils.parserSelectField((SqlSelect) info, tableCache);            </span>
<span  style=""> 216                                                                                                                    </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style=""> 217          HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                            </span>
<span class="-5476396715494077219" onmouseenter="enter('-5476396715494077219');" onmouseout="out('-5476396715494077219');" style=""> 218          for (FieldInfo fieldInfo : extractFieldList) {                                                            </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 219              String tableName = fieldInfo.getTable();                                                              </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 220              String fieldName = fieldInfo.getFieldName();                                                          </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style=""> 221              String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);                 </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style=""> 222              mappingTable.put(tableName, fieldName, mappingFieldName);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223          }                                                                                                         </span>
<span  style=""> 224                                                                                                                    </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 225          FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                                    </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 226          replaceInfo.setMappingTable(mappingTable);                                                                </span>
<span class="9115675088981905484" onmouseenter="enter('9115675088981905484');" onmouseout="out('9115675088981905484');" style=""> 227          replaceInfo.setTargetTableName(alias.toString());                                                         </span>
<span class="-6295883374697236710" onmouseenter="enter('-6295883374697236710');" onmouseout="out('-6295883374697236710');" style=""> 228          replaceInfo.setTargetTableAlias(alias.toString());                                                        </span>
<span class="2754859294214862032" onmouseenter="enter('2754859294214862032');" onmouseout="out('2754859294214862032');" style=""> 229          return replaceInfo;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230      }                                                                                                             </span>
<span  style=""> 231                                                                                                                    </span>
<span  style=""> 232                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -    /**                                                                                                           </span>
<span class="-3820374652196669145" onmouseenter="enter('-3820374652196669145');" onmouseout="out('-3820374652196669145');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 234 -     * 添加字段别名                                                                                                     </span>
<span class="9038438555178000204" onmouseenter="enter('9038438555178000204');" onmouseout="out('9038438555178000204');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -     * @param pollSqlNode                                                                                         </span>
<span class="-5133777749030939729" onmouseenter="enter('-5133777749030939729');" onmouseout="out('-5133777749030939729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -     * @param fieldList                                                                                           </span>
<span class="-2002961180008195570" onmouseenter="enter('-2002961180008195570');" onmouseout="out('-2002961180008195570');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -     * @param mappingTable                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -     */                                                                                                           </span>
<span class="-3955444104111901697" onmouseenter="enter('-3955444104111901697');" onmouseout="out('-3955444104111901697');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 239 -    private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 239 -    private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, 🔵</abbr></span>
<span class="-663927235385144722" onmouseenter="enter('-663927235385144722');" onmouseout="out('-663927235385144722');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -        SqlKind sqlKind = pollSqlNode.getKind();                                                                  </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -        switch (sqlKind) {                                                                                        </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -            case INSERT:                                                                                          </span>
<span class="-3657774864843651643" onmouseenter="enter('-3657774864843651643');" onmouseout="out('-3657774864843651643');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -                SqlNode source = ((SqlInsert) pollSqlNode).getSource();                                           </span>
<span class="6134982029327154291" onmouseenter="enter('6134982029327154291');" onmouseout="out('6134982029327154291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -                addAliasForFieldNode(source, fieldList, mappingTable);                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 245 -                break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -            case AS:                                                                                              </span>
<span class="-6853425371672212621" onmouseenter="enter('-6853425371672212621');" onmouseout="out('-6853425371672212621');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -                addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTable);     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -                break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 249 -            case SELECT:                                                                                          </span>
<span class="-345466278028982068" onmouseenter="enter('-345466278028982068');" onmouseout="out('-345466278028982068');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -                SqlNodeList selectList = ((SqlSelect) pollSqlNode).getSelectList();                               </span>
<span class="-4478316650227403681" onmouseenter="enter('-4478316650227403681');" onmouseout="out('-4478316650227403681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                selectList.getList().forEach(node -&gt; {                                                            </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                    if (node.getKind() == IDENTIFIER) {                                                           </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                        SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                                       </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -                        if (sqlIdentifier.names.size() == 1) {                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                            return;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -                        }                                                                                         </span>
<span class="-4986679521926317286" onmouseenter="enter('-4986679521926317286');" onmouseout="out('-4986679521926317286');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -                        // save real field                                                                        </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                        String fieldName = sqlIdentifier.names.get(1);                                            </span>
<span class="-5921041769209732806" onmouseenter="enter('-5921041769209732806');" onmouseout="out('-5921041769209732806');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 259 -                        if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().containsKey(fieldName)) {"> 259 -                        if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().contai🔵</abbr></span>
<span class="-2287024865944183458" onmouseenter="enter('-2287024865944183458');" onmouseout="out('-2287024865944183458');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -                            fieldList.add(fieldName);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -                        }                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -                    }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -                });                                                                                               </span>
<span class="-8923237898045704845" onmouseenter="enter('-8923237898045704845');" onmouseout="out('-8923237898045704845');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                for (int i = 0; i &lt; selectList.getList().size(); i++) {                                           </span>
<span class="-4321294484021988020" onmouseenter="enter('-4321294484021988020');" onmouseout="out('-4321294484021988020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -                    SqlNode node = selectList.get(i);                                                             </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -                    if (node.getKind() == IDENTIFIER) {                                                           </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -                        SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                                       </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -                        if (sqlIdentifier.names.size() == 1) {                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -                            return;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 271 -                        }                                                                                         </span>
<span class="-170655463018543442" onmouseenter="enter('-170655463018543442');" onmouseout="out('-170655463018543442');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -                        String name = sqlIdentifier.names.get(1);                                                 </span>
<span class="-3204699988614579440" onmouseenter="enter('-3204699988614579440');" onmouseout="out('-3204699988614579440');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -                        // avoid real field pv0 convert pv                                                        </span>
<span class="6166166284113505247" onmouseenter="enter('6166166284113505247');" onmouseout="out('6166166284113505247');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 274 -                        if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring(0, name.length() - 1))) {"> 274 -                        if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -                            SqlOperator operator = new SqlAsOperator();                                           </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 276 -                            SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -                                                                                                                  </span>
<span class="-2138283127011244558" onmouseenter="enter('-2138283127011244558');" onmouseout="out('-2138283127011244558');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 278 -                            SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() - 1), null, sqlParserPos);"> 278 -                            SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() -🔵</abbr></span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -                            SqlNode[] sqlNodes = new SqlNode[2];                                                  </span>
<span class="-2939555014928254235" onmouseenter="enter('-2939555014928254235');" onmouseout="out('-2939555014928254235');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -                            sqlNodes[0] = sqlIdentifier;                                                          </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -                            sqlNodes[1] = sqlIdentifierAlias;                                                     </span>
<span class="172920197577317623" onmouseenter="enter('172920197577317623');" onmouseout="out('172920197577317623');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 282 -                            SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos);       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -                                                                                                                  </span>
<span class="-6513758114426947797" onmouseenter="enter('-6513758114426947797');" onmouseout="out('-6513758114426947797');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -                            selectList.set(i, sqlBasicCall);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -                }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -                                                                                                                  </span>
<span class="73834954090191073" onmouseenter="enter('73834954090191073');" onmouseout="out('73834954090191073');" style=""> 293      public AliasInfo parseASNode(SqlNode sqlNode) throws SqlParseException {                                      </span>







<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 294          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="3363188275491767702" onmouseenter="enter('3363188275491767702');" onmouseout="out('3363188275491767702');" style=""> 295          if(sqlKind != AS){                                                                                        </span>
<span class="1088430228081547460" onmouseenter="enter('1088430228081547460');" onmouseout="out('1088430228081547460');" style=""> 296              throw new RuntimeException(sqlNode + &quot; is not &#x27;as&#x27; operator&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297          }                                                                                                         </span>
<span  style=""> 298                                                                                                                    </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 299          SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                                  </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 300          SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                                </span>
<span  style=""> 301                                                                                                                    </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 302          AliasInfo aliasInfo = new AliasInfo();                                                                    </span>
<span class="-5109084571101185803" onmouseenter="enter('-5109084571101185803');" onmouseout="out('-5109084571101185803');" style=""> 303          aliasInfo.setName(info.toString());                                                                       </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 304          aliasInfo.setAlias(alias.toString());                                                                     </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 306          return aliasInfo;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307      }                                                                                                             </span>
<span  style=""> 308                                                                                                                    </span>
<span class="-8689302297966137516" onmouseenter="enter('-8689302297966137516');" onmouseout="out('-8689302297966137516');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 309 -    public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 309 -    public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, String, Strin🔵</abbr></span>
<span class="4707165697759746048" onmouseenter="enter('4707165697759746048');" onmouseout="out('4707165697759746048');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 310 +    public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo,                                     </span>
<span class="244517366126553103" onmouseenter="enter('244517366126553103');" onmouseout="out('244517366126553103');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 311 +                                           HashBasedTable&lt;String, String, String&gt; mappingTable) {                 </span>
<span class="-3566414926414695948" onmouseenter="enter('-3566414926414695948');" onmouseout="out('-3566414926414695948');" style=""> 312          TypeInformation[] sideOutTypes = new TypeInformation[sideJoinFieldInfo.size()];                           </span>
<span class="-637166731779412769" onmouseenter="enter('-637166731779412769');" onmouseout="out('-637166731779412769');" style=""> 313          String[] sideOutNames = new String[sideJoinFieldInfo.size()];                                             </span>
<span class="7438730024850909889" onmouseenter="enter('7438730024850909889');" onmouseout="out('7438730024850909889');" style=""> 314          for (int i = 0; i &lt; sideJoinFieldInfo.size(); i++) {                                                      </span>
<span class="2207877773063469724" onmouseenter="enter('2207877773063469724');" onmouseout="out('2207877773063469724');" style=""> 315              FieldInfo fieldInfo = sideJoinFieldInfo.get(i);                                                       </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 316              String tableName = fieldInfo.getTable();                                                              </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 317              String fieldName = fieldInfo.getFieldName();                                                          </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 318 -            String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);                 </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 319 -            mappingTable.put(tableName, fieldName, mappingFieldName);                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 320 +                                                                                                                  </span>
<span class="3640983111807923268" onmouseenter="enter('3640983111807923268');" onmouseout="out('3640983111807923268');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 321 +            String mappingFieldName = mappingTable.get(tableName, fieldName);                                     </span>
<span class="-4165873345254348507" onmouseenter="enter('-4165873345254348507');" onmouseout="out('-4165873345254348507');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 322 +            Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be frame bug&quot;);"> 322 +            Preconditions.checkNotNull(mappingFieldName, fieldInfo + &quot; not mapping any field! it may be frame bug&quot;🔵</abbr></span>
<span  style=""> 323                                                                                                                    </span>
<span class="4913645198555706594" onmouseenter="enter('4913645198555706594');" onmouseout="out('4913645198555706594');" style=""> 324              sideOutTypes[i] = fieldInfo.getTypeInformation();                                                     </span>
<span class="6276485717663783154" onmouseenter="enter('6276485717663783154');" onmouseout="out('6276485717663783154');" style=""> 325              sideOutNames[i] = mappingFieldName;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326          }                                                                                                         </span>
<span class="2691939759498133513" onmouseenter="enter('2691939759498133513');" onmouseout="out('2691939759498133513');" style=""> 327          return new RowTypeInfo(sideOutTypes, sideOutNames);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328      }                                                                                                             </span>
<span  style=""> 329                                                                                                                    </span>
<span  style=""> 330                                                                                                                    </span>
<span  style=""> 331                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 332      /**                                                                                                           </span>
<span class="4027944609056411189" onmouseenter="enter('4027944609056411189');" onmouseout="out('4027944609056411189');" style=""> 333       *  对时间类型进行类型转换                                                                                               </span>
<span class="-7981851073621455488" onmouseenter="enter('-7981851073621455488');" onmouseout="out('-7981851073621455488');" style=""> 334       * @param leftTypeInfo                                                                                        </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 335       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 336       */                                                                                                           </span>
<span class="109255438874014135" onmouseenter="enter('109255438874014135');" onmouseout="out('109255438874014135');" style=""> 337      private RowTypeInfo buildLeftTableOutType(RowTypeInfo leftTypeInfo) {                                         </span>
<span class="5269317691380571116" onmouseenter="enter('5269317691380571116');" onmouseout="out('5269317691380571116');" style=""> 338          TypeInformation[] sideOutTypes = new TypeInformation[leftTypeInfo.getFieldNames().length];                </span>
<span class="357447233987634249" onmouseenter="enter('357447233987634249');" onmouseout="out('357447233987634249');" style=""> 339          TypeInformation&lt;?&gt;[] fieldTypes = leftTypeInfo.getFieldTypes();                                           </span>
<span class="-7313385440196867180" onmouseenter="enter('-7313385440196867180');" onmouseout="out('-7313385440196867180');" style=""> 340          for (int i = 0; i &lt; sideOutTypes.length; i++) {                                                           </span>
<span class="-314833607359598646" onmouseenter="enter('-314833607359598646');" onmouseout="out('-314833607359598646');" style=""> 341              sideOutTypes[i] = convertTimeAttributeType(fieldTypes[i]);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342          }                                                                                                         </span>
<span class="-6446480870466684625" onmouseenter="enter('-6446480870466684625');" onmouseout="out('-6446480870466684625');" style=""> 343          RowTypeInfo rowTypeInfo = new RowTypeInfo(sideOutTypes, leftTypeInfo.getFieldNames());                    </span>
<span class="6189116692514123920" onmouseenter="enter('6189116692514123920');" onmouseout="out('6189116692514123920');" style=""> 344          return rowTypeInfo;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345      }                                                                                                             </span>
<span  style=""> 346                                                                                                                    </span>
<span class="2471506251995792847" onmouseenter="enter('2471506251995792847');" onmouseout="out('2471506251995792847');" style=""> 347      private TypeInformation convertTimeAttributeType(TypeInformation typeInformation) {                           </span>
<span class="2997926285576198837" onmouseenter="enter('2997926285576198837');" onmouseout="out('2997926285576198837');" style=""> 348          if (typeInformation instanceof TimeIndicatorTypeInfo) {                                                   </span>
<span class="-6249974448261972874" onmouseenter="enter('-6249974448261972874');" onmouseout="out('-6249974448261972874');" style=""> 349              return TypeInformation.of(Timestamp.class);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350          }                                                                                                         </span>
<span class="6871348106862514693" onmouseenter="enter('6871348106862514693');" onmouseout="out('6871348106862514693');" style=""> 351          return typeInformation;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352      }                                                                                                             </span>
<span  style=""> 353                                                                                                                    </span>
<span class="4184261108342886546" onmouseenter="enter('4184261108342886546');" onmouseout="out('4184261108342886546');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 354 -    //需要考虑更多的情况                                                                                                   </span>
<span class="-5866348515582828073" onmouseenter="enter('-5866348515582828073');" onmouseout="out('-5866348515582828073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 355 -    private void replaceFieldName(SqlNode sqlNode, FieldReplaceInfo replaceInfo) {                                </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 356 -        SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 357 -        switch (sqlKind) {                                                                                        </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 358 -            case INSERT:                                                                                          </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 359 -                SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                            </span>
<span class="3539579188210716047" onmouseenter="enter('3539579188210716047');" onmouseout="out('3539579188210716047');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 360 -                replaceFieldName(sqlSource, replaceInfo);                                                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 361 -                break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 362 -            case AS:                                                                                              </span>
<span class="-2471580703701460163" onmouseenter="enter('-2471580703701460163');" onmouseout="out('-2471580703701460163');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 363 -                SqlNode asNode = ((SqlBasicCall) sqlNode).getOperands()[0];                                       </span>
<span class="2382936847570265491" onmouseenter="enter('2382936847570265491');" onmouseout="out('2382936847570265491');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 364 -                replaceFieldName(asNode, replaceInfo);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 365 -                break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 366 -            case SELECT:                                                                                          </span>
<span class="7730902652365827282" onmouseenter="enter('7730902652365827282');" onmouseout="out('7730902652365827282');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 367 -                SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName());"> 367 -                SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName🔵</abbr></span>
<span class="-1465070514376240276" onmouseenter="enter('-1465070514376240276');" onmouseout="out('-1465070514376240276');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 368 -                if(sqlSelect == null){                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 369 -                    return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 370 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 371 -                                                                                                                  </span>
<span class="-7911431356156617515" onmouseenter="enter('-7911431356156617515');" onmouseout="out('-7911431356156617515');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 372 -                SqlNode sqlSource1 = sqlSelect.getFrom();                                                         </span>
<span class="-4060139958118865814" onmouseenter="enter('-4060139958118865814');" onmouseout="out('-4060139958118865814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 373 -                if(sqlSource1.getKind() == AS){                                                                   </span>
<span class="7708153722582291408" onmouseenter="enter('7708153722582291408');" onmouseout="out('7708153722582291408');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 374 -                    String tableName = ((SqlBasicCall)sqlSource1).getOperands()[0].toString();                    </span>
<span class="-7976662112993336650" onmouseenter="enter('-7976662112993336650');" onmouseout="out('-7976662112993336650');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 375 -                    if(tableName.equalsIgnoreCase(replaceInfo.getTargetTableName())){                             </span>
<span class="5036423329776629809" onmouseenter="enter('5036423329776629809');" onmouseout="out('5036423329776629809');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 376 -                        SqlNodeList sqlSelectList = sqlSelect.getSelectList();                                    </span>
<span class="4783458191183529265" onmouseenter="enter('4783458191183529265');" onmouseout="out('4783458191183529265');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 377 -                        SqlNode whereNode = sqlSelect.getWhere();                                                 </span>
<span class="6069356713975423578" onmouseenter="enter('6069356713975423578');" onmouseout="out('6069356713975423578');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 378 -                        SqlNodeList sqlGroup = sqlSelect.getGroup();                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 379 -                                                                                                                  </span>
<span class="2024933395694494313" onmouseenter="enter('2024933395694494313');" onmouseout="out('2024933395694494313');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 380 -                        //TODO 暂时不处理having                                                                        </span>
<span class="-2928778695763881832" onmouseenter="enter('-2928778695763881832');" onmouseout="out('-2928778695763881832');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 381 -                        SqlNode sqlHaving = sqlSelect.getHaving();                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 382 -                                                                                                                  </span>
<span class="-3614471078991347107" onmouseenter="enter('-3614471078991347107');" onmouseout="out('-3614471078991347107');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 383 -                        List&lt;SqlNode&gt; newSelectNodeList = Lists.newArrayList();                                   </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 384 -                        for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                                     </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 385 -                            SqlNode selectNode = sqlSelectList.getList().get(i);                                  </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 386 -                            //特殊处理 isStar的标识                                                                      </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 387 -                            if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){      </span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 388 -                                List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);"> 388 -                                List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 389 -                                newSelectNodeList.addAll(replaceNodeList);                                        </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 390 -                                continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 391 -                            }                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 392 -                                                                                                                  </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 393 -                            SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);                </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 394 -                            if(replaceNode == null){                                                              </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 395 -                                continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 396 -                            }                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 397 -                                                                                                                  </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 398 -                            //sqlSelectList.set(i, replaceNode);                                                  </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 399 -                            newSelectNodeList.add(replaceNode);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 400 -                        }                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 401 -                                                                                                                  </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 402 -                        SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());"> 402 -                        SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosi🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 403 -                        sqlSelect.setSelectList(newSelectList);                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 404 -                                                                                                                  </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 405 -                        //where                                                                                   </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 406 -                        if(whereNode != null){                                                                    </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 407 -                            SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();                      </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 408 -                            for(int i =0; i&lt;sqlNodeList.length; i++) {                                            </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 409 -                                SqlNode whereSqlNode = sqlNodeList[i];                                            </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 410 -                                SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);                 </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 411 -                                sqlNodeList[i] = replaceNode;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 412 -                            }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 413 -                        }                                                                                         </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 414 -                        if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){                   </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 415 -                            for( int i=0; i&lt;sqlGroup.getList().size(); i++){                                      </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 416 -                                SqlNode selectNode = sqlGroup.getList().get(i);                                   </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 417 -                                SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);                   </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 418 -                                sqlGroup.set(i, replaceNode);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 419 -                            }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 420 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 421 -                    }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 422 -                }else{                                                                                            </span>
<span class="5468885380070811563" onmouseenter="enter('5468885380070811563');" onmouseout="out('5468885380070811563');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 423 -                    //TODO                                                                                        </span>
<span class="-7176218527101706664" onmouseenter="enter('-7176218527101706664');" onmouseout="out('-7176218527101706664');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 424 -                    System.out.println(sqlNode);                                                                  </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 425 -                    throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 426 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 427 -                                                                                                                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 428 -                break;                                                                                            </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 429 -            case UNION:                                                                                           </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 430 -                SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                                    </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 431 -                SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                                   </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 432 -                replaceFieldName(unionLeft, replaceInfo);                                                         </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 433 -                replaceFieldName(unionRight, replaceInfo);                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 434 -                                                                                                                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 435 -                break;                                                                                            </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 436 -            case ORDER_BY:                                                                                        </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 437 -                SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                                    </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 438 -                replaceFieldName(sqlOrderBy.query, replaceInfo);                                                  </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 439 -                SqlNodeList orderFiledList = sqlOrderBy.orderList;                                                </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 440 -                for (int i=0 ;i&lt;orderFiledList.size();i++) {                                                      </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 441 -                    SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());"> 441 -                    SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTabl🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 442 -                    orderFiledList.set(i, replaceNode);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 443 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 444 -                                                                                                                  </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 445 -            default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 446 -                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 447 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 448 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 449 -                                                                                                                  </span>
<span class="-4529709500477233937" onmouseenter="enter('-4529709500477233937');" onmouseout="out('-4529709500477233937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 450 -    private SqlNode replaceOrderByTableName(SqlNode orderNode, String tableAlias) {                               </span>
<span class="-8843072586907859237" onmouseenter="enter('-8843072586907859237');" onmouseout="out('-8843072586907859237');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 451 -        if(orderNode.getKind() == IDENTIFIER){                                                                    </span>
<span class="1286019212722079849" onmouseenter="enter('1286019212722079849');" onmouseout="out('1286019212722079849');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 452 -            SqlIdentifier sqlIdentifier = (SqlIdentifier) orderNode;                                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 453 -            if (sqlIdentifier.names.size() == 1) {                                                                </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 454 -                return orderNode;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 455 -            }                                                                                                     </span>
<span class="4987076328947336547" onmouseenter="enter('4987076328947336547');" onmouseout="out('4987076328947336547');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 456 -            return sqlIdentifier.setName(0, tableAlias);                                                          </span>
<span class="6164370744345420381" onmouseenter="enter('6164370744345420381');" onmouseout="out('6164370744345420381');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 457 -        } else if (orderNode instanceof  SqlBasicCall) {                                                          </span>
<span class="4197878478620092735" onmouseenter="enter('4197878478620092735');" onmouseout="out('4197878478620092735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 458 -            SqlBasicCall sqlBasicCall = (SqlBasicCall) orderNode;                                                 </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 459 -            for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                            </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 460 -                SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                           </span>
<span class="-7345169450449378118" onmouseenter="enter('-7345169450449378118');" onmouseout="out('-7345169450449378118');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 461 -                sqlBasicCall.getOperands()[i] = replaceOrderByTableName(sqlNode , tableAlias);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 462 -            }                                                                                                     </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 463 -            return sqlBasicCall;                                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 464 -        } else {                                                                                                  </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 465 -            return orderNode;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 466 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 467 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 468 -                                                                                                                  </span>
<span class="4620342074554351588" onmouseenter="enter('4620342074554351588');" onmouseout="out('4620342074554351588');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 469 -    private SqlNode replaceNodeInfo(SqlNode groupNode, FieldReplaceInfo replaceInfo){                             </span>
<span class="-8006552962557562934" onmouseenter="enter('-8006552962557562934');" onmouseout="out('-8006552962557562934');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 470 -        if(groupNode.getKind() == IDENTIFIER){                                                                    </span>
<span class="3769318911409416973" onmouseenter="enter('3769318911409416973');" onmouseout="out('3769318911409416973');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 471 -            SqlIdentifier sqlIdentifier = (SqlIdentifier) groupNode;                                              </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 472 -            if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 473 -                return sqlIdentifier;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 474 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 475 -                                                                                                                  </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 476 -            String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 476 -            String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sq🔵</abbr></span>
<span class="1289832806545417263" onmouseenter="enter('1289832806545417263');" onmouseout="out('1289832806545417263');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 477 -            if(mappingFieldName == null){                                                                         </span>
<span class="-3862759337385230883" onmouseenter="enter('-3862759337385230883');" onmouseout="out('-3862759337385230883');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 478 -                throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + sqlIdentifier.toString() );          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 479 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 480 -                                                                                                                  </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 481 -            sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                          </span>
<span class="2521832232004155291" onmouseenter="enter('2521832232004155291');" onmouseout="out('2521832232004155291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 482 -            return sqlIdentifier.setName(1, mappingFieldName);                                                    </span>
<span class="6819015395036995114" onmouseenter="enter('6819015395036995114');" onmouseout="out('6819015395036995114');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 483 -        }else if(groupNode instanceof  SqlBasicCall){                                                             </span>
<span class="8961639140694724649" onmouseenter="enter('8961639140694724649');" onmouseout="out('8961639140694724649');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 484 -            SqlBasicCall sqlBasicCall = (SqlBasicCall) groupNode;                                                 </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 485 -            for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                            </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 486 -                SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                           </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 487 -                SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                               </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 488 -                sqlBasicCall.getOperands()[i] = replaceNode;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 489 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 490 -                                                                                                                  </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 491 -            return sqlBasicCall;                                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 492 -        }else{                                                                                                    </span>
<span class="-2985482133144580062" onmouseenter="enter('-2985482133144580062');" onmouseout="out('-2985482133144580062');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 493 -            return groupNode;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 494 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 495 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 496 -                                                                                                                  </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 497 -    public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 498 -                                                                                                                  </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 499 -        SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 500 -        switch (sqlKind){                                                                                         </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 501 -            case SELECT:                                                                                          </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 502 -                SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                                </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 503 -                if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){</span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 504 -                    if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){   </span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 505 -                        return sqlNode;                                                                           </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 506 -                    }else{                                                                                        </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 507 -                        return null;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 508 -                    }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 509 -                }else{                                                                                            </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 510 -                    return filterNodeWithTargetName(fromNode, targetTableName);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 511 -                }                                                                                                 </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 512 -            case AS:                                                                                              </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 513 -                SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                                     </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 514 -                return filterNodeWithTargetName(childNode, targetTableName);                                      </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 515 -            case JOIN:                                                                                            </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 516 -                SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                                  </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 517 -                SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                               </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 518 -                SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);                     </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 519 -                SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 520 -                                                                                                                  </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 521 -                if(leftReturnNode != null) {                                                                      </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 522 -                    return leftReturnNode;                                                                        </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 523 -                }else if(rightReturnNode != null){                                                                </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 524 -                    return rightReturnNode;                                                                       </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 525 -                }else{                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 526 -                    return null;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 527 -                }                                                                                                 </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 528 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 529 -                                                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 530 -        return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 531 -    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 532 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 533 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 534 +                                                                                                                  </span>
<span  style=""> 535                                                                                                                    </span>
<span  style=""> 536                                                                                                                    </span>
<span class="-6722855011181273565" onmouseenter="enter('-6722855011181273565');" onmouseout="out('-6722855011181273565');" style=""> 537      public void setLocalSqlPluginPath(String localSqlPluginPath) {                                                </span>
<span class="6258662942576926140" onmouseenter="enter('6258662942576926140');" onmouseout="out('6258662942576926140');" style=""> 538          this.localSqlPluginPath = localSqlPluginPath;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 539      }                                                                                                             </span>
<span  style=""> 540                                                                                                                    </span>
<span class="2277905399441322839" onmouseenter="enter('2277905399441322839');" onmouseout="out('2277905399441322839');" style=""> 541      private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableName){     </span>
<span class="-6301156236825066460" onmouseenter="enter('-6301156236825066460');" onmouseout="out('-6301156236825066460');" style=""> 542          Table table = localTableCache.get(tableAlias);                                                            </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 543          if(table == null){                                                                                        </span>
<span class="-5960895848666330323" onmouseenter="enter('-5960895848666330323');" onmouseout="out('-5960895848666330323');" style=""> 544              table = localTableCache.get(tableName);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 545          }                                                                                                         </span>
<span  style=""> 546                                                                                                                    </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 547          if(table == null){                                                                                        </span>
<span class="-2825016904896826066" onmouseenter="enter('-2825016904896826066');" onmouseout="out('-2825016904896826066');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 548 -            throw new RuntimeException(&quot;not register table &quot; + tableName);                                        </span>
<span class="4627225224916806199" onmouseenter="enter('4627225224916806199');" onmouseout="out('4627225224916806199');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 549 +            throw new RuntimeException(&quot;not register table &quot; + tableAlias);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550          }                                                                                                         </span>
<span  style=""> 551                                                                                                                    </span>
<span class="-6017334383208509278" onmouseenter="enter('-6017334383208509278');" onmouseout="out('-6017334383208509278');" style=""> 552          return table;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 553      }                                                                                                             </span>
<span  style=""> 554                                                                                                                    </span>
<span class="-8696523049985644897" onmouseenter="enter('-8696523049985644897');" onmouseout="out('-8696523049985644897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 555 -    private List&lt;SqlNode&gt; replaceSelectStarFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo){           </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 556 -        SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                                 </span>
<span class="-376697531199676299" onmouseenter="enter('-376697531199676299');" onmouseout="out('-376697531199676299');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 557 -        List&lt;SqlNode&gt; sqlNodes = Lists.newArrayList();                                                            </span>
<span class="-3220711380851181839" onmouseenter="enter('-3220711380851181839');" onmouseout="out('-3220711380851181839');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 558 -        if(sqlIdentifier.isStar()){//处理 [* or table.*]                                                            </span>
<span class="-8760640117888015743" onmouseenter="enter('-8760640117888015743');" onmouseout="out('-8760640117888015743');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 559 -            int identifierSize = sqlIdentifier.names.size();                                                      </span>
<span class="-737230567623922483" onmouseenter="enter('-737230567623922483');" onmouseout="out('-737230567623922483');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 560 -            Collection&lt;String&gt; columns = null;                                                                    </span>
<span class="-3878600943817580523" onmouseenter="enter('-3878600943817580523');" onmouseout="out('-3878600943817580523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 561 -            if(identifierSize == 1){                                                                              </span>
<span class="439489357590017604" onmouseenter="enter('439489357590017604');" onmouseout="out('439489357590017604');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 562 -                columns = replaceInfo.getMappingTable().values();                                                 </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 563 -            }else{                                                                                                </span>
<span class="-6967503276601174325" onmouseenter="enter('-6967503276601174325');" onmouseout="out('-6967503276601174325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 564 -                columns = replaceInfo.getMappingTable().row(sqlIdentifier.names.get(0)).values();                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 565 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 566 -                                                                                                                  </span>
<span class="-8621425588629763030" onmouseenter="enter('-8621425588629763030');" onmouseout="out('-8621425588629763030');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 567 -            for(String colAlias : columns){                                                                       </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 568 -                SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                               </span>
<span class="7376564429850475234" onmouseenter="enter('7376564429850475234');" onmouseout="out('7376564429850475234');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 569 -                List&lt;String&gt; columnInfo = Lists.newArrayList();                                                   </span>
<span class="-7580690826400610936" onmouseenter="enter('-7580690826400610936');" onmouseout="out('-7580690826400610936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 570 -                columnInfo.add(replaceInfo.getTargetTableAlias());                                                </span>
<span class="8071016449845654104" onmouseenter="enter('8071016449845654104');" onmouseout="out('8071016449845654104');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 571 -                columnInfo.add(colAlias);                                                                         </span>
<span class="-2937163626106946341" onmouseenter="enter('-2937163626106946341');" onmouseout="out('-2937163626106946341');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 572 -                SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(columnInfo, sqlParserPos);                   </span>
<span class="6977395894616298454" onmouseenter="enter('6977395894616298454');" onmouseout="out('6977395894616298454');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 573 -                sqlNodes.add(sqlIdentifierAlias);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 574 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 575 -                                                                                                                  </span>
<span class="-2192274943977569589" onmouseenter="enter('-2192274943977569589');" onmouseout="out('-2192274943977569589');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 576 -            return sqlNodes;                                                                                      </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 577 -        }else{                                                                                                    </span>
<span class="-8039826041817422769" onmouseenter="enter('-8039826041817422769');" onmouseout="out('-8039826041817422769');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 578 -            throw new RuntimeException(&quot;is not a star select field.&quot; + selectNode);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 579 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 580 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 581 -                                                                                                                  </span>
<span class="-5931652736394605669" onmouseenter="enter('-5931652736394605669');" onmouseout="out('-5931652736394605669');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 582 -    private SqlNode replaceSelectFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo) {                    </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 583 -        if (selectNode.getKind() == AS) {                                                                         </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 584 -            SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                                      </span>
<span class="-1521486087941699086" onmouseenter="enter('-1521486087941699086');" onmouseout="out('-1521486087941699086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 585 -            SqlNode replaceNode = replaceSelectFieldName(leftNode, replaceInfo);                                  </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 586 -            if (replaceNode != null) {                                                                            </span>
<span class="44744548385893691" onmouseenter="enter('44744548385893691');" onmouseout="out('44744548385893691');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 587 -                ((SqlBasicCall) selectNode).getOperands()[0] = replaceNode;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 588 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 589 -                                                                                                                  </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 590 -            return selectNode;                                                                                    </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 591 -        }else if(selectNode.getKind() == IDENTIFIER){                                                             </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 592 -            SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 593 -                                                                                                                  </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 594 -            if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 595 -                return selectNode;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 596 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 597 -                                                                                                                  </span>
<span class="5152547743275588251" onmouseenter="enter('5152547743275588251');" onmouseout="out('5152547743275588251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 598 -            //Same level mappingTable                                                                             </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 599 -            String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 599 -            String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sq🔵</abbr></span>
<span class="-6523721893364253351" onmouseenter="enter('-6523721893364253351');" onmouseout="out('-6523721893364253351');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 600 -            if (mappingFieldName == null) {                                                                       </span>
<span class="8276130366719222706" onmouseenter="enter('8276130366719222706');" onmouseout="out('8276130366719222706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 601 -                throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + selectNode.toString() );             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 602 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 603 -                                                                                                                  </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 604 -            sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                          </span>
<span class="2571352877158902005" onmouseenter="enter('2571352877158902005');" onmouseout="out('2571352877158902005');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 605 -            sqlIdentifier = sqlIdentifier.setName(1, mappingFieldName);                                           </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 606 -            return sqlIdentifier;                                                                                 </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 607 -        }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义                 </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 608 -            return selectNode;                                                                                    </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 609 -        }else if(  AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 610 -                || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 611 -                || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 612 -                || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 613 -                || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 614 -                || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 615 -                || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 616 -                || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 617 -                || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 618 -                || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 619 -                || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 620 -                || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 621 -                || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 622 -                || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 623 -                || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 624 -                || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 625 -                || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 626 -                || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 627 -                || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 628 -                || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 629 -                || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 630 -                || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 631 -                || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 632 -                || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 633 -                || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 634 -                || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 635 -                || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 636 -                || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 637 -                || selectNode.getKind() == LIKE                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 638 -                                                                                                                  </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 639 -                ){                                                                                                </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 640 -            SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 641 -            for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 642 -                SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 643 -                if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 644 -                    continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 645 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 646 -                                                                                                                  </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 647 -                if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 648 -                    continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 649 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 650 -                                                                                                                  </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 651 -                SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                               </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 652 -                if(replaceNode == null){                                                                          </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 653 -                    continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 654 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 655 -                                                                                                                  </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 656 -                sqlBasicCall.getOperands()[i] = replaceNode;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 657 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 658 -                                                                                                                  </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 659 -            return selectNode;                                                                                    </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 660 -        }else if(selectNode.getKind() == CASE){                                                                   </span>
<span class="-6113591358780745482" onmouseenter="enter('-6113591358780745482');" onmouseout="out('-6113591358780745482');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 661 -            System.out.println(&quot;selectNode&quot;);                                                                     </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 662 -            SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 663 -            SqlNodeList whenOperands = sqlCase.getWhenOperands();                                                 </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 664 -            SqlNodeList thenOperands = sqlCase.getThenOperands();                                                 </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 665 -            SqlNode elseNode = sqlCase.getElseOperand();                                                          </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 666 -                                                                                                                  </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 667 -            for(int i=0; i&lt;whenOperands.size(); i++){                                                             </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 668 -                SqlNode oneOperand = whenOperands.get(i);                                                         </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 669 -                SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                            </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 670 -                if (replaceNode != null) {                                                                        </span>
<span class="827753515492975605" onmouseenter="enter('827753515492975605');" onmouseout="out('827753515492975605');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 671 -                    whenOperands.set(i, replaceNode);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 672 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 673 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 674 -                                                                                                                  </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 675 -            for(int i=0; i&lt;thenOperands.size(); i++){                                                             </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 676 -                SqlNode oneOperand = thenOperands.get(i);                                                         </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 677 -                SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                            </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 678 -                if (replaceNode != null) {                                                                        </span>
<span class="-4947674979480974151" onmouseenter="enter('-4947674979480974151');" onmouseout="out('-4947674979480974151');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 679 -                    thenOperands.set(i, replaceNode);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 680 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 681 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 682 -                                                                                                                  </span>
<span class="-1702904876822094161" onmouseenter="enter('-1702904876822094161');" onmouseout="out('-1702904876822094161');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 683 -            ((SqlCase) selectNode).setOperand(3, replaceSelectFieldName(elseNode, replaceInfo));                  </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 684 -            return selectNode;                                                                                    </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 685 -        }else if(selectNode.getKind() == OTHER){                                                                  </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 686 -            //不处理                                                                                                 </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 687 -            return selectNode;                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 688 -        }else{                                                                                                    </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 689 -            throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 689 -            throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 690 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 691 -    }                                                                                                             </span>
<span  style=""> 692                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 693      /**                                                                                                           </span>
<span class="5196638318686351881" onmouseenter="enter('5196638318686351881');" onmouseout="out('5196638318686351881');" style=""><abbr title=" 694       * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension table is the primary key definition"> 694       * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension 🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 695       *                                                                                                            </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 696       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 697       */                                                                                                           </span>
<span class="6839043037696086936" onmouseenter="enter('6839043037696086936');" onmouseout="out('6839043037696086936');" style=""><abbr title=" 698      private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, SideTableInfo sideTableInfo) {"> 698      private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, SideTableInfo sideTableInfo) 🔵</abbr></span>

<span class="-6710736308674703771" onmouseenter="enter('-6710736308674703771');" onmouseout="out('-6710736308674703771');" style=""> 699          List&lt;String&gt; conditionFields = getConditionFields(conditionNode, sideTableAlias, sideTableInfo);          </span>
<span class="-3924194481322428470" onmouseenter="enter('-3924194481322428470');" onmouseout="out('-3924194481322428470');" style=""> 700          if(CollectionUtils.isEqualCollection(conditionFields, convertPrimaryAlias(sideTableInfo))){               </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 701              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 703          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 704      }                                                                                                             </span>
<span  style=""> 705                                                                                                                    </span>
<span class="-142104979032699627" onmouseenter="enter('-142104979032699627');" onmouseout="out('-142104979032699627');" style=""> 706      private List&lt;String&gt; convertPrimaryAlias(SideTableInfo sideTableInfo) {                                       </span>

<span class="-6700733268022775520" onmouseenter="enter('-6700733268022775520');" onmouseout="out('-6700733268022775520');" style=""> 707          List&lt;String&gt; res = Lists.newArrayList();                                                                  </span>
<span class="-1517278133900331130" onmouseenter="enter('-1517278133900331130');" onmouseout="out('-1517278133900331130');" style=""> 708          sideTableInfo.getPrimaryKeys().forEach(field -&gt; {                                                         </span>
<span class="2991641550935988694" onmouseenter="enter('2991641550935988694');" onmouseout="out('2991641550935988694');" style=""> 709              res.add(sideTableInfo.getPhysicalFields().getOrDefault(field, field));                                </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 710          });                                                                                                       </span>
<span class="1866624461241282949" onmouseenter="enter('1866624461241282949');" onmouseout="out('1866624461241282949');" style=""> 711          return res;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 712      }                                                                                                             </span>
<span  style=""> 713                                                                                                                    </span>
<span class="-1424472995770428534" onmouseenter="enter('-1424472995770428534');" onmouseout="out('-1424472995770428534');" style=""><abbr title=" 714      public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, SideTableInfo sideTableInfo){"> 714      public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, SideTableInfo sideTable🔵</abbr></span>

<span class="-5667062641477778387" onmouseenter="enter('-5667062641477778387');" onmouseout="out('-5667062641477778387');" style=""> 715          List&lt;SqlNode&gt; sqlNodeList = Lists.newArrayList();                                                         </span>
<span class="5003747983397221043" onmouseenter="enter('5003747983397221043');" onmouseout="out('5003747983397221043');" style=""> 716          ParseUtils.parseAnd(conditionNode, sqlNodeList);                                                          </span>
<span class="331902561671078290" onmouseenter="enter('331902561671078290');" onmouseout="out('331902561671078290');" style=""> 717          List&lt;String&gt; conditionFields = Lists.newArrayList();                                                      </span>
<span class="-2336842894952786561" onmouseenter="enter('-2336842894952786561');" onmouseout="out('-2336842894952786561');" style=""> 718          for(SqlNode sqlNode : sqlNodeList){                                                                       </span>
<span class="-1235221313035004193" onmouseenter="enter('-1235221313035004193');" onmouseout="out('-1235221313035004193');" style=""> 719              if (!SqlKind.COMPARISON.contains(sqlNode.getKind())) {                                                </span>
<span class="4238811186041433324" onmouseenter="enter('4238811186041433324');" onmouseout="out('4238811186041433324');" style=""> 720                  throw new RuntimeException(&quot;not compare operator.&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 721              }                                                                                                     </span>
<span  style=""> 722                                                                                                                    </span>
<span class="-7359051973666627295" onmouseenter="enter('-7359051973666627295');" onmouseout="out('-7359051973666627295');" style=""> 723              SqlIdentifier left = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];                         </span>
<span class="3465298874779506196" onmouseenter="enter('3465298874779506196');" onmouseout="out('3465298874779506196');" style=""> 724              SqlIdentifier right = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];                        </span>
<span  style=""> 725                                                                                                                    </span>
<span class="-2670749344655178863" onmouseenter="enter('-2670749344655178863');" onmouseout="out('-2670749344655178863');" style=""> 726              String leftTableName = left.getComponent(0).getSimple();                                              </span>
<span class="5188110590184041827" onmouseenter="enter('5188110590184041827');" onmouseout="out('5188110590184041827');" style=""> 727              String rightTableName = right.getComponent(0).getSimple();                                            </span>
<span  style=""> 728                                                                                                                    </span>
<span class="8082853509369418918" onmouseenter="enter('8082853509369418918');" onmouseout="out('8082853509369418918');" style=""> 729              String tableCol = &quot;&quot;;                                                                                 </span>
<span class="3869855333927982135" onmouseenter="enter('3869855333927982135');" onmouseout="out('3869855333927982135');" style=""> 730              if(leftTableName.equalsIgnoreCase(specifyTableName)){                                                 </span>
<span class="4527748628163402760" onmouseenter="enter('4527748628163402760');" onmouseout="out('4527748628163402760');" style=""> 731                  tableCol = left.getComponent(1).getSimple();                                                      </span>
<span class="5068195286258055415" onmouseenter="enter('5068195286258055415');" onmouseout="out('5068195286258055415');" style=""> 732              }else if(rightTableName.equalsIgnoreCase(specifyTableName)){                                          </span>
<span class="4462633703217831544" onmouseenter="enter('4462633703217831544');" onmouseout="out('4462633703217831544');" style=""> 733                  tableCol = right.getComponent(1).getSimple();                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 734              }else{                                                                                                </span>
<span class="3783543445731730404" onmouseenter="enter('3783543445731730404');" onmouseout="out('3783543445731730404');" style=""><abbr title=" 735                  throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName));"> 735                  throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 736              }                                                                                                     </span>
<span class="-2325401555704525047" onmouseenter="enter('-2325401555704525047');" onmouseout="out('-2325401555704525047');" style=""> 737              tableCol = sideTableInfo.getPhysicalFields().getOrDefault(tableCol, tableCol);                        </span>
<span class="-4552234441929070616" onmouseenter="enter('-4552234441929070616');" onmouseout="out('-4552234441929070616');" style=""> 738              conditionFields.add(tableCol);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739          }                                                                                                         </span>
<span  style=""> 740                                                                                                                    </span>
<span class="4950082808497882460" onmouseenter="enter('4950082808497882460');" onmouseout="out('4950082808497882460');" style=""> 741          return conditionFields;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 742      }                                                                                                             </span>
<span  style=""> 743                                                                                                                    </span>
<span class="-8173208587282838964" onmouseenter="enter('-8173208587282838964');" onmouseout="out('-8173208587282838964');" style=""> 744      protected void dealAsSourceTable(StreamTableEnvironment tableEnv,                                             </span>
<span class="9126592535894268017" onmouseenter="enter('9126592535894268017');" onmouseout="out('9126592535894268017');" style=""> 745                                       SqlNode pollSqlNode,                                                         </span>
<span class="-1493383746124052329" onmouseenter="enter('-1493383746124052329');" onmouseout="out('-1493383746124052329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 746 -                                     Map&lt;String, Table&gt; tableCache,                                               </span>
<span class="-3293670501905922467" onmouseenter="enter('-3293670501905922467');" onmouseout="out('-3293670501905922467');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 747 -                                     List&lt;FieldReplaceInfo&gt; replaceInfoList) throws SqlParseException {           </span>
<span class="-4636178628928660306" onmouseenter="enter('-4636178628928660306');" onmouseout="out('-4636178628928660306');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 748 +                                     Map&lt;String, Table&gt; tableCache) throws SqlParseException {                    </span>
<span  style=""> 749                                                                                                                    </span>
<span class="-7364020242551640527" onmouseenter="enter('-7364020242551640527');" onmouseout="out('-7364020242551640527');" style=""> 750          AliasInfo aliasInfo = parseASNode(pollSqlNode);                                                           </span>

<span class="2461088292100865778" onmouseenter="enter('2461088292100865778');" onmouseout="out('2461088292100865778');" style=""> 751          if (localTableCache.containsKey(aliasInfo.getName())) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 752              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 753          }                                                                                                         </span>
<span  style=""> 754                                                                                                                    </span>
<span class="-3390660419579622283" onmouseenter="enter('-3390660419579622283');" onmouseout="out('-3390660419579622283');" style=""> 755          Table table = tableEnv.sqlQuery(aliasInfo.getName());                                                     </span>
<span class="5901087968051131557" onmouseenter="enter('5901087968051131557');" onmouseout="out('5901087968051131557');" style=""> 756          tableEnv.registerTable(aliasInfo.getAlias(), table);                                                      </span>
<span class="1100939894023116874" onmouseenter="enter('1100939894023116874');" onmouseout="out('1100939894023116874');" style=""> 757          localTableCache.put(aliasInfo.getAlias(), table);                                                         </span>
<span  style=""> 758                                                                                                                    </span>
<span class="7353361537117728269" onmouseenter="enter('7353361537117728269');" onmouseout="out('7353361537117728269');" style=""> 759          LOG.info(&quot;Register Table {} by {}&quot;, aliasInfo.getAlias(), aliasInfo.getName());                           </span>
<span  style=""> 760                                                                                                                    </span>
<span class="-8665165690117838262" onmouseenter="enter('-8665165690117838262');" onmouseout="out('-8665165690117838262');" style=""> 761          FieldReplaceInfo fieldReplaceInfo = parseAsQuery((SqlBasicCall) pollSqlNode, tableCache);                 </span>
<span class="-7633956211129533821" onmouseenter="enter('-7633956211129533821');" onmouseout="out('-7633956211129533821');" style=""> 762          if(fieldReplaceInfo == null){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 763             return;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 764          }                                                                                                         </span>
<span  style=""> 765                                                                                                                    </span>
<span class="-6438671410831308886" onmouseenter="enter('-6438671410831308886');" onmouseout="out('-6438671410831308886');" style=""> 766          //as 的源表                                                                                                  </span>
<span class="-7252441079357822746" onmouseenter="enter('-7252441079357822746');" onmouseout="out('-7252441079357822746');" style=""> 767          Set&lt;String&gt; fromTableNameSet = Sets.newHashSet();                                                         </span>
<span class="-1390965398492412473" onmouseenter="enter('-1390965398492412473');" onmouseout="out('-1390965398492412473');" style=""> 768          SqlNode fromNode = ((SqlBasicCall)pollSqlNode).getOperands()[0];                                          </span>
<span class="8218826531385538687" onmouseenter="enter('8218826531385538687');" onmouseout="out('8218826531385538687');" style=""> 769          TableUtils.getFromTableInfo(fromNode, fromTableNameSet);                                                  </span>
<span class="3962421982275373463" onmouseenter="enter('3962421982275373463');" onmouseout="out('3962421982275373463');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 770 -        for(FieldReplaceInfo tmp : replaceInfoList){                                                              </span>
<span class="7807393280391431617" onmouseenter="enter('7807393280391431617');" onmouseout="out('7807393280391431617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 771 -            if(fromTableNameSet.contains(tmp.getTargetTableName())                                                </span>
<span class="-8987246733617074829" onmouseenter="enter('-8987246733617074829');" onmouseout="out('-8987246733617074829');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 772 -                    || fromTableNameSet.contains(tmp.getTargetTableAlias())){                                     </span>
<span class="-8130963267335023429" onmouseenter="enter('-8130963267335023429');" onmouseout="out('-8130963267335023429');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 773 -                fieldReplaceInfo.setPreNode(tmp);                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 774 -                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 775 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 776 -        }                                                                                                         </span>
<span class="2047826278835391080" onmouseenter="enter('2047826278835391080');" onmouseout="out('2047826278835391080');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 777 -        replaceInfoList.add(fieldReplaceInfo);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 778 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 779 -                                                                                                                  </span>
<span class="4197581530070317287" onmouseenter="enter('4197581530070317287');" onmouseout="out('4197581530070317287');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 780 -    private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache,                                      </span>
<span class="3515836699345174480" onmouseenter="enter('3515836699345174480');" onmouseout="out('3515836699345174480');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 781 -                         Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,                </span>

<span class="-2956355081691304387" onmouseenter="enter('-2956355081691304387');" onmouseout="out('-2956355081691304387');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 782 -                         List&lt;FieldReplaceInfo&gt; replaceInfoList) throws Exception{                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 783 +                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 784 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 785 +                                                                                                                  </span>
<span class="-894097875121841059" onmouseenter="enter('-894097875121841059');" onmouseout="out('-894097875121841059');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 786 +    private void joinFun(Object pollObj,                                                                          </span>
<span class="6823594550750748067" onmouseenter="enter('6823594550750748067');" onmouseout="out('6823594550750748067');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 787 +                         Map&lt;String, Table&gt; localTableCache,                                                      </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 788 +                         Map&lt;String, SideTableInfo&gt; sideTableMap,                                                 </span>
<span class="-1170693753985315194" onmouseenter="enter('-1170693753985315194');" onmouseout="out('-1170693753985315194');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 789 +                         StreamTableEnvironment tableEnv) throws Exception{                                       </span>
<span class="-3106951960183426296" onmouseenter="enter('-3106951960183426296');" onmouseout="out('-3106951960183426296');" style=""> 790          JoinInfo joinInfo = (JoinInfo) pollObj;                                                                   </span>
<span  style=""> 791                                                                                                                    </span>
<span class="-4580559439294190862" onmouseenter="enter('-4580559439294190862');" onmouseout="out('-4580559439294190862');" style=""> 792          JoinScope joinScope = new JoinScope();                                                                    </span>
<span class="-6383140859888654083" onmouseenter="enter('-6383140859888654083');" onmouseout="out('-6383140859888654083');" style=""> 793          JoinScope.ScopeChild leftScopeChild = new JoinScope.ScopeChild();                                         </span>
<span class="-5401707331330951256" onmouseenter="enter('-5401707331330951256');" onmouseout="out('-5401707331330951256');" style=""> 794          leftScopeChild.setAlias(joinInfo.getLeftTableAlias());                                                    </span>
<span class="5108424867732442426" onmouseenter="enter('5108424867732442426');" onmouseout="out('5108424867732442426');" style=""> 795          leftScopeChild.setTableName(joinInfo.getLeftTableName());                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 796 -                                                                                                                  </span>
<span class="-3105793890099317611" onmouseenter="enter('-3105793890099317611');" onmouseout="out('-3105793890099317611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 797 -        SqlKind sqlKind = joinInfo.getLeftNode().getKind();                                                       </span>
<span class="9064898697795185402" onmouseenter="enter('9064898697795185402');" onmouseout="out('9064898697795185402');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 798 -        if(sqlKind == AS){                                                                                        </span>
<span class="17281975900406720" onmouseenter="enter('17281975900406720');" onmouseout="out('17281975900406720');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 799 -            dealAsSourceTable(tableEnv, joinInfo.getLeftNode(), localTableCache, replaceInfoList);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 800 -        }                                                                                                         </span>
<span  style=""> 801                                                                                                                    </span>
<span class="-2402361542513321069" onmouseenter="enter('-2402361542513321069');" onmouseout="out('-2402361542513321069');" style=""><abbr title=" 802          Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableName());"> 802          Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableNa🔵</abbr></span>
<span class="5224542232803887157" onmouseenter="enter('5224542232803887157');" onmouseout="out('5224542232803887157');" style=""><abbr title=" 803          RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColumnNames());"> 803          RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColu🔵</abbr></span>
<span class="-5303860989220332569" onmouseenter="enter('-5303860989220332569');" onmouseout="out('-5303860989220332569');" style=""> 804          leftScopeChild.setRowTypeInfo(leftTypeInfo);                                                              </span>
<span  style=""> 805                                                                                                                    </span>
<span class="3043795906382715340" onmouseenter="enter('3043795906382715340');" onmouseout="out('3043795906382715340');" style=""> 806          JoinScope.ScopeChild rightScopeChild = new JoinScope.ScopeChild();                                        </span>
<span class="2585249270397691815" onmouseenter="enter('2585249270397691815');" onmouseout="out('2585249270397691815');" style=""> 807          rightScopeChild.setAlias(joinInfo.getRightTableAlias());                                                  </span>
<span class="-5072747544386586876" onmouseenter="enter('-5072747544386586876');" onmouseout="out('-5072747544386586876');" style=""> 808          rightScopeChild.setTableName(joinInfo.getRightTableName());                                               </span>
<span class="-1752720370690577453" onmouseenter="enter('-1752720370690577453');" onmouseout="out('-1752720370690577453');" style=""> 809          SideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());                             </span>

<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style=""> 810          if(sideTableInfo == null){                                                                                </span>
<span class="-5396801098824602905" onmouseenter="enter('-5396801098824602905');" onmouseout="out('-5396801098824602905');" style=""> 811              sideTableInfo = sideTableMap.get(joinInfo.getRightTableAlias());                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 812          }                                                                                                         </span>
<span  style=""> 813                                                                                                                    </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style=""> 814          if(sideTableInfo == null){                                                                                </span>
<span class="450947362076537032" onmouseenter="enter('450947362076537032');" onmouseout="out('450947362076537032');" style=""> 815              throw new RuntimeException(&quot;can&#x27;t not find side table:&quot; + joinInfo.getRightTableName());              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 816          }                                                                                                         </span>
<span  style=""> 817                                                                                                                    </span>
<span class="6668906180521634363" onmouseenter="enter('6668906180521634363');" onmouseout="out('6668906180521634363');" style=""> 818  //        if(!checkJoinCondition(joinInfo.getCondition(), joinInfo.getRightTableAlias(), sideTableInfo)){         </span>
<span class="2570085130586631416" onmouseenter="enter('2570085130586631416');" onmouseout="out('2570085130586631416');" style=""> 819  //            throw new RuntimeException(&quot;ON condition must contain all equal fields!!!&quot;);                        </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 820  //        }                                                                                                       </span>
<span  style=""> 821                                                                                                                    </span>
<span class="-1562873445908102884" onmouseenter="enter('-1562873445908102884');" onmouseout="out('-1562873445908102884');" style=""> 822          rightScopeChild.setRowTypeInfo(sideTableInfo.getRowTypeInfo());                                           </span>
<span  style=""> 823                                                                                                                    </span>
<span class="-5776192160472100987" onmouseenter="enter('-5776192160472100987');" onmouseout="out('-5776192160472100987');" style=""> 824          joinScope.addScope(leftScopeChild);                                                                       </span>
<span class="6805588345897841594" onmouseenter="enter('6805588345897841594');" onmouseout="out('6805588345897841594');" style=""> 825          joinScope.addScope(rightScopeChild);                                                                      </span>
<span  style=""> 826                                                                                                                    </span>
<span class="2226908158928528195" onmouseenter="enter('2226908158928528195');" onmouseout="out('2226908158928528195');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 827 +        HashBasedTable&lt;String, String, String&gt; mappingTable = ((JoinInfo) pollObj).getTableFieldRef();            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 828 +                                                                                                                  </span>
<span class="-816440763270240777" onmouseenter="enter('-816440763270240777');" onmouseout="out('-816440763270240777');" style=""> 829          //获取两个表的所有字段                                                                                              </span>
<span class="-6198283029075022684" onmouseenter="enter('-6198283029075022684');" onmouseout="out('-6198283029075022684');" style=""><abbr title=" 830          List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, true);"> 830          List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, tr🔵</abbr></span>
<span class="5016458903510526292" onmouseenter="enter('5016458903510526292');" onmouseout="out('5016458903510526292');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 831 +        //通过join的查询字段信息过滤出需要的字段信息                                                                                 </span>
<span class="5211893312708517501" onmouseenter="enter('5211893312708517501');" onmouseout="out('5211893312708517501');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 832 +        sideJoinFieldInfo.removeIf(tmpFieldInfo -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldInfo.getFieldName()) == null);"> 832 +        sideJoinFieldInfo.removeIf(tmpFieldInfo -&gt; mappingTable.get(tmpFieldInfo.getTable(), tmpFieldInfo.getField🔵</abbr></span>
<span  style=""> 833                                                                                                                    </span>
<span class="-1467815726997680818" onmouseenter="enter('-1467815726997680818');" onmouseout="out('-1467815726997680818');" style=""> 834          String leftTableAlias = joinInfo.getLeftTableAlias();                                                     </span>
<span class="-6434853421912213287" onmouseenter="enter('-6434853421912213287');" onmouseout="out('-6434853421912213287');" style=""> 835          Table targetTable = localTableCache.get(leftTableAlias);                                                  </span>
<span class="-6749372432358522016" onmouseenter="enter('-6749372432358522016');" onmouseout="out('-6749372432358522016');" style=""> 836          if(targetTable == null){                                                                                  </span>
<span class="8734197217231436839" onmouseenter="enter('8734197217231436839');" onmouseout="out('8734197217231436839');" style=""> 837              targetTable = localTableCache.get(joinInfo.getLeftTableName());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 838          }                                                                                                         </span>
<span  style=""> 839                                                                                                                    </span>
<span class="3450476289809538439" onmouseenter="enter('3450476289809538439');" onmouseout="out('3450476289809538439');" style=""><abbr title=" 840          RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColumnNames());"> 840          RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColu🔵</abbr></span>
<span  style=""> 841                                                                                                                    </span>
<span class="-3004779098663820792" onmouseenter="enter('-3004779098663820792');" onmouseout="out('-3004779098663820792');" style=""> 842          DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.class)    </span>
<span class="3479563451496228205" onmouseenter="enter('3479563451496228205');" onmouseout="out('3479563451496228205');" style=""> 843                  .map((Tuple2&lt;Boolean, Row&gt; tp2) -&gt; {                                                              </span>
<span class="7833906289428987345" onmouseenter="enter('7833906289428987345');" onmouseout="out('7833906289428987345');" style=""> 844                      return new CRow(tp2.f1, tp2.f0);                                                              </span>
<span class="-8730504840947162971" onmouseenter="enter('-8730504840947162971');" onmouseout="out('-8730504840947162971');" style=""> 845                  }).returns(CRow.class);                                                                           </span>
<span  style=""> 846                                                                                                                    </span>
<span  style=""> 847                                                                                                                    </span>
<span class="-6082173173678345991" onmouseenter="enter('-6082173173678345991');" onmouseout="out('-6082173173678345991');" style=""> 848          //join side table before keyby ===&gt; Reducing the size of each dimension table cache of async              </span>
<span class="6301552848628110191" onmouseenter="enter('6301552848628110191');" onmouseout="out('6301552848628110191');" style=""> 849          if (sideTableInfo.isPartitionedJoin()) {                                                                  </span>
<span class="-4638861421651181765" onmouseenter="enter('-4638861421651181765');" onmouseout="out('-4638861421651181765');" style=""><abbr title=" 850              List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(), sideTableInfo);"> 850              List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(🔵</abbr></span>
<span class="-1086375650130423707" onmouseenter="enter('-1086375650130423707');" onmouseout="out('-1086375650130423707');" style=""> 851              List&lt;String&gt; fieldNames = Arrays.asList(targetTable.getSchema().getFieldNames());                     </span>
<span class="2517152886952033206" onmouseenter="enter('2517152886952033206');" onmouseout="out('2517152886952033206');" style=""> 852              int[] keyIndex = leftJoinColList.stream().mapToInt(fieldNames::indexOf).toArray();                    </span>
<span class="-7482412719932836963" onmouseenter="enter('-7482412719932836963');" onmouseout="out('-7482412719932836963');" style=""><abbr title=" 853              adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.getSchema())));"> 853              adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 854          }                                                                                                         </span>
<span  style=""> 855                                                                                                                    </span>
<span class="-1065289666164106717" onmouseenter="enter('-1065289666164106717');" onmouseout="out('-1065289666164106717');" style=""> 856          DataStream&lt;CRow&gt; dsOut = null;                                                                            </span>
<span class="3901580925108094660" onmouseenter="enter('3901580925108094660');" onmouseout="out('3901580925108094660');" style=""> 857          if(ECacheType.ALL.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="7101184136852303035" onmouseenter="enter('7101184136852303035');" onmouseout="out('7101184136852303035');" style=""><abbr title=" 858              dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);"> 858              dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlP🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 859          }else{                                                                                                    </span>
<span class="7683243294616380271" onmouseenter="enter('7683243294616380271');" onmouseout="out('7683243294616380271');" style=""><abbr title=" 860              dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);"> 860              dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPa🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 861          }                                                                                                         </span>
<span  style=""> 862                                                                                                                    </span>
<span class="1587039608171825646" onmouseenter="enter('1587039608171825646');" onmouseout="out('1587039608171825646');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 863 -        // TODO  将嵌套表中的字段传递过去, 去除冗余的ROWtime                                                                       </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 864 -        HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                            </span>
<span class="2474148199265091642" onmouseenter="enter('2474148199265091642');" onmouseout="out('2474148199265091642');" style=""> 865          RowTypeInfo sideOutTypeInfo = buildOutRowTypeInfo(sideJoinFieldInfo, mappingTable);                       </span>
<span  style=""> 866                                                                                                                    </span>
<span class="-1611735526649110750" onmouseenter="enter('-1611735526649110750');" onmouseout="out('-1611735526649110750');" style=""> 867          CRowTypeInfo cRowTypeInfo = new CRowTypeInfo(sideOutTypeInfo);                                            </span>
<span class="-4428554219841205830" onmouseenter="enter('-4428554219841205830');" onmouseout="out('-4428554219841205830');" style=""> 868          dsOut.getTransformation().setOutputType(cRowTypeInfo);                                                    </span>
<span  style=""> 869                                                                                                                    </span>
<span class="4836712590888983064" onmouseenter="enter('4836712590888983064');" onmouseout="out('4836712590888983064');" style=""> 870          String targetTableName = joinInfo.getNewTableName();                                                      </span>
<span class="-3094587764130774762" onmouseenter="enter('-3094587764130774762');" onmouseout="out('-3094587764130774762');" style=""> 871          String targetTableAlias = joinInfo.getNewTableAlias();                                                    </span>
<span  style=""> 872                                                                                                                    </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 873          FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                                    </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 874          replaceInfo.setMappingTable(mappingTable);                                                                </span>
<span class="8710576405434192583" onmouseenter="enter('8710576405434192583');" onmouseout="out('8710576405434192583');" style=""> 875          replaceInfo.setTargetTableName(targetTableName);                                                          </span>
<span class="-6613112199475906839" onmouseenter="enter('-6613112199475906839');" onmouseout="out('-6613112199475906839');" style=""> 876          replaceInfo.setTargetTableAlias(targetTableAlias);                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 877 -                                                                                                                  </span>
<span class="-3207655655806857927" onmouseenter="enter('-3207655655806857927');" onmouseout="out('-3207655655806857927');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 878 -        //判断之前是不是被替换过,被替换过则设置之前的替换信息作为上一个节点                                                                       </span>
<span class="3962421982275373463" onmouseenter="enter('3962421982275373463');" onmouseout="out('3962421982275373463');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 879 -        for(FieldReplaceInfo tmp : replaceInfoList){                                                              </span>
<span class="6967693276121741260" onmouseenter="enter('6967693276121741260');" onmouseout="out('6967693276121741260');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 880 -            if(tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableName())                             </span>
<span class="8344413733256472211" onmouseenter="enter('8344413733256472211');" onmouseout="out('8344413733256472211');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 881 -            ||tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableAlias())){                           </span>
<span class="-1629804985910745096" onmouseenter="enter('-1629804985910745096');" onmouseout="out('-1629804985910745096');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 882 -                replaceInfo.setPreNode(tmp);                                                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 883 -                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 884 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 885 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 886 -                                                                                                                  </span>
<span class="2528453225163613561" onmouseenter="enter('2528453225163613561');" onmouseout="out('2528453225163613561');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 887 -        replaceInfoList.add(replaceInfo);                                                                         </span>
<span  style=""> 888                                                                                                                    </span>
<span class="1268462607712077740" onmouseenter="enter('1268462607712077740');" onmouseout="out('1268462607712077740');" style=""> 889          if (!tableEnv.isRegistered(joinInfo.getNewTableName())){                                                  </span>
<span class="-9057257427162955657" onmouseenter="enter('-9057257427162955657');" onmouseout="out('-9057257427162955657');" style=""> 890              Table joinTable = tableEnv.fromDataStream(dsOut);                                                     </span>
<span class="-7674974637599312088" onmouseenter="enter('-7674974637599312088');" onmouseout="out('-7674974637599312088');" style=""> 891              tableEnv.registerTable(joinInfo.getNewTableName(), joinTable);                                        </span>
<span class="5569875846259576593" onmouseenter="enter('5569875846259576593');" onmouseout="out('5569875846259576593');" style=""> 892              localTableCache.put(joinInfo.getNewTableName(), joinTable);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 893          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 894      }                                                                                                             </span>
<span  style=""> 895                                                                                                                    </span>
<span class="2503560481488678812" onmouseenter="enter('2503560481488678812');" onmouseout="out('2503560481488678812');" style=""> 896      private TypeInformation&lt;Row&gt; projectedTypeInfo(int[] fields, TableSchema schema) {                            </span>
<span class="-934325254904626531" onmouseenter="enter('-934325254904626531');" onmouseout="out('-934325254904626531');" style=""> 897          String[] fieldNames = schema.getFieldNames();                                                             </span>
<span class="4556717060829301814" onmouseenter="enter('4556717060829301814');" onmouseout="out('4556717060829301814');" style=""> 898          TypeInformation&lt;?&gt;[] fieldTypes = schema.getFieldTypes();                                                 </span>
<span  style=""> 899                                                                                                                    </span>
<span class="424178526470659793" onmouseenter="enter('424178526470659793');" onmouseout="out('424178526470659793');" style=""> 900          String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::new);      </span>
<span class="5411397013359382914" onmouseenter="enter('5411397013359382914');" onmouseout="out('5411397013359382914');" style=""><abbr title=" 901          TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(TypeInformation[]::new);"> 901          TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(TypeInformat🔵</abbr></span>
<span class="-5627838059420262860" onmouseenter="enter('-5627838059420262860');" onmouseout="out('-5627838059420262860');" style=""> 902          return new RowTypeInfo(projectedTypes, projectedNames);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 903      }                                                                                                             </span>
<span  style=""> 904                                                                                                                    </span>
<span  style=""> 905                                                                                                                    </span>
<span class="-410103274617159114" onmouseenter="enter('-410103274617159114');" onmouseout="out('-410103274617159114');" style=""> 906      private boolean checkFieldsInfo(CreateTmpTableParser.SqlParserResult result, Table table) {                   </span>
<span class="8925867441251499081" onmouseenter="enter('8925867441251499081');" onmouseout="out('8925867441251499081');" style=""> 907          List&lt;String&gt; fieldNames = new LinkedList&lt;&gt;();                                                             </span>
<span class="-5553816012496774052" onmouseenter="enter('-5553816012496774052');" onmouseout="out('-5553816012496774052');" style=""> 908          String fieldsInfo = result.getFieldsInfoStr();                                                            </span>
<span class="-5855731071361337066" onmouseenter="enter('-5855731071361337066');" onmouseout="out('-5855731071361337066');" style=""> 909          String[] fields = StringUtils.split(fieldsInfo, &quot;,&quot;);                                                     </span>
<span class="8167763809890058258" onmouseenter="enter('8167763809890058258');" onmouseout="out('8167763809890058258');" style=""> 910          for (int i = 0; i &lt; fields.length; i++) {                                                                 </span>
<span class="2947314498030065040" onmouseenter="enter('2947314498030065040');" onmouseout="out('2947314498030065040');" style=""> 911              String[] filed = fields[i].split(&quot;\\s&quot;);                                                              </span>
<span class="-1166806966413379737" onmouseenter="enter('-1166806966413379737');" onmouseout="out('-1166806966413379737');" style=""> 912              if (filed.length &lt; 2 || fields.length != table.getSchema().getColumnNames().length){                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 913                  return false;                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 914              } else {                                                                                              </span>
<span class="-7518627407039835792" onmouseenter="enter('-7518627407039835792');" onmouseout="out('-7518627407039835792');" style=""> 915                  String[] filedNameArr = new String[filed.length - 1];                                             </span>
<span class="6064994574122217386" onmouseenter="enter('6064994574122217386');" onmouseout="out('6064994574122217386');" style=""> 916                  System.arraycopy(filed, 0, filedNameArr, 0, filed.length - 1);                                    </span>
<span class="-3029457015937137256" onmouseenter="enter('-3029457015937137256');" onmouseout="out('-3029457015937137256');" style=""> 917                  String fieldName = String.join(&quot; &quot;, filedNameArr);                                                </span>
<span class="-8037943253867791720" onmouseenter="enter('-8037943253867791720');" onmouseout="out('-8037943253867791720');" style=""> 918                  fieldNames.add(fieldName);                                                                        </span>
<span class="516386479555957316" onmouseenter="enter('516386479555957316');" onmouseout="out('516386479555957316');" style=""> 919                  String fieldType = filed[filed.length - 1 ].trim();                                               </span>
<span class="-8511761590344571010" onmouseenter="enter('-8511761590344571010');" onmouseout="out('-8511761590344571010');" style=""> 920                  Class fieldClass = ClassUtil.stringConvertClass(fieldType);                                       </span>
<span class="-351203522969775469" onmouseenter="enter('-351203522969775469');" onmouseout="out('-351203522969775469');" style=""> 921                  Class tableField = table.getSchema().getFieldType(i).get().getTypeClass();                        </span>
<span class="9126336856345087988" onmouseenter="enter('9126336856345087988');" onmouseout="out('9126336856345087988');" style=""> 922                  if (fieldClass == tableField){                                                                    </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 923                      continue;                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 924                  } else {                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 925                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 926                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 927              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 928          }                                                                                                         </span>
<span class="-7181802501759976675" onmouseenter="enter('-7181802501759976675');" onmouseout="out('-7181802501759976675');" style=""> 929          tmpFields = String.join(&quot;,&quot;, fieldNames);                                                                 </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 930          return true;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 931      }                                                                                                             </span>
<span  style=""> 932                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 933  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  23  import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  24  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  25  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="">  26  import org.apache.flink.streaming.api.datastream.DataStream;                                                      </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="">  27  import org.apache.flink.table.api.StreamQueryConfig;                                                              </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  28  import org.apache.flink.table.api.Table;                                                                          </span>
<span class="-8888728238394280005" onmouseenter="enter('-8888728238394280005');" onmouseout="out('-8888728238394280005');" style="">  29  import org.apache.flink.table.api.TableSchema;                                                                    </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="">  30  import org.apache.flink.table.api.java.StreamTableEnvironment;                                                    </span>
<span class="-6266446094177003082" onmouseenter="enter('-6266446094177003082');" onmouseout="out('-6266446094177003082');" style="">  31  import org.apache.flink.table.runtime.CRowKeySelector;                                                            </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  32  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="5605277811729025111" onmouseenter="enter('5605277811729025111');" onmouseout="out('5605277811729025111');" style="">  33  import org.apache.flink.table.runtime.types.CRowTypeInfo;                                                         </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  34  import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  35  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  36                                                                                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  37  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="">  38  import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                                   </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="">  39  import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                         </span>
<span class="7697893187981436175" onmouseenter="enter('7697893187981436175');" onmouseout="out('7697893187981436175');" style="">  40  import com.dtstack.flink.sql.side.operator.SideAsyncOperator;                                                     </span>
<span class="-7456990469468101750" onmouseenter="enter('-7456990469468101750');" onmouseout="out('-7456990469468101750');" style="">  41  import com.dtstack.flink.sql.side.operator.SideWithAllCacheOperator;                                              </span>
<span class="4874498590411064411" onmouseenter="enter('4874498590411064411');" onmouseout="out('4874498590411064411');" style="">  42  import com.dtstack.flink.sql.util.ClassUtil;                                                                      </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  43  import com.dtstack.flink.sql.util.ParseUtils;                                                                     </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  44  import com.dtstack.flink.sql.util.TableUtils;                                                                     </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  45  import com.google.common.base.Preconditions;                                                                      </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  46  import com.google.common.collect.HashBasedTable;                                                                  </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  47  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  48  import com.google.common.collect.Maps;                                                                            </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  49  import com.google.common.collect.Sets;                                                                            </span>

<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  50  import org.apache.calcite.sql.SqlAsOperator;                                                                      </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  51  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  52  import org.apache.calcite.sql.SqlDataTypeSpec;                                                                    </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  53  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  54  import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  55  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  56  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  57  import org.apache.calcite.sql.SqlLiteral;                                                                         </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  58  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  59  import org.apache.calcite.sql.SqlNodeList;                                                                        </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  60  import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  61  import org.apache.calcite.sql.SqlOrderBy;                                                                         </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  62  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  63  import org.apache.calcite.sql.SqlWithItem;                                                                        </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  64  import org.apache.calcite.sql.fun.SqlCase;                                                                        </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  65  import org.apache.calcite.sql.parser.SqlParseException;                                                           </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  66  import org.apache.calcite.sql.parser.SqlParserPos;                                                                </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  67  import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  68  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  69  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  70  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  71                                                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  72  import java.sql.Timestamp;                                                                                        </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  73  import java.util.Arrays;                                                                                          </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  74  import java.util.Collection;                                                                                      </span>
<span class="2644117295780670879" onmouseenter="enter('2644117295780670879');" onmouseout="out('2644117295780670879');" style="">  75  import java.util.LinkedList;                                                                                      </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  76  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  77  import java.util.Map;                                                                                             </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  78  import java.util.Queue;                                                                                           </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  79  import java.util.Set;                                                                                             </span>
<span  style="">  80                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  81  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span  style="">  82                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  84   * Reason:                                                                                                        </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  85   * Date: 2018/7/24                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  86   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  87   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  88   */                                                                                                               </span>
<span  style="">  89                                                                                                                    </span>
<span class="-5079038956292767116" onmouseenter="enter('-5079038956292767116');" onmouseout="out('-5079038956292767116');" style="">  90  public class SideSqlExec {                                                                                        </span>
<span  style="">  91                                                                                                                    </span>
<span class="-8991898280301588076" onmouseenter="enter('-8991898280301588076');" onmouseout="out('-8991898280301588076');" style="">  92      private static final Logger LOG = LoggerFactory.getLogger(SideSqlExec.class);                                 </span>
<span  style="">  93                                                                                                                    </span>
<span class="-6334022460956670337" onmouseenter="enter('-6334022460956670337');" onmouseout="out('-6334022460956670337');" style="">  94      private String localSqlPluginPath = null;                                                                     </span>
<span  style="">  95                                                                                                                    </span>
<span class="-863593709646632598" onmouseenter="enter('-863593709646632598');" onmouseout="out('-863593709646632598');" style="">  96      private String tmpFields = null;                                                                              </span>
<span  style="">  97                                                                                                                    </span>
<span class="8878309237265342483" onmouseenter="enter('8878309237265342483');" onmouseout="out('8878309237265342483');" style="">  98      private SidePredicatesParser sidePredicatesParser = new SidePredicatesParser();                               </span>
<span  style="">  99                                                                                                                    </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style=""> 100      private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                               </span>
<span  style=""> 101                                                                                                                    </span>
<span class="-1078000254446854726" onmouseenter="enter('-1078000254446854726');" onmouseout="out('-1078000254446854726');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -    public void exec(String sql, Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,        </span>
<span class="-2568962717532337416" onmouseenter="enter('-2568962717532337416');" onmouseout="out('-2568962717532337416');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 103 +    public void exec(String sql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,</span>
<span class="1000260034925957386" onmouseenter="enter('1000260034925957386');" onmouseout="out('1000260034925957386');" style=""><abbr title=" 104                       Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserResult createView) throws Exception {"> 104                       Map&lt;String, Table&gt; tableCache, StreamQueryConfig queryConfig, CreateTmpTableParser.SqlParserR🔵</abbr></span>






<span class="-7184346740499807144" onmouseenter="enter('-7184346740499807144');" onmouseout="out('-7184346740499807144');" style=""> 105          if(localSqlPluginPath == null){                                                                           </span>
<span class="4243357528698157424" onmouseenter="enter('4243357528698157424');" onmouseout="out('4243357528698157424');" style=""> 106              throw new RuntimeException(&quot;need to set localSqlPluginPath&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107          }                                                                                                         </span>
<span  style=""> 108                                                                                                                    </span>
<span class="-6307578536739293325" onmouseenter="enter('-6307578536739293325');" onmouseout="out('-6307578536739293325');" style=""> 109          localTableCache.putAll(tableCache);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 110          try {                                                                                                     </span>
<span class="-7778408363768085476" onmouseenter="enter('-7778408363768085476');" onmouseout="out('-7778408363768085476');" style=""> 111              sidePredicatesParser.fillPredicatesForSideTable(sql, sideTableMap);                                   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 112          } catch (Exception e) {                                                                                   </span>
<span class="-6535415982741029210" onmouseenter="enter('-6535415982741029210');" onmouseout="out('-6535415982741029210');" style=""> 113              LOG.error(&quot;fill predicates for sideTable fail &quot;, e);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114          }                                                                                                         </span>
<span  style=""> 115                                                                                                                    </span>
<span class="5869130575145188486" onmouseenter="enter('5869130575145188486');" onmouseout="out('5869130575145188486');" style=""> 116          if(createView != null){                                                                                   </span>
<span class="-5051922790285322929" onmouseenter="enter('-5051922790285322929');" onmouseout="out('-5051922790285322929');" style=""> 117              LOG.warn(&quot;create view info\n&quot;);                                                                       </span>
<span class="4994977519661454238" onmouseenter="enter('4994977519661454238');" onmouseout="out('4994977519661454238');" style=""> 118              LOG.warn(createView.getExecSql());                                                                    </span>
<span class="-6048507734051622776" onmouseenter="enter('-6048507734051622776');" onmouseout="out('-6048507734051622776');" style=""> 119              LOG.warn(&quot;-----------------&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120          }                                                                                                         </span>
<span  style=""> 121                                                                                                                    </span>
<span class="3272289589011229925" onmouseenter="enter('3272289589011229925');" onmouseout="out('3272289589011229925');" style=""> 122          SideSQLParser sideSQLParser = new SideSQLParser();                                                        </span>
<span class="9221221341975786732" onmouseenter="enter('9221221341975786732');" onmouseout="out('9221221341975786732');" style=""> 123          sideSQLParser.setLocalTableCache(localTableCache);                                                        </span>
<span class="-1577132173025596093" onmouseenter="enter('-1577132173025596093');" onmouseout="out('-1577132173025596093');" style=""> 124          Queue&lt;Object&gt; exeQueue = sideSQLParser.getExeQueue(sql, sideTableMap.keySet());                           </span>
<span class="1917635497637273504" onmouseenter="enter('1917635497637273504');" onmouseout="out('1917635497637273504');" style=""> 125          Object pollObj = null;                                                                                    </span>
<span  style=""> 126                                                                                                                    </span>
<span class="6779353451040372641" onmouseenter="enter('6779353451040372641');" onmouseout="out('6779353451040372641');" style=""> 127          //need clean                                                                                              </span>
<span class="4055483294687718975" onmouseenter="enter('4055483294687718975');" onmouseout="out('4055483294687718975');" style=""> 128          boolean preIsSideJoin = false;                                                                            </span>
<span class="2266898631888830275" onmouseenter="enter('2266898631888830275');" onmouseout="out('2266898631888830275');" style=""> 129          List&lt;FieldReplaceInfo&gt; replaceInfoList = Lists.newArrayList();                                            </span>
<span  style=""> 130                                                                                                                    </span>
<span class="6128441282435403378" onmouseenter="enter('6128441282435403378');" onmouseout="out('6128441282435403378');" style=""> 131          while((pollObj = exeQueue.poll()) != null){                                                               </span>
<span  style=""> 132                                                                                                                    </span>
<span class="138624831707193108" onmouseenter="enter('138624831707193108');" onmouseout="out('138624831707193108');" style=""> 133              if(pollObj instanceof SqlNode){                                                                       </span>
<span class="-8817010307772649906" onmouseenter="enter('-8817010307772649906');" onmouseout="out('-8817010307772649906');" style=""> 134                  SqlNode pollSqlNode = (SqlNode) pollObj;                                                          </span>
<span  style=""> 135                                                                                                                    </span>
<span class="-3934441269421991372" onmouseenter="enter('-3934441269421991372');" onmouseout="out('-3934441269421991372');" style=""> 136                  if(preIsSideJoin){                                                                                </span>
<span class="313285673257348059" onmouseenter="enter('313285673257348059');" onmouseout="out('313285673257348059');" style=""> 137                      preIsSideJoin = false;                                                                        </span>
<span class="-2618061440979010579" onmouseenter="enter('-2618061440979010579');" onmouseout="out('-2618061440979010579');" style=""> 138                      List&lt;String&gt; fieldNames = null;                                                               </span>
<span class="-7322309591596780027" onmouseenter="enter('-7322309591596780027');" onmouseout="out('-7322309591596780027');" style=""> 139                      for(FieldReplaceInfo replaceInfo : replaceInfoList){                                          </span>
<span class="2418913985965727773" onmouseenter="enter('2418913985965727773');" onmouseout="out('2418913985965727773');" style=""> 140                          fieldNames = Lists.newArrayList();                                                        </span>
<span class="-6690427821834278824" onmouseenter="enter('-6690427821834278824');" onmouseout="out('-6690427821834278824');" style=""> 141                          replaceFieldName(pollSqlNode, replaceInfo);                                               </span>
<span class="8246822691580888265" onmouseenter="enter('8246822691580888265');" onmouseout="out('8246822691580888265');" style=""> 142                          addAliasForFieldNode(pollSqlNode, fieldNames, replaceInfo.getMappingTable());             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144                  }                                                                                                 </span>
<span  style=""> 145                                                                                                                    </span>
<span class="-2885719311179922220" onmouseenter="enter('-2885719311179922220');" onmouseout="out('-2885719311179922220');" style=""> 146                  if(pollSqlNode.getKind() == INSERT){                                                              </span>
<span class="-377775665442624374" onmouseenter="enter('-377775665442624374');" onmouseout="out('-377775665442624374');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -                    System.out.println(&quot;----------real exec sql-----------&quot; );                                    </span>
<span class="1909873149730143207" onmouseenter="enter('1909873149730143207');" onmouseout="out('1909873149730143207');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                    System.out.println(pollSqlNode.toString());                                                   </span>
<span class="-7041171683301857607" onmouseenter="enter('-7041171683301857607');" onmouseout="out('-7041171683301857607');" style=""> 149                      FlinkSQLExec.sqlUpdate(tableEnv, pollSqlNode.toString(), queryConfig);                        </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style=""> 150                      if(LOG.isInfoEnabled()){                                                                      </span>
<span class="8297270454157551832" onmouseenter="enter('8297270454157551832');" onmouseout="out('8297270454157551832');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -                        LOG.info(&quot;exec sql: &quot; + pollSqlNode.toString());                                          </span>
<span class="-5986232783970891998" onmouseenter="enter('-5986232783970891998');" onmouseout="out('-5986232783970891998');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +                        LOG.info(&quot;----------real exec sql-----------\n{}&quot;, pollSqlNode.toString());               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153                      }                                                                                             </span>
<span  style=""> 154                                                                                                                    </span>
<span class="4666687505712980858" onmouseenter="enter('4666687505712980858');" onmouseout="out('4666687505712980858');" style=""> 155                  }else if(pollSqlNode.getKind() == AS){                                                            </span>
<span class="-4906327517343466594" onmouseenter="enter('-4906327517343466594');" onmouseout="out('-4906327517343466594');" style=""> 156                      dealAsSourceTable(tableEnv, pollSqlNode, tableCache, replaceInfoList);                        </span>

<span  style=""> 157                                                                                                                    </span>
<span class="4581342471671871622" onmouseenter="enter('4581342471671871622');" onmouseout="out('4581342471671871622');" style=""> 158                  } else if (pollSqlNode.getKind() == WITH_ITEM) {                                                  </span>
<span class="9089825500288046356" onmouseenter="enter('9089825500288046356');" onmouseout="out('9089825500288046356');" style=""> 159                      SqlWithItem sqlWithItem = (SqlWithItem) pollSqlNode;                                          </span>
<span class="-7674640876687845363" onmouseenter="enter('-7674640876687845363');" onmouseout="out('-7674640876687845363');" style=""> 160                      String TableAlias = sqlWithItem.name.toString();                                              </span>
<span class="2573668668184904794" onmouseenter="enter('2573668668184904794');" onmouseout="out('2573668668184904794');" style=""> 161                      Table table = tableEnv.sqlQuery(sqlWithItem.query.toString());                                </span>
<span class="2341577843786962651" onmouseenter="enter('2341577843786962651');" onmouseout="out('2341577843786962651');" style=""> 162                      tableEnv.registerTable(TableAlias, table);                                                    </span>
<span  style=""> 163                                                                                                                    </span>
<span class="-8892059869421071039" onmouseenter="enter('-8892059869421071039');" onmouseout="out('-8892059869421071039');" style=""> 164                  } else if (pollSqlNode.getKind() == SELECT){                                                      </span>
<span class="-1344441018307209750" onmouseenter="enter('-1344441018307209750');" onmouseout="out('-1344441018307209750');" style=""> 165                      Preconditions.checkState(createView != null, &quot;select sql must included by create view&quot;);      </span>
<span class="1694293925390283740" onmouseenter="enter('1694293925390283740');" onmouseout="out('1694293925390283740');" style=""> 166                      Table table = tableEnv.sqlQuery(pollObj.toString());                                          </span>
<span  style=""> 167                                                                                                                    </span>
<span class="-5832165917407529739" onmouseenter="enter('-5832165917407529739');" onmouseout="out('-5832165917407529739');" style=""> 168                      if (createView.getFieldsInfoStr() == null){                                                   </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 169                          tableEnv.registerTable(createView.getTableName(), table);                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 170                      } else {                                                                                      </span>
<span class="5288384657559945705" onmouseenter="enter('5288384657559945705');" onmouseout="out('5288384657559945705');" style=""> 171                          if (checkFieldsInfo(createView, table)){                                                  </span>
<span class="-9109211084540213069" onmouseenter="enter('-9109211084540213069');" onmouseout="out('-9109211084540213069');" style=""> 172                              table = table.as(tmpFields);                                                          </span>
<span class="-6627833070720611070" onmouseenter="enter('-6627833070720611070');" onmouseout="out('-6627833070720611070');" style=""> 173                              tableEnv.registerTable(createView.getTableName(), table);                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 174                          } else {                                                                                  </span>
<span class="-4180003952862210397" onmouseenter="enter('-4180003952862210397');" onmouseout="out('-4180003952862210397');" style=""> 175                              throw new RuntimeException(&quot;Fields mismatch&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177                      }                                                                                             </span>
<span  style=""> 178                                                                                                                    </span>
<span class="-5831701022468144749" onmouseenter="enter('-5831701022468144749');" onmouseout="out('-5831701022468144749');" style=""> 179                      localTableCache.put(createView.getTableName(), table);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180                  }                                                                                                 </span>
<span  style=""> 181                                                                                                                    </span>
<span class="2267959141426380188" onmouseenter="enter('2267959141426380188');" onmouseout="out('2267959141426380188');" style=""> 182              }else if (pollObj instanceof JoinInfo){                                                               </span>
<span class="-6732469083744011720" onmouseenter="enter('-6732469083744011720');" onmouseout="out('-6732469083744011720');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                System.out.println(&quot;----------exec join info----------&quot;);                                         </span>
<span class="6437130050258637649" onmouseenter="enter('6437130050258637649');" onmouseout="out('6437130050258637649');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -                System.out.println(pollObj.toString());                                                           </span>
<span class="-6196622619540139248" onmouseenter="enter('-6196622619540139248');" onmouseout="out('-6196622619540139248');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +                LOG.info(&quot;----------exec join info----------\n{}&quot;, pollObj.toString());                           </span>
<span class="-4508108017455823844" onmouseenter="enter('-4508108017455823844');" onmouseout="out('-4508108017455823844');" style=""> 186                  preIsSideJoin = true;                                                                             </span>
<span class="-9158044292308775618" onmouseenter="enter('-9158044292308775618');" onmouseout="out('-9158044292308775618');" style=""> 187                  joinFun(pollObj, localTableCache, sideTableMap, tableEnv, replaceInfoList);                       </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189          }                                                                                                         </span>
<span  style=""> 190                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191      }                                                                                                             </span>
<span  style=""> 192                                                                                                                    </span>
<span  style=""> 193                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 194      /**                                                                                                           </span>
<span class="-7226459799151937672" onmouseenter="enter('-7226459799151937672');" onmouseout="out('-7226459799151937672');" style=""> 195       * 解析出as查询的表和字段的关系                                                                                            </span>
<span class="-4711911052088894915" onmouseenter="enter('-4711911052088894915');" onmouseout="out('-4711911052088894915');" style=""> 196       * @param asSqlNode                                                                                           </span>
<span class="-8172984871762282794" onmouseenter="enter('-8172984871762282794');" onmouseout="out('-8172984871762282794');" style=""> 197       * @param tableCache                                                                                          </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 198       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 199       */                                                                                                           </span>
<span class="-8315666616430025383" onmouseenter="enter('-8315666616430025383');" onmouseout="out('-8315666616430025383');" style=""> 200      private FieldReplaceInfo parseAsQuery(SqlBasicCall asSqlNode, Map&lt;String, Table&gt; tableCache){                 </span>
<span class="-4950849472737015743" onmouseenter="enter('-4950849472737015743');" onmouseout="out('-4950849472737015743');" style=""> 201          SqlNode info = asSqlNode.getOperands()[0];                                                                </span>
<span class="-6049998703041327008" onmouseenter="enter('-6049998703041327008');" onmouseout="out('-6049998703041327008');" style=""> 202          SqlNode alias = asSqlNode.getOperands()[1];                                                               </span>
<span  style=""> 203                                                                                                                    </span>
<span class="6169254144825097648" onmouseenter="enter('6169254144825097648');" onmouseout="out('6169254144825097648');" style=""> 204          SqlKind infoKind = info.getKind();                                                                        </span>
<span class="-8998816044463313680" onmouseenter="enter('-8998816044463313680');" onmouseout="out('-8998816044463313680');" style=""> 205          if(infoKind != SELECT){                                                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 206              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207          }                                                                                                         </span>
<span  style=""> 208                                                                                                                    </span>
<span class="1448651332248375248" onmouseenter="enter('1448651332248375248');" onmouseout="out('1448651332248375248');" style=""> 209          List&lt;FieldInfo&gt; extractFieldList = TableUtils.parserSelectField((SqlSelect) info, tableCache);            </span>
<span  style=""> 210                                                                                                                    </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style=""> 211          HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                            </span>
<span class="-5476396715494077219" onmouseenter="enter('-5476396715494077219');" onmouseout="out('-5476396715494077219');" style=""> 212          for (FieldInfo fieldInfo : extractFieldList) {                                                            </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 213              String tableName = fieldInfo.getTable();                                                              </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 214              String fieldName = fieldInfo.getFieldName();                                                          </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style=""> 215              String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);                 </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style=""> 216              mappingTable.put(tableName, fieldName, mappingFieldName);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217          }                                                                                                         </span>
<span  style=""> 218                                                                                                                    </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 219          FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                                    </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 220          replaceInfo.setMappingTable(mappingTable);                                                                </span>
<span class="9115675088981905484" onmouseenter="enter('9115675088981905484');" onmouseout="out('9115675088981905484');" style=""> 221          replaceInfo.setTargetTableName(alias.toString());                                                         </span>
<span class="-6295883374697236710" onmouseenter="enter('-6295883374697236710');" onmouseout="out('-6295883374697236710');" style=""> 222          replaceInfo.setTargetTableAlias(alias.toString());                                                        </span>
<span class="2754859294214862032" onmouseenter="enter('2754859294214862032');" onmouseout="out('2754859294214862032');" style=""> 223          return replaceInfo;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224      }                                                                                                             </span>
<span  style=""> 225                                                                                                                    </span>
<span  style=""> 226                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 227      /**                                                                                                           </span>
<span class="-3820374652196669145" onmouseenter="enter('-3820374652196669145');" onmouseout="out('-3820374652196669145');" style=""> 228       * 添加字段别名                                                                                                     </span>
<span class="9038438555178000204" onmouseenter="enter('9038438555178000204');" onmouseout="out('9038438555178000204');" style=""> 229       * @param pollSqlNode                                                                                         </span>
<span class="-5133777749030939729" onmouseenter="enter('-5133777749030939729');" onmouseout="out('-5133777749030939729');" style=""> 230       * @param fieldList                                                                                           </span>
<span class="-2002961180008195570" onmouseenter="enter('-2002961180008195570');" onmouseout="out('-2002961180008195570');" style=""> 231       * @param mappingTable                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 232       */                                                                                                           </span>
<span class="-3955444104111901697" onmouseenter="enter('-3955444104111901697');" onmouseout="out('-3955444104111901697');" style=""><abbr title=" 233      private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 233      private void addAliasForFieldNode(SqlNode pollSqlNode, List&lt;String&gt; fieldList, HashBasedTable&lt;String, String, 🔵</abbr></span>
<span class="-663927235385144722" onmouseenter="enter('-663927235385144722');" onmouseout="out('-663927235385144722');" style=""> 234          SqlKind sqlKind = pollSqlNode.getKind();                                                                  </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style=""> 235          switch (sqlKind) {                                                                                        </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style=""> 236              case INSERT:                                                                                          </span>
<span class="-3657774864843651643" onmouseenter="enter('-3657774864843651643');" onmouseout="out('-3657774864843651643');" style=""> 237                  SqlNode source = ((SqlInsert) pollSqlNode).getSource();                                           </span>
<span class="6134982029327154291" onmouseenter="enter('6134982029327154291');" onmouseout="out('6134982029327154291');" style=""> 238                  addAliasForFieldNode(source, fieldList, mappingTable);                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 239                  break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 240              case AS:                                                                                              </span>
<span class="-6853425371672212621" onmouseenter="enter('-6853425371672212621');" onmouseout="out('-6853425371672212621');" style=""> 241                  addAliasForFieldNode(((SqlBasicCall) pollSqlNode).getOperands()[0], fieldList, mappingTable);     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 242                  break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 243              case SELECT:                                                                                          </span>
<span class="-345466278028982068" onmouseenter="enter('-345466278028982068');" onmouseout="out('-345466278028982068');" style=""> 244                  SqlNodeList selectList = ((SqlSelect) pollSqlNode).getSelectList();                               </span>
<span class="-4478316650227403681" onmouseenter="enter('-4478316650227403681');" onmouseout="out('-4478316650227403681');" style=""> 245                  selectList.getList().forEach(node -&gt; {                                                            </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style=""> 246                      if (node.getKind() == IDENTIFIER) {                                                           </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style=""> 247                          SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                                       </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style=""> 248                          if (sqlIdentifier.names.size() == 1) {                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 249                              return;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250                          }                                                                                         </span>
<span class="-4986679521926317286" onmouseenter="enter('-4986679521926317286');" onmouseout="out('-4986679521926317286');" style=""> 251                          // save real field                                                                        </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style=""> 252                          String fieldName = sqlIdentifier.names.get(1);                                            </span>
<span class="-5921041769209732806" onmouseenter="enter('-5921041769209732806');" onmouseout="out('-5921041769209732806');" style=""><abbr title=" 253                          if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().containsKey(fieldName)) {"> 253                          if (!fieldName.endsWith(&quot;0&quot;) || fieldName.endsWith(&quot;0&quot;) &amp;&amp; mappingTable.columnMap().contai🔵</abbr></span>
<span class="-2287024865944183458" onmouseenter="enter('-2287024865944183458');" onmouseout="out('-2287024865944183458');" style=""> 254                              fieldList.add(fieldName);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                          }                                                                                         </span>
<span  style=""> 256                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 258                  });                                                                                               </span>
<span class="-8923237898045704845" onmouseenter="enter('-8923237898045704845');" onmouseout="out('-8923237898045704845');" style=""> 259                  for (int i = 0; i &lt; selectList.getList().size(); i++) {                                           </span>
<span class="-4321294484021988020" onmouseenter="enter('-4321294484021988020');" onmouseout="out('-4321294484021988020');" style=""> 260                      SqlNode node = selectList.get(i);                                                             </span>
<span class="-1705164696650123310" onmouseenter="enter('-1705164696650123310');" onmouseout="out('-1705164696650123310');" style=""> 261                      if (node.getKind() == IDENTIFIER) {                                                           </span>
<span class="-6805567368565268789" onmouseenter="enter('-6805567368565268789');" onmouseout="out('-6805567368565268789');" style=""> 262                          SqlIdentifier sqlIdentifier = (SqlIdentifier) node;                                       </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style=""> 263                          if (sqlIdentifier.names.size() == 1) {                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 264                              return;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265                          }                                                                                         </span>
<span class="-170655463018543442" onmouseenter="enter('-170655463018543442');" onmouseout="out('-170655463018543442');" style=""> 266                          String name = sqlIdentifier.names.get(1);                                                 </span>
<span class="-3204699988614579440" onmouseenter="enter('-3204699988614579440');" onmouseout="out('-3204699988614579440');" style=""> 267                          // avoid real field pv0 convert pv                                                        </span>
<span class="6166166284113505247" onmouseenter="enter('6166166284113505247');" onmouseout="out('6166166284113505247');" style=""><abbr title=" 268                          if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring(0, name.length() - 1))) {"> 268                          if (name.endsWith(&quot;0&quot;) &amp;&amp;  !fieldList.contains(name) &amp;&amp; !fieldList.contains(name.substring🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style=""> 269                              SqlOperator operator = new SqlAsOperator();                                           </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style=""> 270                              SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                   </span>
<span  style=""> 271                                                                                                                    </span>
<span class="-2138283127011244558" onmouseenter="enter('-2138283127011244558');" onmouseout="out('-2138283127011244558');" style=""><abbr title=" 272                              SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() - 1), null, sqlParserPos);"> 272                              SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(name.substring(0, name.length() -🔵</abbr></span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style=""> 273                              SqlNode[] sqlNodes = new SqlNode[2];                                                  </span>
<span class="-2939555014928254235" onmouseenter="enter('-2939555014928254235');" onmouseout="out('-2939555014928254235');" style=""> 274                              sqlNodes[0] = sqlIdentifier;                                                          </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style=""> 275                              sqlNodes[1] = sqlIdentifierAlias;                                                     </span>
<span class="172920197577317623" onmouseenter="enter('172920197577317623');" onmouseout="out('172920197577317623');" style=""> 276                              SqlBasicCall sqlBasicCall = new SqlBasicCall(operator, sqlNodes, sqlParserPos);       </span>
<span  style=""> 277                                                                                                                    </span>
<span class="-6513758114426947797" onmouseenter="enter('-6513758114426947797');" onmouseout="out('-6513758114426947797');" style=""> 278                              selectList.set(i, sqlBasicCall);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 282                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -                                                                                                                  </span>
<span class="73834954090191073" onmouseenter="enter('73834954090191073');" onmouseout="out('73834954090191073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -    public AliasInfo parseASNode(SqlNode sqlNode) throws SqlParseException {                                      </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 288 +            default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 289 +                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 290 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 291 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 292 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 293 +                                                                                                                  </span>
<span class="3897594848566528823" onmouseenter="enter('3897594848566528823');" onmouseout="out('3897594848566528823');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 294 +    public AliasInfo parseAsNode(SqlNode sqlNode) throws SqlParseException {                                      </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 295          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="3363188275491767702" onmouseenter="enter('3363188275491767702');" onmouseout="out('3363188275491767702');" style=""> 296          if(sqlKind != AS){                                                                                        </span>
<span class="1088430228081547460" onmouseenter="enter('1088430228081547460');" onmouseout="out('1088430228081547460');" style=""> 297              throw new RuntimeException(sqlNode + &quot; is not &#x27;as&#x27; operator&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298          }                                                                                                         </span>
<span  style=""> 299                                                                                                                    </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 300          SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                                  </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 301          SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                                </span>
<span  style=""> 302                                                                                                                    </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 303          AliasInfo aliasInfo = new AliasInfo();                                                                    </span>
<span class="-5109084571101185803" onmouseenter="enter('-5109084571101185803');" onmouseout="out('-5109084571101185803');" style=""> 304          aliasInfo.setName(info.toString());                                                                       </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 305          aliasInfo.setAlias(alias.toString());                                                                     </span>
<span  style=""> 306                                                                                                                    </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 307          return aliasInfo;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308      }                                                                                                             </span>
<span  style=""> 309                                                                                                                    </span>
<span class="-8689302297966137516" onmouseenter="enter('-8689302297966137516');" onmouseout="out('-8689302297966137516');" style=""><abbr title=" 310      public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, String, String&gt; mappingTable) {"> 310      public RowTypeInfo buildOutRowTypeInfo(List&lt;FieldInfo&gt; sideJoinFieldInfo, HashBasedTable&lt;String, String, Strin🔵</abbr></span>


<span class="-3566414926414695948" onmouseenter="enter('-3566414926414695948');" onmouseout="out('-3566414926414695948');" style=""> 311          TypeInformation[] sideOutTypes = new TypeInformation[sideJoinFieldInfo.size()];                           </span>
<span class="-637166731779412769" onmouseenter="enter('-637166731779412769');" onmouseout="out('-637166731779412769');" style=""> 312          String[] sideOutNames = new String[sideJoinFieldInfo.size()];                                             </span>
<span class="7438730024850909889" onmouseenter="enter('7438730024850909889');" onmouseout="out('7438730024850909889');" style=""> 313          for (int i = 0; i &lt; sideJoinFieldInfo.size(); i++) {                                                      </span>
<span class="2207877773063469724" onmouseenter="enter('2207877773063469724');" onmouseout="out('2207877773063469724');" style=""> 314              FieldInfo fieldInfo = sideJoinFieldInfo.get(i);                                                       </span>
<span class="5857084890364228557" onmouseenter="enter('5857084890364228557');" onmouseout="out('5857084890364228557');" style=""> 315              String tableName = fieldInfo.getTable();                                                              </span>
<span class="-8111306812434290998" onmouseenter="enter('-8111306812434290998');" onmouseout="out('-8111306812434290998');" style=""> 316              String fieldName = fieldInfo.getFieldName();                                                          </span>
<span class="4185539436596522295" onmouseenter="enter('4185539436596522295');" onmouseout="out('4185539436596522295');" style=""> 317              String mappingFieldName = ParseUtils.dealDuplicateFieldName(mappingTable, fieldName);                 </span>
<span class="-7827879044056282695" onmouseenter="enter('-7827879044056282695');" onmouseout="out('-7827879044056282695');" style=""> 318              mappingTable.put(tableName, fieldName, mappingFieldName);                                             </span>



<span  style=""> 319                                                                                                                    </span>
<span class="4913645198555706594" onmouseenter="enter('4913645198555706594');" onmouseout="out('4913645198555706594');" style=""> 320              sideOutTypes[i] = fieldInfo.getTypeInformation();                                                     </span>
<span class="6276485717663783154" onmouseenter="enter('6276485717663783154');" onmouseout="out('6276485717663783154');" style=""> 321              sideOutNames[i] = mappingFieldName;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322          }                                                                                                         </span>
<span class="2691939759498133513" onmouseenter="enter('2691939759498133513');" onmouseout="out('2691939759498133513');" style=""> 323          return new RowTypeInfo(sideOutTypes, sideOutNames);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324      }                                                                                                             </span>
<span  style=""> 325                                                                                                                    </span>
<span  style=""> 326                                                                                                                    </span>
<span  style=""> 327                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 328      /**                                                                                                           </span>
<span class="4027944609056411189" onmouseenter="enter('4027944609056411189');" onmouseout="out('4027944609056411189');" style=""> 329       *  对时间类型进行类型转换                                                                                               </span>
<span class="-7981851073621455488" onmouseenter="enter('-7981851073621455488');" onmouseout="out('-7981851073621455488');" style=""> 330       * @param leftTypeInfo                                                                                        </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 331       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 332       */                                                                                                           </span>
<span class="109255438874014135" onmouseenter="enter('109255438874014135');" onmouseout="out('109255438874014135');" style=""> 333      private RowTypeInfo buildLeftTableOutType(RowTypeInfo leftTypeInfo) {                                         </span>
<span class="5269317691380571116" onmouseenter="enter('5269317691380571116');" onmouseout="out('5269317691380571116');" style=""> 334          TypeInformation[] sideOutTypes = new TypeInformation[leftTypeInfo.getFieldNames().length];                </span>
<span class="357447233987634249" onmouseenter="enter('357447233987634249');" onmouseout="out('357447233987634249');" style=""> 335          TypeInformation&lt;?&gt;[] fieldTypes = leftTypeInfo.getFieldTypes();                                           </span>
<span class="-7313385440196867180" onmouseenter="enter('-7313385440196867180');" onmouseout="out('-7313385440196867180');" style=""> 336          for (int i = 0; i &lt; sideOutTypes.length; i++) {                                                           </span>
<span class="-314833607359598646" onmouseenter="enter('-314833607359598646');" onmouseout="out('-314833607359598646');" style=""> 337              sideOutTypes[i] = convertTimeAttributeType(fieldTypes[i]);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338          }                                                                                                         </span>
<span class="-6446480870466684625" onmouseenter="enter('-6446480870466684625');" onmouseout="out('-6446480870466684625');" style=""> 339          RowTypeInfo rowTypeInfo = new RowTypeInfo(sideOutTypes, leftTypeInfo.getFieldNames());                    </span>
<span class="6189116692514123920" onmouseenter="enter('6189116692514123920');" onmouseout="out('6189116692514123920');" style=""> 340          return rowTypeInfo;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341      }                                                                                                             </span>
<span  style=""> 342                                                                                                                    </span>
<span class="2471506251995792847" onmouseenter="enter('2471506251995792847');" onmouseout="out('2471506251995792847');" style=""> 343      private TypeInformation convertTimeAttributeType(TypeInformation typeInformation) {                           </span>
<span class="2997926285576198837" onmouseenter="enter('2997926285576198837');" onmouseout="out('2997926285576198837');" style=""> 344          if (typeInformation instanceof TimeIndicatorTypeInfo) {                                                   </span>
<span class="-6249974448261972874" onmouseenter="enter('-6249974448261972874');" onmouseout="out('-6249974448261972874');" style=""> 345              return TypeInformation.of(Timestamp.class);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346          }                                                                                                         </span>
<span class="6871348106862514693" onmouseenter="enter('6871348106862514693');" onmouseout="out('6871348106862514693');" style=""> 347          return typeInformation;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348      }                                                                                                             </span>
<span  style=""> 349                                                                                                                    </span>
<span class="4184261108342886546" onmouseenter="enter('4184261108342886546');" onmouseout="out('4184261108342886546');" style=""> 350      //需要考虑更多的情况                                                                                                   </span>
<span class="-5866348515582828073" onmouseenter="enter('-5866348515582828073');" onmouseout="out('-5866348515582828073');" style=""> 351      private void replaceFieldName(SqlNode sqlNode, FieldReplaceInfo replaceInfo) {                                </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 352          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style=""> 353          switch (sqlKind) {                                                                                        </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style=""> 354              case INSERT:                                                                                          </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style=""> 355                  SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                            </span>
<span class="3539579188210716047" onmouseenter="enter('3539579188210716047');" onmouseout="out('3539579188210716047');" style=""> 356                  replaceFieldName(sqlSource, replaceInfo);                                                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 357                  break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 358              case AS:                                                                                              </span>
<span class="-2471580703701460163" onmouseenter="enter('-2471580703701460163');" onmouseout="out('-2471580703701460163');" style=""> 359                  SqlNode asNode = ((SqlBasicCall) sqlNode).getOperands()[0];                                       </span>
<span class="2382936847570265491" onmouseenter="enter('2382936847570265491');" onmouseout="out('2382936847570265491');" style=""> 360                  replaceFieldName(asNode, replaceInfo);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 361                  break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 362              case SELECT:                                                                                          </span>
<span class="7730902652365827282" onmouseenter="enter('7730902652365827282');" onmouseout="out('7730902652365827282');" style=""><abbr title=" 363                  SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName());"> 363                  SqlSelect sqlSelect = (SqlSelect) filterNodeWithTargetName(sqlNode, replaceInfo.getTargetTableName🔵</abbr></span>
<span class="-1465070514376240276" onmouseenter="enter('-1465070514376240276');" onmouseout="out('-1465070514376240276');" style=""> 364                  if(sqlSelect == null){                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 365                      return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366                  }                                                                                                 </span>
<span  style=""> 367                                                                                                                    </span>
<span class="-7911431356156617515" onmouseenter="enter('-7911431356156617515');" onmouseout="out('-7911431356156617515');" style=""> 368                  SqlNode sqlSource1 = sqlSelect.getFrom();                                                         </span>
<span class="-4060139958118865814" onmouseenter="enter('-4060139958118865814');" onmouseout="out('-4060139958118865814');" style=""> 369                  if(sqlSource1.getKind() == AS){                                                                   </span>
<span class="7708153722582291408" onmouseenter="enter('7708153722582291408');" onmouseout="out('7708153722582291408');" style=""> 370                      String tableName = ((SqlBasicCall)sqlSource1).getOperands()[0].toString();                    </span>
<span class="-7976662112993336650" onmouseenter="enter('-7976662112993336650');" onmouseout="out('-7976662112993336650');" style=""> 371                      if(tableName.equalsIgnoreCase(replaceInfo.getTargetTableName())){                             </span>
<span class="5036423329776629809" onmouseenter="enter('5036423329776629809');" onmouseout="out('5036423329776629809');" style=""> 372                          SqlNodeList sqlSelectList = sqlSelect.getSelectList();                                    </span>
<span class="4783458191183529265" onmouseenter="enter('4783458191183529265');" onmouseout="out('4783458191183529265');" style=""> 373                          SqlNode whereNode = sqlSelect.getWhere();                                                 </span>
<span class="6069356713975423578" onmouseenter="enter('6069356713975423578');" onmouseout="out('6069356713975423578');" style=""> 374                          SqlNodeList sqlGroup = sqlSelect.getGroup();                                              </span>
<span  style=""> 375                                                                                                                    </span>
<span class="2024933395694494313" onmouseenter="enter('2024933395694494313');" onmouseout="out('2024933395694494313');" style=""> 376                          //TODO 暂时不处理having                                                                        </span>
<span class="-2928778695763881832" onmouseenter="enter('-2928778695763881832');" onmouseout="out('-2928778695763881832');" style=""> 377                          SqlNode sqlHaving = sqlSelect.getHaving();                                                </span>
<span  style=""> 378                                                                                                                    </span>
<span class="-3614471078991347107" onmouseenter="enter('-3614471078991347107');" onmouseout="out('-3614471078991347107');" style=""> 379                          List&lt;SqlNode&gt; newSelectNodeList = Lists.newArrayList();                                   </span>
<span class="4525830429471113267" onmouseenter="enter('4525830429471113267');" onmouseout="out('4525830429471113267');" style=""> 380                          for( int i=0; i&lt;sqlSelectList.getList().size(); i++){                                     </span>
<span class="295237348129218365" onmouseenter="enter('295237348129218365');" onmouseout="out('295237348129218365');" style=""> 381                              SqlNode selectNode = sqlSelectList.getList().get(i);                                  </span>
<span class="3005939127677060655" onmouseenter="enter('3005939127677060655');" onmouseout="out('3005939127677060655');" style=""> 382                              //特殊处理 isStar的标识                                                                      </span>
<span class="-7362933676269921614" onmouseenter="enter('-7362933676269921614');" onmouseout="out('-7362933676269921614');" style=""> 383                              if(selectNode.getKind() == IDENTIFIER &amp;&amp; ((SqlIdentifier) selectNode).isStar()){      </span>
<span class="1426748103918852649" onmouseenter="enter('1426748103918852649');" onmouseout="out('1426748103918852649');" style=""><abbr title=" 384                                  List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo);"> 384                                  List&lt;SqlNode&gt; replaceNodeList = replaceSelectStarFieldName(selectNode, replaceInfo🔵</abbr></span>
<span class="-936038636053459659" onmouseenter="enter('-936038636053459659');" onmouseout="out('-936038636053459659');" style=""> 385                                  newSelectNodeList.addAll(replaceNodeList);                                        </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 386                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387                              }                                                                                     </span>
<span  style=""> 388                                                                                                                    </span>
<span class="3570575360626670937" onmouseenter="enter('3570575360626670937');" onmouseout="out('3570575360626670937');" style=""> 389                              SqlNode replaceNode = replaceSelectFieldName(selectNode, replaceInfo);                </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style=""> 390                              if(replaceNode == null){                                                              </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 391                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392                              }                                                                                     </span>
<span  style=""> 393                                                                                                                    </span>
<span class="-2861561298429904330" onmouseenter="enter('-2861561298429904330');" onmouseout="out('-2861561298429904330');" style=""> 394                              //sqlSelectList.set(i, replaceNode);                                                  </span>
<span class="1157087708345012360" onmouseenter="enter('1157087708345012360');" onmouseout="out('1157087708345012360');" style=""> 395                              newSelectNodeList.add(replaceNode);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396                          }                                                                                         </span>
<span  style=""> 397                                                                                                                    </span>
<span class="3723543992832155466" onmouseenter="enter('3723543992832155466');" onmouseout="out('3723543992832155466');" style=""><abbr title=" 398                          SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosition());"> 398                          SqlNodeList newSelectList = new SqlNodeList(newSelectNodeList, sqlSelectList.getParserPosi🔵</abbr></span>
<span class="-8903961717282297850" onmouseenter="enter('-8903961717282297850');" onmouseout="out('-8903961717282297850');" style=""> 399                          sqlSelect.setSelectList(newSelectList);                                                   </span>
<span  style=""> 400                                                                                                                    </span>
<span class="-47820880813073829" onmouseenter="enter('-47820880813073829');" onmouseout="out('-47820880813073829');" style=""> 401                          //where                                                                                   </span>
<span class="-2977999434516732521" onmouseenter="enter('-2977999434516732521');" onmouseout="out('-2977999434516732521');" style=""> 402                          if(whereNode != null){                                                                    </span>
<span class="5185992084008387135" onmouseenter="enter('5185992084008387135');" onmouseout="out('5185992084008387135');" style=""> 403                              SqlNode[] sqlNodeList = ((SqlBasicCall)whereNode).getOperands();                      </span>
<span class="3961659355684503168" onmouseenter="enter('3961659355684503168');" onmouseout="out('3961659355684503168');" style=""> 404                              for(int i =0; i&lt;sqlNodeList.length; i++) {                                            </span>
<span class="2172750173548984826" onmouseenter="enter('2172750173548984826');" onmouseout="out('2172750173548984826');" style=""> 405                                  SqlNode whereSqlNode = sqlNodeList[i];                                            </span>
<span class="-4477047106175359937" onmouseenter="enter('-4477047106175359937');" onmouseout="out('-4477047106175359937');" style=""> 406                                  SqlNode replaceNode = replaceNodeInfo(whereSqlNode, replaceInfo);                 </span>
<span class="-1237302974526763563" onmouseenter="enter('-1237302974526763563');" onmouseout="out('-1237302974526763563');" style=""> 407                                  sqlNodeList[i] = replaceNode;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                          }                                                                                         </span>
<span class="6298777632396279516" onmouseenter="enter('6298777632396279516');" onmouseout="out('6298777632396279516');" style=""> 410                          if(sqlGroup != null &amp;&amp; CollectionUtils.isNotEmpty(sqlGroup.getList())){                   </span>
<span class="-8564058694678267080" onmouseenter="enter('-8564058694678267080');" onmouseout="out('-8564058694678267080');" style=""> 411                              for( int i=0; i&lt;sqlGroup.getList().size(); i++){                                      </span>
<span class="1364213940272952273" onmouseenter="enter('1364213940272952273');" onmouseout="out('1364213940272952273');" style=""> 412                                  SqlNode selectNode = sqlGroup.getList().get(i);                                   </span>
<span class="3578364850198173029" onmouseenter="enter('3578364850198173029');" onmouseout="out('3578364850198173029');" style=""> 413                                  SqlNode replaceNode = replaceNodeInfo(selectNode, replaceInfo);                   </span>
<span class="5715423325454336801" onmouseenter="enter('5715423325454336801');" onmouseout="out('5715423325454336801');" style=""> 414                                  sqlGroup.set(i, replaceNode);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417                      }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 418                  }else{                                                                                            </span>
<span class="5468885380070811563" onmouseenter="enter('5468885380070811563');" onmouseout="out('5468885380070811563');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 419 -                    //TODO                                                                                        </span>
<span class="-7176218527101706664" onmouseenter="enter('-7176218527101706664');" onmouseout="out('-7176218527101706664');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 420 -                    System.out.println(sqlNode);                                                                  </span>
<span class="7951951008096051242" onmouseenter="enter('7951951008096051242');" onmouseout="out('7951951008096051242');" style=""> 421                      throw new RuntimeException(&quot;---not deal type:&quot; + sqlNode);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422                  }                                                                                                 </span>
<span  style=""> 423                                                                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 424                  break;                                                                                            </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 425              case UNION:                                                                                           </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style=""> 426                  SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                                    </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style=""> 427                  SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                                   </span>
<span class="12832057540049012" onmouseenter="enter('12832057540049012');" onmouseout="out('12832057540049012');" style=""> 428                  replaceFieldName(unionLeft, replaceInfo);                                                         </span>
<span class="-8236931260571053140" onmouseenter="enter('-8236931260571053140');" onmouseout="out('-8236931260571053140');" style=""> 429                  replaceFieldName(unionRight, replaceInfo);                                                        </span>
<span  style=""> 430                                                                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 431                  break;                                                                                            </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style=""> 432              case ORDER_BY:                                                                                        </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style=""> 433                  SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                                    </span>
<span class="6726911406523213581" onmouseenter="enter('6726911406523213581');" onmouseout="out('6726911406523213581');" style=""> 434                  replaceFieldName(sqlOrderBy.query, replaceInfo);                                                  </span>
<span class="-1619723091747707804" onmouseenter="enter('-1619723091747707804');" onmouseout="out('-1619723091747707804');" style=""> 435                  SqlNodeList orderFiledList = sqlOrderBy.orderList;                                                </span>
<span class="-5416337846474747128" onmouseenter="enter('-5416337846474747128');" onmouseout="out('-5416337846474747128');" style=""> 436                  for (int i=0 ;i&lt;orderFiledList.size();i++) {                                                      </span>
<span class="3598769397463403835" onmouseenter="enter('3598769397463403835');" onmouseout="out('3598769397463403835');" style=""><abbr title=" 437                      SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTableAlias());"> 437                      SqlNode replaceNode = replaceOrderByTableName(orderFiledList.get(i), replaceInfo.getTargetTabl🔵</abbr></span>
<span class="-1288993483926023903" onmouseenter="enter('-1288993483926023903');" onmouseout="out('-1288993483926023903');" style=""> 438                      orderFiledList.set(i, replaceNode);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439                  }                                                                                                 </span>
<span  style=""> 440                                                                                                                    </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 441              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 442                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444      }                                                                                                             </span>
<span  style=""> 445                                                                                                                    </span>
<span class="-4529709500477233937" onmouseenter="enter('-4529709500477233937');" onmouseout="out('-4529709500477233937');" style=""> 446      private SqlNode replaceOrderByTableName(SqlNode orderNode, String tableAlias) {                               </span>
<span class="-8843072586907859237" onmouseenter="enter('-8843072586907859237');" onmouseout="out('-8843072586907859237');" style=""> 447          if(orderNode.getKind() == IDENTIFIER){                                                                    </span>
<span class="1286019212722079849" onmouseenter="enter('1286019212722079849');" onmouseout="out('1286019212722079849');" style=""> 448              SqlIdentifier sqlIdentifier = (SqlIdentifier) orderNode;                                              </span>
<span class="5334275776993480413" onmouseenter="enter('5334275776993480413');" onmouseout="out('5334275776993480413');" style=""> 449              if (sqlIdentifier.names.size() == 1) {                                                                </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style=""> 450                  return orderNode;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 451              }                                                                                                     </span>
<span class="4987076328947336547" onmouseenter="enter('4987076328947336547');" onmouseout="out('4987076328947336547');" style=""> 452              return sqlIdentifier.setName(0, tableAlias);                                                          </span>
<span class="6164370744345420381" onmouseenter="enter('6164370744345420381');" onmouseout="out('6164370744345420381');" style=""> 453          } else if (orderNode instanceof  SqlBasicCall) {                                                          </span>
<span class="4197878478620092735" onmouseenter="enter('4197878478620092735');" onmouseout="out('4197878478620092735');" style=""> 454              SqlBasicCall sqlBasicCall = (SqlBasicCall) orderNode;                                                 </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style=""> 455              for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                            </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style=""> 456                  SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                           </span>
<span class="-7345169450449378118" onmouseenter="enter('-7345169450449378118');" onmouseout="out('-7345169450449378118');" style=""> 457                  sqlBasicCall.getOperands()[i] = replaceOrderByTableName(sqlNode , tableAlias);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458              }                                                                                                     </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style=""> 459              return sqlBasicCall;                                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 460          } else {                                                                                                  </span>
<span class="3658299151650011152" onmouseenter="enter('3658299151650011152');" onmouseout="out('3658299151650011152');" style=""> 461              return orderNode;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 463      }                                                                                                             </span>
<span  style=""> 464                                                                                                                    </span>
<span class="4620342074554351588" onmouseenter="enter('4620342074554351588');" onmouseout="out('4620342074554351588');" style=""> 465      private SqlNode replaceNodeInfo(SqlNode groupNode, FieldReplaceInfo replaceInfo){                             </span>
<span class="-8006552962557562934" onmouseenter="enter('-8006552962557562934');" onmouseout="out('-8006552962557562934');" style=""> 466          if(groupNode.getKind() == IDENTIFIER){                                                                    </span>
<span class="3769318911409416973" onmouseenter="enter('3769318911409416973');" onmouseout="out('3769318911409416973');" style=""> 467              SqlIdentifier sqlIdentifier = (SqlIdentifier) groupNode;                                              </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 468              if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style=""> 469                  return sqlIdentifier;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470              }                                                                                                     </span>
<span  style=""> 471                                                                                                                    </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style=""><abbr title=" 472              String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 472              String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sq🔵</abbr></span>
<span class="1289832806545417263" onmouseenter="enter('1289832806545417263');" onmouseout="out('1289832806545417263');" style=""> 473              if(mappingFieldName == null){                                                                         </span>
<span class="-3862759337385230883" onmouseenter="enter('-3862759337385230883');" onmouseout="out('-3862759337385230883');" style=""> 474                  throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + sqlIdentifier.toString() );          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475              }                                                                                                     </span>
<span  style=""> 476                                                                                                                    </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style=""> 477              sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                          </span>
<span class="2521832232004155291" onmouseenter="enter('2521832232004155291');" onmouseout="out('2521832232004155291');" style=""> 478              return sqlIdentifier.setName(1, mappingFieldName);                                                    </span>
<span class="6819015395036995114" onmouseenter="enter('6819015395036995114');" onmouseout="out('6819015395036995114');" style=""> 479          }else if(groupNode instanceof  SqlBasicCall){                                                             </span>
<span class="8961639140694724649" onmouseenter="enter('8961639140694724649');" onmouseout="out('8961639140694724649');" style=""> 480              SqlBasicCall sqlBasicCall = (SqlBasicCall) groupNode;                                                 </span>
<span class="-7573732783383249897" onmouseenter="enter('-7573732783383249897');" onmouseout="out('-7573732783383249897');" style=""> 481              for(int i=0; i&lt;sqlBasicCall.getOperandList().size(); i++){                                            </span>
<span class="100008651296407899" onmouseenter="enter('100008651296407899');" onmouseout="out('100008651296407899');" style=""> 482                  SqlNode sqlNode = sqlBasicCall.getOperandList().get(i);                                           </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style=""> 483                  SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                               </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style=""> 484                  sqlBasicCall.getOperands()[i] = replaceNode;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485              }                                                                                                     </span>
<span  style=""> 486                                                                                                                    </span>
<span class="-8358112570910588815" onmouseenter="enter('-8358112570910588815');" onmouseout="out('-8358112570910588815');" style=""> 487              return sqlBasicCall;                                                                                  </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 488          }else{                                                                                                    </span>
<span class="-2985482133144580062" onmouseenter="enter('-2985482133144580062');" onmouseout="out('-2985482133144580062');" style=""> 489              return groupNode;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 490          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491      }                                                                                                             </span>
<span  style=""> 492                                                                                                                    </span>
<span class="8999921149877150187" onmouseenter="enter('8999921149877150187');" onmouseout="out('8999921149877150187');" style=""> 493      public SqlNode filterNodeWithTargetName(SqlNode sqlNode, String targetTableName) {                            </span>
<span  style=""> 494                                                                                                                    </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 495          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 496          switch (sqlKind){                                                                                         </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 497              case SELECT:                                                                                          </span>
<span class="3690582093491335304" onmouseenter="enter('3690582093491335304');" onmouseout="out('3690582093491335304');" style=""> 498                  SqlNode fromNode = ((SqlSelect)sqlNode).getFrom();                                                </span>
<span class="-3145608785072750921" onmouseenter="enter('-3145608785072750921');" onmouseout="out('-3145608785072750921');" style=""> 499                  if(fromNode.getKind() == AS &amp;&amp; ((SqlBasicCall)fromNode).getOperands()[0].getKind() == IDENTIFIER){</span>
<span class="-8703575627981044416" onmouseenter="enter('-8703575627981044416');" onmouseout="out('-8703575627981044416');" style=""> 500                      if(((SqlBasicCall)fromNode).getOperands()[0].toString().equalsIgnoreCase(targetTableName)){   </span>
<span class="4129664160573057591" onmouseenter="enter('4129664160573057591');" onmouseout="out('4129664160573057591');" style=""> 501                          return sqlNode;                                                                           </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 502                      }else{                                                                                        </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 503                          return null;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504                      }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 505                  }else{                                                                                            </span>
<span class="-487022337093825690" onmouseenter="enter('-487022337093825690');" onmouseout="out('-487022337093825690');" style=""> 506                      return filterNodeWithTargetName(fromNode, targetTableName);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507                  }                                                                                                 </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 508              case AS:                                                                                              </span>
<span class="-1062165270197177560" onmouseenter="enter('-1062165270197177560');" onmouseout="out('-1062165270197177560');" style=""> 509                  SqlNode childNode = ((SqlBasicCall)sqlNode).getOperands()[0];                                     </span>
<span class="-1638905337538821604" onmouseenter="enter('-1638905337538821604');" onmouseout="out('-1638905337538821604');" style=""> 510                  return filterNodeWithTargetName(childNode, targetTableName);                                      </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 511              case JOIN:                                                                                            </span>
<span class="7698802261704662279" onmouseenter="enter('7698802261704662279');" onmouseout="out('7698802261704662279');" style=""> 512                  SqlNode leftNode = ((SqlJoin)sqlNode).getLeft();                                                  </span>
<span class="-2733398086906527657" onmouseenter="enter('-2733398086906527657');" onmouseout="out('-2733398086906527657');" style=""> 513                  SqlNode rightNode =  ((SqlJoin)sqlNode).getRight();                                               </span>
<span class="2468445302541940347" onmouseenter="enter('2468445302541940347');" onmouseout="out('2468445302541940347');" style=""> 514                  SqlNode leftReturnNode = filterNodeWithTargetName(leftNode, targetTableName);                     </span>
<span class="-8199943593633767670" onmouseenter="enter('-8199943593633767670');" onmouseout="out('-8199943593633767670');" style=""> 515                  SqlNode rightReturnNode = filterNodeWithTargetName(rightNode, targetTableName);                   </span>
<span  style=""> 516                                                                                                                    </span>
<span class="-394673487884933665" onmouseenter="enter('-394673487884933665');" onmouseout="out('-394673487884933665');" style=""> 517                  if(leftReturnNode != null) {                                                                      </span>
<span class="7562823630460789719" onmouseenter="enter('7562823630460789719');" onmouseout="out('7562823630460789719');" style=""> 518                      return leftReturnNode;                                                                        </span>
<span class="1020015460804008518" onmouseenter="enter('1020015460804008518');" onmouseout="out('1020015460804008518');" style=""> 519                  }else if(rightReturnNode != null){                                                                </span>
<span class="7420403991289947009" onmouseenter="enter('7420403991289947009');" onmouseout="out('7420403991289947009');" style=""> 520                      return rightReturnNode;                                                                       </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 521                  }else{                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 522                      return null;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523                  }                                                                                                 </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 524 +            default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 525 +                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526          }                                                                                                         </span>
<span  style=""> 527                                                                                                                    </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 528          return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529      }                                                                                                             </span>



<span  style=""> 530                                                                                                                    </span>
<span  style=""> 531                                                                                                                    </span>
<span class="-6722855011181273565" onmouseenter="enter('-6722855011181273565');" onmouseout="out('-6722855011181273565');" style=""> 532      public void setLocalSqlPluginPath(String localSqlPluginPath) {                                                </span>
<span class="6258662942576926140" onmouseenter="enter('6258662942576926140');" onmouseout="out('6258662942576926140');" style=""> 533          this.localSqlPluginPath = localSqlPluginPath;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534      }                                                                                                             </span>
<span  style=""> 535                                                                                                                    </span>
<span class="2277905399441322839" onmouseenter="enter('2277905399441322839');" onmouseout="out('2277905399441322839');" style=""> 536      private Table getTableFromCache(Map&lt;String, Table&gt; localTableCache, String tableAlias, String tableName){     </span>
<span class="-6301156236825066460" onmouseenter="enter('-6301156236825066460');" onmouseout="out('-6301156236825066460');" style=""> 537          Table table = localTableCache.get(tableAlias);                                                            </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 538          if(table == null){                                                                                        </span>
<span class="-5960895848666330323" onmouseenter="enter('-5960895848666330323');" onmouseout="out('-5960895848666330323');" style=""> 539              table = localTableCache.get(tableName);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540          }                                                                                                         </span>
<span  style=""> 541                                                                                                                    </span>
<span class="2042916935617835771" onmouseenter="enter('2042916935617835771');" onmouseout="out('2042916935617835771');" style=""> 542          if(table == null){                                                                                        </span>
<span class="-2825016904896826066" onmouseenter="enter('-2825016904896826066');" onmouseout="out('-2825016904896826066');" style=""> 543              throw new RuntimeException(&quot;not register table &quot; + tableName);                                        </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544          }                                                                                                         </span>
<span  style=""> 545                                                                                                                    </span>
<span class="-6017334383208509278" onmouseenter="enter('-6017334383208509278');" onmouseout="out('-6017334383208509278');" style=""> 546          return table;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547      }                                                                                                             </span>
<span  style=""> 548                                                                                                                    </span>
<span class="-8696523049985644897" onmouseenter="enter('-8696523049985644897');" onmouseout="out('-8696523049985644897');" style=""> 549      private List&lt;SqlNode&gt; replaceSelectStarFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo){           </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 550          SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                                 </span>
<span class="-376697531199676299" onmouseenter="enter('-376697531199676299');" onmouseout="out('-376697531199676299');" style=""> 551          List&lt;SqlNode&gt; sqlNodes = Lists.newArrayList();                                                            </span>
<span class="-3220711380851181839" onmouseenter="enter('-3220711380851181839');" onmouseout="out('-3220711380851181839');" style=""> 552          if(sqlIdentifier.isStar()){//处理 [* or table.*]                                                            </span>
<span class="-8760640117888015743" onmouseenter="enter('-8760640117888015743');" onmouseout="out('-8760640117888015743');" style=""> 553              int identifierSize = sqlIdentifier.names.size();                                                      </span>
<span class="-737230567623922483" onmouseenter="enter('-737230567623922483');" onmouseout="out('-737230567623922483');" style=""> 554              Collection&lt;String&gt; columns = null;                                                                    </span>
<span class="-3878600943817580523" onmouseenter="enter('-3878600943817580523');" onmouseout="out('-3878600943817580523');" style=""> 555              if(identifierSize == 1){                                                                              </span>
<span class="439489357590017604" onmouseenter="enter('439489357590017604');" onmouseout="out('439489357590017604');" style=""> 556                  columns = replaceInfo.getMappingTable().values();                                                 </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 557              }else{                                                                                                </span>
<span class="-6967503276601174325" onmouseenter="enter('-6967503276601174325');" onmouseout="out('-6967503276601174325');" style=""> 558                  columns = replaceInfo.getMappingTable().row(sqlIdentifier.names.get(0)).values();                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 559              }                                                                                                     </span>
<span  style=""> 560                                                                                                                    </span>
<span class="-8621425588629763030" onmouseenter="enter('-8621425588629763030');" onmouseout="out('-8621425588629763030');" style=""> 561              for(String colAlias : columns){                                                                       </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style=""> 562                  SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                               </span>
<span class="7376564429850475234" onmouseenter="enter('7376564429850475234');" onmouseout="out('7376564429850475234');" style=""> 563                  List&lt;String&gt; columnInfo = Lists.newArrayList();                                                   </span>
<span class="-7580690826400610936" onmouseenter="enter('-7580690826400610936');" onmouseout="out('-7580690826400610936');" style=""> 564                  columnInfo.add(replaceInfo.getTargetTableAlias());                                                </span>
<span class="8071016449845654104" onmouseenter="enter('8071016449845654104');" onmouseout="out('8071016449845654104');" style=""> 565                  columnInfo.add(colAlias);                                                                         </span>
<span class="-2937163626106946341" onmouseenter="enter('-2937163626106946341');" onmouseout="out('-2937163626106946341');" style=""> 566                  SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(columnInfo, sqlParserPos);                   </span>
<span class="6977395894616298454" onmouseenter="enter('6977395894616298454');" onmouseout="out('6977395894616298454');" style=""> 567                  sqlNodes.add(sqlIdentifierAlias);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 568              }                                                                                                     </span>
<span  style=""> 569                                                                                                                    </span>
<span class="-2192274943977569589" onmouseenter="enter('-2192274943977569589');" onmouseout="out('-2192274943977569589');" style=""> 570              return sqlNodes;                                                                                      </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 571          }else{                                                                                                    </span>
<span class="-8039826041817422769" onmouseenter="enter('-8039826041817422769');" onmouseout="out('-8039826041817422769');" style=""> 572              throw new RuntimeException(&quot;is not a star select field.&quot; + selectNode);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 573          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 574      }                                                                                                             </span>
<span  style=""> 575                                                                                                                    </span>
<span class="-5931652736394605669" onmouseenter="enter('-5931652736394605669');" onmouseout="out('-5931652736394605669');" style=""> 576      private SqlNode replaceSelectFieldName(SqlNode selectNode, FieldReplaceInfo replaceInfo) {                    </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style=""> 577          if (selectNode.getKind() == AS) {                                                                         </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style=""> 578              SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                                      </span>
<span class="-1521486087941699086" onmouseenter="enter('-1521486087941699086');" onmouseout="out('-1521486087941699086');" style=""> 579              SqlNode replaceNode = replaceSelectFieldName(leftNode, replaceInfo);                                  </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style=""> 580              if (replaceNode != null) {                                                                            </span>
<span class="44744548385893691" onmouseenter="enter('44744548385893691');" onmouseout="out('44744548385893691');" style=""> 581                  ((SqlBasicCall) selectNode).getOperands()[0] = replaceNode;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 582              }                                                                                                     </span>
<span  style=""> 583                                                                                                                    </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style=""> 584              return selectNode;                                                                                    </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style=""> 585          }else if(selectNode.getKind() == IDENTIFIER){                                                             </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 586              SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style=""> 587                                                                                                                    </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 588              if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style=""> 589                  return selectNode;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590              }                                                                                                     </span>
<span  style=""> 591                                                                                                                    </span>
<span class="5152547743275588251" onmouseenter="enter('5152547743275588251');" onmouseout="out('5152547743275588251');" style=""> 592              //Same level mappingTable                                                                             </span>
<span class="6407916945855257008" onmouseenter="enter('6407916945855257008');" onmouseout="out('6407916945855257008');" style=""><abbr title=" 593              String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sqlIdentifier.getComponent(1).getSimple());"> 593              String mappingFieldName = replaceInfo.getTargetFieldName(sqlIdentifier.getComponent(0).getSimple(), sq🔵</abbr></span>
<span class="-6523721893364253351" onmouseenter="enter('-6523721893364253351');" onmouseout="out('-6523721893364253351');" style=""> 594              if (mappingFieldName == null) {                                                                       </span>
<span class="8276130366719222706" onmouseenter="enter('8276130366719222706');" onmouseout="out('8276130366719222706');" style=""> 595                  throw new RuntimeException(&quot;can&#x27;t find mapping fieldName:&quot; + selectNode.toString() );             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 596              }                                                                                                     </span>
<span  style=""> 597                                                                                                                    </span>
<span class="-5890535765636234447" onmouseenter="enter('-5890535765636234447');" onmouseout="out('-5890535765636234447');" style=""> 598              sqlIdentifier = sqlIdentifier.setName(0, replaceInfo.getTargetTableAlias());                          </span>
<span class="2571352877158902005" onmouseenter="enter('2571352877158902005');" onmouseout="out('2571352877158902005');" style=""> 599              sqlIdentifier = sqlIdentifier.setName(1, mappingFieldName);                                           </span>
<span class="-847366074365989092" onmouseenter="enter('-847366074365989092');" onmouseout="out('-847366074365989092');" style=""> 600              return sqlIdentifier;                                                                                 </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 601          }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义                 </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style=""> 602              return selectNode;                                                                                    </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 603          }else if(  AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 604                  || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 605                  || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 606                  || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 607                  || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 608                  || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 609                  || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 610                  || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 611                  || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 612                  || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 613                  || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 614                  || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 615                  || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 616                  || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 617                  || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 618                  || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 619                  || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 620                  || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 621                  || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 622                  || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 623                  || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 624                  || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 625                  || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 626                  || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 627                  || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 628                  || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 629                  || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 630                  || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 631                  || selectNode.getKind() == LIKE                                                                   </span>
<span  style=""> 632                                                                                                                    </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 633                  ){                                                                                                </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 634              SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 635              for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 636                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 637                  if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 638                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 639                  }                                                                                                 </span>
<span  style=""> 640                                                                                                                    </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 641                  if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 642                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 643                  }                                                                                                 </span>
<span  style=""> 644                                                                                                                    </span>
<span class="7881018161937387163" onmouseenter="enter('7881018161937387163');" onmouseout="out('7881018161937387163');" style=""> 645                  SqlNode replaceNode = replaceSelectFieldName(sqlNode, replaceInfo);                               </span>
<span class="6730448349282232186" onmouseenter="enter('6730448349282232186');" onmouseout="out('6730448349282232186');" style=""> 646                  if(replaceNode == null){                                                                          </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 647                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 648                  }                                                                                                 </span>
<span  style=""> 649                                                                                                                    </span>
<span class="347802466520365331" onmouseenter="enter('347802466520365331');" onmouseout="out('347802466520365331');" style=""> 650                  sqlBasicCall.getOperands()[i] = replaceNode;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 651              }                                                                                                     </span>
<span  style=""> 652                                                                                                                    </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style=""> 653              return selectNode;                                                                                    </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style=""> 654          }else if(selectNode.getKind() == CASE){                                                                   </span>
<span class="-6113591358780745482" onmouseenter="enter('-6113591358780745482');" onmouseout="out('-6113591358780745482');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 655 -            System.out.println(&quot;selectNode&quot;);                                                                     </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 656              SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 657              SqlNodeList whenOperands = sqlCase.getWhenOperands();                                                 </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 658              SqlNodeList thenOperands = sqlCase.getThenOperands();                                                 </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 659              SqlNode elseNode = sqlCase.getElseOperand();                                                          </span>
<span  style=""> 660                                                                                                                    </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style=""> 661              for(int i=0; i&lt;whenOperands.size(); i++){                                                             </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 662                  SqlNode oneOperand = whenOperands.get(i);                                                         </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style=""> 663                  SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                            </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style=""> 664                  if (replaceNode != null) {                                                                        </span>
<span class="827753515492975605" onmouseenter="enter('827753515492975605');" onmouseout="out('827753515492975605');" style=""> 665                      whenOperands.set(i, replaceNode);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 666                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 667              }                                                                                                     </span>
<span  style=""> 668                                                                                                                    </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style=""> 669              for(int i=0; i&lt;thenOperands.size(); i++){                                                             </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 670                  SqlNode oneOperand = thenOperands.get(i);                                                         </span>
<span class="-5229900958041612772" onmouseenter="enter('-5229900958041612772');" onmouseout="out('-5229900958041612772');" style=""> 671                  SqlNode replaceNode = replaceSelectFieldName(oneOperand, replaceInfo);                            </span>
<span class="7546853924527679598" onmouseenter="enter('7546853924527679598');" onmouseout="out('7546853924527679598');" style=""> 672                  if (replaceNode != null) {                                                                        </span>
<span class="-4947674979480974151" onmouseenter="enter('-4947674979480974151');" onmouseout="out('-4947674979480974151');" style=""> 673                      thenOperands.set(i, replaceNode);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 675              }                                                                                                     </span>
<span  style=""> 676                                                                                                                    </span>
<span class="-1702904876822094161" onmouseenter="enter('-1702904876822094161');" onmouseout="out('-1702904876822094161');" style=""> 677              ((SqlCase) selectNode).setOperand(3, replaceSelectFieldName(elseNode, replaceInfo));                  </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style=""> 678              return selectNode;                                                                                    </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 679          }else if(selectNode.getKind() == OTHER){                                                                  </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 680              //不处理                                                                                                 </span>
<span class="3674056650915394868" onmouseenter="enter('3674056650915394868');" onmouseout="out('3674056650915394868');" style=""> 681              return selectNode;                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 682          }else{                                                                                                    </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 683              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 683              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 684          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 685      }                                                                                                             </span>
<span  style=""> 686                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 687      /**                                                                                                           </span>
<span class="5196638318686351881" onmouseenter="enter('5196638318686351881');" onmouseout="out('5196638318686351881');" style=""><abbr title=" 688       * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension table is the primary key definition"> 688       * Analyzing conditions are very join the dimension tables include all equivalent conditions (i.e., dimension 🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 689       *                                                                                                            </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 690       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 691       */                                                                                                           </span>
<span class="6839043037696086936" onmouseenter="enter('6839043037696086936');" onmouseout="out('6839043037696086936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 692 -    private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, SideTableInfo sideTableInfo) {"> 692 -    private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, SideTableInfo sideTableInfo) 🔵</abbr></span>
<span class="4488554625343324946" onmouseenter="enter('4488554625343324946');" onmouseout="out('4488554625343324946');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 693 +    private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInfo sideTableInfo) {"> 693 +    private boolean checkJoinCondition(SqlNode conditionNode, String sideTableAlias, AbstractSideTableInfo sideTab🔵</abbr></span>
<span class="-6710736308674703771" onmouseenter="enter('-6710736308674703771');" onmouseout="out('-6710736308674703771');" style=""> 694          List&lt;String&gt; conditionFields = getConditionFields(conditionNode, sideTableAlias, sideTableInfo);          </span>
<span class="-3924194481322428470" onmouseenter="enter('-3924194481322428470');" onmouseout="out('-3924194481322428470');" style=""> 695          if(CollectionUtils.isEqualCollection(conditionFields, convertPrimaryAlias(sideTableInfo))){               </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 696              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 697          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 698          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 699      }                                                                                                             </span>
<span  style=""> 700                                                                                                                    </span>
<span class="-142104979032699627" onmouseenter="enter('-142104979032699627');" onmouseout="out('-142104979032699627');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 701 -    private List&lt;String&gt; convertPrimaryAlias(SideTableInfo sideTableInfo) {                                       </span>
<span class="572998504046101497" onmouseenter="enter('572998504046101497');" onmouseout="out('572998504046101497');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 702 +    private List&lt;String&gt; convertPrimaryAlias(AbstractSideTableInfo sideTableInfo) {                               </span>
<span class="-6700733268022775520" onmouseenter="enter('-6700733268022775520');" onmouseout="out('-6700733268022775520');" style=""> 703          List&lt;String&gt; res = Lists.newArrayList();                                                                  </span>
<span class="-1517278133900331130" onmouseenter="enter('-1517278133900331130');" onmouseout="out('-1517278133900331130');" style=""> 704          sideTableInfo.getPrimaryKeys().forEach(field -&gt; {                                                         </span>
<span class="2991641550935988694" onmouseenter="enter('2991641550935988694');" onmouseout="out('2991641550935988694');" style=""> 705              res.add(sideTableInfo.getPhysicalFields().getOrDefault(field, field));                                </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 706          });                                                                                                       </span>
<span class="1866624461241282949" onmouseenter="enter('1866624461241282949');" onmouseout="out('1866624461241282949');" style=""> 707          return res;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 708      }                                                                                                             </span>
<span  style=""> 709                                                                                                                    </span>
<span class="-1424472995770428534" onmouseenter="enter('-1424472995770428534');" onmouseout="out('-1424472995770428534');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 710 -    public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, SideTableInfo sideTableInfo){"> 710 -    public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, SideTableInfo sideTable🔵</abbr></span>
<span class="-958139939083183834" onmouseenter="enter('-958139939083183834');" onmouseout="out('-958139939083183834');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 711 +    public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTableInfo sideTableInfo){"> 711 +    public List&lt;String&gt; getConditionFields(SqlNode conditionNode, String specifyTableName, AbstractSideTableInfo s🔵</abbr></span>
<span class="-5667062641477778387" onmouseenter="enter('-5667062641477778387');" onmouseout="out('-5667062641477778387');" style=""> 712          List&lt;SqlNode&gt; sqlNodeList = Lists.newArrayList();                                                         </span>
<span class="5003747983397221043" onmouseenter="enter('5003747983397221043');" onmouseout="out('5003747983397221043');" style=""> 713          ParseUtils.parseAnd(conditionNode, sqlNodeList);                                                          </span>
<span class="331902561671078290" onmouseenter="enter('331902561671078290');" onmouseout="out('331902561671078290');" style=""> 714          List&lt;String&gt; conditionFields = Lists.newArrayList();                                                      </span>
<span class="-2336842894952786561" onmouseenter="enter('-2336842894952786561');" onmouseout="out('-2336842894952786561');" style=""> 715          for(SqlNode sqlNode : sqlNodeList){                                                                       </span>
<span class="-1235221313035004193" onmouseenter="enter('-1235221313035004193');" onmouseout="out('-1235221313035004193');" style=""> 716              if (!SqlKind.COMPARISON.contains(sqlNode.getKind())) {                                                </span>
<span class="4238811186041433324" onmouseenter="enter('4238811186041433324');" onmouseout="out('4238811186041433324');" style=""> 717                  throw new RuntimeException(&quot;not compare operator.&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 718              }                                                                                                     </span>
<span  style=""> 719                                                                                                                    </span>
<span class="-7359051973666627295" onmouseenter="enter('-7359051973666627295');" onmouseout="out('-7359051973666627295');" style=""> 720              SqlIdentifier left = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[0];                         </span>
<span class="3465298874779506196" onmouseenter="enter('3465298874779506196');" onmouseout="out('3465298874779506196');" style=""> 721              SqlIdentifier right = (SqlIdentifier)((SqlBasicCall)sqlNode).getOperands()[1];                        </span>
<span  style=""> 722                                                                                                                    </span>
<span class="-2670749344655178863" onmouseenter="enter('-2670749344655178863');" onmouseout="out('-2670749344655178863');" style=""> 723              String leftTableName = left.getComponent(0).getSimple();                                              </span>
<span class="5188110590184041827" onmouseenter="enter('5188110590184041827');" onmouseout="out('5188110590184041827');" style=""> 724              String rightTableName = right.getComponent(0).getSimple();                                            </span>
<span  style=""> 725                                                                                                                    </span>
<span class="8082853509369418918" onmouseenter="enter('8082853509369418918');" onmouseout="out('8082853509369418918');" style=""> 726              String tableCol = &quot;&quot;;                                                                                 </span>
<span class="3869855333927982135" onmouseenter="enter('3869855333927982135');" onmouseout="out('3869855333927982135');" style=""> 727              if(leftTableName.equalsIgnoreCase(specifyTableName)){                                                 </span>
<span class="4527748628163402760" onmouseenter="enter('4527748628163402760');" onmouseout="out('4527748628163402760');" style=""> 728                  tableCol = left.getComponent(1).getSimple();                                                      </span>
<span class="5068195286258055415" onmouseenter="enter('5068195286258055415');" onmouseout="out('5068195286258055415');" style=""> 729              }else if(rightTableName.equalsIgnoreCase(specifyTableName)){                                          </span>
<span class="4462633703217831544" onmouseenter="enter('4462633703217831544');" onmouseout="out('4462633703217831544');" style=""> 730                  tableCol = right.getComponent(1).getSimple();                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 731              }else{                                                                                                </span>
<span class="3783543445731730404" onmouseenter="enter('3783543445731730404');" onmouseout="out('3783543445731730404');" style=""><abbr title=" 732                  throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName));"> 732                  throw new RuntimeException(String.format(&quot;side table:%s join condition is wrong&quot;, specifyTableName🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 733              }                                                                                                     </span>
<span class="-2325401555704525047" onmouseenter="enter('-2325401555704525047');" onmouseout="out('-2325401555704525047');" style=""> 734              tableCol = sideTableInfo.getPhysicalFields().getOrDefault(tableCol, tableCol);                        </span>
<span class="-4552234441929070616" onmouseenter="enter('-4552234441929070616');" onmouseout="out('-4552234441929070616');" style=""> 735              conditionFields.add(tableCol);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 736          }                                                                                                         </span>
<span  style=""> 737                                                                                                                    </span>
<span class="4950082808497882460" onmouseenter="enter('4950082808497882460');" onmouseout="out('4950082808497882460');" style=""> 738          return conditionFields;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739      }                                                                                                             </span>
<span  style=""> 740                                                                                                                    </span>
<span class="-8173208587282838964" onmouseenter="enter('-8173208587282838964');" onmouseout="out('-8173208587282838964');" style=""> 741      protected void dealAsSourceTable(StreamTableEnvironment tableEnv,                                             </span>
<span class="9126592535894268017" onmouseenter="enter('9126592535894268017');" onmouseout="out('9126592535894268017');" style=""> 742                                       SqlNode pollSqlNode,                                                         </span>
<span class="-1493383746124052329" onmouseenter="enter('-1493383746124052329');" onmouseout="out('-1493383746124052329');" style=""> 743                                       Map&lt;String, Table&gt; tableCache,                                               </span>
<span class="-3293670501905922467" onmouseenter="enter('-3293670501905922467');" onmouseout="out('-3293670501905922467');" style=""> 744                                       List&lt;FieldReplaceInfo&gt; replaceInfoList) throws SqlParseException {           </span>

<span  style=""> 745                                                                                                                    </span>
<span class="-7364020242551640527" onmouseenter="enter('-7364020242551640527');" onmouseout="out('-7364020242551640527');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 746 -        AliasInfo aliasInfo = parseASNode(pollSqlNode);                                                           </span>
<span class="7772412594103241573" onmouseenter="enter('7772412594103241573');" onmouseout="out('7772412594103241573');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 747 +        AliasInfo aliasInfo = parseAsNode(pollSqlNode);                                                           </span>
<span class="2461088292100865778" onmouseenter="enter('2461088292100865778');" onmouseout="out('2461088292100865778');" style=""> 748          if (localTableCache.containsKey(aliasInfo.getName())) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 749              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 750          }                                                                                                         </span>
<span  style=""> 751                                                                                                                    </span>
<span class="-3390660419579622283" onmouseenter="enter('-3390660419579622283');" onmouseout="out('-3390660419579622283');" style=""> 752          Table table = tableEnv.sqlQuery(aliasInfo.getName());                                                     </span>
<span class="5901087968051131557" onmouseenter="enter('5901087968051131557');" onmouseout="out('5901087968051131557');" style=""> 753          tableEnv.registerTable(aliasInfo.getAlias(), table);                                                      </span>
<span class="1100939894023116874" onmouseenter="enter('1100939894023116874');" onmouseout="out('1100939894023116874');" style=""> 754          localTableCache.put(aliasInfo.getAlias(), table);                                                         </span>
<span  style=""> 755                                                                                                                    </span>
<span class="7353361537117728269" onmouseenter="enter('7353361537117728269');" onmouseout="out('7353361537117728269');" style=""> 756          LOG.info(&quot;Register Table {} by {}&quot;, aliasInfo.getAlias(), aliasInfo.getName());                           </span>
<span  style=""> 757                                                                                                                    </span>
<span class="-8665165690117838262" onmouseenter="enter('-8665165690117838262');" onmouseout="out('-8665165690117838262');" style=""> 758          FieldReplaceInfo fieldReplaceInfo = parseAsQuery((SqlBasicCall) pollSqlNode, tableCache);                 </span>
<span class="-7633956211129533821" onmouseenter="enter('-7633956211129533821');" onmouseout="out('-7633956211129533821');" style=""> 759          if(fieldReplaceInfo == null){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 760             return;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 761          }                                                                                                         </span>
<span  style=""> 762                                                                                                                    </span>
<span class="-6438671410831308886" onmouseenter="enter('-6438671410831308886');" onmouseout="out('-6438671410831308886');" style=""> 763          //as 的源表                                                                                                  </span>
<span class="-7252441079357822746" onmouseenter="enter('-7252441079357822746');" onmouseout="out('-7252441079357822746');" style=""> 764          Set&lt;String&gt; fromTableNameSet = Sets.newHashSet();                                                         </span>
<span class="-1390965398492412473" onmouseenter="enter('-1390965398492412473');" onmouseout="out('-1390965398492412473');" style=""> 765          SqlNode fromNode = ((SqlBasicCall)pollSqlNode).getOperands()[0];                                          </span>
<span class="8218826531385538687" onmouseenter="enter('8218826531385538687');" onmouseout="out('8218826531385538687');" style=""> 766          TableUtils.getFromTableInfo(fromNode, fromTableNameSet);                                                  </span>
<span class="3962421982275373463" onmouseenter="enter('3962421982275373463');" onmouseout="out('3962421982275373463');" style=""> 767          for(FieldReplaceInfo tmp : replaceInfoList){                                                              </span>
<span class="7807393280391431617" onmouseenter="enter('7807393280391431617');" onmouseout="out('7807393280391431617');" style=""> 768              if(fromTableNameSet.contains(tmp.getTargetTableName())                                                </span>
<span class="-8987246733617074829" onmouseenter="enter('-8987246733617074829');" onmouseout="out('-8987246733617074829');" style=""> 769                      || fromTableNameSet.contains(tmp.getTargetTableAlias())){                                     </span>
<span class="-8130963267335023429" onmouseenter="enter('-8130963267335023429');" onmouseout="out('-8130963267335023429');" style=""> 770                  fieldReplaceInfo.setPreNode(tmp);                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 771                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 772              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 773          }                                                                                                         </span>
<span class="2047826278835391080" onmouseenter="enter('2047826278835391080');" onmouseout="out('2047826278835391080');" style=""> 774          replaceInfoList.add(fieldReplaceInfo);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 775      }                                                                                                             </span>
<span  style=""> 776                                                                                                                    </span>
<span class="4197581530070317287" onmouseenter="enter('4197581530070317287');" onmouseout="out('4197581530070317287');" style=""> 777      private void joinFun(Object pollObj, Map&lt;String, Table&gt; localTableCache,                                      </span>
<span class="3515836699345174480" onmouseenter="enter('3515836699345174480');" onmouseout="out('3515836699345174480');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 778 -                         Map&lt;String, SideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,                </span>
<span class="-7423850058561480692" onmouseenter="enter('-7423850058561480692');" onmouseout="out('-7423850058561480692');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 779 +                         Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, StreamTableEnvironment tableEnv,        </span>
<span class="-2956355081691304387" onmouseenter="enter('-2956355081691304387');" onmouseout="out('-2956355081691304387');" style=""> 780                           List&lt;FieldReplaceInfo&gt; replaceInfoList) throws Exception{                                </span>







<span class="-3106951960183426296" onmouseenter="enter('-3106951960183426296');" onmouseout="out('-3106951960183426296');" style=""> 781          JoinInfo joinInfo = (JoinInfo) pollObj;                                                                   </span>
<span  style=""> 782                                                                                                                    </span>
<span class="-4580559439294190862" onmouseenter="enter('-4580559439294190862');" onmouseout="out('-4580559439294190862');" style=""> 783          JoinScope joinScope = new JoinScope();                                                                    </span>
<span class="-6383140859888654083" onmouseenter="enter('-6383140859888654083');" onmouseout="out('-6383140859888654083');" style=""> 784          JoinScope.ScopeChild leftScopeChild = new JoinScope.ScopeChild();                                         </span>
<span class="-5401707331330951256" onmouseenter="enter('-5401707331330951256');" onmouseout="out('-5401707331330951256');" style=""> 785          leftScopeChild.setAlias(joinInfo.getLeftTableAlias());                                                    </span>
<span class="5108424867732442426" onmouseenter="enter('5108424867732442426');" onmouseout="out('5108424867732442426');" style=""> 786          leftScopeChild.setTableName(joinInfo.getLeftTableName());                                                 </span>
<span  style=""> 787                                                                                                                    </span>
<span class="-3105793890099317611" onmouseenter="enter('-3105793890099317611');" onmouseout="out('-3105793890099317611');" style=""> 788          SqlKind sqlKind = joinInfo.getLeftNode().getKind();                                                       </span>
<span class="9064898697795185402" onmouseenter="enter('9064898697795185402');" onmouseout="out('9064898697795185402');" style=""> 789          if(sqlKind == AS){                                                                                        </span>
<span class="17281975900406720" onmouseenter="enter('17281975900406720');" onmouseout="out('17281975900406720');" style=""> 790              dealAsSourceTable(tableEnv, joinInfo.getLeftNode(), localTableCache, replaceInfoList);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 791          }                                                                                                         </span>
<span  style=""> 792                                                                                                                    </span>
<span class="-2402361542513321069" onmouseenter="enter('-2402361542513321069');" onmouseout="out('-2402361542513321069');" style=""><abbr title=" 793          Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableName());"> 793          Table leftTable = getTableFromCache(localTableCache, joinInfo.getLeftTableAlias(), joinInfo.getLeftTableNa🔵</abbr></span>
<span class="5224542232803887157" onmouseenter="enter('5224542232803887157');" onmouseout="out('5224542232803887157');" style=""><abbr title=" 794          RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColumnNames());"> 794          RowTypeInfo leftTypeInfo = new RowTypeInfo(leftTable.getSchema().getTypes(), leftTable.getSchema().getColu🔵</abbr></span>
<span class="-5303860989220332569" onmouseenter="enter('-5303860989220332569');" onmouseout="out('-5303860989220332569');" style=""> 795          leftScopeChild.setRowTypeInfo(leftTypeInfo);                                                              </span>
<span  style=""> 796                                                                                                                    </span>
<span class="3043795906382715340" onmouseenter="enter('3043795906382715340');" onmouseout="out('3043795906382715340');" style=""> 797          JoinScope.ScopeChild rightScopeChild = new JoinScope.ScopeChild();                                        </span>
<span class="2585249270397691815" onmouseenter="enter('2585249270397691815');" onmouseout="out('2585249270397691815');" style=""> 798          rightScopeChild.setAlias(joinInfo.getRightTableAlias());                                                  </span>
<span class="-5072747544386586876" onmouseenter="enter('-5072747544386586876');" onmouseout="out('-5072747544386586876');" style=""> 799          rightScopeChild.setTableName(joinInfo.getRightTableName());                                               </span>
<span class="-1752720370690577453" onmouseenter="enter('-1752720370690577453');" onmouseout="out('-1752720370690577453');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 800 -        SideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());                             </span>
<span class="-6382774479188932768" onmouseenter="enter('-6382774479188932768');" onmouseout="out('-6382774479188932768');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 801 +        AbstractSideTableInfo sideTableInfo = sideTableMap.get(joinInfo.getRightTableName());                     </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style=""> 802          if(sideTableInfo == null){                                                                                </span>
<span class="-5396801098824602905" onmouseenter="enter('-5396801098824602905');" onmouseout="out('-5396801098824602905');" style=""> 803              sideTableInfo = sideTableMap.get(joinInfo.getRightTableAlias());                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 804          }                                                                                                         </span>
<span  style=""> 805                                                                                                                    </span>
<span class="-2759210686353099969" onmouseenter="enter('-2759210686353099969');" onmouseout="out('-2759210686353099969');" style=""> 806          if(sideTableInfo == null){                                                                                </span>
<span class="450947362076537032" onmouseenter="enter('450947362076537032');" onmouseout="out('450947362076537032');" style=""> 807              throw new RuntimeException(&quot;can&#x27;t not find side table:&quot; + joinInfo.getRightTableName());              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 808          }                                                                                                         </span>
<span  style=""> 809                                                                                                                    </span>
<span class="6668906180521634363" onmouseenter="enter('6668906180521634363');" onmouseout="out('6668906180521634363');" style=""> 810  //        if(!checkJoinCondition(joinInfo.getCondition(), joinInfo.getRightTableAlias(), sideTableInfo)){         </span>
<span class="2570085130586631416" onmouseenter="enter('2570085130586631416');" onmouseout="out('2570085130586631416');" style=""> 811  //            throw new RuntimeException(&quot;ON condition must contain all equal fields!!!&quot;);                        </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 812  //        }                                                                                                       </span>
<span  style=""> 813                                                                                                                    </span>
<span class="-1562873445908102884" onmouseenter="enter('-1562873445908102884');" onmouseout="out('-1562873445908102884');" style=""> 814          rightScopeChild.setRowTypeInfo(sideTableInfo.getRowTypeInfo());                                           </span>
<span  style=""> 815                                                                                                                    </span>
<span class="-5776192160472100987" onmouseenter="enter('-5776192160472100987');" onmouseout="out('-5776192160472100987');" style=""> 816          joinScope.addScope(leftScopeChild);                                                                       </span>
<span class="6805588345897841594" onmouseenter="enter('6805588345897841594');" onmouseout="out('6805588345897841594');" style=""> 817          joinScope.addScope(rightScopeChild);                                                                      </span>
<span  style=""> 818                                                                                                                    </span>


<span class="-816440763270240777" onmouseenter="enter('-816440763270240777');" onmouseout="out('-816440763270240777');" style=""> 819          //获取两个表的所有字段                                                                                              </span>
<span class="-6198283029075022684" onmouseenter="enter('-6198283029075022684');" onmouseout="out('-6198283029075022684');" style=""><abbr title=" 820          List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, true);"> 820          List&lt;FieldInfo&gt; sideJoinFieldInfo = ParserJoinField.getRowTypeInfo(joinInfo.getSelectNode(), joinScope, tr🔵</abbr></span>


<span  style=""> 821                                                                                                                    </span>
<span class="-1467815726997680818" onmouseenter="enter('-1467815726997680818');" onmouseout="out('-1467815726997680818');" style=""> 822          String leftTableAlias = joinInfo.getLeftTableAlias();                                                     </span>
<span class="-6434853421912213287" onmouseenter="enter('-6434853421912213287');" onmouseout="out('-6434853421912213287');" style=""> 823          Table targetTable = localTableCache.get(leftTableAlias);                                                  </span>
<span class="-6749372432358522016" onmouseenter="enter('-6749372432358522016');" onmouseout="out('-6749372432358522016');" style=""> 824          if(targetTable == null){                                                                                  </span>
<span class="8734197217231436839" onmouseenter="enter('8734197217231436839');" onmouseout="out('8734197217231436839');" style=""> 825              targetTable = localTableCache.get(joinInfo.getLeftTableName());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 826          }                                                                                                         </span>
<span  style=""> 827                                                                                                                    </span>
<span class="3450476289809538439" onmouseenter="enter('3450476289809538439');" onmouseout="out('3450476289809538439');" style=""><abbr title=" 828          RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColumnNames());"> 828          RowTypeInfo typeInfo = new RowTypeInfo(targetTable.getSchema().getTypes(), targetTable.getSchema().getColu🔵</abbr></span>
<span  style=""> 829                                                                                                                    </span>
<span class="-3004779098663820792" onmouseenter="enter('-3004779098663820792');" onmouseout="out('-3004779098663820792');" style=""> 830          DataStream&lt;CRow&gt; adaptStream = tableEnv.toRetractStream(targetTable, org.apache.flink.types.Row.class)    </span>
<span class="3479563451496228205" onmouseenter="enter('3479563451496228205');" onmouseout="out('3479563451496228205');" style=""> 831                  .map((Tuple2&lt;Boolean, Row&gt; tp2) -&gt; {                                                              </span>
<span class="7833906289428987345" onmouseenter="enter('7833906289428987345');" onmouseout="out('7833906289428987345');" style=""> 832                      return new CRow(tp2.f1, tp2.f0);                                                              </span>
<span class="-8730504840947162971" onmouseenter="enter('-8730504840947162971');" onmouseout="out('-8730504840947162971');" style=""> 833                  }).returns(CRow.class);                                                                           </span>
<span  style=""> 834                                                                                                                    </span>
<span  style=""> 835                                                                                                                    </span>
<span class="-6082173173678345991" onmouseenter="enter('-6082173173678345991');" onmouseout="out('-6082173173678345991');" style=""> 836          //join side table before keyby ===&gt; Reducing the size of each dimension table cache of async              </span>
<span class="6301552848628110191" onmouseenter="enter('6301552848628110191');" onmouseout="out('6301552848628110191');" style=""> 837          if (sideTableInfo.isPartitionedJoin()) {                                                                  </span>
<span class="-4638861421651181765" onmouseenter="enter('-4638861421651181765');" onmouseout="out('-4638861421651181765');" style=""><abbr title=" 838              List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(), sideTableInfo);"> 838              List&lt;String&gt; leftJoinColList = getConditionFields(joinInfo.getCondition(), joinInfo.getLeftTableAlias(🔵</abbr></span>
<span class="-1086375650130423707" onmouseenter="enter('-1086375650130423707');" onmouseout="out('-1086375650130423707');" style=""> 839              List&lt;String&gt; fieldNames = Arrays.asList(targetTable.getSchema().getFieldNames());                     </span>
<span class="2517152886952033206" onmouseenter="enter('2517152886952033206');" onmouseout="out('2517152886952033206');" style=""> 840              int[] keyIndex = leftJoinColList.stream().mapToInt(fieldNames::indexOf).toArray();                    </span>
<span class="-7482412719932836963" onmouseenter="enter('-7482412719932836963');" onmouseout="out('-7482412719932836963');" style=""><abbr title=" 841              adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.getSchema())));"> 841              adaptStream = adaptStream.keyBy(new CRowKeySelector(keyIndex, projectedTypeInfo(keyIndex, targetTable.🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 842          }                                                                                                         </span>
<span  style=""> 843                                                                                                                    </span>
<span class="-1065289666164106717" onmouseenter="enter('-1065289666164106717');" onmouseout="out('-1065289666164106717');" style=""> 844          DataStream&lt;CRow&gt; dsOut = null;                                                                            </span>
<span class="3901580925108094660" onmouseenter="enter('3901580925108094660');" onmouseout="out('3901580925108094660');" style=""> 845          if(ECacheType.ALL.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="7101184136852303035" onmouseenter="enter('7101184136852303035');" onmouseout="out('7101184136852303035');" style=""><abbr title=" 846              dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);"> 846              dsOut = SideWithAllCacheOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlP🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 847          }else{                                                                                                    </span>
<span class="7683243294616380271" onmouseenter="enter('7683243294616380271');" onmouseout="out('7683243294616380271');" style=""><abbr title=" 848              dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPath, typeInfo, joinInfo, sideJoinFieldInfo, sideTableInfo);"> 848              dsOut = SideAsyncOperator.getSideJoinDataStream(adaptStream, sideTableInfo.getType(), localSqlPluginPa🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 849          }                                                                                                         </span>
<span  style=""> 850                                                                                                                    </span>
<span class="1587039608171825646" onmouseenter="enter('1587039608171825646');" onmouseout="out('1587039608171825646');" style=""> 851          // TODO  将嵌套表中的字段传递过去, 去除冗余的ROWtime                                                                       </span>
<span class="-3840015462696951757" onmouseenter="enter('-3840015462696951757');" onmouseout="out('-3840015462696951757');" style=""> 852          HashBasedTable&lt;String, String, String&gt; mappingTable = HashBasedTable.create();                            </span>
<span class="2474148199265091642" onmouseenter="enter('2474148199265091642');" onmouseout="out('2474148199265091642');" style=""> 853          RowTypeInfo sideOutTypeInfo = buildOutRowTypeInfo(sideJoinFieldInfo, mappingTable);                       </span>
<span  style=""> 854                                                                                                                    </span>
<span class="-1611735526649110750" onmouseenter="enter('-1611735526649110750');" onmouseout="out('-1611735526649110750');" style=""> 855          CRowTypeInfo cRowTypeInfo = new CRowTypeInfo(sideOutTypeInfo);                                            </span>
<span class="-4428554219841205830" onmouseenter="enter('-4428554219841205830');" onmouseout="out('-4428554219841205830');" style=""> 856          dsOut.getTransformation().setOutputType(cRowTypeInfo);                                                    </span>
<span  style=""> 857                                                                                                                    </span>
<span class="4836712590888983064" onmouseenter="enter('4836712590888983064');" onmouseout="out('4836712590888983064');" style=""> 858          String targetTableName = joinInfo.getNewTableName();                                                      </span>
<span class="-3094587764130774762" onmouseenter="enter('-3094587764130774762');" onmouseout="out('-3094587764130774762');" style=""> 859          String targetTableAlias = joinInfo.getNewTableAlias();                                                    </span>
<span  style=""> 860                                                                                                                    </span>
<span class="-913526733197814375" onmouseenter="enter('-913526733197814375');" onmouseout="out('-913526733197814375');" style=""> 861          FieldReplaceInfo replaceInfo = new FieldReplaceInfo();                                                    </span>
<span class="877285140377329660" onmouseenter="enter('877285140377329660');" onmouseout="out('877285140377329660');" style=""> 862          replaceInfo.setMappingTable(mappingTable);                                                                </span>
<span class="8710576405434192583" onmouseenter="enter('8710576405434192583');" onmouseout="out('8710576405434192583');" style=""> 863          replaceInfo.setTargetTableName(targetTableName);                                                          </span>
<span class="-6613112199475906839" onmouseenter="enter('-6613112199475906839');" onmouseout="out('-6613112199475906839');" style=""> 864          replaceInfo.setTargetTableAlias(targetTableAlias);                                                        </span>
<span  style=""> 865                                                                                                                    </span>
<span class="-3207655655806857927" onmouseenter="enter('-3207655655806857927');" onmouseout="out('-3207655655806857927');" style=""> 866          //判断之前是不是被替换过,被替换过则设置之前的替换信息作为上一个节点                                                                       </span>
<span class="3962421982275373463" onmouseenter="enter('3962421982275373463');" onmouseout="out('3962421982275373463');" style=""> 867          for(FieldReplaceInfo tmp : replaceInfoList){                                                              </span>
<span class="6967693276121741260" onmouseenter="enter('6967693276121741260');" onmouseout="out('6967693276121741260');" style=""> 868              if(tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableName())                             </span>
<span class="8344413733256472211" onmouseenter="enter('8344413733256472211');" onmouseout="out('8344413733256472211');" style=""> 869              ||tmp.getTargetTableName().equalsIgnoreCase(joinInfo.getLeftTableAlias())){                           </span>
<span class="-1629804985910745096" onmouseenter="enter('-1629804985910745096');" onmouseout="out('-1629804985910745096');" style=""> 870                  replaceInfo.setPreNode(tmp);                                                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 871                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 872              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 873          }                                                                                                         </span>
<span  style=""> 874                                                                                                                    </span>
<span class="2528453225163613561" onmouseenter="enter('2528453225163613561');" onmouseout="out('2528453225163613561');" style=""> 875          replaceInfoList.add(replaceInfo);                                                                         </span>
<span  style=""> 876                                                                                                                    </span>
<span class="1268462607712077740" onmouseenter="enter('1268462607712077740');" onmouseout="out('1268462607712077740');" style=""> 877          if (!tableEnv.isRegistered(joinInfo.getNewTableName())){                                                  </span>
<span class="-9057257427162955657" onmouseenter="enter('-9057257427162955657');" onmouseout="out('-9057257427162955657');" style=""> 878              Table joinTable = tableEnv.fromDataStream(dsOut);                                                     </span>
<span class="-7674974637599312088" onmouseenter="enter('-7674974637599312088');" onmouseout="out('-7674974637599312088');" style=""> 879              tableEnv.registerTable(joinInfo.getNewTableName(), joinTable);                                        </span>
<span class="5569875846259576593" onmouseenter="enter('5569875846259576593');" onmouseout="out('5569875846259576593');" style=""> 880              localTableCache.put(joinInfo.getNewTableName(), joinTable);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 881          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 882      }                                                                                                             </span>
<span  style=""> 883                                                                                                                    </span>
<span class="2503560481488678812" onmouseenter="enter('2503560481488678812');" onmouseout="out('2503560481488678812');" style=""> 884      private TypeInformation&lt;Row&gt; projectedTypeInfo(int[] fields, TableSchema schema) {                            </span>
<span class="-934325254904626531" onmouseenter="enter('-934325254904626531');" onmouseout="out('-934325254904626531');" style=""> 885          String[] fieldNames = schema.getFieldNames();                                                             </span>
<span class="4556717060829301814" onmouseenter="enter('4556717060829301814');" onmouseout="out('4556717060829301814');" style=""> 886          TypeInformation&lt;?&gt;[] fieldTypes = schema.getFieldTypes();                                                 </span>
<span  style=""> 887                                                                                                                    </span>
<span class="424178526470659793" onmouseenter="enter('424178526470659793');" onmouseout="out('424178526470659793');" style=""> 888          String[] projectedNames = Arrays.stream(fields).mapToObj(i -&gt; fieldNames[i]).toArray(String[]::new);      </span>
<span class="5411397013359382914" onmouseenter="enter('5411397013359382914');" onmouseout="out('5411397013359382914');" style=""><abbr title=" 889          TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(TypeInformation[]::new);"> 889          TypeInformation[] projectedTypes = Arrays.stream(fields).mapToObj(i -&gt; fieldTypes[i]).toArray(TypeInformat🔵</abbr></span>
<span class="-5627838059420262860" onmouseenter="enter('-5627838059420262860');" onmouseout="out('-5627838059420262860');" style=""> 890          return new RowTypeInfo(projectedTypes, projectedNames);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 891      }                                                                                                             </span>
<span  style=""> 892                                                                                                                    </span>
<span  style=""> 893                                                                                                                    </span>
<span class="-410103274617159114" onmouseenter="enter('-410103274617159114');" onmouseout="out('-410103274617159114');" style=""> 894      private boolean checkFieldsInfo(CreateTmpTableParser.SqlParserResult result, Table table) {                   </span>
<span class="8925867441251499081" onmouseenter="enter('8925867441251499081');" onmouseout="out('8925867441251499081');" style=""> 895          List&lt;String&gt; fieldNames = new LinkedList&lt;&gt;();                                                             </span>
<span class="-5553816012496774052" onmouseenter="enter('-5553816012496774052');" onmouseout="out('-5553816012496774052');" style=""> 896          String fieldsInfo = result.getFieldsInfoStr();                                                            </span>
<span class="-5855731071361337066" onmouseenter="enter('-5855731071361337066');" onmouseout="out('-5855731071361337066');" style=""> 897          String[] fields = StringUtils.split(fieldsInfo, &quot;,&quot;);                                                     </span>
<span class="8167763809890058258" onmouseenter="enter('8167763809890058258');" onmouseout="out('8167763809890058258');" style=""> 898          for (int i = 0; i &lt; fields.length; i++) {                                                                 </span>
<span class="2947314498030065040" onmouseenter="enter('2947314498030065040');" onmouseout="out('2947314498030065040');" style=""> 899              String[] filed = fields[i].split(&quot;\\s&quot;);                                                              </span>
<span class="-1166806966413379737" onmouseenter="enter('-1166806966413379737');" onmouseout="out('-1166806966413379737');" style=""> 900              if (filed.length &lt; 2 || fields.length != table.getSchema().getColumnNames().length){                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 901                  return false;                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 902              } else {                                                                                              </span>
<span class="-7518627407039835792" onmouseenter="enter('-7518627407039835792');" onmouseout="out('-7518627407039835792');" style=""> 903                  String[] filedNameArr = new String[filed.length - 1];                                             </span>
<span class="6064994574122217386" onmouseenter="enter('6064994574122217386');" onmouseout="out('6064994574122217386');" style=""> 904                  System.arraycopy(filed, 0, filedNameArr, 0, filed.length - 1);                                    </span>
<span class="-3029457015937137256" onmouseenter="enter('-3029457015937137256');" onmouseout="out('-3029457015937137256');" style=""> 905                  String fieldName = String.join(&quot; &quot;, filedNameArr);                                                </span>
<span class="-8037943253867791720" onmouseenter="enter('-8037943253867791720');" onmouseout="out('-8037943253867791720');" style=""> 906                  fieldNames.add(fieldName);                                                                        </span>
<span class="516386479555957316" onmouseenter="enter('516386479555957316');" onmouseout="out('516386479555957316');" style=""> 907                  String fieldType = filed[filed.length - 1 ].trim();                                               </span>
<span class="-8511761590344571010" onmouseenter="enter('-8511761590344571010');" onmouseout="out('-8511761590344571010');" style=""> 908                  Class fieldClass = ClassUtil.stringConvertClass(fieldType);                                       </span>
<span class="-351203522969775469" onmouseenter="enter('-351203522969775469');" onmouseout="out('-351203522969775469');" style=""> 909                  Class tableField = table.getSchema().getFieldType(i).get().getTypeClass();                        </span>
<span class="9126336856345087988" onmouseenter="enter('9126336856345087988');" onmouseout="out('9126336856345087988');" style=""> 910                  if (fieldClass == tableField){                                                                    </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 911                      continue;                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 912                  } else {                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 913                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 914                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 915              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 916          }                                                                                                         </span>
<span class="-7181802501759976675" onmouseenter="enter('-7181802501759976675');" onmouseout="out('-7181802501759976675');" style=""> 917          tmpFields = String.join(&quot;,&quot;, fieldNames);                                                                 </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 918          return true;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 919      }                                                                                                             </span>
<span  style=""> 920                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 921  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            