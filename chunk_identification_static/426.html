<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>426</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    426
                    <a href="425.html">prev</a>
                    <a href="427.html">next</a>
                    <a href="426_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_21b0e2ad2fb2e40fe8aea28c453f6ab209e5f1af_kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;21b0e2ad2fb2e40fe8aea28c453f6ab209e5f1af:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;21b0e2ad2fb2e40fe8aea28c453f6ab209e5f1af^1:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;21b0e2ad2fb2e40fe8aea28c453f6ab209e5f1af^2:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;210b9c3cb61e84b04c5f09f8f0fccec9c746acb0:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bsj]], subset: [[bsj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-7064734655611069376" onmouseenter="enter('-7064734655611069376');" onmouseout="out('-7064734655611069376');" style="">  20 package com.dtstack.flink.sql.source.kafka.table;                                                        </span>
<span  style="">  21                                                                                                          </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  22 import com.dtstack.flink.sql.format.FormatType;                                                          </span>
<span class="1858401820470473532" onmouseenter="enter('1858401820470473532');" onmouseout="out('1858401820470473532');" style="">  23 import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;                                            </span>
<span class="397918604901287985" onmouseenter="enter('397918604901287985');" onmouseout="out('397918604901287985');" style="">  24 import com.dtstack.flink.sql.table.AbstractSourceParser;                                                 </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="">  25 import com.dtstack.flink.sql.table.AbstractTableInfo;                                                    </span>
<span class="-5753193131350624266" onmouseenter="enter('-5753193131350624266');" onmouseout="out('-5753193131350624266');" style="">  26 import com.dtstack.flink.sql.util.MathUtil;                                                              </span>
<span  style="">  27                                                                                                          </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  28 import java.util.Map;                                                                                    </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  29 import java.util.stream.Collectors;                                                                      </span>
<span  style="">  30                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  31 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  32  * Reason:                                                                                               </span>
<span class="4222025842925612011" onmouseenter="enter('4222025842925612011');" onmouseout="out('4222025842925612011');" style="">  33  * Date: 2018/09/18                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  34  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  35  *                                                                                                       </span>
<span class="-3971691924018094169" onmouseenter="enter('-3971691924018094169');" onmouseout="out('-3971691924018094169');" style="">  36  * @author sishu.yss                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  37  */                                                                                                      </span>
<span class="-2502602030432015530" onmouseenter="enter('-2502602030432015530');" onmouseout="out('-2502602030432015530');" style="">  38 public class KafkaSourceParser extends AbstractSourceParser {                                            </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  39     @Override                                                                                            </span>
<span class="3632243130028915065" onmouseenter="enter('3632243130028915065');" onmouseout="out('3632243130028915065');" style=""><abbr title="  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props)ðŸ”µ</abbr></span>
<span  style="">  41                                                                                                          </span>
<span class="-3979680527446739160" onmouseenter="enter('-3979680527446739160');" onmouseout="out('-3979680527446739160');" style="">  42         KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();                          </span>
<span class="6868994740360842973" onmouseenter="enter('6868994740360842973');" onmouseout="out('6868994740360842973');" style="">  43         parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);                                               </span>
<span  style="">  44                                                                                                          </span>
<span class="-6128440189444499998" onmouseenter="enter('-6128440189444499998');" onmouseout="out('-6128440189444499998');" style="">  45         kafkaSourceTableInfo.setName(tableName);                                                         </span>
<span class="2019232699127483322" onmouseenter="enter('2019232699127483322');" onmouseout="out('2019232699127483322');" style=""><abbr title="  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));">  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCaðŸ”µ</abbr></span>
<span class="-2598610944087485625" onmouseenter="enter('-2598610944087485625');" onmouseout="out('-2598610944087485625');" style=""><abbr title="  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLEðŸ”µ</abbr></span>
<span class="589208455079856491" onmouseenter="enter('589208455079856491');" onmouseout="out('589208455079856491');" style=""><abbr title="  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTðŸ”µ</abbr></span>
<span class="-5656758930033021588" onmouseenter="enter('-5656758930033021588');" onmouseout="out('-5656758930033021588');" style=""><abbr title="  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr></span>
<span class="7034285388524040854" onmouseenter="enter('7034285388524040854');" onmouseout="out('7034285388524040854');" style=""><abbr title="  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr></span>
<span class="-5435927246048491177" onmouseenter="enter('-5435927246048491177');" onmouseout="out('-5435927246048491177');" style=""><abbr title="  51         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  51         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span class="-1856417297190168609" onmouseenter="enter('-1856417297190168609');" onmouseout="out('-1856417297190168609');" style=""><abbr title="  52         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  52         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  53 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="8077300323415965285" onmouseenter="enter('8077300323415965285');" onmouseout="out('8077300323415965285');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  54         kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHARSET_NAME_KEY.toLowerCase(),&quot;UTF-8&quot;)));">  54         kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHðŸ”µ</abbr></span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  55 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-5435927246048491177" onmouseenter="enter('-5435927246048491177');" onmouseout="out('-5435927246048491177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  56         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  56         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span class="-1856417297190168609" onmouseenter="enter('-1856417297190168609');" onmouseout="out('-1856417297190168609');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  57         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  57         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span class="1997534063297468740" onmouseenter="enter('1997534063297468740');" onmouseout="out('1997534063297468740');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  58         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  58         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  59 =======                                                                                                  </span>
<span class="3453681674607214640" onmouseenter="enter('3453681674607214640');" onmouseout="out('3453681674607214640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  60         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  60         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFðŸ”µ</abbr></span>
<span class="-351688158129114478" onmouseenter="enter('-351688158129114478');" onmouseout="out('-351688158129114478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  61         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  61         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  62 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="1997534063297468740" onmouseenter="enter('1997534063297468740');" onmouseout="out('1997534063297468740');" style=""><abbr title="  63         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  63         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr></span>
<span  style="">  64                                                                                                          </span>
<span class="8331248545936659113" onmouseenter="enter('8331248545936659113');" onmouseout="out('8331248545936659113');" style=""><abbr title="  65         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  65         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRðŸ”µ</abbr></span>
<span class="-4341467090526335917" onmouseenter="enter('-4341467090526335917');" onmouseout="out('-4341467090526335917');" style=""><abbr title="  66         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  66         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr></span>
<span class="-728668885073268529" onmouseenter="enter('-728668885073268529');" onmouseout="out('-728668885073268529');" style=""><abbr title="  67         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  67         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr></span>
<span  style="">  68                                                                                                          </span>
<span class="-920529234545737528" onmouseenter="enter('-920529234545737528');" onmouseout="out('-920529234545737528');" style="">  69         Map&lt;String, String&gt; kafkaParams = props.keySet().stream()                                        </span>
<span class="5789555383205784072" onmouseenter="enter('5789555383205784072');" onmouseout="out('5789555383205784072');" style="">  70                 .filter(key -&gt; !key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;))                               </span>
<span class="-7544825204510117185" onmouseenter="enter('-7544825204510117185');" onmouseout="out('-7544825204510117185');" style="">  71                 .collect(Collectors.toMap(                                                               </span>
<span class="303964316823078642" onmouseenter="enter('303964316823078642');" onmouseout="out('303964316823078642');" style="">  72                         key -&gt; key.substring(6), key -&gt; props.get(key).toString())                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="">  73                 );                                                                                       </span>
<span  style="">  74                                                                                                          </span>
<span class="6518789662065103019" onmouseenter="enter('6518789662065103019');" onmouseout="out('6518789662065103019');" style="">  75         kafkaSourceTableInfo.addKafkaParam(kafkaParams);                                                 </span>
<span class="2124594157128188747" onmouseenter="enter('2124594157128188747');" onmouseout="out('2124594157128188747');" style="">  76         kafkaSourceTableInfo.check();                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="1830791182698526741" onmouseenter="enter('1830791182698526741');" onmouseout="out('1830791182698526741');" style="">  78         return kafkaSourceTableInfo;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80 }                                                                                                        </span>

</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-7064734655611069376" onmouseenter="enter('-7064734655611069376');" onmouseout="out('-7064734655611069376');" style="">  20 package com.dtstack.flink.sql.source.kafka.table;                                                        </span>
<span  style="">  21                                                                                                          </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  22 import com.dtstack.flink.sql.format.FormatType;                                                          </span>
<span class="1858401820470473532" onmouseenter="enter('1858401820470473532');" onmouseout="out('1858401820470473532');" style="">  23 import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;                                            </span>
<span class="397918604901287985" onmouseenter="enter('397918604901287985');" onmouseout="out('397918604901287985');" style="">  24 import com.dtstack.flink.sql.table.AbstractSourceParser;                                                 </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="">  25 import com.dtstack.flink.sql.table.AbstractTableInfo;                                                    </span>
<span class="-5753193131350624266" onmouseenter="enter('-5753193131350624266');" onmouseout="out('-5753193131350624266');" style="">  26 import com.dtstack.flink.sql.util.MathUtil;                                                              </span>
<span  style="">  27                                                                                                          </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  28 import java.util.Map;                                                                                    </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  29 import java.util.stream.Collectors;                                                                      </span>
<span  style="">  30                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  31 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  32  * Reason:                                                                                               </span>
<span class="4222025842925612011" onmouseenter="enter('4222025842925612011');" onmouseout="out('4222025842925612011');" style="">  33  * Date: 2018/09/18                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  34  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  35  *                                                                                                       </span>
<span class="-3971691924018094169" onmouseenter="enter('-3971691924018094169');" onmouseout="out('-3971691924018094169');" style="">  36  * @author sishu.yss                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  37  */                                                                                                      </span>
<span class="-2502602030432015530" onmouseenter="enter('-2502602030432015530');" onmouseout="out('-2502602030432015530');" style="">  38 public class KafkaSourceParser extends AbstractSourceParser {                                            </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  39     @Override                                                                                            </span>
<span class="3632243130028915065" onmouseenter="enter('3632243130028915065');" onmouseout="out('3632243130028915065');" style=""><abbr title="  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props)ðŸ”µ</abbr></span>
<span  style="">  41                                                                                                          </span>
<span class="-3979680527446739160" onmouseenter="enter('-3979680527446739160');" onmouseout="out('-3979680527446739160');" style="">  42         KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();                          </span>
<span class="6868994740360842973" onmouseenter="enter('6868994740360842973');" onmouseout="out('6868994740360842973');" style="">  43         parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);                                               </span>
<span  style="">  44                                                                                                          </span>
<span class="-6128440189444499998" onmouseenter="enter('-6128440189444499998');" onmouseout="out('-6128440189444499998');" style="">  45         kafkaSourceTableInfo.setName(tableName);                                                         </span>
<span class="2019232699127483322" onmouseenter="enter('2019232699127483322');" onmouseout="out('2019232699127483322');" style=""><abbr title="  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));">  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCaðŸ”µ</abbr></span>
<span class="-2598610944087485625" onmouseenter="enter('-2598610944087485625');" onmouseout="out('-2598610944087485625');" style=""><abbr title="  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLEðŸ”µ</abbr></span>
<span class="589208455079856491" onmouseenter="enter('589208455079856491');" onmouseout="out('589208455079856491');" style=""><abbr title="  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTðŸ”µ</abbr></span>
<span class="-5656758930033021588" onmouseenter="enter('-5656758930033021588');" onmouseout="out('-5656758930033021588');" style=""><abbr title="  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr></span>
<span class="7034285388524040854" onmouseenter="enter('7034285388524040854');" onmouseout="out('7034285388524040854');" style=""><abbr title="  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr></span>
<span class="-5435927246048491177" onmouseenter="enter('-5435927246048491177');" onmouseout="out('-5435927246048491177');" style=""><abbr title="  51         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  51         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span class="-1856417297190168609" onmouseenter="enter('-1856417297190168609');" onmouseout="out('-1856417297190168609');" style=""><abbr title="  52         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  52         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  53 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="8077300323415965285" onmouseenter="enter('8077300323415965285');" onmouseout="out('8077300323415965285');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  54         kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHARSET_NAME_KEY.toLowerCase(),&quot;UTF-8&quot;)));">  54         kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHðŸ”µ</abbr></span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  55 ||||||| BASE                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56         }                                                                                                </span>
<span class="-5656758930033021588" onmouseenter="enter('-5656758930033021588');" onmouseout="out('-5656758930033021588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  57         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  57         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr></span>
<span class="7034285388524040854" onmouseenter="enter('7034285388524040854');" onmouseout="out('7034285388524040854');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  58         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  58         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr></span>
<span class="-5435927246048491177" onmouseenter="enter('-5435927246048491177');" onmouseout="out('-5435927246048491177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  59         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  59         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span class="-1856417297190168609" onmouseenter="enter('-1856417297190168609');" onmouseout="out('-1856417297190168609');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  60         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  60         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span class="1997534063297468740" onmouseenter="enter('1997534063297468740');" onmouseout="out('1997534063297468740');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  61         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  61         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  62 =======                                                                                                  </span>
<span class="3453681674607214640" onmouseenter="enter('3453681674607214640');" onmouseout="out('3453681674607214640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  63         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  63         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFðŸ”µ</abbr></span>
<span class="-351688158129114478" onmouseenter="enter('-351688158129114478');" onmouseout="out('-351688158129114478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  64         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  64         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  65 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="1997534063297468740" onmouseenter="enter('1997534063297468740');" onmouseout="out('1997534063297468740');" style=""><abbr title="  66         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  66         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr></span>
<span  style="">  67                                                                                                          </span>
<span class="8331248545936659113" onmouseenter="enter('8331248545936659113');" onmouseout="out('8331248545936659113');" style=""><abbr title="  68         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  68         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRðŸ”µ</abbr></span>
<span class="-4341467090526335917" onmouseenter="enter('-4341467090526335917');" onmouseout="out('-4341467090526335917');" style=""><abbr title="  69         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  69         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr></span>
<span class="-728668885073268529" onmouseenter="enter('-728668885073268529');" onmouseout="out('-728668885073268529');" style=""><abbr title="  70         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  70         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr></span>
<span  style="">  71                                                                                                          </span>
<span class="-920529234545737528" onmouseenter="enter('-920529234545737528');" onmouseout="out('-920529234545737528');" style="">  72         Map&lt;String, String&gt; kafkaParams = props.keySet().stream()                                        </span>
<span class="5789555383205784072" onmouseenter="enter('5789555383205784072');" onmouseout="out('5789555383205784072');" style="">  73                 .filter(key -&gt; !key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;))                               </span>
<span class="-7544825204510117185" onmouseenter="enter('-7544825204510117185');" onmouseout="out('-7544825204510117185');" style="">  74                 .collect(Collectors.toMap(                                                               </span>
<span class="303964316823078642" onmouseenter="enter('303964316823078642');" onmouseout="out('303964316823078642');" style="">  75                         key -&gt; key.substring(6), key -&gt; props.get(key).toString())                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="">  76                 );                                                                                       </span>
<span  style="">  77                                                                                                          </span>
<span class="6518789662065103019" onmouseenter="enter('6518789662065103019');" onmouseout="out('6518789662065103019');" style="">  78         kafkaSourceTableInfo.addKafkaParam(kafkaParams);                                                 </span>
<span class="2124594157128188747" onmouseenter="enter('2124594157128188747');" onmouseout="out('2124594157128188747');" style="">  79         kafkaSourceTableInfo.check();                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="1830791182698526741" onmouseenter="enter('1830791182698526741');" onmouseout="out('1830791182698526741');" style="">  81         return kafkaSourceTableInfo;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-7064734655611069376" onmouseenter="enter('-7064734655611069376');" onmouseout="out('-7064734655611069376');" style="">  18 package com.dtstack.flink.sql.source.kafka.table;                                                        </span>
<span  style="">  19                                                                                                          </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  20 import com.dtstack.flink.sql.format.FormatType;                                                          </span>
<span class="1858401820470473532" onmouseenter="enter('1858401820470473532');" onmouseout="out('1858401820470473532');" style="">  21 import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;                                            </span>
<span class="397918604901287985" onmouseenter="enter('397918604901287985');" onmouseout="out('397918604901287985');" style="">  22 import com.dtstack.flink.sql.table.AbstractSourceParser;                                                 </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="">  23 import com.dtstack.flink.sql.table.AbstractTableInfo;                                                    </span>
<span class="-5753193131350624266" onmouseenter="enter('-5753193131350624266');" onmouseout="out('-5753193131350624266');" style="">  24 import com.dtstack.flink.sql.util.MathUtil;                                                              </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  25 import java.util.Map;                                                                                    </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  26 import java.util.stream.Collectors;                                                                      </span>
<span  style="">  27                                                                                                          </span>
<span  style="">  28                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  29 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  30  * Reason:                                                                                               </span>
<span class="4222025842925612011" onmouseenter="enter('4222025842925612011');" onmouseout="out('4222025842925612011');" style="">  31  * Date: 2018/09/18                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  32  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  33  *                                                                                                       </span>
<span class="-3971691924018094169" onmouseenter="enter('-3971691924018094169');" onmouseout="out('-3971691924018094169');" style="">  34  * @author sishu.yss                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  35  */                                                                                                      </span>
<span class="-2502602030432015530" onmouseenter="enter('-2502602030432015530');" onmouseout="out('-2502602030432015530');" style="">  36 public class KafkaSourceParser extends AbstractSourceParser {                                            </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  37     @Override                                                                                            </span>
<span class="3632243130028915065" onmouseenter="enter('3632243130028915065');" onmouseout="out('3632243130028915065');" style=""><abbr title="  38     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  38     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props)ðŸ”µ</abbr></span>
<span class="-3979680527446739160" onmouseenter="enter('-3979680527446739160');" onmouseout="out('-3979680527446739160');" style="">  39         KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();                          </span>
<span class="6868994740360842973" onmouseenter="enter('6868994740360842973');" onmouseout="out('6868994740360842973');" style="">  40         parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);                                               </span>
<span class="-6128440189444499998" onmouseenter="enter('-6128440189444499998');" onmouseout="out('-6128440189444499998');" style="">  41         kafkaSourceTableInfo.setName(tableName);                                                         </span>
<span class="2019232699127483322" onmouseenter="enter('2019232699127483322');" onmouseout="out('2019232699127483322');" style=""><abbr title="  42         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));">  42         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCaðŸ”µ</abbr></span>
<span class="-2598610944087485625" onmouseenter="enter('-2598610944087485625');" onmouseout="out('-2598610944087485625');" style=""><abbr title="  43         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  43         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLEðŸ”µ</abbr></span>
<span class="589208455079856491" onmouseenter="enter('589208455079856491');" onmouseout="out('589208455079856491');" style=""><abbr title="  44         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  44         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTðŸ”µ</abbr></span>
<span class="-5656758930033021588" onmouseenter="enter('-5656758930033021588');" onmouseout="out('-5656758930033021588');" style=""><abbr title="  45         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  45         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr></span>
<span class="7034285388524040854" onmouseenter="enter('7034285388524040854');" onmouseout="out('7034285388524040854');" style=""><abbr title="  46         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  46         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr></span>
<span class="-5435927246048491177" onmouseenter="enter('-5435927246048491177');" onmouseout="out('-5435927246048491177');" style=""><abbr title="  47         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  47         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span class="-1856417297190168609" onmouseenter="enter('-1856417297190168609');" onmouseout="out('-1856417297190168609');" style=""><abbr title="  48         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  48         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span  style="">  49                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style="">  50 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="8077300323415965285" onmouseenter="enter('8077300323415965285');" onmouseout="out('8077300323415965285');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  51         kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHARSET_NAME_KEY.toLowerCase(),&quot;UTF-8&quot;)));">  51         kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHðŸ”µ</abbr></span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  52 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  53 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">  53 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  54 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  55                                                                                                          </span>
<span class="3453681674607214640" onmouseenter="enter('3453681674607214640');" onmouseout="out('3453681674607214640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  56         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  56         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFðŸ”µ</abbr></span>
<span class="-351688158129114478" onmouseenter="enter('-351688158129114478');" onmouseout="out('-351688158129114478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  57         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  57         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style="">  58 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span  style="">  59                                                                                                          </span>
<span class="1997534063297468740" onmouseenter="enter('1997534063297468740');" onmouseout="out('1997534063297468740');" style=""><abbr title="  60         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  60         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr></span>
<span class="8331248545936659113" onmouseenter="enter('8331248545936659113');" onmouseout="out('8331248545936659113');" style=""><abbr title="  61         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  61         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRðŸ”µ</abbr></span>
<span class="-4341467090526335917" onmouseenter="enter('-4341467090526335917');" onmouseout="out('-4341467090526335917');" style=""><abbr title="  62         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  62         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr></span>
<span class="-728668885073268529" onmouseenter="enter('-728668885073268529');" onmouseout="out('-728668885073268529');" style=""><abbr title="  63         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  63         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr></span>
<span class="1355552943588502731" onmouseenter="enter('1355552943588502731');" onmouseout="out('1355552943588502731');" style=""><abbr title="  64         Map&lt;String, String&gt; kafkaParams = props.keySet().stream().filter(( key) -&gt; (!key.isEmpty()) &amp;&amp; key.startsWith(&quot;kafka.&quot;)).collect(Collectors.toMap(( key) -&gt; key.substring(6), ( key) -&gt; props.get(key).toString()));">  64         Map&lt;String, String&gt; kafkaParams = props.keySet().stream().filter(( key) -&gt; (!key.isEmpty()) &amp;&amp; keðŸ”µ</abbr></span>
<span class="6518789662065103019" onmouseenter="enter('6518789662065103019');" onmouseout="out('6518789662065103019');" style="">  65         kafkaSourceTableInfo.addKafkaParam(kafkaParams);                                                 </span>
<span class="2124594157128188747" onmouseenter="enter('2124594157128188747');" onmouseout="out('2124594157128188747');" style="">  66         kafkaSourceTableInfo.check();                                                                    </span>
<span class="1830791182698526741" onmouseenter="enter('1830791182698526741');" onmouseout="out('1830791182698526741');" style="">  67         return kafkaSourceTableInfo;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  68     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69 }                                                                                                        </span>












</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="-7064734655611069376" onmouseenter="enter('-7064734655611069376');" onmouseout="out('-7064734655611069376');" style="">  20  package com.dtstack.flink.sql.source.kafka.table;                                                                 </span>
<span  style="">  21                                                                                                                    </span>
<span class="7029823032971829565" onmouseenter="enter('7029823032971829565');" onmouseout="out('7029823032971829565');" style="">  22  import com.dtstack.flink.sql.table.AbsSourceParser;                                                               </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="">  23  import com.dtstack.flink.sql.table.TableInfo;                                                                     </span>




<span class="-5753193131350624266" onmouseenter="enter('-5753193131350624266');" onmouseout="out('-5753193131350624266');" style="">  24  import com.dtstack.flink.sql.util.MathUtil;                                                                       </span>
<span  style="">  25                                                                                                                    </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  26  import java.util.Map;                                                                                             </span>

<span  style="">  27                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  28  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  29   * Reason:                                                                                                        </span>
<span class="4222025842925612011" onmouseenter="enter('4222025842925612011');" onmouseout="out('4222025842925612011');" style="">  30   * Date: 2018/09/18                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  31   * Company: www.dtstack.com                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  32   *                                                                                                                </span>
<span class="-3971691924018094169" onmouseenter="enter('-3971691924018094169');" onmouseout="out('-3971691924018094169');" style="">  33   * @author sishu.yss                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  34   */                                                                                                               </span>
<span class="9137423138432248425" onmouseenter="enter('9137423138432248425');" onmouseout="out('9137423138432248425');" style="">  35  public class KafkaSourceParser extends AbsSourceParser {                                                          </span>

<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  36      @Override                                                                                                     </span>
<span class="-910491477086395452" onmouseenter="enter('-910491477086395452');" onmouseout="out('-910491477086395452');" style=""><abbr title="  37      public TableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  37      public TableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws ExceptionðŸ”µ</abbr></span>

<span  style="">  38                                                                                                                    </span>
<span class="-3979680527446739160" onmouseenter="enter('-3979680527446739160');" onmouseout="out('-3979680527446739160');" style="">  39          KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();                                   </span>


<span class="-6128440189444499998" onmouseenter="enter('-6128440189444499998');" onmouseout="out('-6128440189444499998');" style="">  40          kafkaSourceTableInfo.setName(tableName);                                                                  </span>
<span class="2019232699127483322" onmouseenter="enter('2019232699127483322');" onmouseout="out('2019232699127483322');" style="">  41          kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase()))); </span>
<span class="6868994740360842973" onmouseenter="enter('6868994740360842973');" onmouseout="out('6868994740360842973');" style="">  42          parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);                                                        </span>
<span  style="">  43                                                                                                                    </span>
<span class="-2598610944087485625" onmouseenter="enter('-2598610944087485625');" onmouseout="out('-2598610944087485625');" style=""><abbr title="  44          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  44          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.ðŸ”µ</abbr></span>
<span class="6556389195897426667" onmouseenter="enter('6556389195897426667');" onmouseout="out('6556389195897426667');" style=""><abbr title="  45          String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase()));">  45          String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCasðŸ”µ</abbr></span>
<span class="-6041173648844585113" onmouseenter="enter('-6041173648844585113');" onmouseout="out('-6041173648844585113');" style="">  46          if (bootstrapServer == null || bootstrapServer.trim().equals(&quot;&quot;)) {                                       </span>
<span class="1705750656220000856" onmouseenter="enter('1705750656220000856');" onmouseout="out('1705750656220000856');" style="">  47              throw new Exception(&quot;BootstrapServers can not be empty!&quot;);                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  48          } else {                                                                                                  </span>
<span class="2444293089767226128" onmouseenter="enter('2444293089767226128');" onmouseout="out('2444293089767226128');" style="">  49              kafkaSourceTableInfo.setBootstrapServers(bootstrapServer);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  50          }                                                                                                         </span>

<span class="-5656758930033021588" onmouseenter="enter('-5656758930033021588');" onmouseout="out('-5656758930033021588');" style=""><abbr title="  51          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  51          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase(ðŸ”µ</abbr></span>
<span class="7034285388524040854" onmouseenter="enter('7034285388524040854');" onmouseout="out('7034285388524040854');" style=""><abbr title="  52          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  52          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())))ðŸ”µ</abbr></span>
<span class="-5435927246048491177" onmouseenter="enter('-5435927246048491177');" onmouseout="out('-5435927246048491177');" style=""><abbr title="  53          kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  53          kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLoðŸ”µ</abbr></span>
<span class="-1856417297190168609" onmouseenter="enter('-1856417297190168609');" onmouseout="out('-1856417297190168609');" style=""><abbr title="  54          kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  54          kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KðŸ”µ</abbr></span>
<span class="8077300323415965285" onmouseenter="enter('8077300323415965285');" onmouseout="out('8077300323415965285');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  55 +        kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHARSET_NAME_KEY.toLowerCase(),&quot;UTF-8&quot;)));">  55 +        kafkaSourceTableInfo.setCharsetName(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CHARSET_NAMðŸ”µ</abbr></span>

<span class="1997534063297468740" onmouseenter="enter('1997534063297468740');" onmouseout="out('1997534063297468740');" style=""><abbr title="  56          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  56          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCaðŸ”µ</abbr></span>
<span class="3246702865844389046" onmouseenter="enter('3246702865844389046');" onmouseout="out('3246702865844389046');" style="">  57          for (String key : props.keySet()) {                                                                       </span>
<span class="3263124188948623033" onmouseenter="enter('3263124188948623033');" onmouseout="out('3263124188948623033');" style="">  58              if (!key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;)) {                                                     </span>
<span class="5418279252285037506" onmouseenter="enter('5418279252285037506');" onmouseout="out('5418279252285037506');" style="">  59                  kafkaSourceTableInfo.addKafkaParam(key.substring(6), props.get(key).toString());                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  60              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  61          }                                                                                                         </span>












<span class="2124594157128188747" onmouseenter="enter('2124594157128188747');" onmouseout="out('2124594157128188747');" style="">  62          kafkaSourceTableInfo.check();                                                                             </span>

<span class="1830791182698526741" onmouseenter="enter('1830791182698526741');" onmouseout="out('1830791182698526741');" style="">  63          return kafkaSourceTableInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  64      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="-7064734655611069376" onmouseenter="enter('-7064734655611069376');" onmouseout="out('-7064734655611069376');" style="">  20  package com.dtstack.flink.sql.source.kafka.table;                                                                 </span>
<span  style="">  21                                                                                                                    </span>
<span class="7029823032971829565" onmouseenter="enter('7029823032971829565');" onmouseout="out('7029823032971829565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.table.AbsSourceParser;                                                               </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.dtstack.flink.sql.table.TableInfo;                                                                     </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import com.dtstack.flink.sql.format.FormatType;                                                                   </span>
<span class="1858401820470473532" onmouseenter="enter('1858401820470473532');" onmouseout="out('1858401820470473532');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;                                                     </span>
<span class="397918604901287985" onmouseenter="enter('397918604901287985');" onmouseout="out('397918604901287985');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import com.dtstack.flink.sql.table.AbstractSourceParser;                                                          </span>
<span class="-692023547870128618" onmouseenter="enter('-692023547870128618');" onmouseout="out('-692023547870128618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import com.dtstack.flink.sql.table.AbstractTableInfo;                                                             </span>
<span class="-5753193131350624266" onmouseenter="enter('-5753193131350624266');" onmouseout="out('-5753193131350624266');" style="">  28  import com.dtstack.flink.sql.util.MathUtil;                                                                       </span>
<span  style="">  29                                                                                                                    </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  30  import java.util.Map;                                                                                             </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +import java.util.stream.Collectors;                                                                               </span>
<span  style="">  32                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  33  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  34   * Reason:                                                                                                        </span>
<span class="4222025842925612011" onmouseenter="enter('4222025842925612011');" onmouseout="out('4222025842925612011');" style="">  35   * Date: 2018/09/18                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  36   * Company: www.dtstack.com                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  37   *                                                                                                                </span>
<span class="-3971691924018094169" onmouseenter="enter('-3971691924018094169');" onmouseout="out('-3971691924018094169');" style="">  38   * @author sishu.yss                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  39   */                                                                                                               </span>
<span class="9137423138432248425" onmouseenter="enter('9137423138432248425');" onmouseout="out('9137423138432248425');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -public class KafkaSourceParser extends AbsSourceParser {                                                          </span>
<span class="-2502602030432015530" onmouseenter="enter('-2502602030432015530');" onmouseout="out('-2502602030432015530');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +public class KafkaSourceParser extends AbstractSourceParser {                                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  42      @Override                                                                                                     </span>
<span class="-910491477086395452" onmouseenter="enter('-910491477086395452');" onmouseout="out('-910491477086395452');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  43 -    public TableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  43 -    public TableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws ExceptionðŸ”µ</abbr></span>
<span class="3632243130028915065" onmouseenter="enter('3632243130028915065');" onmouseout="out('3632243130028915065');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  44 +    public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  44 +    public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws EðŸ”µ</abbr></span>
<span  style="">  45                                                                                                                    </span>
<span class="-3979680527446739160" onmouseenter="enter('-3979680527446739160');" onmouseout="out('-3979680527446739160');" style="">  46          KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();                                   </span>
<span class="6868994740360842973" onmouseenter="enter('6868994740360842973');" onmouseout="out('6868994740360842973');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +        parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +                                                                                                                  </span>
<span class="-6128440189444499998" onmouseenter="enter('-6128440189444499998');" onmouseout="out('-6128440189444499998');" style="">  49          kafkaSourceTableInfo.setName(tableName);                                                                  </span>
<span class="2019232699127483322" onmouseenter="enter('2019232699127483322');" onmouseout="out('2019232699127483322');" style="">  50          kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase()))); </span>
<span class="6868994740360842973" onmouseenter="enter('6868994740360842973');" onmouseout="out('6868994740360842973');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -        parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -                                                                                                                  </span>
<span class="-2598610944087485625" onmouseenter="enter('-2598610944087485625');" onmouseout="out('-2598610944087485625');" style=""><abbr title="  53          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  53          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.ðŸ”µ</abbr></span>
<span class="6556389195897426667" onmouseenter="enter('6556389195897426667');" onmouseout="out('6556389195897426667');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  54 -        String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase()));">  54 -        String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCasðŸ”µ</abbr></span>
<span class="-6041173648844585113" onmouseenter="enter('-6041173648844585113');" onmouseout="out('-6041173648844585113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -        if (bootstrapServer == null || bootstrapServer.trim().equals(&quot;&quot;)) {                                       </span>
<span class="1705750656220000856" onmouseenter="enter('1705750656220000856');" onmouseout="out('1705750656220000856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -            throw new Exception(&quot;BootstrapServers can not be empty!&quot;);                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -        } else {                                                                                                  </span>
<span class="2444293089767226128" onmouseenter="enter('2444293089767226128');" onmouseout="out('2444293089767226128');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -            kafkaSourceTableInfo.setBootstrapServers(bootstrapServer);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -        }                                                                                                         </span>
<span class="589208455079856491" onmouseenter="enter('589208455079856491');" onmouseout="out('589208455079856491');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  60 +        kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  60 +        kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERðŸ”µ</abbr></span>
<span class="-5656758930033021588" onmouseenter="enter('-5656758930033021588');" onmouseout="out('-5656758930033021588');" style=""><abbr title="  61          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  61          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase(ðŸ”µ</abbr></span>
<span class="7034285388524040854" onmouseenter="enter('7034285388524040854');" onmouseout="out('7034285388524040854');" style=""><abbr title="  62          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  62          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())))ðŸ”µ</abbr></span>
<span class="-5435927246048491177" onmouseenter="enter('-5435927246048491177');" onmouseout="out('-5435927246048491177');" style=""><abbr title="  63          kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  63          kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLoðŸ”µ</abbr></span>
<span class="-1856417297190168609" onmouseenter="enter('-1856417297190168609');" onmouseout="out('-1856417297190168609');" style=""><abbr title="  64          kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  64          kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KðŸ”µ</abbr></span>
<span class="3453681674607214640" onmouseenter="enter('3453681674607214640');" onmouseout="out('3453681674607214640');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  65 +        kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  65 +        kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span class="-351688158129114478" onmouseenter="enter('-351688158129114478');" onmouseout="out('-351688158129114478');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  66 +        kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  66 +        kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KðŸ”µ</abbr></span>
<span class="1997534063297468740" onmouseenter="enter('1997534063297468740');" onmouseout="out('1997534063297468740');" style=""><abbr title="  67          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  67          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCaðŸ”µ</abbr></span>
<span class="3246702865844389046" onmouseenter="enter('3246702865844389046');" onmouseout="out('3246702865844389046');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -        for (String key : props.keySet()) {                                                                       </span>
<span class="3263124188948623033" onmouseenter="enter('3263124188948623033');" onmouseout="out('3263124188948623033');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -            if (!key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;)) {                                                     </span>
<span class="5418279252285037506" onmouseenter="enter('5418279252285037506');" onmouseout="out('5418279252285037506');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -                kafkaSourceTableInfo.addKafkaParam(key.substring(6), props.get(key).toString());                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +                                                                                                                  </span>
<span class="8331248545936659113" onmouseenter="enter('8331248545936659113');" onmouseout="out('8331248545936659113');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  74 +        kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  74 +        kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.tðŸ”µ</abbr></span>
<span class="-4341467090526335917" onmouseenter="enter('-4341467090526335917');" onmouseout="out('-4341467090526335917');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  75 +        kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  75 +        kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELðŸ”µ</abbr></span>
<span class="-728668885073268529" onmouseenter="enter('-728668885073268529');" onmouseout="out('-728668885073268529');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  76 +        kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  76 +        kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  77 +                                                                                                                  </span>
<span class="-920529234545737528" onmouseenter="enter('-920529234545737528');" onmouseout="out('-920529234545737528');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +        Map&lt;String, String&gt; kafkaParams = props.keySet().stream()                                                 </span>
<span class="5789555383205784072" onmouseenter="enter('5789555383205784072');" onmouseout="out('5789555383205784072');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +                .filter(key -&gt; !key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;))                                        </span>
<span class="-7544825204510117185" onmouseenter="enter('-7544825204510117185');" onmouseout="out('-7544825204510117185');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +                .collect(Collectors.toMap(                                                                        </span>
<span class="303964316823078642" onmouseenter="enter('303964316823078642');" onmouseout="out('303964316823078642');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +                        key -&gt; key.substring(6), key -&gt; props.get(key).toString())                                </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +                );                                                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +                                                                                                                  </span>
<span class="6518789662065103019" onmouseenter="enter('6518789662065103019');" onmouseout="out('6518789662065103019');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +        kafkaSourceTableInfo.addKafkaParam(kafkaParams);                                                          </span>
<span class="2124594157128188747" onmouseenter="enter('2124594157128188747');" onmouseout="out('2124594157128188747');" style="">  85          kafkaSourceTableInfo.check();                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +                                                                                                                  </span>
<span class="1830791182698526741" onmouseenter="enter('1830791182698526741');" onmouseout="out('1830791182698526741');" style="">  87          return kafkaSourceTableInfo;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            