<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>29</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    29
                    <a href="28.html">prev</a>
                    <a href="30.html">next</a>
                    <a href="29_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    AriaLyy/Aria_ce886921a652b2ea1ded6e36a0748360e01c007f_Aria/src/main/java/com/arialyy/aria/core/download/DownloadReceiver.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;ce886921a652b2ea1ded6e36a0748360e01c007f:Aria/src/main/java/com/arialyy/aria/core/download/DownloadReceiver.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;ce886921a652b2ea1ded6e36a0748360e01c007f^1:Aria/src/main/java/com/arialyy/aria/core/download/DownloadReceiver.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;ce886921a652b2ea1ded6e36a0748360e01c007f^2:Aria/src/main/java/com/arialyy/aria/core/download/DownloadReceiver.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;84ce7e06974326b39f68f3f23fd64570bcdb9bdc:Aria/src/main/java/com/arialyy/aria/core/download/DownloadReceiver.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2  * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span class="1987357580077471394" onmouseenter="enter('1987357580077471394');" onmouseout="out('1987357580077471394');" style="">  16 package com.arialyy.aria.core.download;                                                                  </span>
<span  style="">  17                                                                                                          </span>
<span class="-2370850629707943459" onmouseenter="enter('-2370850629707943459');" onmouseout="out('-2370850629707943459');" style="">  18 import android.support.annotation.NonNull;                                                               </span>
<span class="3973751924708272716" onmouseenter="enter('3973751924708272716');" onmouseout="out('3973751924708272716');" style="">  19 import com.arialyy.aria.core.AriaManager;                                                                </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  20 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  21 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-477762279452602188" onmouseenter="enter('-477762279452602188');" onmouseout="out('-477762279452602188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  22 import com.arialyy.aria.core.inf.ICmd;                                                                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  23 =======                                                                                                  </span>
<span class="-2122960619967737033" onmouseenter="enter('-2122960619967737033');" onmouseout="out('-2122960619967737033');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  24 import com.arialyy.aria.core.inf.AbsReceiver;                                                            </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  25 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-5016163043314935005" onmouseenter="enter('-5016163043314935005');" onmouseout="out('-5016163043314935005');" style="">  26 import com.arialyy.aria.core.inf.IEntity;                                                                </span>
<span class="-7853945460211298347" onmouseenter="enter('-7853945460211298347');" onmouseout="out('-7853945460211298347');" style="">  27 import com.arialyy.aria.core.inf.IReceiver;                                                              </span>
<span class="-801363442427116995" onmouseenter="enter('-801363442427116995');" onmouseout="out('-801363442427116995');" style="">  28 import com.arialyy.aria.core.command.normal.NormalCmdFactory;                                            </span>
<span class="7326175858930165690" onmouseenter="enter('7326175858930165690');" onmouseout="out('7326175858930165690');" style="">  29 import com.arialyy.aria.core.scheduler.DownloadSchedulers;                                               </span>
<span class="-972246557960033348" onmouseenter="enter('-972246557960033348');" onmouseout="out('-972246557960033348');" style="">  30 import com.arialyy.aria.core.scheduler.ISchedulerListener;                                               </span>
<span class="-4499301116755301031" onmouseenter="enter('-4499301116755301031');" onmouseout="out('-4499301116755301031');" style="">  31 import com.arialyy.aria.orm.DbEntity;                                                                    </span>
<span class="-8921020518339919076" onmouseenter="enter('-8921020518339919076');" onmouseout="out('-8921020518339919076');" style="">  32 import com.arialyy.aria.util.CheckUtil;                                                                  </span>
<span class="-3106139894727218967" onmouseenter="enter('-3106139894727218967');" onmouseout="out('-3106139894727218967');" style="">  33 import com.arialyy.aria.util.CommonUtil;                                                                 </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  34 import java.io.File;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  35 import java.util.List;                                                                                   </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  36 import java.util.Set;                                                                                    </span>
<span  style="">  37                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38 /**                                                                                                      </span>
<span class="-8976164179967820781" onmouseenter="enter('-8976164179967820781');" onmouseout="out('-8976164179967820781');" style="">  39  * Created by lyy on 2016/12/5.                                                                          </span>
<span class="8451370004399326130" onmouseenter="enter('8451370004399326130');" onmouseout="out('8451370004399326130');" style="">  40  * 下载功能接收器                                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  41  */                                                                                                      </span>
<span class="-8738903633205828472" onmouseenter="enter('-8738903633205828472');" onmouseout="out('-8738903633205828472');" style="">  42 public class DownloadReceiver extends AbsReceiver&lt;DownloadEntity&gt; {                                      </span>
<span class="-4144196955255973047" onmouseenter="enter('-4144196955255973047');" onmouseout="out('-4144196955255973047');" style="">  43   private final String TAG = &quot;DownloadReceiver&quot;;                                                         </span>
<span class="8974910660156933255" onmouseenter="enter('8974910660156933255');" onmouseout="out('8974910660156933255');" style="">  44   public ISchedulerListener&lt;DownloadTask&gt; listener;                                                      </span>
<span  style="">  45                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  46   /**                                                                                                    </span>
<span class="-8030592473296514020" onmouseenter="enter('-8030592473296514020');" onmouseout="out('-8030592473296514020');" style="">  47    * 设置最大下载速度，单位：kb                                                                                      </span>
<span class="5818094815562401128" onmouseenter="enter('5818094815562401128');" onmouseout="out('5818094815562401128');" style="">  48    * 该方法为实验性功能，清不要轻易在生产环境中使用。                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  49    *                                                                                                     </span>
<span class="9124526800094534994" onmouseenter="enter('9124526800094534994');" onmouseout="out('9124526800094534994');" style="">  50    * @param maxSpeed 为0表示不限速                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  51    */                                                                                                    </span>
<span class="-7953977331871486849" onmouseenter="enter('-7953977331871486849');" onmouseout="out('-7953977331871486849');" style="">  52   @Deprecated public void setMaxSpeed(double maxSpeed) {                                                 </span>
<span class="7170079538529520301" onmouseenter="enter('7170079538529520301');" onmouseout="out('7170079538529520301');" style="">  53     AriaManager.getInstance(AriaManager.APP).getDownloadConfig().setMsxSpeed(maxSpeed);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  54   }                                                                                                      </span>
<span  style="">  55                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  56   /**                                                                                                    </span>
<span class="3315269434963037496" onmouseenter="enter('3315269434963037496');" onmouseout="out('3315269434963037496');" style="">  57    * {@link #load(String)}，请使用该方法                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  58    */                                                                                                    </span>
<span class="-198951527563532118" onmouseenter="enter('-198951527563532118');" onmouseout="out('-198951527563532118');" style="">  59   @Deprecated public DownloadTarget load(DownloadEntity entity) {                                        </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  60     return new DownloadTarget(entity, targetName);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  61   }                                                                                                      </span>
<span  style="">  62                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  63   /**                                                                                                    </span>
<span class="-7592705859776173848" onmouseenter="enter('-7592705859776173848');" onmouseout="out('-7592705859776173848');" style="">  64    * 加载下载地址                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  65    */                                                                                                    </span>
<span class="5257821212992384848" onmouseenter="enter('5257821212992384848');" onmouseout="out('5257821212992384848');" style="">  66   public DownloadTarget load(@NonNull String downloadUrl) {                                              </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style="">  67     CheckUtil.checkDownloadUrl(downloadUrl);                                                             </span>
<span class="-5265249557182946837" onmouseenter="enter('-5265249557182946837');" onmouseout="out('-5265249557182946837');" style="">  68     DownloadEntity entity =                                                                              </span>
<span class="57873310924392504" onmouseenter="enter('57873310924392504');" onmouseout="out('57873310924392504');" style="">  69         DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                     </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  70     if (entity == null) {                                                                                </span>
<span class="-873561942459071238" onmouseenter="enter('-873561942459071238');" onmouseout="out('-873561942459071238');" style="">  71       entity = new DownloadEntity();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  72     }                                                                                                    </span>
<span class="-8554155214173149752" onmouseenter="enter('-8554155214173149752');" onmouseout="out('-8554155214173149752');" style="">  73     File file = new File(entity.getDownloadPath());                                                      </span>
<span class="4133240422546463755" onmouseenter="enter('4133240422546463755');" onmouseout="out('4133240422546463755');" style="">  74     if (!file.exists()) {                                                                                </span>
<span class="2455718788061552443" onmouseenter="enter('2455718788061552443');" onmouseout="out('2455718788061552443');" style="">  75       entity.setState(IEntity.STATE_WAIT);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76     }                                                                                                    </span>
<span class="8369938699249911811" onmouseenter="enter('8369938699249911811');" onmouseout="out('8369938699249911811');" style="">  77     entity.setDownloadUrl(downloadUrl);                                                                  </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  78     return new DownloadTarget(entity, targetName);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79   }                                                                                                      </span>
<span  style="">  80                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  81   /**                                                                                                    </span>
<span class="2297304325080531827" onmouseenter="enter('2297304325080531827');" onmouseout="out('2297304325080531827');" style="">  82    * 加载下载地址，如果任务组的中的下载地址改变了，则任务从新的一个任务组                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  83    */                                                                                                    </span>
<span class="-3978985407316286854" onmouseenter="enter('-3978985407316286854');" onmouseout="out('-3978985407316286854');" style="">  84   public DownloadGroupTarget load(List&lt;String&gt; urls) {                                                   </span>
<span class="-1456626783606571249" onmouseenter="enter('-1456626783606571249');" onmouseout="out('-1456626783606571249');" style="">  85     CheckUtil.checkDownloadUrls(urls);                                                                   </span>
<span class="4798297140159515182" onmouseenter="enter('4798297140159515182');" onmouseout="out('4798297140159515182');" style="">  86     DownloadGroupEntity entity =                                                                         </span>
<span class="-1893221228860282904" onmouseenter="enter('-1893221228860282904');" onmouseout="out('-1893221228860282904');" style="">  87         DbEntity.findData(DownloadGroupEntity.class, &quot;urlHash=?&quot;, CommonUtil.getMd5Code(urls));          </span>
<span  style="">  88                                                                                                          </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  89     if (entity == null) {                                                                                </span>
<span class="3061966465183528912" onmouseenter="enter('3061966465183528912');" onmouseout="out('3061966465183528912');" style="">  90       entity = new DownloadGroupEntity();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91     }                                                                                                    </span>
<span class="8763312927794318369" onmouseenter="enter('8763312927794318369');" onmouseout="out('8763312927794318369');" style="">  92     return new DownloadGroupTarget(entity, targetName, urls);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93   }                                                                                                      </span>
<span  style="">  94                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  95   /**                                                                                                    </span>
<span class="-2874086798355386198" onmouseenter="enter('-2874086798355386198');" onmouseout="out('-2874086798355386198');" style="">  96    * 将当前类注册到Aria                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  97    */                                                                                                    </span>
<span class="-4925173742984207732" onmouseenter="enter('-4925173742984207732');" onmouseout="out('-4925173742984207732');" style="">  98   public DownloadReceiver register() {                                                                   </span>
<span class="-5670875303591463725" onmouseenter="enter('-5670875303591463725');" onmouseout="out('-5670875303591463725');" style="">  99     DownloadSchedulers.getInstance().register(obj);                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 100     return this;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101   }                                                                                                      </span>
<span  style=""> 102                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 103   /**                                                                                                    </span>
<span class="4811620718788803994" onmouseenter="enter('4811620718788803994');" onmouseout="out('4811620718788803994');" style=""> 104    * 取消注册                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 105    */                                                                                                    </span>
<span class="9104098464026605676" onmouseenter="enter('9104098464026605676');" onmouseout="out('9104098464026605676');" style=""> 106   @Override public void unRegister() {                                                                   </span>
<span class="-4965118218032185711" onmouseenter="enter('-4965118218032185711');" onmouseout="out('-4965118218032185711');" style=""> 107     DownloadSchedulers.getInstance().unRegister(obj);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108   }                                                                                                      </span>
<span  style=""> 109                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 110   /**                                                                                                    </span>
<span class="2908219533119674198" onmouseenter="enter('2908219533119674198');" onmouseout="out('2908219533119674198');" style=""> 111    * 添加调度器回调                                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 112    *                                                                                                     </span>
<span class="6045833037568940004" onmouseenter="enter('6045833037568940004');" onmouseout="out('6045833037568940004');" style=""> 113    * @see #register()                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 114    */                                                                                                    </span>
<span class="7863890290020597777" onmouseenter="enter('7863890290020597777');" onmouseout="out('7863890290020597777');" style=""> 115   @Deprecated public DownloadReceiver addSchedulerListener(                                              </span>
<span class="8359169744604926706" onmouseenter="enter('8359169744604926706');" onmouseout="out('8359169744604926706');" style=""> 116       ISchedulerListener&lt;DownloadTask&gt; listener) {                                                       </span>
<span class="3639523841108672913" onmouseenter="enter('3639523841108672913');" onmouseout="out('3639523841108672913');" style=""> 117     this.listener = listener;                                                                            </span>
<span class="-4329255953607201155" onmouseenter="enter('-4329255953607201155');" onmouseout="out('-4329255953607201155');" style=""> 118     DownloadSchedulers.getInstance().addSchedulerListener(targetName, listener);                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 119     return this;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120   }                                                                                                      </span>
<span  style=""> 121                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 122   /**                                                                                                    </span>
<span class="-1733418996972913610" onmouseenter="enter('-1733418996972913610');" onmouseout="out('-1733418996972913610');" style=""> 123    * 移除回调                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 124    *                                                                                                     </span>
<span class="5995762354354199814" onmouseenter="enter('5995762354354199814');" onmouseout="out('5995762354354199814');" style=""> 125    * @see #unRegister()                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 126    */                                                                                                    </span>
<span class="-2712512022957064783" onmouseenter="enter('-2712512022957064783');" onmouseout="out('-2712512022957064783');" style=""> 127   @Deprecated @Override public void removeSchedulerListener() {                                          </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 128     if (listener != null) {                                                                              </span>
<span class="-8355444973462207128" onmouseenter="enter('-8355444973462207128');" onmouseout="out('-8355444973462207128');" style=""> 129       DownloadSchedulers.getInstance().removeSchedulerListener(targetName, listener);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131   }                                                                                                      </span>
<span  style=""> 132                                                                                                          </span>
<span class="3345695681730814389" onmouseenter="enter('3345695681730814389');" onmouseout="out('3345695681730814389');" style=""> 133   @Override public void destroy() {                                                                      </span>
<span class="-4901128148553670878" onmouseenter="enter('-4901128148553670878');" onmouseout="out('-4901128148553670878');" style=""> 134     targetName = null;                                                                                   </span>
<span class="-4099358687357442786" onmouseenter="enter('-4099358687357442786');" onmouseout="out('-4099358687357442786');" style=""> 135     listener = null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136   }                                                                                                      </span>
<span  style=""> 137                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 138   /**                                                                                                    </span>
<span class="-4855951461764354463" onmouseenter="enter('-4855951461764354463');" onmouseout="out('-4855951461764354463');" style=""> 139    * 通过下载链接获取下载实体                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 140    */                                                                                                    </span>
<span class="6067624311729681660" onmouseenter="enter('6067624311729681660');" onmouseout="out('6067624311729681660');" style=""> 141   public DownloadEntity getDownloadEntity(String downloadUrl) {                                          </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style=""> 142     CheckUtil.checkDownloadUrl(downloadUrl);                                                             </span>
<span class="-4757197890854513070" onmouseenter="enter('-4757197890854513070');" onmouseout="out('-4757197890854513070');" style=""> 143     return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144   }                                                                                                      </span>
<span  style=""> 145                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 146   /**                                                                                                    </span>
<span class="-7888671401854060616" onmouseenter="enter('-7888671401854060616');" onmouseout="out('-7888671401854060616');" style=""> 147    * 下载任务是否存在                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 148    */                                                                                                    </span>
<span class="-1092275811913780416" onmouseenter="enter('-1092275811913780416');" onmouseout="out('-1092275811913780416');" style=""> 149   @Override public boolean taskExists(String downloadUrl) {                                              </span>
<span class="-7371274125067821256" onmouseenter="enter('-7371274125067821256');" onmouseout="out('-7371274125067821256');" style=""> 150     return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl) != null;          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151   }                                                                                                      </span>
<span  style=""> 152                                                                                                          </span>
<span class="-6671982019509624286" onmouseenter="enter('-6671982019509624286');" onmouseout="out('-6671982019509624286');" style=""> 153   @Override public List&lt;DownloadEntity&gt; getTaskList() {                                                  </span>
<span class="-3090597531179212341" onmouseenter="enter('-3090597531179212341');" onmouseout="out('-3090597531179212341');" style=""> 154     return DownloadEntity.findAllData(DownloadEntity.class);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155   }                                                                                                      </span>
<span  style=""> 156                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 157   /**                                                                                                    </span>
<span class="3402822126794432274" onmouseenter="enter('3402822126794432274');" onmouseout="out('3402822126794432274');" style=""> 158    * 停止所有正在下载的任务，并清空等待队列。                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 159    */                                                                                                    </span>
<span class="-8271139132618696861" onmouseenter="enter('-8271139132618696861');" onmouseout="out('-8271139132618696861');" style=""> 160   @Override public void stopAllTask() {                                                                  </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style=""> 161     AriaManager.getInstance(AriaManager.APP)                                                             </span>
<span class="-8662412021557476230" onmouseenter="enter('-8662412021557476230');" onmouseout="out('-8662412021557476230');" style=""> 162         .setCmd(NormalCmdFactory.getInstance()                                                           </span>
<span class="2753526899995092870" onmouseenter="enter('2753526899995092870');" onmouseout="out('2753526899995092870');" style=""> 163             .createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_STOP_ALL))            </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style=""> 164         .exe();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165   }                                                                                                      </span>
<span  style=""> 166                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 167   /**                                                                                                    </span>
<span class="1311517946297423409" onmouseenter="enter('1311517946297423409');" onmouseout="out('1311517946297423409');" style=""> 168    * 恢复所有正在下载的任务                                                                                         </span>
<span class="-4407894673997389754" onmouseenter="enter('-4407894673997389754');" onmouseout="out('-4407894673997389754');" style=""> 169    * 1.如果执行队列没有满，则开始下载任务，直到执行队列满                                                                         </span>
<span class="-525289014070027486" onmouseenter="enter('-525289014070027486');" onmouseout="out('-525289014070027486');" style=""> 170    * 2.如果队列执行队列已经满了，则将所有任务添加到等待队列中                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 171    */                                                                                                    </span>
<span class="2382837737668558844" onmouseenter="enter('2382837737668558844');" onmouseout="out('2382837737668558844');" style=""> 172   public void resumeAllTask() {                                                                          </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style=""> 173     AriaManager.getInstance(AriaManager.APP)                                                             </span>
<span class="-8662412021557476230" onmouseenter="enter('-8662412021557476230');" onmouseout="out('-8662412021557476230');" style=""> 174         .setCmd(NormalCmdFactory.getInstance()                                                           </span>
<span class="-6359175430758334480" onmouseenter="enter('-6359175430758334480');" onmouseout="out('-6359175430758334480');" style=""> 175             .createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_RESUME_ALL))          </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style=""> 176         .exe();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177   }                                                                                                      </span>
<span  style=""> 178                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 179   /**                                                                                                    </span>
<span class="-7338390600186437821" onmouseenter="enter('-7338390600186437821');" onmouseout="out('-7338390600186437821');" style=""> 180    * 删除所有任务                                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 181    *                                                                                                     </span>
<span class="-325804075342723783" onmouseenter="enter('-325804075342723783');" onmouseout="out('-325804075342723783');" style=""> 182    * @param removeFile {@code true} 删除已经下载完成的任务，不仅删除下载记录，还会删除已经下载完成的文件，{@code false}                     </span>
<span class="-4045013558095481687" onmouseenter="enter('-4045013558095481687');" onmouseout="out('-4045013558095481687');" style=""> 183    * 如果文件已经下载完成，只删除下载记录                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 184    */                                                                                                    </span>
<span class="5963878394412937684" onmouseenter="enter('5963878394412937684');" onmouseout="out('5963878394412937684');" style=""> 185   @Override public void removeAllTask(boolean removeFile) {                                              </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style=""> 186     final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                            </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style=""> 187     AriaManager.getInstance(AriaManager.APP)                                                             </span>
<span class="-4817605631113220698" onmouseenter="enter('-4817605631113220698');" onmouseout="out('-4817605631113220698');" style=""> 188         .setCmd(CommonUtil.createCmd(targetName, new DownloadTaskEntity(),                               </span>
<span class="-5697611243738789926" onmouseenter="enter('-5697611243738789926');" onmouseout="out('-5697611243738789926');" style=""> 189             NormalCmdFactory.TASK_CANCEL_ALL))                                                           </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style=""> 190         .exe();                                                                                          </span>
<span  style=""> 191                                                                                                          </span>
<span class="6170682864485863774" onmouseenter="enter('6170682864485863774');" onmouseout="out('6170682864485863774');" style=""> 192     Set&lt;String&gt; keys = ariaManager.getReceiver().keySet();                                               </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 193     for (String key : keys) {                                                                            </span>
<span class="-467225363893902060" onmouseenter="enter('-467225363893902060');" onmouseout="out('-467225363893902060');" style=""> 194       IReceiver receiver = ariaManager.getReceiver().get(key);                                           </span>
<span class="3799717368039523564" onmouseenter="enter('3799717368039523564');" onmouseout="out('3799717368039523564');" style=""> 195       receiver.removeSchedulerListener();                                                                </span>
<span class="5986307215158803793" onmouseenter="enter('5986307215158803793');" onmouseout="out('5986307215158803793');" style=""> 196       receiver.unRegister();                                                                             </span>
<span class="-4261055600814182440" onmouseenter="enter('-4261055600814182440');" onmouseout="out('-4261055600814182440');" style=""> 197       ariaManager.getReceiver().remove(key);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199   }                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2  * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span class="1987357580077471394" onmouseenter="enter('1987357580077471394');" onmouseout="out('1987357580077471394');" style="">  16 package com.arialyy.aria.core.download;                                                                  </span>
<span  style="">  17                                                                                                          </span>
<span class="-2370850629707943459" onmouseenter="enter('-2370850629707943459');" onmouseout="out('-2370850629707943459');" style="">  18 import android.support.annotation.NonNull;                                                               </span>
<span class="3973751924708272716" onmouseenter="enter('3973751924708272716');" onmouseout="out('3973751924708272716');" style="">  19 import com.arialyy.aria.core.AriaManager;                                                                </span>
<span class="-2122960619967737033" onmouseenter="enter('-2122960619967737033');" onmouseout="out('-2122960619967737033');" style="">  20 import com.arialyy.aria.core.inf.AbsReceiver;                                                            </span>
<span class="-5016163043314935005" onmouseenter="enter('-5016163043314935005');" onmouseout="out('-5016163043314935005');" style="">  21 import com.arialyy.aria.core.inf.IEntity;                                                                </span>
<span class="-7853945460211298347" onmouseenter="enter('-7853945460211298347');" onmouseout="out('-7853945460211298347');" style="">  22 import com.arialyy.aria.core.inf.IReceiver;                                                              </span>
<span class="-801363442427116995" onmouseenter="enter('-801363442427116995');" onmouseout="out('-801363442427116995');" style="">  23 import com.arialyy.aria.core.command.normal.NormalCmdFactory;                                            </span>
<span class="7326175858930165690" onmouseenter="enter('7326175858930165690');" onmouseout="out('7326175858930165690');" style="">  24 import com.arialyy.aria.core.scheduler.DownloadSchedulers;                                               </span>
<span class="-972246557960033348" onmouseenter="enter('-972246557960033348');" onmouseout="out('-972246557960033348');" style="">  25 import com.arialyy.aria.core.scheduler.ISchedulerListener;                                               </span>
<span class="-4499301116755301031" onmouseenter="enter('-4499301116755301031');" onmouseout="out('-4499301116755301031');" style="">  26 import com.arialyy.aria.orm.DbEntity;                                                                    </span>
<span class="-8921020518339919076" onmouseenter="enter('-8921020518339919076');" onmouseout="out('-8921020518339919076');" style="">  27 import com.arialyy.aria.util.CheckUtil;                                                                  </span>
<span class="-3106139894727218967" onmouseenter="enter('-3106139894727218967');" onmouseout="out('-3106139894727218967');" style="">  28 import com.arialyy.aria.util.CommonUtil;                                                                 </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  29 import java.io.File;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  30 import java.util.List;                                                                                   </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  31 import java.util.Set;                                                                                    </span>
<span  style="">  32                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  33 /**                                                                                                      </span>
<span class="-8976164179967820781" onmouseenter="enter('-8976164179967820781');" onmouseout="out('-8976164179967820781');" style="">  34  * Created by lyy on 2016/12/5.                                                                          </span>
<span class="8451370004399326130" onmouseenter="enter('8451370004399326130');" onmouseout="out('8451370004399326130');" style="">  35  * 下载功能接收器                                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  36  */                                                                                                      </span>
<span class="-8738903633205828472" onmouseenter="enter('-8738903633205828472');" onmouseout="out('-8738903633205828472');" style="">  37 public class DownloadReceiver extends AbsReceiver&lt;DownloadEntity&gt; {                                      </span>
<span class="-4144196955255973047" onmouseenter="enter('-4144196955255973047');" onmouseout="out('-4144196955255973047');" style="">  38   private final String TAG = &quot;DownloadReceiver&quot;;                                                         </span>
<span class="8974910660156933255" onmouseenter="enter('8974910660156933255');" onmouseout="out('8974910660156933255');" style="">  39   public ISchedulerListener&lt;DownloadTask&gt; listener;                                                      </span>
<span  style="">  40                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  41   /**                                                                                                    </span>
<span class="-8030592473296514020" onmouseenter="enter('-8030592473296514020');" onmouseout="out('-8030592473296514020');" style="">  42    * 设置最大下载速度，单位：kb                                                                                      </span>
<span class="5818094815562401128" onmouseenter="enter('5818094815562401128');" onmouseout="out('5818094815562401128');" style="">  43    * 该方法为实验性功能，清不要轻易在生产环境中使用。                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  44    *                                                                                                     </span>
<span class="9124526800094534994" onmouseenter="enter('9124526800094534994');" onmouseout="out('9124526800094534994');" style="">  45    * @param maxSpeed 为0表示不限速                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  46    */                                                                                                    </span>
<span class="-7953977331871486849" onmouseenter="enter('-7953977331871486849');" onmouseout="out('-7953977331871486849');" style="">  47   @Deprecated public void setMaxSpeed(double maxSpeed) {                                                 </span>
<span class="7170079538529520301" onmouseenter="enter('7170079538529520301');" onmouseout="out('7170079538529520301');" style="">  48     AriaManager.getInstance(AriaManager.APP).getDownloadConfig().setMsxSpeed(maxSpeed);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  49   }                                                                                                      </span>
<span  style="">  50                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  51   /**                                                                                                    </span>
<span class="3315269434963037496" onmouseenter="enter('3315269434963037496');" onmouseout="out('3315269434963037496');" style="">  52    * {@link #load(String)}，请使用该方法                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  53    */                                                                                                    </span>
<span class="-198951527563532118" onmouseenter="enter('-198951527563532118');" onmouseout="out('-198951527563532118');" style="">  54   @Deprecated public DownloadTarget load(DownloadEntity entity) {                                        </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  55     return new DownloadTarget(entity, targetName);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  56   }                                                                                                      </span>
<span  style="">  57                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  58   /**                                                                                                    </span>
<span class="-7592705859776173848" onmouseenter="enter('-7592705859776173848');" onmouseout="out('-7592705859776173848');" style="">  59    * 加载下载地址                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  60    */                                                                                                    </span>
<span class="5257821212992384848" onmouseenter="enter('5257821212992384848');" onmouseout="out('5257821212992384848');" style="">  61   public DownloadTarget load(@NonNull String downloadUrl) {                                              </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style="">  62     CheckUtil.checkDownloadUrl(downloadUrl);                                                             </span>
<span class="-5265249557182946837" onmouseenter="enter('-5265249557182946837');" onmouseout="out('-5265249557182946837');" style="">  63     DownloadEntity entity =                                                                              </span>
<span class="57873310924392504" onmouseenter="enter('57873310924392504');" onmouseout="out('57873310924392504');" style="">  64         DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                     </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  65     if (entity == null) {                                                                                </span>
<span class="-873561942459071238" onmouseenter="enter('-873561942459071238');" onmouseout="out('-873561942459071238');" style="">  66       entity = new DownloadEntity();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67     }                                                                                                    </span>
<span class="-8554155214173149752" onmouseenter="enter('-8554155214173149752');" onmouseout="out('-8554155214173149752');" style="">  68     File file = new File(entity.getDownloadPath());                                                      </span>
<span class="4133240422546463755" onmouseenter="enter('4133240422546463755');" onmouseout="out('4133240422546463755');" style="">  69     if (!file.exists()) {                                                                                </span>
<span class="2455718788061552443" onmouseenter="enter('2455718788061552443');" onmouseout="out('2455718788061552443');" style="">  70       entity.setState(IEntity.STATE_WAIT);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71     }                                                                                                    </span>
<span class="8369938699249911811" onmouseenter="enter('8369938699249911811');" onmouseout="out('8369938699249911811');" style="">  72     entity.setDownloadUrl(downloadUrl);                                                                  </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  73     return new DownloadTarget(entity, targetName);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74   }                                                                                                      </span>
<span  style="">  75                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  76   /**                                                                                                    </span>
<span class="2297304325080531827" onmouseenter="enter('2297304325080531827');" onmouseout="out('2297304325080531827');" style="">  77    * 加载下载地址，如果任务组的中的下载地址改变了，则任务从新的一个任务组                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  78    */                                                                                                    </span>
<span class="-3978985407316286854" onmouseenter="enter('-3978985407316286854');" onmouseout="out('-3978985407316286854');" style="">  79   public DownloadGroupTarget load(List&lt;String&gt; urls) {                                                   </span>
<span class="-1456626783606571249" onmouseenter="enter('-1456626783606571249');" onmouseout="out('-1456626783606571249');" style="">  80     CheckUtil.checkDownloadUrls(urls);                                                                   </span>
<span class="4798297140159515182" onmouseenter="enter('4798297140159515182');" onmouseout="out('4798297140159515182');" style="">  81     DownloadGroupEntity entity =                                                                         </span>
<span class="-1893221228860282904" onmouseenter="enter('-1893221228860282904');" onmouseout="out('-1893221228860282904');" style="">  82         DbEntity.findData(DownloadGroupEntity.class, &quot;urlHash=?&quot;, CommonUtil.getMd5Code(urls));          </span>
<span  style="">  83                                                                                                          </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  84     if (entity == null) {                                                                                </span>
<span class="3061966465183528912" onmouseenter="enter('3061966465183528912');" onmouseout="out('3061966465183528912');" style="">  85       entity = new DownloadGroupEntity();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86     }                                                                                                    </span>
<span class="8763312927794318369" onmouseenter="enter('8763312927794318369');" onmouseout="out('8763312927794318369');" style="">  87     return new DownloadGroupTarget(entity, targetName, urls);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88   }                                                                                                      </span>
<span  style="">  89                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  90   /**                                                                                                    </span>
<span class="-2874086798355386198" onmouseenter="enter('-2874086798355386198');" onmouseout="out('-2874086798355386198');" style="">  91    * 将当前类注册到Aria                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  92    */                                                                                                    </span>
<span class="-4925173742984207732" onmouseenter="enter('-4925173742984207732');" onmouseout="out('-4925173742984207732');" style="">  93   public DownloadReceiver register() {                                                                   </span>
<span class="-5670875303591463725" onmouseenter="enter('-5670875303591463725');" onmouseout="out('-5670875303591463725');" style="">  94     DownloadSchedulers.getInstance().register(obj);                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">  95     return this;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96   }                                                                                                      </span>
<span  style="">  97                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  98   /**                                                                                                    </span>
<span class="4811620718788803994" onmouseenter="enter('4811620718788803994');" onmouseout="out('4811620718788803994');" style="">  99    * 取消注册                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 100    */                                                                                                    </span>
<span class="9104098464026605676" onmouseenter="enter('9104098464026605676');" onmouseout="out('9104098464026605676');" style=""> 101   @Override public void unRegister() {                                                                   </span>
<span class="-4965118218032185711" onmouseenter="enter('-4965118218032185711');" onmouseout="out('-4965118218032185711');" style=""> 102     DownloadSchedulers.getInstance().unRegister(obj);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103   }                                                                                                      </span>
<span  style=""> 104                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 105   /**                                                                                                    </span>
<span class="2908219533119674198" onmouseenter="enter('2908219533119674198');" onmouseout="out('2908219533119674198');" style=""> 106    * 添加调度器回调                                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 107    *                                                                                                     </span>
<span class="6045833037568940004" onmouseenter="enter('6045833037568940004');" onmouseout="out('6045833037568940004');" style=""> 108    * @see #register()                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 109    */                                                                                                    </span>
<span class="7863890290020597777" onmouseenter="enter('7863890290020597777');" onmouseout="out('7863890290020597777');" style=""> 110   @Deprecated public DownloadReceiver addSchedulerListener(                                              </span>
<span class="8359169744604926706" onmouseenter="enter('8359169744604926706');" onmouseout="out('8359169744604926706');" style=""> 111       ISchedulerListener&lt;DownloadTask&gt; listener) {                                                       </span>
<span class="3639523841108672913" onmouseenter="enter('3639523841108672913');" onmouseout="out('3639523841108672913');" style=""> 112     this.listener = listener;                                                                            </span>
<span class="-4329255953607201155" onmouseenter="enter('-4329255953607201155');" onmouseout="out('-4329255953607201155');" style=""> 113     DownloadSchedulers.getInstance().addSchedulerListener(targetName, listener);                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 114     return this;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115   }                                                                                                      </span>
<span  style=""> 116                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 117   /**                                                                                                    </span>
<span class="-1733418996972913610" onmouseenter="enter('-1733418996972913610');" onmouseout="out('-1733418996972913610');" style=""> 118    * 移除回调                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 119    *                                                                                                     </span>
<span class="5995762354354199814" onmouseenter="enter('5995762354354199814');" onmouseout="out('5995762354354199814');" style=""> 120    * @see #unRegister()                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 121    */                                                                                                    </span>
<span class="-2712512022957064783" onmouseenter="enter('-2712512022957064783');" onmouseout="out('-2712512022957064783');" style=""> 122   @Deprecated @Override public void removeSchedulerListener() {                                          </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 123     if (listener != null) {                                                                              </span>
<span class="-8355444973462207128" onmouseenter="enter('-8355444973462207128');" onmouseout="out('-8355444973462207128');" style=""> 124       DownloadSchedulers.getInstance().removeSchedulerListener(targetName, listener);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126   }                                                                                                      </span>
<span  style=""> 127                                                                                                          </span>
<span class="3345695681730814389" onmouseenter="enter('3345695681730814389');" onmouseout="out('3345695681730814389');" style=""> 128   @Override public void destroy() {                                                                      </span>
<span class="-4901128148553670878" onmouseenter="enter('-4901128148553670878');" onmouseout="out('-4901128148553670878');" style=""> 129     targetName = null;                                                                                   </span>
<span class="-4099358687357442786" onmouseenter="enter('-4099358687357442786');" onmouseout="out('-4099358687357442786');" style=""> 130     listener = null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131   }                                                                                                      </span>
<span  style=""> 132                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 133   /**                                                                                                    </span>
<span class="-4855951461764354463" onmouseenter="enter('-4855951461764354463');" onmouseout="out('-4855951461764354463');" style=""> 134    * 通过下载链接获取下载实体                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 135    */                                                                                                    </span>
<span class="6067624311729681660" onmouseenter="enter('6067624311729681660');" onmouseout="out('6067624311729681660');" style=""> 136   public DownloadEntity getDownloadEntity(String downloadUrl) {                                          </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style=""> 137     CheckUtil.checkDownloadUrl(downloadUrl);                                                             </span>
<span class="-4757197890854513070" onmouseenter="enter('-4757197890854513070');" onmouseout="out('-4757197890854513070');" style=""> 138     return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139   }                                                                                                      </span>
<span  style=""> 140                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 141   /**                                                                                                    </span>
<span class="-7888671401854060616" onmouseenter="enter('-7888671401854060616');" onmouseout="out('-7888671401854060616');" style=""> 142    * 下载任务是否存在                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 143    */                                                                                                    </span>
<span class="-1092275811913780416" onmouseenter="enter('-1092275811913780416');" onmouseout="out('-1092275811913780416');" style=""> 144   @Override public boolean taskExists(String downloadUrl) {                                              </span>
<span class="-7371274125067821256" onmouseenter="enter('-7371274125067821256');" onmouseout="out('-7371274125067821256');" style=""> 145     return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl) != null;          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146   }                                                                                                      </span>
<span  style=""> 147                                                                                                          </span>
<span class="-6671982019509624286" onmouseenter="enter('-6671982019509624286');" onmouseout="out('-6671982019509624286');" style=""> 148   @Override public List&lt;DownloadEntity&gt; getTaskList() {                                                  </span>
<span class="-3090597531179212341" onmouseenter="enter('-3090597531179212341');" onmouseout="out('-3090597531179212341');" style=""> 149     return DownloadEntity.findAllData(DownloadEntity.class);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150   }                                                                                                      </span>
<span  style=""> 151                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 152   /**                                                                                                    </span>
<span class="3402822126794432274" onmouseenter="enter('3402822126794432274');" onmouseout="out('3402822126794432274');" style=""> 153    * 停止所有正在下载的任务，并清空等待队列。                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 154    */                                                                                                    </span>
<span class="-8271139132618696861" onmouseenter="enter('-8271139132618696861');" onmouseout="out('-8271139132618696861');" style=""> 155   @Override public void stopAllTask() {                                                                  </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style=""> 156     AriaManager.getInstance(AriaManager.APP)                                                             </span>
<span class="-8662412021557476230" onmouseenter="enter('-8662412021557476230');" onmouseout="out('-8662412021557476230');" style=""> 157         .setCmd(NormalCmdFactory.getInstance()                                                           </span>
<span class="2753526899995092870" onmouseenter="enter('2753526899995092870');" onmouseout="out('2753526899995092870');" style=""> 158             .createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_STOP_ALL))            </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style=""> 159         .exe();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160   }                                                                                                      </span>
<span  style=""> 161                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 162   /**                                                                                                    </span>
<span class="1311517946297423409" onmouseenter="enter('1311517946297423409');" onmouseout="out('1311517946297423409');" style=""> 163    * 恢复所有正在下载的任务                                                                                         </span>
<span class="-4407894673997389754" onmouseenter="enter('-4407894673997389754');" onmouseout="out('-4407894673997389754');" style=""> 164    * 1.如果执行队列没有满，则开始下载任务，直到执行队列满                                                                         </span>
<span class="-525289014070027486" onmouseenter="enter('-525289014070027486');" onmouseout="out('-525289014070027486');" style=""> 165    * 2.如果队列执行队列已经满了，则将所有任务添加到等待队列中                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 166    */                                                                                                    </span>
<span class="2382837737668558844" onmouseenter="enter('2382837737668558844');" onmouseout="out('2382837737668558844');" style=""> 167   public void resumeAllTask() {                                                                          </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style=""> 168     AriaManager.getInstance(AriaManager.APP)                                                             </span>
<span class="-8662412021557476230" onmouseenter="enter('-8662412021557476230');" onmouseout="out('-8662412021557476230');" style=""> 169         .setCmd(NormalCmdFactory.getInstance()                                                           </span>
<span class="-6359175430758334480" onmouseenter="enter('-6359175430758334480');" onmouseout="out('-6359175430758334480');" style=""> 170             .createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_RESUME_ALL))          </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style=""> 171         .exe();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172   }                                                                                                      </span>
<span  style=""> 173                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 174   /**                                                                                                    </span>
<span class="-7338390600186437821" onmouseenter="enter('-7338390600186437821');" onmouseout="out('-7338390600186437821');" style=""> 175    * 删除所有任务                                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 176    *                                                                                                     </span>
<span class="-325804075342723783" onmouseenter="enter('-325804075342723783');" onmouseout="out('-325804075342723783');" style=""> 177    * @param removeFile {@code true} 删除已经下载完成的任务，不仅删除下载记录，还会删除已经下载完成的文件，{@code false}                     </span>
<span class="-4045013558095481687" onmouseenter="enter('-4045013558095481687');" onmouseout="out('-4045013558095481687');" style=""> 178    * 如果文件已经下载完成，只删除下载记录                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 179    */                                                                                                    </span>
<span class="5963878394412937684" onmouseenter="enter('5963878394412937684');" onmouseout="out('5963878394412937684');" style=""> 180   @Override public void removeAllTask(boolean removeFile) {                                              </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style=""> 181     final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                            </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style=""> 182     AriaManager.getInstance(AriaManager.APP)                                                             </span>
<span class="-4817605631113220698" onmouseenter="enter('-4817605631113220698');" onmouseout="out('-4817605631113220698');" style=""> 183         .setCmd(CommonUtil.createCmd(targetName, new DownloadTaskEntity(),                               </span>
<span class="-5697611243738789926" onmouseenter="enter('-5697611243738789926');" onmouseout="out('-5697611243738789926');" style=""> 184             NormalCmdFactory.TASK_CANCEL_ALL))                                                           </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style=""> 185         .exe();                                                                                          </span>
<span  style=""> 186                                                                                                          </span>
<span class="6170682864485863774" onmouseenter="enter('6170682864485863774');" onmouseout="out('6170682864485863774');" style=""> 187     Set&lt;String&gt; keys = ariaManager.getReceiver().keySet();                                               </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 188     for (String key : keys) {                                                                            </span>
<span class="-467225363893902060" onmouseenter="enter('-467225363893902060');" onmouseout="out('-467225363893902060');" style=""> 189       IReceiver receiver = ariaManager.getReceiver().get(key);                                           </span>
<span class="3799717368039523564" onmouseenter="enter('3799717368039523564');" onmouseout="out('3799717368039523564');" style=""> 190       receiver.removeSchedulerListener();                                                                </span>
<span class="5986307215158803793" onmouseenter="enter('5986307215158803793');" onmouseout="out('5986307215158803793');" style=""> 191       receiver.unRegister();                                                                             </span>
<span class="-4261055600814182440" onmouseenter="enter('-4261055600814182440');" onmouseout="out('-4261055600814182440');" style=""> 192       ariaManager.getReceiver().remove(key);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194   }                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195 }                                                                                                        </span>



</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2  * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span class="1987357580077471394" onmouseenter="enter('1987357580077471394');" onmouseout="out('1987357580077471394');" style="">  16 package com.arialyy.aria.core.download;                                                                  </span>
<span  style="">  17                                                                                                          </span>
<span class="-2370850629707943459" onmouseenter="enter('-2370850629707943459');" onmouseout="out('-2370850629707943459');" style="">  18 import android.support.annotation.NonNull;                                                               </span>
<span class="3973751924708272716" onmouseenter="enter('3973751924708272716');" onmouseout="out('3973751924708272716');" style="">  19 import com.arialyy.aria.core.AriaManager;                                                                </span>
<span class="-801363442427116995" onmouseenter="enter('-801363442427116995');" onmouseout="out('-801363442427116995');" style="">  20 import com.arialyy.aria.core.command.normal.NormalCmdFactory;                                            </span>
<span class="-2122960619967737033" onmouseenter="enter('-2122960619967737033');" onmouseout="out('-2122960619967737033');" style="">  21 import com.arialyy.aria.core.inf.AbsReceiver;                                                            </span>
<span class="-5016163043314935005" onmouseenter="enter('-5016163043314935005');" onmouseout="out('-5016163043314935005');" style="">  22 import com.arialyy.aria.core.inf.IEntity;                                                                </span>
<span class="-7853945460211298347" onmouseenter="enter('-7853945460211298347');" onmouseout="out('-7853945460211298347');" style="">  23 import com.arialyy.aria.core.inf.IReceiver;                                                              </span>
<span class="7326175858930165690" onmouseenter="enter('7326175858930165690');" onmouseout="out('7326175858930165690');" style="">  24 import com.arialyy.aria.core.scheduler.DownloadSchedulers;                                               </span>
<span class="-972246557960033348" onmouseenter="enter('-972246557960033348');" onmouseout="out('-972246557960033348');" style="">  25 import com.arialyy.aria.core.scheduler.ISchedulerListener;                                               </span>
<span class="-4499301116755301031" onmouseenter="enter('-4499301116755301031');" onmouseout="out('-4499301116755301031');" style="">  26 import com.arialyy.aria.orm.DbEntity;                                                                    </span>
<span class="-8921020518339919076" onmouseenter="enter('-8921020518339919076');" onmouseout="out('-8921020518339919076');" style="">  27 import com.arialyy.aria.util.CheckUtil;                                                                  </span>
<span class="-3106139894727218967" onmouseenter="enter('-3106139894727218967');" onmouseout="out('-3106139894727218967');" style="">  28 import com.arialyy.aria.util.CommonUtil;                                                                 </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  29 import java.io.File;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  30 import java.util.List;                                                                                   </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  31 import java.util.Set;                                                                                    </span>
<span  style="">  32                                                                                                          </span>
<span  style="">  33                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  34 /**                                                                                                      </span>
<span class="-8976164179967820781" onmouseenter="enter('-8976164179967820781');" onmouseout="out('-8976164179967820781');" style="">  35  * Created by lyy on 2016/12/5.                                                                          </span>
<span class="8451370004399326130" onmouseenter="enter('8451370004399326130');" onmouseout="out('8451370004399326130');" style="">  36  * 下载功能接收器                                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  37  */                                                                                                      </span>
<span class="-8738903633205828472" onmouseenter="enter('-8738903633205828472');" onmouseout="out('-8738903633205828472');" style="">  38 public class DownloadReceiver extends AbsReceiver&lt;DownloadEntity&gt; {                                      </span>
<span class="-4144196955255973047" onmouseenter="enter('-4144196955255973047');" onmouseout="out('-4144196955255973047');" style="">  39   private final String TAG = &quot;DownloadReceiver&quot;;                                                         </span>
<span  style="">  40                                                                                                          </span>
<span class="8974910660156933255" onmouseenter="enter('8974910660156933255');" onmouseout="out('8974910660156933255');" style="">  41   public ISchedulerListener&lt;DownloadTask&gt; listener;                                                      </span>
<span  style="">  42                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  43   /**                                                                                                    </span>
<span class="-8030592473296514020" onmouseenter="enter('-8030592473296514020');" onmouseout="out('-8030592473296514020');" style="">  44    * 设置最大下载速度，单位：kb                                                                                      </span>
<span class="5818094815562401128" onmouseenter="enter('5818094815562401128');" onmouseout="out('5818094815562401128');" style="">  45    * 该方法为实验性功能，清不要轻易在生产环境中使用。                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  46    *                                                                                                     </span>
<span class="9124526800094534994" onmouseenter="enter('9124526800094534994');" onmouseout="out('9124526800094534994');" style="">  47    * @param maxSpeed 为0表示不限速                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  48    */                                                                                                    </span>
<span class="-7953977331871486849" onmouseenter="enter('-7953977331871486849');" onmouseout="out('-7953977331871486849');" style="">  49   @Deprecated public void setMaxSpeed(double maxSpeed) {                                                 </span>
<span class="7170079538529520301" onmouseenter="enter('7170079538529520301');" onmouseout="out('7170079538529520301');" style="">  50     AriaManager.getInstance(AriaManager.APP).getDownloadConfig().setMsxSpeed(maxSpeed);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  51   }                                                                                                      </span>
<span  style="">  52                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  53   /**                                                                                                    </span>
<span class="3315269434963037496" onmouseenter="enter('3315269434963037496');" onmouseout="out('3315269434963037496');" style="">  54    * {@link #load(String)}，请使用该方法                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  55    */                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="">  56   @Deprecated                                                                                            </span>
<span class="5466262800524521213" onmouseenter="enter('5466262800524521213');" onmouseout="out('5466262800524521213');" style="">  57   public DownloadTarget load(DownloadEntity entity) {                                                    </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  58     return new DownloadTarget(entity, targetName);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  59   }                                                                                                      </span>
<span  style="">  60                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  61   /**                                                                                                    </span>
<span class="-7592705859776173848" onmouseenter="enter('-7592705859776173848');" onmouseout="out('-7592705859776173848');" style="">  62    * 加载下载地址                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63    */                                                                                                    </span>
<span class="4648348523170975147" onmouseenter="enter('4648348523170975147');" onmouseout="out('4648348523170975147');" style="">  64   public DownloadTarget load(@NonNull                                                                    </span>
<span class="7669369098894497310" onmouseenter="enter('7669369098894497310');" onmouseout="out('7669369098894497310');" style="">  65   String downloadUrl) {                                                                                  </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style="">  66     CheckUtil.checkDownloadUrl(downloadUrl);                                                             </span>
<span class="3055451008209389064" onmouseenter="enter('3055451008209389064');" onmouseout="out('3055451008209389064');" style="">  67     DownloadEntity entity = DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl); </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  68     if (entity == null) {                                                                                </span>
<span class="-873561942459071238" onmouseenter="enter('-873561942459071238');" onmouseout="out('-873561942459071238');" style="">  69       entity = new DownloadEntity();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70     }                                                                                                    </span>
<span class="-8554155214173149752" onmouseenter="enter('-8554155214173149752');" onmouseout="out('-8554155214173149752');" style="">  71     File file = new File(entity.getDownloadPath());                                                      </span>
<span class="4133240422546463755" onmouseenter="enter('4133240422546463755');" onmouseout="out('4133240422546463755');" style="">  72     if (!file.exists()) {                                                                                </span>
<span class="2455718788061552443" onmouseenter="enter('2455718788061552443');" onmouseout="out('2455718788061552443');" style="">  73       entity.setState(IEntity.STATE_WAIT);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span class="8369938699249911811" onmouseenter="enter('8369938699249911811');" onmouseout="out('8369938699249911811');" style="">  75     entity.setDownloadUrl(downloadUrl);                                                                  </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  76     return new DownloadTarget(entity, targetName);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77   }                                                                                                      </span>
<span  style="">  78                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  79   /**                                                                                                    </span>
<span class="2297304325080531827" onmouseenter="enter('2297304325080531827');" onmouseout="out('2297304325080531827');" style="">  80    * 加载下载地址，如果任务组的中的下载地址改变了，则任务从新的一个任务组                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  81    */                                                                                                    </span>
<span class="-3978985407316286854" onmouseenter="enter('-3978985407316286854');" onmouseout="out('-3978985407316286854');" style="">  82   public DownloadGroupTarget load(List&lt;String&gt; urls) {                                                   </span>
<span class="-1456626783606571249" onmouseenter="enter('-1456626783606571249');" onmouseout="out('-1456626783606571249');" style="">  83     CheckUtil.checkDownloadUrls(urls);                                                                   </span>
<span class="4798297140159515182" onmouseenter="enter('4798297140159515182');" onmouseout="out('4798297140159515182');" style="">  84     DownloadGroupEntity entity =                                                                         </span>
<span class="-1893221228860282904" onmouseenter="enter('-1893221228860282904');" onmouseout="out('-1893221228860282904');" style="">  85         DbEntity.findData(DownloadGroupEntity.class, &quot;urlHash=?&quot;, CommonUtil.getMd5Code(urls));          </span>
<span  style="">  86                                                                                                          </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  87     if (entity == null) {                                                                                </span>
<span class="3061966465183528912" onmouseenter="enter('3061966465183528912');" onmouseout="out('3061966465183528912');" style="">  88       entity = new DownloadGroupEntity();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89     }                                                                                                    </span>
<span class="8763312927794318369" onmouseenter="enter('8763312927794318369');" onmouseout="out('8763312927794318369');" style="">  90     return new DownloadGroupTarget(entity, targetName, urls);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91   }                                                                                                      </span>
<span  style="">  92                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  93   /**                                                                                                    </span>
<span class="-2874086798355386198" onmouseenter="enter('-2874086798355386198');" onmouseout="out('-2874086798355386198');" style="">  94    * 将当前类注册到Aria                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  95    */                                                                                                    </span>
<span class="-4925173742984207732" onmouseenter="enter('-4925173742984207732');" onmouseout="out('-4925173742984207732');" style="">  96   public DownloadReceiver register() {                                                                   </span>
<span class="-5670875303591463725" onmouseenter="enter('-5670875303591463725');" onmouseout="out('-5670875303591463725');" style="">  97     DownloadSchedulers.getInstance().register(obj);                                                      </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">  98     return this;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99   }                                                                                                      </span>
<span  style=""> 100                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 101   /**                                                                                                    </span>
<span class="4811620718788803994" onmouseenter="enter('4811620718788803994');" onmouseout="out('4811620718788803994');" style=""> 102    * 取消注册                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 103    */                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 104   @Override                                                                                              </span>
<span class="-4986667513617837645" onmouseenter="enter('-4986667513617837645');" onmouseout="out('-4986667513617837645');" style=""> 105   public void unRegister() {                                                                             </span>
<span class="-4965118218032185711" onmouseenter="enter('-4965118218032185711');" onmouseout="out('-4965118218032185711');" style=""> 106     DownloadSchedulers.getInstance().unRegister(obj);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107   }                                                                                                      </span>
<span  style=""> 108                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 109   /**                                                                                                    </span>
<span class="2908219533119674198" onmouseenter="enter('2908219533119674198');" onmouseout="out('2908219533119674198');" style=""> 110    * 添加调度器回调                                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 111    *                                                                                                     </span>
<span class="6045833037568940004" onmouseenter="enter('6045833037568940004');" onmouseout="out('6045833037568940004');" style=""> 112    * @see #register()                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 113    */                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 114   @Deprecated                                                                                            </span>
<span class="-126542030871069224" onmouseenter="enter('-126542030871069224');" onmouseout="out('-126542030871069224');" style=""> 115   public DownloadReceiver addSchedulerListener(ISchedulerListener&lt;DownloadTask&gt; listener) {              </span>
<span class="3639523841108672913" onmouseenter="enter('3639523841108672913');" onmouseout="out('3639523841108672913');" style=""> 116     this.listener = listener;                                                                            </span>
<span class="-4329255953607201155" onmouseenter="enter('-4329255953607201155');" onmouseout="out('-4329255953607201155');" style=""> 117     DownloadSchedulers.getInstance().addSchedulerListener(targetName, listener);                         </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 118     return this;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119   }                                                                                                      </span>
<span  style=""> 120                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 121   /**                                                                                                    </span>
<span class="-1733418996972913610" onmouseenter="enter('-1733418996972913610');" onmouseout="out('-1733418996972913610');" style=""> 122    * 移除回调                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 123    *                                                                                                     </span>
<span class="5995762354354199814" onmouseenter="enter('5995762354354199814');" onmouseout="out('5995762354354199814');" style=""> 124    * @see #unRegister()                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 125    */                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 126   @Deprecated                                                                                            </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 127   @Override                                                                                              </span>
<span class="-700361754253835081" onmouseenter="enter('-700361754253835081');" onmouseout="out('-700361754253835081');" style=""> 128   public void removeSchedulerListener() {                                                                </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 129     if (listener != null) {                                                                              </span>
<span class="-8355444973462207128" onmouseenter="enter('-8355444973462207128');" onmouseout="out('-8355444973462207128');" style=""> 130       DownloadSchedulers.getInstance().removeSchedulerListener(targetName, listener);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132   }                                                                                                      </span>
<span  style=""> 133                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 134   @Override                                                                                              </span>
<span class="-4337173735040660880" onmouseenter="enter('-4337173735040660880');" onmouseout="out('-4337173735040660880');" style=""> 135   public void destroy() {                                                                                </span>
<span class="-4901128148553670878" onmouseenter="enter('-4901128148553670878');" onmouseout="out('-4901128148553670878');" style=""> 136     targetName = null;                                                                                   </span>
<span class="-4099358687357442786" onmouseenter="enter('-4099358687357442786');" onmouseout="out('-4099358687357442786');" style=""> 137     listener = null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138   }                                                                                                      </span>
<span  style=""> 139                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 140   /**                                                                                                    </span>
<span class="-4855951461764354463" onmouseenter="enter('-4855951461764354463');" onmouseout="out('-4855951461764354463');" style=""> 141    * 通过下载链接获取下载实体                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 142    */                                                                                                    </span>
<span class="6067624311729681660" onmouseenter="enter('6067624311729681660');" onmouseout="out('6067624311729681660');" style=""> 143   public DownloadEntity getDownloadEntity(String downloadUrl) {                                          </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style=""> 144     CheckUtil.checkDownloadUrl(downloadUrl);                                                             </span>
<span class="-4757197890854513070" onmouseenter="enter('-4757197890854513070');" onmouseout="out('-4757197890854513070');" style=""> 145     return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146   }                                                                                                      </span>
<span  style=""> 147                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 148   /**                                                                                                    </span>
<span class="-7888671401854060616" onmouseenter="enter('-7888671401854060616');" onmouseout="out('-7888671401854060616');" style=""> 149    * 下载任务是否存在                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 150    */                                                                                                    </span>
<span class="-1092275811913780416" onmouseenter="enter('-1092275811913780416');" onmouseout="out('-1092275811913780416');" style=""> 151   @Override public boolean taskExists(String downloadUrl) {                                              </span>
<span class="-7371274125067821256" onmouseenter="enter('-7371274125067821256');" onmouseout="out('-7371274125067821256');" style=""> 152     return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl) != null;          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153   }                                                                                                      </span>
<span  style=""> 154                                                                                                          </span>
<span class="-6671982019509624286" onmouseenter="enter('-6671982019509624286');" onmouseout="out('-6671982019509624286');" style=""> 155   @Override public List&lt;DownloadEntity&gt; getTaskList() {                                                  </span>
<span class="-3090597531179212341" onmouseenter="enter('-3090597531179212341');" onmouseout="out('-3090597531179212341');" style=""> 156     return DownloadEntity.findAllData(DownloadEntity.class);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157   }                                                                                                      </span>
<span  style=""> 158                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 159   /**                                                                                                    </span>
<span class="3402822126794432274" onmouseenter="enter('3402822126794432274');" onmouseout="out('3402822126794432274');" style=""> 160    * 停止所有正在下载的任务，并清空等待队列。                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 161    */                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 162   @Override                                                                                              </span>
<span class="-1687190236639704239" onmouseenter="enter('-1687190236639704239');" onmouseout="out('-1687190236639704239');" style=""> 163   public void stopAllTask() {                                                                            </span>
<span class="3876288912213825694" onmouseenter="enter('3876288912213825694');" onmouseout="out('3876288912213825694');" style=""><abbr title=" 164     AriaManager.getInstance(AriaManager.APP).setCmd(NormalCmdFactory.getInstance().createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_STOP_ALL)).exe();"> 164     AriaManager.getInstance(AriaManager.APP).setCmd(NormalCmdFactory.getInstance().createCmd(targetName, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165   }                                                                                                      </span>
<span  style=""> 166                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 167   /**                                                                                                    </span>
<span class="1311517946297423409" onmouseenter="enter('1311517946297423409');" onmouseout="out('1311517946297423409');" style=""> 168    * 恢复所有正在下载的任务                                                                                         </span>
<span class="-4407894673997389754" onmouseenter="enter('-4407894673997389754');" onmouseout="out('-4407894673997389754');" style=""> 169    * 1.如果执行队列没有满，则开始下载任务，直到执行队列满                                                                         </span>
<span class="-525289014070027486" onmouseenter="enter('-525289014070027486');" onmouseout="out('-525289014070027486');" style=""> 170    * 2.如果队列执行队列已经满了，则将所有任务添加到等待队列中                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 171    */                                                                                                    </span>
<span class="2382837737668558844" onmouseenter="enter('2382837737668558844');" onmouseout="out('2382837737668558844');" style=""> 172   public void resumeAllTask() {                                                                          </span>
<span class="3790579628813537865" onmouseenter="enter('3790579628813537865');" onmouseout="out('3790579628813537865');" style=""><abbr title=" 173     AriaManager.getInstance(AriaManager.APP).setCmd(NormalCmdFactory.getInstance().createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_RESUME_ALL)).exe();"> 173     AriaManager.getInstance(AriaManager.APP).setCmd(NormalCmdFactory.getInstance().createCmd(targetName, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174   }                                                                                                      </span>
<span  style=""> 175                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 176   /**                                                                                                    </span>
<span class="-7338390600186437821" onmouseenter="enter('-7338390600186437821');" onmouseout="out('-7338390600186437821');" style=""> 177    * 删除所有任务                                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 178    *                                                                                                     </span>
<span class="-1652635678671515318" onmouseenter="enter('-1652635678671515318');" onmouseout="out('-1652635678671515318');" style=""> 179    * @param removeFile                                                                                   </span>
<span class="-7081133589852931771" onmouseenter="enter('-7081133589852931771');" onmouseout="out('-7081133589852931771');" style=""> 180    * 		{@code true} 删除已经下载完成的任务，不仅删除下载记录，还会删除已经下载完成的文件，{@code false}                                     </span>
<span class="1426146265381645507" onmouseenter="enter('1426146265381645507');" onmouseout="out('1426146265381645507');" style=""> 181    * 		如果文件已经下载完成，只删除下载记录                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 182    */                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 183   @Override                                                                                              </span>
<span class="-630732473641048725" onmouseenter="enter('-630732473641048725');" onmouseout="out('-630732473641048725');" style=""> 184   public void removeAllTask(boolean removeFile) {                                                        </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style=""> 185     final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                            </span>
<span class="9110181056272170820" onmouseenter="enter('9110181056272170820');" onmouseout="out('9110181056272170820');" style=""><abbr title=" 186     AriaManager.getInstance(AriaManager.APP).setCmd(CommonUtil.createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_CANCEL_ALL)).exe();"> 186     AriaManager.getInstance(AriaManager.APP).setCmd(CommonUtil.createCmd(targetName, new DownloadTaskEnti🔵</abbr></span>
<span class="6170682864485863774" onmouseenter="enter('6170682864485863774');" onmouseout="out('6170682864485863774');" style=""> 187     Set&lt;String&gt; keys = ariaManager.getReceiver().keySet();                                               </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 188     for (String key : keys) {                                                                            </span>
<span class="-467225363893902060" onmouseenter="enter('-467225363893902060');" onmouseout="out('-467225363893902060');" style=""> 189       IReceiver receiver = ariaManager.getReceiver().get(key);                                           </span>
<span class="3799717368039523564" onmouseenter="enter('3799717368039523564');" onmouseout="out('3799717368039523564');" style=""> 190       receiver.removeSchedulerListener();                                                                </span>
<span class="5986307215158803793" onmouseenter="enter('5986307215158803793');" onmouseout="out('5986307215158803793');" style=""> 191       receiver.unRegister();                                                                             </span>
<span class="-4261055600814182440" onmouseenter="enter('-4261055600814182440');" onmouseout="out('-4261055600814182440');" style=""> 192       ariaManager.getReceiver().remove(key);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194   }                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195 }                                                                                                        </span>



</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2   * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span class="1987357580077471394" onmouseenter="enter('1987357580077471394');" onmouseout="out('1987357580077471394');" style="">  16  package com.arialyy.aria.core.download;                                                                           </span>
<span  style="">  17                                                                                                                    </span>
<span class="-2370850629707943459" onmouseenter="enter('-2370850629707943459');" onmouseout="out('-2370850629707943459');" style="">  18  import android.support.annotation.NonNull;                                                                        </span>
<span class="3973751924708272716" onmouseenter="enter('3973751924708272716');" onmouseout="out('3973751924708272716');" style="">  19  import com.arialyy.aria.core.AriaManager;                                                                         </span>
<span class="-477762279452602188" onmouseenter="enter('-477762279452602188');" onmouseout="out('-477762279452602188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -import com.arialyy.aria.core.inf.ICmd;                                                                            </span>

<span class="-5016163043314935005" onmouseenter="enter('-5016163043314935005');" onmouseout="out('-5016163043314935005');" style="">  21  import com.arialyy.aria.core.inf.IEntity;                                                                         </span>
<span class="-7853945460211298347" onmouseenter="enter('-7853945460211298347');" onmouseout="out('-7853945460211298347');" style="">  22  import com.arialyy.aria.core.inf.IReceiver;                                                                       </span>
<span class="4978045074105868199" onmouseenter="enter('4978045074105868199');" onmouseout="out('4978045074105868199');" style="">  23  import com.arialyy.aria.core.command.CmdFactory;                                                                  </span>
<span class="1694884086403432854" onmouseenter="enter('1694884086403432854');" onmouseout="out('1694884086403432854');" style="">  24  import com.arialyy.aria.core.command.AbsCmd;                                                                      </span>

<span class="7326175858930165690" onmouseenter="enter('7326175858930165690');" onmouseout="out('7326175858930165690');" style="">  25  import com.arialyy.aria.core.scheduler.DownloadSchedulers;                                                        </span>
<span class="-972246557960033348" onmouseenter="enter('-972246557960033348');" onmouseout="out('-972246557960033348');" style="">  26  import com.arialyy.aria.core.scheduler.ISchedulerListener;                                                        </span>
<span class="-4499301116755301031" onmouseenter="enter('-4499301116755301031');" onmouseout="out('-4499301116755301031');" style="">  27  import com.arialyy.aria.orm.DbEntity;                                                                             </span>
<span class="-8921020518339919076" onmouseenter="enter('-8921020518339919076');" onmouseout="out('-8921020518339919076');" style="">  28  import com.arialyy.aria.util.CheckUtil;                                                                           </span>
<span class="-3106139894727218967" onmouseenter="enter('-3106139894727218967');" onmouseout="out('-3106139894727218967');" style="">  29  import com.arialyy.aria.util.CommonUtil;                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  30  import java.io.File;                                                                                              </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  31  import java.util.ArrayList;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  32  import java.util.List;                                                                                            </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  33  import java.util.Set;                                                                                             </span>
<span  style="">  34                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  35  /**                                                                                                               </span>
<span class="-8976164179967820781" onmouseenter="enter('-8976164179967820781');" onmouseout="out('-8976164179967820781');" style="">  36   * Created by lyy on 2016/12/5.                                                                                   </span>
<span class="8451370004399326130" onmouseenter="enter('8451370004399326130');" onmouseout="out('8451370004399326130');" style="">  37   * 下载功能接收器                                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  38   */                                                                                                               </span>
<span class="5064456939760455403" onmouseenter="enter('5064456939760455403');" onmouseout="out('5064456939760455403');" style="">  39  public class DownloadReceiver implements IReceiver&lt;DownloadEntity&gt; {                                              </span>
<span class="3855473464411743291" onmouseenter="enter('3855473464411743291');" onmouseout="out('3855473464411743291');" style="">  40    private static final String TAG = &quot;DownloadReceiver&quot;;                                                           </span>
<span class="-7082153646158853593" onmouseenter="enter('-7082153646158853593');" onmouseout="out('-7082153646158853593');" style="">  41    public String targetName;                                                                                       </span>
<span class="-3598199831321058814" onmouseenter="enter('-3598199831321058814');" onmouseout="out('-3598199831321058814');" style="">  42    public Object obj;                                                                                              </span>


<span class="8974910660156933255" onmouseenter="enter('8974910660156933255');" onmouseout="out('8974910660156933255');" style="">  43    public ISchedulerListener&lt;DownloadTask&gt; listener;                                                               </span>
<span  style="">  44                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45    /**                                                                                                             </span>
<span class="-8030592473296514020" onmouseenter="enter('-8030592473296514020');" onmouseout="out('-8030592473296514020');" style="">  46     * 设置最大下载速度，单位：kb                                                                                               </span>
<span class="5818094815562401128" onmouseenter="enter('5818094815562401128');" onmouseout="out('5818094815562401128');" style="">  47     * 该方法为实验性功能，清不要轻易在生产环境中使用。                                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  48     *                                                                                                              </span>
<span class="9124526800094534994" onmouseenter="enter('9124526800094534994');" onmouseout="out('9124526800094534994');" style="">  49     * @param maxSpeed 为0表示不限速                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  50     */                                                                                                             </span>
<span class="-7953977331871486849" onmouseenter="enter('-7953977331871486849');" onmouseout="out('-7953977331871486849');" style="">  51    @Deprecated public void setMaxSpeed(double maxSpeed) {                                                          </span>
<span class="7170079538529520301" onmouseenter="enter('7170079538529520301');" onmouseout="out('7170079538529520301');" style="">  52      AriaManager.getInstance(AriaManager.APP).getDownloadConfig().setMsxSpeed(maxSpeed);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53    }                                                                                                               </span>
<span  style="">  54                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55    /**                                                                                                             </span>
<span class="3315269434963037496" onmouseenter="enter('3315269434963037496');" onmouseout="out('3315269434963037496');" style="">  56     * {@link #load(String)}，请使用该方法                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57     */                                                                                                             </span>
<span class="-198951527563532118" onmouseenter="enter('-198951527563532118');" onmouseout="out('-198951527563532118');" style="">  58    @Deprecated public DownloadTarget load(DownloadEntity entity) {                                                 </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  59      return new DownloadTarget(entity, targetName);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  60    }                                                                                                               </span>
<span  style="">  61                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62    /**                                                                                                             </span>
<span class="-7592705859776173848" onmouseenter="enter('-7592705859776173848');" onmouseout="out('-7592705859776173848');" style="">  63     * 加载下载地址                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64     */                                                                                                             </span>
<span class="5257821212992384848" onmouseenter="enter('5257821212992384848');" onmouseout="out('5257821212992384848');" style="">  65    public DownloadTarget load(@NonNull String downloadUrl) {                                                       </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style="">  66      CheckUtil.checkDownloadUrl(downloadUrl);                                                                      </span>
<span class="-5265249557182946837" onmouseenter="enter('-5265249557182946837');" onmouseout="out('-5265249557182946837');" style="">  67      DownloadEntity entity =                                                                                       </span>
<span class="57873310924392504" onmouseenter="enter('57873310924392504');" onmouseout="out('57873310924392504');" style="">  68          DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                              </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  69      if (entity == null) {                                                                                         </span>
<span class="-873561942459071238" onmouseenter="enter('-873561942459071238');" onmouseout="out('-873561942459071238');" style="">  70        entity = new DownloadEntity();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71      }                                                                                                             </span>
<span class="-8554155214173149752" onmouseenter="enter('-8554155214173149752');" onmouseout="out('-8554155214173149752');" style="">  72      File file = new File(entity.getDownloadPath());                                                               </span>
<span class="4133240422546463755" onmouseenter="enter('4133240422546463755');" onmouseout="out('4133240422546463755');" style="">  73      if (!file.exists()) {                                                                                         </span>
<span class="2455718788061552443" onmouseenter="enter('2455718788061552443');" onmouseout="out('2455718788061552443');" style="">  74        entity.setState(IEntity.STATE_WAIT);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75      }                                                                                                             </span>
<span class="8369938699249911811" onmouseenter="enter('8369938699249911811');" onmouseout="out('8369938699249911811');" style="">  76      entity.setDownloadUrl(downloadUrl);                                                                           </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  77      return new DownloadTarget(entity, targetName);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78    }                                                                                                               </span>
<span  style="">  79                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  80    /**                                                                                                             </span>
<span class="2908219533119674198" onmouseenter="enter('2908219533119674198');" onmouseout="out('2908219533119674198');" style="">  81     * 添加调度器回调                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  82     *                                                                                                              </span>
<span class="6045833037568940004" onmouseenter="enter('6045833037568940004');" onmouseout="out('6045833037568940004');" style="">  83     * @see #register()                                                                                             </span>

<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  84     */                                                                                                             </span>
<span class="7863890290020597777" onmouseenter="enter('7863890290020597777');" onmouseout="out('7863890290020597777');" style="">  85    @Deprecated public DownloadReceiver addSchedulerListener(                                                       </span>
<span class="8359169744604926706" onmouseenter="enter('8359169744604926706');" onmouseout="out('8359169744604926706');" style="">  86        ISchedulerListener&lt;DownloadTask&gt; listener) {                                                                </span>
<span class="3639523841108672913" onmouseenter="enter('3639523841108672913');" onmouseout="out('3639523841108672913');" style="">  87      this.listener = listener;                                                                                     </span>
<span class="-4329255953607201155" onmouseenter="enter('-4329255953607201155');" onmouseout="out('-4329255953607201155');" style="">  88      DownloadSchedulers.getInstance().addSchedulerListener(targetName, listener);                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">  89      return this;                                                                                                  </span>









<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90    }                                                                                                               </span>
<span  style="">  91                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  92    /**                                                                                                             </span>
<span class="-2874086798355386198" onmouseenter="enter('-2874086798355386198');" onmouseout="out('-2874086798355386198');" style="">  93     * 将当前类注册到Aria                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  94     */                                                                                                             </span>
<span class="-4925173742984207732" onmouseenter="enter('-4925173742984207732');" onmouseout="out('-4925173742984207732');" style="">  95    public DownloadReceiver register() {                                                                            </span>
<span class="-5670875303591463725" onmouseenter="enter('-5670875303591463725');" onmouseout="out('-5670875303591463725');" style="">  96      DownloadSchedulers.getInstance().register(obj);                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="">  97      return this;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98    }                                                                                                               </span>
<span  style="">  99                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 100    /**                                                                                                             </span>
<span class="4811620718788803994" onmouseenter="enter('4811620718788803994');" onmouseout="out('4811620718788803994');" style=""> 101     * 取消注册                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 102     */                                                                                                             </span>
<span class="9104098464026605676" onmouseenter="enter('9104098464026605676');" onmouseout="out('9104098464026605676');" style=""> 103    @Override public void unRegister() {                                                                            </span>
<span class="-4965118218032185711" onmouseenter="enter('-4965118218032185711');" onmouseout="out('-4965118218032185711');" style=""> 104      DownloadSchedulers.getInstance().unRegister(obj);                                                             </span>












<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105    }                                                                                                               </span>
<span  style=""> 106                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 107    /**                                                                                                             </span>
<span class="-1733418996972913610" onmouseenter="enter('-1733418996972913610');" onmouseout="out('-1733418996972913610');" style=""> 108     * 移除回调                                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 109     *                                                                                                              </span>
<span class="5995762354354199814" onmouseenter="enter('5995762354354199814');" onmouseout="out('5995762354354199814');" style=""> 110     * @see #unRegister()                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 111     */                                                                                                             </span>
<span class="-2712512022957064783" onmouseenter="enter('-2712512022957064783');" onmouseout="out('-2712512022957064783');" style=""> 112    @Deprecated @Override public void removeSchedulerListener() {                                                   </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 113      if (listener != null) {                                                                                       </span>
<span class="-8355444973462207128" onmouseenter="enter('-8355444973462207128');" onmouseout="out('-8355444973462207128');" style=""> 114        DownloadSchedulers.getInstance().removeSchedulerListener(targetName, listener);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116    }                                                                                                               </span>
<span  style=""> 117                                                                                                                    </span>
<span class="3345695681730814389" onmouseenter="enter('3345695681730814389');" onmouseout="out('3345695681730814389');" style=""> 118    @Override public void destroy() {                                                                               </span>
<span class="-4901128148553670878" onmouseenter="enter('-4901128148553670878');" onmouseout="out('-4901128148553670878');" style=""> 119      targetName = null;                                                                                            </span>
<span class="-4099358687357442786" onmouseenter="enter('-4099358687357442786');" onmouseout="out('-4099358687357442786');" style=""> 120      listener = null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121    }                                                                                                               </span>
<span  style=""> 122                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 123    /**                                                                                                             </span>
<span class="-4855951461764354463" onmouseenter="enter('-4855951461764354463');" onmouseout="out('-4855951461764354463');" style=""> 124     * 通过下载链接获取下载实体                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 125     */                                                                                                             </span>
<span class="6067624311729681660" onmouseenter="enter('6067624311729681660');" onmouseout="out('6067624311729681660');" style=""> 126    public DownloadEntity getDownloadEntity(String downloadUrl) {                                                   </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style=""> 127      CheckUtil.checkDownloadUrl(downloadUrl);                                                                      </span>
<span class="-4757197890854513070" onmouseenter="enter('-4757197890854513070');" onmouseout="out('-4757197890854513070');" style=""> 128      return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129    }                                                                                                               </span>
<span  style=""> 130                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 131    /**                                                                                                             </span>
<span class="-7888671401854060616" onmouseenter="enter('-7888671401854060616');" onmouseout="out('-7888671401854060616');" style=""> 132     * 下载任务是否存在                                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 133     */                                                                                                             </span>
<span class="-1092275811913780416" onmouseenter="enter('-1092275811913780416');" onmouseout="out('-1092275811913780416');" style=""> 134    @Override public boolean taskExists(String downloadUrl) {                                                       </span>
<span class="-7371274125067821256" onmouseenter="enter('-7371274125067821256');" onmouseout="out('-7371274125067821256');" style=""> 135      return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl) != null;                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136    }                                                                                                               </span>
<span  style=""> 137                                                                                                                    </span>
<span class="-6671982019509624286" onmouseenter="enter('-6671982019509624286');" onmouseout="out('-6671982019509624286');" style=""> 138    @Override public List&lt;DownloadEntity&gt; getTaskList() {                                                           </span>
<span class="-3090597531179212341" onmouseenter="enter('-3090597531179212341');" onmouseout="out('-3090597531179212341');" style=""> 139      return DownloadEntity.findAllData(DownloadEntity.class);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140    }                                                                                                               </span>
<span  style=""> 141                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 142    /**                                                                                                             </span>
<span class="3402822126794432274" onmouseenter="enter('3402822126794432274');" onmouseout="out('3402822126794432274');" style=""> 143     * 停止所有正在下载的任务，并清空等待队列。                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 144     */                                                                                                             </span>
<span class="-8271139132618696861" onmouseenter="enter('-8271139132618696861');" onmouseout="out('-8271139132618696861');" style=""> 145    @Override public void stopAllTask() {                                                                           </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style=""> 146      final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                                     </span>
<span class="-3279938674581626487" onmouseenter="enter('-3279938674581626487');" onmouseout="out('-3279938674581626487');" style=""> 147      ariaManager.setCmd(CmdFactory.getInstance()                                                                   </span>
<span class="-124375894478059984" onmouseenter="enter('-124375894478059984');" onmouseout="out('-124375894478059984');" style=""> 148          .createCmd(targetName, new DownloadTaskEntity(), CmdFactory.TASK_STOP_ALL)).exe();                        </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149    }                                                                                                               </span>
<span  style=""> 150                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 151    /**                                                                                                             </span>
<span class="1311517946297423409" onmouseenter="enter('1311517946297423409');" onmouseout="out('1311517946297423409');" style=""> 152     * 恢复所有正在下载的任务                                                                                                  </span>
<span class="-4407894673997389754" onmouseenter="enter('-4407894673997389754');" onmouseout="out('-4407894673997389754');" style=""> 153     * 1.如果执行队列没有满，则开始下载任务，直到执行队列满                                                                                  </span>
<span class="-525289014070027486" onmouseenter="enter('-525289014070027486');" onmouseout="out('-525289014070027486');" style=""> 154     * 2.如果队列执行队列已经满了，则将所有任务添加到等待队列中                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 155     */                                                                                                             </span>
<span class="2382837737668558844" onmouseenter="enter('2382837737668558844');" onmouseout="out('2382837737668558844');" style=""> 156    public void resumeAllTask() {                                                                                   </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style=""> 157      final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                                     </span>
<span class="-3279938674581626487" onmouseenter="enter('-3279938674581626487');" onmouseout="out('-3279938674581626487');" style=""> 158      ariaManager.setCmd(CmdFactory.getInstance()                                                                   </span>
<span class="-5782153098770386278" onmouseenter="enter('-5782153098770386278');" onmouseout="out('-5782153098770386278');" style=""> 159          .createCmd(targetName, new DownloadTaskEntity(), CmdFactory.TASK_RESUME_ALL)).exe();                      </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160    }                                                                                                               </span>
<span  style=""> 161                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 162    /**                                                                                                             </span>
<span class="-7338390600186437821" onmouseenter="enter('-7338390600186437821');" onmouseout="out('-7338390600186437821');" style=""> 163     * 删除所有任务                                                                                                       </span>



<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 164     */                                                                                                             </span>
<span class="-1737930364576906321" onmouseenter="enter('-1737930364576906321');" onmouseout="out('-1737930364576906321');" style=""> 165    @Override public void removeAllTask() {                                                                         </span>

<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style=""> 166      final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                                     </span>
<span class="8569706088986467037" onmouseenter="enter('8569706088986467037');" onmouseout="out('8569706088986467037');" style=""> 167      List&lt;DownloadEntity&gt; allEntity = DbEntity.findAllData(DownloadEntity.class);                                  </span>
<span class="-8362571003842902202" onmouseenter="enter('-8362571003842902202');" onmouseout="out('-8362571003842902202');" style=""> 168      List&lt;AbsCmd&gt; cancelCmds = new ArrayList&lt;&gt;();                                                                  </span>
<span class="7270933921411644426" onmouseenter="enter('7270933921411644426');" onmouseout="out('7270933921411644426');" style=""> 169      for (DownloadEntity entity : allEntity) {                                                                     </span>
<span class="-2596374898145490245" onmouseenter="enter('-2596374898145490245');" onmouseout="out('-2596374898145490245');" style=""> 170        cancelCmds.add(                                                                                             </span>
<span class="-991582373137690263" onmouseenter="enter('-991582373137690263');" onmouseout="out('-991582373137690263');" style=""> 171            CommonUtil.createCmd(targetName, new DownloadTaskEntity(entity), CmdFactory.TASK_CANCEL));              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172      }                                                                                                             </span>
<span class="6221331641879304576" onmouseenter="enter('6221331641879304576');" onmouseout="out('6221331641879304576');" style=""> 173      ariaManager.setCmds(cancelCmds).exe();                                                                        </span>





<span class="6170682864485863774" onmouseenter="enter('6170682864485863774');" onmouseout="out('6170682864485863774');" style=""> 174      Set&lt;String&gt; keys = ariaManager.getReceiver().keySet();                                                        </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 175      for (String key : keys) {                                                                                     </span>
<span class="-467225363893902060" onmouseenter="enter('-467225363893902060');" onmouseout="out('-467225363893902060');" style=""> 176        IReceiver receiver = ariaManager.getReceiver().get(key);                                                    </span>
<span class="3799717368039523564" onmouseenter="enter('3799717368039523564');" onmouseout="out('3799717368039523564');" style=""> 177        receiver.removeSchedulerListener();                                                                         </span>
<span class="5986307215158803793" onmouseenter="enter('5986307215158803793');" onmouseout="out('5986307215158803793');" style=""> 178        receiver.unRegister();                                                                                      </span>
<span class="-4261055600814182440" onmouseenter="enter('-4261055600814182440');" onmouseout="out('-4261055600814182440');" style=""> 179        ariaManager.getReceiver().remove(key);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181    }                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2   * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span class="1987357580077471394" onmouseenter="enter('1987357580077471394');" onmouseout="out('1987357580077471394');" style="">  16  package com.arialyy.aria.core.download;                                                                           </span>
<span  style="">  17                                                                                                                    </span>
<span class="-2370850629707943459" onmouseenter="enter('-2370850629707943459');" onmouseout="out('-2370850629707943459');" style="">  18  import android.support.annotation.NonNull;                                                                        </span>
<span class="3973751924708272716" onmouseenter="enter('3973751924708272716');" onmouseout="out('3973751924708272716');" style="">  19  import com.arialyy.aria.core.AriaManager;                                                                         </span>
<span class="-477762279452602188" onmouseenter="enter('-477762279452602188');" onmouseout="out('-477762279452602188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -import com.arialyy.aria.core.inf.ICmd;                                                                            </span>
<span class="-2122960619967737033" onmouseenter="enter('-2122960619967737033');" onmouseout="out('-2122960619967737033');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  21 +import com.arialyy.aria.core.inf.AbsReceiver;                                                                     </span>
<span class="-5016163043314935005" onmouseenter="enter('-5016163043314935005');" onmouseout="out('-5016163043314935005');" style="">  22  import com.arialyy.aria.core.inf.IEntity;                                                                         </span>
<span class="-7853945460211298347" onmouseenter="enter('-7853945460211298347');" onmouseout="out('-7853945460211298347');" style="">  23  import com.arialyy.aria.core.inf.IReceiver;                                                                       </span>
<span class="4978045074105868199" onmouseenter="enter('4978045074105868199');" onmouseout="out('4978045074105868199');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import com.arialyy.aria.core.command.CmdFactory;                                                                  </span>
<span class="1694884086403432854" onmouseenter="enter('1694884086403432854');" onmouseout="out('1694884086403432854');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.arialyy.aria.core.command.AbsCmd;                                                                      </span>
<span class="-801363442427116995" onmouseenter="enter('-801363442427116995');" onmouseout="out('-801363442427116995');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import com.arialyy.aria.core.command.normal.NormalCmdFactory;                                                     </span>
<span class="7326175858930165690" onmouseenter="enter('7326175858930165690');" onmouseout="out('7326175858930165690');" style="">  27  import com.arialyy.aria.core.scheduler.DownloadSchedulers;                                                        </span>
<span class="-972246557960033348" onmouseenter="enter('-972246557960033348');" onmouseout="out('-972246557960033348');" style="">  28  import com.arialyy.aria.core.scheduler.ISchedulerListener;                                                        </span>
<span class="-4499301116755301031" onmouseenter="enter('-4499301116755301031');" onmouseout="out('-4499301116755301031');" style="">  29  import com.arialyy.aria.orm.DbEntity;                                                                             </span>
<span class="-8921020518339919076" onmouseenter="enter('-8921020518339919076');" onmouseout="out('-8921020518339919076');" style="">  30  import com.arialyy.aria.util.CheckUtil;                                                                           </span>
<span class="-3106139894727218967" onmouseenter="enter('-3106139894727218967');" onmouseout="out('-3106139894727218967');" style="">  31  import com.arialyy.aria.util.CommonUtil;                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  32  import java.io.File;                                                                                              </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import java.util.ArrayList;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  34  import java.util.List;                                                                                            </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  35  import java.util.Set;                                                                                             </span>
<span  style="">  36                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  37  /**                                                                                                               </span>
<span class="-8976164179967820781" onmouseenter="enter('-8976164179967820781');" onmouseout="out('-8976164179967820781');" style="">  38   * Created by lyy on 2016/12/5.                                                                                   </span>
<span class="8451370004399326130" onmouseenter="enter('8451370004399326130');" onmouseout="out('8451370004399326130');" style="">  39   * 下载功能接收器                                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  40   */                                                                                                               </span>
<span class="5064456939760455403" onmouseenter="enter('5064456939760455403');" onmouseout="out('5064456939760455403');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -public class DownloadReceiver implements IReceiver&lt;DownloadEntity&gt; {                                              </span>
<span class="3855473464411743291" onmouseenter="enter('3855473464411743291');" onmouseout="out('3855473464411743291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -  private static final String TAG = &quot;DownloadReceiver&quot;;                                                           </span>
<span class="-7082153646158853593" onmouseenter="enter('-7082153646158853593');" onmouseout="out('-7082153646158853593');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -  public String targetName;                                                                                       </span>
<span class="-3598199831321058814" onmouseenter="enter('-3598199831321058814');" onmouseout="out('-3598199831321058814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -  public Object obj;                                                                                              </span>
<span class="-8738903633205828472" onmouseenter="enter('-8738903633205828472');" onmouseout="out('-8738903633205828472');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +public class DownloadReceiver extends AbsReceiver&lt;DownloadEntity&gt; {                                               </span>
<span class="-4144196955255973047" onmouseenter="enter('-4144196955255973047');" onmouseout="out('-4144196955255973047');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +  private final String TAG = &quot;DownloadReceiver&quot;;                                                                  </span>
<span class="8974910660156933255" onmouseenter="enter('8974910660156933255');" onmouseout="out('8974910660156933255');" style="">  47    public ISchedulerListener&lt;DownloadTask&gt; listener;                                                               </span>
<span  style="">  48                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  49    /**                                                                                                             </span>
<span class="-8030592473296514020" onmouseenter="enter('-8030592473296514020');" onmouseout="out('-8030592473296514020');" style="">  50     * 设置最大下载速度，单位：kb                                                                                               </span>
<span class="5818094815562401128" onmouseenter="enter('5818094815562401128');" onmouseout="out('5818094815562401128');" style="">  51     * 该方法为实验性功能，清不要轻易在生产环境中使用。                                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  52     *                                                                                                              </span>
<span class="9124526800094534994" onmouseenter="enter('9124526800094534994');" onmouseout="out('9124526800094534994');" style="">  53     * @param maxSpeed 为0表示不限速                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54     */                                                                                                             </span>
<span class="-7953977331871486849" onmouseenter="enter('-7953977331871486849');" onmouseout="out('-7953977331871486849');" style="">  55    @Deprecated public void setMaxSpeed(double maxSpeed) {                                                          </span>
<span class="7170079538529520301" onmouseenter="enter('7170079538529520301');" onmouseout="out('7170079538529520301');" style="">  56      AriaManager.getInstance(AriaManager.APP).getDownloadConfig().setMsxSpeed(maxSpeed);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57    }                                                                                                               </span>
<span  style="">  58                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  59    /**                                                                                                             </span>
<span class="3315269434963037496" onmouseenter="enter('3315269434963037496');" onmouseout="out('3315269434963037496');" style="">  60     * {@link #load(String)}，请使用该方法                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61     */                                                                                                             </span>
<span class="-198951527563532118" onmouseenter="enter('-198951527563532118');" onmouseout="out('-198951527563532118');" style="">  62    @Deprecated public DownloadTarget load(DownloadEntity entity) {                                                 </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  63      return new DownloadTarget(entity, targetName);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  64    }                                                                                                               </span>
<span  style="">  65                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  66    /**                                                                                                             </span>
<span class="-7592705859776173848" onmouseenter="enter('-7592705859776173848');" onmouseout="out('-7592705859776173848');" style="">  67     * 加载下载地址                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68     */                                                                                                             </span>
<span class="5257821212992384848" onmouseenter="enter('5257821212992384848');" onmouseout="out('5257821212992384848');" style="">  69    public DownloadTarget load(@NonNull String downloadUrl) {                                                       </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style="">  70      CheckUtil.checkDownloadUrl(downloadUrl);                                                                      </span>
<span class="-5265249557182946837" onmouseenter="enter('-5265249557182946837');" onmouseout="out('-5265249557182946837');" style="">  71      DownloadEntity entity =                                                                                       </span>
<span class="57873310924392504" onmouseenter="enter('57873310924392504');" onmouseout="out('57873310924392504');" style="">  72          DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                              </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">  73      if (entity == null) {                                                                                         </span>
<span class="-873561942459071238" onmouseenter="enter('-873561942459071238');" onmouseout="out('-873561942459071238');" style="">  74        entity = new DownloadEntity();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75      }                                                                                                             </span>
<span class="-8554155214173149752" onmouseenter="enter('-8554155214173149752');" onmouseout="out('-8554155214173149752');" style="">  76      File file = new File(entity.getDownloadPath());                                                               </span>
<span class="4133240422546463755" onmouseenter="enter('4133240422546463755');" onmouseout="out('4133240422546463755');" style="">  77      if (!file.exists()) {                                                                                         </span>
<span class="2455718788061552443" onmouseenter="enter('2455718788061552443');" onmouseout="out('2455718788061552443');" style="">  78        entity.setState(IEntity.STATE_WAIT);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79      }                                                                                                             </span>
<span class="8369938699249911811" onmouseenter="enter('8369938699249911811');" onmouseout="out('8369938699249911811');" style="">  80      entity.setDownloadUrl(downloadUrl);                                                                           </span>
<span class="3937395813820048271" onmouseenter="enter('3937395813820048271');" onmouseout="out('3937395813820048271');" style="">  81      return new DownloadTarget(entity, targetName);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82    }                                                                                                               </span>
<span  style="">  83                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84    /**                                                                                                             </span>
<span class="2908219533119674198" onmouseenter="enter('2908219533119674198');" onmouseout="out('2908219533119674198');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -   * 添加调度器回调                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -   *                                                                                                              </span>
<span class="6045833037568940004" onmouseenter="enter('6045833037568940004');" onmouseout="out('6045833037568940004');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -   * @see #register()                                                                                             </span>
<span class="2297304325080531827" onmouseenter="enter('2297304325080531827');" onmouseout="out('2297304325080531827');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  88 +   * 加载下载地址，如果任务组的中的下载地址改变了，则任务从新的一个任务组                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  89     */                                                                                                             </span>
<span class="7863890290020597777" onmouseenter="enter('7863890290020597777');" onmouseout="out('7863890290020597777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -  @Deprecated public DownloadReceiver addSchedulerListener(                                                       </span>
<span class="8359169744604926706" onmouseenter="enter('8359169744604926706');" onmouseout="out('8359169744604926706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -      ISchedulerListener&lt;DownloadTask&gt; listener) {                                                                </span>
<span class="3639523841108672913" onmouseenter="enter('3639523841108672913');" onmouseout="out('3639523841108672913');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -    this.listener = listener;                                                                                     </span>
<span class="-4329255953607201155" onmouseenter="enter('-4329255953607201155');" onmouseout="out('-4329255953607201155');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -    DownloadSchedulers.getInstance().addSchedulerListener(targetName, listener);                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -    return this;                                                                                                  </span>
<span class="-3978985407316286854" onmouseenter="enter('-3978985407316286854');" onmouseout="out('-3978985407316286854');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +  public DownloadGroupTarget load(List&lt;String&gt; urls) {                                                            </span>
<span class="-1456626783606571249" onmouseenter="enter('-1456626783606571249');" onmouseout="out('-1456626783606571249');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +    CheckUtil.checkDownloadUrls(urls);                                                                            </span>
<span class="4798297140159515182" onmouseenter="enter('4798297140159515182');" onmouseout="out('4798297140159515182');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  97 +    DownloadGroupEntity entity =                                                                                  </span>
<span class="-1893221228860282904" onmouseenter="enter('-1893221228860282904');" onmouseout="out('-1893221228860282904');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +        DbEntity.findData(DownloadGroupEntity.class, &quot;urlHash=?&quot;, CommonUtil.getMd5Code(urls));                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +                                                                                                                  </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +    if (entity == null) {                                                                                         </span>
<span class="3061966465183528912" onmouseenter="enter('3061966465183528912');" onmouseout="out('3061966465183528912');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +      entity = new DownloadGroupEntity();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 102 +    }                                                                                                             </span>
<span class="8763312927794318369" onmouseenter="enter('8763312927794318369');" onmouseout="out('8763312927794318369');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 103 +    return new DownloadGroupTarget(entity, targetName, urls);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104    }                                                                                                               </span>
<span  style=""> 105                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 106    /**                                                                                                             </span>
<span class="-2874086798355386198" onmouseenter="enter('-2874086798355386198');" onmouseout="out('-2874086798355386198');" style=""> 107     * 将当前类注册到Aria                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 108     */                                                                                                             </span>
<span class="-4925173742984207732" onmouseenter="enter('-4925173742984207732');" onmouseout="out('-4925173742984207732');" style=""> 109    public DownloadReceiver register() {                                                                            </span>
<span class="-5670875303591463725" onmouseenter="enter('-5670875303591463725');" onmouseout="out('-5670875303591463725');" style=""> 110      DownloadSchedulers.getInstance().register(obj);                                                               </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style=""> 111      return this;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112    }                                                                                                               </span>
<span  style=""> 113                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 114    /**                                                                                                             </span>
<span class="4811620718788803994" onmouseenter="enter('4811620718788803994');" onmouseout="out('4811620718788803994');" style=""> 115     * 取消注册                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 116     */                                                                                                             </span>
<span class="9104098464026605676" onmouseenter="enter('9104098464026605676');" onmouseout="out('9104098464026605676');" style=""> 117    @Override public void unRegister() {                                                                            </span>
<span class="-4965118218032185711" onmouseenter="enter('-4965118218032185711');" onmouseout="out('-4965118218032185711');" style=""> 118      DownloadSchedulers.getInstance().unRegister(obj);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +  }                                                                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +  /**                                                                                                             </span>
<span class="2908219533119674198" onmouseenter="enter('2908219533119674198');" onmouseout="out('2908219533119674198');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +   * 添加调度器回调                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +   *                                                                                                              </span>
<span class="6045833037568940004" onmouseenter="enter('6045833037568940004');" onmouseout="out('6045833037568940004');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +   * @see #register()                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +   */                                                                                                             </span>
<span class="7863890290020597777" onmouseenter="enter('7863890290020597777');" onmouseout="out('7863890290020597777');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +  @Deprecated public DownloadReceiver addSchedulerListener(                                                       </span>
<span class="8359169744604926706" onmouseenter="enter('8359169744604926706');" onmouseout="out('8359169744604926706');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +      ISchedulerListener&lt;DownloadTask&gt; listener) {                                                                </span>
<span class="3639523841108672913" onmouseenter="enter('3639523841108672913');" onmouseout="out('3639523841108672913');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +    this.listener = listener;                                                                                     </span>
<span class="-4329255953607201155" onmouseenter="enter('-4329255953607201155');" onmouseout="out('-4329255953607201155');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +    DownloadSchedulers.getInstance().addSchedulerListener(targetName, listener);                                  </span>
<span class="2297715846939503398" onmouseenter="enter('2297715846939503398');" onmouseout="out('2297715846939503398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +    return this;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131    }                                                                                                               </span>
<span  style=""> 132                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 133    /**                                                                                                             </span>
<span class="-1733418996972913610" onmouseenter="enter('-1733418996972913610');" onmouseout="out('-1733418996972913610');" style=""> 134     * 移除回调                                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 135     *                                                                                                              </span>
<span class="5995762354354199814" onmouseenter="enter('5995762354354199814');" onmouseout="out('5995762354354199814');" style=""> 136     * @see #unRegister()                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 137     */                                                                                                             </span>
<span class="-2712512022957064783" onmouseenter="enter('-2712512022957064783');" onmouseout="out('-2712512022957064783');" style=""> 138    @Deprecated @Override public void removeSchedulerListener() {                                                   </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 139      if (listener != null) {                                                                                       </span>
<span class="-8355444973462207128" onmouseenter="enter('-8355444973462207128');" onmouseout="out('-8355444973462207128');" style=""> 140        DownloadSchedulers.getInstance().removeSchedulerListener(targetName, listener);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142    }                                                                                                               </span>
<span  style=""> 143                                                                                                                    </span>
<span class="3345695681730814389" onmouseenter="enter('3345695681730814389');" onmouseout="out('3345695681730814389');" style=""> 144    @Override public void destroy() {                                                                               </span>
<span class="-4901128148553670878" onmouseenter="enter('-4901128148553670878');" onmouseout="out('-4901128148553670878');" style=""> 145      targetName = null;                                                                                            </span>
<span class="-4099358687357442786" onmouseenter="enter('-4099358687357442786');" onmouseout="out('-4099358687357442786');" style=""> 146      listener = null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147    }                                                                                                               </span>
<span  style=""> 148                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 149    /**                                                                                                             </span>
<span class="-4855951461764354463" onmouseenter="enter('-4855951461764354463');" onmouseout="out('-4855951461764354463');" style=""> 150     * 通过下载链接获取下载实体                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 151     */                                                                                                             </span>
<span class="6067624311729681660" onmouseenter="enter('6067624311729681660');" onmouseout="out('6067624311729681660');" style=""> 152    public DownloadEntity getDownloadEntity(String downloadUrl) {                                                   </span>
<span class="-7551708026621458125" onmouseenter="enter('-7551708026621458125');" onmouseout="out('-7551708026621458125');" style=""> 153      CheckUtil.checkDownloadUrl(downloadUrl);                                                                      </span>
<span class="-4757197890854513070" onmouseenter="enter('-4757197890854513070');" onmouseout="out('-4757197890854513070');" style=""> 154      return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155    }                                                                                                               </span>
<span  style=""> 156                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 157    /**                                                                                                             </span>
<span class="-7888671401854060616" onmouseenter="enter('-7888671401854060616');" onmouseout="out('-7888671401854060616');" style=""> 158     * 下载任务是否存在                                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 159     */                                                                                                             </span>
<span class="-1092275811913780416" onmouseenter="enter('-1092275811913780416');" onmouseout="out('-1092275811913780416');" style=""> 160    @Override public boolean taskExists(String downloadUrl) {                                                       </span>
<span class="-7371274125067821256" onmouseenter="enter('-7371274125067821256');" onmouseout="out('-7371274125067821256');" style=""> 161      return DownloadEntity.findData(DownloadEntity.class, &quot;downloadUrl=?&quot;, downloadUrl) != null;                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162    }                                                                                                               </span>
<span  style=""> 163                                                                                                                    </span>
<span class="-6671982019509624286" onmouseenter="enter('-6671982019509624286');" onmouseout="out('-6671982019509624286');" style=""> 164    @Override public List&lt;DownloadEntity&gt; getTaskList() {                                                           </span>
<span class="-3090597531179212341" onmouseenter="enter('-3090597531179212341');" onmouseout="out('-3090597531179212341');" style=""> 165      return DownloadEntity.findAllData(DownloadEntity.class);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166    }                                                                                                               </span>
<span  style=""> 167                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 168    /**                                                                                                             </span>
<span class="3402822126794432274" onmouseenter="enter('3402822126794432274');" onmouseout="out('3402822126794432274');" style=""> 169     * 停止所有正在下载的任务，并清空等待队列。                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 170     */                                                                                                             </span>
<span class="-8271139132618696861" onmouseenter="enter('-8271139132618696861');" onmouseout="out('-8271139132618696861');" style=""> 171    @Override public void stopAllTask() {                                                                           </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -    final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                                     </span>
<span class="-3279938674581626487" onmouseenter="enter('-3279938674581626487');" onmouseout="out('-3279938674581626487');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -    ariaManager.setCmd(CmdFactory.getInstance()                                                                   </span>
<span class="-124375894478059984" onmouseenter="enter('-124375894478059984');" onmouseout="out('-124375894478059984');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -        .createCmd(targetName, new DownloadTaskEntity(), CmdFactory.TASK_STOP_ALL)).exe();                        </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +    AriaManager.getInstance(AriaManager.APP)                                                                      </span>
<span class="-8662412021557476230" onmouseenter="enter('-8662412021557476230');" onmouseout="out('-8662412021557476230');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +        .setCmd(NormalCmdFactory.getInstance()                                                                    </span>
<span class="2753526899995092870" onmouseenter="enter('2753526899995092870');" onmouseout="out('2753526899995092870');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +            .createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_STOP_ALL))                     </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 178 +        .exe();                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179    }                                                                                                               </span>
<span  style=""> 180                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 181    /**                                                                                                             </span>
<span class="1311517946297423409" onmouseenter="enter('1311517946297423409');" onmouseout="out('1311517946297423409');" style=""> 182     * 恢复所有正在下载的任务                                                                                                  </span>
<span class="-4407894673997389754" onmouseenter="enter('-4407894673997389754');" onmouseout="out('-4407894673997389754');" style=""> 183     * 1.如果执行队列没有满，则开始下载任务，直到执行队列满                                                                                  </span>
<span class="-525289014070027486" onmouseenter="enter('-525289014070027486');" onmouseout="out('-525289014070027486');" style=""> 184     * 2.如果队列执行队列已经满了，则将所有任务添加到等待队列中                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 185     */                                                                                                             </span>
<span class="2382837737668558844" onmouseenter="enter('2382837737668558844');" onmouseout="out('2382837737668558844');" style=""> 186    public void resumeAllTask() {                                                                                   </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -    final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                                     </span>
<span class="-3279938674581626487" onmouseenter="enter('-3279938674581626487');" onmouseout="out('-3279938674581626487');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -    ariaManager.setCmd(CmdFactory.getInstance()                                                                   </span>
<span class="-5782153098770386278" onmouseenter="enter('-5782153098770386278');" onmouseout="out('-5782153098770386278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -        .createCmd(targetName, new DownloadTaskEntity(), CmdFactory.TASK_RESUME_ALL)).exe();                      </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 190 +    AriaManager.getInstance(AriaManager.APP)                                                                      </span>
<span class="-8662412021557476230" onmouseenter="enter('-8662412021557476230');" onmouseout="out('-8662412021557476230');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +        .setCmd(NormalCmdFactory.getInstance()                                                                    </span>
<span class="-6359175430758334480" onmouseenter="enter('-6359175430758334480');" onmouseout="out('-6359175430758334480');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 192 +            .createCmd(targetName, new DownloadTaskEntity(), NormalCmdFactory.TASK_RESUME_ALL))                   </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +        .exe();                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194    }                                                                                                               </span>
<span  style=""> 195                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 196    /**                                                                                                             </span>
<span class="-7338390600186437821" onmouseenter="enter('-7338390600186437821');" onmouseout="out('-7338390600186437821');" style=""> 197     * 删除所有任务                                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +   *                                                                                                              </span>
<span class="-325804075342723783" onmouseenter="enter('-325804075342723783');" onmouseout="out('-325804075342723783');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 199 +   * @param removeFile {@code true} 删除已经下载完成的任务，不仅删除下载记录，还会删除已经下载完成的文件，{@code false}                              </span>
<span class="-4045013558095481687" onmouseenter="enter('-4045013558095481687');" onmouseout="out('-4045013558095481687');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 200 +   * 如果文件已经下载完成，只删除下载记录                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 201     */                                                                                                             </span>
<span class="-1737930364576906321" onmouseenter="enter('-1737930364576906321');" onmouseout="out('-1737930364576906321');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -  @Override public void removeAllTask() {                                                                         </span>
<span class="5963878394412937684" onmouseenter="enter('5963878394412937684');" onmouseout="out('5963878394412937684');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 203 +  @Override public void removeAllTask(boolean removeFile) {                                                       </span>
<span class="-1602790229953823078" onmouseenter="enter('-1602790229953823078');" onmouseout="out('-1602790229953823078');" style=""> 204      final AriaManager ariaManager = AriaManager.getInstance(AriaManager.APP);                                     </span>
<span class="8569706088986467037" onmouseenter="enter('8569706088986467037');" onmouseout="out('8569706088986467037');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -    List&lt;DownloadEntity&gt; allEntity = DbEntity.findAllData(DownloadEntity.class);                                  </span>
<span class="-8362571003842902202" onmouseenter="enter('-8362571003842902202');" onmouseout="out('-8362571003842902202');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -    List&lt;AbsCmd&gt; cancelCmds = new ArrayList&lt;&gt;();                                                                  </span>
<span class="7270933921411644426" onmouseenter="enter('7270933921411644426');" onmouseout="out('7270933921411644426');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -    for (DownloadEntity entity : allEntity) {                                                                     </span>
<span class="-2596374898145490245" onmouseenter="enter('-2596374898145490245');" onmouseout="out('-2596374898145490245');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -      cancelCmds.add(                                                                                             </span>
<span class="-991582373137690263" onmouseenter="enter('-991582373137690263');" onmouseout="out('-991582373137690263');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -          CommonUtil.createCmd(targetName, new DownloadTaskEntity(entity), CmdFactory.TASK_CANCEL));              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -    }                                                                                                             </span>
<span class="6221331641879304576" onmouseenter="enter('6221331641879304576');" onmouseout="out('6221331641879304576');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -    ariaManager.setCmds(cancelCmds).exe();                                                                        </span>
<span class="-7859796608944545969" onmouseenter="enter('-7859796608944545969');" onmouseout="out('-7859796608944545969');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +    AriaManager.getInstance(AriaManager.APP)                                                                      </span>
<span class="-4817605631113220698" onmouseenter="enter('-4817605631113220698');" onmouseout="out('-4817605631113220698');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +        .setCmd(CommonUtil.createCmd(targetName, new DownloadTaskEntity(),                                        </span>
<span class="-5697611243738789926" onmouseenter="enter('-5697611243738789926');" onmouseout="out('-5697611243738789926');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +            NormalCmdFactory.TASK_CANCEL_ALL))                                                                    </span>
<span class="4364523834861304685" onmouseenter="enter('4364523834861304685');" onmouseout="out('4364523834861304685');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 215 +        .exe();                                                                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +                                                                                                                  </span>
<span class="6170682864485863774" onmouseenter="enter('6170682864485863774');" onmouseout="out('6170682864485863774');" style=""> 217      Set&lt;String&gt; keys = ariaManager.getReceiver().keySet();                                                        </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 218      for (String key : keys) {                                                                                     </span>
<span class="-467225363893902060" onmouseenter="enter('-467225363893902060');" onmouseout="out('-467225363893902060');" style=""> 219        IReceiver receiver = ariaManager.getReceiver().get(key);                                                    </span>
<span class="3799717368039523564" onmouseenter="enter('3799717368039523564');" onmouseout="out('3799717368039523564');" style=""> 220        receiver.removeSchedulerListener();                                                                         </span>
<span class="5986307215158803793" onmouseenter="enter('5986307215158803793');" onmouseout="out('5986307215158803793');" style=""> 221        receiver.unRegister();                                                                                      </span>
<span class="-4261055600814182440" onmouseenter="enter('-4261055600814182440');" onmouseout="out('-4261055600814182440');" style=""> 222        ariaManager.getReceiver().remove(key);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224    }                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            