<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>86</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    86
                    <a href="85.html">prev</a>
                    <a href="87.html">next</a>
                    <a href="86_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Automattic/simplenote-android_a379ea0cd268411774a28e2b9ec8b1dea1b5db3a_Simplenote/src/main/java/com/automattic/simplenote/utils/TagUtils.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;a379ea0cd268411774a28e2b9ec8b1dea1b5db3a:Simplenote/src/main/java/com/automattic/simplenote/utils/TagUtils.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;a379ea0cd268411774a28e2b9ec8b1dea1b5db3a^1:Simplenote/src/main/java/com/automattic/simplenote/utils/TagUtils.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;a379ea0cd268411774a28e2b9ec8b1dea1b5db3a^2:Simplenote/src/main/java/com/automattic/simplenote/utils/TagUtils.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;b31e76b78daf8eacff2d158fcf77dba40c44c20b:Simplenote/src/main/java/com/automattic/simplenote/utils/TagUtils.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-4228041758449221373" onmouseenter="enter('-4228041758449221373');" onmouseout="out('-4228041758449221373');" style="">   1 package com.automattic.simplenote.utils;                                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">   3 import android.util.Log;                                                                                 </span>
<span  style="">   4                                                                                                          </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">   5 import com.automattic.simplenote.models.Tag;                                                             </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">   6 import com.simperium.client.Bucket;                                                                      </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">   7 import com.simperium.client.BucketObjectMissingException;                                                </span>
<span class="-3142233007863984129" onmouseenter="enter('-3142233007863984129');" onmouseout="out('-3142233007863984129');" style="">   8 import com.simperium.client.BucketObjectNameInvalid;                                                     </span>
<span  style="">   9                                                                                                          </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  10 import java.io.UnsupportedEncodingException;                                                             </span>
<span class="302463665162759210" onmouseenter="enter('302463665162759210');" onmouseout="out('302463665162759210');" style="">  11 import java.net.URLEncoder;                                                                              </span>
<span class="-2624565711555737384" onmouseenter="enter('-2624565711555737384');" onmouseout="out('-2624565711555737384');" style="">  12 import java.nio.charset.StandardCharsets;                                                                </span>
<span class="1643854008646391422" onmouseenter="enter('1643854008646391422');" onmouseout="out('1643854008646391422');" style="">  13 import java.text.Normalizer;                                                                             </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  14 import java.util.Locale;                                                                                 </span>
<span  style="">  15                                                                                                          </span>
<span class="-1128522509845860150" onmouseenter="enter('-1128522509845860150');" onmouseout="out('-1128522509845860150');" style="">  16 public class TagUtils {                                                                                  </span>
<span class="-8759576399830854342" onmouseenter="enter('-8759576399830854342');" onmouseout="out('-8759576399830854342');" style="">  17     private static int MAXIMUM_LENGTH_ENCODED_HASH = 256;                                                </span>
<span  style="">  18                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  19     /**                                                                                                  </span>
<span class="-1412269536984484265" onmouseenter="enter('-1412269536984484265');" onmouseout="out('-1412269536984484265');" style="">  20      * Create a tag with the @param key and @param name in the @param bucket.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  21      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  22      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="1483566391602743876" onmouseenter="enter('1483566391602743876');" onmouseout="out('1483566391602743876');" style="">  23      * @param name      {@link String} to use as tag name.                                               </span>
<span class="6727814651609344167" onmouseenter="enter('6727814651609344167');" onmouseout="out('6727814651609344167');" style="">  24      * @param index     {@link int} to use as tag index.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  25      */                                                                                                  </span>
<span class="8747903455774861782" onmouseenter="enter('8747903455774861782');" onmouseout="out('8747903455774861782');" style=""><abbr title="  26     public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalid {">  26     public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  27         try {                                                                                            </span>
<span class="9216191153424566972" onmouseenter="enter('9216191153424566972');" onmouseout="out('9216191153424566972');" style="">  28             Tag tag = bucket.newObject(hashTag(name));                                                   </span>
<span class="7062856805755770087" onmouseenter="enter('7062856805755770087');" onmouseout="out('7062856805755770087');" style="">  29             tag.setName(name);                                                                           </span>
<span class="1241154828935735504" onmouseenter="enter('1241154828935735504');" onmouseout="out('1241154828935735504');" style="">  30             tag.setIndex(index);                                                                         </span>
<span class="-984333530129888175" onmouseenter="enter('-984333530129888175');" onmouseout="out('-984333530129888175');" style="">  31             tag.save();                                                                                  </span>
<span class="-1947392774679043932" onmouseenter="enter('-1947392774679043932');" onmouseout="out('-1947392774679043932');" style="">  32         } catch (BucketObjectNameInvalid e) {                                                            </span>
<span class="-8667743002495120657" onmouseenter="enter('-8667743002495120657');" onmouseout="out('-8667743002495120657');" style="">  33             Log.e(&quot;createTag&quot;, &quot;Could not create tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot;, e);                         </span>
<span class="-8098549490726146918" onmouseenter="enter('-8098549490726146918');" onmouseout="out('-8098549490726146918');" style="">  34             throw new BucketObjectNameInvalid(name);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  35         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  36     }                                                                                                    </span>
<span  style="">  37                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38     /**                                                                                                  </span>
<span class="2392397237022653325" onmouseenter="enter('2392397237022653325');" onmouseout="out('2392397237022653325');" style="">  39      * Create a tag the @param key and @param name in the @param bucket if it does not exist.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  40      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  41      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style="">  42      * @param name      {@link String} to use creating the tag.                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43      */                                                                                                  </span>
<span class="5504812218324751022" onmouseenter="enter('5504812218324751022');" onmouseout="out('5504812218324751022');" style=""><abbr title="  44     public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalid {">  44     public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalidðŸ”µ</abbr></span>
<span class="5015686068998267814" onmouseenter="enter('5015686068998267814');" onmouseout="out('5015686068998267814');" style="">  45         if (isTagMissing(bucket, name)) {                                                                </span>
<span class="-5507367490190149303" onmouseenter="enter('-5507367490190149303');" onmouseout="out('-5507367490190149303');" style="">  46             createTag(bucket, name, bucket.count());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  47         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  48     }                                                                                                    </span>
<span  style="">  49                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  50     /**                                                                                                  </span>
<span class="-7954620787131072644" onmouseenter="enter('-7954620787131072644');" onmouseout="out('-7954620787131072644');" style="">  51      * Get the canonical representation of a tag from the hashed value of the lexical variation.         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  52      *                                                                                                   </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  53      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                         </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  54      * @param lexical   {@link String} lexical variation of tag.                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  55      *                                                                                                   </span>
<span class="6994769969865688752" onmouseenter="enter('6994769969865688752');" onmouseout="out('6994769969865688752');" style="">  56      * @return          {@link String} canonical of tag if exists; lexical variation otherwise.          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57      */                                                                                                  </span>
<span class="3615339384736220797" onmouseenter="enter('3615339384736220797');" onmouseout="out('3615339384736220797');" style="">  58     public static String getCanonicalFromLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                   </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  59         String hashed = hashTag(lexical);                                                                </span>
<span  style="">  60                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  61         try {                                                                                            </span>
<span class="2049191054179030541" onmouseenter="enter('2049191054179030541');" onmouseout="out('2049191054179030541');" style="">  62             Tag tag = bucket.getObject(hashed);                                                          </span>
<span class="9102515807610881143" onmouseenter="enter('9102515807610881143');" onmouseout="out('9102515807610881143');" style="">  63             Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);             </span>
<span class="8026912047484491735" onmouseenter="enter('8026912047484491735');" onmouseout="out('8026912047484491735');" style="">  64             return tag.getName();                                                                        </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  65         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="837984383885487332" onmouseenter="enter('837984383885487332');" onmouseout="out('837984383885487332');" style="">  66             Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);         </span>
<span class="-543341485617227697" onmouseenter="enter('-543341485617227697');" onmouseout="out('-543341485617227697');" style="">  67             return lexical;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  68         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69     }                                                                                                    </span>
<span  style="">  70                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  71     /**                                                                                                  </span>
<span class="8524513986896116908" onmouseenter="enter('8524513986896116908');" onmouseout="out('8524513986896116908');" style="">  72      * A canonical representation of a tag exists from the hashed value of the lexical variation.        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  73      *                                                                                                   </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  74      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                         </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  75      * @param lexical   {@link String} lexical variation of tag.                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  76      *                                                                                                   </span>
<span class="-3904799022660837793" onmouseenter="enter('-3904799022660837793');" onmouseout="out('-3904799022660837793');" style="">  77      * @return          {@link Boolean} TRUE if canonical tag exists; FALSE otherwise.                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  78      */                                                                                                  </span>
<span class="-99796051801894615" onmouseenter="enter('-99796051801894615');" onmouseout="out('-99796051801894615');" style="">  79     public static boolean hasCanonicalOfLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                    </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  80         String hashed = hashTag(lexical);                                                                </span>
<span  style="">  81                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  82         try {                                                                                            </span>
<span class="9080528103180666416" onmouseenter="enter('9080528103180666416');" onmouseout="out('9080528103180666416');" style="">  83             bucket.getObject(hashed);                                                                    </span>
<span class="1920803171501308835" onmouseenter="enter('1920803171501308835');" onmouseout="out('1920803171501308835');" style="">  84             Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);               </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  85             return true;                                                                                 </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  86         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="515776657904866913" onmouseenter="enter('515776657904866913');" onmouseout="out('515776657904866913');" style="">  87             Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">  88             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90     }                                                                                                    </span>
<span  style="">  91                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  92     /**                                                                                                  </span>
<span class="7435699933451053654" onmouseenter="enter('7435699933451053654');" onmouseout="out('7435699933451053654');" style="">  93      * Hash the tag @param name with normalizing, lowercasing, and encoding.                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  94      *                                                                                                   </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style="">  95      * @param name      {@link String} to hash as the tag kay.                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  96      *                                                                                                   </span>
<span class="4943694139439122302" onmouseenter="enter('4943694139439122302');" onmouseout="out('4943694139439122302');" style="">  97      * @return          {@link String} hashed to use as tag key.                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  98      */                                                                                                  </span>
<span class="-3908749490287186730" onmouseenter="enter('-3908749490287186730');" onmouseout="out('-3908749490287186730');" style="">  99     public static String hashTag(String name) {                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 100         try {                                                                                            </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 101             String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                         </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 102             String lowercased = normalized.toLowerCase(Locale.US);                                       </span>
<span class="5745320295091512620" onmouseenter="enter('5745320295091512620');" onmouseout="out('5745320295091512620');" style=""> 103             String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name());               </span>
<span class="5822871577258993169" onmouseenter="enter('5822871577258993169');" onmouseout="out('5822871577258993169');" style=""> 104             return replaceEncoded(encoded);                                                              </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 105         } catch (UnsupportedEncodingException e) {                                                       </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 106             // TODO: Handle encoding exception with a custom UTF-8 encoder.                              </span>
<span class="-3727955329973069704" onmouseenter="enter('-3727955329973069704');" onmouseout="out('-3727955329973069704');" style=""> 107             return name;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109     }                                                                                                    </span>
<span  style=""> 110                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 111     /**                                                                                                  </span>
<span class="-7971737868796377532" onmouseenter="enter('-7971737868796377532');" onmouseout="out('-7971737868796377532');" style=""> 112      * Determine if the hashed tag @param name is valid after normalizing, lowercasing, and encoding.    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 113      *                                                                                                   </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style=""> 114      * @param name      {@link String} to hash as the tag kay.                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 115      *                                                                                                   </span>
<span class="7577525586581647458" onmouseenter="enter('7577525586581647458');" onmouseout="out('7577525586581647458');" style=""> 116      * @return          {@link boolean} true if hashed value is valid; false otherwise.                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 117      */                                                                                                  </span>
<span class="7745313155817491769" onmouseenter="enter('7745313155817491769');" onmouseout="out('7745313155817491769');" style=""> 118     public static boolean hashTagValid(String name) {                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 119         try {                                                                                            </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 120             String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                         </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 121             String lowercased = normalized.toLowerCase(Locale.US);                                       </span>
<span class="2872420892522440005" onmouseenter="enter('2872420892522440005');" onmouseout="out('2872420892522440005');" style=""><abbr title=" 122             String encoded = replaceEncoded(URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()));"> 122             String encoded = replaceEncoded(URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()))ðŸ”µ</abbr></span>
<span class="8567221967181029316" onmouseenter="enter('8567221967181029316');" onmouseout="out('8567221967181029316');" style=""> 123             return encoded.length() &lt;= MAXIMUM_LENGTH_ENCODED_HASH;                                      </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 124         } catch (UnsupportedEncodingException e) {                                                       </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 125             // TODO: Handle encoding exception with a custom UTF-8 encoder.                              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 126             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 130     /**                                                                                                  </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 131 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-3167749631394751426" onmouseenter="enter('-3167749631394751426');" onmouseout="out('-3167749631394751426');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132      * Determine if the tag with @param name is missing from @param bucket or not.                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 135      * @param name      {@link String} to use creating the tag.                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 136      *                                                                                                   </span>
<span class="3982193436933187611" onmouseenter="enter('3982193436933187611');" onmouseout="out('3982193436933187611');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 137      * @return          {@link Boolean} true if tag is missing; false otherwise.                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 138      */                                                                                                  </span>
<span class="-3086183887637415732" onmouseenter="enter('-3086183887637415732');" onmouseout="out('-3086183887637415732');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 139     public static boolean isTagMissing(Bucket&lt;Tag&gt; bucket, String name) {                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140         try {                                                                                            </span>
<span class="6887131945084192998" onmouseenter="enter('6887131945084192998');" onmouseout="out('6887131945084192998');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 141             bucket.getObject(hashTag(name));                                                             </span>
<span class="5313510975148768879" onmouseenter="enter('5313510975148768879');" onmouseout="out('5313510975148768879');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 142             Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; already exists&quot;);                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 143             return false;                                                                                </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="-4406715836082075739" onmouseenter="enter('-4406715836082075739');" onmouseout="out('-4406715836082075739');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145             Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; does not exist&quot;);                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 147         }                                                                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 148 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 151 =======                                                                                                  </span>
<span class="-339038258891723312" onmouseenter="enter('-339038258891723312');" onmouseout="out('-339038258891723312');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152      * Replace certain characters in @param encoded that were not encoded with encoded value.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153      *                                                                                                   </span>
<span class="-1936486022863977938" onmouseenter="enter('-1936486022863977938');" onmouseout="out('-1936486022863977938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154      * All &quot;+&quot; characters in a tag are encoded upstream and passed as &quot;%2B&quot; in {@param encoded}.         </span>
<span class="-4164453662286537621" onmouseenter="enter('-4164453662286537621');" onmouseout="out('-4164453662286537621');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155      * All &quot; &quot; characters in a tag are encoded upstream and passed as &quot;+&quot; in {@param encoded}.           </span>
<span class="-1577699597192556224" onmouseenter="enter('-1577699597192556224');" onmouseout="out('-1577699597192556224');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156      * Thus, all &quot;+&quot; in {@param encoded} should be replaced with &quot;%20&quot; as an encoded space.              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157      *                                                                                                   </span>
<span class="6678159147138687630" onmouseenter="enter('6678159147138687630');" onmouseout="out('6678159147138687630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158      * @param encoded   {@link String} to replace certain characters with encoded value.                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159      *                                                                                                   </span>
<span class="-2341289387672210523" onmouseenter="enter('-2341289387672210523');" onmouseout="out('-2341289387672210523');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160      * @return          {@link String} replaced characters with encoded values.                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161      */                                                                                                  </span>
<span class="-8944270830991439293" onmouseenter="enter('-8944270830991439293');" onmouseout="out('-8944270830991439293');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162     private static String replaceEncoded(String encoded) {                                               </span>
<span class="-1765823146320074002" onmouseenter="enter('-1765823146320074002');" onmouseout="out('-1765823146320074002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163         return encoded                                                                                   </span>
<span class="-3743019157832617127" onmouseenter="enter('-3743019157832617127');" onmouseout="out('-3743019157832617127');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164             .replace(&quot;+&quot;, &quot;%20&quot;)                                                                         </span>
<span class="-3338477209764874631" onmouseenter="enter('-3338477209764874631');" onmouseout="out('-3338477209764874631');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165             .replace(&quot;*&quot;, &quot;%2A&quot;)                                                                         </span>
<span class="-429073147476082560" onmouseenter="enter('-429073147476082560');" onmouseout="out('-429073147476082560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166             .replace(&quot;-&quot;, &quot;%2D&quot;)                                                                         </span>
<span class="-4659631057048750898" onmouseenter="enter('-4659631057048750898');" onmouseout="out('-4659631057048750898');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167             .replace(&quot;.&quot;, &quot;%2E&quot;)                                                                         </span>
<span class="7137732937458195694" onmouseenter="enter('7137732937458195694');" onmouseout="out('7137732937458195694');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168             .replace(&quot;_&quot;, &quot;%5F&quot;);                                                                        </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 169 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-4228041758449221373" onmouseenter="enter('-4228041758449221373');" onmouseout="out('-4228041758449221373');" style="">   1 package com.automattic.simplenote.utils;                                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">   3 import android.util.Log;                                                                                 </span>
<span  style="">   4                                                                                                          </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">   5 import com.automattic.simplenote.models.Tag;                                                             </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">   6 import com.simperium.client.Bucket;                                                                      </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">   7 import com.simperium.client.BucketObjectMissingException;                                                </span>
<span class="-3142233007863984129" onmouseenter="enter('-3142233007863984129');" onmouseout="out('-3142233007863984129');" style="">   8 import com.simperium.client.BucketObjectNameInvalid;                                                     </span>
<span  style="">   9                                                                                                          </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  10 import java.io.UnsupportedEncodingException;                                                             </span>
<span class="302463665162759210" onmouseenter="enter('302463665162759210');" onmouseout="out('302463665162759210');" style="">  11 import java.net.URLEncoder;                                                                              </span>
<span class="-2624565711555737384" onmouseenter="enter('-2624565711555737384');" onmouseout="out('-2624565711555737384');" style="">  12 import java.nio.charset.StandardCharsets;                                                                </span>
<span class="1643854008646391422" onmouseenter="enter('1643854008646391422');" onmouseout="out('1643854008646391422');" style="">  13 import java.text.Normalizer;                                                                             </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  14 import java.util.Locale;                                                                                 </span>
<span  style="">  15                                                                                                          </span>
<span class="-1128522509845860150" onmouseenter="enter('-1128522509845860150');" onmouseout="out('-1128522509845860150');" style="">  16 public class TagUtils {                                                                                  </span>
<span class="-8759576399830854342" onmouseenter="enter('-8759576399830854342');" onmouseout="out('-8759576399830854342');" style="">  17     private static int MAXIMUM_LENGTH_ENCODED_HASH = 256;                                                </span>
<span  style="">  18                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  19     /**                                                                                                  </span>
<span class="-1412269536984484265" onmouseenter="enter('-1412269536984484265');" onmouseout="out('-1412269536984484265');" style="">  20      * Create a tag with the @param key and @param name in the @param bucket.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  21      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  22      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="1483566391602743876" onmouseenter="enter('1483566391602743876');" onmouseout="out('1483566391602743876');" style="">  23      * @param name      {@link String} to use as tag name.                                               </span>
<span class="6727814651609344167" onmouseenter="enter('6727814651609344167');" onmouseout="out('6727814651609344167');" style="">  24      * @param index     {@link int} to use as tag index.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  25      */                                                                                                  </span>
<span class="8747903455774861782" onmouseenter="enter('8747903455774861782');" onmouseout="out('8747903455774861782');" style=""><abbr title="  26     public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalid {">  26     public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  27         try {                                                                                            </span>
<span class="9216191153424566972" onmouseenter="enter('9216191153424566972');" onmouseout="out('9216191153424566972');" style="">  28             Tag tag = bucket.newObject(hashTag(name));                                                   </span>
<span class="7062856805755770087" onmouseenter="enter('7062856805755770087');" onmouseout="out('7062856805755770087');" style="">  29             tag.setName(name);                                                                           </span>
<span class="1241154828935735504" onmouseenter="enter('1241154828935735504');" onmouseout="out('1241154828935735504');" style="">  30             tag.setIndex(index);                                                                         </span>
<span class="-984333530129888175" onmouseenter="enter('-984333530129888175');" onmouseout="out('-984333530129888175');" style="">  31             tag.save();                                                                                  </span>
<span class="-1947392774679043932" onmouseenter="enter('-1947392774679043932');" onmouseout="out('-1947392774679043932');" style="">  32         } catch (BucketObjectNameInvalid e) {                                                            </span>
<span class="-8667743002495120657" onmouseenter="enter('-8667743002495120657');" onmouseout="out('-8667743002495120657');" style="">  33             Log.e(&quot;createTag&quot;, &quot;Could not create tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot;, e);                         </span>
<span class="-8098549490726146918" onmouseenter="enter('-8098549490726146918');" onmouseout="out('-8098549490726146918');" style="">  34             throw new BucketObjectNameInvalid(name);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  35         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  36     }                                                                                                    </span>
<span  style="">  37                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38     /**                                                                                                  </span>
<span class="2392397237022653325" onmouseenter="enter('2392397237022653325');" onmouseout="out('2392397237022653325');" style="">  39      * Create a tag the @param key and @param name in the @param bucket if it does not exist.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  40      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  41      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style="">  42      * @param name      {@link String} to use creating the tag.                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43      */                                                                                                  </span>
<span class="5504812218324751022" onmouseenter="enter('5504812218324751022');" onmouseout="out('5504812218324751022');" style=""><abbr title="  44     public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalid {">  44     public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalidðŸ”µ</abbr></span>
<span class="5015686068998267814" onmouseenter="enter('5015686068998267814');" onmouseout="out('5015686068998267814');" style="">  45         if (isTagMissing(bucket, name)) {                                                                </span>
<span class="-5507367490190149303" onmouseenter="enter('-5507367490190149303');" onmouseout="out('-5507367490190149303');" style="">  46             createTag(bucket, name, bucket.count());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  47         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  48     }                                                                                                    </span>
<span  style="">  49                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  50     /**                                                                                                  </span>
<span class="-7954620787131072644" onmouseenter="enter('-7954620787131072644');" onmouseout="out('-7954620787131072644');" style="">  51      * Get the canonical representation of a tag from the hashed value of the lexical variation.         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  52      *                                                                                                   </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  53      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                         </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  54      * @param lexical   {@link String} lexical variation of tag.                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  55      *                                                                                                   </span>
<span class="6994769969865688752" onmouseenter="enter('6994769969865688752');" onmouseout="out('6994769969865688752');" style="">  56      * @return          {@link String} canonical of tag if exists; lexical variation otherwise.          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57      */                                                                                                  </span>
<span class="3615339384736220797" onmouseenter="enter('3615339384736220797');" onmouseout="out('3615339384736220797');" style="">  58     public static String getCanonicalFromLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                   </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  59         String hashed = hashTag(lexical);                                                                </span>
<span  style="">  60                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  61         try {                                                                                            </span>
<span class="2049191054179030541" onmouseenter="enter('2049191054179030541');" onmouseout="out('2049191054179030541');" style="">  62             Tag tag = bucket.getObject(hashed);                                                          </span>
<span class="9102515807610881143" onmouseenter="enter('9102515807610881143');" onmouseout="out('9102515807610881143');" style="">  63             Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);             </span>
<span class="8026912047484491735" onmouseenter="enter('8026912047484491735');" onmouseout="out('8026912047484491735');" style="">  64             return tag.getName();                                                                        </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  65         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="837984383885487332" onmouseenter="enter('837984383885487332');" onmouseout="out('837984383885487332');" style="">  66             Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);         </span>
<span class="-543341485617227697" onmouseenter="enter('-543341485617227697');" onmouseout="out('-543341485617227697');" style="">  67             return lexical;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  68         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69     }                                                                                                    </span>
<span  style="">  70                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  71     /**                                                                                                  </span>
<span class="8524513986896116908" onmouseenter="enter('8524513986896116908');" onmouseout="out('8524513986896116908');" style="">  72      * A canonical representation of a tag exists from the hashed value of the lexical variation.        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  73      *                                                                                                   </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  74      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                         </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  75      * @param lexical   {@link String} lexical variation of tag.                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  76      *                                                                                                   </span>
<span class="-3904799022660837793" onmouseenter="enter('-3904799022660837793');" onmouseout="out('-3904799022660837793');" style="">  77      * @return          {@link Boolean} TRUE if canonical tag exists; FALSE otherwise.                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  78      */                                                                                                  </span>
<span class="-99796051801894615" onmouseenter="enter('-99796051801894615');" onmouseout="out('-99796051801894615');" style="">  79     public static boolean hasCanonicalOfLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                    </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  80         String hashed = hashTag(lexical);                                                                </span>
<span  style="">  81                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  82         try {                                                                                            </span>
<span class="9080528103180666416" onmouseenter="enter('9080528103180666416');" onmouseout="out('9080528103180666416');" style="">  83             bucket.getObject(hashed);                                                                    </span>
<span class="1920803171501308835" onmouseenter="enter('1920803171501308835');" onmouseout="out('1920803171501308835');" style="">  84             Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);               </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  85             return true;                                                                                 </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  86         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="515776657904866913" onmouseenter="enter('515776657904866913');" onmouseout="out('515776657904866913');" style="">  87             Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">  88             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90     }                                                                                                    </span>
<span  style="">  91                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  92     /**                                                                                                  </span>
<span class="7435699933451053654" onmouseenter="enter('7435699933451053654');" onmouseout="out('7435699933451053654');" style="">  93      * Hash the tag @param name with normalizing, lowercasing, and encoding.                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  94      *                                                                                                   </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style="">  95      * @param name      {@link String} to hash as the tag kay.                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  96      *                                                                                                   </span>
<span class="4943694139439122302" onmouseenter="enter('4943694139439122302');" onmouseout="out('4943694139439122302');" style="">  97      * @return          {@link String} hashed to use as tag key.                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  98      */                                                                                                  </span>
<span class="-3908749490287186730" onmouseenter="enter('-3908749490287186730');" onmouseout="out('-3908749490287186730');" style="">  99     public static String hashTag(String name) {                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 100         try {                                                                                            </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 101             String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                         </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 102             String lowercased = normalized.toLowerCase(Locale.US);                                       </span>
<span class="5745320295091512620" onmouseenter="enter('5745320295091512620');" onmouseout="out('5745320295091512620');" style=""> 103             String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name());               </span>
<span class="5822871577258993169" onmouseenter="enter('5822871577258993169');" onmouseout="out('5822871577258993169');" style=""> 104             return replaceEncoded(encoded);                                                              </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 105         } catch (UnsupportedEncodingException e) {                                                       </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 106             // TODO: Handle encoding exception with a custom UTF-8 encoder.                              </span>
<span class="-3727955329973069704" onmouseenter="enter('-3727955329973069704');" onmouseout="out('-3727955329973069704');" style=""> 107             return name;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109     }                                                                                                    </span>
<span  style=""> 110                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 111     /**                                                                                                  </span>
<span class="-7971737868796377532" onmouseenter="enter('-7971737868796377532');" onmouseout="out('-7971737868796377532');" style=""> 112      * Determine if the hashed tag @param name is valid after normalizing, lowercasing, and encoding.    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 113      *                                                                                                   </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style=""> 114      * @param name      {@link String} to hash as the tag kay.                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 115      *                                                                                                   </span>
<span class="7577525586581647458" onmouseenter="enter('7577525586581647458');" onmouseout="out('7577525586581647458');" style=""> 116      * @return          {@link boolean} true if hashed value is valid; false otherwise.                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 117      */                                                                                                  </span>
<span class="7745313155817491769" onmouseenter="enter('7745313155817491769');" onmouseout="out('7745313155817491769');" style=""> 118     public static boolean hashTagValid(String name) {                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 119         try {                                                                                            </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 120             String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                         </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 121             String lowercased = normalized.toLowerCase(Locale.US);                                       </span>
<span class="2872420892522440005" onmouseenter="enter('2872420892522440005');" onmouseout="out('2872420892522440005');" style=""><abbr title=" 122             String encoded = replaceEncoded(URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()));"> 122             String encoded = replaceEncoded(URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()))ðŸ”µ</abbr></span>
<span class="8567221967181029316" onmouseenter="enter('8567221967181029316');" onmouseout="out('8567221967181029316');" style=""> 123             return encoded.length() &lt;= MAXIMUM_LENGTH_ENCODED_HASH;                                      </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 124         } catch (UnsupportedEncodingException e) {                                                       </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 125             // TODO: Handle encoding exception with a custom UTF-8 encoder.                              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 126             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 130     /**                                                                                                  </span>
<span class="-3167749631394751426" onmouseenter="enter('-3167749631394751426');" onmouseout="out('-3167749631394751426');" style=""> 131      * Determine if the tag with @param name is missing from @param bucket or not.                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 132      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style=""> 133      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style=""> 134      * @param name      {@link String} to use creating the tag.                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 135      *                                                                                                   </span>
<span class="3982193436933187611" onmouseenter="enter('3982193436933187611');" onmouseout="out('3982193436933187611');" style=""> 136      * @return          {@link Boolean} true if tag is missing; false otherwise.                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 137      */                                                                                                  </span>
<span class="-3086183887637415732" onmouseenter="enter('-3086183887637415732');" onmouseout="out('-3086183887637415732');" style=""> 138     public static boolean isTagMissing(Bucket&lt;Tag&gt; bucket, String name) {                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 139         try {                                                                                            </span>
<span class="6887131945084192998" onmouseenter="enter('6887131945084192998');" onmouseout="out('6887131945084192998');" style=""> 140             bucket.getObject(hashTag(name));                                                             </span>
<span class="5313510975148768879" onmouseenter="enter('5313510975148768879');" onmouseout="out('5313510975148768879');" style=""> 141             Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; already exists&quot;);                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 142             return false;                                                                                </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 143         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="-4406715836082075739" onmouseenter="enter('-4406715836082075739');" onmouseout="out('-4406715836082075739');" style=""> 144             Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; does not exist&quot;);                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 145             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147     }                                                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 149     /**                                                                                                  </span>
<span class="-339038258891723312" onmouseenter="enter('-339038258891723312');" onmouseout="out('-339038258891723312');" style=""> 150      * Replace certain characters in @param encoded that were not encoded with encoded value.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 151      *                                                                                                   </span>
<span class="-1936486022863977938" onmouseenter="enter('-1936486022863977938');" onmouseout="out('-1936486022863977938');" style=""> 152      * All &quot;+&quot; characters in a tag are encoded upstream and passed as &quot;%2B&quot; in {@param encoded}.         </span>
<span class="-4164453662286537621" onmouseenter="enter('-4164453662286537621');" onmouseout="out('-4164453662286537621');" style=""> 153      * All &quot; &quot; characters in a tag are encoded upstream and passed as &quot;+&quot; in {@param encoded}.           </span>
<span class="-1577699597192556224" onmouseenter="enter('-1577699597192556224');" onmouseout="out('-1577699597192556224');" style=""> 154      * Thus, all &quot;+&quot; in {@param encoded} should be replaced with &quot;%20&quot; as an encoded space.              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 155      *                                                                                                   </span>
<span class="6678159147138687630" onmouseenter="enter('6678159147138687630');" onmouseout="out('6678159147138687630');" style=""> 156      * @param encoded   {@link String} to replace certain characters with encoded value.                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 157      *                                                                                                   </span>
<span class="-2341289387672210523" onmouseenter="enter('-2341289387672210523');" onmouseout="out('-2341289387672210523');" style=""> 158      * @return          {@link String} replaced characters with encoded values.                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 159      */                                                                                                  </span>
<span class="-8944270830991439293" onmouseenter="enter('-8944270830991439293');" onmouseout="out('-8944270830991439293');" style=""> 160     private static String replaceEncoded(String encoded) {                                               </span>
<span class="-1765823146320074002" onmouseenter="enter('-1765823146320074002');" onmouseout="out('-1765823146320074002');" style=""> 161         return encoded                                                                                   </span>
<span class="-3743019157832617127" onmouseenter="enter('-3743019157832617127');" onmouseout="out('-3743019157832617127');" style=""> 162             .replace(&quot;+&quot;, &quot;%20&quot;)                                                                         </span>
<span class="-3338477209764874631" onmouseenter="enter('-3338477209764874631');" onmouseout="out('-3338477209764874631');" style=""> 163             .replace(&quot;*&quot;, &quot;%2A&quot;)                                                                         </span>
<span class="-429073147476082560" onmouseenter="enter('-429073147476082560');" onmouseout="out('-429073147476082560');" style=""> 164             .replace(&quot;-&quot;, &quot;%2D&quot;)                                                                         </span>
<span class="-4659631057048750898" onmouseenter="enter('-4659631057048750898');" onmouseout="out('-4659631057048750898');" style=""> 165             .replace(&quot;.&quot;, &quot;%2E&quot;)                                                                         </span>
<span class="7137732937458195694" onmouseenter="enter('7137732937458195694');" onmouseout="out('7137732937458195694');" style=""> 166             .replace(&quot;_&quot;, &quot;%5F&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168 }                                                                                                        </span>

</pre></td>
                            <td><pre><span class="-4228041758449221373" onmouseenter="enter('-4228041758449221373');" onmouseout="out('-4228041758449221373');" style="">   1 package com.automattic.simplenote.utils;                                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">   3 import android.util.Log;                                                                                 </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">   4 import com.automattic.simplenote.models.Tag;                                                             </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">   5 import com.simperium.client.Bucket;                                                                      </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">   6 import com.simperium.client.BucketObjectMissingException;                                                </span>
<span class="-3142233007863984129" onmouseenter="enter('-3142233007863984129');" onmouseout="out('-3142233007863984129');" style="">   7 import com.simperium.client.BucketObjectNameInvalid;                                                     </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">   8 import java.io.UnsupportedEncodingException;                                                             </span>
<span class="302463665162759210" onmouseenter="enter('302463665162759210');" onmouseout="out('302463665162759210');" style="">   9 import java.net.URLEncoder;                                                                              </span>
<span class="-2624565711555737384" onmouseenter="enter('-2624565711555737384');" onmouseout="out('-2624565711555737384');" style="">  10 import java.nio.charset.StandardCharsets;                                                                </span>
<span class="1643854008646391422" onmouseenter="enter('1643854008646391422');" onmouseout="out('1643854008646391422');" style="">  11 import java.text.Normalizer;                                                                             </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  12 import java.util.Locale;                                                                                 </span>
<span  style="">  13                                                                                                          </span>
<span  style="">  14                                                                                                          </span>
<span class="-1128522509845860150" onmouseenter="enter('-1128522509845860150');" onmouseout="out('-1128522509845860150');" style="">  15 public class TagUtils {                                                                                  </span>
<span class="-8759576399830854342" onmouseenter="enter('-8759576399830854342');" onmouseout="out('-8759576399830854342');" style="">  16     private static int MAXIMUM_LENGTH_ENCODED_HASH = 256;                                                </span>
<span  style="">  17                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  18     /**                                                                                                  </span>
<span class="-1412269536984484265" onmouseenter="enter('-1412269536984484265');" onmouseout="out('-1412269536984484265');" style="">  19      * Create a tag with the @param key and @param name in the @param bucket.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  20      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  21      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="1483566391602743876" onmouseenter="enter('1483566391602743876');" onmouseout="out('1483566391602743876');" style="">  22      * @param name      {@link String} to use as tag name.                                               </span>
<span class="6727814651609344167" onmouseenter="enter('6727814651609344167');" onmouseout="out('6727814651609344167');" style="">  23      * @param index     {@link int} to use as tag index.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  24      */                                                                                                  </span>
<span class="8747903455774861782" onmouseenter="enter('8747903455774861782');" onmouseout="out('8747903455774861782');" style=""><abbr title="  25     public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalid {">  25     public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  26         try {                                                                                            </span>
<span class="9216191153424566972" onmouseenter="enter('9216191153424566972');" onmouseout="out('9216191153424566972');" style="">  27             Tag tag = bucket.newObject(hashTag(name));                                                   </span>
<span class="7062856805755770087" onmouseenter="enter('7062856805755770087');" onmouseout="out('7062856805755770087');" style="">  28             tag.setName(name);                                                                           </span>
<span class="1241154828935735504" onmouseenter="enter('1241154828935735504');" onmouseout="out('1241154828935735504');" style="">  29             tag.setIndex(index);                                                                         </span>
<span class="-984333530129888175" onmouseenter="enter('-984333530129888175');" onmouseout="out('-984333530129888175');" style="">  30             tag.save();                                                                                  </span>
<span class="-1947392774679043932" onmouseenter="enter('-1947392774679043932');" onmouseout="out('-1947392774679043932');" style="">  31         } catch (BucketObjectNameInvalid e) {                                                            </span>
<span class="-8667743002495120657" onmouseenter="enter('-8667743002495120657');" onmouseout="out('-8667743002495120657');" style="">  32             Log.e(&quot;createTag&quot;, &quot;Could not create tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot;, e);                         </span>
<span class="-8098549490726146918" onmouseenter="enter('-8098549490726146918');" onmouseout="out('-8098549490726146918');" style="">  33             throw new BucketObjectNameInvalid(name);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  34         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  35     }                                                                                                    </span>
<span  style="">  36                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  37     /**                                                                                                  </span>
<span class="2392397237022653325" onmouseenter="enter('2392397237022653325');" onmouseout="out('2392397237022653325');" style="">  38      * Create a tag the @param key and @param name in the @param bucket if it does not exist.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  39      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  40      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style="">  41      * @param name      {@link String} to use creating the tag.                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  42      */                                                                                                  </span>
<span class="5504812218324751022" onmouseenter="enter('5504812218324751022');" onmouseout="out('5504812218324751022');" style=""><abbr title="  43     public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalid {">  43     public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalidðŸ”µ</abbr></span>
<span class="5015686068998267814" onmouseenter="enter('5015686068998267814');" onmouseout="out('5015686068998267814');" style="">  44         if (isTagMissing(bucket, name)) {                                                                </span>
<span class="-5507367490190149303" onmouseenter="enter('-5507367490190149303');" onmouseout="out('-5507367490190149303');" style="">  45             createTag(bucket, name, bucket.count());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  46         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  47     }                                                                                                    </span>
<span  style="">  48                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  49     /**                                                                                                  </span>
<span class="-7954620787131072644" onmouseenter="enter('-7954620787131072644');" onmouseout="out('-7954620787131072644');" style="">  50      * Get the canonical representation of a tag from the hashed value of the lexical variation.         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  51      *                                                                                                   </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  52      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                         </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  53      * @param lexical   {@link String} lexical variation of tag.                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  54      *                                                                                                   </span>
<span class="6994769969865688752" onmouseenter="enter('6994769969865688752');" onmouseout="out('6994769969865688752');" style="">  55      * @return          {@link String} canonical of tag if exists; lexical variation otherwise.          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  56      */                                                                                                  </span>
<span class="3615339384736220797" onmouseenter="enter('3615339384736220797');" onmouseout="out('3615339384736220797');" style="">  57     public static String getCanonicalFromLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                   </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  58         String hashed = hashTag(lexical);                                                                </span>
<span  style="">  59                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  60         try {                                                                                            </span>
<span class="2049191054179030541" onmouseenter="enter('2049191054179030541');" onmouseout="out('2049191054179030541');" style="">  61             Tag tag = bucket.getObject(hashed);                                                          </span>
<span class="9102515807610881143" onmouseenter="enter('9102515807610881143');" onmouseout="out('9102515807610881143');" style="">  62             Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);             </span>
<span class="8026912047484491735" onmouseenter="enter('8026912047484491735');" onmouseout="out('8026912047484491735');" style="">  63             return tag.getName();                                                                        </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  64         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="837984383885487332" onmouseenter="enter('837984383885487332');" onmouseout="out('837984383885487332');" style="">  65             Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);         </span>
<span class="-543341485617227697" onmouseenter="enter('-543341485617227697');" onmouseout="out('-543341485617227697');" style="">  66             return lexical;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  68     }                                                                                                    </span>
<span  style="">  69                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  70     /**                                                                                                  </span>
<span class="8524513986896116908" onmouseenter="enter('8524513986896116908');" onmouseout="out('8524513986896116908');" style="">  71      * A canonical representation of a tag exists from the hashed value of the lexical variation.        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  72      *                                                                                                   </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  73      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                         </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  74      * @param lexical   {@link String} lexical variation of tag.                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  75      *                                                                                                   </span>
<span class="-3904799022660837793" onmouseenter="enter('-3904799022660837793');" onmouseout="out('-3904799022660837793');" style="">  76      * @return          {@link Boolean} TRUE if canonical tag exists; FALSE otherwise.                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  77      */                                                                                                  </span>
<span class="-99796051801894615" onmouseenter="enter('-99796051801894615');" onmouseout="out('-99796051801894615');" style="">  78     public static boolean hasCanonicalOfLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                    </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  79         String hashed = hashTag(lexical);                                                                </span>
<span  style="">  80                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  81         try {                                                                                            </span>
<span class="9080528103180666416" onmouseenter="enter('9080528103180666416');" onmouseout="out('9080528103180666416');" style="">  82             bucket.getObject(hashed);                                                                    </span>
<span class="1920803171501308835" onmouseenter="enter('1920803171501308835');" onmouseout="out('1920803171501308835');" style="">  83             Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);               </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  84             return true;                                                                                 </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  85         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="515776657904866913" onmouseenter="enter('515776657904866913');" onmouseout="out('515776657904866913');" style="">  86             Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">  87             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89     }                                                                                                    </span>
<span  style="">  90                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  91     /**                                                                                                  </span>
<span class="7435699933451053654" onmouseenter="enter('7435699933451053654');" onmouseout="out('7435699933451053654');" style="">  92      * Hash the tag @param name with normalizing, lowercasing, and encoding.                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  93      *                                                                                                   </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style="">  94      * @param name      {@link String} to hash as the tag kay.                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  95      *                                                                                                   </span>
<span class="4943694139439122302" onmouseenter="enter('4943694139439122302');" onmouseout="out('4943694139439122302');" style="">  96      * @return          {@link String} hashed to use as tag key.                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  97      */                                                                                                  </span>
<span class="-3908749490287186730" onmouseenter="enter('-3908749490287186730');" onmouseout="out('-3908749490287186730');" style="">  98     public static String hashTag(String name) {                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  99         try {                                                                                            </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 100             String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                         </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 101             String lowercased = normalized.toLowerCase(Locale.US);                                       </span>
<span class="5745320295091512620" onmouseenter="enter('5745320295091512620');" onmouseout="out('5745320295091512620');" style=""> 102             String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name());               </span>
<span class="5822871577258993169" onmouseenter="enter('5822871577258993169');" onmouseout="out('5822871577258993169');" style=""> 103             return replaceEncoded(encoded);                                                              </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 104         } catch (UnsupportedEncodingException e) {                                                       </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 105             // TODO: Handle encoding exception with a custom UTF-8 encoder.                              </span>
<span class="-3727955329973069704" onmouseenter="enter('-3727955329973069704');" onmouseout="out('-3727955329973069704');" style=""> 106             return name;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 110     /**                                                                                                  </span>
<span class="-7971737868796377532" onmouseenter="enter('-7971737868796377532');" onmouseout="out('-7971737868796377532');" style=""> 111      * Determine if the hashed tag @param name is valid after normalizing, lowercasing, and encoding.    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 112      *                                                                                                   </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style=""> 113      * @param name      {@link String} to hash as the tag kay.                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 114      *                                                                                                   </span>
<span class="7577525586581647458" onmouseenter="enter('7577525586581647458');" onmouseout="out('7577525586581647458');" style=""> 115      * @return          {@link boolean} true if hashed value is valid; false otherwise.                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 116      */                                                                                                  </span>
<span class="7745313155817491769" onmouseenter="enter('7745313155817491769');" onmouseout="out('7745313155817491769');" style=""> 117     public static boolean hashTagValid(String name) {                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 118         try {                                                                                            </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 119             String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                         </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 120             String lowercased = normalized.toLowerCase(Locale.US);                                       </span>
<span class="2872420892522440005" onmouseenter="enter('2872420892522440005');" onmouseout="out('2872420892522440005');" style=""><abbr title=" 121             String encoded = replaceEncoded(URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()));"> 121             String encoded = replaceEncoded(URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()))ðŸ”µ</abbr></span>
<span class="8567221967181029316" onmouseenter="enter('8567221967181029316');" onmouseout="out('8567221967181029316');" style=""> 122             return encoded.length() &lt;= MAXIMUM_LENGTH_ENCODED_HASH;                                      </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 123         } catch (UnsupportedEncodingException e) {                                                       </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 124             // TODO: Handle encoding exception with a custom UTF-8 encoder.                              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 125             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 129     /**                                                                                                  </span>
<span class="-3167749631394751426" onmouseenter="enter('-3167749631394751426');" onmouseout="out('-3167749631394751426');" style=""> 130      * Determine if the tag with @param name is missing from @param bucket or not.                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 131      *                                                                                                   </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style=""> 132      * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                  </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style=""> 133      * @param name      {@link String} to use creating the tag.                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 134      *                                                                                                   </span>
<span class="3982193436933187611" onmouseenter="enter('3982193436933187611');" onmouseout="out('3982193436933187611');" style=""> 135      * @return          {@link Boolean} true if tag is missing; false otherwise.                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 136      */                                                                                                  </span>
<span class="-3086183887637415732" onmouseenter="enter('-3086183887637415732');" onmouseout="out('-3086183887637415732');" style=""> 137     public static boolean isTagMissing(Bucket&lt;Tag&gt; bucket, String name) {                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 138         try {                                                                                            </span>
<span class="6887131945084192998" onmouseenter="enter('6887131945084192998');" onmouseout="out('6887131945084192998');" style=""> 139             bucket.getObject(hashTag(name));                                                             </span>
<span class="-5371889370518325343" onmouseenter="enter('-5371889370518325343');" onmouseout="out('-5371889370518325343');" style=""> 140             Log.d(&quot;createTagIfMissing&quot;, (((&quot;Tag &quot; + &quot;\&quot;&quot;) + name) + &quot;\&quot;&quot;) + &quot; already exists&quot;);          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 141             return false;                                                                                </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 142         } catch (BucketObjectMissingException e) {                                                       </span>
<span class="-2242524591460624762" onmouseenter="enter('-2242524591460624762');" onmouseout="out('-2242524591460624762');" style=""> 143             Log.d(&quot;createTagIfMissing&quot;, (((&quot;Tag &quot; + &quot;\&quot;&quot;) + name) + &quot;\&quot;&quot;) + &quot; does not exist&quot;);          </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 144             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146     }                                                                                                    </span>
<span  style=""> 147                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 148     /**                                                                                                  </span>
<span class="-339038258891723312" onmouseenter="enter('-339038258891723312');" onmouseout="out('-339038258891723312');" style=""> 149      * Replace certain characters in @param encoded that were not encoded with encoded value.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 150      *                                                                                                   </span>
<span class="-1936486022863977938" onmouseenter="enter('-1936486022863977938');" onmouseout="out('-1936486022863977938');" style=""> 151      * All &quot;+&quot; characters in a tag are encoded upstream and passed as &quot;%2B&quot; in {@param encoded}.         </span>
<span class="-4164453662286537621" onmouseenter="enter('-4164453662286537621');" onmouseout="out('-4164453662286537621');" style=""> 152      * All &quot; &quot; characters in a tag are encoded upstream and passed as &quot;+&quot; in {@param encoded}.           </span>
<span class="-1577699597192556224" onmouseenter="enter('-1577699597192556224');" onmouseout="out('-1577699597192556224');" style=""> 153      * Thus, all &quot;+&quot; in {@param encoded} should be replaced with &quot;%20&quot; as an encoded space.              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 154      *                                                                                                   </span>
<span class="6678159147138687630" onmouseenter="enter('6678159147138687630');" onmouseout="out('6678159147138687630');" style=""> 155      * @param encoded   {@link String} to replace certain characters with encoded value.                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 156      *                                                                                                   </span>
<span class="-2341289387672210523" onmouseenter="enter('-2341289387672210523');" onmouseout="out('-2341289387672210523');" style=""> 157      * @return          {@link String} replaced characters with encoded values.                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 158      */                                                                                                  </span>
<span class="-8944270830991439293" onmouseenter="enter('-8944270830991439293');" onmouseout="out('-8944270830991439293');" style=""> 159     private static String replaceEncoded(String encoded) {                                               </span>
<span class="-1765823146320074002" onmouseenter="enter('-1765823146320074002');" onmouseout="out('-1765823146320074002');" style=""> 160         return encoded                                                                                   </span>
<span class="-3743019157832617127" onmouseenter="enter('-3743019157832617127');" onmouseout="out('-3743019157832617127');" style=""> 161             .replace(&quot;+&quot;, &quot;%20&quot;)                                                                         </span>
<span class="-3338477209764874631" onmouseenter="enter('-3338477209764874631');" onmouseout="out('-3338477209764874631');" style=""> 162             .replace(&quot;*&quot;, &quot;%2A&quot;)                                                                         </span>
<span class="-429073147476082560" onmouseenter="enter('-429073147476082560');" onmouseout="out('-429073147476082560');" style=""> 163             .replace(&quot;-&quot;, &quot;%2D&quot;)                                                                         </span>
<span class="-4659631057048750898" onmouseenter="enter('-4659631057048750898');" onmouseout="out('-4659631057048750898');" style=""> 164             .replace(&quot;.&quot;, &quot;%2E&quot;)                                                                         </span>
<span class="7137732937458195694" onmouseenter="enter('7137732937458195694');" onmouseout="out('7137732937458195694');" style=""> 165             .replace(&quot;_&quot;, &quot;%5F&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167 }                                                                                                        </span>


</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-4228041758449221373" onmouseenter="enter('-4228041758449221373');" onmouseout="out('-4228041758449221373');" style="">   1  package com.automattic.simplenote.utils;                                                                          </span>
<span  style="">   2                                                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">   3  import android.util.Log;                                                                                          </span>
<span  style="">   4                                                                                                                    </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">   5  import com.automattic.simplenote.models.Tag;                                                                      </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">   6  import com.simperium.client.Bucket;                                                                               </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">   7  import com.simperium.client.BucketObjectMissingException;                                                         </span>
<span class="-3142233007863984129" onmouseenter="enter('-3142233007863984129');" onmouseout="out('-3142233007863984129');" style="">   8  import com.simperium.client.BucketObjectNameInvalid;                                                              </span>
<span  style="">   9                                                                                                                    </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  10  import java.io.UnsupportedEncodingException;                                                                      </span>
<span class="302463665162759210" onmouseenter="enter('302463665162759210');" onmouseout="out('302463665162759210');" style="">  11  import java.net.URLEncoder;                                                                                       </span>
<span class="-2624565711555737384" onmouseenter="enter('-2624565711555737384');" onmouseout="out('-2624565711555737384');" style="">  12  import java.nio.charset.StandardCharsets;                                                                         </span>
<span class="1643854008646391422" onmouseenter="enter('1643854008646391422');" onmouseout="out('1643854008646391422');" style="">  13  import java.text.Normalizer;                                                                                      </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  14  import java.util.Locale;                                                                                          </span>
<span  style="">  15                                                                                                                    </span>
<span class="-1128522509845860150" onmouseenter="enter('-1128522509845860150');" onmouseout="out('-1128522509845860150');" style="">  16  public class TagUtils {                                                                                           </span>
<span class="-8759576399830854342" onmouseenter="enter('-8759576399830854342');" onmouseout="out('-8759576399830854342');" style="">  17      private static int MAXIMUM_LENGTH_ENCODED_HASH = 256;                                                         </span>
<span  style="">  18                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  19      /**                                                                                                           </span>
<span class="-1412269536984484265" onmouseenter="enter('-1412269536984484265');" onmouseout="out('-1412269536984484265');" style="">  20       * Create a tag with the @param key and @param name in the @param bucket.                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  21       *                                                                                                            </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  22       * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                           </span>
<span class="1483566391602743876" onmouseenter="enter('1483566391602743876');" onmouseout="out('1483566391602743876');" style="">  23       * @param name      {@link String} to use as tag name.                                                        </span>
<span class="6727814651609344167" onmouseenter="enter('6727814651609344167');" onmouseout="out('6727814651609344167');" style="">  24       * @param index     {@link int} to use as tag index.                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  25       */                                                                                                           </span>
<span class="8747903455774861782" onmouseenter="enter('8747903455774861782');" onmouseout="out('8747903455774861782');" style="">  26      public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalid {     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  27          try {                                                                                                     </span>
<span class="9216191153424566972" onmouseenter="enter('9216191153424566972');" onmouseout="out('9216191153424566972');" style="">  28              Tag tag = bucket.newObject(hashTag(name));                                                            </span>
<span class="7062856805755770087" onmouseenter="enter('7062856805755770087');" onmouseout="out('7062856805755770087');" style="">  29              tag.setName(name);                                                                                    </span>
<span class="1241154828935735504" onmouseenter="enter('1241154828935735504');" onmouseout="out('1241154828935735504');" style="">  30              tag.setIndex(index);                                                                                  </span>
<span class="-984333530129888175" onmouseenter="enter('-984333530129888175');" onmouseout="out('-984333530129888175');" style="">  31              tag.save();                                                                                           </span>
<span class="-1947392774679043932" onmouseenter="enter('-1947392774679043932');" onmouseout="out('-1947392774679043932');" style="">  32          } catch (BucketObjectNameInvalid e) {                                                                     </span>
<span class="-8667743002495120657" onmouseenter="enter('-8667743002495120657');" onmouseout="out('-8667743002495120657');" style="">  33              Log.e(&quot;createTag&quot;, &quot;Could not create tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot;, e);                                  </span>
<span class="-8098549490726146918" onmouseenter="enter('-8098549490726146918');" onmouseout="out('-8098549490726146918');" style="">  34              throw new BucketObjectNameInvalid(name);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  35          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  36      }                                                                                                             </span>
<span  style="">  37                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38      /**                                                                                                           </span>
<span class="2392397237022653325" onmouseenter="enter('2392397237022653325');" onmouseout="out('2392397237022653325');" style="">  39       * Create a tag the @param key and @param name in the @param bucket if it does not exist.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  40       *                                                                                                            </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  41       * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                           </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style="">  42       * @param name      {@link String} to use creating the tag.                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43       */                                                                                                           </span>
<span class="5504812218324751022" onmouseenter="enter('5504812218324751022');" onmouseout="out('5504812218324751022');" style="">  44      public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalid {       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -        try {                                                                                                     </span>
<span class="6887131945084192998" onmouseenter="enter('6887131945084192998');" onmouseout="out('6887131945084192998');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -            bucket.getObject(hashTag(name));                                                                      </span>
<span class="5313510975148768879" onmouseenter="enter('5313510975148768879');" onmouseout="out('5313510975148768879');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -            Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; already exists&quot;);                         </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -        } catch (BucketObjectMissingException e) {                                                                </span>
<span class="5015686068998267814" onmouseenter="enter('5015686068998267814');" onmouseout="out('5015686068998267814');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +        if (isTagMissing(bucket, name)) {                                                                         </span>
<span class="-5507367490190149303" onmouseenter="enter('-5507367490190149303');" onmouseout="out('-5507367490190149303');" style="">  50              createTag(bucket, name, bucket.count());                                                              </span>
<span class="-4406715836082075739" onmouseenter="enter('-4406715836082075739');" onmouseout="out('-4406715836082075739');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -            Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; does not exist&quot;);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  52          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53      }                                                                                                             </span>
<span  style="">  54                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55      /**                                                                                                           </span>
<span class="-7954620787131072644" onmouseenter="enter('-7954620787131072644');" onmouseout="out('-7954620787131072644');" style="">  56       * Get the canonical representation of a tag from the hashed value of the lexical variation.                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  57       *                                                                                                            </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  58       * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                                  </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  59       * @param lexical   {@link String} lexical variation of tag.                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  60       *                                                                                                            </span>
<span class="6994769969865688752" onmouseenter="enter('6994769969865688752');" onmouseout="out('6994769969865688752');" style="">  61       * @return          {@link String} canonical of tag if exists; lexical variation otherwise.                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  62       */                                                                                                           </span>
<span class="3615339384736220797" onmouseenter="enter('3615339384736220797');" onmouseout="out('3615339384736220797');" style="">  63      public static String getCanonicalFromLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                            </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  64          String hashed = hashTag(lexical);                                                                         </span>
<span  style="">  65                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  66          try {                                                                                                     </span>
<span class="2049191054179030541" onmouseenter="enter('2049191054179030541');" onmouseout="out('2049191054179030541');" style="">  67              Tag tag = bucket.getObject(hashed);                                                                   </span>
<span class="9102515807610881143" onmouseenter="enter('9102515807610881143');" onmouseout="out('9102515807610881143');" style="">  68              Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);                      </span>
<span class="8026912047484491735" onmouseenter="enter('8026912047484491735');" onmouseout="out('8026912047484491735');" style="">  69              return tag.getName();                                                                                 </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  70          } catch (BucketObjectMissingException e) {                                                                </span>
<span class="837984383885487332" onmouseenter="enter('837984383885487332');" onmouseout="out('837984383885487332');" style="">  71              Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);                  </span>
<span class="-543341485617227697" onmouseenter="enter('-543341485617227697');" onmouseout="out('-543341485617227697');" style="">  72              return lexical;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  73          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74      }                                                                                                             </span>
<span  style="">  75                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  76      /**                                                                                                           </span>





















<span class="7435699933451053654" onmouseenter="enter('7435699933451053654');" onmouseout="out('7435699933451053654');" style="">  77       * Hash the tag @param name with normalizing, lowercasing, and encoding.                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  78       *                                                                                                            </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style="">  79       * @param name      {@link String} to hash as the tag kay.                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  80       *                                                                                                            </span>
<span class="4943694139439122302" onmouseenter="enter('4943694139439122302');" onmouseout="out('4943694139439122302');" style="">  81       * @return          {@link String} hashed to use as tag key.                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  82       */                                                                                                           </span>
<span class="-3908749490287186730" onmouseenter="enter('-3908749490287186730');" onmouseout="out('-3908749490287186730');" style="">  83      public static String hashTag(String name) {                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  84          try {                                                                                                     </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style="">  85              String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                                  </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style="">  86              String lowercased = normalized.toLowerCase(Locale.US);                                                </span>
<span class="5745320295091512620" onmouseenter="enter('5745320295091512620');" onmouseout="out('5745320295091512620');" style="">  87              String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name());                        </span>
<span class="-3496770183992135401" onmouseenter="enter('-3496770183992135401');" onmouseout="out('-3496770183992135401');" style="">  88              return encoded.replace(&quot;*&quot;, &quot;%2A&quot;).replace(&quot;+&quot;, &quot;%20&quot;);                                               </span>

<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style="">  89          } catch (UnsupportedEncodingException e) {                                                                </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style="">  90              // TODO: Handle encoding exception with a custom UTF-8 encoder.                                       </span>
<span class="-3727955329973069704" onmouseenter="enter('-3727955329973069704');" onmouseout="out('-3727955329973069704');" style="">  91              return name;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93      }                                                                                                             </span>
<span  style="">  94                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  95      /**                                                                                                           </span>
<span class="-7971737868796377532" onmouseenter="enter('-7971737868796377532');" onmouseout="out('-7971737868796377532');" style="">  96       * Determine if the hashed tag @param name is valid after normalizing, lowercasing, and encoding.             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  97       *                                                                                                            </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style="">  98       * @param name      {@link String} to hash as the tag kay.                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  99       *                                                                                                            </span>
<span class="7577525586581647458" onmouseenter="enter('7577525586581647458');" onmouseout="out('7577525586581647458');" style=""> 100       * @return          {@link boolean} true if hashed value is valid; false otherwise.                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 101       */                                                                                                           </span>
<span class="7745313155817491769" onmouseenter="enter('7745313155817491769');" onmouseout="out('7745313155817491769');" style=""> 102      public static boolean hashTagValid(String name) {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 103          try {                                                                                                     </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 104              String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                                  </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 105              String lowercased = normalized.toLowerCase(Locale.US);                                                </span>
<span class="8257006028877340574" onmouseenter="enter('8257006028877340574');" onmouseout="out('8257006028877340574');" style=""><abbr title=" 106              String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()).replace(&quot;*&quot;, &quot;%2A&quot;).replace(&quot;+&quot;, &quot;%20&quot;);"> 106              String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()).replace(&quot;*&quot;, &quot;%2A&quot;).replðŸ”µ</abbr></span>

<span class="8567221967181029316" onmouseenter="enter('8567221967181029316');" onmouseout="out('8567221967181029316');" style=""> 107              return encoded.length() &lt;= MAXIMUM_LENGTH_ENCODED_HASH;                                               </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 108          } catch (UnsupportedEncodingException e) {                                                                </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 109              // TODO: Handle encoding exception with a custom UTF-8 encoder.                                       </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 110              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112      }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +    /**                                                                                                           </span>
<span class="-3167749631394751426" onmouseenter="enter('-3167749631394751426');" onmouseout="out('-3167749631394751426');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +     * Determine if the tag with @param name is missing from @param bucket or not.                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +     *                                                                                                            </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +     * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                           </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +     * @param name      {@link String} to use creating the tag.                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +     *                                                                                                            </span>
<span class="3982193436933187611" onmouseenter="enter('3982193436933187611');" onmouseout="out('3982193436933187611');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +     * @return          {@link Boolean} true if tag is missing; false otherwise.                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +     */                                                                                                           </span>
<span class="-3086183887637415732" onmouseenter="enter('-3086183887637415732');" onmouseout="out('-3086183887637415732');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +    public static boolean isTagMissing(Bucket&lt;Tag&gt; bucket, String name) {                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +        try {                                                                                                     </span>
<span class="6887131945084192998" onmouseenter="enter('6887131945084192998');" onmouseout="out('6887131945084192998');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +            bucket.getObject(hashTag(name));                                                                      </span>
<span class="5313510975148768879" onmouseenter="enter('5313510975148768879');" onmouseout="out('5313510975148768879');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +            Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; already exists&quot;);                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +            return false;                                                                                         </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +        } catch (BucketObjectMissingException e) {                                                                </span>
<span class="-4406715836082075739" onmouseenter="enter('-4406715836082075739');" onmouseout="out('-4406715836082075739');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +            Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; does not exist&quot;);                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +            return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +    }                                                                                                             </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="-4228041758449221373" onmouseenter="enter('-4228041758449221373');" onmouseout="out('-4228041758449221373');" style="">   1  package com.automattic.simplenote.utils;                                                                          </span>
<span  style="">   2                                                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">   3  import android.util.Log;                                                                                          </span>
<span  style="">   4                                                                                                                    </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">   5  import com.automattic.simplenote.models.Tag;                                                                      </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">   6  import com.simperium.client.Bucket;                                                                               </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">   7  import com.simperium.client.BucketObjectMissingException;                                                         </span>
<span class="-3142233007863984129" onmouseenter="enter('-3142233007863984129');" onmouseout="out('-3142233007863984129');" style="">   8  import com.simperium.client.BucketObjectNameInvalid;                                                              </span>
<span  style="">   9                                                                                                                    </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  10  import java.io.UnsupportedEncodingException;                                                                      </span>
<span class="302463665162759210" onmouseenter="enter('302463665162759210');" onmouseout="out('302463665162759210');" style="">  11  import java.net.URLEncoder;                                                                                       </span>
<span class="-2624565711555737384" onmouseenter="enter('-2624565711555737384');" onmouseout="out('-2624565711555737384');" style="">  12  import java.nio.charset.StandardCharsets;                                                                         </span>
<span class="1643854008646391422" onmouseenter="enter('1643854008646391422');" onmouseout="out('1643854008646391422');" style="">  13  import java.text.Normalizer;                                                                                      </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  14  import java.util.Locale;                                                                                          </span>
<span  style="">  15                                                                                                                    </span>
<span class="-1128522509845860150" onmouseenter="enter('-1128522509845860150');" onmouseout="out('-1128522509845860150');" style="">  16  public class TagUtils {                                                                                           </span>
<span class="-8759576399830854342" onmouseenter="enter('-8759576399830854342');" onmouseout="out('-8759576399830854342');" style="">  17      private static int MAXIMUM_LENGTH_ENCODED_HASH = 256;                                                         </span>
<span  style="">  18                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  19      /**                                                                                                           </span>
<span class="-1412269536984484265" onmouseenter="enter('-1412269536984484265');" onmouseout="out('-1412269536984484265');" style="">  20       * Create a tag with the @param key and @param name in the @param bucket.                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  21       *                                                                                                            </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  22       * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                           </span>
<span class="1483566391602743876" onmouseenter="enter('1483566391602743876');" onmouseout="out('1483566391602743876');" style="">  23       * @param name      {@link String} to use as tag name.                                                        </span>
<span class="6727814651609344167" onmouseenter="enter('6727814651609344167');" onmouseout="out('6727814651609344167');" style="">  24       * @param index     {@link int} to use as tag index.                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  25       */                                                                                                           </span>
<span class="8747903455774861782" onmouseenter="enter('8747903455774861782');" onmouseout="out('8747903455774861782');" style="">  26      public static void createTag(Bucket&lt;Tag&gt; bucket, String name, int index) throws BucketObjectNameInvalid {     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  27          try {                                                                                                     </span>
<span class="9216191153424566972" onmouseenter="enter('9216191153424566972');" onmouseout="out('9216191153424566972');" style="">  28              Tag tag = bucket.newObject(hashTag(name));                                                            </span>
<span class="7062856805755770087" onmouseenter="enter('7062856805755770087');" onmouseout="out('7062856805755770087');" style="">  29              tag.setName(name);                                                                                    </span>
<span class="1241154828935735504" onmouseenter="enter('1241154828935735504');" onmouseout="out('1241154828935735504');" style="">  30              tag.setIndex(index);                                                                                  </span>
<span class="-984333530129888175" onmouseenter="enter('-984333530129888175');" onmouseout="out('-984333530129888175');" style="">  31              tag.save();                                                                                           </span>
<span class="-1947392774679043932" onmouseenter="enter('-1947392774679043932');" onmouseout="out('-1947392774679043932');" style="">  32          } catch (BucketObjectNameInvalid e) {                                                                     </span>
<span class="-8667743002495120657" onmouseenter="enter('-8667743002495120657');" onmouseout="out('-8667743002495120657');" style="">  33              Log.e(&quot;createTag&quot;, &quot;Could not create tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot;, e);                                  </span>
<span class="-8098549490726146918" onmouseenter="enter('-8098549490726146918');" onmouseout="out('-8098549490726146918');" style="">  34              throw new BucketObjectNameInvalid(name);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  35          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  36      }                                                                                                             </span>
<span  style="">  37                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38      /**                                                                                                           </span>
<span class="2392397237022653325" onmouseenter="enter('2392397237022653325');" onmouseout="out('2392397237022653325');" style="">  39       * Create a tag the @param key and @param name in the @param bucket if it does not exist.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  40       *                                                                                                            </span>
<span class="4997689953681300090" onmouseenter="enter('4997689953681300090');" onmouseout="out('4997689953681300090');" style="">  41       * @param bucket    {@link Bucket&lt;Tag&gt;} in which to create the tag.                                           </span>
<span class="-5160304178145477051" onmouseenter="enter('-5160304178145477051');" onmouseout="out('-5160304178145477051');" style="">  42       * @param name      {@link String} to use creating the tag.                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43       */                                                                                                           </span>
<span class="5504812218324751022" onmouseenter="enter('5504812218324751022');" onmouseout="out('5504812218324751022');" style="">  44      public static void createTagIfMissing(Bucket&lt;Tag&gt; bucket, String name) throws BucketObjectNameInvalid {       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  45          try {                                                                                                     </span>
<span class="6887131945084192998" onmouseenter="enter('6887131945084192998');" onmouseout="out('6887131945084192998');" style="">  46              bucket.getObject(hashTag(name));                                                                      </span>
<span class="5313510975148768879" onmouseenter="enter('5313510975148768879');" onmouseout="out('5313510975148768879');" style="">  47              Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; already exists&quot;);                         </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  48          } catch (BucketObjectMissingException e) {                                                                </span>

<span class="-5507367490190149303" onmouseenter="enter('-5507367490190149303');" onmouseout="out('-5507367490190149303');" style="">  49              createTag(bucket, name, bucket.count());                                                              </span>
<span class="-4406715836082075739" onmouseenter="enter('-4406715836082075739');" onmouseout="out('-4406715836082075739');" style="">  50              Log.d(&quot;createTagIfMissing&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + name + &quot;\&quot;&quot; + &quot; does not exist&quot;);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  51          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  52      }                                                                                                             </span>
<span  style="">  53                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  54      /**                                                                                                           </span>
<span class="-7954620787131072644" onmouseenter="enter('-7954620787131072644');" onmouseout="out('-7954620787131072644');" style="">  55       * Get the canonical representation of a tag from the hashed value of the lexical variation.                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  56       *                                                                                                            </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="">  57       * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                                  </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="">  58       * @param lexical   {@link String} lexical variation of tag.                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  59       *                                                                                                            </span>
<span class="6994769969865688752" onmouseenter="enter('6994769969865688752');" onmouseout="out('6994769969865688752');" style="">  60       * @return          {@link String} canonical of tag if exists; lexical variation otherwise.                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61       */                                                                                                           </span>
<span class="3615339384736220797" onmouseenter="enter('3615339384736220797');" onmouseout="out('3615339384736220797');" style="">  62      public static String getCanonicalFromLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                            </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="">  63          String hashed = hashTag(lexical);                                                                         </span>
<span  style="">  64                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  65          try {                                                                                                     </span>
<span class="2049191054179030541" onmouseenter="enter('2049191054179030541');" onmouseout="out('2049191054179030541');" style="">  66              Tag tag = bucket.getObject(hashed);                                                                   </span>
<span class="9102515807610881143" onmouseenter="enter('9102515807610881143');" onmouseout="out('9102515807610881143');" style="">  67              Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);                      </span>
<span class="8026912047484491735" onmouseenter="enter('8026912047484491735');" onmouseout="out('8026912047484491735');" style="">  68              return tag.getName();                                                                                 </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="">  69          } catch (BucketObjectMissingException e) {                                                                </span>
<span class="837984383885487332" onmouseenter="enter('837984383885487332');" onmouseout="out('837984383885487332');" style="">  70              Log.d(&quot;getCanonicalFromLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);                  </span>
<span class="-543341485617227697" onmouseenter="enter('-543341485617227697');" onmouseout="out('-543341485617227697');" style="">  71              return lexical;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  72          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  73      }                                                                                                             </span>
<span  style="">  74                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  75      /**                                                                                                           </span>
<span class="8524513986896116908" onmouseenter="enter('8524513986896116908');" onmouseout="out('8524513986896116908');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  76 +     * A canonical representation of a tag exists from the hashed value of the lexical variation.                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  77 +     *                                                                                                            </span>
<span class="5667026867143258529" onmouseenter="enter('5667026867143258529');" onmouseout="out('5667026867143258529');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +     * @param bucket    {@link Bucket&lt;Tag&gt;} in which to get tag.                                                  </span>
<span class="5934297363790132327" onmouseenter="enter('5934297363790132327');" onmouseout="out('5934297363790132327');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +     * @param lexical   {@link String} lexical variation of tag.                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +     *                                                                                                            </span>
<span class="-3904799022660837793" onmouseenter="enter('-3904799022660837793');" onmouseout="out('-3904799022660837793');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +     * @return          {@link Boolean} TRUE if canonical tag exists; FALSE otherwise.                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +     */                                                                                                           </span>
<span class="-99796051801894615" onmouseenter="enter('-99796051801894615');" onmouseout="out('-99796051801894615');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +    public static boolean hasCanonicalOfLexical(Bucket&lt;Tag&gt; bucket, String lexical) {                             </span>
<span class="1785660653781068886" onmouseenter="enter('1785660653781068886');" onmouseout="out('1785660653781068886');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +        String hashed = hashTag(lexical);                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +                                                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +        try {                                                                                                     </span>
<span class="9080528103180666416" onmouseenter="enter('9080528103180666416');" onmouseout="out('9080528103180666416');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  87 +            bucket.getObject(hashed);                                                                             </span>
<span class="1920803171501308835" onmouseenter="enter('1920803171501308835');" onmouseout="out('1920803171501308835');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  88 +            Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does exist&quot;);                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  89 +            return true;                                                                                          </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  90 +        } catch (BucketObjectMissingException e) {                                                                </span>
<span class="515776657904866913" onmouseenter="enter('515776657904866913');" onmouseout="out('515776657904866913');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  91 +            Log.d(&quot;hasCanonicalOfLexical&quot;, &quot;Tag &quot; + &quot;\&quot;&quot; + hashed + &quot;\&quot;&quot; + &quot; does not exist&quot;);                    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  92 +            return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +    /**                                                                                                           </span>
<span class="7435699933451053654" onmouseenter="enter('7435699933451053654');" onmouseout="out('7435699933451053654');" style="">  97       * Hash the tag @param name with normalizing, lowercasing, and encoding.                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  98       *                                                                                                            </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style="">  99       * @param name      {@link String} to hash as the tag kay.                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 100       *                                                                                                            </span>
<span class="4943694139439122302" onmouseenter="enter('4943694139439122302');" onmouseout="out('4943694139439122302');" style=""> 101       * @return          {@link String} hashed to use as tag key.                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 102       */                                                                                                           </span>
<span class="-3908749490287186730" onmouseenter="enter('-3908749490287186730');" onmouseout="out('-3908749490287186730');" style=""> 103      public static String hashTag(String name) {                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 104          try {                                                                                                     </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 105              String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                                  </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 106              String lowercased = normalized.toLowerCase(Locale.US);                                                </span>
<span class="5745320295091512620" onmouseenter="enter('5745320295091512620');" onmouseout="out('5745320295091512620');" style=""> 107              String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name());                        </span>
<span class="-3496770183992135401" onmouseenter="enter('-3496770183992135401');" onmouseout="out('-3496770183992135401');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -            return encoded.replace(&quot;*&quot;, &quot;%2A&quot;).replace(&quot;+&quot;, &quot;%20&quot;);                                               </span>
<span class="5822871577258993169" onmouseenter="enter('5822871577258993169');" onmouseout="out('5822871577258993169');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +            return replaceEncoded(encoded);                                                                       </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 110          } catch (UnsupportedEncodingException e) {                                                                </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 111              // TODO: Handle encoding exception with a custom UTF-8 encoder.                                       </span>
<span class="-3727955329973069704" onmouseenter="enter('-3727955329973069704');" onmouseout="out('-3727955329973069704');" style=""> 112              return name;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114      }                                                                                                             </span>
<span  style=""> 115                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 116      /**                                                                                                           </span>
<span class="-7971737868796377532" onmouseenter="enter('-7971737868796377532');" onmouseout="out('-7971737868796377532');" style=""> 117       * Determine if the hashed tag @param name is valid after normalizing, lowercasing, and encoding.             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 118       *                                                                                                            </span>
<span class="6016037568870399159" onmouseenter="enter('6016037568870399159');" onmouseout="out('6016037568870399159');" style=""> 119       * @param name      {@link String} to hash as the tag kay.                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 120       *                                                                                                            </span>
<span class="7577525586581647458" onmouseenter="enter('7577525586581647458');" onmouseout="out('7577525586581647458');" style=""> 121       * @return          {@link boolean} true if hashed value is valid; false otherwise.                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 122       */                                                                                                           </span>
<span class="7745313155817491769" onmouseenter="enter('7745313155817491769');" onmouseout="out('7745313155817491769');" style=""> 123      public static boolean hashTagValid(String name) {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 124          try {                                                                                                     </span>
<span class="8269284913580328958" onmouseenter="enter('8269284913580328958');" onmouseout="out('8269284913580328958');" style=""> 125              String normalized = Normalizer.normalize(name, Normalizer.Form.NFC);                                  </span>
<span class="2544287960353137747" onmouseenter="enter('2544287960353137747');" onmouseout="out('2544287960353137747');" style=""> 126              String lowercased = normalized.toLowerCase(Locale.US);                                                </span>
<span class="8257006028877340574" onmouseenter="enter('8257006028877340574');" onmouseout="out('8257006028877340574');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 127 -            String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()).replace(&quot;*&quot;, &quot;%2A&quot;).replace(&quot;+&quot;, &quot;%20&quot;);"> 127 -            String encoded = URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()).replace(&quot;*&quot;, &quot;%2A&quot;).replðŸ”µ</abbr></span>
<span class="2872420892522440005" onmouseenter="enter('2872420892522440005');" onmouseout="out('2872420892522440005');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +            String encoded = replaceEncoded(URLEncoder.encode(lowercased, StandardCharsets.UTF_8.name()));        </span>
<span class="8567221967181029316" onmouseenter="enter('8567221967181029316');" onmouseout="out('8567221967181029316');" style=""> 129              return encoded.length() &lt;= MAXIMUM_LENGTH_ENCODED_HASH;                                               </span>
<span class="2368993151256970390" onmouseenter="enter('2368993151256970390');" onmouseout="out('2368993151256970390');" style=""> 130          } catch (UnsupportedEncodingException e) {                                                                </span>
<span class="-8221842598768357583" onmouseenter="enter('-8221842598768357583');" onmouseout="out('-8221842598768357583');" style=""> 131              // TODO: Handle encoding exception with a custom UTF-8 encoder.                                       </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 132              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134      }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 136 +    /**                                                                                                           </span>
<span class="-339038258891723312" onmouseenter="enter('-339038258891723312');" onmouseout="out('-339038258891723312');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +     * Replace certain characters in @param encoded that were not encoded with encoded value.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +     *                                                                                                            </span>
<span class="-1936486022863977938" onmouseenter="enter('-1936486022863977938');" onmouseout="out('-1936486022863977938');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +     * All &quot;+&quot; characters in a tag are encoded upstream and passed as &quot;%2B&quot; in {@param encoded}.                  </span>
<span class="-4164453662286537621" onmouseenter="enter('-4164453662286537621');" onmouseout="out('-4164453662286537621');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +     * All &quot; &quot; characters in a tag are encoded upstream and passed as &quot;+&quot; in {@param encoded}.                    </span>
<span class="-1577699597192556224" onmouseenter="enter('-1577699597192556224');" onmouseout="out('-1577699597192556224');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +     * Thus, all &quot;+&quot; in {@param encoded} should be replaced with &quot;%20&quot; as an encoded space.                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +     *                                                                                                            </span>
<span class="6678159147138687630" onmouseenter="enter('6678159147138687630');" onmouseout="out('6678159147138687630');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 143 +     * @param encoded   {@link String} to replace certain characters with encoded value.                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 144 +     *                                                                                                            </span>
<span class="-2341289387672210523" onmouseenter="enter('-2341289387672210523');" onmouseout="out('-2341289387672210523');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +     * @return          {@link String} replaced characters with encoded values.                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +     */                                                                                                           </span>
<span class="-8944270830991439293" onmouseenter="enter('-8944270830991439293');" onmouseout="out('-8944270830991439293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +    private static String replaceEncoded(String encoded) {                                                        </span>
<span class="-1765823146320074002" onmouseenter="enter('-1765823146320074002');" onmouseout="out('-1765823146320074002');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +        return encoded                                                                                            </span>
<span class="-3743019157832617127" onmouseenter="enter('-3743019157832617127');" onmouseout="out('-3743019157832617127');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +            .replace(&quot;+&quot;, &quot;%20&quot;)                                                                                  </span>
<span class="-3338477209764874631" onmouseenter="enter('-3338477209764874631');" onmouseout="out('-3338477209764874631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +            .replace(&quot;*&quot;, &quot;%2A&quot;)                                                                                  </span>
<span class="-429073147476082560" onmouseenter="enter('-429073147476082560');" onmouseout="out('-429073147476082560');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +            .replace(&quot;-&quot;, &quot;%2D&quot;)                                                                                  </span>
<span class="-4659631057048750898" onmouseenter="enter('-4659631057048750898');" onmouseout="out('-4659631057048750898');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +            .replace(&quot;.&quot;, &quot;%2E&quot;)                                                                                  </span>
<span class="7137732937458195694" onmouseenter="enter('7137732937458195694');" onmouseout="out('7137732937458195694');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +            .replace(&quot;_&quot;, &quot;%5F&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +    }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            