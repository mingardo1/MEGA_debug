<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>436 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.launcher.perjob;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.deployment.ClusterSpecification;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.program.ClusterClient;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.core.fs.Path;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.runtime.jobgraph.JobGraph;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.yarn.AbstractYarnClusterDescriptor;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.option.Options;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.util.PluginUtil;\n&#x27;
                           &#x27;import org.apache.commons.io.Charsets;\n&#x27;
                           &#x27;import org.apache.commons.lang3.StringUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.hadoop.yarn.api.records.ApplicationId;\n&#x27;
                           &#x27;import org.slf4j.Logger;\n&#x27;
                           &#x27;import org.slf4j.LoggerFactory;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.net.URLDecoder;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Properties;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * per job mode submitter\n&#x27;
                           &#x27; * Date: 2018/11/17\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public class PerJobSubmitter {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final Logger LOG = &#x27;
                           &#x27;LoggerFactory.getLogger(PerJobSubmitter.class);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public static String submit(Options &#x27;
                           &#x27;launcherOptions, JobGraph jobGraph, Configuration &#x27;
                           &#x27;flinkConfig) throws Exception {\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(!StringUtils.isBlank(launcherOptions.getAddjar())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            String addjarPath = &#x27;
                           &#x27;URLDecoder.decode(launcherOptions.getAddjar(), &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;            List&lt;String&gt; paths = &#x27;
                           &#x27;getJarPaths(addjarPath);\n&#x27;
                           &#x27;            paths.forEach(path -&gt; {\n&#x27;
                           &#x27;                jobGraph.addJar(new Path(&quot;file://&quot; &#x27;
                           &#x27;+ path));\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String confProp = &#x27;
                           &#x27;launcherOptions.getConfProp();\n&#x27;
                           &#x27;        confProp = URLDecoder.decode(confProp, &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;        Properties confProperties = &#x27;
                           &#x27;PluginUtil.jsonStrToObject(confProp, &#x27;
                           &#x27;Properties.class);\n&#x27;
                           &#x27;        ClusterSpecification clusterSpecification &#x27;
                           &#x27;= &#x27;
                           &#x27;FLinkPerJobResourceUtil.createClusterSpecification(confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        PerJobClusterClientBuilder &#x27;
                           &#x27;perJobClusterClientBuilder = new &#x27;
                           &#x27;PerJobClusterClientBuilder();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), &#x27;
                           &#x27;flinkConfig, confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String flinkJarPath = &#x27;
                           &#x27;launcherOptions.getFlinkJarPath();\n&#x27;
                           &#x27;        AbstractYarnClusterDescriptor &#x27;
                           &#x27;yarnClusterDescriptor = &#x27;
                           &#x27;perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, &#x27;
                           &#x27;launcherOptions, jobGraph);\n&#x27;
                           &#x27;        ClusterClient&lt;ApplicationId&gt; clusterClient &#x27;
                           &#x27;= &#x27;
                           &#x27;yarnClusterDescriptor.deployJobCluster(clusterSpecification, &#x27;
                           &#x27;jobGraph, true);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String applicationId = &#x27;
                           &#x27;clusterClient.getClusterId().toString();\n&#x27;
                           &#x27;        String flinkJobId = &#x27;
                           &#x27;jobGraph.getJobID().toString();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String tips = String.format(&quot;deploy &#x27;
                           &#x27;per_job with appId: %s, jobId: %s&quot;, applicationId, &#x27;
                           &#x27;flinkJobId);\n&#x27;
                           &#x27;        LOG.info(tips);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return applicationId;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static List&lt;String&gt; getJarPaths(String &#x27;
                           &#x27;addjarPath) {\n&#x27;
                           &#x27;        if (addjarPath.length() &gt; 2) {\n&#x27;
                           &#x27;            addjarPath = addjarPath.substring(1, &#x27;
                           &#x27;addjarPath.length() - 1).replace(&quot;\\&quot;&quot;, &quot;&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;Arrays.asList(StringUtils.split(addjarPath, &#x27;
                           &#x27;&quot;,&quot;));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.launcher.perjob;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.deployment.ClusterSpecification;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.program.ClusterClient;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.core.fs.Path;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.runtime.jobgraph.JobGraph;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.yarn.AbstractYarnClusterDescriptor;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.option.Options;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.util.PluginUtil;\n&#x27;
                           &#x27;import org.apache.commons.io.Charsets;\n&#x27;
                           &#x27;import org.apache.commons.lang3.StringUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.hadoop.yarn.api.records.ApplicationId;\n&#x27;
                           &#x27;import org.slf4j.Logger;\n&#x27;
                           &#x27;import org.slf4j.LoggerFactory;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.net.URLDecoder;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Properties;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * per job mode submitter\n&#x27;
                           &#x27; * Date: 2018/11/17\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public class PerJobSubmitter {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final Logger LOG = &#x27;
                           &#x27;LoggerFactory.getLogger(PerJobSubmitter.class);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public static String submit(Options &#x27;
                           &#x27;launcherOptions, JobGraph jobGraph, Configuration &#x27;
                           &#x27;flinkConfig) throws Exception {\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(!StringUtils.isBlank(launcherOptions.getAddjar())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            String addjarPath = &#x27;
                           &#x27;URLDecoder.decode(launcherOptions.getAddjar(), &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;            List&lt;String&gt; paths = &#x27;
                           &#x27;getJarPaths(addjarPath);\n&#x27;
                           &#x27;            paths.forEach(path -&gt; {\n&#x27;
                           &#x27;                jobGraph.addJar(new Path(&quot;file://&quot; &#x27;
                           &#x27;+ path));\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String confProp = &#x27;
                           &#x27;launcherOptions.getConfProp();\n&#x27;
                           &#x27;        confProp = URLDecoder.decode(confProp, &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;        Properties confProperties = &#x27;
                           &#x27;PluginUtil.jsonStrToObject(confProp, &#x27;
                           &#x27;Properties.class);\n&#x27;
                           &#x27;        ClusterSpecification clusterSpecification &#x27;
                           &#x27;= &#x27;
                           &#x27;FLinkPerJobResourceUtil.createClusterSpecification(confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        PerJobClusterClientBuilder &#x27;
                           &#x27;perJobClusterClientBuilder = new &#x27;
                           &#x27;PerJobClusterClientBuilder();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), &#x27;
                           &#x27;flinkConfig, confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String flinkJarPath = &#x27;
                           &#x27;launcherOptions.getFlinkJarPath();\n&#x27;
                           &#x27;        AbstractYarnClusterDescriptor &#x27;
                           &#x27;yarnClusterDescriptor = &#x27;
                           &#x27;perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, &#x27;
                           &#x27;launcherOptions, jobGraph);\n&#x27;
                           &#x27;        ClusterClient&lt;ApplicationId&gt; clusterClient &#x27;
                           &#x27;= &#x27;
                           &#x27;yarnClusterDescriptor.deployJobCluster(clusterSpecification, &#x27;
                           &#x27;jobGraph, true);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String applicationId = &#x27;
                           &#x27;clusterClient.getClusterId().toString();\n&#x27;
                           &#x27;        String flinkJobId = &#x27;
                           &#x27;jobGraph.getJobID().toString();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String tips = String.format(&quot;deploy &#x27;
                           &#x27;per_job with appId: %s, jobId: %s&quot;, applicationId, &#x27;
                           &#x27;flinkJobId);\n&#x27;
                           &#x27;        LOG.info(tips);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return applicationId;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static List&lt;String&gt; getJarPaths(String &#x27;
                           &#x27;addjarPath) {\n&#x27;
                           &#x27;        if (addjarPath.length() &gt; 2) {\n&#x27;
                           &#x27;            addjarPath = addjarPath.substring(1, &#x27;
                           &#x27;addjarPath.length() - 1).replace(&quot;\\&quot;&quot;, &quot;&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;Arrays.asList(StringUtils.split(addjarPath, &#x27;
                           &#x27;&quot;,&quot;));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.launcher.perjob;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.deployment.ClusterSpecification;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.program.ClusterClient;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.core.fs.Path;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.runtime.jobgraph.JobGraph;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.yarn.AbstractYarnClusterDescriptor;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.option.Options;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.util.PluginUtil;\n&#x27;
                           &#x27;import org.apache.commons.io.Charsets;\n&#x27;
                           &#x27;import org.apache.commons.lang3.StringUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.hadoop.yarn.api.records.ApplicationId;\n&#x27;
                           &#x27;import org.slf4j.Logger;\n&#x27;
                           &#x27;import org.slf4j.LoggerFactory;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.net.URLDecoder;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Properties;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * per job mode submitter\n&#x27;
                           &#x27; * Date: 2018/11/17\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public class PerJobSubmitter {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final Logger LOG = &#x27;
                           &#x27;LoggerFactory.getLogger(PerJobSubmitter.class);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public static String submit(Options &#x27;
                           &#x27;launcherOptions, JobGraph jobGraph, Configuration &#x27;
                           &#x27;flinkConfig) throws Exception {\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(!StringUtils.isBlank(launcherOptions.getAddjar())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            String addjarPath = &#x27;
                           &#x27;URLDecoder.decode(launcherOptions.getAddjar(), &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;            List&lt;String&gt; paths = &#x27;
                           &#x27;getJarPaths(addjarPath);\n&#x27;
                           &#x27;            paths.forEach(path -&gt; {\n&#x27;
                           &#x27;                jobGraph.addJar(new Path(&quot;file://&quot; &#x27;
                           &#x27;+ path));\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String confProp = &#x27;
                           &#x27;launcherOptions.getConfProp();\n&#x27;
                           &#x27;        confProp = URLDecoder.decode(confProp, &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;        Properties confProperties = &#x27;
                           &#x27;PluginUtil.jsonStrToObject(confProp, &#x27;
                           &#x27;Properties.class);\n&#x27;
                           &#x27;        ClusterSpecification clusterSpecification &#x27;
                           &#x27;= &#x27;
                           &#x27;FLinkPerJobResourceUtil.createClusterSpecification(confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        PerJobClusterClientBuilder &#x27;
                           &#x27;perJobClusterClientBuilder = new &#x27;
                           &#x27;PerJobClusterClientBuilder();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), &#x27;
                           &#x27;flinkConfig, confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String flinkJarPath = &#x27;
                           &#x27;launcherOptions.getFlinkJarPath();\n&#x27;
                           &#x27;        AbstractYarnClusterDescriptor &#x27;
                           &#x27;yarnClusterDescriptor = &#x27;
                           &#x27;perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, &#x27;
                           &#x27;launcherOptions, jobGraph);\n&#x27;
                           &#x27;        ClusterClient&lt;ApplicationId&gt; clusterClient &#x27;
                           &#x27;= &#x27;
                           &#x27;yarnClusterDescriptor.deployJobCluster(clusterSpecification, &#x27;
                           &#x27;jobGraph, true);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String applicationId = &#x27;
                           &#x27;clusterClient.getClusterId().toString();\n&#x27;
                           &#x27;        String flinkJobId = &#x27;
                           &#x27;jobGraph.getJobID().toString();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String tips = String.format(&quot;deploy &#x27;
                           &#x27;per_job with appId: %s, jobId: %s&quot;, applicationId, &#x27;
                           &#x27;flinkJobId);\n&#x27;
                           &#x27;        LOG.info(tips);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return applicationId;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static List&lt;String&gt; getJarPaths(String &#x27;
                           &#x27;addjarPath) {\n&#x27;
                           &#x27;        if (addjarPath.length() &gt; 2) {\n&#x27;
                           &#x27;            addjarPath = addjarPath.substring(1, &#x27;
                           &#x27;addjarPath.length() - 1).replace(&quot;\\&quot;&quot;, &quot;&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;Arrays.asList(StringUtils.split(addjarPath, &#x27;
                           &#x27;&quot;,&quot;));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.launcher.perjob;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.deployment.ClusterSpecification;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.program.ClusterClient;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.core.fs.Path;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.runtime.jobgraph.JobGraph;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.yarn.AbstractYarnClusterDescriptor;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.option.Options;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.util.PluginUtil;\n&#x27;
                           &#x27;import org.apache.commons.io.Charsets;\n&#x27;
                           &#x27;import org.apache.commons.lang3.StringUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.hadoop.yarn.api.records.ApplicationId;\n&#x27;
                           &#x27;import org.slf4j.Logger;\n&#x27;
                           &#x27;import org.slf4j.LoggerFactory;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.net.URLDecoder;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Properties;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * per job mode submitter\n&#x27;
                           &#x27; * Date: 2018/11/17\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public class PerJobSubmitter {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final Logger LOG = &#x27;
                           &#x27;LoggerFactory.getLogger(PerJobSubmitter.class);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public static String submit(Options &#x27;
                           &#x27;launcherOptions, JobGraph jobGraph, Configuration &#x27;
                           &#x27;flinkConfig) throws Exception {\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(!StringUtils.isBlank(launcherOptions.getAddjar())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            String addjarPath = &#x27;
                           &#x27;URLDecoder.decode(launcherOptions.getAddjar(), &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;            List&lt;String&gt; paths = &#x27;
                           &#x27;getJarPaths(addjarPath);\n&#x27;
                           &#x27;            paths.forEach(path -&gt; {\n&#x27;
                           &#x27;                jobGraph.addJar(new Path(&quot;file://&quot; &#x27;
                           &#x27;+ path));\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String confProp = &#x27;
                           &#x27;launcherOptions.getConfProp();\n&#x27;
                           &#x27;        confProp = URLDecoder.decode(confProp, &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;        Properties confProperties = &#x27;
                           &#x27;PluginUtil.jsonStrToObject(confProp, &#x27;
                           &#x27;Properties.class);\n&#x27;
                           &#x27;        ClusterSpecification clusterSpecification &#x27;
                           &#x27;= &#x27;
                           &#x27;FLinkPerJobResourceUtil.createClusterSpecification(confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        PerJobClusterClientBuilder &#x27;
                           &#x27;perJobClusterClientBuilder = new &#x27;
                           &#x27;PerJobClusterClientBuilder();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), &#x27;
                           &#x27;flinkConfig, confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String flinkJarPath = &#x27;
                           &#x27;launcherOptions.getFlinkJarPath();\n&#x27;
                           &#x27;        AbstractYarnClusterDescriptor &#x27;
                           &#x27;yarnClusterDescriptor = &#x27;
                           &#x27;perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, &#x27;
                           &#x27;launcherOptions, jobGraph);\n&#x27;
                           &#x27;        ClusterClient&lt;ApplicationId&gt; clusterClient &#x27;
                           &#x27;= &#x27;
                           &#x27;yarnClusterDescriptor.deployJobCluster(clusterSpecification, &#x27;
                           &#x27;jobGraph, true);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String applicationId = &#x27;
                           &#x27;clusterClient.getClusterId().toString();\n&#x27;
                           &#x27;        String flinkJobId = &#x27;
                           &#x27;jobGraph.getJobID().toString();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String tips = String.format(&quot;deploy &#x27;
                           &#x27;per_job with appId: %s, jobId: %s&quot;, applicationId, &#x27;
                           &#x27;flinkJobId);\n&#x27;
                           &#x27;        LOG.info(tips);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return applicationId;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static List&lt;String&gt; getJarPaths(String &#x27;
                           &#x27;addjarPath) {\n&#x27;
                           &#x27;        if (addjarPath.length() &gt; 2) {\n&#x27;
                           &#x27;            addjarPath = addjarPath.substring(1, &#x27;
                           &#x27;addjarPath.length() - 1).replace(&quot;\\&quot;&quot;, &quot;&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;Arrays.asList(StringUtils.split(addjarPath, &#x27;
                           &#x27;&quot;,&quot;));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.launcher.perjob;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.deployment.ClusterSpecification;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.program.ClusterClient;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.core.fs.Path;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.runtime.jobgraph.JobGraph;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.yarn.AbstractYarnClusterDescriptor;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.option.Options;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.util.PluginUtil;\n&#x27;
                           &#x27;import org.apache.commons.io.Charsets;\n&#x27;
                           &#x27;import org.apache.commons.lang3.StringUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.hadoop.yarn.api.records.ApplicationId;\n&#x27;
                           &#x27;import org.slf4j.Logger;\n&#x27;
                           &#x27;import org.slf4j.LoggerFactory;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.net.URLDecoder;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Properties;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * per job mode submitter\n&#x27;
                           &#x27; * Date: 2018/11/17\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public class PerJobSubmitter {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final Logger LOG = &#x27;
                           &#x27;LoggerFactory.getLogger(PerJobSubmitter.class);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public static String submit(Options &#x27;
                           &#x27;launcherOptions, JobGraph jobGraph, Configuration &#x27;
                           &#x27;flinkConfig) throws Exception {\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(!StringUtils.isBlank(launcherOptions.getAddjar())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            String addjarPath = &#x27;
                           &#x27;URLDecoder.decode(launcherOptions.getAddjar(), &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;            List&lt;String&gt; paths = &#x27;
                           &#x27;getJarPaths(addjarPath);\n&#x27;
                           &#x27;            paths.forEach(path -&gt; {\n&#x27;
                           &#x27;                jobGraph.addJar(new Path(&quot;file://&quot; &#x27;
                           &#x27;+ path));\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String confProp = &#x27;
                           &#x27;launcherOptions.getConfProp();\n&#x27;
                           &#x27;        confProp = URLDecoder.decode(confProp, &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;        Properties confProperties = &#x27;
                           &#x27;PluginUtil.jsonStrToObject(confProp, &#x27;
                           &#x27;Properties.class);\n&#x27;
                           &#x27;        ClusterSpecification clusterSpecification &#x27;
                           &#x27;= &#x27;
                           &#x27;FLinkPerJobResourceUtil.createClusterSpecification(confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        PerJobClusterClientBuilder &#x27;
                           &#x27;perJobClusterClientBuilder = new &#x27;
                           &#x27;PerJobClusterClientBuilder();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), &#x27;
                           &#x27;flinkConfig, confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String flinkJarPath = &#x27;
                           &#x27;launcherOptions.getFlinkJarPath();\n&#x27;
                           &#x27;        AbstractYarnClusterDescriptor &#x27;
                           &#x27;yarnClusterDescriptor = &#x27;
                           &#x27;perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, &#x27;
                           &#x27;launcherOptions, jobGraph);\n&#x27;
                           &#x27;        ClusterClient&lt;ApplicationId&gt; clusterClient &#x27;
                           &#x27;= &#x27;
                           &#x27;yarnClusterDescriptor.deployJobCluster(clusterSpecification, &#x27;
                           &#x27;jobGraph, true);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String applicationId = &#x27;
                           &#x27;clusterClient.getClusterId().toString();\n&#x27;
                           &#x27;        String flinkJobId = &#x27;
                           &#x27;jobGraph.getJobID().toString();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String tips = String.format(&quot;deploy &#x27;
                           &#x27;per_job with appId: %s, jobId: %s&quot;, applicationId, &#x27;
                           &#x27;flinkJobId);\n&#x27;
                           &#x27;        LOG.info(tips);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return applicationId;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static List&lt;String&gt; getJarPaths(String &#x27;
                           &#x27;addjarPath) {\n&#x27;
                           &#x27;        if (addjarPath.length() &gt; 2) {\n&#x27;
                           &#x27;            addjarPath = addjarPath.substring(1, &#x27;
                           &#x27;addjarPath.length() - 1).replace(&quot;\\&quot;&quot;, &quot;&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;Arrays.asList(StringUtils.split(addjarPath, &#x27;
                           &#x27;&quot;,&quot;));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.launcher.perjob;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.deployment.ClusterSpecification;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.client.program.ClusterClient;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.core.fs.Path;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.runtime.jobgraph.JobGraph;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.yarn.AbstractYarnClusterDescriptor;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.option.Options;\n&#x27;
                           &#x27;import com.dtstack.flink.sql.util.PluginUtil;\n&#x27;
                           &#x27;import org.apache.commons.io.Charsets;\n&#x27;
                           &#x27;import org.apache.commons.lang3.StringUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.hadoop.yarn.api.records.ApplicationId;\n&#x27;
                           &#x27;import org.slf4j.Logger;\n&#x27;
                           &#x27;import org.slf4j.LoggerFactory;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.net.URLDecoder;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Properties;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * per job mode submitter\n&#x27;
                           &#x27; * Date: 2018/11/17\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public class PerJobSubmitter {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final Logger LOG = &#x27;
                           &#x27;LoggerFactory.getLogger(PerJobSubmitter.class);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public static String submit(Options &#x27;
                           &#x27;launcherOptions, JobGraph jobGraph, Configuration &#x27;
                           &#x27;flinkConfig) throws Exception {\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(!StringUtils.isBlank(launcherOptions.getAddjar())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            String addjarPath = &#x27;
                           &#x27;URLDecoder.decode(launcherOptions.getAddjar(), &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;            List&lt;String&gt; paths = &#x27;
                           &#x27;getJarPaths(addjarPath);\n&#x27;
                           &#x27;            paths.forEach(path -&gt; {\n&#x27;
                           &#x27;                jobGraph.addJar(new Path(&quot;file://&quot; &#x27;
                           &#x27;+ path));\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String confProp = &#x27;
                           &#x27;launcherOptions.getConfProp();\n&#x27;
                           &#x27;        confProp = URLDecoder.decode(confProp, &#x27;
                           &#x27;Charsets.UTF_8.toString());\n&#x27;
                           &#x27;        Properties confProperties = &#x27;
                           &#x27;PluginUtil.jsonStrToObject(confProp, &#x27;
                           &#x27;Properties.class);\n&#x27;
                           &#x27;        ClusterSpecification clusterSpecification &#x27;
                           &#x27;= &#x27;
                           &#x27;FLinkPerJobResourceUtil.createClusterSpecification(confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        PerJobClusterClientBuilder &#x27;
                           &#x27;perJobClusterClientBuilder = new &#x27;
                           &#x27;PerJobClusterClientBuilder();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), &#x27;
                           &#x27;flinkConfig, confProperties);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String flinkJarPath = &#x27;
                           &#x27;launcherOptions.getFlinkJarPath();\n&#x27;
                           &#x27;        AbstractYarnClusterDescriptor &#x27;
                           &#x27;yarnClusterDescriptor = &#x27;
                           &#x27;perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, &#x27;
                           &#x27;launcherOptions, jobGraph);\n&#x27;
                           &#x27;        ClusterClient&lt;ApplicationId&gt; clusterClient &#x27;
                           &#x27;= &#x27;
                           &#x27;yarnClusterDescriptor.deployJobCluster(clusterSpecification, &#x27;
                           &#x27;jobGraph, true);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String applicationId = &#x27;
                           &#x27;clusterClient.getClusterId().toString();\n&#x27;
                           &#x27;        String flinkJobId = &#x27;
                           &#x27;jobGraph.getJobID().toString();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String tips = String.format(&quot;deploy &#x27;
                           &#x27;per_job with appId: %s, jobId: %s&quot;, applicationId, &#x27;
                           &#x27;flinkJobId);\n&#x27;
                           &#x27;        LOG.info(tips);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return applicationId;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static List&lt;String&gt; getJarPaths(String &#x27;
                           &#x27;addjarPath) {\n&#x27;
                           &#x27;        if (addjarPath.length() &gt; 2) {\n&#x27;
                           &#x27;            addjarPath = addjarPath.substring(1, &#x27;
                           &#x27;addjarPath.length() - 1).replace(&quot;\\&quot;&quot;, &quot;&quot;);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        return &#x27;
                           &#x27;Arrays.asList(StringUtils.split(addjarPath, &#x27;
                           &#x27;&quot;,&quot;));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        