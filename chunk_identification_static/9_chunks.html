<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>9 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import com.arialyy.aria.core.download.DownloadTask;\n&#x27;
                         &#x27;import com.arialyy.aria.core.inf.AbsEntity;\n&#x27;
                         &#x27;import com.arialyy.aria.core.inf.IEntity;\n&#x27;
                         &#x27;import com.arialyy.frame.util.show.L;\n&#x27;
                         &#x27;import com.arialyy.simple.R;\n&#x27;
                         &#x27;import com.arialyy.simple.base.BaseActivity;\n&#x27;
                         &#x27;import &#x27;
                         &#x27;com.arialyy.simple.core.download.multi_download.DownloadAdapter;\n&#x27;
                         &#x27;import &#x27;
                         &#x27;com.arialyy.simple.databinding.ActivityHighestPriorityBinding;\n&#x27;
                         &#x27;import com.arialyy.simple.util.AppUtil;\n&#x27;
                         &#x27;import &#x27;
                         &#x27;com.arialyy.simple.widget.HorizontalProgressBarWithNumber;\n&#x27;
                         &#x27;import java.util.ArrayList;\n&#x27;
                         &#x27;import java.util.HashSet;\n&#x27;
                         &#x27;import java.util.List;\n&#x27;
                         &#x27;import java.util.Set;\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;/**\n&#x27;
                         &#x27; * Created by lyy on 2017/6/2.\n&#x27;
                         &#x27; * 最高优先级任务Demo\n&#x27;
                         &#x27; */\n&#x27;
                         &#x27;public class HighestPriorityActivity extends &#x27;
                         &#x27;BaseActivity&lt;ActivityHighestPriorityBinding&gt; {\n&#x27;
                         &#x27;  private HorizontalProgressBarWithNumber mPb;\n&#x27;
                         &#x27;  private Button mStart;\n&#x27;
                         &#x27;  private Button mStop;\n&#x27;
                         &#x27;  private Button mCancel;\n&#x27;
                         &#x27;  private TextView mSize;\n&#x27;
                         &#x27;  private TextView mSpeed;\n&#x27;
                         &#x27;  private RecyclerView mList;\n&#x27;
                         &#x27;  private DownloadEntity mEntity;\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  private String mTaskName = &quot;光明大陆&quot;;\n&#x27;
                         &#x27;  private static final String DOWNLOAD_URL =\n&#x27;
                         &#x27;      &#x27;
                         &#x27;&quot;https://res5.d.cn/6f78ee3bcfdd033e64892a8553a95814cf5b4a62b12a76d9eb2a694905f0dc30fa5c7f728806a4ee0b3479e7b26a38707dac92b136add91191ac1219aadb4a3aa70bfa6d06d2d8db.apk&quot;;\n&#x27;
                         &#x27;  private DownloadAdapter mAdapter;\n&#x27;
                         &#x27;  private List&lt;AbsEntity&gt; mData = new &#x27;
                         &#x27;ArrayList&lt;&gt;();\n&#x27;
                         &#x27;  private Set&lt;String&gt; mRecord = new HashSet&lt;&gt;();\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override protected int setLayoutId() {\n&#x27;
                         &#x27;    return R.layout.activity_highest_priority;\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override protected void init(Bundle &#x27;
                         &#x27;savedInstanceState) {\n&#x27;
                         &#x27;    super.init(savedInstanceState);\n&#x27;
                         &#x27;    mPb = findViewById(R.id.progressBar);\n&#x27;
                         &#x27;    mStart = findViewById(R.id.start);\n&#x27;
                         &#x27;    mStop = findViewById(R.id.stop);\n&#x27;
                         &#x27;    mCancel = findViewById(R.id.cancel);\n&#x27;
                         &#x27;    mSize = findViewById(R.id.size);\n&#x27;
                         &#x27;    mSpeed = findViewById(R.id.speed);\n&#x27;
                         &#x27;    mList = findViewById(R.id.list);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;    setTitle(&quot;最高优先级任务&quot;);\n&#x27;
                         &#x27;    getBinding().setTaskName(&quot;任务名：&quot; + mTaskName + &quot; &#x27;
                         &#x27;（最高优先级任务）&quot;);\n&#x27;
                         &#x27;    initWidget();\n&#x27;
                         &#x27;    Aria.download(this).register();\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  private void initWidget() {\n&#x27;
                         &#x27;    mEntity = &#x27;
                         &#x27;Aria.download(this).getFirstDownloadEntity(DOWNLOAD_URL);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;    if (mEntity != null) {\n&#x27;
                         &#x27;      mPb.setProgress(mEntity.getPercent());\n&#x27;
                         &#x27;      if (mEntity.getState() == IEntity.STATE_STOP) &#x27;
                         &#x27;{\n&#x27;
                         &#x27;        mStart.setText(&quot;恢复&quot;);\n&#x27;
                         &#x27;        &#x27;
                         &#x27;mStart.setTextColor(getResources().getColor(android.R.color.holo_blue_light));\n&#x27;
                         &#x27;        setBtState(true);\n&#x27;
                         &#x27;      } else if (mEntity.getState() == &#x27;
                         &#x27;IEntity.STATE_RUNNING) {\n&#x27;
                         &#x27;        setBtState(false);\n&#x27;
                         &#x27;      }\n&#x27;
                         &#x27;      mSize.setText(mEntity.getConvertFileSize());\n&#x27;
                         &#x27;    }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;    List&lt;DownloadEntity&gt; temp = &#x27;
                         &#x27;Aria.download(this).getTaskList();\n&#x27;
                         &#x27;    if (temp != null &amp;&amp; !temp.isEmpty()) {\n&#x27;
                         &#x27;      for (DownloadEntity entity : temp) {\n&#x27;
                         &#x27;        if (entity.getUrl().equals(DOWNLOAD_URL)) &#x27;
                         &#x27;continue;\n&#x27;
                         &#x27;        mData.add(entity);\n&#x27;
                         &#x27;        mRecord.add(entity.getUrl());\n&#x27;
                         &#x27;      }\n&#x27;
                         &#x27;    }\n&#x27;
                         &#x27;    mAdapter = new DownloadAdapter(this, mData);\n&#x27;
                         &#x27;    mList.setLayoutManager(new &#x27;
                         &#x27;LinearLayoutManager(this));\n&#x27;
                         &#x27;    mList.setAdapter(mAdapter);\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override public boolean onCreateOptionsMenu(Menu &#x27;
                         &#x27;menu) {\n&#x27;
                         &#x27;    &#x27;
                         &#x27;getMenuInflater().inflate(R.menu.menu_highest_priority, &#x27;
                         &#x27;menu);\n&#x27;
                         &#x27;    return super.onCreateOptionsMenu(menu);\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override public boolean onMenuItemClick(MenuItem &#x27;
                         &#x27;item) {\n&#x27;
                         &#x27;    switch (item.getItemId()) {\n&#x27;
                         &#x27;      case R.id.add_task:\n&#x27;
                         &#x27;        List&lt;DownloadEntity&gt; temp = &#x27;
                         &#x27;getModule(DownloadModule.class).getHighestTestList();\n&#x27;
                         &#x27;        for (DownloadEntity entity : temp) {\n&#x27;
                         &#x27;          String url = entity.getUrl();\n&#x27;
                         &#x27;          if (mRecord.contains(url)) {\n&#x27;
                         &#x27;            continue;\n&#x27;
                         &#x27;          }\n&#x27;
                         &#x27;          mAdapter.addDownloadEntity(entity);\n&#x27;
                         &#x27;          mRecord.add(url);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;        mAdapter.notifyDataSetChanged();\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;      case R.id.help:\n&#x27;
                         &#x27;        String title = &quot;最高优先级任务介绍&quot;;\n&#x27;
                         &#x27;        String msg = &quot; &#x27;
                         &#x27;将任务设置为最高优先级任务，最高优先级任务有以下特点：\\n&quot;\n&#x27;
                         &#x27;            + &quot; 1、在下载队列中，有且只有一个最高优先级任务\\n&quot;\n&#x27;
                         &#x27;            + &quot; 2、最高优先级任务会一直存在，直到用户手动暂停或任务完成\\n&quot;\n&#x27;
                         &#x27;            + &quot; 3、任务调度器不会暂停最高优先级任务\\n&quot;\n&#x27;
                         &#x27;            + &quot; &#x27;
                         &#x27;4、用户手动暂停或任务完成后，第二次重新执行该任务，该命令将失效\\n&quot;\n&#x27;
                         &#x27;            + &quot; &#x27;
                         &#x27;5、如果下载队列中已经满了，则会停止队尾的任务，当高优先级任务完成后，该队尾任务将自动执行\\n&quot;\n&#x27;
                         &#x27;            + &quot; &#x27;
                         &#x27;6、把任务设置为最高优先级任务后，将自动执行任务，不需要重新调用start()启动任务&quot;;\n&#x27;
                         &#x27;        showMsgDialog(title, msg);\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;    }\n&#x27;
                         &#x27;    return true;\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  public void onClick(View view) {\n&#x27;
                         &#x27;    switch (view.getId()) {\n&#x27;
                         &#x27;      case R.id.start:\n&#x27;
                         &#x27;        if (AppUtil.chekEntityValid(mEntity)) {\n&#x27;
                         &#x27;          Aria.download(this)\n&#x27;
                         &#x27;              .load(DOWNLOAD_URL)\n&#x27;
                         &#x27;              &#x27;
                         &#x27;.setFilePath(Environment.getExternalStorageDirectory().getPath()\n&#x27;
                         &#x27;                  + &quot;/Download/&quot;\n&#x27;
                         &#x27;                  + mTaskName\n&#x27;
                         &#x27;                  + &quot;.apk&quot;)\n&#x27;
                         &#x27;              .setHighestPriority();\n&#x27;
                         &#x27;        } else {\n&#x27;
                         &#x27;          &#x27;
                         &#x27;Aria.download(this).load(mEntity.getId()).resume();\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;        ((TextView) &#x27;
                         &#x27;view).setText(getString(R.string.stop));\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;      case R.id.stop:\n&#x27;
                         &#x27;        if (AppUtil.chekEntityValid(mEntity)) {\n&#x27;
                         &#x27;          &#x27;
                         &#x27;Aria.download(this).load(mEntity.getId()).stop();\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;        ((TextView) &#x27;
                         &#x27;view).setText(getString(R.string.resume));\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;      case R.id.cancel:\n&#x27;
                         &#x27;        if (AppUtil.chekEntityValid(mEntity)) {\n&#x27;
                         &#x27;          &#x27;
                         &#x27;Aria.download(this).load(mEntity.getId()).cancel();\n&#x27;
                         &#x27;        }\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import &#x27;
                           &#x27;com.arialyy.aria.core.download.DownloadTarget;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.aria.core.download.DownloadTask;\n&#x27;
                           &#x27;import com.arialyy.aria.core.inf.AbsEntity;\n&#x27;
                           &#x27;import com.arialyy.aria.core.inf.IEntity;\n&#x27;
                           &#x27;import com.arialyy.frame.util.show.L;\n&#x27;
                           &#x27;import com.arialyy.simple.R;\n&#x27;
                           &#x27;import com.arialyy.simple.base.BaseActivity;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.simple.databinding.ActivityHighestPriorityBinding;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.simple.core.download.multi_download.DownloadAdapter;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.simple.widget.HorizontalProgressBarWithNumber;\n&#x27;
                           &#x27;import java.util.ArrayList;\n&#x27;
                           &#x27;import java.util.HashSet;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Set;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Created by lyy on 2017/6/2.\n&#x27;
                           &#x27; * 最高优先级任务Demo\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class HighestPriorityActivity extends &#x27;
                           &#x27;BaseActivity&lt;ActivityHighestPriorityBinding&gt; {\n&#x27;
                           &#x27;  private HorizontalProgressBarWithNumber mPb;\n&#x27;
                           &#x27;  private Button mStart;\n&#x27;
                           &#x27;  private Button mStop;\n&#x27;
                           &#x27;  private Button mCancel;\n&#x27;
                           &#x27;  private TextView mSize;\n&#x27;
                           &#x27;  private TextView mSpeed;\n&#x27;
                           &#x27;  private RecyclerView mList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  private String mTaskName = &quot;光明大陆&quot;;\n&#x27;
                           &#x27;  private static final String DOWNLOAD_URL =\n&#x27;
                           &#x27;      &#x27;
                           &#x27;&quot;https://res5.d.cn/6f78ee3bcfdd033e64892a8553a95814cf5b4a62b12a76d9eb2a694905f0dc30fa5c7f728806a4ee0b3479e7b26a38707dac92b136add91191ac1219aadb4a3aa70bfa6d06d2d8db.apk&quot;;\n&#x27;
                           &#x27;  private DownloadAdapter mAdapter;\n&#x27;
                           &#x27;  private List&lt;AbsEntity&gt; mData = new &#x27;
                           &#x27;ArrayList&lt;&gt;();\n&#x27;
                           &#x27;  private Set&lt;String&gt; mRecord = new HashSet&lt;&gt;();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override protected int setLayoutId() {\n&#x27;
                           &#x27;    return R.layout.activity_highest_priority;\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override protected void init(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;    super.init(savedInstanceState);\n&#x27;
                           &#x27;    mPb = findViewById(R.id.progressBar);\n&#x27;
                           &#x27;    mStart = findViewById(R.id.start);\n&#x27;
                           &#x27;    mStop = findViewById(R.id.stop);\n&#x27;
                           &#x27;    mCancel = findViewById(R.id.cancel);\n&#x27;
                           &#x27;    mSize = findViewById(R.id.size);\n&#x27;
                           &#x27;    mSpeed = findViewById(R.id.speed);\n&#x27;
                           &#x27;    mList = findViewById(R.id.list);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    setTitle(&quot;最高优先级任务&quot;);\n&#x27;
                           &#x27;    getBinding().setTaskName(&quot;任务名：&quot; + mTaskName + &#x27;
                           &#x27;&quot; （最高优先级任务）&quot;);\n&#x27;
                           &#x27;    initWidget();\n&#x27;
                           &#x27;    Aria.download(this).register();\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  private void initWidget() {\n&#x27;
                           &#x27;    DownloadTarget target = &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL);\n&#x27;
                           &#x27;    mPb.setProgress(target.getPercent());\n&#x27;
                           &#x27;    if (target.getTaskState() == &#x27;
                           &#x27;IEntity.STATE_STOP) {\n&#x27;
                           &#x27;      mStart.setText(&quot;恢复&quot;);\n&#x27;
                           &#x27;      &#x27;
                           &#x27;mStart.setTextColor(getResources().getColor(android.R.color.holo_blue_light));\n&#x27;
                           &#x27;      setBtState(true);\n&#x27;
                           &#x27;    } else if (target.isRunning()) {\n&#x27;
                           &#x27;      setBtState(false);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;    mSize.setText(target.getConvertFileSize());\n&#x27;
                           &#x27;    List&lt;DownloadEntity&gt; temp = &#x27;
                           &#x27;Aria.download(this).getTaskList();\n&#x27;
                           &#x27;    if (temp != null &amp;&amp; !temp.isEmpty()) {\n&#x27;
                           &#x27;      for (DownloadEntity entity : temp) {\n&#x27;
                           &#x27;        if (entity.getUrl().equals(DOWNLOAD_URL)) &#x27;
                           &#x27;continue;\n&#x27;
                           &#x27;        mData.add(entity);\n&#x27;
                           &#x27;        mRecord.add(entity.getUrl());\n&#x27;
                           &#x27;      }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;    mAdapter = new DownloadAdapter(this, mData);\n&#x27;
                           &#x27;    mList.setLayoutManager(new &#x27;
                           &#x27;LinearLayoutManager(this));\n&#x27;
                           &#x27;    mList.setAdapter(mAdapter);\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override public boolean &#x27;
                           &#x27;onCreateOptionsMenu(Menu menu) {\n&#x27;
                           &#x27;    &#x27;
                           &#x27;getMenuInflater().inflate(R.menu.menu_highest_priority, &#x27;
                           &#x27;menu);\n&#x27;
                           &#x27;    return super.onCreateOptionsMenu(menu);\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override public boolean &#x27;
                           &#x27;onMenuItemClick(MenuItem item) {\n&#x27;
                           &#x27;    switch (item.getItemId()) {\n&#x27;
                           &#x27;      case R.id.add_task:\n&#x27;
                           &#x27;        List&lt;DownloadEntity&gt; temp = &#x27;
                           &#x27;getModule(DownloadModule.class).getHighestTestList();\n&#x27;
                           &#x27;        for (DownloadEntity entity : temp) {\n&#x27;
                           &#x27;          String url = entity.getUrl();\n&#x27;
                           &#x27;          if (mRecord.contains(url)) {\n&#x27;
                           &#x27;            continue;\n&#x27;
                           &#x27;          }\n&#x27;
                           &#x27;          mAdapter.addDownloadEntity(entity);\n&#x27;
                           &#x27;          mRecord.add(url);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;      case R.id.help:\n&#x27;
                           &#x27;        String title = &quot;最高优先级任务介绍&quot;;\n&#x27;
                           &#x27;        String msg = &quot; &#x27;
                           &#x27;将任务设置为最高优先级任务，最高优先级任务有以下特点：\\n&quot;\n&#x27;
                           &#x27;            + &quot; 1、在下载队列中，有且只有一个最高优先级任务\\n&quot;\n&#x27;
                           &#x27;            + &quot; 2、最高优先级任务会一直存在，直到用户手动暂停或任务完成\\n&quot;\n&#x27;
                           &#x27;            + &quot; 3、任务调度器不会暂停最高优先级任务\\n&quot;\n&#x27;
                           &#x27;            + &quot; &#x27;
                           &#x27;4、用户手动暂停或任务完成后，第二次重新执行该任务，该命令将失效\\n&quot;\n&#x27;
                           &#x27;            + &quot; &#x27;
                           &#x27;5、如果下载队列中已经满了，则会停止队尾的任务，当高优先级任务完成后，该队尾任务将自动执行\\n&quot;\n&#x27;
                           &#x27;            + &quot; &#x27;
                           &#x27;6、把任务设置为最高优先级任务后，将自动执行任务，不需要重新调用start()启动任务&quot;;\n&#x27;
                           &#x27;        showMsgDialog(title, msg);\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;    return true;\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  public void onClick(View view) {\n&#x27;
                           &#x27;    switch (view.getId()) {\n&#x27;
                           &#x27;      case R.id.start:\n&#x27;
                           &#x27;        String text = ((TextView) &#x27;
                           &#x27;view).getText().toString();\n&#x27;
                           &#x27;        if (text.equals(&quot;重新开始？&quot;) || &#x27;
                           &#x27;text.equals(&quot;开始&quot;)) {\n&#x27;
                           &#x27;          Aria.download(this)\n&#x27;
                           &#x27;              .load(DOWNLOAD_URL)\n&#x27;
                           &#x27;              &#x27;
                           &#x27;.setFilePath(Environment.getExternalStorageDirectory().getPath()\n&#x27;
                           &#x27;                  + &quot;/Download/&quot;\n&#x27;
                           &#x27;                  + mTaskName\n&#x27;
                           &#x27;                  + &quot;.apk&quot;)\n&#x27;
                           &#x27;              .setHighestPriority();\n&#x27;
                           &#x27;        } else if (text.equals(&quot;恢复&quot;)) {\n&#x27;
                           &#x27;          &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL).resume();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;      case R.id.stop:\n&#x27;
                           &#x27;        &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL).pause();\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;      case R.id.cancel:\n&#x27;
                           &#x27;        &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL).cancel();\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import com.arialyy.aria.core.download.DownloadTask;\n&#x27;
                         &#x27;import com.arialyy.aria.core.inf.AbsEntity;\n&#x27;
                         &#x27;import com.arialyy.aria.core.inf.IEntity;\n&#x27;
                         &#x27;import com.arialyy.frame.util.show.L;\n&#x27;
                         &#x27;import com.arialyy.simple.R;\n&#x27;
                         &#x27;import com.arialyy.simple.base.BaseActivity;\n&#x27;
                         &#x27;import &#x27;
                         &#x27;com.arialyy.simple.core.download.multi_download.DownloadAdapter;\n&#x27;
                         &#x27;import &#x27;
                         &#x27;com.arialyy.simple.databinding.ActivityHighestPriorityBinding;\n&#x27;
                         &#x27;import com.arialyy.simple.util.AppUtil;\n&#x27;
                         &#x27;import &#x27;
                         &#x27;com.arialyy.simple.widget.HorizontalProgressBarWithNumber;\n&#x27;
                         &#x27;import java.util.ArrayList;\n&#x27;
                         &#x27;import java.util.HashSet;\n&#x27;
                         &#x27;import java.util.List;\n&#x27;
                         &#x27;import java.util.Set;\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;/**\n&#x27;
                         &#x27; * Created by lyy on 2017/6/2.\n&#x27;
                         &#x27; * 最高优先级任务Demo\n&#x27;
                         &#x27; */\n&#x27;
                         &#x27;public class HighestPriorityActivity extends &#x27;
                         &#x27;BaseActivity&lt;ActivityHighestPriorityBinding&gt; {\n&#x27;
                         &#x27;  private HorizontalProgressBarWithNumber mPb;\n&#x27;
                         &#x27;  private Button mStart;\n&#x27;
                         &#x27;  private Button mStop;\n&#x27;
                         &#x27;  private Button mCancel;\n&#x27;
                         &#x27;  private TextView mSize;\n&#x27;
                         &#x27;  private TextView mSpeed;\n&#x27;
                         &#x27;  private RecyclerView mList;\n&#x27;
                         &#x27;  private DownloadEntity mEntity;\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  private String mTaskName = &quot;光明大陆&quot;;\n&#x27;
                         &#x27;  private static final String DOWNLOAD_URL =\n&#x27;
                         &#x27;      &#x27;
                         &#x27;&quot;https://res5.d.cn/6f78ee3bcfdd033e64892a8553a95814cf5b4a62b12a76d9eb2a694905f0dc30fa5c7f728806a4ee0b3479e7b26a38707dac92b136add91191ac1219aadb4a3aa70bfa6d06d2d8db.apk&quot;;\n&#x27;
                         &#x27;  private DownloadAdapter mAdapter;\n&#x27;
                         &#x27;  private List&lt;AbsEntity&gt; mData = new &#x27;
                         &#x27;ArrayList&lt;&gt;();\n&#x27;
                         &#x27;  private Set&lt;String&gt; mRecord = new HashSet&lt;&gt;();\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override protected int setLayoutId() {\n&#x27;
                         &#x27;    return R.layout.activity_highest_priority;\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override protected void init(Bundle &#x27;
                         &#x27;savedInstanceState) {\n&#x27;
                         &#x27;    super.init(savedInstanceState);\n&#x27;
                         &#x27;    mPb = findViewById(R.id.progressBar);\n&#x27;
                         &#x27;    mStart = findViewById(R.id.start);\n&#x27;
                         &#x27;    mStop = findViewById(R.id.stop);\n&#x27;
                         &#x27;    mCancel = findViewById(R.id.cancel);\n&#x27;
                         &#x27;    mSize = findViewById(R.id.size);\n&#x27;
                         &#x27;    mSpeed = findViewById(R.id.speed);\n&#x27;
                         &#x27;    mList = findViewById(R.id.list);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;    setTitle(&quot;最高优先级任务&quot;);\n&#x27;
                         &#x27;    getBinding().setTaskName(&quot;任务名：&quot; + mTaskName + &quot; &#x27;
                         &#x27;（最高优先级任务）&quot;);\n&#x27;
                         &#x27;    initWidget();\n&#x27;
                         &#x27;    Aria.download(this).register();\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  private void initWidget() {\n&#x27;
                         &#x27;    mEntity = &#x27;
                         &#x27;Aria.download(this).getFirstDownloadEntity(DOWNLOAD_URL);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;    if (mEntity != null) {\n&#x27;
                         &#x27;      mPb.setProgress(mEntity.getPercent());\n&#x27;
                         &#x27;      if (mEntity.getState() == IEntity.STATE_STOP) &#x27;
                         &#x27;{\n&#x27;
                         &#x27;        mStart.setText(&quot;恢复&quot;);\n&#x27;
                         &#x27;        &#x27;
                         &#x27;mStart.setTextColor(getResources().getColor(android.R.color.holo_blue_light));\n&#x27;
                         &#x27;        setBtState(true);\n&#x27;
                         &#x27;      } else if (mEntity.getState() == &#x27;
                         &#x27;IEntity.STATE_RUNNING) {\n&#x27;
                         &#x27;        setBtState(false);\n&#x27;
                         &#x27;      }\n&#x27;
                         &#x27;      mSize.setText(mEntity.getConvertFileSize());\n&#x27;
                         &#x27;    }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;    List&lt;DownloadEntity&gt; temp = &#x27;
                         &#x27;Aria.download(this).getTaskList();\n&#x27;
                         &#x27;    if (temp != null &amp;&amp; !temp.isEmpty()) {\n&#x27;
                         &#x27;      for (DownloadEntity entity : temp) {\n&#x27;
                         &#x27;        if (entity.getUrl().equals(DOWNLOAD_URL)) &#x27;
                         &#x27;continue;\n&#x27;
                         &#x27;        mData.add(entity);\n&#x27;
                         &#x27;        mRecord.add(entity.getUrl());\n&#x27;
                         &#x27;      }\n&#x27;
                         &#x27;    }\n&#x27;
                         &#x27;    mAdapter = new DownloadAdapter(this, mData);\n&#x27;
                         &#x27;    mList.setLayoutManager(new &#x27;
                         &#x27;LinearLayoutManager(this));\n&#x27;
                         &#x27;    mList.setAdapter(mAdapter);\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override public boolean onCreateOptionsMenu(Menu &#x27;
                         &#x27;menu) {\n&#x27;
                         &#x27;    &#x27;
                         &#x27;getMenuInflater().inflate(R.menu.menu_highest_priority, &#x27;
                         &#x27;menu);\n&#x27;
                         &#x27;    return super.onCreateOptionsMenu(menu);\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  @Override public boolean onMenuItemClick(MenuItem &#x27;
                         &#x27;item) {\n&#x27;
                         &#x27;    switch (item.getItemId()) {\n&#x27;
                         &#x27;      case R.id.add_task:\n&#x27;
                         &#x27;        List&lt;DownloadEntity&gt; temp = &#x27;
                         &#x27;getModule(DownloadModule.class).getHighestTestList();\n&#x27;
                         &#x27;        for (DownloadEntity entity : temp) {\n&#x27;
                         &#x27;          String url = entity.getUrl();\n&#x27;
                         &#x27;          if (mRecord.contains(url)) {\n&#x27;
                         &#x27;            continue;\n&#x27;
                         &#x27;          }\n&#x27;
                         &#x27;          mAdapter.addDownloadEntity(entity);\n&#x27;
                         &#x27;          mRecord.add(url);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;        mAdapter.notifyDataSetChanged();\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;      case R.id.help:\n&#x27;
                         &#x27;        String title = &quot;最高优先级任务介绍&quot;;\n&#x27;
                         &#x27;        String msg = &quot; &#x27;
                         &#x27;将任务设置为最高优先级任务，最高优先级任务有以下特点：\\n&quot;\n&#x27;
                         &#x27;            + &quot; 1、在下载队列中，有且只有一个最高优先级任务\\n&quot;\n&#x27;
                         &#x27;            + &quot; 2、最高优先级任务会一直存在，直到用户手动暂停或任务完成\\n&quot;\n&#x27;
                         &#x27;            + &quot; 3、任务调度器不会暂停最高优先级任务\\n&quot;\n&#x27;
                         &#x27;            + &quot; &#x27;
                         &#x27;4、用户手动暂停或任务完成后，第二次重新执行该任务，该命令将失效\\n&quot;\n&#x27;
                         &#x27;            + &quot; &#x27;
                         &#x27;5、如果下载队列中已经满了，则会停止队尾的任务，当高优先级任务完成后，该队尾任务将自动执行\\n&quot;\n&#x27;
                         &#x27;            + &quot; &#x27;
                         &#x27;6、把任务设置为最高优先级任务后，将自动执行任务，不需要重新调用start()启动任务&quot;;\n&#x27;
                         &#x27;        showMsgDialog(title, msg);\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;    }\n&#x27;
                         &#x27;    return true;\n&#x27;
                         &#x27;  }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;  public void onClick(View view) {\n&#x27;
                         &#x27;    switch (view.getId()) {\n&#x27;
                         &#x27;      case R.id.start:\n&#x27;
                         &#x27;        if (AppUtil.chekEntityValid(mEntity)) {\n&#x27;
                         &#x27;          Aria.download(this)\n&#x27;
                         &#x27;              .load(DOWNLOAD_URL)\n&#x27;
                         &#x27;              &#x27;
                         &#x27;.setFilePath(Environment.getExternalStorageDirectory().getPath()\n&#x27;
                         &#x27;                  + &quot;/Download/&quot;\n&#x27;
                         &#x27;                  + mTaskName\n&#x27;
                         &#x27;                  + &quot;.apk&quot;)\n&#x27;
                         &#x27;              .setHighestPriority();\n&#x27;
                         &#x27;        } else {\n&#x27;
                         &#x27;          &#x27;
                         &#x27;Aria.download(this).load(mEntity.getId()).resume();\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;        ((TextView) &#x27;
                         &#x27;view).setText(getString(R.string.stop));\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;      case R.id.stop:\n&#x27;
                         &#x27;        if (AppUtil.chekEntityValid(mEntity)) {\n&#x27;
                         &#x27;          &#x27;
                         &#x27;Aria.download(this).load(mEntity.getId()).stop();\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;        ((TextView) &#x27;
                         &#x27;view).setText(getString(R.string.resume));\n&#x27;
                         &#x27;        break;\n&#x27;
                         &#x27;      case R.id.cancel:\n&#x27;
                         &#x27;        if (AppUtil.chekEntityValid(mEntity)) {\n&#x27;
                         &#x27;          &#x27;
                         &#x27;Aria.download(this).load(mEntity.getId()).cancel();\n&#x27;
                         &#x27;        }\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import &#x27;
                           &#x27;com.arialyy.aria.core.download.DownloadTarget;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.aria.core.download.DownloadTask;\n&#x27;
                           &#x27;import com.arialyy.aria.core.inf.AbsEntity;\n&#x27;
                           &#x27;import com.arialyy.aria.core.inf.IEntity;\n&#x27;
                           &#x27;import com.arialyy.frame.util.show.L;\n&#x27;
                           &#x27;import com.arialyy.simple.R;\n&#x27;
                           &#x27;import com.arialyy.simple.base.BaseActivity;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.simple.databinding.ActivityHighestPriorityBinding;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.simple.core.download.multi_download.DownloadAdapter;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.arialyy.simple.widget.HorizontalProgressBarWithNumber;\n&#x27;
                           &#x27;import java.util.ArrayList;\n&#x27;
                           &#x27;import java.util.HashSet;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Set;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Created by lyy on 2017/6/2.\n&#x27;
                           &#x27; * 最高优先级任务Demo\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class HighestPriorityActivity extends &#x27;
                           &#x27;BaseActivity&lt;ActivityHighestPriorityBinding&gt; {\n&#x27;
                           &#x27;  private HorizontalProgressBarWithNumber mPb;\n&#x27;
                           &#x27;  private Button mStart;\n&#x27;
                           &#x27;  private Button mStop;\n&#x27;
                           &#x27;  private Button mCancel;\n&#x27;
                           &#x27;  private TextView mSize;\n&#x27;
                           &#x27;  private TextView mSpeed;\n&#x27;
                           &#x27;  private RecyclerView mList;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  private String mTaskName = &quot;光明大陆&quot;;\n&#x27;
                           &#x27;  private static final String DOWNLOAD_URL =\n&#x27;
                           &#x27;      &#x27;
                           &#x27;&quot;https://res5.d.cn/6f78ee3bcfdd033e64892a8553a95814cf5b4a62b12a76d9eb2a694905f0dc30fa5c7f728806a4ee0b3479e7b26a38707dac92b136add91191ac1219aadb4a3aa70bfa6d06d2d8db.apk&quot;;\n&#x27;
                           &#x27;  private DownloadAdapter mAdapter;\n&#x27;
                           &#x27;  private List&lt;AbsEntity&gt; mData = new &#x27;
                           &#x27;ArrayList&lt;&gt;();\n&#x27;
                           &#x27;  private Set&lt;String&gt; mRecord = new HashSet&lt;&gt;();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override protected int setLayoutId() {\n&#x27;
                           &#x27;    return R.layout.activity_highest_priority;\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override protected void init(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;    super.init(savedInstanceState);\n&#x27;
                           &#x27;    mPb = findViewById(R.id.progressBar);\n&#x27;
                           &#x27;    mStart = findViewById(R.id.start);\n&#x27;
                           &#x27;    mStop = findViewById(R.id.stop);\n&#x27;
                           &#x27;    mCancel = findViewById(R.id.cancel);\n&#x27;
                           &#x27;    mSize = findViewById(R.id.size);\n&#x27;
                           &#x27;    mSpeed = findViewById(R.id.speed);\n&#x27;
                           &#x27;    mList = findViewById(R.id.list);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    setTitle(&quot;最高优先级任务&quot;);\n&#x27;
                           &#x27;    getBinding().setTaskName(&quot;任务名：&quot; + mTaskName + &#x27;
                           &#x27;&quot; （最高优先级任务）&quot;);\n&#x27;
                           &#x27;    initWidget();\n&#x27;
                           &#x27;    Aria.download(this).register();\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  private void initWidget() {\n&#x27;
                           &#x27;    DownloadTarget target = &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL);\n&#x27;
                           &#x27;    mPb.setProgress(target.getPercent());\n&#x27;
                           &#x27;    if (target.getTaskState() == &#x27;
                           &#x27;IEntity.STATE_STOP) {\n&#x27;
                           &#x27;      mStart.setText(&quot;恢复&quot;);\n&#x27;
                           &#x27;      &#x27;
                           &#x27;mStart.setTextColor(getResources().getColor(android.R.color.holo_blue_light));\n&#x27;
                           &#x27;      setBtState(true);\n&#x27;
                           &#x27;    } else if (target.isRunning()) {\n&#x27;
                           &#x27;      setBtState(false);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;    mSize.setText(target.getConvertFileSize());\n&#x27;
                           &#x27;    List&lt;DownloadEntity&gt; temp = &#x27;
                           &#x27;Aria.download(this).getTaskList();\n&#x27;
                           &#x27;    if (temp != null &amp;&amp; !temp.isEmpty()) {\n&#x27;
                           &#x27;      for (DownloadEntity entity : temp) {\n&#x27;
                           &#x27;        if (entity.getUrl().equals(DOWNLOAD_URL)) &#x27;
                           &#x27;continue;\n&#x27;
                           &#x27;        mData.add(entity);\n&#x27;
                           &#x27;        mRecord.add(entity.getUrl());\n&#x27;
                           &#x27;      }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;    mAdapter = new DownloadAdapter(this, mData);\n&#x27;
                           &#x27;    mList.setLayoutManager(new &#x27;
                           &#x27;LinearLayoutManager(this));\n&#x27;
                           &#x27;    mList.setAdapter(mAdapter);\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override public boolean &#x27;
                           &#x27;onCreateOptionsMenu(Menu menu) {\n&#x27;
                           &#x27;    &#x27;
                           &#x27;getMenuInflater().inflate(R.menu.menu_highest_priority, &#x27;
                           &#x27;menu);\n&#x27;
                           &#x27;    return super.onCreateOptionsMenu(menu);\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  @Override public boolean &#x27;
                           &#x27;onMenuItemClick(MenuItem item) {\n&#x27;
                           &#x27;    switch (item.getItemId()) {\n&#x27;
                           &#x27;      case R.id.add_task:\n&#x27;
                           &#x27;        List&lt;DownloadEntity&gt; temp = &#x27;
                           &#x27;getModule(DownloadModule.class).getHighestTestList();\n&#x27;
                           &#x27;        for (DownloadEntity entity : temp) {\n&#x27;
                           &#x27;          String url = entity.getUrl();\n&#x27;
                           &#x27;          if (mRecord.contains(url)) {\n&#x27;
                           &#x27;            continue;\n&#x27;
                           &#x27;          }\n&#x27;
                           &#x27;          mAdapter.addDownloadEntity(entity);\n&#x27;
                           &#x27;          mRecord.add(url);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;      case R.id.help:\n&#x27;
                           &#x27;        String title = &quot;最高优先级任务介绍&quot;;\n&#x27;
                           &#x27;        String msg = &quot; &#x27;
                           &#x27;将任务设置为最高优先级任务，最高优先级任务有以下特点：\\n&quot;\n&#x27;
                           &#x27;            + &quot; 1、在下载队列中，有且只有一个最高优先级任务\\n&quot;\n&#x27;
                           &#x27;            + &quot; 2、最高优先级任务会一直存在，直到用户手动暂停或任务完成\\n&quot;\n&#x27;
                           &#x27;            + &quot; 3、任务调度器不会暂停最高优先级任务\\n&quot;\n&#x27;
                           &#x27;            + &quot; &#x27;
                           &#x27;4、用户手动暂停或任务完成后，第二次重新执行该任务，该命令将失效\\n&quot;\n&#x27;
                           &#x27;            + &quot; &#x27;
                           &#x27;5、如果下载队列中已经满了，则会停止队尾的任务，当高优先级任务完成后，该队尾任务将自动执行\\n&quot;\n&#x27;
                           &#x27;            + &quot; &#x27;
                           &#x27;6、把任务设置为最高优先级任务后，将自动执行任务，不需要重新调用start()启动任务&quot;;\n&#x27;
                           &#x27;        showMsgDialog(title, msg);\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;    return true;\n&#x27;
                           &#x27;  }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;  public void onClick(View view) {\n&#x27;
                           &#x27;    switch (view.getId()) {\n&#x27;
                           &#x27;      case R.id.start:\n&#x27;
                           &#x27;        String text = ((TextView) &#x27;
                           &#x27;view).getText().toString();\n&#x27;
                           &#x27;        if (text.equals(&quot;重新开始？&quot;) || &#x27;
                           &#x27;text.equals(&quot;开始&quot;)) {\n&#x27;
                           &#x27;          Aria.download(this)\n&#x27;
                           &#x27;              .load(DOWNLOAD_URL)\n&#x27;
                           &#x27;              &#x27;
                           &#x27;.setFilePath(Environment.getExternalStorageDirectory().getPath()\n&#x27;
                           &#x27;                  + &quot;/Download/&quot;\n&#x27;
                           &#x27;                  + mTaskName\n&#x27;
                           &#x27;                  + &quot;.apk&quot;)\n&#x27;
                           &#x27;              .setHighestPriority();\n&#x27;
                           &#x27;        } else if (text.equals(&quot;恢复&quot;)) {\n&#x27;
                           &#x27;          &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL).resume();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;      case R.id.stop:\n&#x27;
                           &#x27;        &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL).pause();\n&#x27;
                           &#x27;        break;\n&#x27;
                           &#x27;      case R.id.cancel:\n&#x27;
                           &#x27;        &#x27;
                           &#x27;Aria.download(this).load(DOWNLOAD_URL).cancel();\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;}}]]</pre>
          </body>
        </html>
        