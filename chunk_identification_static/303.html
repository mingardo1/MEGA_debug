<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>303</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    303
                    <a href="302.html">prev</a>
                    <a href="304.html">next</a>
                    <a href="303_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    BroadleafCommerce/BroadleafCommerce_cd7cff12a798c3a68943ad44552e25fb0f98f8d1_admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/web/controller/entity/AdminBasicEntityController.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;cd7cff12a798c3a68943ad44552e25fb0f98f8d1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/web/controller/entity/AdminBasicEntityController.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;cd7cff12a798c3a68943ad44552e25fb0f98f8d1^1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/web/controller/entity/AdminBasicEntityController.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;cd7cff12a798c3a68943ad44552e25fb0f98f8d1^2:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/web/controller/entity/AdminBasicEntityController.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;556ac57d12139326e76b29db4638956d93283fb1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/web/controller/entity/AdminBasicEntityController.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="913821711322743166" onmouseenter="enter('913821711322743166');" onmouseout="out('913821711322743166');" style="">  18 package org.broadleafcommerce.openadmin.web.controller.entity;                                           </span>
<span  style="">  19                                                                                                          </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  20 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  21 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="3542918789910249764" onmouseenter="enter('3542918789910249764');" onmouseout="out('3542918789910249764');" style="">  25 import org.broadleafcommerce.common.exception.SecurityServiceException;                                  </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  26 import org.broadleafcommerce.common.exception.ServiceException;                                          </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  27 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  28 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-3349026188166660873" onmouseenter="enter('-3349026188166660873');" onmouseout="out('-3349026188166660873');" style="">  29 import org.broadleafcommerce.common.persistence.EntityDuplicator;                                        </span>
<span class="-6648433550510659033" onmouseenter="enter('-6648433550510659033');" onmouseout="out('-6648433550510659033');" style="">  30 import org.broadleafcommerce.common.presentation.client.AddMethodType;                                   </span>
<span class="1362364260528215152" onmouseenter="enter('1362364260528215152');" onmouseout="out('1362364260528215152');" style="">  31 import org.broadleafcommerce.common.presentation.client.SupportedFieldType;                              </span>
<span class="-2818686525334833130" onmouseenter="enter('-2818686525334833130');" onmouseout="out('-2818686525334833130');" style="">  32 import org.broadleafcommerce.common.sandbox.SandBoxHelper;                                               </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  33 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="2429458746821399950" onmouseenter="enter('2429458746821399950');" onmouseout="out('2429458746821399950');" style="">  34 import org.broadleafcommerce.common.util.BLCArrayUtils;                                                  </span>
<span class="2428099238642943960" onmouseenter="enter('2428099238642943960');" onmouseout="out('2428099238642943960');" style="">  35 import org.broadleafcommerce.common.util.BLCMessageUtils;                                                </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  36 import org.broadleafcommerce.common.web.BroadleafRequestContext;                                         </span>
<span class="-1418036767363331062" onmouseenter="enter('-1418036767363331062');" onmouseout="out('-1418036767363331062');" style="">  37 import org.broadleafcommerce.common.web.JsonResponse;                                                    </span>
<span class="-3361215363157046739" onmouseenter="enter('-3361215363157046739');" onmouseout="out('-3361215363157046739');" style="">  38 import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;                              </span>
<span class="-1781055592725563383" onmouseenter="enter('-1781055592725563383');" onmouseout="out('-1781055592725563383');" style="">  39 import org.broadleafcommerce.openadmin.dto.AdornedTargetList;                                            </span>
<span class="-6140296335181984013" onmouseenter="enter('-6140296335181984013');" onmouseout="out('-6140296335181984013');" style="">  40 import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;                                      </span>
<span class="4427537537958608766" onmouseenter="enter('4427537537958608766');" onmouseout="out('4427537537958608766');" style="">  41 import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;                                           </span>
<span class="-1607559599739253077" onmouseenter="enter('-1607559599739253077');" onmouseout="out('-1607559599739253077');" style="">  42 import org.broadleafcommerce.openadmin.dto.ClassMetadata;                                                </span>
<span class="5550564421881377532" onmouseenter="enter('5550564421881377532');" onmouseout="out('5550564421881377532');" style="">  43 import org.broadleafcommerce.openadmin.dto.ClassTree;                                                    </span>
<span class="-3165611006566133086" onmouseenter="enter('-3165611006566133086');" onmouseout="out('-3165611006566133086');" style="">  44 import org.broadleafcommerce.openadmin.dto.CollectionMetadata;                                           </span>
<span class="-4742435063138209714" onmouseenter="enter('-4742435063138209714');" onmouseout="out('-4742435063138209714');" style="">  45 import org.broadleafcommerce.openadmin.dto.DynamicResultSet;                                             </span>
<span class="-5093421835888664541" onmouseenter="enter('-5093421835888664541');" onmouseout="out('-5093421835888664541');" style="">  46 import org.broadleafcommerce.openadmin.dto.Entity;                                                       </span>
<span class="-8829499667991596741" onmouseenter="enter('-8829499667991596741');" onmouseout="out('-8829499667991596741');" style="">  47 import org.broadleafcommerce.openadmin.dto.FieldMetadata;                                                </span>
<span class="6369021917986026789" onmouseenter="enter('6369021917986026789');" onmouseout="out('6369021917986026789');" style="">  48 import org.broadleafcommerce.openadmin.dto.FilterAndSortCriteria;                                        </span>
<span class="826821438795056004" onmouseenter="enter('826821438795056004');" onmouseout="out('826821438795056004');" style="">  49 import org.broadleafcommerce.openadmin.dto.MapMetadata;                                                  </span>
<span class="1983554291461039357" onmouseenter="enter('1983554291461039357');" onmouseout="out('1983554291461039357');" style="">  50 import org.broadleafcommerce.openadmin.dto.Property;                                                     </span>
<span class="1696571253156436279" onmouseenter="enter('1696571253156436279');" onmouseout="out('1696571253156436279');" style="">  51 import org.broadleafcommerce.openadmin.dto.SectionCrumb;                                                 </span>
<span class="5662236005419086618" onmouseenter="enter('5662236005419086618');" onmouseout="out('5662236005419086618');" style="">  52 import org.broadleafcommerce.openadmin.dto.TabMetadata;                                                  </span>
<span class="-8828889589519173652" onmouseenter="enter('-8828889589519173652');" onmouseout="out('-8828889589519173652');" style="">  53 import org.broadleafcommerce.openadmin.server.dao.DynamicEntityDao;                                      </span>
<span class="4410643013278245372" onmouseenter="enter('4410643013278245372');" onmouseout="out('4410643013278245372');" style="">  54 import org.broadleafcommerce.openadmin.server.domain.PersistencePackageRequest;                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  55 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-7620175268967942501" onmouseenter="enter('-7620175268967942501');" onmouseout="out('-7620175268967942501');" style="">  56 import org.broadleafcommerce.openadmin.server.security.domain.AdminSection;                              </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  57 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-4641149340176766185" onmouseenter="enter('-4641149340176766185');" onmouseout="out('-4641149340176766185');" style="">  58 import org.broadleafcommerce.openadmin.server.security.remote.EntityOperationType;                       </span>
<span class="78786346091609662" onmouseenter="enter('78786346091609662');" onmouseout="out('78786346091609662');" style="">  59 import org.broadleafcommerce.openadmin.server.security.service.RowLevelSecurityService;                  </span>
<span class="-8603256547657551769" onmouseenter="enter('-8603256547657551769');" onmouseout="out('-8603256547657551769');" style="">  60 import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;                   </span>
<span class="5585583973934060515" onmouseenter="enter('5585583973934060515');" onmouseout="out('5585583973934060515');" style=""><abbr title="  61 import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExtensionManager;">  61 import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExteðŸ”µ</abbr></span>
<span class="-3086540061138981164" onmouseenter="enter('-3086540061138981164');" onmouseout="out('-3086540061138981164');" style="">  62 import org.broadleafcommerce.openadmin.server.service.persistence.module.BasicPersistenceModule;         </span>
<span class="9131075895472939574" onmouseenter="enter('9131075895472939574');" onmouseout="out('9131075895472939574');" style="">  63 import org.broadleafcommerce.openadmin.web.controller.AdminAbstractController;                           </span>
<span class="7254479112554025637" onmouseenter="enter('7254479112554025637');" onmouseout="out('7254479112554025637');" style="">  64 import org.broadleafcommerce.openadmin.web.controller.modal.ModalHeaderType;                             </span>
<span class="4507704609742395614" onmouseenter="enter('4507704609742395614');" onmouseout="out('4507704609742395614');" style="">  65 import org.broadleafcommerce.openadmin.web.editor.NonNullBooleanEditor;                                  </span>
<span class="-2042519459673859584" onmouseenter="enter('-2042519459673859584');" onmouseout="out('-2042519459673859584');" style="">  66 import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;                        </span>
<span class="3056790491614608405" onmouseenter="enter('3056790491614608405');" onmouseout="out('3056790491614608405');" style="">  67 import org.broadleafcommerce.openadmin.web.form.component.ListGrid;                                      </span>
<span class="1405974373227613661" onmouseenter="enter('1405974373227613661');" onmouseout="out('1405974373227613661');" style="">  68 import org.broadleafcommerce.openadmin.web.form.entity.DefaultAdornedEntityFormActions;                  </span>
<span class="2718350422838759693" onmouseenter="enter('2718350422838759693');" onmouseout="out('2718350422838759693');" style="">  69 import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;                         </span>
<span class="-3560862041655103076" onmouseenter="enter('-3560862041655103076');" onmouseout="out('-3560862041655103076');" style="">  70 import org.broadleafcommerce.openadmin.web.form.entity.DefaultMainActions;                               </span>
<span class="8035715143965725316" onmouseenter="enter('8035715143965725316');" onmouseout="out('8035715143965725316');" style="">  71 import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;                                       </span>
<span class="-3164920911156953697" onmouseenter="enter('-3164920911156953697');" onmouseout="out('-3164920911156953697');" style="">  72 import org.broadleafcommerce.openadmin.web.form.entity.EntityFormAction;                                 </span>
<span class="6015559832933397076" onmouseenter="enter('6015559832933397076');" onmouseout="out('6015559832933397076');" style="">  73 import org.broadleafcommerce.openadmin.web.form.entity.Field;                                            </span>
<span class="-5634654756625156689" onmouseenter="enter('-5634654756625156689');" onmouseout="out('-5634654756625156689');" style="">  74 import org.broadleafcommerce.openadmin.web.form.entity.FieldGroup;                                       </span>
<span class="8763280003660953520" onmouseenter="enter('8763280003660953520');" onmouseout="out('8763280003660953520');" style="">  75 import org.springframework.beans.propertyeditors.StringTrimmerEditor;                                    </span>
<span class="4128309806836178094" onmouseenter="enter('4128309806836178094');" onmouseout="out('4128309806836178094');" style="">  76 import org.springframework.stereotype.Controller;                                                        </span>
<span class="2230089600625206822" onmouseenter="enter('2230089600625206822');" onmouseout="out('2230089600625206822');" style="">  77 import org.springframework.ui.Model;                                                                     </span>
<span class="-8661390401087732702" onmouseenter="enter('-8661390401087732702');" onmouseout="out('-8661390401087732702');" style="">  78 import org.springframework.util.MultiValueMap;                                                           </span>
<span class="-5446610002806720528" onmouseenter="enter('-5446610002806720528');" onmouseout="out('-5446610002806720528');" style="">  79 import org.springframework.validation.BindingResult;                                                     </span>
<span class="-5956639343389312225" onmouseenter="enter('-5956639343389312225');" onmouseout="out('-5956639343389312225');" style="">  80 import org.springframework.web.bind.WebDataBinder;                                                       </span>
<span class="6486986322776186621" onmouseenter="enter('6486986322776186621');" onmouseout="out('6486986322776186621');" style="">  81 import org.springframework.web.bind.annotation.InitBinder;                                               </span>
<span class="2718246165073723950" onmouseenter="enter('2718246165073723950');" onmouseout="out('2718246165073723950');" style="">  82 import org.springframework.web.bind.annotation.ModelAttribute;                                           </span>
<span class="3963501418927616634" onmouseenter="enter('3963501418927616634');" onmouseout="out('3963501418927616634');" style="">  83 import org.springframework.web.bind.annotation.PathVariable;                                             </span>
<span class="-7989471178862524182" onmouseenter="enter('-7989471178862524182');" onmouseout="out('-7989471178862524182');" style="">  84 import org.springframework.web.bind.annotation.RequestMapping;                                           </span>
<span class="4584846860636268493" onmouseenter="enter('4584846860636268493');" onmouseout="out('4584846860636268493');" style="">  85 import org.springframework.web.bind.annotation.RequestMethod;                                            </span>
<span class="-8913037601281016619" onmouseenter="enter('-8913037601281016619');" onmouseout="out('-8913037601281016619');" style="">  86 import org.springframework.web.bind.annotation.RequestParam;                                             </span>
<span class="-7662224364501075428" onmouseenter="enter('-7662224364501075428');" onmouseout="out('-7662224364501075428');" style="">  87 import org.springframework.web.bind.annotation.ResponseBody;                                             </span>
<span class="82864906475118767" onmouseenter="enter('82864906475118767');" onmouseout="out('82864906475118767');" style="">  88 import org.springframework.web.servlet.DispatcherServlet;                                                </span>
<span class="4665273347041581179" onmouseenter="enter('4665273347041581179');" onmouseout="out('4665273347041581179');" style="">  89 import org.springframework.web.servlet.FlashMap;                                                         </span>
<span class="4289605998216587359" onmouseenter="enter('4289605998216587359');" onmouseout="out('4289605998216587359');" style="">  90 import org.springframework.web.servlet.mvc.support.RedirectAttributes;                                   </span>
<span class="2383374134797300138" onmouseenter="enter('2383374134797300138');" onmouseout="out('2383374134797300138');" style="">  91 import org.springframework.web.util.UrlPathHelper;                                                       </span>
<span  style="">  92                                                                                                          </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="">  93 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span  style="">  94                                                                                                          </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  95 import java.io.Serializable;                                                                             </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  96 import java.io.UnsupportedEncodingException;                                                             </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="">  97 import java.net.URLDecoder;                                                                              </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  98 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  99 import java.util.Arrays;                                                                                 </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style=""> 100 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style=""> 101 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style=""> 102 import java.util.Map;                                                                                    </span>
<span class="2393042000349901971" onmouseenter="enter('2393042000349901971');" onmouseout="out('2393042000349901971');" style=""> 103 import java.util.Map.Entry;                                                                              </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style=""> 104 import java.util.Set;                                                                                    </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 105 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5924803009700709999" onmouseenter="enter('5924803009700709999');" onmouseout="out('5924803009700709999');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 106 import java.util.stream.Stream;                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 107 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="-2247759832438184775" onmouseenter="enter('-2247759832438184775');" onmouseout="out('-2247759832438184775');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109 import javax.servlet.http.HttpServletResponse;                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111 /**                                                                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 112 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 113 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 114                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style=""> 115 import javax.annotation.Resource;                                                                        </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style=""> 116 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="-2247759832438184775" onmouseenter="enter('-2247759832438184775');" onmouseout="out('-2247759832438184775');" style=""> 117 import javax.servlet.http.HttpServletResponse;                                                           </span>
<span  style=""> 118                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 119 /**                                                                                                      </span>
<span class="5624503434864804252" onmouseenter="enter('5624503434864804252');" onmouseout="out('5624503434864804252');" style=""> 120  * The default implementation of the {@link AdminAbstractController}. This delegates every call to       </span>
<span class="-497882971048272294" onmouseenter="enter('-497882971048272294');" onmouseout="out('-497882971048272294');" style=""> 121  * super and does not provide any custom-tailored functionality. It is responsible for rendering the     </span>
<span class="-4790859535261881332" onmouseenter="enter('-4790859535261881332');" onmouseout="out('-4790859535261881332');" style=""> 122  * admin for every entity that is not explicitly customized by its own controller.                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 123  *                                                                                                       </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style=""> 124  * @author Andre Azzolini (apazzolini)                                                                   </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style=""> 125  * @author Jeff Fischer                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 126  */                                                                                                      </span>
<span class="4155455059275642147" onmouseenter="enter('4155455059275642147');" onmouseout="out('4155455059275642147');" style=""> 127 @Controller(&quot;blAdminBasicEntityController&quot;)                                                              </span>
<span class="1298802560762502343" onmouseenter="enter('1298802560762502343');" onmouseout="out('1298802560762502343');" style=""> 128 @RequestMapping(&quot;/{sectionKey:.+}&quot;)                                                                      </span>
<span class="8857493697785984988" onmouseenter="enter('8857493697785984988');" onmouseout="out('8857493697785984988');" style=""> 129 public class AdminBasicEntityController extends AdminAbstractController {                                </span>
<span  style=""> 130                                                                                                          </span>
<span class="6387945601766467724" onmouseenter="enter('6387945601766467724');" onmouseout="out('6387945601766467724');" style=""> 131     protected static final Log LOG = LogFactory.getLog(AdminBasicEntityController.class);                </span>
<span  style=""> 132                                                                                                          </span>
<span class="-3043900363751028803" onmouseenter="enter('-3043900363751028803');" onmouseout="out('-3043900363751028803');" style=""> 133     public static final String ALTERNATE_ID_PROPERTY = &quot;ALTERNATE_ID&quot;;                                   </span>
<span class="4075481265342786632" onmouseenter="enter('4075481265342786632');" onmouseout="out('4075481265342786632');" style=""> 134     public static final String CUSTOM_CRITERIA = &quot;criteria&quot;;                                             </span>
<span class="-5370879055704196240" onmouseenter="enter('-5370879055704196240');" onmouseout="out('-5370879055704196240');" style=""> 135     public static final String IS_SELECTIZE_REQUEST = &quot;isSelectizeRequest&quot;;                              </span>
<span  style=""> 136                                                                                                          </span>
<span class="-7030764210296949798" onmouseenter="enter('-7030764210296949798');" onmouseout="out('-7030764210296949798');" style=""> 137     @Resource(name=&quot;blSandBoxHelper&quot;)                                                                    </span>
<span class="-7799183597372200632" onmouseenter="enter('-7799183597372200632');" onmouseout="out('-7799183597372200632');" style=""> 138     protected SandBoxHelper sandBoxHelper;                                                               </span>
<span  style=""> 139                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style=""> 140     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style=""> 141     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style=""> 142                                                                                                          </span>
<span class="1039661802170570045" onmouseenter="enter('1039661802170570045');" onmouseout="out('1039661802170570045');" style=""> 143     @Resource(name=&quot;blDynamicEntityDao&quot;)                                                                 </span>
<span class="-6629482740079052882" onmouseenter="enter('-6629482740079052882');" onmouseout="out('-6629482740079052882');" style=""> 144     protected DynamicEntityDao dynamicEntityDao;                                                         </span>
<span  style=""> 145                                                                                                          </span>
<span class="3323977399618509653" onmouseenter="enter('3323977399618509653');" onmouseout="out('3323977399618509653');" style=""> 146     @Resource(name = &quot;blAdornedTargetAutoPopulateExtensionManager&quot;)                                      </span>
<span class="-4810148452666974339" onmouseenter="enter('-4810148452666974339');" onmouseout="out('-4810148452666974339');" style=""> 147     protected AdornedTargetAutoPopulateExtensionManager adornedTargetAutoPopulateExtensionManager;       </span>
<span  style=""> 148                                                                                                          </span>
<span class="-1073312679381587606" onmouseenter="enter('-1073312679381587606');" onmouseout="out('-1073312679381587606');" style=""> 149     @Resource(name = &quot;blRowLevelSecurityService&quot;)                                                        </span>
<span class="7292046362506695965" onmouseenter="enter('7292046362506695965');" onmouseout="out('7292046362506695965');" style=""> 150     protected RowLevelSecurityService rowLevelSecurityService;                                           </span>
<span  style=""> 151                                                                                                          </span>
<span class="4471392044492296285" onmouseenter="enter('4471392044492296285');" onmouseout="out('4471392044492296285');" style=""> 152     @Resource(name = &quot;blEntityDuplicator&quot;)                                                               </span>
<span class="-9194612273021432316" onmouseenter="enter('-9194612273021432316');" onmouseout="out('-9194612273021432316');" style=""> 153     protected EntityDuplicator duplicator;                                                               </span>
<span  style=""> 154                                                                                                          </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style=""> 155     @Resource(name = &quot;blGenericEntityService&quot;)                                                           </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style=""> 156     protected GenericEntityService genericEntityService;                                                 </span>
<span  style=""> 157                                                                                                          </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 158     // ******************************************                                                        </span>
<span class="8145904524131922989" onmouseenter="enter('8145904524131922989');" onmouseout="out('8145904524131922989');" style=""> 159     // REQUEST-MAPPING BOUND CONTROLLER METHODS *                                                        </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 160     // ******************************************                                                        </span>
<span  style=""> 161                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 162     /**                                                                                                  </span>
<span class="5980196098348408716" onmouseenter="enter('5980196098348408716');" onmouseout="out('5980196098348408716');" style=""><abbr title=" 163      * Renders the main entity listing for the specified class, which is based on the current sectionKey with some optional"> 163      * Renders the main entity listing for the specified class, which is based on the current sectionKey ðŸ”µ</abbr></span>
<span class="1756838433111210325" onmouseenter="enter('1756838433111210325');" onmouseout="out('1756838433111210325');" style=""> 164      * criteria.                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 165      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 166      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 167      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 168      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 169      * @param pathVars                                                                                   </span>
<span class="-7836494531350161829" onmouseenter="enter('-7836494531350161829');" onmouseout="out('-7836494531350161829');" style=""> 170      * @param requestParams a Map of property name -&gt; list critiera values                               </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 171      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 172      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 173      */                                                                                                  </span>
<span class="854227037044969777" onmouseenter="enter('854227037044969777');" onmouseout="out('854227037044969777');" style=""> 174     @RequestMapping(value = &quot;&quot;, method = RequestMethod.GET)                                              </span>
<span class="5203424842505603172" onmouseenter="enter('5203424842505603172');" onmouseout="out('5203424842505603172');" style=""> 175     public String viewEntityList(HttpServletRequest request, HttpServletResponse response, Model model,  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 176             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 177             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 178         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 179         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 180         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                               </span>
<span class="1452589137399878084" onmouseenter="enter('1452589137399878084');" onmouseout="out('1452589137399878084');" style=""><abbr title=" 181         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars);"> 181         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 182         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 183         DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                           </span>
<span  style=""> 184                                                                                                          </span>
<span class="-9123024135554384147" onmouseenter="enter('-9123024135554384147');" onmouseout="out('-9123024135554384147');" style=""> 185         ListGrid listGrid = formService.buildMainListGrid(drs, cmd, sectionKey, crumbs);                 </span>
<span class="-7197013270379460942" onmouseenter="enter('-7197013270379460942');" onmouseout="out('-7197013270379460942');" style=""> 186         listGrid.setSelectType(ListGrid.SelectType.NONE);                                                </span>
<span  style=""> 187                                                                                                          </span>
<span class="6707774114103003478" onmouseenter="enter('6707774114103003478');" onmouseout="out('6707774114103003478');" style=""> 188         Set&lt;Field&gt; headerFields = listGrid.getHeaderFields();                                            </span>
<span class="6157449347608657417" onmouseenter="enter('6157449347608657417');" onmouseout="out('6157449347608657417');" style=""> 189         if (CollectionUtils.isNotEmpty(headerFields)) {                                                  </span>
<span class="7359980094802675712" onmouseenter="enter('7359980094802675712');" onmouseout="out('7359980094802675712');" style=""> 190             Field firstField = headerFields.iterator().next();                                           </span>
<span class="-7992921859474727563" onmouseenter="enter('-7992921859474727563');" onmouseout="out('-7992921859474727563');" style=""> 191             if (requestParams.containsKey(firstField.getName())) {                                       </span>
<span class="-4847870846432586371" onmouseenter="enter('-4847870846432586371');" onmouseout="out('-4847870846432586371');" style=""> 192                 model.addAttribute(&quot;mainSearchTerm&quot;, requestParams.get(firstField.getName()).get(0));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194         }                                                                                                </span>
<span  style=""> 195                                                                                                          </span>
<span class="3294377821001327596" onmouseenter="enter('3294377821001327596');" onmouseout="out('3294377821001327596');" style=""> 196         model.addAttribute(&quot;viewType&quot;, &quot;entityList&quot;);                                                    </span>
<span  style=""> 197                                                                                                          </span>
<span class="5223794068523842694" onmouseenter="enter('5223794068523842694');" onmouseout="out('5223794068523842694');" style=""> 198         setupViewEntityListBasicModel(request, cmd, sectionKey, sectionClassName, model, requestParams); </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 199         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style=""> 200                                                                                                          </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 201         return DEFAULT_CONTAINER_VIEW;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202     }                                                                                                    </span>
<span  style=""> 203                                                                                                          </span>
<span class="5512240627727429054" onmouseenter="enter('5512240627727429054');" onmouseout="out('5512240627727429054');" style=""><abbr title=" 204     protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String sectionKey,"> 204     protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String seðŸ”µ</abbr></span>
<span class="522743254766371502" onmouseenter="enter('522743254766371502');" onmouseout="out('522743254766371502');" style=""> 205             String sectionClassName, Model model, MultiValueMap&lt;String, String&gt; requestParams) {         </span>
<span class="5787313217223527782" onmouseenter="enter('5787313217223527782');" onmouseout="out('5787313217223527782');" style=""> 206         List&lt;EntityFormAction&gt; mainActions = new ArrayList&lt;&gt;();                                          </span>
<span class="-6495333239259317464" onmouseenter="enter('-6495333239259317464');" onmouseout="out('-6495333239259317464');" style=""> 207         addAddActionIfAllowed(sectionClassName, cmd, mainActions);                                       </span>
<span class="-5948121019403308590" onmouseenter="enter('-5948121019403308590');" onmouseout="out('-5948121019403308590');" style=""> 208         extensionManager.getProxy().addAdditionalMainActions(sectionClassName, mainActions);             </span>
<span class="-381816252130957573" onmouseenter="enter('-381816252130957573');" onmouseout="out('-381816252130957573');" style=""> 209         extensionManager.getProxy().modifyMainActions(cmd, mainActions);                                 </span>
<span  style=""> 210                                                                                                          </span>
<span class="-5498329164774951339" onmouseenter="enter('-5498329164774951339');" onmouseout="out('-5498329164774951339');" style=""> 211         // If this came from a delete save, we&#x27;ll have a headerFlash request parameter to take care of   </span>
<span class="6915846846822456322" onmouseenter="enter('6915846846822456322');" onmouseout="out('6915846846822456322');" style=""> 212         if (requestParams.containsKey(&quot;headerFlash&quot;)) {                                                  </span>
<span class="-7374079465520861767" onmouseenter="enter('-7374079465520861767');" onmouseout="out('-7374079465520861767');" style=""> 213             model.addAttribute(&quot;headerFlash&quot;, requestParams.get(&quot;headerFlash&quot;).get(0));                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214         }                                                                                                </span>
<span  style=""> 215                                                                                                          </span>
<span class="-5632901614715850082" onmouseenter="enter('-5632901614715850082');" onmouseout="out('-5632901614715850082');" style=""> 216         List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                   </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style=""> 217         String requestUri = request.getRequestURI();                                                     </span>
<span class="2670437920401576748" onmouseenter="enter('2670437920401576748');" onmouseout="out('2670437920401576748');" style=""> 218         if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) {  </span>
<span class="-901741071381030126" onmouseenter="enter('-901741071381030126');" onmouseout="out('-901741071381030126');" style=""><abbr title=" 219             requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length());"> 219             requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length())ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220         }                                                                                                </span>
<span  style=""> 221                                                                                                          </span>
<span class="-3335875933652663591" onmouseenter="enter('-3335875933652663591');" onmouseout="out('-3335875933652663591');" style=""> 222         model.addAttribute(&quot;isFilter&quot;, (requestParams.size() &gt; 0));                                      </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style=""> 223         model.addAttribute(&quot;currentUri&quot;, requestUri);                                                    </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style=""> 224         model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                  </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 225         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 226         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="-4219022137146036385" onmouseenter="enter('-4219022137146036385');" onmouseout="out('-4219022137146036385');" style=""> 227         model.addAttribute(&quot;mainActions&quot;, mainActions);                                                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 228         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-7167932239083034641" onmouseenter="enter('-7167932239083034641');" onmouseout="out('-7167932239083034641');" style=""> 229         setTypedEntityModelAttributes(request, model);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230     }                                                                                                    </span>
<span  style=""> 231                                                                                                          </span>
<span class="-3612928683982517341" onmouseenter="enter('-3612928683982517341');" onmouseout="out('-3612928683982517341');" style=""> 232     @RequestMapping(value = &quot;/selectize&quot;, method = RequestMethod.GET)                                    </span>
<span class="-2536734120775641057" onmouseenter="enter('-2536734120775641057');" onmouseout="out('-2536734120775641057');" style=""> 233     public @ResponseBody Map&lt;String, Object&gt; viewEntityListSelectize(HttpServletRequest request,         </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style=""> 234              HttpServletResponse response, Model model,                                                  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 235              @PathVariable Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 236              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 237         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 238         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 239         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                               </span>
<span class="3971039348455381302" onmouseenter="enter('3971039348455381302');" onmouseout="out('3971039348455381302');" style=""><abbr title=" 240         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars)"> 240         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="-5204717557696417186" onmouseenter="enter('-5204717557696417186');" onmouseout="out('-5204717557696417186');" style=""> 241                 .withCustomCriteria(getCustomCriteria(requestParams));                                   </span>
<span  style=""> 242                                                                                                          </span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style=""> 243         ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                           </span>
<span  style=""> 244                                                                                                          </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 245         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 246         DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                           </span>
<span  style=""> 247                                                                                                          </span>
<span class="-6840686923261380416" onmouseenter="enter('-6840686923261380416');" onmouseout="out('-6840686923261380416');" style=""> 248         return formService.constructSelectizeOptionMap(drs, cmd);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249     }                                                                                                    </span>
<span  style=""> 250                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 251     /**                                                                                                  </span>
<span class="6015587852497052057" onmouseenter="enter('6015587852497052057');" onmouseout="out('6015587852497052057');" style=""> 252      * Obtains the requested criteria parameter                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 253      *                                                                                                   </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 254      * @param requestParams                                                                              </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 255      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 256      */                                                                                                  </span>
<span class="-5224065764328446223" onmouseenter="enter('-5224065764328446223');" onmouseout="out('-5224065764328446223');" style=""> 257     protected String[] getCustomCriteria(Map&lt;String, List&lt;String&gt;&gt; requestParams) {                      </span>
<span class="8308653628584061101" onmouseenter="enter('8308653628584061101');" onmouseout="out('8308653628584061101');" style=""> 258         if (requestParams == null || requestParams.isEmpty()) {                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 259             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260         }                                                                                                </span>
<span  style=""> 261                                                                                                          </span>
<span class="-6200156504676301578" onmouseenter="enter('-6200156504676301578');" onmouseout="out('-6200156504676301578');" style=""> 262         List&lt;String&gt; criteria = requestParams.get(CUSTOM_CRITERIA);                                      </span>
<span class="3479198517250864619" onmouseenter="enter('3479198517250864619');" onmouseout="out('3479198517250864619');" style=""> 263         String response = CollectionUtils.isEmpty(criteria) ? null : criteria.get(0);                    </span>
<span class="3591199473111095603" onmouseenter="enter('3591199473111095603');" onmouseout="out('3591199473111095603');" style=""> 264         return new String[] {response};                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265     }                                                                                                    </span>
<span  style=""> 266                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 267     /**                                                                                                  </span>
<span class="53051913897087216" onmouseenter="enter('53051913897087216');" onmouseout="out('53051913897087216');" style=""><abbr title=" 268      * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new instances"> 268      * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new inðŸ”µ</abbr></span>
<span class="-2041834868205006384" onmouseenter="enter('-2041834868205006384');" onmouseout="out('-2041834868205006384');" style=""> 269      * of the entity and all of the fields in the entity aren&#x27;t marked as read only.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 270      *                                                                                                   </span>
<span class="2579837316240354786" onmouseenter="enter('2579837316240354786');" onmouseout="out('2579837316240354786');" style=""> 271      * @param sectionClassName                                                                           </span>
<span class="3340688165449077744" onmouseenter="enter('3340688165449077744');" onmouseout="out('3340688165449077744');" style=""> 272      * @param cmd                                                                                        </span>
<span class="-70241175981651056" onmouseenter="enter('-70241175981651056');" onmouseout="out('-70241175981651056');" style=""> 273      * @param mainActions                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 274      */                                                                                                  </span>
<span class="-3535265632615590771" onmouseenter="enter('-3535265632615590771');" onmouseout="out('-3535265632615590771');" style=""><abbr title=" 275     protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormAction&gt; mainActions) {"> 275     protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormActioðŸ”µ</abbr></span>
<span class="-1675673801723949520" onmouseenter="enter('-1675673801723949520');" onmouseout="out('-1675673801723949520');" style=""> 276         if (isAddActionAllowed(sectionClassName, cmd)) {                                                 </span>
<span class="-161553798203722975" onmouseenter="enter('-161553798203722975');" onmouseout="out('-161553798203722975');" style=""> 277             mainActions.add(DefaultMainActions.ADD);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279     }                                                                                                    </span>
<span  style=""> 280                                                                                                          </span>
<span class="4125299149074369729" onmouseenter="enter('4125299149074369729');" onmouseout="out('4125299149074369729');" style=""> 281     protected boolean isAddActionAllowed(final String sectionClassName, final ClassMetadata cmd) {       </span>
<span class="2379281051849826609" onmouseenter="enter('2379281051849826609');" onmouseout="out('2379281051849826609');" style=""> 282         // If the user does not have create permissions, we will not add the &quot;Add New&quot; button            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 283         try {                                                                                            </span>
<span class="-2050050318794737036" onmouseenter="enter('-2050050318794737036');" onmouseout="out('-2050050318794737036');" style=""> 284             adminRemoteSecurityService.securityCheck(sectionClassName, EntityOperationType.ADD);         </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 285         } catch (ServiceException e) {                                                                   </span>
<span class="-8912377967087217182" onmouseenter="enter('-8912377967087217182');" onmouseout="out('-8912377967087217182');" style=""> 286             if (e instanceof SecurityServiceException) {                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 287                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289         }                                                                                                </span>
<span  style=""> 290                                                                                                          </span>
<span class="-3272601440754635767" onmouseenter="enter('-3272601440754635767');" onmouseout="out('-3272601440754635767');" style=""> 291         final boolean canAdd = rowLevelSecurityService                                                   </span>
<span class="-1653290766274377775" onmouseenter="enter('-1653290766274377775');" onmouseout="out('-1653290766274377775');" style=""> 292                 .canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectionClassName, cmd);     </span>
<span class="5125272502277129387" onmouseenter="enter('5125272502277129387');" onmouseout="out('5125272502277129387');" style=""> 293         return isNotReadOnly(cmd) &amp;&amp; canAdd;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="-7397004815762425407" onmouseenter="enter('-7397004815762425407');" onmouseout="out('-7397004815762425407');" style=""> 296     protected boolean isNotReadOnly(final ClassMetadata cmd) {                                           </span>
<span class="-5650645308789885306" onmouseenter="enter('-5650645308789885306');" onmouseout="out('-5650645308789885306');" style=""> 297         //check if all the metadata is read only                                                         </span>
<span class="-3497335608114491506" onmouseenter="enter('-3497335608114491506');" onmouseout="out('-3497335608114491506');" style=""> 298         for (Property property : cmd.getProperties()) {                                                  </span>
<span class="-446642995335437650" onmouseenter="enter('-446642995335437650');" onmouseout="out('-446642995335437650');" style=""> 299             if (property.getMetadata() instanceof BasicFieldMetadata) {                                  </span>
<span class="-4740706861929444273" onmouseenter="enter('-4740706861929444273');" onmouseout="out('-4740706861929444273');" style=""> 300                 if (((BasicFieldMetadata) property.getMetadata()).getReadOnly() == null ||               </span>
<span class="7731016670197656615" onmouseenter="enter('7731016670197656615');" onmouseout="out('7731016670197656615');" style=""> 301                         !((BasicFieldMetadata) property.getMetadata()).getReadOnly()) {                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 302                     return true;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305         }                                                                                                </span>
<span  style=""> 306                                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 307         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308     }                                                                                                    </span>
<span  style=""> 309                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 310     /**                                                                                                  </span>
<span class="-403478592182410175" onmouseenter="enter('-403478592182410175');" onmouseout="out('-403478592182410175');" style=""><abbr title=" 311      * Renders the modal form that is used to add a new parent level entity. Note that this form cannot render any"> 311      * Renders the modal form that is used to add a new parent level entity. Note that this form cannot rðŸ”µ</abbr></span>
<span class="-2684076904077363908" onmouseenter="enter('-2684076904077363908');" onmouseout="out('-2684076904077363908');" style=""><abbr title=" 312      * subcollections as operations on those collections require the parent level entity to first be saved and have"> 312      * subcollections as operations on those collections require the parent level entity to first be saveðŸ”µ</abbr></span>
<span class="-2496660529180512497" onmouseenter="enter('-2496660529180512497');" onmouseout="out('-2496660529180512497');" style=""><abbr title=" 313      * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity screen where"> 313      * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity ðŸ”µ</abbr></span>
<span class="-5672334976076130102" onmouseenter="enter('-5672334976076130102');" onmouseout="out('-5672334976076130102');" style=""> 314      * they can then perform operations on sub collections.                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 315      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 316      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 317      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 318      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 319      * @param pathVars                                                                                   </span>
<span class="-7339043177630483847" onmouseenter="enter('-7339043177630483847');" onmouseout="out('-7339043177630483847');" style=""> 320      * @param entityType                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 321      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 322      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 323      */                                                                                                  </span>
<span class="-6494270766546423105" onmouseenter="enter('-6494270766546423105');" onmouseout="out('-6494270766546423105');" style=""> 324     @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.GET)                                          </span>
<span class="8522113168804045570" onmouseenter="enter('8522113168804045570');" onmouseout="out('8522113168804045570');" style=""><abbr title=" 325     public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,"> 325     public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model modelðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 326             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="-1715631339976075770" onmouseenter="enter('-1715631339976075770');" onmouseout="out('-1715631339976075770');" style=""> 327             @RequestParam(defaultValue = &quot;&quot;) String entityType) throws Exception {                       </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 328         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 329         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 330         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 331         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 331         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style=""> 332         ppr.setAddOperationInspect(true);                                                                </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 333         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span  style=""> 334                                                                                                          </span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style=""> 335         entityType = determineEntityType(entityType, cmd);                                               </span>
<span  style=""> 336                                                                                                          </span>
<span class="4098005746663533241" onmouseenter="enter('4098005746663533241');" onmouseout="out('4098005746663533241');" style=""> 337         EntityForm entityForm = formService.createEntityForm(cmd, sectionCrumbs);                        </span>
<span  style=""> 338                                                                                                          </span>
<span class="5826594571687596812" onmouseenter="enter('5826594571687596812');" onmouseout="out('5826594571687596812');" style=""><abbr title=" 339         // We need to make sure that the ceiling entity is set to the interface and the specific entity type"> 339         // We need to make sure that the ceiling entity is set to the interface and the specific entity tðŸ”µ</abbr></span>
<span class="37161952125740808" onmouseenter="enter('37161952125740808');" onmouseout="out('37161952125740808');" style=""> 340         // is set to the type we&#x27;re going to be creating.                                                </span>
<span class="5062735442039535924" onmouseenter="enter('5062735442039535924');" onmouseout="out('5062735442039535924');" style=""> 341         entityForm.setCeilingEntityClassname(cmd.getCeilingType());                                      </span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style=""> 342         entityForm.setEntityType(entityType);                                                            </span>
<span  style=""> 343                                                                                                          </span>
<span class="-5227856854691424770" onmouseenter="enter('-5227856854691424770');" onmouseout="out('-5227856854691424770');" style=""><abbr title=" 344         // When we initially build the class metadata (and thus, the entity form), we had all of the possible"> 344         // When we initially build the class metadata (and thus, the entity form), we had all of the possðŸ”µ</abbr></span>
<span class="5105619661852614163" onmouseenter="enter('5105619661852614163');" onmouseout="out('5105619661852614163');" style=""><abbr title=" 345         // polymorphic fields built out. Now that we have a concrete entity type to render, we can remove the"> 345         // polymorphic fields built out. Now that we have a concrete entity type to render, we can removeðŸ”µ</abbr></span>
<span class="-3843175043245177501" onmouseenter="enter('-3843175043245177501');" onmouseout="out('-3843175043245177501');" style=""> 346         // fields that are not applicable for this given entity type.                                    </span>
<span class="-2935519954456371455" onmouseenter="enter('-2935519954456371455');" onmouseout="out('-2935519954456371455');" style=""> 347         formService.removeNonApplicableFields(cmd, entityForm, entityType);                              </span>
<span  style=""> 348                                                                                                          </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 349         modifyAddEntityForm(entityForm, pathVars);                                                       </span>
<span  style=""> 350                                                                                                          </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 351         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 352         model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                               </span>
<span  style=""> 353                                                                                                          </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 354         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 355         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 356         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 357         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 358         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359     }                                                                                                    </span>
<span  style=""> 360                                                                                                          </span>
<span class="6822582914767657426" onmouseenter="enter('6822582914767657426');" onmouseout="out('6822582914767657426');" style=""> 361     // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic         </span>
<span class="6925903770450869702" onmouseenter="enter('6925903770450869702');" onmouseout="out('6925903770450869702');" style=""> 362     // types for this entity.                                                                            </span>
<span class="3096473113628081949" onmouseenter="enter('3096473113628081949');" onmouseout="out('3096473113628081949');" style=""> 363     protected String determineEntityType(String entityType, final ClassMetadata cmd)                     </span>
<span class="363372168864539985" onmouseenter="enter('363372168864539985');" onmouseout="out('363372168864539985');" style=""> 364             throws UnsupportedEncodingException {                                                        </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 365         if (StringUtils.isBlank(entityType)) {                                                           </span>
<span class="2333848870190395940" onmouseenter="enter('2333848870190395940');" onmouseout="out('2333848870190395940');" style=""> 366             if (cmd.getPolymorphicEntities().getChildren().length == 0) {                                </span>
<span class="2097783908693957449" onmouseenter="enter('2097783908693957449');" onmouseout="out('2097783908693957449');" style=""> 367                 entityType = cmd.getPolymorphicEntities().getFullyQualifiedClassname();                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 368             } else {                                                                                     </span>
<span class="-6902702564943152777" onmouseenter="enter('-6902702564943152777');" onmouseout="out('-6902702564943152777');" style=""> 369                 entityType = getDefaultEntityType();                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 371         } else {                                                                                         </span>
<span class="7843468667819793383" onmouseenter="enter('7843468667819793383');" onmouseout="out('7843468667819793383');" style=""> 372             entityType = URLDecoder.decode(entityType, &quot;UTF-8&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373         }                                                                                                </span>
<span class="2597693607778452486" onmouseenter="enter('2597693607778452486');" onmouseout="out('2597693607778452486');" style=""> 374         return entityType;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375     }                                                                                                    </span>
<span  style=""> 376                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 377     /**                                                                                                  </span>
<span class="-2292124409166412817" onmouseenter="enter('-2292124409166412817');" onmouseout="out('-2292124409166412817');" style=""><abbr title=" 378      * Processes the request to add a new entity. If successful, returns a redirect to the newly created entity."> 378      * Processes the request to add a new entity. If successful, returns a redirect to the newly created ðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 379      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 380      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 381      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 382      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 383      * @param pathVars                                                                                   </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 384      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 385      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 386      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 387      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 388      */                                                                                                  </span>
<span class="-1840738840686664300" onmouseenter="enter('-1840738840686664300');" onmouseout="out('-1840738840686664300');" style=""> 389     @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.POST)                                         </span>
<span class="8551380442207718095" onmouseenter="enter('8551380442207718095');" onmouseout="out('8551380442207718095');" style=""> 390     public String addEntity(HttpServletRequest request, HttpServletResponse response, Model model,       </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 391             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title=" 392             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {"> 392             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 393         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 394         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 395         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="2596618104185041854" onmouseenter="enter('2596618104185041854');" onmouseout="out('2596618104185041854');" style=""><abbr title=" 396         ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 396         ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassNameðŸ”µ</abbr></span>
<span  style=""> 397                                                                                                          </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 398         extractDynamicFormFields(cmd, entityForm);                                                       </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 399         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 399         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="-4281879219750019053" onmouseenter="enter('-4281879219750019053');" onmouseout="out('-4281879219750019053');" style=""> 400         Entity entity = service.addEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();       </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 401         entityFormValidator.validate(entityForm, entity, result);                                        </span>
<span  style=""> 402                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 403         if (result.hasErrors()) {                                                                        </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 404             entityForm.clearFieldsMap();                                                                 </span>
<span class="-312181662169537666" onmouseenter="enter('-312181662169537666');" onmouseout="out('-312181662169537666');" style=""> 405             formService.populateEntityForm(cmd, entity, entityForm, sectionCrumbs);                      </span>
<span  style=""> 406                                                                                                          </span>
<span class="254171966199148419" onmouseenter="enter('254171966199148419');" onmouseout="out('254171966199148419');" style=""> 407             formService.removeNonApplicableFields(cmd, entityForm, entityForm.getEntityType());          </span>
<span  style=""> 408                                                                                                          </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 409             modifyAddEntityForm(entityForm, pathVars);                                                   </span>
<span  style=""> 410                                                                                                          </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 411             model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                           </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 412             model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                        </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 413             model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                 </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 414             model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 415             setModelAttributes(model, sectionKey);                                                       </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 416             return MODAL_CONTAINER_VIEW;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417         }                                                                                                </span>
<span  style=""> 418                                                                                                          </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 419         // Note that AJAX Redirects need the context path prepended to them                              </span>
<span class="-9104189425594863479" onmouseenter="enter('-9104189425594863479');" onmouseout="out('-9104189425594863479');" style=""><abbr title=" 420         return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).getValue();"> 420         return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421     }                                                                                                    </span>
<span  style=""> 422                                                                                                          </span>
<span class="1290933159858539781" onmouseenter="enter('1290933159858539781');" onmouseout="out('1290933159858539781');" style=""> 423     @RequestMapping(value = &quot;/{id}/duplicate&quot;, method = RequestMethod.POST)                              </span>
<span class="-7829728733805273999" onmouseenter="enter('-7829728733805273999');" onmouseout="out('-7829728733805273999');" style=""> 424     public String duplicateEntity(final HttpServletRequest request,                                      </span>
<span class="277417182565607361" onmouseenter="enter('277417182565607361');" onmouseout="out('277417182565607361');" style=""> 425             final HttpServletResponse response,                                                          </span>
<span class="7665770463560391322" onmouseenter="enter('7665770463560391322');" onmouseout="out('7665770463560391322');" style=""> 426             final Model model,                                                                           </span>
<span class="5144416334471976319" onmouseenter="enter('5144416334471976319');" onmouseout="out('5144416334471976319');" style=""> 427             @PathVariable final Map&lt;String, String&gt; pathVars,                                            </span>
<span class="5884230296910152604" onmouseenter="enter('5884230296910152604');" onmouseout="out('5884230296910152604');" style=""> 428             @PathVariable(value = &quot;id&quot;) final String id,                                                 </span>
<span class="5134952934925976911" onmouseenter="enter('5134952934925976911');" onmouseout="out('5134952934925976911');" style=""> 429             @ModelAttribute(value = &quot;entityForm&quot;) final EntityForm entityForm,                           </span>
<span class="3593210188792847894" onmouseenter="enter('3593210188792847894');" onmouseout="out('3593210188792847894');" style=""> 430             final BindingResult result) throws Exception {                                               </span>
<span class="5473402149144087547" onmouseenter="enter('5473402149144087547');" onmouseout="out('5473402149144087547');" style=""> 431         final String sectionKey = getSectionKey(pathVars);                                               </span>
<span class="5437662011929987553" onmouseenter="enter('5437662011929987553');" onmouseout="out('5437662011929987553');" style=""> 432         final String sectionClassName = getClassNameForSection(sectionKey);                              </span>
<span class="8553976943183535096" onmouseenter="enter('8553976943183535096');" onmouseout="out('8553976943183535096');" style=""> 433         final Class&lt;?&gt; entityClass = dynamicEntityDao.getImplClass(sectionClassName);                    </span>
<span class="3365797270076600425" onmouseenter="enter('3365797270076600425');" onmouseout="out('3365797270076600425');" style=""> 434         final long identifier = Long.parseLong(id);                                                      </span>
<span  style=""> 435                                                                                                          </span>
<span class="-138107922525045121" onmouseenter="enter('-138107922525045121');" onmouseout="out('-138107922525045121');" style=""> 436         if (duplicator.validate(entityClass, identifier)) {                                              </span>
<span class="5493542447860389431" onmouseenter="enter('5493542447860389431');" onmouseout="out('5493542447860389431');" style=""> 437             final Object duplicate;                                                                      </span>
<span  style=""> 438                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 439             try {                                                                                        </span>
<span class="-2283233085854885260" onmouseenter="enter('-2283233085854885260');" onmouseout="out('-2283233085854885260');" style=""> 440                 duplicate = duplicator.copy(entityClass, identifier);                                    </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 441             } catch (Exception e) {                                                                      </span>
<span class="-8850460393574909327" onmouseenter="enter('-8850460393574909327');" onmouseout="out('-8850460393574909327');" style=""> 442                 LOG.error(&quot;Could not duplicate entity&quot;, e);                                              </span>
<span class="-7503880796159563304" onmouseenter="enter('-7503880796159563304');" onmouseout="out('-7503880796159563304');" style=""> 443                 return getErrorDuplicatingResponse(response, &quot;Duplication_Failure&quot;);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444             }                                                                                            </span>
<span  style=""> 445                                                                                                          </span>
<span class="9202899875978069713" onmouseenter="enter('9202899875978069713');" onmouseout="out('9202899875978069713');" style=""> 446             final Serializable dupId = genericEntityService.getIdentifier(duplicate);                    </span>
<span  style=""> 447                                                                                                          </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 448             // Note that AJAX Redirects need the context path prepended to them                          </span>
<span class="6804960621276438337" onmouseenter="enter('6804960621276438337');" onmouseout="out('6804960621276438337');" style=""> 449             return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + dupId;                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 450         } else {                                                                                         </span>
<span class="-110948502599545681" onmouseenter="enter('-110948502599545681');" onmouseout="out('-110948502599545681');" style=""> 451             return getErrorDuplicatingResponse(response, &quot;Validation_Failure&quot;);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453     }                                                                                                    </span>
<span  style=""> 454                                                                                                          </span>
<span class="-106656131545478097" onmouseenter="enter('-106656131545478097');" onmouseout="out('-106656131545478097');" style=""> 455     protected String getErrorDuplicatingResponse(HttpServletResponse response, String code) {            </span>
<span class="7659712838923572459" onmouseenter="enter('7659712838923572459');" onmouseout="out('7659712838923572459');" style=""> 456         List&lt;Map&lt;String, Object&gt;&gt; errors = new ArrayList&lt;&gt;();                                            </span>
<span class="-6240695079450735253" onmouseenter="enter('-6240695079450735253');" onmouseout="out('-6240695079450735253');" style=""> 457         String message;                                                                                  </span>
<span class="-7826420477706002406" onmouseenter="enter('-7826420477706002406');" onmouseout="out('-7826420477706002406');" style=""> 458         BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();          </span>
<span class="-2727648393614728" onmouseenter="enter('-2727648393614728');" onmouseout="out('-2727648393614728');" style=""> 459         if (context != null &amp;&amp; context.getMessageSource() != null) {                                     </span>
<span class="-5978418614812499702" onmouseenter="enter('-5978418614812499702');" onmouseout="out('-5978418614812499702');" style=""> 460             message = context.getMessageSource()                                                         </span>
<span class="1624598595284946587" onmouseenter="enter('1624598595284946587');" onmouseout="out('1624598595284946587');" style=""> 461                     .getMessage(code, null, code, context.getJavaLocale());                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 462         } else {                                                                                         </span>
<span class="-9004243737964586892" onmouseenter="enter('-9004243737964586892');" onmouseout="out('-9004243737964586892');" style=""> 463             LOG.warn(                                                                                    </span>
<span class="6269614064328325287" onmouseenter="enter('6269614064328325287');" onmouseout="out('6269614064328325287');" style=""> 464                     &quot;Could not find the MessageSource on the current request, &quot;                          </span>
<span class="-8208830135626721740" onmouseenter="enter('-8208830135626721740');" onmouseout="out('-8208830135626721740');" style=""> 465                             + &quot;not translating the message key&quot;);                                        </span>
<span class="599114272120646428" onmouseenter="enter('599114272120646428');" onmouseout="out('599114272120646428');" style=""> 466             message = &quot;Duplication_Failure&quot;;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467         }                                                                                                </span>
<span  style=""> 468                                                                                                          </span>
<span class="-4703377271641004207" onmouseenter="enter('-4703377271641004207');" onmouseout="out('-4703377271641004207');" style=""> 469         Map&lt;String, Object&gt; errorMap = new HashMap&lt;&gt;();                                                  </span>
<span class="2851590661979449603" onmouseenter="enter('2851590661979449603');" onmouseout="out('2851590661979449603');" style=""> 470         errorMap.put(&quot;errorType&quot;, &quot;global&quot;);                                                             </span>
<span class="4738760182182965590" onmouseenter="enter('4738760182182965590');" onmouseout="out('4738760182182965590');" style=""> 471         errorMap.put(&quot;code&quot;, code);                                                                      </span>
<span class="7426718838785534996" onmouseenter="enter('7426718838785534996');" onmouseout="out('7426718838785534996');" style=""> 472         errorMap.put(&quot;message&quot;, message);                                                                </span>
<span class="-4906289066975989946" onmouseenter="enter('-4906289066975989946');" onmouseout="out('-4906289066975989946');" style=""> 473         errors.add(errorMap);                                                                            </span>
<span class="-8734340547513070222" onmouseenter="enter('-8734340547513070222');" onmouseout="out('-8734340547513070222');" style=""> 474         return new JsonResponse(response).with(&quot;errors&quot;, errors).done();                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475     }                                                                                                    </span>
<span  style=""> 476                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 477     /**                                                                                                  </span>
<span class="9102199281013466170" onmouseenter="enter('9102199281013466170');" onmouseout="out('9102199281013466170');" style=""> 478      * Renders the main entity form for the specified entity                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 479      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 480      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 481      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 482      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 483      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 484      * @param id                                                                                         </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 485      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 486      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 487      */                                                                                                  </span>
<span class="7083955269921705584" onmouseenter="enter('7083955269921705584');" onmouseout="out('7083955269921705584');" style=""> 488     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.GET)                                         </span>
<span class="-4309552397998806559" onmouseenter="enter('-4309552397998806559');" onmouseout="out('-4309552397998806559');" style=""> 489     public String viewEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,  </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 490             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="-2194094146044801021" onmouseenter="enter('-2194094146044801021');" onmouseout="out('-2194094146044801021');" style=""> 491             @PathVariable(&quot;id&quot;) String id) throws Exception {                                            </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 492         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 493         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 494         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                           </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""><abbr title=" 495         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);"> 495         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, patðŸ”µ</abbr></span>
<span  style=""> 496                                                                                                          </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 497         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-8780243800866475465" onmouseenter="enter('-8780243800866475465');" onmouseout="out('-8780243800866475465');" style=""> 498         Entity entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style=""> 499                                                                                                          </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""><abbr title=" 500         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);"> 500         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, cðŸ”µ</abbr></span>
<span  style=""> 501                                                                                                          </span>
<span class="872584542219399793" onmouseenter="enter('872584542219399793');" onmouseout="out('872584542219399793');" style=""> 502         EntityForm entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);        </span>
<span  style=""> 503                                                                                                          </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 504         modifyEntityForm(entity, entityForm, pathVars);                                                  </span>
<span  style=""> 505                                                                                                          </span>
<span class="1981952247030149381" onmouseenter="enter('1981952247030149381');" onmouseout="out('1981952247030149381');" style=""> 506         if (request.getParameter(&quot;headerFlash&quot;) != null) {                                               </span>
<span class="-2367607735703612103" onmouseenter="enter('-2367607735703612103');" onmouseout="out('-2367607735703612103');" style=""> 507             model.addAttribute(&quot;headerFlash&quot;, request.getParameter(&quot;headerFlash&quot;));                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508         }                                                                                                </span>
<span  style=""> 509                                                                                                          </span>
<span class="-6569554975283424126" onmouseenter="enter('-6569554975283424126');" onmouseout="out('-6569554975283424126');" style=""> 510         // Set the sectionKey again incase this is a typed entity                                        </span>
<span class="4201932972037321722" onmouseenter="enter('4201932972037321722');" onmouseout="out('4201932972037321722');" style=""> 511         entityForm.setSectionKey(sectionKey);                                                            </span>
<span  style=""> 512                                                                                                          </span>
<span class="5387752430767952558" onmouseenter="enter('5387752430767952558');" onmouseout="out('5387752430767952558');" style=""> 513         // Build the current url in the cast that this is a typed entity                                 </span>
<span class="3856485652570637824" onmouseenter="enter('3856485652570637824');" onmouseout="out('3856485652570637824');" style=""> 514         String originatingUri = new UrlPathHelper().getOriginatingRequestUri(request);                   </span>
<span class="-1728408616530607173" onmouseenter="enter('-1728408616530607173');" onmouseout="out('-1728408616530607173');" style=""> 515         int startIndex = request.getContextPath().length();                                              </span>
<span  style=""> 516                                                                                                          </span>
<span class="654052499558570629" onmouseenter="enter('654052499558570629');" onmouseout="out('654052499558570629');" style=""> 517         // Remove the context path from servlet path                                                     </span>
<span class="526107488063217153" onmouseenter="enter('526107488063217153');" onmouseout="out('526107488063217153');" style=""> 518         String currentUrl = originatingUri.substring(startIndex);                                        </span>
<span  style=""> 519                                                                                                          </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 520         model.addAttribute(&quot;entity&quot;, entity);                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 521         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-4977411250845897884" onmouseenter="enter('-4977411250845897884');" onmouseout="out('-4977411250845897884');" style=""> 522         model.addAttribute(&quot;currentUrl&quot;, currentUrl);                                                    </span>
<span  style=""> 523                                                                                                          </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 524         setModelAttributes(model, sectionKey);                                                           </span>
<span  style=""> 525                                                                                                          </span>
<span class="8236570979651257825" onmouseenter="enter('8236570979651257825');" onmouseout="out('8236570979651257825');" style=""> 526         // We want to replace author ids with their names                                                </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style=""> 527         addAuditableDisplayFields(entityForm);                                                           </span>
<span  style=""> 528                                                                                                          </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style=""> 529         return resolveAppropriateEntityView(request, model, entityForm);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 530     }                                                                                                    </span>
<span  style=""> 531                                                                                                          </span>
<span class="9182660926479189949" onmouseenter="enter('9182660926479189949');" onmouseout="out('9182660926479189949');" style=""><abbr title=" 532     protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, String&gt; pathVars,"> 532     protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, StrðŸ”µ</abbr></span>
<span class="4477928710658117231" onmouseenter="enter('4477928710658117231');" onmouseout="out('4477928710658117231');" style=""> 533                                                               ClassMetadata cmd, Entity entity,          </span>
<span class="5660295431162582196" onmouseenter="enter('5660295431162582196');" onmouseout="out('5660295431162582196');" style=""><abbr title=" 534                                                               List&lt;SectionCrumb&gt; crumbs) throws Exception {"> 534                                                               List&lt;SectionCrumb&gt; crumbs) throws ExceptionðŸ”µ</abbr></span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style=""> 535         String tabName = pathVars.get(&quot;tabName&quot;);                                                        </span>
<span class="5384642555226517985" onmouseenter="enter('5384642555226517985');" onmouseout="out('5384642555226517985');" style=""> 536         if (StringUtils.isEmpty(tabName)) {                                                              </span>
<span class="-3672533750283461484" onmouseenter="enter('-3672533750283461484');" onmouseout="out('-3672533750283461484');" style=""> 537             tabName = cmd.getFirstTab() == null ? &quot;General&quot; : cmd.getFirstTab().getTabName();            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538         }                                                                                                </span>
<span class="-5882478663361935855" onmouseenter="enter('-5882478663361935855');" onmouseout="out('-5882478663361935855');" style=""> 539         return service.getRecordsForSelectedTab(cmd, entity, crumbs, tabName);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540     }                                                                                                    </span>
<span  style=""> 541                                                                                                          </span>
<span class="1953795048205106952" onmouseenter="enter('1953795048205106952');" onmouseout="out('1953795048205106952');" style=""> 542     private boolean isAddRequest(Entity entity) {                                                        </span>
<span class="-2989581670667655563" onmouseenter="enter('-2989581670667655563');" onmouseout="out('-2989581670667655563');" style=""> 543         ExtensionResultHolder&lt;Boolean&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                     </span>
<span class="2773544387861748911" onmouseenter="enter('2773544387861748911');" onmouseout="out('2773544387861748911');" style=""><abbr title=" 544         ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder);"> 544         ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder)ðŸ”µ</abbr></span>
<span class="8622638495597819717" onmouseenter="enter('8622638495597819717');" onmouseout="out('8622638495597819717');" style=""> 545         if (result.equals(ExtensionResultStatusType.NOT_HANDLED)) {                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 546             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547         }                                                                                                </span>
<span  style=""> 548                                                                                                          </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 549         return resultHolder.getResult();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550     }                                                                                                    </span>
<span  style=""> 551                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 552     /**                                                                                                  </span>
<span class="-4864218972040039628" onmouseenter="enter('-4864218972040039628');" onmouseout="out('-4864218972040039628');" style=""> 553      * Attempts to get the List Grid for the selected tab.                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 554      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 555      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 556      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 557      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 558      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 559      * @param id                                                                                         </span>
<span class="4841027518362301903" onmouseenter="enter('4841027518362301903');" onmouseout="out('4841027518362301903');" style=""> 560      * @param tabName                                                                                    </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 561      * @param entityForm                                                                                 </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style=""> 562      * @param entity                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 563      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 564      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 565      */                                                                                                  </span>
<span class="-7675092144868804288" onmouseenter="enter('-7675092144868804288');" onmouseout="out('-7675092144868804288');" style=""> 566     @RequestMapping(value = &quot;/{id}/{tab:[0-9]+}/{tabName}&quot;, method = RequestMethod.POST)                 </span>
<span class="-2248541185927650044" onmouseenter="enter('-2248541185927650044');" onmouseout="out('-2248541185927650044');" style=""> 567     public String viewEntityTab(HttpServletRequest request, HttpServletResponse response, Model model,   </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 568             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 569             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="2259450910520289810" onmouseenter="enter('2259450910520289810');" onmouseout="out('2259450910520289810');" style=""> 570             @PathVariable(value = &quot;tabName&quot;) String tabName,                                             </span>
<span class="2754607649135651414" onmouseenter="enter('2754607649135651414');" onmouseout="out('2754607649135651414');" style=""> 571             @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm,                                 </span>
<span class="-2950467864443381399" onmouseenter="enter('-2950467864443381399');" onmouseout="out('-2950467864443381399');" style=""> 572             @ModelAttribute(value = &quot;entity&quot;) Entity entity) throws Exception {                          </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 573         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 574         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 575         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                           </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""><abbr title=" 576         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);"> 576         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, patðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 577         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 578         entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];           </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""><abbr title=" 579         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);"> 579         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, cðŸ”µ</abbr></span>
<span class="-3846048132763499568" onmouseenter="enter('-3846048132763499568');" onmouseout="out('-3846048132763499568');" style=""> 580         entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);                   </span>
<span  style=""> 581                                                                                                          </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 582         modifyEntityForm(entity, entityForm, pathVars);                                                  </span>
<span  style=""> 583                                                                                                          </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 584         model.addAttribute(&quot;entity&quot;, entity);                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 585         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 586         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span  style=""> 587                                                                                                          </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 588         setModelAttributes(model, sectionKey);                                                           </span>
<span  style=""> 589                                                                                                          </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 590         model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                       </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 591         model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                    </span>
<span  style=""> 592                                                                                                          </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 593         return DEFAULT_CONTAINER_VIEW;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594     }                                                                                                    </span>
<span  style=""> 595                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 596     /**                                                                                                  </span>
<span class="26428616724277901" onmouseenter="enter('26428616724277901');" onmouseout="out('26428616724277901');" style=""> 597      * Builds JSON that looks like this:                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 598      *                                                                                                   </span>
<span class="-619170819873097874" onmouseenter="enter('-619170819873097874');" onmouseout="out('-619170819873097874');" style=""> 599      * {&quot;errors&quot;:                                                                                        </span>
<span class="-7867797149207986089" onmouseenter="enter('-7867797149207986089');" onmouseout="out('-7867797149207986089');" style=""> 600      *      [{&quot;message&quot;:&quot;This field is Required&quot;,                                                        </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 601      *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                        </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 602      *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 603      *        &quot;errorType&quot;, &quot;field&quot;,                                                                      </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 604      *        &quot;tab&quot;: &quot;General&quot;                                                                           </span>
<span class="762081609125064039" onmouseenter="enter('762081609125064039');" onmouseout="out('762081609125064039');" style=""> 605      *        },                                                                                         </span>
<span class="2065208195238134241" onmouseenter="enter('2065208195238134241');" onmouseout="out('2065208195238134241');" style=""> 606      *        {&quot;message&quot;:&quot;This field is Required&quot;,                                                       </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 607      *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                        </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 608      *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 609      *        &quot;errorType&quot;, &quot;field&quot;,                                                                      </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 610      *        &quot;tab&quot;: &quot;General&quot;                                                                           </span>
<span class="-832778532632947969" onmouseenter="enter('-832778532632947969');" onmouseout="out('-832778532632947969');" style=""> 611      *        }]                                                                                         </span>
<span class="8941010846014250828" onmouseenter="enter('8941010846014250828');" onmouseout="out('8941010846014250828');" style=""> 612      * }                                                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 613      *                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 614      */                                                                                                  </span>
<span class="726178843151373675" onmouseenter="enter('726178843151373675');" onmouseout="out('726178843151373675');" style=""> 615     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST, produces = &quot;application/json&quot;)         </span>
<span class="-4245682307765667372" onmouseenter="enter('-4245682307765667372');" onmouseout="out('-4245682307765667372');" style=""> 616     public String saveEntityJson(HttpServletRequest request, HttpServletResponse response, Model model,  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 617             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 618             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="-5165411007609652701" onmouseenter="enter('-5165411007609652701');" onmouseout="out('-5165411007609652701');" style=""> 619             @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm, BindingResult result,           </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 620             RedirectAttributes ra) throws Exception {                                                    </span>
<span  style=""> 621                                                                                                          </span>
<span class="-7049584637685461961" onmouseenter="enter('-7049584637685461961');" onmouseout="out('-7049584637685461961');" style=""> 622         saveEntity(request, response, model, pathVars, id, entityForm, result, ra);                      </span>
<span  style=""> 623                                                                                                          </span>
<span class="2770382331963423086" onmouseenter="enter('2770382331963423086');" onmouseout="out('2770382331963423086');" style=""> 624         JsonResponse json = new JsonResponse(response);                                                  </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 625         if (result.hasErrors()) {                                                                        </span>
<span class="6668101882629849049" onmouseenter="enter('6668101882629849049');" onmouseout="out('6668101882629849049');" style=""> 626             populateJsonValidationErrors(entityForm, result, json);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 627         }                                                                                                </span>
<span class="-8719030961107019295" onmouseenter="enter('-8719030961107019295');" onmouseout="out('-8719030961107019295');" style=""> 628         List&lt;String&gt; dirtyList = buildDirtyList(pathVars, request, id);                                  </span>
<span class="-2397478597494600131" onmouseenter="enter('-2397478597494600131');" onmouseout="out('-2397478597494600131');" style=""> 629         if (CollectionUtils.isNotEmpty(dirtyList)) {                                                     </span>
<span class="-6863151800017638945" onmouseenter="enter('-6863151800017638945');" onmouseout="out('-6863151800017638945');" style=""> 630             json.with(&quot;dirty&quot;, dirtyList);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 631         }                                                                                                </span>
<span  style=""> 632                                                                                                          </span>
<span class="1148846903613025505" onmouseenter="enter('1148846903613025505');" onmouseout="out('1148846903613025505');" style=""> 633         ExtensionResultHolder&lt;String&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                      </span>
<span class="772761850497532920" onmouseenter="enter('772761850497532920');" onmouseout="out('772761850497532920');" style=""><abbr title=" 634         ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonResponse(response, result.hasErrors(), getSectionKey(pathVars), id, resultHolder);"> 634         ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonReðŸ”µ</abbr></span>
<span class="-7225919658162387284" onmouseenter="enter('-7225919658162387284');" onmouseout="out('-7225919658162387284');" style=""> 635         if (resultStatusType.equals(ExtensionResultStatusType.HANDLED)) {                                </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 636             return resultHolder.getResult();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 637         }                                                                                                </span>
<span  style=""> 638                                                                                                          </span>
<span class="-3901811907821215875" onmouseenter="enter('-3901811907821215875');" onmouseout="out('-3901811907821215875');" style=""> 639         return json.done();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 640     }                                                                                                    </span>
<span  style=""> 641                                                                                                          </span>
<span class="-2624067384280123527" onmouseenter="enter('-2624067384280123527');" onmouseout="out('-2624067384280123527');" style=""><abbr title=" 642     public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String id) throws ServiceException {"> 642     public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String iðŸ”µ</abbr></span>
<span class="-6199220983064020273" onmouseenter="enter('-6199220983064020273');" onmouseout="out('-6199220983064020273');" style=""> 643         List&lt;String&gt; dirtyList = new ArrayList&lt;&gt;();                                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 644         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 645         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 646         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 647         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 647         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="-6293964121119142853" onmouseenter="enter('-6293964121119142853');" onmouseout="out('-6293964121119142853');" style=""> 648         ClassMetadata cmd = null;                                                                        </span>
<span class="-6100049554794336383" onmouseenter="enter('-6100049554794336383');" onmouseout="out('-6100049554794336383');" style=""> 649         Entity entity = null;                                                                            </span>
<span class="-7221558264805358950" onmouseenter="enter('-7221558264805358950');" onmouseout="out('-7221558264805358950');" style=""> 650         cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();                    </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 651         entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];           </span>
<span  style=""> 652                                                                                                          </span>
<span class="-538034338216639378" onmouseenter="enter('-538034338216639378');" onmouseout="out('-538034338216639378');" style=""> 653         for (Property p: entity.getProperties()) {                                                       </span>
<span class="-5586383415891827802" onmouseenter="enter('-5586383415891827802');" onmouseout="out('-5586383415891827802');" style=""> 654             if (p.getIsDirty()) {                                                                        </span>
<span class="-1571805809811752662" onmouseenter="enter('-1571805809811752662');" onmouseout="out('-1571805809811752662');" style=""> 655                 dirtyList.add(p.getName());                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 656             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 657         }                                                                                                </span>
<span class="7211627429904225799" onmouseenter="enter('7211627429904225799');" onmouseout="out('7211627429904225799');" style=""> 658         return dirtyList;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659     }                                                                                                    </span>
<span  style=""> 660                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 661     /**                                                                                                  </span>
<span class="-1912365624495655250" onmouseenter="enter('-1912365624495655250');" onmouseout="out('-1912365624495655250');" style=""><abbr title=" 662      * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity form with"> 662      * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity forðŸ”µ</abbr></span>
<span class="3378821078357952120" onmouseenter="enter('3378821078357952120');" onmouseout="out('3378821078357952120');" style=""> 663      * error fields highlighted. On a successful save, it will refresh the entity page.                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 664      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 665      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 666      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 667      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 668      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 669      * @param id                                                                                         </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 670      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 671      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 672      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 673      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 674      */                                                                                                  </span>
<span class="681227659796054179" onmouseenter="enter('681227659796054179');" onmouseout="out('681227659796054179');" style=""> 675     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST)                                        </span>
<span class="2696827203115285075" onmouseenter="enter('2696827203115285075');" onmouseout="out('2696827203115285075');" style=""> 676     public String saveEntity(HttpServletRequest request, HttpServletResponse response, Model model,      </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 677             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 678             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 679             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,             </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 680             RedirectAttributes ra) throws Exception {                                                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 681         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 682         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 683         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 684         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 684         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 685         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span  style=""> 686                                                                                                          </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 687         extractDynamicFormFields(cmd, entityForm);                                                       </span>
<span  style=""> 688                                                                                                          </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 689         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 689         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="-4517703585527939334" onmouseenter="enter('-4517703585527939334');" onmouseout="out('-4517703585527939334');" style=""> 690         Entity entity = service.updateEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();    </span>
<span  style=""> 691                                                                                                          </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 692         entityFormValidator.validate(entityForm, entity, result);                                        </span>
<span  style=""> 693                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 694         if (result.hasErrors()) {                                                                        </span>
<span class="-9083492279253959347" onmouseenter="enter('-9083492279253959347');" onmouseout="out('-9083492279253959347');" style=""> 695             model.addAttribute(&quot;headerFlash&quot;, &quot;save.unsuccessful&quot;);                                      </span>
<span class="-3255113992478543295" onmouseenter="enter('-3255113992478543295');" onmouseout="out('-3255113992478543295');" style=""> 696             model.addAttribute(&quot;headerFlashAlert&quot;, true);                                                </span>
<span  style=""> 697                                                                                                          </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 698             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 698             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 699             entityForm.clearFieldsMap();                                                                 </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 700             formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);       </span>
<span  style=""> 701                                                                                                          </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 702             modifyEntityForm(entity, entityForm, pathVars);                                              </span>
<span  style=""> 703                                                                                                          </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 704             model.addAttribute(&quot;entity&quot;, entity);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 705             model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                        </span>
<span  style=""> 706                                                                                                          </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 707             setModelAttributes(model, sectionKey);                                                       </span>
<span  style=""> 708                                                                                                          </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style=""> 709             return resolveAppropriateEntityView(request, model, entityForm);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 710         }                                                                                                </span>
<span  style=""> 711                                                                                                          </span>
<span class="-8977665602521560288" onmouseenter="enter('-8977665602521560288');" onmouseout="out('-8977665602521560288');" style=""> 712         ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;save.successful&quot;);                                          </span>
<span  style=""> 713                                                                                                          </span>
<span class="5326436654777975784" onmouseenter="enter('5326436654777975784');" onmouseout="out('5326436654777975784');" style=""> 714         return &quot;redirect:/&quot; + sectionKey + &quot;/&quot; + id;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 715     }                                                                                                    </span>
<span  style=""> 716                                                                                                          </span>
<span class="-1036069149620696687" onmouseenter="enter('-1036069149620696687');" onmouseout="out('-1036069149620696687');" style=""> 717     protected void modifyEntityForm(final Entity entity, final EntityForm entityForm,                    </span>
<span class="-2182671422299427893" onmouseenter="enter('-2182671422299427893');" onmouseout="out('-2182671422299427893');" style=""> 718             final Map&lt;String, String&gt; pathVars) throws Exception {                                       </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style=""> 719         if (isAddRequest(entity)) {                                                                      </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 720             modifyAddEntityForm(entityForm, pathVars);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 721         } else {                                                                                         </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 722             modifyEntityForm(entityForm, pathVars);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 723         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724     }                                                                                                    </span>
<span  style=""> 725                                                                                                          </span>
<span class="7327611436230860688" onmouseenter="enter('7327611436230860688');" onmouseout="out('7327611436230860688');" style=""> 726     protected String resolveAppropriateEntityView(final HttpServletRequest request,                      </span>
<span class="7665770463560391322" onmouseenter="enter('7665770463560391322');" onmouseout="out('7665770463560391322');" style=""> 727             final Model model,                                                                           </span>
<span class="6537819747648345888" onmouseenter="enter('6537819747648345888');" onmouseout="out('6537819747648345888');" style=""> 728             final @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) {                         </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 729         if (isAjaxRequest(request)) {                                                                    </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style=""> 730             entityForm.setReadOnly();                                                                    </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style=""> 731             model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                          </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style=""> 732             model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 733             return MODAL_CONTAINER_VIEW;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 734         } else {                                                                                         </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 735             model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                   </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 736             model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 737             return DEFAULT_CONTAINER_VIEW;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 738         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739     }                                                                                                    </span>
<span  style=""> 740                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 741     /**                                                                                                  </span>
<span class="4876253458579857532" onmouseenter="enter('4876253458579857532');" onmouseout="out('4876253458579857532');" style=""> 742      * Attempts to remove the given entity.                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 743      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 744      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 745      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 746      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 747      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 748      * @param id                                                                                         </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 749      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 750      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 751      */                                                                                                  </span>
<span class="8293921381301703428" onmouseenter="enter('8293921381301703428');" onmouseout="out('8293921381301703428');" style=""> 752     @RequestMapping(value = &quot;/{id}/delete&quot;, method = RequestMethod.POST)                                 </span>
<span class="2313354717081876463" onmouseenter="enter('2313354717081876463');" onmouseout="out('2313354717081876463');" style=""> 753     public String removeEntity(HttpServletRequest request, HttpServletResponse response, Model model,    </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 754             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 755             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 756             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,             </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 757             RedirectAttributes ra) throws Exception {                                                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 758         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 759         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 760         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span  style=""> 761                                                                                                          </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 762         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 762         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="6624819200143935214" onmouseenter="enter('6624819200143935214');" onmouseout="out('6624819200143935214');" style=""> 763         Entity entity = service.removeEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();    </span>
<span class="-6561774320633688873" onmouseenter="enter('-6561774320633688873');" onmouseout="out('-6561774320633688873');" style=""> 764         // Removal does not normally return an Entity unless there is some validation error              </span>
<span class="-2807113977407494827" onmouseenter="enter('-2807113977407494827');" onmouseout="out('-2807113977407494827');" style=""> 765         if (entity != null) {                                                                            </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 766             entityFormValidator.validate(entityForm, entity, result);                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 767             if (result.hasErrors()) {                                                                    </span>
<span class="354313568014337940" onmouseenter="enter('354313568014337940');" onmouseout="out('354313568014337940');" style=""> 768                 // Create a flash attribute for the unsuccessful delete                                  </span>
<span class="-3408473788799892596" onmouseenter="enter('-3408473788799892596');" onmouseout="out('-3408473788799892596');" style=""> 769                 FlashMap fm = new FlashMap();                                                            </span>
<span class="-3785724779356953427" onmouseenter="enter('-3785724779356953427');" onmouseout="out('-3785724779356953427');" style=""> 770                 fm.put(&quot;headerFlash&quot;, &quot;delete.unsuccessful&quot;);                                            </span>
<span class="2000410372434500283" onmouseenter="enter('2000410372434500283');" onmouseout="out('2000410372434500283');" style=""> 771                 fm.put(&quot;headerFlashAlert&quot;, true);                                                        </span>
<span class="-216272657842661141" onmouseenter="enter('-216272657842661141');" onmouseout="out('-216272657842661141');" style=""> 772                 request.setAttribute(DispatcherServlet.OUTPUT_FLASH_MAP_ATTRIBUTE, fm);                  </span>
<span  style=""> 773                                                                                                          </span>
<span class="-9154666565283892619" onmouseenter="enter('-9154666565283892619');" onmouseout="out('-9154666565283892619');" style=""> 774                 // Re-look back up the entity so that we can return something populated                  </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 775                 PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 775                 PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, secðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""><abbr title=" 776                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 776                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData(ðŸ”µ</abbr></span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 777                 entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];   </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 778                 Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 778                 Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr,ðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 779                 entityForm.clearFieldsMap();                                                             </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 780                 formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);   </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 781                 modifyEntityForm(entityForm, pathVars);                                                  </span>
<span  style=""> 782                                                                                                          </span>
<span class="-1358530666837283115" onmouseenter="enter('-1358530666837283115');" onmouseout="out('-1358530666837283115');" style=""> 783                 return populateJsonValidationErrors(entityForm, result, new JsonResponse(response))      </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style=""> 784                         .done();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 785             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 786         }                                                                                                </span>
<span  style=""> 787                                                                                                          </span>
<span class="3611526951082120901" onmouseenter="enter('3611526951082120901');" onmouseout="out('3611526951082120901');" style=""> 788         ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;delete.successful&quot;);                                        </span>
<span class="2579818068351246488" onmouseenter="enter('2579818068351246488');" onmouseout="out('2579818068351246488');" style=""> 789         ra.addFlashAttribute(&quot;headerFlashAlert&quot;, true);                                                  </span>
<span  style=""> 790                                                                                                          </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 791         if (isAjaxRequest(request)) {                                                                    </span>
<span class="-5684384949344822714" onmouseenter="enter('-5684384949344822714');" onmouseout="out('-5684384949344822714');" style=""> 792             // redirect attributes won&#x27;t work here since ajaxredirect actually makes a new request       </span>
<span class="-9107475529968351628" onmouseenter="enter('-9107475529968351628');" onmouseout="out('-9107475529968351628');" style=""><abbr title=" 793             return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;?headerFlash=delete.successful&quot;;"> 793             return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;?headerFlash=delete.successfðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 794         } else {                                                                                         </span>
<span class="4357427724598824699" onmouseenter="enter('4357427724598824699');" onmouseout="out('4357427724598824699');" style=""> 795             return &quot;redirect:/&quot; + sectionKey;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 796         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797     }                                                                                                    </span>
<span  style=""> 798                                                                                                          </span>
<span class="-2983794507366563158" onmouseenter="enter('-2983794507366563158');" onmouseout="out('-2983794507366563158');" style=""> 799     @RequestMapping(value = &quot;/{collectionField:.*}/details&quot;, method = RequestMethod.GET)                 </span>
<span class="-527911248282232950" onmouseenter="enter('-527911248282232950');" onmouseout="out('-527911248282232950');" style=""><abbr title=" 800     public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 800     public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpSeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 801             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 802             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-5250072335910309101" onmouseenter="enter('-5250072335910309101');" onmouseout="out('-5250072335910309101');" style=""> 803             @RequestParam String ids,                                                                    </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 804             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 805         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 806         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 807         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="-5225610456611199616" onmouseenter="enter('-5225610456611199616');" onmouseout="out('-5225610456611199616');" style=""><abbr title=" 808         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, sectionCrumbs, pathVars);"> 808         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""><abbr title=" 809         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 809         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDataðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 810         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 811         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style=""> 812                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style=""> 813         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span class="-2120492003233088270" onmouseenter="enter('-2120492003233088270');" onmouseout="out('-2120492003233088270');" style=""> 814         ppr.setStartIndex(getStartIndex(requestParams));                                                 </span>
<span class="2736790979641523309" onmouseenter="enter('2736790979641523309');" onmouseout="out('2736790979641523309');" style=""> 815         ppr.setMaxIndex(getMaxIndex(requestParams));                                                     </span>
<span  style=""> 816                                                                                                          </span>
<span class="-8000769512056204294" onmouseenter="enter('-8000769512056204294');" onmouseout="out('-8000769512056204294');" style=""> 817         if (md instanceof BasicFieldMetadata) {                                                          </span>
<span class="-1954892043355765019" onmouseenter="enter('-1954892043355765019');" onmouseout="out('-1954892043355765019');" style=""> 818             String idProp = ((BasicFieldMetadata) md).getForeignKeyProperty();                           </span>
<span class="6288096257758990604" onmouseenter="enter('6288096257758990604');" onmouseout="out('6288096257758990604');" style=""> 819             String displayProp = ((BasicFieldMetadata) md).getForeignKeyDisplayValueProperty();          </span>
<span  style=""> 820                                                                                                          </span>
<span class="-6477100624593005266" onmouseenter="enter('-6477100624593005266');" onmouseout="out('-6477100624593005266');" style=""> 821             List&lt;String&gt; filterValues = BLCArrayUtils.asList(ids.split(FILTER_VALUE_SEPARATOR_REGEX));   </span>
<span class="3640259021720155935" onmouseenter="enter('3640259021720155935');" onmouseout="out('3640259021720155935');" style=""> 822             ppr.addFilterAndSortCriteria(new FilterAndSortCriteria(idProp, filterValues));               </span>
<span  style=""> 823                                                                                                          </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style=""> 824             DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                        </span>
<span class="-2768740094948248396" onmouseenter="enter('-2768740094948248396');" onmouseout="out('-2768740094948248396');" style=""> 825             Map&lt;String, String&gt; returnMap = new HashMap&lt;&gt;();                                             </span>
<span  style=""> 826                                                                                                          </span>
<span class="-5517026699518874938" onmouseenter="enter('-5517026699518874938');" onmouseout="out('-5517026699518874938');" style=""> 827             for (Entity e : drs.getRecords()) {                                                          </span>
<span class="4979367110517822568" onmouseenter="enter('4979367110517822568');" onmouseout="out('4979367110517822568');" style=""> 828                 String id = e.getPMap().get(idProp).getValue();                                          </span>
<span class="-4946347213336092877" onmouseenter="enter('-4946347213336092877');" onmouseout="out('-4946347213336092877');" style=""> 829                 String disp = e.getPMap().get(displayProp).getDisplayValue();                            </span>
<span  style=""> 830                                                                                                          </span>
<span class="3483982845402449596" onmouseenter="enter('3483982845402449596');" onmouseout="out('3483982845402449596');" style=""> 831                 if (StringUtils.isBlank(disp)) {                                                         </span>
<span class="-2027181132953179584" onmouseenter="enter('-2027181132953179584');" onmouseout="out('-2027181132953179584');" style=""> 832                     disp = e.getPMap().get(displayProp).getValue();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 833                 }                                                                                        </span>
<span  style=""> 834                                                                                                          </span>
<span class="-1075893121428940879" onmouseenter="enter('-1075893121428940879');" onmouseout="out('-1075893121428940879');" style=""> 835                 returnMap.put(id,  disp);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 836             }                                                                                            </span>
<span  style=""> 837                                                                                                          </span>
<span class="9157811424862351106" onmouseenter="enter('9157811424862351106');" onmouseout="out('9157811424862351106');" style=""> 838             return returnMap;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 839         }                                                                                                </span>
<span  style=""> 840                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 841         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 842     }                                                                                                    </span>
<span  style=""> 843                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 844     /**                                                                                                  </span>
<span class="7896529828316523089" onmouseenter="enter('7896529828316523089');" onmouseout="out('7896529828316523089');" style=""><abbr title=" 845      * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a list of products"> 845      * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a ðŸ”µ</abbr></span>
<span class="8702245574166025616" onmouseenter="enter('8702245574166025616');" onmouseout="out('8702245574166025616');" style=""> 846      * then this method is invoked when a user clicks on the name of the default category field.         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 847      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 848      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 849      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 850      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 851      * @param pathVars                                                                                   </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 852      * @param collectionField                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 853      * @param id                                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 854      * @return                                                                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 855      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 856      */                                                                                                  </span>
<span class="1405910210670150204" onmouseenter="enter('1405910210670150204');" onmouseout="out('1405910210670150204');" style=""> 857     @RequestMapping(value = &quot;/{collectionField:.*}/{id}/view&quot;, method = RequestMethod.GET)               </span>
<span class="-5496524556428427140" onmouseenter="enter('-5496524556428427140');" onmouseout="out('-5496524556428427140');" style=""><abbr title=" 858     public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 858     public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, ModðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 859             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 860             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-1857511616350008386" onmouseenter="enter('-1857511616350008386');" onmouseout="out('-1857511616350008386');" style=""> 861             @PathVariable(value=&quot;id&quot;) String id) throws Exception {                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 862         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 863         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 864         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 865         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 865         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 866         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="2157347470680130722" onmouseenter="enter('2157347470680130722');" onmouseout="out('2157347470680130722');" style=""> 867         BasicFieldMetadata md = (BasicFieldMetadata) collectionProperty.getMetadata();                   </span>
<span  style=""> 868                                                                                                          </span>
<span class="-1856968160831305726" onmouseenter="enter('-1856968160831305726');" onmouseout="out('-1856968160831305726');" style=""><abbr title=" 869         AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeyClass(), sectionKey);"> 869         AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeðŸ”µ</abbr></span>
<span class="-151095669048618305" onmouseenter="enter('-151095669048618305');" onmouseout="out('-151095669048618305');" style=""><abbr title=" 870         String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : section.getUrl();"> 870         String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : sectiðŸ”µ</abbr></span>
<span class="4949862081138664893" onmouseenter="enter('4949862081138664893');" onmouseout="out('4949862081138664893');" style=""> 871         Map&lt;String, String&gt; varsForField = new HashMap&lt;&gt;();                                              </span>
<span class="-4429965231898090358" onmouseenter="enter('-4429965231898090358');" onmouseout="out('-4429965231898090358');" style=""> 872         varsForField.put(&quot;sectionKey&quot;, sectionUrlKey);                                                   </span>
<span class="4805235980730638518" onmouseenter="enter('4805235980730638518');" onmouseout="out('4805235980730638518');" style=""> 873         return viewEntityForm(request, response, model, varsForField, id);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 874     }                                                                                                    </span>
<span  style=""> 875                                                                                                          </span>
<span class="2731983140361230349" onmouseenter="enter('2731983140361230349');" onmouseout="out('2731983140361230349');" style=""> 876     @RequestMapping(                                                                                     </span>
<span class="4528666449367390600" onmouseenter="enter('4528666449367390600');" onmouseout="out('4528666449367390600');" style=""> 877             value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{tab:[0-9]+}/{tabName}&quot;,              </span>
<span class="7470628324060602258" onmouseenter="enter('7470628324060602258');" onmouseout="out('7470628324060602258');" style=""> 878             method = RequestMethod.POST                                                                  </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 879     )                                                                                                    </span>
<span class="1786222500639285262" onmouseenter="enter('1786222500639285262');" onmouseout="out('1786222500639285262');" style=""><abbr title=" 880     public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model model,"> 880     public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model mðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 881                                         @PathVariable  Map&lt;String, String&gt; pathVars,                     </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 882                                         @PathVariable(value=&quot;id&quot;) String id,                             </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 883                                         @PathVariable(value=&quot;collectionField&quot;) String collectionField,   </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style=""> 884                                         @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId, </span>
<span class="1347902176383833481" onmouseenter="enter('1347902176383833481');" onmouseout="out('1347902176383833481');" style=""> 885                                         @PathVariable(value=&quot;tabName&quot;) String tabName,                   </span>
<span class="-2122907702415237135" onmouseenter="enter('-2122907702415237135');" onmouseout="out('-2122907702415237135');" style=""><abbr title=" 886                                         @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throws Exception {"> 886                                         @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throðŸ”µ</abbr></span>
<span  style=""> 887                                                                                                          </span>
<span class="2284268618604436814" onmouseenter="enter('2284268618604436814');" onmouseout="out('2284268618604436814');" style=""><abbr title=" 888         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ModalHeaderType.VIEW_COLLECTION_ITEM.getType(), entityForm, null);"> 888         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 889     }                                                                                                    </span>
<span  style=""> 890                                                                                                          </span>
<span  style=""> 891                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 892     /**                                                                                                  </span>
<span class="1274042523848442367" onmouseenter="enter('1274042523848442367');" onmouseout="out('1274042523848442367');" style=""> 893      * Returns the records for a given collectionField filtered by a particular criteria                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 894      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 895      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 896      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 897      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 898      * @param pathVars                                                                                   </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 899      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 900      * @param requestParams                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 901      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 902      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 903      */                                                                                                  </span>
<span class="-4095443548484775059" onmouseenter="enter('-4095443548484775059');" onmouseout="out('-4095443548484775059');" style=""> 904     @RequestMapping(value = &quot;/{id}/{collectionField:.*}&quot;, method = RequestMethod.GET)                    </span>
<span class="-5889287394210369546" onmouseenter="enter('-5889287394210369546');" onmouseout="out('-5889287394210369546');" style=""><abbr title=" 905     public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, Model model,"> 905     public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, ModðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 906             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 907             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 908             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="3465670919255037355" onmouseenter="enter('3465670919255037355');" onmouseout="out('3465670919255037355');" style=""> 909             @RequestParam  MultiValueMap&lt;String, String&gt; requestParams) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 910         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 911         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 912         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-6545915569490985196" onmouseenter="enter('-6545915569490985196');" onmouseout="out('-6545915569490985196');" style=""><abbr title=" 913         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams, sectionCrumbs, pathVars);"> 913         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams,ðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""><abbr title=" 914         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 914         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDataðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 915         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style=""> 916                                                                                                          </span>
<span class="-3734134243620930531" onmouseenter="enter('-3734134243620930531');" onmouseout="out('-3734134243620930531');" style=""> 917         ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);               </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title=" 918         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];"> 918         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style=""> 919                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style=""> 920         // Next, we must get the new list grid that represents this collection                           </span>
<span class="-8440278474384944243" onmouseenter="enter('-8440278474384944243');" onmouseout="out('-8440278474384944243');" style=""><abbr title=" 921         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParams, sectionKey, sectionCrumbs);"> 921         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParamsðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 922         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style=""> 923                                                                                                          </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style=""> 924         model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));       </span>
<span  style=""> 925                                                                                                          </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style=""> 926         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 927         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style=""> 928         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 929     }                                                                                                    </span>
<span  style=""> 930                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 931     /**                                                                                                  </span>
<span class="-2279175998905644242" onmouseenter="enter('-2279175998905644242');" onmouseout="out('-2279175998905644242');" style=""><abbr title=" 932      * Shows the modal dialog that is used to add an item to a given collection. There are several possible outcomes"> 932      * Shows the modal dialog that is used to add an item to a given collection. There are several possibðŸ”µ</abbr></span>
<span class="-3490572548815062734" onmouseenter="enter('-3490572548815062734');" onmouseout="out('-3490572548815062734');" style=""> 933      * of this call depending on the type of the specified collection field.                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 934      *                                                                                                   </span>
<span class="2717555647352622731" onmouseenter="enter('2717555647352622731');" onmouseout="out('2717555647352622731');" style=""> 935      * &lt;ul&gt;                                                                                              </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 936      *  &lt;li&gt;                                                                                             </span>
<span class="4930235181592711719" onmouseenter="enter('4930235181592711719');" onmouseout="out('4930235181592711719');" style=""><abbr title=" 937      *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so that the user may"> 937      *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so thaðŸ”µ</abbr></span>
<span class="-3142080293607523336" onmouseenter="enter('-3142080293607523336');" onmouseout="out('-3142080293607523336');" style=""><abbr title=" 938      *    enter information and associate the record with this collection. Used by fields such as ProductAttribute."> 938      *    enter information and associate the record with this collection. Used by fields such as ProductðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 939      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 940      *  &lt;li&gt;                                                                                             </span>
<span class="6319691685860667757" onmouseenter="enter('6319691685860667757');" onmouseout="out('6319691685860667757');" style=""><abbr title=" 941      *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and select it."> 941      *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entiðŸ”µ</abbr></span>
<span class="-8731186021492741581" onmouseenter="enter('-8731186021492741581');" onmouseout="out('-8731186021492741581');" style=""> 942      *    Used by fields such as &quot;allParentCategories&quot;.                                                  </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 943      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 944      *  &lt;li&gt;                                                                                             </span>
<span class="-6847404578833725914" onmouseenter="enter('-6847404578833725914');" onmouseout="out('-6847404578833725914');" style=""><abbr title=" 945      *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 945      *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click onðŸ”µ</abbr></span>
<span class="568361472595397074" onmouseenter="enter('568361472595397074');" onmouseout="out('568361472595397074');" style=""><abbr title=" 946      *    select it. The view rendered by this is identical to basic collection (lookup), but will perform the operation"> 946      *    select it. The view rendered by this is identical to basic collection (lookup), but will perforðŸ”µ</abbr></span>
<span class="-4048066359856567222" onmouseenter="enter('-4048066359856567222');" onmouseout="out('-4048066359856567222');" style=""><abbr title=" 947      *    on an adorned field, which may carry extra meta-information about the created relationship, such as order."> 947      *    on an adorned field, which may carry extra meta-information about the created relationship, sucðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 948      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 949      *  &lt;li&gt;                                                                                             </span>
<span class="7355096557601214207" onmouseenter="enter('7355096557601214207');" onmouseout="out('7355096557601214207');" style=""><abbr title=" 950      *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 950      *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on anðŸ”µ</abbr></span>
<span class="-146713903552295440" onmouseenter="enter('-146713903552295440');" onmouseout="out('-146713903552295440');" style=""><abbr title=" 951      *    select it. Once the user selects the entity, he will be presented with an empty form based on the specified"> 951      *    select it. Once the user selects the entity, he will be presented with an empty form based on tðŸ”µ</abbr></span>
<span class="7585671366133275820" onmouseenter="enter('7585671366133275820');" onmouseout="out('7585671366133275820');" style=""><abbr title=" 952      *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, which in addition"> 952      *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, whiðŸ”µ</abbr></span>
<span class="7350312284882119043" onmouseenter="enter('7350312284882119043');" onmouseout="out('7350312284882119043');" style=""> 953      *    to linking an entity, provide extra fields, such as a promotional message.                     </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 954      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 955      *  &lt;li&gt;                                                                                             </span>
<span class="8829232354049589291" onmouseenter="enter('8829232354049589291');" onmouseout="out('8829232354049589291');" style=""><abbr title=" 956      *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. This field is"> 956      *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. ðŸ”µ</abbr></span>
<span class="-8508051731153769866" onmouseenter="enter('-8508051731153769866');" onmouseout="out('-8508051731153769866');" style=""><abbr title=" 957      *    populated either from the configured map keys, or as a result of a lookup in the case of a key based on another"> 957      *    populated either from the configured map keys, or as a result of a lookup in the case of a key ðŸ”µ</abbr></span>
<span class="-6056737616128420156" onmouseenter="enter('-6056737616128420156');" onmouseout="out('-6056737616128420156');" style=""> 958      *    entity. Used by fields such as the mediaMap on a Sku.                                          </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 959      *  &lt;/li&gt;                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 960      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 961      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 962      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 963      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 964      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 965      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 966      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 967      * @param requestParams                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 968      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 969      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 970      */                                                                                                  </span>
<span class="835275592837580694" onmouseenter="enter('835275592837580694');" onmouseout="out('835275592837580694');" style=""> 971     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.GET)                </span>
<span class="2460266594736272943" onmouseenter="enter('2460266594736272943');" onmouseout="out('2460266594736272943');" style=""><abbr title=" 972     public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,"> 972     public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model mðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 973             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 974             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style=""> 975             @PathVariable(value = &quot;collectionField&quot;) String collectionField,                             </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 976             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 977         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 978         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 979         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style=""><abbr title=" 980         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,"> 980         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style=""> 981                 sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 982         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 983         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style=""> 984                                                                                                          </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style=""> 985         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)        </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style=""> 986                 .withFilterAndSortCriteria(getCriteria(requestParams))                                   </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style=""> 987                 .withStartIndex(getStartIndex(requestParams))                                            </span>
<span class="4786121744461484155" onmouseenter="enter('4786121744461484155');" onmouseout="out('4786121744461484155');" style=""> 988                 .withMaxIndex(getMaxIndex(requestParams))                                                </span>
<span class="2941692162045974129" onmouseenter="enter('2941692162045974129');" onmouseout="out('2941692162045974129');" style=""> 989                 .withLastId(getLastId(requestParams))                                                    </span>
<span class="-9137331061893195290" onmouseenter="enter('-9137331061893195290');" onmouseout="out('-9137331061893195290');" style=""> 990                 .withFirstId(getFirstId(requestParams))                                                  </span>
<span class="-6497878492174321892" onmouseenter="enter('-6497878492174321892');" onmouseout="out('-6497878492174321892');" style=""> 991                 .withUpperCount(getUpperCount(requestParams))                                            </span>
<span class="-8373154769706308503" onmouseenter="enter('-8373154769706308503');" onmouseout="out('-8373154769706308503');" style=""> 992                 .withLowerCount(getLowerCount(requestParams))                                            </span>
<span class="-1051723743320189375" onmouseenter="enter('-1051723743320189375');" onmouseout="out('-1051723743320189375');" style=""> 993                 .withPageSize(getPageSize(requestParams))                                                </span>
<span class="-6582704259903712752" onmouseenter="enter('-6582704259903712752');" onmouseout="out('-6582704259903712752');" style=""> 994                 .withPresentationFetch(true);                                                            </span>
<span  style=""> 995                                                                                                          </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style=""> 996         if (md instanceof BasicCollectionMetadata) {                                                     </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style=""> 997             BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                  </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style=""> 998             if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                  </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""><abbr title=" 999                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 999                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData(ðŸ”µ</abbr></span>
<span class="-2914433993330253670" onmouseenter="enter('-2914433993330253670');" onmouseout="out('-2914433993330253670');" style=""><abbr title="1000                 // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types">1000                 // If the entity type isn&#x27;t specified, we need to determine if there are various polymorpðŸ”µ</abbr></span>
<span class="-7795450821592681641" onmouseenter="enter('-7795450821592681641');" onmouseout="out('-7795450821592681641');" style="">1001                 // for this entity.                                                                      </span>
<span class="6186895968667433501" onmouseenter="enter('6186895968667433501');" onmouseout="out('6186895968667433501');" style="">1002                 String entityType = null;                                                                </span>
<span  style="">1003                                                                                                          </span>
<span class="3580632700461537732" onmouseenter="enter('3580632700461537732');" onmouseout="out('3580632700461537732');" style="">1004                 if (requestParams.containsKey(&quot;entityType&quot;)) {                                           </span>
<span class="-1630371572733568969" onmouseenter="enter('-1630371572733568969');" onmouseout="out('-1630371572733568969');" style="">1005                     entityType = requestParams.get(&quot;entityType&quot;).get(0);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1006                 }                                                                                        </span>
<span  style="">1007                                                                                                          </span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style="">1008                 entityType = determineEntityType(entityType, cmd);                                       </span>
<span  style="">1009                                                                                                          </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style="">1010                 if (StringUtils.isBlank(entityType)) {                                                   </span>
<span class="679217737668422196" onmouseenter="enter('679217737668422196');" onmouseout="out('679217737668422196');" style="">1011                     return getModalForBlankEntityType(request, model, sectionKey, cmd);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1012                 }                                                                                        </span>
<span  style="">1013                                                                                                          </span>
<span class="-58316621888079189" onmouseenter="enter('-58316621888079189');" onmouseout="out('-58316621888079189');" style="">1014                 ppr = ppr.withCeilingEntityClassname(entityType);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1015             }                                                                                            </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1016         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="-8815560953057448419" onmouseenter="enter('-8815560953057448419');" onmouseout="out('-8815560953057448419');" style=""><abbr title="1017             ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(request,response,model,sectionKey,id,requestParams,(MapMetadata) md);">1017             ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionTypðŸ”µ</abbr></span>
<span class="6674469997589527714" onmouseenter="enter('6674469997589527714');" onmouseout="out('6674469997589527714');" style="">1018             if (result.equals(ExtensionResultStatusType.HANDLED)) {                                      </span>
<span class="1057476267973220454" onmouseenter="enter('1057476267973220454');" onmouseout="out('1057476267973220454');" style="">1019                 model.addAttribute(&quot;entityId&quot;, id);                                                      </span>
<span class="6720161805434028669" onmouseenter="enter('6720161805434028669');" onmouseout="out('6720161805434028669');" style="">1020                 model.addAttribute(&quot;sectionKey&quot;, sectionKey);                                            </span>
<span class="-2435595331613687341" onmouseenter="enter('-2435595331613687341');" onmouseout="out('-2435595331613687341');" style="">1021                 model.addAttribute(&quot;collectionField&quot;, collectionField);                                  </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1022                 return MODAL_CONTAINER_VIEW;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1023             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1024         }                                                                                                </span>
<span  style="">1025                                                                                                          </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style="">1026         model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));       </span>
<span  style="">1027                                                                                                          </span>
<span class="6180232744784249160" onmouseenter="enter('6180232744784249160');" onmouseout="out('6180232744784249160');" style=""><abbr title="1028         return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty, md, ppr, null, null);">1028         return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, colðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1029     }                                                                                                    </span>
<span  style="">1030                                                                                                          </span>
<span class="-2220429573703069666" onmouseenter="enter('-2220429573703069666');" onmouseout="out('-2220429573703069666');" style="">1031     protected String getModalForBlankEntityType(final HttpServletRequest request,                        </span>
<span class="-5263780204247815298" onmouseenter="enter('-5263780204247815298');" onmouseout="out('-5263780204247815298');" style="">1032             final Model model, final String sectionKey, final ClassMetadata cmd) {                       </span>
<span class="-2316979209506989336" onmouseenter="enter('-2316979209506989336');" onmouseout="out('-2316979209506989336');" style="">1033         final List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());             </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style="">1034         model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                  </span>
<span class="-7344898891916261334" onmouseenter="enter('-7344898891916261334');" onmouseout="out('-7344898891916261334');" style="">1035         model.addAttribute(&quot;viewType&quot;, &quot;modal/entityTypeSelection&quot;);                                     </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style="">1036         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span  style="">1037                                                                                                          </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style="">1038         String requestUri = request.getRequestURI();                                                     </span>
<span class="3126054482386392887" onmouseenter="enter('3126054482386392887');" onmouseout="out('3126054482386392887');" style="">1039         final String contextPath = request.getContextPath();                                             </span>
<span  style="">1040                                                                                                          </span>
<span class="1413502326105343009" onmouseenter="enter('1413502326105343009');" onmouseout="out('1413502326105343009');" style="">1041         if (!contextPath.equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(contextPath)) {                            </span>
<span class="-5812874762785975576" onmouseenter="enter('-5812874762785975576');" onmouseout="out('-5812874762785975576');" style="">1042             requestUri = requestUri.substring(contextPath.length() + 1, requestUri.length());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1043         }                                                                                                </span>
<span  style="">1044                                                                                                          </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style="">1045         model.addAttribute(&quot;currentUri&quot;, requestUri);                                                    </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style="">1046         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1047         setModelAttributes(model, sectionKey);                                                           </span>
<span  style="">1048                                                                                                          </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1049         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1050     }                                                                                                    </span>
<span  style="">1051                                                                                                          </span>
<span class="373770933822047642" onmouseenter="enter('373770933822047642');" onmouseout="out('373770933822047642');" style=""><abbr title="1052     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMethod.POST)">1052     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMðŸ”µ</abbr></span>
<span class="-870509305261572147" onmouseenter="enter('-870509305261572147');" onmouseout="out('-870509305261572147');" style=""><abbr title="1053     public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1053     public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1054             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1055             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1056             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1057             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1058         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1059         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1060         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1061         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1061         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1062         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1063         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1064         Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                               </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1065         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title="1066             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,">1066             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, maðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style="">1067                     collectionField,                                                                     </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style="">1068                     collectionItemId, responseMap);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1069         }                                                                                                </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1070         return responseMap;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1071     }                                                                                                    </span>
<span  style="">1072                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1073     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1074      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1075      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1076      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1077      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1078      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1079      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1080      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style="">1081      * @param requestParams                                                                              </span>
<span class="-4008047975326689228" onmouseenter="enter('-4008047975326689228');" onmouseout="out('-4008047975326689228');" style="">1082      * @return Json collection data                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1083      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1084      */                                                                                                  </span>
<span class="1491507797785399205" onmouseenter="enter('1491507797785399205');" onmouseout="out('1491507797785399205');" style="">1085     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize&quot;, method = RequestMethod.GET)          </span>
<span class="3394871197523978831" onmouseenter="enter('3394871197523978831');" onmouseout="out('3394871197523978831');" style=""><abbr title="1086     public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletResponse response, Model model,">1086     public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HtðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1087             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style="">1088             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style="">1089             @PathVariable(value = &quot;collectionField&quot;) String collectionField,                             </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style="">1090             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1091         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1092         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1093         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style=""><abbr title="1094         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,">1094         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style="">1095                 sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1096         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1097         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style="">1098                                                                                                          </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style="">1099         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)        </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style="">1100                 .withFilterAndSortCriteria(getCriteria(requestParams))                                   </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style="">1101                 .withStartIndex(getStartIndex(requestParams))                                            </span>
<span class="-115113180096268460" onmouseenter="enter('-115113180096268460');" onmouseout="out('-115113180096268460');" style="">1102                 .withMaxIndex(getMaxIndex(requestParams));                                               </span>
<span class="1857239787668878379" onmouseenter="enter('1857239787668878379');" onmouseout="out('1857239787668878379');" style=""><abbr title="1103         String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizeCustomCriteria()))">1103         String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizðŸ”µ</abbr></span>
<span class="8925682901439482297" onmouseenter="enter('8925682901439482297');" onmouseout="out('8925682901439482297');" style="">1104                 .toArray(String[]::new);                                                                 </span>
<span class="-226841645969872938" onmouseenter="enter('-226841645969872938');" onmouseout="out('-226841645969872938');" style="">1105         ppr = ppr.withCustomCriteria( both);                                                             </span>
<span  style="">1106                                                                                                          </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1107         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1108             ppr.setOperationTypesOverride(null);                                                         </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1109             ppr.setType(PersistencePackageRequest.Type.STANDARD);                                        </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1110             ppr.setSectionEntityField(collectionField);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1111         }                                                                                                </span>
<span  style="">1112                                                                                                          </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1113         DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                            </span>
<span  style="">1114                                                                                                          </span>
<span class="9153362413933125536" onmouseenter="enter('9153362413933125536');" onmouseout="out('9153362413933125536');" style=""><abbr title="1115         return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1115         return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1116     }                                                                                                    </span>
<span  style="">1117                                                                                                          </span>
<span class="-7439222430983038453" onmouseenter="enter('-7439222430983038453');" onmouseout="out('-7439222430983038453');" style="">1118     protected String[] buildSelectizeCustomCriteria() {                                                  </span>
<span class="-4161579644301235736" onmouseenter="enter('-4161579644301235736');" onmouseout="out('-4161579644301235736');" style="">1119         return new String[]{ IS_SELECTIZE_REQUEST };                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1120     }                                                                                                    </span>
<span  style="">1121                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1122     /**                                                                                                  </span>
<span class="-7141111024633203374" onmouseenter="enter('-7141111024633203374');" onmouseout="out('-7141111024633203374');" style="">1123      * Adds the requested collection item via Selectize                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1124      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1125      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1126      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1127      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1128      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1129      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1130      * @param collectionField                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1131      * @param entityForm                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1132      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1133      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1134      */                                                                                                  </span>
<span class="4942792763487402415" onmouseenter="enter('4942792763487402415');" onmouseout="out('4942792763487402415');" style="">1135     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize-add&quot;, method = RequestMethod.POST)     </span>
<span class="8163998475300370418" onmouseenter="enter('8163998475300370418');" onmouseout="out('8163998475300370418');" style=""><abbr title="1136     public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1136     public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpSðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1137             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1138             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1139             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1140             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1140             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-3120252458037341618" onmouseenter="enter('-3120252458037341618');" onmouseout="out('-3120252458037341618');" style="">1141         Map&lt;String, Object&gt; returnVal = new HashMap&lt;&gt;();                                                 </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1142         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1143         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1144         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1145         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1145         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1146         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1147                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1148         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1149             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1150             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1151                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1152             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1153         }                                                                                                </span>
<span  style="">1154                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1155         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1155         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style="">1156         ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                           </span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1157         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1158         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1158         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1159                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1160         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1161         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1161         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1162         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1163         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1164                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1165         if (result.hasErrors()) {                                                                        </span>
<span class="842224369260603633" onmouseenter="enter('842224369260603633');" onmouseout="out('842224369260603633');" style="">1166             returnVal.put(&quot;error&quot;, result.getFieldError());                                              </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1167             return returnVal;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1168         }                                                                                                </span>
<span  style="">1169                                                                                                          </span>
<span class="2610632867002015507" onmouseenter="enter('2610632867002015507');" onmouseout="out('2610632867002015507');" style="">1170         if (savedEntity.findProperty(ALTERNATE_ID_PROPERTY) != null) {                                   </span>
<span class="-5383740165855607078" onmouseenter="enter('-5383740165855607078');" onmouseout="out('-5383740165855607078');" style="">1171             returnVal.put(&quot;alternateId&quot;, savedEntity.findProperty(ALTERNATE_ID_PROPERTY).getValue());    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1172         }                                                                                                </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1173         return returnVal;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1174     }                                                                                                    </span>
<span  style="">1175                                                                                                          </span>
<span class="5412920841771640365" onmouseenter="enter('5412920841771640365');" onmouseout="out('5412920841771640365');" style="">1176     protected void declareShouldIgnoreAdditionStatusFilter() {                                           </span>
<span class="-4270951653865217168" onmouseenter="enter('-4270951653865217168');" onmouseout="out('-4270951653865217168');" style=""><abbr title="1177         Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().getAdditionalProperties();">1177         Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().gðŸ”µ</abbr></span>
<span class="-3723341051420574210" onmouseenter="enter('-3723341051420574210');" onmouseout="out('-3723341051420574210');" style="">1178         additionalProperties.put(&quot;shouldIgnoreAdditionStatusFilter&quot;, true);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1179     }                                                                                                    </span>
<span  style="">1180                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1181     /**                                                                                                  </span>
<span class="1325408264830379158" onmouseenter="enter('1325408264830379158');" onmouseout="out('1325408264830379158');" style="">1182      * Adds the requested collection item                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1183      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1184      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1185      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1186      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1187      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1188      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1189      * @param collectionField                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1190      * @param entityForm                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1191      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1192      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1193      */                                                                                                  </span>
<span class="-2068929988984533631" onmouseenter="enter('-2068929988984533631');" onmouseout="out('-2068929988984533631');" style="">1194     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.POST)               </span>
<span class="-6457137423768539998" onmouseenter="enter('-6457137423768539998');" onmouseout="out('-6457137423768539998');" style=""><abbr title="1195     public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1195     public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model modelðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1196             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1197             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1198             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1199             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1199             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1200         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1201         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1202         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1203         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1203         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1204         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1205                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1206         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1207             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1208             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1209                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1210             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1211         }                                                                                                </span>
<span  style="">1212                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1213         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1213         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1214         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1215         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1215         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1216                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1217         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1218         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1218         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1219         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1220         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1221                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1222         if (result.hasErrors()) {                                                                        </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1223             FieldMetadata md = collectionProperty.getMetadata();                                         </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1224             ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                             </span>
<span class="4503162777083318611" onmouseenter="enter('4503162777083318611');" onmouseout="out('4503162777083318611');" style=""><abbr title="1225             return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty,">1225             return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey,ðŸ”µ</abbr></span>
<span class="5267635088951466475" onmouseenter="enter('5267635088951466475');" onmouseout="out('5267635088951466475');" style="">1226                     md, ppr, entityForm, savedEntity);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1227         }                                                                                                </span>
<span  style="">1228                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1229         // Next, we must get the new list grid that represents this collection                           </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1230         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1230         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1231         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style="">1232                                                                                                          </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1233         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="7250522969210652718" onmouseenter="enter('7250522969210652718');" onmouseout="out('7250522969210652718');" style="">1234         model.addAttribute(&quot;actualEntityId&quot;, id);                                                        </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1235         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1236         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1237     }                                                                                                    </span>
<span  style="">1238                                                                                                          </span>
<span class="-8003545521832011894" onmouseenter="enter('-8003545521832011894');" onmouseout="out('-8003545521832011894');" style="">1239     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/addEmpty&quot;, method = RequestMethod.POST)          </span>
<span class="162700220048203938" onmouseenter="enter('162700220048203938');" onmouseout="out('162700220048203938');" style=""><abbr title="1240     public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1240     public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse reðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1241             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1242             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1243             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1244             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1244             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1245         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1246         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1247         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1248         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1248         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1249         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1250                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1251         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1252             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1253             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1254                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1255             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1256         }                                                                                                </span>
<span  style="">1257                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1258         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1258         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1259         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1259         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span class="-5337934248855825573" onmouseenter="enter('-5337934248855825573');" onmouseout="out('-5337934248855825573');" style="">1260         entity.setIsPreAdd(true);                                                                        </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1261         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1262         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1262         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1263         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span  style="">1264                                                                                                          </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1265         return new JsonResponse(response)                                                                </span>
<span class="-645443211281069037" onmouseenter="enter('-645443211281069037');" onmouseout="out('-645443211281069037');" style="">1266                 .with(&quot;status&quot;, &quot;complete&quot;)                                                              </span>
<span class="-7858493257692229655" onmouseenter="enter('-7858493257692229655');" onmouseout="out('-7858493257692229655');" style="">1267                 .with(&quot;id&quot;, savedEntity.findProperty(entityForm.getIdProperty()).getValue())             </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1268                 .done();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1269     }                                                                                                    </span>
<span  style="">1270                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1271     /**                                                                                                  </span>
<span class="-6140462241686685910" onmouseenter="enter('-6140462241686685910');" onmouseout="out('-6140462241686685910');" style=""><abbr title="1272      * Builds out all of the model information needed for showing the add modal for collection items on both the initial GET">1272      * Builds out all of the model information needed for showing the add modal for collection items on bðŸ”µ</abbr></span>
<span class="9052968863197617086" onmouseenter="enter('9052968863197617086');" onmouseout="out('9052968863197617086');" style="">1273      * as well as after a POST with validation errors                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1274      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1275      * @param request                                                                                    </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1276      * @param model                                                                                      </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1277      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1278      * @param collectionField                                                                            </span>
<span class="7403666429378321004" onmouseenter="enter('7403666429378321004');" onmouseout="out('7403666429378321004');" style="">1279      * @param sectionKey                                                                                 </span>
<span class="-7927619294366963435" onmouseenter="enter('-7927619294366963435');" onmouseout="out('-7927619294366963435');" style="">1280      * @param collectionProperty                                                                         </span>
<span class="-5426566728726502924" onmouseenter="enter('-5426566728726502924');" onmouseout="out('-5426566728726502924');" style="">1281      * @param md                                                                                         </span>
<span class="4349163197755218506" onmouseenter="enter('4349163197755218506');" onmouseout="out('4349163197755218506');" style="">1282      * @param ppr                                                                                        </span>
<span class="2094225145376343101" onmouseenter="enter('2094225145376343101');" onmouseout="out('2094225145376343101');" style="">1283      * @return the appropriate view to display for the modal                                             </span>
<span class="450948407444547835" onmouseenter="enter('450948407444547835');" onmouseout="out('450948407444547835');" style=""><abbr title="1284      * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, EntityForm, BindingResult)}">1284      * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, StringðŸ”µ</abbr></span>
<span class="3423849059172457982" onmouseenter="enter('3423849059172457982');" onmouseout="out('3423849059172457982');" style=""><abbr title="1285      * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, MultiValueMap)}">1285      * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, StðŸ”µ</abbr></span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1286      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1287      */                                                                                                  </span>
<span class="-4127331421111161450" onmouseenter="enter('-4127331421111161450');" onmouseout="out('-4127331421111161450');" style=""><abbr title="1288     protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse response,">1288     protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse responseðŸ”µ</abbr></span>
<span class="1808182660955839449" onmouseenter="enter('1808182660955839449');" onmouseout="out('1808182660955839449');" style=""><abbr title="1289             Model model, String id, String collectionField, String sectionKey, Property collectionProperty,">1289             Model model, String id, String collectionField, String sectionKey, Property collectionPropertðŸ”µ</abbr></span>
<span class="-5972908184992702659" onmouseenter="enter('-5972908184992702659');" onmouseout="out('-5972908184992702659');" style=""><abbr title="1290             FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throws ServiceException {">1290             FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throwsðŸ”µ</abbr></span>
<span  style="">1291                                                                                                          </span>
<span class="-2054675889041043286" onmouseenter="enter('-2054675889041043286');" onmouseout="out('-2054675889041043286');" style=""><abbr title="1292         // For requests to add a new collection item include the main class that the subsequent request comes from.">1292         // For requests to add a new collection item include the main class that the subsequent request cðŸ”µ</abbr></span>
<span class="7422952884503198827" onmouseenter="enter('7422952884503198827');" onmouseout="out('7422952884503198827');" style=""><abbr title="1293         // For instance, with basic collections we know the main associated class for a fetch through the ForeignKey">1293         // For instance, with basic collections we know the main associated class for a fetch through theðŸ”µ</abbr></span>
<span class="5831142982738818001" onmouseenter="enter('5831142982738818001');" onmouseout="out('5831142982738818001');" style=""><abbr title="1294         // persistence item but map and adorned target lookups make a standard persistence request. This solution">1294         // persistence item but map and adorned target lookups make a standard persistence request. This ðŸ”µ</abbr></span>
<span class="-3910081436214830376" onmouseenter="enter('-3910081436214830376');" onmouseout="out('-3910081436214830376');" style="">1295         // fixes all cases.                                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1296         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-8007514226035577536" onmouseenter="enter('-8007514226035577536');" onmouseout="out('-8007514226035577536');" style="">1297         ppr.addCustomCriteria(&quot;owningClass=&quot; + mainClassName);                                           </span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style="">1298         ppr.setAddOperationInspect(true);                                                                </span>
<span  style="">1299                                                                                                          </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1300         if (entityForm != null) {                                                                        </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1301             entityForm.clearFieldsMap();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1302         }                                                                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1303         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style="">1304         if (md instanceof BasicCollectionMetadata) {                                                     </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1305             BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                  </span>
<span  style="">1306                                                                                                          </span>
<span class="5473401195179812518" onmouseenter="enter('5473401195179812518');" onmouseout="out('5473401195179812518');" style=""><abbr title="1307             // When adding items to basic collections, we will sometimes show a form to persist a new record">1307             // When adding items to basic collections, we will sometimes show a form to persist a new recðŸ”µ</abbr></span>
<span class="3817220166052180028" onmouseenter="enter('3817220166052180028');" onmouseout="out('3817220166052180028');" style="">1308             // and sometimes show a list grid to allow the user to associate an existing record.         </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style="">1309             if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                  </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1310                 ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1310                 ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().geðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1311                 if (entityForm == null) {                                                                </span>
<span class="509426350308747164" onmouseenter="enter('509426350308747164');" onmouseout="out('509426350308747164');" style="">1312                     entityForm = formService.createEntityForm(collectionMetadata,sectionCrumbs);         </span>
<span class="2737056182573571703" onmouseenter="enter('2737056182573571703');" onmouseout="out('2737056182573571703');" style="">1313                     entityForm.setCeilingEntityClassname(ppr.getCeilingEntityClassname());               </span>
<span class="2710161406345740991" onmouseenter="enter('2710161406345740991');" onmouseout="out('2710161406345740991');" style="">1314                     entityForm.setEntityType(ppr.getCeilingEntityClassname());                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1315                 } else {                                                                                 </span>
<span class="-5799643084244932085" onmouseenter="enter('-5799643084244932085');" onmouseout="out('-5799643084244932085');" style="">1316                     formService.populateEntityForm(collectionMetadata, entityForm, sectionCrumbs);       </span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1317                     formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1318                 }                                                                                        </span>
<span class="-7315185064917392199" onmouseenter="enter('-7315185064917392199');" onmouseout="out('-7315185064917392199');" style=""><abbr title="1319                 formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntityClassname());">1319                 formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntitðŸ”µ</abbr></span>
<span class="1687533348183327340" onmouseenter="enter('1687533348183327340');" onmouseout="out('1687533348183327340');" style="">1320                 entityForm.getTabs().iterator().next().getIsVisible();                                   </span>
<span  style="">1321                                                                                                          </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1322                 model.addAttribute(&quot;entityForm&quot;, entityForm);                                            </span>
<span class="-2634442257361103125" onmouseenter="enter('-2634442257361103125');" onmouseout="out('-2634442257361103125');" style="">1323                 model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleAddEntity&quot;);                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1324             } else {                                                                                     </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1325                 DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                    </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1326                 ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1326                 ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectðŸ”µ</abbr></span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1327                 listGrid.setPathOverride(request.getRequestURL().toString());                            </span>
<span  style="">1328                                                                                                          </span>
<span class="6493773829436488040" onmouseenter="enter('6493773829436488040');" onmouseout="out('6493773829436488040');" style=""><abbr title="1329                 if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUP.equals(fmd.getAddMethodType())) {">1329                 if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUPðŸ”µ</abbr></span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1330                     listGrid.removeAllRowActions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1331                 }                                                                                        </span>
<span  style="">1332                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1333                 model.addAttribute(&quot;listGrid&quot;, listGrid);                                                </span>
<span class="-4615041483574305082" onmouseenter="enter('-4615041483574305082');" onmouseout="out('-4615041483574305082');" style="">1334                 model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleSelectEntity&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1335             }                                                                                            </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1336         } else if (md instanceof AdornedTargetCollectionMetadata) {                                      </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1337             AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                  </span>
<span  style="">1338                                                                                                          </span>
<span class="-4994014003685781795" onmouseenter="enter('-4994014003685781795');" onmouseout="out('-4994014003685781795');" style=""><abbr title="1339             // Even though this field represents an adorned target collection, the list we want to show in the modal">1339             // Even though this field represents an adorned target collection, the list we want to show iðŸ”µ</abbr></span>
<span class="3396745077097675731" onmouseenter="enter('3396745077097675731');" onmouseout="out('3396745077097675731');" style="">1340             // is the standard list grid for the target entity of this field                             </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1341             ppr.setOperationTypesOverride(null);                                                         </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1342             ppr.setType(PersistencePackageRequest.Type.STANDARD);                                        </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1343             ppr.setSectionEntityField(collectionField);                                                  </span>
<span  style="">1344                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1345             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1345             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span  style="">1346                                                                                                          </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1347             DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                        </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1348             ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1348             ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKðŸ”µ</abbr></span>
<span class="1884537605734649521" onmouseenter="enter('1884537605734649521');" onmouseout="out('1884537605734649521');" style="">1349             listGrid.setSubCollectionFieldName(collectionField);                                         </span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1350             listGrid.setPathOverride(request.getRequestURL().toString());                                </span>
<span class="2370419943178688476" onmouseenter="enter('2370419943178688476');" onmouseout="out('2370419943178688476');" style="">1351             listGrid.setFriendlyName(collectionMetadata.getPolymorphicEntities().getFriendlyName());     </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1352             if (entityForm == null) {                                                                    </span>
<span class="-1229292684052118628" onmouseenter="enter('-1229292684052118628');" onmouseout="out('-1229292684052118628');" style=""><abbr title="1353                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, true);">1353                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectiðŸ”µ</abbr></span>
<span class="-7486141420721649683" onmouseenter="enter('-7486141420721649683');" onmouseout="out('-7486141420721649683');" style=""><abbr title="1354                 entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassname());">1354                 entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassnameðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1355             } else {                                                                                     </span>
<span class="7685228187033982459" onmouseenter="enter('7685228187033982459');" onmouseout="out('7685228187033982459');" style=""><abbr title="1356                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectionCrumbs, true);">1356                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectioðŸ”µ</abbr></span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1357                 formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1358             }                                                                                            </span>
<span  style="">1359                                                                                                          </span>
<span class="5169338689637413329" onmouseenter="enter('5169338689637413329');" onmouseout="out('5169338689637413329');" style="">1360             listGrid.setListGridType(ListGrid.Type.ADORNED);                                             </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1361             for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                       </span>
<span class="8450559638200016101" onmouseenter="enter('8450559638200016101');" onmouseout="out('8450559638200016101');" style="">1362                 if (entry.getValue().getIsVisible()) {                                                   </span>
<span class="1657391013588898454" onmouseenter="enter('1657391013588898454');" onmouseout="out('1657391013588898454');" style="">1363                     listGrid.setListGridType(ListGrid.Type.ADORNED_WITH_FORM);                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1364                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1365                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1366             }                                                                                            </span>
<span  style="">1367                                                                                                          </span>
<span class="-757286675881477752" onmouseenter="enter('-757286675881477752');" onmouseout="out('-757286675881477752');" style="">1368             // This is part of an add, so we want to be able to filter/sort the listgrid                 </span>
<span class="3421525283764936758" onmouseenter="enter('3421525283764936758');" onmouseout="out('3421525283764936758');" style="">1369             listGrid.setIsSortable(false);                                                               </span>
<span class="-2714096270635703274" onmouseenter="enter('-2714096270635703274');" onmouseout="out('-2714096270635703274');" style="">1370             listGrid.setCanFilterAndSort(true);                                                          </span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1371             listGrid.removeAllRowActions();                                                              </span>
<span  style="">1372                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1373             model.addAttribute(&quot;listGrid&quot;, listGrid);                                                    </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1374             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="-1071174233767081578" onmouseenter="enter('-1071174233767081578');" onmouseout="out('-1071174233767081578');" style="">1375             model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedSelectEntity&quot;);                                 </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1376         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1377             MapMetadata fmd = (MapMetadata) md;                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1378             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1378             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span  style="">1379                                                                                                          </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1380             if (entityForm == null) {                                                                    </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style=""><abbr title="1381                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);">1381                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1382             } else {                                                                                     </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1383                 formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);</span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1384                 formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1385             }                                                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1386             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="-892500240032703395" onmouseenter="enter('-892500240032703395');" onmouseout="out('-892500240032703395');" style="">1387             model.addAttribute(&quot;viewType&quot;, &quot;modal/mapAddEntity&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1388         }                                                                                                </span>
<span  style="">1389                                                                                                          </span>
<span class="6074380392351813368" onmouseenter="enter('6074380392351813368');" onmouseout="out('6074380392351813368');" style="">1390         // Set the parent id on the entity form                                                          </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1391         if (entityForm != null) {                                                                        </span>
<span class="-3154229542834445725" onmouseenter="enter('-3154229542834445725');" onmouseout="out('-3154229542834445725');" style="">1392             entityForm.setParentId(id);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1393         }                                                                                                </span>
<span  style="">1394                                                                                                          </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1395         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="7819166863376485578" onmouseenter="enter('7819166863376485578');" onmouseout="out('7819166863376485578');" style="">1396         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_COLLECTION_ITEM.getType());            </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1397         model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1398         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1399         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1400     }                                                                                                    </span>
<span  style="">1401                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1402     /**                                                                                                  </span>
<span class="3915085583429756257" onmouseenter="enter('3915085583429756257');" onmouseout="out('3915085583429756257');" style="">1403      * Shows the appropriate modal dialog to edit the selected collection item                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1404      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1405      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1406      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1407      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1408      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1409      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1410      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1411      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1412      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1413      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1414      */                                                                                                  </span>
<span class="5941881897199209931" onmouseenter="enter('5941881897199209931');" onmouseout="out('5941881897199209931');" style=""><abbr title="1415     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.GET)">1415     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style=""><abbr title="1416     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1416     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, ModeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1417             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1418             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1419             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1420             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1421             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1422         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1422         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1423                 ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1424     }                                                                                                    </span>
<span  style="">1425                                                                                                          </span>
<span class="-3777402830265989862" onmouseenter="enter('-3777402830265989862');" onmouseout="out('-3777402830265989862');" style="">1426     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.GET) </span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style=""><abbr title="1427     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1427     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, ModeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1428             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1429             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1430             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1431             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="7585768018133278114" onmouseenter="enter('7585768018133278114');" onmouseout="out('7585768018133278114');" style=""><abbr title="1432         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1432         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1433                 ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1434     }                                                                                                    </span>
<span  style="">1435                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1436     /**                                                                                                  </span>
<span class="6761933478321573145" onmouseenter="enter('6761933478321573145');" onmouseout="out('6761933478321573145');" style=""><abbr title="1437      * Shows the appropriate modal dialog to view the selected collection item. This will display the modal as readonly">1437      * Shows the appropriate modal dialog to view the selected collection item. This will display the modðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1438      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1439      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1440      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1441      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1442      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1443      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1444      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1445      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1446      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1447      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1448      */                                                                                                  </span>
<span class="5228464490364608791" onmouseenter="enter('5228464490364608791');" onmouseout="out('5228464490364608791');" style=""><abbr title="1449     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = RequestMethod.GET)">1449     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = ðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style=""><abbr title="1450     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1450     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model ðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1451             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1452             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1453             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1454             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1455             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="7887850161668822106" onmouseenter="enter('7887850161668822106');" onmouseout="out('7887850161668822106');" style=""><abbr title="1456         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1456         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, colleðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1457                 ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                         </span>
<span  style="">1458                                                                                                          </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1459         // Since this is a read-only view, actions don&#x27;t make sense in this context                      </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1460         EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                    </span>
<span class="7289613241506142720" onmouseenter="enter('7289613241506142720');" onmouseout="out('7289613241506142720');" style="">1461         addAuditableDisplayFields(ef);                                                                   </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1462         ef.removeAllActions();                                                                           </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1463         ef.setReadOnly();                                                                                </span>
<span  style="">1464                                                                                                          </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1465         return returnPath;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1466     }                                                                                                    </span>
<span  style="">1467                                                                                                          </span>
<span class="6858008221927215769" onmouseenter="enter('6858008221927215769');" onmouseout="out('6858008221927215769');" style=""><abbr title="1468     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.GET)">1468     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.ðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style=""><abbr title="1469     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1469     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model ðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1470             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1471             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1472             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1473             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="2521791674908842244" onmouseenter="enter('2521791674908842244');" onmouseout="out('2521791674908842244');" style=""><abbr title="1474         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1474         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, colleðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1475                 ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                         </span>
<span  style="">1476                                                                                                          </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1477         // Since this is a read-only view, actions don&#x27;t make sense in this context                      </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1478         EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                    </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1479         ef.removeAllActions();                                                                           </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1480         ef.setReadOnly();                                                                                </span>
<span  style="">1481                                                                                                          </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1482         return returnPath;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1483     }                                                                                                    </span>
<span  style="">1484                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1485     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1485     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="6852009337058352330" onmouseenter="enter('6852009337058352330');" onmouseout="out('6852009337058352330');" style=""><abbr title="1486             String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType) throws ServiceException {">1486             String id, String collectionField, String collectionItemId, String alternateId, String modalHðŸ”µ</abbr></span>
<span class="-2699953653458232908" onmouseenter="enter('-2699953653458232908');" onmouseout="out('-2699953653458232908');" style=""><abbr title="1487         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId, modalHeaderType, null, null);">1487         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1488     }                                                                                                    </span>
<span  style="">1489                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1490     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1490     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="-3706011950121400951" onmouseenter="enter('-3706011950121400951');" onmouseout="out('-3706011950121400951');" style=""><abbr title="1491             String id, String collectionField, String collectionItemId, String modalHeaderType) throws ServiceException {">1491             String id, String collectionField, String collectionItemId, String modalHeaderType) throws SeðŸ”µ</abbr></span>
<span class="-6899013896128397577" onmouseenter="enter('-6899013896128397577');" onmouseout="out('-6899013896128397577');" style=""><abbr title="1492         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, null, null);">1492         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1493     }                                                                                                    </span>
<span  style="">1494                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1495     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1495     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="4852573692087282601" onmouseenter="enter('4852573692087282601');" onmouseout="out('4852573692087282601');" style=""><abbr title="1496                 String id, String collectionField, String collectionItemId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1496                 String id, String collectionField, String collectionItemId, String modalHeaderType, EntitðŸ”µ</abbr></span>
<span class="6580107021722154279" onmouseenter="enter('6580107021722154279');" onmouseout="out('6580107021722154279');" style=""><abbr title="1497         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, entityForm, entity);">1497         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1498     }                                                                                                    </span>
<span  style="">1499                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1500     /**                                                                                                  </span>
<span class="837861132196545598" onmouseenter="enter('837861132196545598');" onmouseout="out('837861132196545598');" style=""><abbr title="1501      * Shows the view and populates the model for updating a collection item. You can also pass in an entityform and entity">1501      * Shows the view and populates the model for updating a collection item. You can also pass in an entðŸ”µ</abbr></span>
<span class="5643306329084644224" onmouseenter="enter('5643306329084644224');" onmouseout="out('5643306329084644224');" style="">1502      * which are optional. If they are not passed in then they are automatically looked up               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1503      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1504      * @param request                                                                                    </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1505      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1506      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1507      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1508      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1509      * @param collectionItemId                                                                           </span>
<span class="-5929844173285242940" onmouseenter="enter('-5929844173285242940');" onmouseout="out('-5929844173285242940');" style="">1510      * @param modalHeaderType                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1511      * @param entityForm                                                                                 </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style="">1512      * @param entity                                                                                     </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">1513      * @return                                                                                           </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1514      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1515      */                                                                                                  </span>
<span class="-7113907340183053787" onmouseenter="enter('-7113907340183053787');" onmouseout="out('-7113907340183053787');" style="">1516     protected String showViewUpdateCollection(HttpServletRequest request,                                </span>
<span class="-8519940996091909282" onmouseenter="enter('-8519940996091909282');" onmouseout="out('-8519940996091909282');" style="">1517             Model model,                                                                                 </span>
<span class="233550986134862533" onmouseenter="enter('233550986134862533');" onmouseout="out('233550986134862533');" style="">1518             Map&lt;String, String&gt; pathVars,                                                                </span>
<span class="462404651577214798" onmouseenter="enter('462404651577214798');" onmouseout="out('462404651577214798');" style="">1519             String id,                                                                                   </span>
<span class="-5551105944774799057" onmouseenter="enter('-5551105944774799057');" onmouseout="out('-5551105944774799057');" style="">1520             String collectionField,                                                                      </span>
<span class="-7138244874257810737" onmouseenter="enter('-7138244874257810737');" onmouseout="out('-7138244874257810737');" style="">1521             String collectionItemId,                                                                     </span>
<span class="7426253478403504017" onmouseenter="enter('7426253478403504017');" onmouseout="out('7426253478403504017');" style="">1522             String alternateId,                                                                          </span>
<span class="2900696252953040190" onmouseenter="enter('2900696252953040190');" onmouseout="out('2900696252953040190');" style="">1523             String modalHeaderType,                                                                      </span>
<span class="5597094285729719755" onmouseenter="enter('5597094285729719755');" onmouseout="out('5597094285729719755');" style="">1524             EntityForm entityForm,                                                                       </span>
<span class="3632664887850253049" onmouseenter="enter('3632664887850253049');" onmouseout="out('3632664887850253049');" style="">1525             Entity entity) throws ServiceException {                                                     </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1526         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1527         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1528         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1529         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1529         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1530         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1531         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-2889762407992276786" onmouseenter="enter('-2889762407992276786');" onmouseout="out('-2889762407992276786');" style="">1532         SectionCrumb nextCrumb = new SectionCrumb();                                                     </span>
<span class="4180533444018328805" onmouseenter="enter('4180533444018328805');" onmouseout="out('4180533444018328805');" style="">1533         if (md instanceof MapMetadata) {                                                                 </span>
<span class="-382349485821163458" onmouseenter="enter('-382349485821163458');" onmouseout="out('-382349485821163458');" style="">1534             nextCrumb.setSectionIdentifier(((MapMetadata) md).getValueClassName());                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1535         } else {                                                                                         </span>
<span class="1919475910220989527" onmouseenter="enter('1919475910220989527');" onmouseout="out('1919475910220989527');" style="">1536             nextCrumb.setSectionIdentifier(((CollectionMetadata) md).getCollectionCeilingEntity());      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1537         }                                                                                                </span>
<span class="3745082800889494172" onmouseenter="enter('3745082800889494172');" onmouseout="out('3745082800889494172');" style="">1538         nextCrumb.setSectionId(collectionItemId);                                                        </span>
<span class="7047611651117816234" onmouseenter="enter('7047611651117816234');" onmouseout="out('7047611651117816234');" style="">1539         if (!sectionCrumbs.contains(nextCrumb)) {                                                        </span>
<span class="-6316688126111539901" onmouseenter="enter('-6316688126111539901');" onmouseout="out('-6316688126111539901');" style="">1540             sectionCrumbs.add(nextCrumb);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1541         }                                                                                                </span>
<span  style="">1542                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1543         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1543         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1544         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1544         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getReðŸ”µ</abbr></span>
<span  style="">1545                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1546         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span  style="">1547                                                                                                          </span>
<span class="4300500518149699432" onmouseenter="enter('4300500518149699432');" onmouseout="out('4300500518149699432');" style="">1548         if (md instanceof BasicCollectionMetadata &amp;&amp;                                                     </span>
<span class="3179311364823579995" onmouseenter="enter('3179311364823579995');" onmouseout="out('3179311364823579995');" style="">1549                 (((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST) ||      </span>
<span class="-5057368181444983975" onmouseenter="enter('-5057368181444983975');" onmouseout="out('-5057368181444983975');" style=""><abbr title="1550                         ((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST_EMPTY))) {">1550                         ((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST_EMðŸ”µ</abbr></span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1551             BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                  </span>
<span  style="">1552                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1553             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1553             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1554             if (entity == null) {                                                                        </span>
<span class="4597721164047448054" onmouseenter="enter('4597721164047448054');" onmouseout="out('4597721164047448054');" style=""><abbr title="1555                 entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResultSet().getRecords()[0];">1555                 entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1556             }                                                                                            </span>
<span  style="">1557                                                                                                          </span>
<span class="-7942197356638317765" onmouseenter="enter('-7942197356638317765');" onmouseout="out('-7942197356638317765');" style="">1558             String currentTabName = getCurrentTabName(pathVars, collectionMetadata);                     </span>
<span class="9017537031938626444" onmouseenter="enter('9017537031938626444');" onmouseout="out('9017537031938626444');" style=""><abbr title="1559             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetadata, entity, sectionCrumbs, currentTabName);">1559             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetaðŸ”µ</abbr></span>
<span  style="">1560                                                                                                          </span>
<span class="348957922752701667" onmouseenter="enter('348957922752701667');" onmouseout="out('348957922752701667');" style="">1561             entityForm = reinitializeEntityForm(entityForm, collectionMetadata, entity,                  </span>
<span class="-6666340752275266103" onmouseenter="enter('-6666340752275266103');" onmouseout="out('-6666340752275266103');" style="">1562                     subRecordsMap, sectionCrumbs);                                                       </span>
<span  style="">1563                                                                                                          </span>
<span class="-3892497188964586657" onmouseenter="enter('-3892497188964586657');" onmouseout="out('-3892497188964586657');" style="">1564             entityForm.removeAction(DefaultEntityFormActions.DELETE);                                    </span>
<span class="6748640999540281749" onmouseenter="enter('6748640999540281749');" onmouseout="out('6748640999540281749');" style="">1565             entityForm.removeAction(DefaultEntityFormActions.DUPLICATE);                                 </span>
<span  style="">1566                                                                                                          </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1567             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1568             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="2070483683171714322" onmouseenter="enter('2070483683171714322');" onmouseout="out('2070483683171714322');" style="">1569             model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleEditEntity&quot;);                                    </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1570         } else if (md instanceof AdornedTargetCollectionMetadata) {                                      </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1571             AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                  </span>
<span  style="">1572                                                                                                          </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1573             if (entity == null) {                                                                        </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style=""><abbr title="1574                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,">1574                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperðŸ”µ</abbr></span>
<span class="-2961516840614790290" onmouseenter="enter('-2961516840614790290');" onmouseout="out('-2961516840614790290');" style="">1575                     collectionItemId, sectionCrumbs, alternateId).getDynamicResultSet().getRecords()[0]; </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1576             }                                                                                            </span>
<span  style="">1577                                                                                                          </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1578             boolean populateTypeAndId = true;                                                            </span>
<span class="921756716374353809" onmouseenter="enter('921756716374353809');" onmouseout="out('921756716374353809');" style=""><abbr title="1579             boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaderType);">1579             boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1580             if (entityForm == null) {                                                                    </span>
<span class="-8902040329002931298" onmouseenter="enter('-8902040329002931298');" onmouseout="out('-8902040329002931298');" style=""><abbr title="1581                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, sectionCrumbs, false);">1581                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollecðŸ”µ</abbr></span>
<span class="-4655192855930300298" onmouseenter="enter('-4655192855930300298');" onmouseout="out('-4655192855930300298');" style="">1582                 entityForm.removeAction(DefaultAdornedEntityFormActions.Add);                            </span>
<span class="1109271490036416226" onmouseenter="enter('1109271490036416226');" onmouseout="out('1109271490036416226');" style="">1583                 entityForm.addAction(DefaultAdornedEntityFormActions.Save);                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1584             } else {                                                                                     </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1585                 entityForm.clearFieldsMap();                                                             </span>
<span class="2583214667713512490" onmouseenter="enter('2583214667713512490');" onmouseout="out('2583214667713512490');" style="">1586                 String entityType = entityForm.getEntityType();                                          </span>
<span class="-6584758178229470245" onmouseenter="enter('-6584758178229470245');" onmouseout="out('-6584758178229470245');" style=""><abbr title="1587                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entityForm, sectionCrumbs, false);">1587                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entðŸ”µ</abbr></span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style="">1588                 entityForm.setEntityType(entityType);                                                    </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1589                 populateTypeAndId = false;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1590             }                                                                                            </span>
<span  style="">1591                                                                                                          </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1592             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title="1593             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,">1593             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, maðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style="">1594                     collectionField,                                                                     </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style="">1595                     collectionItemId, responseMap);                                                      </span>
<span  style="">1596                                                                                                          </span>
<span class="-3972135447881278836" onmouseenter="enter('-3972135447881278836');" onmouseout="out('-3972135447881278836');" style=""><abbr title="1597             //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and Id is used.">1597             //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and ðŸ”µ</abbr></span>
<span class="-8007896595560301001" onmouseenter="enter('-8007896595560301001');" onmouseout="out('-8007896595560301001');" style=""><abbr title="1598             //It should be the entity and referenced Id of the adorned entity (not the target entity and Id).">1598             //It should be the entity and referenced Id of the adorned entity (not the target entity and ðŸ”µ</abbr></span>
<span class="316997016312344867" onmouseenter="enter('316997016312344867');" onmouseout="out('316997016312344867');" style="">1599             entityForm.setTranslationCeilingEntity(entityForm.getEntityType());                          </span>
<span class="-4512360180775881719" onmouseenter="enter('-4512360180775881719');" onmouseout="out('-4512360180775881719');" style="">1600             entityForm.setTranslationId(alternateId);                                                    </span>
<span  style="">1601                                                                                                          </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style="">1602             ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();  </span>
<span class="-1465905251928147670" onmouseenter="enter('-1465905251928147670');" onmouseout="out('-1465905251928147670');" style="">1603             for (String field : fmd.getMaintainedAdornedTargetFields()) {                                </span>
<span class="-2821179418575098708" onmouseenter="enter('-2821179418575098708');" onmouseout="out('-2821179418575098708');" style="">1604                 if (responseMap.containsKey(field) &amp;&amp; responseMap.containsKey(&quot;autoSubmit&quot;)) {           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1605                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1606                 }                                                                                        </span>
<span class="-3390991397790942785" onmouseenter="enter('-3390991397790942785');" onmouseout="out('-3390991397790942785');" style="">1607                 Property p = cmd.getPMap().get(field);                                                   </span>
<span class="3110636146594998978" onmouseenter="enter('3110636146594998978');" onmouseout="out('3110636146594998978');" style="">1608                 if (p != null &amp;&amp; p.getMetadata() instanceof AdornedTargetCollectionMetadata) {           </span>
<span class="-1526293730221303684" onmouseenter="enter('-1526293730221303684');" onmouseout="out('-1526293730221303684');" style=""><abbr title="1609                     // Because we&#x27;re dealing with a nested adorned target collection, this particular request must act">1609                     // Because we&#x27;re dealing with a nested adorned target collection, this particular reqðŸ”µ</abbr></span>
<span class="5008429970050276114" onmouseenter="enter('5008429970050276114');" onmouseout="out('5008429970050276114');" style=""><abbr title="1610                     // directly on the first adorned target collection. Because of this, we need the actual id property">1610                     // directly on the first adorned target collection. Because of this, we need the actuðŸ”µ</abbr></span>
<span class="-7713892716328274330" onmouseenter="enter('-7713892716328274330');" onmouseout="out('-7713892716328274330');" style=""><abbr title="1611                     // from the entity that models the adorned target relationship, and not the id of the target object.">1611                     // from the entity that models the adorned target relationship, and not the id of theðŸ”µ</abbr></span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1612                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1612                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style=""><abbr title="1613                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,">1613                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, nuðŸ”µ</abbr></span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1614                             alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();        </span>
<span  style="">1615                                                                                                          </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1616                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1616                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(ðŸ”µ</abbr></span>
<span class="-6504403122086949696" onmouseenter="enter('-6504403122086949696');" onmouseout="out('-6504403122086949696');" style="">1617                             ppr.getAdornedList().getAdornedTargetEntityClassname(), sectionCrumbs);      </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1618                     listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                        </span>
<span  style="">1619                                                                                                          </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1620                     if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {       </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1621                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1621                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1622                     } else {                                                                             </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1623                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1623                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1624                     }                                                                                    </span>
<span class="2712626054905490038" onmouseenter="enter('2712626054905490038');" onmouseout="out('2712626054905490038');" style="">1625                 } else if (p != null &amp;&amp; p.getMetadata() instanceof MapMetadata) {                        </span>
<span class="-388196981394792667" onmouseenter="enter('-388196981394792667');" onmouseout="out('-388196981394792667');" style="">1626                     // See above comment for AdornedTargetCollectionMetadata                             </span>
<span class="-9194902891343883685" onmouseenter="enter('-9194902891343883685');" onmouseout="out('-9194902891343883685');" style="">1627                     MapMetadata mmd = (MapMetadata) p.getMetadata();                                     </span>
<span  style="">1628                                                                                                          </span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1629                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1629                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style=""><abbr title="1630                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,">1630                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, nuðŸ”µ</abbr></span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1631                             alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();        </span>
<span  style="">1632                                                                                                          </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1633                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1633                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(ðŸ”µ</abbr></span>
<span class="-6515044965274807025" onmouseenter="enter('-6515044965274807025');" onmouseout="out('-6515044965274807025');" style="">1634                             mmd.getTargetClass(), sectionCrumbs);                                        </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1635                     listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                        </span>
<span  style="">1636                                                                                                          </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1637                     if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {       </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1638                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1638                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1639                     } else {                                                                             </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1640                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1640                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1641                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1642                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1643             }                                                                                            </span>
<span  style="">1644                                                                                                          </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style=""><abbr title="1645             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);">1645             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndIdðŸ”µ</abbr></span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1646             formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());       </span>
<span  style="">1647                                                                                                          </span>
<span class="7046829326366784672" onmouseenter="enter('7046829326366784672');" onmouseout="out('7046829326366784672');" style="">1648             boolean atLeastOneBasicField = false;                                                        </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1649             for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                       </span>
<span class="-3942382004211496115" onmouseenter="enter('-3942382004211496115');" onmouseout="out('-3942382004211496115');" style=""><abbr title="1650                 if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName()) &amp;&amp; !responseMap.containsKey(&quot;autoSubmit&quot;)) {">1650                 if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName(ðŸ”µ</abbr></span>
<span class="3115307772764059490" onmouseenter="enter('3115307772764059490');" onmouseout="out('3115307772764059490');" style="">1651                     atLeastOneBasicField = true;                                                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1652                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1653                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1654             }                                                                                            </span>
<span class="4813170790944841786" onmouseenter="enter('4813170790944841786');" onmouseout="out('4813170790944841786');" style="">1655             if (!atLeastOneBasicField) {                                                                 </span>
<span class="3364274495995556597" onmouseenter="enter('3364274495995556597');" onmouseout="out('3364274495995556597');" style="">1656                 entityForm.removeAction(DefaultEntityFormActions.SAVE);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1657             }                                                                                            </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1658             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1659             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="3009851293217081678" onmouseenter="enter('3009851293217081678');" onmouseout="out('3009851293217081678');" style="">1660             model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedEditEntity&quot;);                                   </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1661         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1662             MapMetadata fmd = (MapMetadata) md;                                                          </span>
<span  style="">1663                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1664             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1664             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1665             if (entity == null) {                                                                        </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style=""><abbr title="1666                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,">1666                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperðŸ”µ</abbr></span>
<span class="-2813813427236819301" onmouseenter="enter('-2813813427236819301');" onmouseout="out('-2813813427236819301');" style="">1667                     collectionItemId, sectionCrumbs, null).getEntity();                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1668             }                                                                                            </span>
<span  style="">1669                                                                                                          </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1670             boolean populateTypeAndId = true;                                                            </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1671             if (entityForm == null) {                                                                    </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style=""><abbr title="1672                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);">1672                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1673             } else {                                                                                     </span>
<span class="-2965751497501930249" onmouseenter="enter('-2965751497501930249');" onmouseout="out('-2965751497501930249');" style="">1674                 //save off the prior key before clearing out the fields map as it will not appear        </span>
<span class="-4459883460939835415" onmouseenter="enter('-4459883460939835415');" onmouseout="out('-4459883460939835415');" style="">1675                 //back on the saved entity                                                               </span>
<span class="-8617997777962995342" onmouseenter="enter('-8617997777962995342');" onmouseout="out('-8617997777962995342');" style="">1676                 String priorKey = entityForm.findField(&quot;priorKey&quot;).getValue();                           </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1677                 entityForm.clearFieldsMap();                                                             </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1678                 formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);</span>
<span class="-5674534809018144237" onmouseenter="enter('-5674534809018144237');" onmouseout="out('-5674534809018144237');" style="">1679                 entityForm.findField(&quot;priorKey&quot;).setValue(priorKey);                                     </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1680                 populateTypeAndId = false;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1681             }                                                                                            </span>
<span  style="">1682                                                                                                          </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style=""><abbr title="1683             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);">1683             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndIdðŸ”µ</abbr></span>
<span class="-7934209705949108459" onmouseenter="enter('-7934209705949108459');" onmouseout="out('-7934209705949108459');" style="">1684             formService.populateMapEntityFormFields(entityForm, entity);                                 </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1685             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1686             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="5184741693677662709" onmouseenter="enter('5184741693677662709');" onmouseout="out('5184741693677662709');" style="">1687             model.addAttribute(&quot;viewType&quot;, &quot;modal/mapEditEntity&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1688         }                                                                                                </span>
<span  style="">1689                                                                                                          </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1690         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="5715532112666019496" onmouseenter="enter('5715532112666019496');" onmouseout="out('5715532112666019496');" style="">1691         model.addAttribute(&quot;modalHeaderType&quot;, modalHeaderType);                                          </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1692         model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1693         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1694         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1695     }                                                                                                    </span>
<span  style="">1696                                                                                                          </span>
<span class="-6629135688250429856" onmouseenter="enter('-6629135688250429856');" onmouseout="out('-6629135688250429856');" style="">1697     protected EntityForm reinitializeEntityForm(final EntityForm entityForm,                             </span>
<span class="2488527282562212871" onmouseenter="enter('2488527282562212871');" onmouseout="out('2488527282562212871');" style="">1698             final ClassMetadata collectionMetadata,                                                      </span>
<span class="6244041270191906475" onmouseenter="enter('6244041270191906475');" onmouseout="out('6244041270191906475');" style="">1699             final Entity entity,                                                                         </span>
<span class="4210642227221008869" onmouseenter="enter('4210642227221008869');" onmouseout="out('4210642227221008869');" style="">1700             final Map&lt;String, DynamicResultSet&gt; subRecordsMap,                                           </span>
<span class="7695373887778905827" onmouseenter="enter('7695373887778905827');" onmouseout="out('7695373887778905827');" style="">1701             final List&lt;SectionCrumb&gt; sectionCrumbs) throws ServiceException {                            </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1702         if (entityForm == null) {                                                                        </span>
<span class="5007761642077021691" onmouseenter="enter('5007761642077021691');" onmouseout="out('5007761642077021691');" style="">1703             return formService                                                                           </span>
<span class="2427987523723463928" onmouseenter="enter('2427987523723463928');" onmouseout="out('2427987523723463928');" style="">1704                     .createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbs);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1705         }                                                                                                </span>
<span  style="">1706                                                                                                          </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1707         entityForm.clearFieldsMap();                                                                     </span>
<span class="524385531586817703" onmouseenter="enter('524385531586817703');" onmouseout="out('524385531586817703');" style="">1708         formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm,            </span>
<span class="2971672777452209099" onmouseenter="enter('2971672777452209099');" onmouseout="out('2971672777452209099');" style="">1709                 sectionCrumbs);                                                                          </span>
<span class="5496760487980360743" onmouseenter="enter('5496760487980360743');" onmouseout="out('5496760487980360743');" style="">1710         //remove all the actions since we&#x27;re not trying to redisplay them on the form                    </span>
<span class="-6469844840195102556" onmouseenter="enter('-6469844840195102556');" onmouseout="out('-6469844840195102556');" style="">1711         entityForm.removeAllActions();                                                                   </span>
<span  style="">1712                                                                                                          </span>
<span class="6548609876597156982" onmouseenter="enter('6548609876597156982');" onmouseout="out('6548609876597156982');" style="">1713         return entityForm;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1714     }                                                                                                    </span>
<span  style="">1715                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1716     /**                                                                                                  </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1717      * Updates the specified collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1718      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1719      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1720      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1721      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1722      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1723      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1724      * @param collectionField                                                                            </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1725      * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1725      * @param collectionItemId the collection primary key value (in the case of adorned target collectionðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1726      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1727      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1728      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1729      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1730      */                                                                                                  </span>
<span class="1690395709289479208" onmouseenter="enter('1690395709289479208');" onmouseout="out('1690395709289479208');" style="">1731     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.POST)</span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style=""><abbr title="1732     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1732     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1733             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1734             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1735             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1736             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1737             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                   </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1738             BindingResult result) throws Exception {                                                     </span>
<span class="454845068344591329" onmouseenter="enter('454845068344591329');" onmouseout="out('454845068344591329');" style=""><abbr title="1739         return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, entityForm, null, result);">1739         return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1740     }                                                                                                    </span>
<span  style="">1741                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1742     /**                                                                                                  </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1743      * Updates the specified collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1744      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1745      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1746      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1747      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1748      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1749      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1750      * @param collectionField                                                                            </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1751      * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1751      * @param collectionItemId the collection primary key value (in the case of adorned target collectionðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1752      * @param entityForm                                                                                 </span>
<span class="4031667150854181086" onmouseenter="enter('4031667150854181086');" onmouseout="out('4031667150854181086');" style=""><abbr title="1753      * @param alternateId in the case of adorned target collections, this is the primary key value of the collection member">1753      * @param alternateId in the case of adorned target collections, this is the primary key value of theðŸ”µ</abbr></span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1754      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1755      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1756      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1757      */                                                                                                  </span>
<span class="6716233350399381715" onmouseenter="enter('6716233350399381715');" onmouseout="out('6716233350399381715');" style=""><abbr title="1758     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.POST)">1758     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style=""><abbr title="1759     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1759     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1760             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1761             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1762             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1763             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1764             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                   </span>
<span class="-5366992345424767315" onmouseenter="enter('-5366992345424767315');" onmouseout="out('-5366992345424767315');" style="">1765             @PathVariable(value=&quot;alternateId&quot;) String alternateId,                                       </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1766             BindingResult result) throws Exception {                                                     </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1767         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1768         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1769         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1770         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1770         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1771         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1772                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1773         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1773         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1774         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1774         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1775                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1776         // First, we must save the collection entity                                                     </span>
<span class="3262117580653454816" onmouseenter="enter('3262117580653454816');" onmouseout="out('3262117580653454816');" style=""><abbr title="1777         PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, collectionItemId, alternateId, sectionCrumbs);">1777         PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1778         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1779         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1780                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1781         if (result.hasErrors()) {                                                                        </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1782             return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1782             return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemðŸ”µ</abbr></span>
<span class="-1009973048758571460" onmouseenter="enter('-1009973048758571460');" onmouseout="out('-1009973048758571460');" style="">1783                     ModalHeaderType.UPDATE_COLLECTION_ITEM.getType(), entityForm, savedEntity);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1784         }                                                                                                </span>
<span  style="">1785                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1786         // Next, we must get the new list grid that represents this collection                           </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1787         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1788         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1788         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span  style="">1789                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1790         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1791         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1792         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1793         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1794     }                                                                                                    </span>
<span  style="">1795                                                                                                          </span>
<span class="-2715204734461845190" onmouseenter="enter('-2715204734461845190');" onmouseout="out('-2715204734461845190');" style=""><abbr title="1796     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMethod.POST)">1796     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMetðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1797     public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,    </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1798             HttpServletResponse response, Model model,                                                   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1799             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1800             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1801             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1802             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="6458961487045284345" onmouseenter="enter('6458961487045284345');" onmouseout="out('6458961487045284345');" style="">1803             @RequestParam(value=&quot;newSequence&quot;) String newSequence) throws Exception {                    </span>
<span class="-6477101312884008952" onmouseenter="enter('-6477101312884008952');" onmouseout="out('-6477101312884008952');" style=""><abbr title="1804         return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collectionItemId, newSequence, null);">1804         return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1805     }                                                                                                    </span>
<span  style="">1806                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1807     /**                                                                                                  </span>
<span class="-7447609122613552365" onmouseenter="enter('-7447609122613552365');" onmouseout="out('-7447609122613552365');" style=""><abbr title="1808      * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target collections">1808      * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target colðŸ”µ</abbr></span>
<span class="5163972519999742424" onmouseenter="enter('5163972519999742424');" onmouseout="out('5163972519999742424');" style=""><abbr title="1809      * where a sort field is specified -- any other invocation is incorrect and will result in an exception.">1809      * where a sort field is specified -- any other invocation is incorrect and will result in an exceptiðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1810      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1811      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1812      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1813      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1814      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1815      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1816      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1817      * @param collectionItemId                                                                           </span>
<span class="8542418631474543845" onmouseenter="enter('8542418631474543845');" onmouseout="out('8542418631474543845');" style="">1818      * @return an object explaining the state of the operation                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1819      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1820      */                                                                                                  </span>
<span class="1279723180837283801" onmouseenter="enter('1279723180837283801');" onmouseout="out('1279723180837283801');" style=""><abbr title="1821     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, method = RequestMethod.POST)">1821     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, methoðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1822     public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,    </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1823             HttpServletResponse response, Model model,                                                   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1824             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1825             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1826             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1827             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="6744719432735700494" onmouseenter="enter('6744719432735700494');" onmouseout="out('6744719432735700494');" style="">1828             @RequestParam(value=&quot;newSequence&quot;) String newSequence,                                       </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1829             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1830         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1831         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1832         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1833         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1833         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1834         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1835         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style="">1836                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1837         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1837         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="6971869165316675737" onmouseenter="enter('6971869165316675737');" onmouseout="out('6971869165316675737');" style="">1838         ppr.addCustomCriteria(&quot;reorderParentEntityFetch&quot;);                                               </span>
<span  style="">1839                                                                                                          </span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1840         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1840         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getReðŸ”µ</abbr></span>
<span  style="">1841                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1842         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span  style="">1843                                                                                                          </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1844         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1845             AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                  </span>
<span class="-895931586936599512" onmouseenter="enter('-895931586936599512');" onmouseout="out('-895931586936599512');" style="">1846             AdornedTargetList atl = ppr.getAdornedList();                                                </span>
<span  style="">1847                                                                                                          </span>
<span class="4013888246220668443" onmouseenter="enter('4013888246220668443');" onmouseout="out('4013888246220668443');" style="">1848             // Get an entity form for the entity                                                         </span>
<span class="4144133685169635892" onmouseenter="enter('4144133685169635892');" onmouseout="out('4144133685169635892');" style=""><abbr title="1849             EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, false);">1849             EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, falseðŸ”µ</abbr></span>
<span class="985151044669117950" onmouseenter="enter('985151044669117950');" onmouseout="out('985151044669117950');" style=""><abbr title="1850             Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,">1850             Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProðŸ”µ</abbr></span>
<span class="-4422231398086337832" onmouseenter="enter('-4422231398086337832');" onmouseout="out('-4422231398086337832');" style=""><abbr title="1851                     collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;})">1851                     collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;}ðŸ”µ</abbr></span>
<span class="-7850695853310911802" onmouseenter="enter('-7850695853310911802');" onmouseout="out('-7850695853310911802');" style="">1852                     .getDynamicResultSet().getRecords()[0];                                              </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1853             formService.populateEntityFormFields(entityForm, entity);                                    </span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1854             formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());       </span>
<span  style="">1855                                                                                                          </span>
<span class="-3124065187694573478" onmouseenter="enter('-3124065187694573478');" onmouseout="out('-3124065187694573478');" style=""><abbr title="1856             // Set the new sequence (note that it will come in 0-indexed but the persistence module expects 1-indexed)">1856             // Set the new sequence (note that it will come in 0-indexed but the persistence module expecðŸ”µ</abbr></span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1857             int sequenceValue = Integer.parseInt(newSequence) + 1;                                       </span>
<span class="2556919505341751863" onmouseenter="enter('2556919505341751863');" onmouseout="out('2556919505341751863');" style="">1858             Field field = entityForm.findField(atl.getSortField());                                      </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1859             field.setValue(String.valueOf(sequenceValue));                                               </span>
<span  style="">1860                                                                                                          </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1861             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="-5669538829732150992" onmouseenter="enter('-5669538829732150992');" onmouseout="out('-5669538829732150992');" style=""><abbr title="1862             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, alternateId, sectionCrumbs);">1862             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMðŸ”µ</abbr></span>
<span class="-6209319883391535282" onmouseenter="enter('-6209319883391535282');" onmouseout="out('-6209319883391535282');" style="">1863             Property displayOrder = persistenceResponse.getEntity().findProperty(atl.getSortField());    </span>
<span  style="">1864                                                                                                          </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1865             responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                             </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1866             responseMap.put(&quot;field&quot;, collectionField);                                                   </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1867             responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());   </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1868             return responseMap;                                                                          </span>
<span class="-3117865694677500361" onmouseenter="enter('-3117865694677500361');" onmouseout="out('-3117865694677500361');" style="">1869         } else if (md instanceof BasicCollectionMetadata) {                                              </span>
<span class="-8492572584837651214" onmouseenter="enter('-8492572584837651214');" onmouseout="out('-8492572584837651214');" style="">1870             BasicCollectionMetadata cd = (BasicCollectionMetadata) md;                                   </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1871             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="-2546552603594507996" onmouseenter="enter('-2546552603594507996');" onmouseout="out('-2546552603594507996');" style=""><abbr title="1872             Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1872             Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResulðŸ”µ</abbr></span>
<span  style="">1873                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1874             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1874             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="-2818097934143266938" onmouseenter="enter('-2818097934143266938');" onmouseout="out('-2818097934143266938');" style="">1875             EntityForm entityForm = formService.createEntityForm(collectionMetadata, sectionCrumbs);     </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1876             if (!StringUtils.isEmpty(cd.getSortProperty())) {                                            </span>
<span class="-6303462610985739492" onmouseenter="enter('-6303462610985739492');" onmouseout="out('-6303462610985739492');" style="">1877                 Field f = new Field()                                                                    </span>
<span class="-2538063021289876061" onmouseenter="enter('-2538063021289876061');" onmouseout="out('-2538063021289876061');" style="">1878                         .withName(cd.getSortProperty())                                                  </span>
<span class="-2458072313875538806" onmouseenter="enter('-2458072313875538806');" onmouseout="out('-2458072313875538806');" style="">1879                         .withFieldType(SupportedFieldType.HIDDEN.toString());                            </span>
<span class="5054103958554301667" onmouseenter="enter('5054103958554301667');" onmouseout="out('5054103958554301667');" style="">1880                 entityForm.addHiddenField(mainMetadata, f);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1881             }                                                                                            </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1882             formService.populateEntityFormFields(entityForm, entity);                                    </span>
<span  style="">1883                                                                                                          </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1884             if (!StringUtils.isEmpty(cd.getSortProperty())) {                                            </span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1885                 int sequenceValue = Integer.parseInt(newSequence) + 1;                                   </span>
<span class="-3733495482183042291" onmouseenter="enter('-3733495482183042291');" onmouseout="out('-3733495482183042291');" style="">1886                 Field field = entityForm.findField(cd.getSortProperty());                                </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1887                 field.setValue(String.valueOf(sequenceValue));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1888             }                                                                                            </span>
<span  style="">1889                                                                                                          </span>
<span class="3923458830762383909" onmouseenter="enter('3923458830762383909');" onmouseout="out('3923458830762383909');" style=""><abbr title="1890             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, sectionCrumbs);">1890             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMðŸ”µ</abbr></span>
<span class="-792608105002716351" onmouseenter="enter('-792608105002716351');" onmouseout="out('-792608105002716351');" style="">1891             Property displayOrder = persistenceResponse.getEntity().findProperty(cd.getSortProperty());  </span>
<span  style="">1892                                                                                                          </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1893             responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                             </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1894             responseMap.put(&quot;field&quot;, collectionField);                                                   </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1895             responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());   </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1896             return responseMap;                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1897         } else {                                                                                         </span>
<span class="7542199431919878786" onmouseenter="enter('7542199431919878786');" onmouseout="out('7542199431919878786');" style=""><abbr title="1898             throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collection fields.&quot;);">1898             throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1899         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1900     }                                                                                                    </span>
<span  style="">1901                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1902     /**                                                                                                  </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1903      * Removes the requested collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1904      *                                                                                                   </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1905      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1905      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collectionðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1906      * map collection.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1907      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1908      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1909      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1910      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1911      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1912      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1913      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1914      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1915      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1916      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1917      */                                                                                                  </span>
<span class="6340503715634976611" onmouseenter="enter('6340503715634976611');" onmouseout="out('6340503715634976611');" style=""><abbr title="1918     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethod.POST)">1918     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethoðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style=""><abbr title="1919     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1919     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1920             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1921             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1922             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1923             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="6845453766150325497" onmouseenter="enter('6845453766150325497');" onmouseout="out('6845453766150325497');" style=""><abbr title="1924         return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, null);">1924         return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1925     }                                                                                                    </span>
<span  style="">1926                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1927     /**                                                                                                  </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1928      * Removes the requested collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1929      *                                                                                                   </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1930      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1930      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collectionðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1931      * map collection.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1932      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1933      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1934      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1935      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1936      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1937      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1938      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1939      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1940      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1941      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1942      */                                                                                                  </span>
<span class="-4053134536146029119" onmouseenter="enter('-4053134536146029119');" onmouseout="out('-4053134536146029119');" style=""><abbr title="1943     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method = RequestMethod.POST)">1943     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method ðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style=""><abbr title="1944     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1944     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1945             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1946             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1947             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1948             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1949             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1950         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1951         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1952         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1953         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1953         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1954         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1955                                                                                                          </span>
<span class="-6408221600487262974" onmouseenter="enter('-6408221600487262974');" onmouseout="out('-6408221600487262974');" style="">1956         String priorKey = request.getParameter(&quot;key&quot;);                                                   </span>
<span  style="">1957                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1958         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1958         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1959         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1960         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1960         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1961                                                                                                          </span>
<span class="8107528363762278945" onmouseenter="enter('8107528363762278945');" onmouseout="out('8107528363762278945');" style="">1962         // First, we must remove the collection entity                                                   </span>
<span class="-8185015406879465962" onmouseenter="enter('-8185015406879465962');" onmouseout="out('-8185015406879465962');" style=""><abbr title="1963         PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectionProperty, entity, collectionItemId, alternateId, priorKey, sectionCrumbs);">1963         PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectðŸ”µ</abbr></span>
<span class="4740780245520344929" onmouseenter="enter('4740780245520344929');" onmouseout="out('4740780245520344929');" style=""><abbr title="1964         if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailure()) {">1964         if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailurðŸ”µ</abbr></span>
<span class="-1907173364280213129" onmouseenter="enter('-1907173364280213129');" onmouseout="out('-1907173364280213129');" style="">1965             String error = &quot;There was an error removing the whatever&quot;;                                   </span>
<span class="6694909055776458558" onmouseenter="enter('6694909055776458558');" onmouseout="out('6694909055776458558');" style="">1966             if (MapUtils.isNotEmpty(persistenceResponse.getEntity().getPropertyValidationErrors())) {    </span>
<span class="2653002805011151778" onmouseenter="enter('2653002805011151778');" onmouseout="out('2653002805011151778');" style="">1967                 // If we failed, we&#x27;ll return some JSON with the first error                             </span>
<span class="6101527636004026445" onmouseenter="enter('6101527636004026445');" onmouseout="out('6101527636004026445');" style=""><abbr title="1968                 error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator().next().get(0);">1968                 error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator()ðŸ”µ</abbr></span>
<span class="3589903040125146199" onmouseenter="enter('3589903040125146199');" onmouseout="out('3589903040125146199');" style=""><abbr title="1969             } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErrors())) {">1969             } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErroðŸ”µ</abbr></span>
<span class="-8002349788440125315" onmouseenter="enter('-8002349788440125315');" onmouseout="out('-8002349788440125315');" style="">1970                 error = persistenceResponse.getEntity().getGlobalValidationErrors().get(0);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1971             }                                                                                            </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1972             return new JsonResponse(response)                                                            </span>
<span class="4764127484129551096" onmouseenter="enter('4764127484129551096');" onmouseout="out('4764127484129551096');" style="">1973                 .with(&quot;status&quot;, &quot;error&quot;)                                                                 </span>
<span class="-4778619806303294332" onmouseenter="enter('-4778619806303294332');" onmouseout="out('-4778619806303294332');" style="">1974                 .with(&quot;message&quot;, BLCMessageUtils.getMessage(error))                                      </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1975                 .done();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1976         }                                                                                                </span>
<span  style="">1977                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1978         // Next, we must get the new list grid that represents this collection                           </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1979         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1980         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1980         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span  style="">1981                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1982         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1983         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1984         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1985         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1986     }                                                                                                    </span>
<span  style="">1987                                                                                                          </span>
<span class="-1722269672251008380" onmouseenter="enter('-1722269672251008380');" onmouseout="out('-1722269672251008380');" style="">1988     public void addAuditableDisplayFields(EntityForm entityForm) {                                       </span>
<span class="2220665039639111541" onmouseenter="enter('2220665039639111541');" onmouseout="out('2220665039639111541');" style="">1989         Field createdBy = entityForm.findField(&quot;auditable.createdBy&quot;);                                   </span>
<span class="-1310269621989930827" onmouseenter="enter('-1310269621989930827');" onmouseout="out('-1310269621989930827');" style="">1990         if (createdBy != null &amp;&amp; createdBy.getValue() != null) {                                         </span>
<span class="3065344382927201496" onmouseenter="enter('3065344382927201496');" onmouseout="out('3065344382927201496');" style="">1991             addAuditableDisplayField(entityForm, createdBy);                                             </span>
<span  style="">1992                                                                                                          </span>
<span class="-8232178899610643805" onmouseenter="enter('-8232178899610643805');" onmouseout="out('-8232178899610643805');" style="">1993             createdBy.setIsVisible(false);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1994         }                                                                                                </span>
<span class="1393544913931451876" onmouseenter="enter('1393544913931451876');" onmouseout="out('1393544913931451876');" style="">1995         Field updatedBy = entityForm.findField(&quot;auditable.updatedBy&quot;);                                   </span>
<span class="362865388069983596" onmouseenter="enter('362865388069983596');" onmouseout="out('362865388069983596');" style="">1996         if (updatedBy != null &amp;&amp; updatedBy.getValue() != null) {                                         </span>
<span class="-892302887107162271" onmouseenter="enter('-892302887107162271');" onmouseout="out('-892302887107162271');" style="">1997             addAuditableDisplayField(entityForm, updatedBy);                                             </span>
<span  style="">1998                                                                                                          </span>
<span class="6398063041947851488" onmouseenter="enter('6398063041947851488');" onmouseout="out('6398063041947851488');" style="">1999             updatedBy.setIsVisible(false);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2000         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2001     }                                                                                                    </span>
<span  style="">2002                                                                                                          </span>
<span class="4984267825623541739" onmouseenter="enter('4984267825623541739');" onmouseout="out('4984267825623541739');" style="">2003     private void addAuditableDisplayField(EntityForm entityForm, Field userField) {                      </span>
<span class="-4635466229336929139" onmouseenter="enter('-4635466229336929139');" onmouseout="out('-4635466229336929139');" style="">2004         Field displayField = buildAuditableDisplayField(userField);                                      </span>
<span  style="">2005                                                                                                          </span>
<span class="-3510960703864117903" onmouseenter="enter('-3510960703864117903');" onmouseout="out('-3510960703864117903');" style="">2006         AdminUser user = adminUserDao.readAdminUserById(Long.parseLong(userField.getValue()));           </span>
<span class="-2749914300638269457" onmouseenter="enter('-2749914300638269457');" onmouseout="out('-2749914300638269457');" style="">2007         String userName = user == null ? null : user.getName();                                          </span>
<span class="-519467923242361473" onmouseenter="enter('-519467923242361473');" onmouseout="out('-519467923242361473');" style="">2008         displayField.setValue(userName);                                                                 </span>
<span  style="">2009                                                                                                          </span>
<span class="2796866146572271884" onmouseenter="enter('2796866146572271884');" onmouseout="out('2796866146572271884');" style="">2010         FieldGroup auditGroup = entityForm.findGroup(&quot;AdminAuditable_Audit&quot;);                            </span>
<span class="442119087406556402" onmouseenter="enter('442119087406556402');" onmouseout="out('442119087406556402');" style="">2011         if (auditGroup != null) {                                                                        </span>
<span class="2790071812155889083" onmouseenter="enter('2790071812155889083');" onmouseout="out('2790071812155889083');" style="">2012             auditGroup.addField(displayField);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2013         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2014     }                                                                                                    </span>
<span  style="">2015                                                                                                          </span>
<span class="-898012728924165157" onmouseenter="enter('-898012728924165157');" onmouseout="out('-898012728924165157');" style="">2016     private Field buildAuditableDisplayField(Field auditableField) {                                     </span>
<span class="7586031541837577475" onmouseenter="enter('7586031541837577475');" onmouseout="out('7586031541837577475');" style="">2017         return new Field().withFieldType(SupportedFieldType.STRING.toString())                           </span>
<span class="-5983163062967947616" onmouseenter="enter('-5983163062967947616');" onmouseout="out('-5983163062967947616');" style="">2018                 .withName(auditableField.getName() + &quot;Display&quot;)                                          </span>
<span class="-3810520855500417343" onmouseenter="enter('-3810520855500417343');" onmouseout="out('-3810520855500417343');" style="">2019                 .withFriendlyName(auditableField.getFriendlyName())                                      </span>
<span class="-2087540063707551713" onmouseenter="enter('-2087540063707551713');" onmouseout="out('-2087540063707551713');" style="">2020                 .withOrder(auditableField.getOrder())                                                    </span>
<span class="3252055162848788175" onmouseenter="enter('3252055162848788175');" onmouseout="out('3252055162848788175');" style="">2021                 .withOwningEntityClass(auditableField.getOwningEntityClass())                            </span>
<span class="8052491048417023702" onmouseenter="enter('8052491048417023702');" onmouseout="out('8052491048417023702');" style="">2022                 .withReadOnly(true);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2023     }                                                                                                    </span>
<span  style="">2024                                                                                                          </span>
<span class="2512746595428590302" onmouseenter="enter('2512746595428590302');" onmouseout="out('2512746595428590302');" style="">2025     protected String getCurrentTabName(Map&lt;String, String&gt; pathVars, ClassMetadata cmd) {                </span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style="">2026         String tabName = pathVars.get(&quot;tabName&quot;);                                                        </span>
<span class="620358619967646231" onmouseenter="enter('620358619967646231');" onmouseout="out('620358619967646231');" style="">2027         if (StringUtils.isBlank(tabName)) {                                                              </span>
<span class="-8386812650765964886" onmouseenter="enter('-8386812650765964886');" onmouseout="out('-8386812650765964886');" style="">2028             TabMetadata firstTab = cmd.getFirstTab();                                                    </span>
<span class="5997097813726693180" onmouseenter="enter('5997097813726693180');" onmouseout="out('5997097813726693180');" style="">2029             return firstTab != null ? firstTab.getTabName() : &quot;General&quot;;                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2030         }                                                                                                </span>
<span class="-6789109484485831180" onmouseenter="enter('-6789109484485831180');" onmouseout="out('-6789109484485831180');" style="">2031         return tabName;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2032     }                                                                                                    </span>
<span  style="">2033                                                                                                          </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">2034     // *****************************************                                                         </span>
<span class="2492884656402841956" onmouseenter="enter('2492884656402841956');" onmouseout="out('2492884656402841956');" style="">2035     // Typed Entity Helper Methods                                                                       </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">2036     // *****************************************                                                         </span>
<span  style="">2037                                                                                                          </span>
<span class="709722161552159597" onmouseenter="enter('709722161552159597');" onmouseout="out('709722161552159597');" style="">2038     protected void setTypedEntityModelAttributes(HttpServletRequest request, Model model) {              </span>
<span class="2572860224956804545" onmouseenter="enter('2572860224956804545');" onmouseout="out('2572860224956804545');" style="">2039         // Check if this is a typed entity                                                               </span>
<span class="-601784761218487618" onmouseenter="enter('-601784761218487618');" onmouseout="out('-601784761218487618');" style="">2040         AdminSection typedEntitySection = (AdminSection) request.getAttribute(&quot;typedEntitySection&quot;);     </span>
<span class="2356861889771822774" onmouseenter="enter('2356861889771822774');" onmouseout="out('2356861889771822774');" style="">2041         if (typedEntitySection != null) {                                                                </span>
<span class="-7054855399164801351" onmouseenter="enter('-7054855399164801351');" onmouseout="out('-7054855399164801351');" style="">2042             // Update the friendly name for this Entity Type                                             </span>
<span class="-8436584596314077038" onmouseenter="enter('-8436584596314077038');" onmouseout="out('-8436584596314077038');" style="">2043             model.addAttribute(&quot;entityFriendlyName&quot;, typedEntitySection.getName());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2044         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2045     }                                                                                                    </span>
<span  style="">2046                                                                                                          </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">2047     // *********************************                                                                 </span>
<span class="5570644305110686760" onmouseenter="enter('5570644305110686760');" onmouseout="out('5570644305110686760');" style="">2048     // ADDITIONAL SPRING-BOUND METHODS *                                                                 </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">2049     // *********************************                                                                 </span>
<span  style="">2050                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">2051     /**                                                                                                  </span>
<span class="-6771709729688841784" onmouseenter="enter('-6771709729688841784');" onmouseout="out('-6771709729688841784');" style=""><abbr title="2052      * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding process.">2052      * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding ðŸ”µ</abbr></span>
<span class="2498077318751920180" onmouseenter="enter('2498077318751920180');" onmouseout="out('2498077318751920180');" style=""><abbr title="2053      * By default, we register a binder that treats empty Strings as null and a Boolean editor that supports either true">2053      * By default, we register a binder that treats empty Strings as null and a Boolean editor that suppoðŸ”µ</abbr></span>
<span class="4465303089468973962" onmouseenter="enter('4465303089468973962');" onmouseout="out('4465303089468973962');" style="">2054      * or false. If the value is passed in as null, it will treat it as false.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">2055      *                                                                                                   </span>
<span class="-3898462538136412996" onmouseenter="enter('-3898462538136412996');" onmouseout="out('-3898462538136412996');" style="">2056      * @param binder                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">2057      */                                                                                                  </span>
<span class="2978104519843175555" onmouseenter="enter('2978104519843175555');" onmouseout="out('2978104519843175555');" style="">2058     @InitBinder                                                                                          </span>
<span class="4179572271848089300" onmouseenter="enter('4179572271848089300');" onmouseout="out('4179572271848089300');" style="">2059     public void initBinder(WebDataBinder binder) {                                                       </span>
<span class="3888201586857511470" onmouseenter="enter('3888201586857511470');" onmouseout="out('3888201586857511470');" style="">2060         binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));                        </span>
<span class="-4458929942740752488" onmouseenter="enter('-4458929942740752488');" onmouseout="out('-4458929942740752488');" style="">2061         binder.registerCustomEditor(Boolean.class, new NonNullBooleanEditor());                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2062     }                                                                                                    </span>
<span  style="">2063                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2064 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="913821711322743166" onmouseenter="enter('913821711322743166');" onmouseout="out('913821711322743166');" style="">  18 package org.broadleafcommerce.openadmin.web.controller.entity;                                           </span>
<span  style="">  19                                                                                                          </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  20 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  21 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="3542918789910249764" onmouseenter="enter('3542918789910249764');" onmouseout="out('3542918789910249764');" style="">  25 import org.broadleafcommerce.common.exception.SecurityServiceException;                                  </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  26 import org.broadleafcommerce.common.exception.ServiceException;                                          </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  27 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  28 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-3349026188166660873" onmouseenter="enter('-3349026188166660873');" onmouseout="out('-3349026188166660873');" style="">  29 import org.broadleafcommerce.common.persistence.EntityDuplicator;                                        </span>
<span class="-6648433550510659033" onmouseenter="enter('-6648433550510659033');" onmouseout="out('-6648433550510659033');" style="">  30 import org.broadleafcommerce.common.presentation.client.AddMethodType;                                   </span>
<span class="1362364260528215152" onmouseenter="enter('1362364260528215152');" onmouseout="out('1362364260528215152');" style="">  31 import org.broadleafcommerce.common.presentation.client.SupportedFieldType;                              </span>
<span class="-2818686525334833130" onmouseenter="enter('-2818686525334833130');" onmouseout="out('-2818686525334833130');" style="">  32 import org.broadleafcommerce.common.sandbox.SandBoxHelper;                                               </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  33 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="2429458746821399950" onmouseenter="enter('2429458746821399950');" onmouseout="out('2429458746821399950');" style="">  34 import org.broadleafcommerce.common.util.BLCArrayUtils;                                                  </span>
<span class="2428099238642943960" onmouseenter="enter('2428099238642943960');" onmouseout="out('2428099238642943960');" style="">  35 import org.broadleafcommerce.common.util.BLCMessageUtils;                                                </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  36 import org.broadleafcommerce.common.web.BroadleafRequestContext;                                         </span>
<span class="-1418036767363331062" onmouseenter="enter('-1418036767363331062');" onmouseout="out('-1418036767363331062');" style="">  37 import org.broadleafcommerce.common.web.JsonResponse;                                                    </span>
<span class="-3361215363157046739" onmouseenter="enter('-3361215363157046739');" onmouseout="out('-3361215363157046739');" style="">  38 import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;                              </span>
<span class="-1781055592725563383" onmouseenter="enter('-1781055592725563383');" onmouseout="out('-1781055592725563383');" style="">  39 import org.broadleafcommerce.openadmin.dto.AdornedTargetList;                                            </span>
<span class="-6140296335181984013" onmouseenter="enter('-6140296335181984013');" onmouseout="out('-6140296335181984013');" style="">  40 import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;                                      </span>
<span class="4427537537958608766" onmouseenter="enter('4427537537958608766');" onmouseout="out('4427537537958608766');" style="">  41 import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;                                           </span>
<span class="-1607559599739253077" onmouseenter="enter('-1607559599739253077');" onmouseout="out('-1607559599739253077');" style="">  42 import org.broadleafcommerce.openadmin.dto.ClassMetadata;                                                </span>
<span class="5550564421881377532" onmouseenter="enter('5550564421881377532');" onmouseout="out('5550564421881377532');" style="">  43 import org.broadleafcommerce.openadmin.dto.ClassTree;                                                    </span>
<span class="-3165611006566133086" onmouseenter="enter('-3165611006566133086');" onmouseout="out('-3165611006566133086');" style="">  44 import org.broadleafcommerce.openadmin.dto.CollectionMetadata;                                           </span>
<span class="-4742435063138209714" onmouseenter="enter('-4742435063138209714');" onmouseout="out('-4742435063138209714');" style="">  45 import org.broadleafcommerce.openadmin.dto.DynamicResultSet;                                             </span>
<span class="-5093421835888664541" onmouseenter="enter('-5093421835888664541');" onmouseout="out('-5093421835888664541');" style="">  46 import org.broadleafcommerce.openadmin.dto.Entity;                                                       </span>
<span class="-8829499667991596741" onmouseenter="enter('-8829499667991596741');" onmouseout="out('-8829499667991596741');" style="">  47 import org.broadleafcommerce.openadmin.dto.FieldMetadata;                                                </span>
<span class="6369021917986026789" onmouseenter="enter('6369021917986026789');" onmouseout="out('6369021917986026789');" style="">  48 import org.broadleafcommerce.openadmin.dto.FilterAndSortCriteria;                                        </span>
<span class="826821438795056004" onmouseenter="enter('826821438795056004');" onmouseout="out('826821438795056004');" style="">  49 import org.broadleafcommerce.openadmin.dto.MapMetadata;                                                  </span>
<span class="1983554291461039357" onmouseenter="enter('1983554291461039357');" onmouseout="out('1983554291461039357');" style="">  50 import org.broadleafcommerce.openadmin.dto.Property;                                                     </span>
<span class="1696571253156436279" onmouseenter="enter('1696571253156436279');" onmouseout="out('1696571253156436279');" style="">  51 import org.broadleafcommerce.openadmin.dto.SectionCrumb;                                                 </span>
<span class="5662236005419086618" onmouseenter="enter('5662236005419086618');" onmouseout="out('5662236005419086618');" style="">  52 import org.broadleafcommerce.openadmin.dto.TabMetadata;                                                  </span>
<span class="-8828889589519173652" onmouseenter="enter('-8828889589519173652');" onmouseout="out('-8828889589519173652');" style="">  53 import org.broadleafcommerce.openadmin.server.dao.DynamicEntityDao;                                      </span>
<span class="4410643013278245372" onmouseenter="enter('4410643013278245372');" onmouseout="out('4410643013278245372');" style="">  54 import org.broadleafcommerce.openadmin.server.domain.PersistencePackageRequest;                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  55 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-7620175268967942501" onmouseenter="enter('-7620175268967942501');" onmouseout="out('-7620175268967942501');" style="">  56 import org.broadleafcommerce.openadmin.server.security.domain.AdminSection;                              </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  57 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-4641149340176766185" onmouseenter="enter('-4641149340176766185');" onmouseout="out('-4641149340176766185');" style="">  58 import org.broadleafcommerce.openadmin.server.security.remote.EntityOperationType;                       </span>
<span class="78786346091609662" onmouseenter="enter('78786346091609662');" onmouseout="out('78786346091609662');" style="">  59 import org.broadleafcommerce.openadmin.server.security.service.RowLevelSecurityService;                  </span>
<span class="-8603256547657551769" onmouseenter="enter('-8603256547657551769');" onmouseout="out('-8603256547657551769');" style="">  60 import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;                   </span>
<span class="5585583973934060515" onmouseenter="enter('5585583973934060515');" onmouseout="out('5585583973934060515');" style=""><abbr title="  61 import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExtensionManager;">  61 import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExteðŸ”µ</abbr></span>
<span class="-3086540061138981164" onmouseenter="enter('-3086540061138981164');" onmouseout="out('-3086540061138981164');" style="">  62 import org.broadleafcommerce.openadmin.server.service.persistence.module.BasicPersistenceModule;         </span>
<span class="9131075895472939574" onmouseenter="enter('9131075895472939574');" onmouseout="out('9131075895472939574');" style="">  63 import org.broadleafcommerce.openadmin.web.controller.AdminAbstractController;                           </span>
<span class="7254479112554025637" onmouseenter="enter('7254479112554025637');" onmouseout="out('7254479112554025637');" style="">  64 import org.broadleafcommerce.openadmin.web.controller.modal.ModalHeaderType;                             </span>
<span class="4507704609742395614" onmouseenter="enter('4507704609742395614');" onmouseout="out('4507704609742395614');" style="">  65 import org.broadleafcommerce.openadmin.web.editor.NonNullBooleanEditor;                                  </span>
<span class="-2042519459673859584" onmouseenter="enter('-2042519459673859584');" onmouseout="out('-2042519459673859584');" style="">  66 import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;                        </span>
<span class="3056790491614608405" onmouseenter="enter('3056790491614608405');" onmouseout="out('3056790491614608405');" style="">  67 import org.broadleafcommerce.openadmin.web.form.component.ListGrid;                                      </span>
<span class="1405974373227613661" onmouseenter="enter('1405974373227613661');" onmouseout="out('1405974373227613661');" style="">  68 import org.broadleafcommerce.openadmin.web.form.entity.DefaultAdornedEntityFormActions;                  </span>
<span class="2718350422838759693" onmouseenter="enter('2718350422838759693');" onmouseout="out('2718350422838759693');" style="">  69 import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;                         </span>
<span class="-3560862041655103076" onmouseenter="enter('-3560862041655103076');" onmouseout="out('-3560862041655103076');" style="">  70 import org.broadleafcommerce.openadmin.web.form.entity.DefaultMainActions;                               </span>
<span class="8035715143965725316" onmouseenter="enter('8035715143965725316');" onmouseout="out('8035715143965725316');" style="">  71 import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;                                       </span>
<span class="-3164920911156953697" onmouseenter="enter('-3164920911156953697');" onmouseout="out('-3164920911156953697');" style="">  72 import org.broadleafcommerce.openadmin.web.form.entity.EntityFormAction;                                 </span>
<span class="6015559832933397076" onmouseenter="enter('6015559832933397076');" onmouseout="out('6015559832933397076');" style="">  73 import org.broadleafcommerce.openadmin.web.form.entity.Field;                                            </span>
<span class="-5634654756625156689" onmouseenter="enter('-5634654756625156689');" onmouseout="out('-5634654756625156689');" style="">  74 import org.broadleafcommerce.openadmin.web.form.entity.FieldGroup;                                       </span>
<span class="8763280003660953520" onmouseenter="enter('8763280003660953520');" onmouseout="out('8763280003660953520');" style="">  75 import org.springframework.beans.propertyeditors.StringTrimmerEditor;                                    </span>
<span class="4128309806836178094" onmouseenter="enter('4128309806836178094');" onmouseout="out('4128309806836178094');" style="">  76 import org.springframework.stereotype.Controller;                                                        </span>
<span class="2230089600625206822" onmouseenter="enter('2230089600625206822');" onmouseout="out('2230089600625206822');" style="">  77 import org.springframework.ui.Model;                                                                     </span>
<span class="-8661390401087732702" onmouseenter="enter('-8661390401087732702');" onmouseout="out('-8661390401087732702');" style="">  78 import org.springframework.util.MultiValueMap;                                                           </span>
<span class="-5446610002806720528" onmouseenter="enter('-5446610002806720528');" onmouseout="out('-5446610002806720528');" style="">  79 import org.springframework.validation.BindingResult;                                                     </span>
<span class="-5956639343389312225" onmouseenter="enter('-5956639343389312225');" onmouseout="out('-5956639343389312225');" style="">  80 import org.springframework.web.bind.WebDataBinder;                                                       </span>
<span class="6486986322776186621" onmouseenter="enter('6486986322776186621');" onmouseout="out('6486986322776186621');" style="">  81 import org.springframework.web.bind.annotation.InitBinder;                                               </span>
<span class="2718246165073723950" onmouseenter="enter('2718246165073723950');" onmouseout="out('2718246165073723950');" style="">  82 import org.springframework.web.bind.annotation.ModelAttribute;                                           </span>
<span class="3963501418927616634" onmouseenter="enter('3963501418927616634');" onmouseout="out('3963501418927616634');" style="">  83 import org.springframework.web.bind.annotation.PathVariable;                                             </span>
<span class="-7989471178862524182" onmouseenter="enter('-7989471178862524182');" onmouseout="out('-7989471178862524182');" style="">  84 import org.springframework.web.bind.annotation.RequestMapping;                                           </span>
<span class="4584846860636268493" onmouseenter="enter('4584846860636268493');" onmouseout="out('4584846860636268493');" style="">  85 import org.springframework.web.bind.annotation.RequestMethod;                                            </span>
<span class="-8913037601281016619" onmouseenter="enter('-8913037601281016619');" onmouseout="out('-8913037601281016619');" style="">  86 import org.springframework.web.bind.annotation.RequestParam;                                             </span>
<span class="-7662224364501075428" onmouseenter="enter('-7662224364501075428');" onmouseout="out('-7662224364501075428');" style="">  87 import org.springframework.web.bind.annotation.ResponseBody;                                             </span>
<span class="82864906475118767" onmouseenter="enter('82864906475118767');" onmouseout="out('82864906475118767');" style="">  88 import org.springframework.web.servlet.DispatcherServlet;                                                </span>
<span class="4665273347041581179" onmouseenter="enter('4665273347041581179');" onmouseout="out('4665273347041581179');" style="">  89 import org.springframework.web.servlet.FlashMap;                                                         </span>
<span class="4289605998216587359" onmouseenter="enter('4289605998216587359');" onmouseout="out('4289605998216587359');" style="">  90 import org.springframework.web.servlet.mvc.support.RedirectAttributes;                                   </span>
<span class="2383374134797300138" onmouseenter="enter('2383374134797300138');" onmouseout="out('2383374134797300138');" style="">  91 import org.springframework.web.util.UrlPathHelper;                                                       </span>
<span  style="">  92                                                                                                          </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="">  93 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span  style="">  94                                                                                                          </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  95 import java.io.Serializable;                                                                             </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  96 import java.io.UnsupportedEncodingException;                                                             </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="">  97 import java.net.URLDecoder;                                                                              </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  98 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  99 import java.util.Arrays;                                                                                 </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style=""> 100 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style=""> 101 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style=""> 102 import java.util.Map;                                                                                    </span>
<span class="2393042000349901971" onmouseenter="enter('2393042000349901971');" onmouseout="out('2393042000349901971');" style=""> 103 import java.util.Map.Entry;                                                                              </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style=""> 104 import java.util.Set;                                                                                    </span>
<span class="5924803009700709999" onmouseenter="enter('5924803009700709999');" onmouseout="out('5924803009700709999');" style=""> 105 import java.util.stream.Stream;                                                                          </span>
<span  style=""> 106                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style=""> 107 import javax.annotation.Resource;                                                                        </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style=""> 108 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="-2247759832438184775" onmouseenter="enter('-2247759832438184775');" onmouseout="out('-2247759832438184775');" style=""> 109 import javax.servlet.http.HttpServletResponse;                                                           </span>
<span  style=""> 110                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 111 /**                                                                                                      </span>
<span class="5624503434864804252" onmouseenter="enter('5624503434864804252');" onmouseout="out('5624503434864804252');" style=""> 112  * The default implementation of the {@link AdminAbstractController}. This delegates every call to       </span>
<span class="-497882971048272294" onmouseenter="enter('-497882971048272294');" onmouseout="out('-497882971048272294');" style=""> 113  * super and does not provide any custom-tailored functionality. It is responsible for rendering the     </span>
<span class="-4790859535261881332" onmouseenter="enter('-4790859535261881332');" onmouseout="out('-4790859535261881332');" style=""> 114  * admin for every entity that is not explicitly customized by its own controller.                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 115  *                                                                                                       </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style=""> 116  * @author Andre Azzolini (apazzolini)                                                                   </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style=""> 117  * @author Jeff Fischer                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 118  */                                                                                                      </span>
<span class="4155455059275642147" onmouseenter="enter('4155455059275642147');" onmouseout="out('4155455059275642147');" style=""> 119 @Controller(&quot;blAdminBasicEntityController&quot;)                                                              </span>
<span class="1298802560762502343" onmouseenter="enter('1298802560762502343');" onmouseout="out('1298802560762502343');" style=""> 120 @RequestMapping(&quot;/{sectionKey:.+}&quot;)                                                                      </span>
<span class="8857493697785984988" onmouseenter="enter('8857493697785984988');" onmouseout="out('8857493697785984988');" style=""> 121 public class AdminBasicEntityController extends AdminAbstractController {                                </span>
<span  style=""> 122                                                                                                          </span>
<span class="6387945601766467724" onmouseenter="enter('6387945601766467724');" onmouseout="out('6387945601766467724');" style=""> 123     protected static final Log LOG = LogFactory.getLog(AdminBasicEntityController.class);                </span>
<span  style=""> 124                                                                                                          </span>
<span class="-3043900363751028803" onmouseenter="enter('-3043900363751028803');" onmouseout="out('-3043900363751028803');" style=""> 125     public static final String ALTERNATE_ID_PROPERTY = &quot;ALTERNATE_ID&quot;;                                   </span>
<span class="4075481265342786632" onmouseenter="enter('4075481265342786632');" onmouseout="out('4075481265342786632');" style=""> 126     public static final String CUSTOM_CRITERIA = &quot;criteria&quot;;                                             </span>
<span class="-5370879055704196240" onmouseenter="enter('-5370879055704196240');" onmouseout="out('-5370879055704196240');" style=""> 127     public static final String IS_SELECTIZE_REQUEST = &quot;isSelectizeRequest&quot;;                              </span>
<span  style=""> 128                                                                                                          </span>
<span class="-7030764210296949798" onmouseenter="enter('-7030764210296949798');" onmouseout="out('-7030764210296949798');" style=""> 129     @Resource(name=&quot;blSandBoxHelper&quot;)                                                                    </span>
<span class="-7799183597372200632" onmouseenter="enter('-7799183597372200632');" onmouseout="out('-7799183597372200632');" style=""> 130     protected SandBoxHelper sandBoxHelper;                                                               </span>
<span  style=""> 131                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style=""> 132     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style=""> 133     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style=""> 134                                                                                                          </span>
<span class="1039661802170570045" onmouseenter="enter('1039661802170570045');" onmouseout="out('1039661802170570045');" style=""> 135     @Resource(name=&quot;blDynamicEntityDao&quot;)                                                                 </span>
<span class="-6629482740079052882" onmouseenter="enter('-6629482740079052882');" onmouseout="out('-6629482740079052882');" style=""> 136     protected DynamicEntityDao dynamicEntityDao;                                                         </span>
<span  style=""> 137                                                                                                          </span>
<span class="3323977399618509653" onmouseenter="enter('3323977399618509653');" onmouseout="out('3323977399618509653');" style=""> 138     @Resource(name = &quot;blAdornedTargetAutoPopulateExtensionManager&quot;)                                      </span>
<span class="-4810148452666974339" onmouseenter="enter('-4810148452666974339');" onmouseout="out('-4810148452666974339');" style=""> 139     protected AdornedTargetAutoPopulateExtensionManager adornedTargetAutoPopulateExtensionManager;       </span>
<span  style=""> 140                                                                                                          </span>
<span class="-1073312679381587606" onmouseenter="enter('-1073312679381587606');" onmouseout="out('-1073312679381587606');" style=""> 141     @Resource(name = &quot;blRowLevelSecurityService&quot;)                                                        </span>
<span class="7292046362506695965" onmouseenter="enter('7292046362506695965');" onmouseout="out('7292046362506695965');" style=""> 142     protected RowLevelSecurityService rowLevelSecurityService;                                           </span>
<span  style=""> 143                                                                                                          </span>
<span class="4471392044492296285" onmouseenter="enter('4471392044492296285');" onmouseout="out('4471392044492296285');" style=""> 144     @Resource(name = &quot;blEntityDuplicator&quot;)                                                               </span>
<span class="-9194612273021432316" onmouseenter="enter('-9194612273021432316');" onmouseout="out('-9194612273021432316');" style=""> 145     protected EntityDuplicator duplicator;                                                               </span>
<span  style=""> 146                                                                                                          </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style=""> 147     @Resource(name = &quot;blGenericEntityService&quot;)                                                           </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style=""> 148     protected GenericEntityService genericEntityService;                                                 </span>
<span  style=""> 149                                                                                                          </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 150     // ******************************************                                                        </span>
<span class="8145904524131922989" onmouseenter="enter('8145904524131922989');" onmouseout="out('8145904524131922989');" style=""> 151     // REQUEST-MAPPING BOUND CONTROLLER METHODS *                                                        </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 152     // ******************************************                                                        </span>
<span  style=""> 153                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 154     /**                                                                                                  </span>
<span class="5980196098348408716" onmouseenter="enter('5980196098348408716');" onmouseout="out('5980196098348408716');" style=""><abbr title=" 155      * Renders the main entity listing for the specified class, which is based on the current sectionKey with some optional"> 155      * Renders the main entity listing for the specified class, which is based on the current sectionKey ðŸ”µ</abbr></span>
<span class="1756838433111210325" onmouseenter="enter('1756838433111210325');" onmouseout="out('1756838433111210325');" style=""> 156      * criteria.                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 157      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 158      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 159      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 160      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 161      * @param pathVars                                                                                   </span>
<span class="-7836494531350161829" onmouseenter="enter('-7836494531350161829');" onmouseout="out('-7836494531350161829');" style=""> 162      * @param requestParams a Map of property name -&gt; list critiera values                               </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 163      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 164      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 165      */                                                                                                  </span>
<span class="854227037044969777" onmouseenter="enter('854227037044969777');" onmouseout="out('854227037044969777');" style=""> 166     @RequestMapping(value = &quot;&quot;, method = RequestMethod.GET)                                              </span>
<span class="5203424842505603172" onmouseenter="enter('5203424842505603172');" onmouseout="out('5203424842505603172');" style=""> 167     public String viewEntityList(HttpServletRequest request, HttpServletResponse response, Model model,  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 168             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 169             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 170         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 171         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 172         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                               </span>
<span class="1452589137399878084" onmouseenter="enter('1452589137399878084');" onmouseout="out('1452589137399878084');" style=""><abbr title=" 173         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars);"> 173         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 174         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 175         DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                           </span>
<span  style=""> 176                                                                                                          </span>
<span class="-9123024135554384147" onmouseenter="enter('-9123024135554384147');" onmouseout="out('-9123024135554384147');" style=""> 177         ListGrid listGrid = formService.buildMainListGrid(drs, cmd, sectionKey, crumbs);                 </span>
<span class="-7197013270379460942" onmouseenter="enter('-7197013270379460942');" onmouseout="out('-7197013270379460942');" style=""> 178         listGrid.setSelectType(ListGrid.SelectType.NONE);                                                </span>
<span  style=""> 179                                                                                                          </span>
<span class="6707774114103003478" onmouseenter="enter('6707774114103003478');" onmouseout="out('6707774114103003478');" style=""> 180         Set&lt;Field&gt; headerFields = listGrid.getHeaderFields();                                            </span>
<span class="6157449347608657417" onmouseenter="enter('6157449347608657417');" onmouseout="out('6157449347608657417');" style=""> 181         if (CollectionUtils.isNotEmpty(headerFields)) {                                                  </span>
<span class="7359980094802675712" onmouseenter="enter('7359980094802675712');" onmouseout="out('7359980094802675712');" style=""> 182             Field firstField = headerFields.iterator().next();                                           </span>
<span class="-7992921859474727563" onmouseenter="enter('-7992921859474727563');" onmouseout="out('-7992921859474727563');" style=""> 183             if (requestParams.containsKey(firstField.getName())) {                                       </span>
<span class="-4847870846432586371" onmouseenter="enter('-4847870846432586371');" onmouseout="out('-4847870846432586371');" style=""> 184                 model.addAttribute(&quot;mainSearchTerm&quot;, requestParams.get(firstField.getName()).get(0));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186         }                                                                                                </span>
<span  style=""> 187                                                                                                          </span>
<span class="3294377821001327596" onmouseenter="enter('3294377821001327596');" onmouseout="out('3294377821001327596');" style=""> 188         model.addAttribute(&quot;viewType&quot;, &quot;entityList&quot;);                                                    </span>
<span  style=""> 189                                                                                                          </span>
<span class="5223794068523842694" onmouseenter="enter('5223794068523842694');" onmouseout="out('5223794068523842694');" style=""> 190         setupViewEntityListBasicModel(request, cmd, sectionKey, sectionClassName, model, requestParams); </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 191         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style=""> 192                                                                                                          </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 193         return DEFAULT_CONTAINER_VIEW;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="5512240627727429054" onmouseenter="enter('5512240627727429054');" onmouseout="out('5512240627727429054');" style=""><abbr title=" 196     protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String sectionKey,"> 196     protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String seðŸ”µ</abbr></span>
<span class="522743254766371502" onmouseenter="enter('522743254766371502');" onmouseout="out('522743254766371502');" style=""> 197             String sectionClassName, Model model, MultiValueMap&lt;String, String&gt; requestParams) {         </span>
<span class="5787313217223527782" onmouseenter="enter('5787313217223527782');" onmouseout="out('5787313217223527782');" style=""> 198         List&lt;EntityFormAction&gt; mainActions = new ArrayList&lt;&gt;();                                          </span>
<span class="-6495333239259317464" onmouseenter="enter('-6495333239259317464');" onmouseout="out('-6495333239259317464');" style=""> 199         addAddActionIfAllowed(sectionClassName, cmd, mainActions);                                       </span>
<span class="-5948121019403308590" onmouseenter="enter('-5948121019403308590');" onmouseout="out('-5948121019403308590');" style=""> 200         extensionManager.getProxy().addAdditionalMainActions(sectionClassName, mainActions);             </span>
<span class="-381816252130957573" onmouseenter="enter('-381816252130957573');" onmouseout="out('-381816252130957573');" style=""> 201         extensionManager.getProxy().modifyMainActions(cmd, mainActions);                                 </span>
<span  style=""> 202                                                                                                          </span>
<span class="-5498329164774951339" onmouseenter="enter('-5498329164774951339');" onmouseout="out('-5498329164774951339');" style=""> 203         // If this came from a delete save, we&#x27;ll have a headerFlash request parameter to take care of   </span>
<span class="6915846846822456322" onmouseenter="enter('6915846846822456322');" onmouseout="out('6915846846822456322');" style=""> 204         if (requestParams.containsKey(&quot;headerFlash&quot;)) {                                                  </span>
<span class="-7374079465520861767" onmouseenter="enter('-7374079465520861767');" onmouseout="out('-7374079465520861767');" style=""> 205             model.addAttribute(&quot;headerFlash&quot;, requestParams.get(&quot;headerFlash&quot;).get(0));                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206         }                                                                                                </span>
<span  style=""> 207                                                                                                          </span>
<span class="-5632901614715850082" onmouseenter="enter('-5632901614715850082');" onmouseout="out('-5632901614715850082');" style=""> 208         List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                   </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style=""> 209         String requestUri = request.getRequestURI();                                                     </span>
<span class="2670437920401576748" onmouseenter="enter('2670437920401576748');" onmouseout="out('2670437920401576748');" style=""> 210         if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) {  </span>
<span class="-901741071381030126" onmouseenter="enter('-901741071381030126');" onmouseout="out('-901741071381030126');" style=""><abbr title=" 211             requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length());"> 211             requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length())ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212         }                                                                                                </span>
<span  style=""> 213                                                                                                          </span>
<span class="-3335875933652663591" onmouseenter="enter('-3335875933652663591');" onmouseout="out('-3335875933652663591');" style=""> 214         model.addAttribute(&quot;isFilter&quot;, (requestParams.size() &gt; 0));                                      </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style=""> 215         model.addAttribute(&quot;currentUri&quot;, requestUri);                                                    </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style=""> 216         model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                  </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 217         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 218         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="-4219022137146036385" onmouseenter="enter('-4219022137146036385');" onmouseout="out('-4219022137146036385');" style=""> 219         model.addAttribute(&quot;mainActions&quot;, mainActions);                                                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 220         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-7167932239083034641" onmouseenter="enter('-7167932239083034641');" onmouseout="out('-7167932239083034641');" style=""> 221         setTypedEntityModelAttributes(request, model);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222     }                                                                                                    </span>
<span  style=""> 223                                                                                                          </span>
<span class="-3612928683982517341" onmouseenter="enter('-3612928683982517341');" onmouseout="out('-3612928683982517341');" style=""> 224     @RequestMapping(value = &quot;/selectize&quot;, method = RequestMethod.GET)                                    </span>
<span class="-2536734120775641057" onmouseenter="enter('-2536734120775641057');" onmouseout="out('-2536734120775641057');" style=""> 225     public @ResponseBody Map&lt;String, Object&gt; viewEntityListSelectize(HttpServletRequest request,         </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style=""> 226              HttpServletResponse response, Model model,                                                  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 227              @PathVariable Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 228              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 229         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 230         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 231         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                               </span>
<span class="3971039348455381302" onmouseenter="enter('3971039348455381302');" onmouseout="out('3971039348455381302');" style=""><abbr title=" 232         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars)"> 232         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="-5204717557696417186" onmouseenter="enter('-5204717557696417186');" onmouseout="out('-5204717557696417186');" style=""> 233                 .withCustomCriteria(getCustomCriteria(requestParams));                                   </span>
<span  style=""> 234                                                                                                          </span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style=""> 235         ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                           </span>
<span  style=""> 236                                                                                                          </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 237         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 238         DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                           </span>
<span  style=""> 239                                                                                                          </span>
<span class="-6840686923261380416" onmouseenter="enter('-6840686923261380416');" onmouseout="out('-6840686923261380416');" style=""> 240         return formService.constructSelectizeOptionMap(drs, cmd);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241     }                                                                                                    </span>
<span  style=""> 242                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 243     /**                                                                                                  </span>
<span class="6015587852497052057" onmouseenter="enter('6015587852497052057');" onmouseout="out('6015587852497052057');" style=""> 244      * Obtains the requested criteria parameter                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 245      *                                                                                                   </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 246      * @param requestParams                                                                              </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 247      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 248      */                                                                                                  </span>
<span class="-5224065764328446223" onmouseenter="enter('-5224065764328446223');" onmouseout="out('-5224065764328446223');" style=""> 249     protected String[] getCustomCriteria(Map&lt;String, List&lt;String&gt;&gt; requestParams) {                      </span>
<span class="8308653628584061101" onmouseenter="enter('8308653628584061101');" onmouseout="out('8308653628584061101');" style=""> 250         if (requestParams == null || requestParams.isEmpty()) {                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 251             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252         }                                                                                                </span>
<span  style=""> 253                                                                                                          </span>
<span class="-6200156504676301578" onmouseenter="enter('-6200156504676301578');" onmouseout="out('-6200156504676301578');" style=""> 254         List&lt;String&gt; criteria = requestParams.get(CUSTOM_CRITERIA);                                      </span>
<span class="3479198517250864619" onmouseenter="enter('3479198517250864619');" onmouseout="out('3479198517250864619');" style=""> 255         String response = CollectionUtils.isEmpty(criteria) ? null : criteria.get(0);                    </span>
<span class="3591199473111095603" onmouseenter="enter('3591199473111095603');" onmouseout="out('3591199473111095603');" style=""> 256         return new String[] {response};                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257     }                                                                                                    </span>
<span  style=""> 258                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 259     /**                                                                                                  </span>
<span class="53051913897087216" onmouseenter="enter('53051913897087216');" onmouseout="out('53051913897087216');" style=""><abbr title=" 260      * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new instances"> 260      * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new inðŸ”µ</abbr></span>
<span class="-2041834868205006384" onmouseenter="enter('-2041834868205006384');" onmouseout="out('-2041834868205006384');" style=""> 261      * of the entity and all of the fields in the entity aren&#x27;t marked as read only.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 262      *                                                                                                   </span>
<span class="2579837316240354786" onmouseenter="enter('2579837316240354786');" onmouseout="out('2579837316240354786');" style=""> 263      * @param sectionClassName                                                                           </span>
<span class="3340688165449077744" onmouseenter="enter('3340688165449077744');" onmouseout="out('3340688165449077744');" style=""> 264      * @param cmd                                                                                        </span>
<span class="-70241175981651056" onmouseenter="enter('-70241175981651056');" onmouseout="out('-70241175981651056');" style=""> 265      * @param mainActions                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 266      */                                                                                                  </span>
<span class="-3535265632615590771" onmouseenter="enter('-3535265632615590771');" onmouseout="out('-3535265632615590771');" style=""><abbr title=" 267     protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormAction&gt; mainActions) {"> 267     protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormActioðŸ”µ</abbr></span>
<span class="-1675673801723949520" onmouseenter="enter('-1675673801723949520');" onmouseout="out('-1675673801723949520');" style=""> 268         if (isAddActionAllowed(sectionClassName, cmd)) {                                                 </span>
<span class="-161553798203722975" onmouseenter="enter('-161553798203722975');" onmouseout="out('-161553798203722975');" style=""> 269             mainActions.add(DefaultMainActions.ADD);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="4125299149074369729" onmouseenter="enter('4125299149074369729');" onmouseout="out('4125299149074369729');" style=""> 273     protected boolean isAddActionAllowed(final String sectionClassName, final ClassMetadata cmd) {       </span>
<span class="2379281051849826609" onmouseenter="enter('2379281051849826609');" onmouseout="out('2379281051849826609');" style=""> 274         // If the user does not have create permissions, we will not add the &quot;Add New&quot; button            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 275         try {                                                                                            </span>
<span class="-2050050318794737036" onmouseenter="enter('-2050050318794737036');" onmouseout="out('-2050050318794737036');" style=""> 276             adminRemoteSecurityService.securityCheck(sectionClassName, EntityOperationType.ADD);         </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 277         } catch (ServiceException e) {                                                                   </span>
<span class="-8912377967087217182" onmouseenter="enter('-8912377967087217182');" onmouseout="out('-8912377967087217182');" style=""> 278             if (e instanceof SecurityServiceException) {                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 279                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281         }                                                                                                </span>
<span  style=""> 282                                                                                                          </span>
<span class="-3272601440754635767" onmouseenter="enter('-3272601440754635767');" onmouseout="out('-3272601440754635767');" style=""> 283         final boolean canAdd = rowLevelSecurityService                                                   </span>
<span class="-1653290766274377775" onmouseenter="enter('-1653290766274377775');" onmouseout="out('-1653290766274377775');" style=""> 284                 .canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectionClassName, cmd);     </span>
<span class="5125272502277129387" onmouseenter="enter('5125272502277129387');" onmouseout="out('5125272502277129387');" style=""> 285         return isNotReadOnly(cmd) &amp;&amp; canAdd;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286     }                                                                                                    </span>
<span  style=""> 287                                                                                                          </span>
<span class="-7397004815762425407" onmouseenter="enter('-7397004815762425407');" onmouseout="out('-7397004815762425407');" style=""> 288     protected boolean isNotReadOnly(final ClassMetadata cmd) {                                           </span>
<span class="-5650645308789885306" onmouseenter="enter('-5650645308789885306');" onmouseout="out('-5650645308789885306');" style=""> 289         //check if all the metadata is read only                                                         </span>
<span class="-3497335608114491506" onmouseenter="enter('-3497335608114491506');" onmouseout="out('-3497335608114491506');" style=""> 290         for (Property property : cmd.getProperties()) {                                                  </span>
<span class="-446642995335437650" onmouseenter="enter('-446642995335437650');" onmouseout="out('-446642995335437650');" style=""> 291             if (property.getMetadata() instanceof BasicFieldMetadata) {                                  </span>
<span class="-4740706861929444273" onmouseenter="enter('-4740706861929444273');" onmouseout="out('-4740706861929444273');" style=""> 292                 if (((BasicFieldMetadata) property.getMetadata()).getReadOnly() == null ||               </span>
<span class="7731016670197656615" onmouseenter="enter('7731016670197656615');" onmouseout="out('7731016670197656615');" style=""> 293                         !((BasicFieldMetadata) property.getMetadata()).getReadOnly()) {                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 294                     return true;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297         }                                                                                                </span>
<span  style=""> 298                                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 299         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300     }                                                                                                    </span>
<span  style=""> 301                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 302     /**                                                                                                  </span>
<span class="-403478592182410175" onmouseenter="enter('-403478592182410175');" onmouseout="out('-403478592182410175');" style=""><abbr title=" 303      * Renders the modal form that is used to add a new parent level entity. Note that this form cannot render any"> 303      * Renders the modal form that is used to add a new parent level entity. Note that this form cannot rðŸ”µ</abbr></span>
<span class="-2684076904077363908" onmouseenter="enter('-2684076904077363908');" onmouseout="out('-2684076904077363908');" style=""><abbr title=" 304      * subcollections as operations on those collections require the parent level entity to first be saved and have"> 304      * subcollections as operations on those collections require the parent level entity to first be saveðŸ”µ</abbr></span>
<span class="-2496660529180512497" onmouseenter="enter('-2496660529180512497');" onmouseout="out('-2496660529180512497');" style=""><abbr title=" 305      * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity screen where"> 305      * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity ðŸ”µ</abbr></span>
<span class="-5672334976076130102" onmouseenter="enter('-5672334976076130102');" onmouseout="out('-5672334976076130102');" style=""> 306      * they can then perform operations on sub collections.                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 307      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 308      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 309      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 310      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 311      * @param pathVars                                                                                   </span>
<span class="-7339043177630483847" onmouseenter="enter('-7339043177630483847');" onmouseout="out('-7339043177630483847');" style=""> 312      * @param entityType                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 313      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 314      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 315      */                                                                                                  </span>
<span class="-6494270766546423105" onmouseenter="enter('-6494270766546423105');" onmouseout="out('-6494270766546423105');" style=""> 316     @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.GET)                                          </span>
<span class="8522113168804045570" onmouseenter="enter('8522113168804045570');" onmouseout="out('8522113168804045570');" style=""><abbr title=" 317     public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,"> 317     public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model modelðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 318             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="-1715631339976075770" onmouseenter="enter('-1715631339976075770');" onmouseout="out('-1715631339976075770');" style=""> 319             @RequestParam(defaultValue = &quot;&quot;) String entityType) throws Exception {                       </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 320         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 321         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 322         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 323         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 323         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style=""> 324         ppr.setAddOperationInspect(true);                                                                </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 325         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span  style=""> 326                                                                                                          </span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style=""> 327         entityType = determineEntityType(entityType, cmd);                                               </span>
<span  style=""> 328                                                                                                          </span>
<span class="4098005746663533241" onmouseenter="enter('4098005746663533241');" onmouseout="out('4098005746663533241');" style=""> 329         EntityForm entityForm = formService.createEntityForm(cmd, sectionCrumbs);                        </span>
<span  style=""> 330                                                                                                          </span>
<span class="5826594571687596812" onmouseenter="enter('5826594571687596812');" onmouseout="out('5826594571687596812');" style=""><abbr title=" 331         // We need to make sure that the ceiling entity is set to the interface and the specific entity type"> 331         // We need to make sure that the ceiling entity is set to the interface and the specific entity tðŸ”µ</abbr></span>
<span class="37161952125740808" onmouseenter="enter('37161952125740808');" onmouseout="out('37161952125740808');" style=""> 332         // is set to the type we&#x27;re going to be creating.                                                </span>
<span class="5062735442039535924" onmouseenter="enter('5062735442039535924');" onmouseout="out('5062735442039535924');" style=""> 333         entityForm.setCeilingEntityClassname(cmd.getCeilingType());                                      </span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style=""> 334         entityForm.setEntityType(entityType);                                                            </span>
<span  style=""> 335                                                                                                          </span>
<span class="-5227856854691424770" onmouseenter="enter('-5227856854691424770');" onmouseout="out('-5227856854691424770');" style=""><abbr title=" 336         // When we initially build the class metadata (and thus, the entity form), we had all of the possible"> 336         // When we initially build the class metadata (and thus, the entity form), we had all of the possðŸ”µ</abbr></span>
<span class="5105619661852614163" onmouseenter="enter('5105619661852614163');" onmouseout="out('5105619661852614163');" style=""><abbr title=" 337         // polymorphic fields built out. Now that we have a concrete entity type to render, we can remove the"> 337         // polymorphic fields built out. Now that we have a concrete entity type to render, we can removeðŸ”µ</abbr></span>
<span class="-3843175043245177501" onmouseenter="enter('-3843175043245177501');" onmouseout="out('-3843175043245177501');" style=""> 338         // fields that are not applicable for this given entity type.                                    </span>
<span class="-2935519954456371455" onmouseenter="enter('-2935519954456371455');" onmouseout="out('-2935519954456371455');" style=""> 339         formService.removeNonApplicableFields(cmd, entityForm, entityType);                              </span>
<span  style=""> 340                                                                                                          </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 341         modifyAddEntityForm(entityForm, pathVars);                                                       </span>
<span  style=""> 342                                                                                                          </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 343         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 344         model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                               </span>
<span  style=""> 345                                                                                                          </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 346         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 347         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 348         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 349         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 350         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351     }                                                                                                    </span>
<span  style=""> 352                                                                                                          </span>
<span class="6822582914767657426" onmouseenter="enter('6822582914767657426');" onmouseout="out('6822582914767657426');" style=""> 353     // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic         </span>
<span class="6925903770450869702" onmouseenter="enter('6925903770450869702');" onmouseout="out('6925903770450869702');" style=""> 354     // types for this entity.                                                                            </span>
<span class="3096473113628081949" onmouseenter="enter('3096473113628081949');" onmouseout="out('3096473113628081949');" style=""> 355     protected String determineEntityType(String entityType, final ClassMetadata cmd)                     </span>
<span class="363372168864539985" onmouseenter="enter('363372168864539985');" onmouseout="out('363372168864539985');" style=""> 356             throws UnsupportedEncodingException {                                                        </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 357         if (StringUtils.isBlank(entityType)) {                                                           </span>
<span class="2333848870190395940" onmouseenter="enter('2333848870190395940');" onmouseout="out('2333848870190395940');" style=""> 358             if (cmd.getPolymorphicEntities().getChildren().length == 0) {                                </span>
<span class="2097783908693957449" onmouseenter="enter('2097783908693957449');" onmouseout="out('2097783908693957449');" style=""> 359                 entityType = cmd.getPolymorphicEntities().getFullyQualifiedClassname();                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 360             } else {                                                                                     </span>
<span class="-6902702564943152777" onmouseenter="enter('-6902702564943152777');" onmouseout="out('-6902702564943152777');" style=""> 361                 entityType = getDefaultEntityType();                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 363         } else {                                                                                         </span>
<span class="7843468667819793383" onmouseenter="enter('7843468667819793383');" onmouseout="out('7843468667819793383');" style=""> 364             entityType = URLDecoder.decode(entityType, &quot;UTF-8&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365         }                                                                                                </span>
<span class="2597693607778452486" onmouseenter="enter('2597693607778452486');" onmouseout="out('2597693607778452486');" style=""> 366         return entityType;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367     }                                                                                                    </span>
<span  style=""> 368                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 369     /**                                                                                                  </span>
<span class="-2292124409166412817" onmouseenter="enter('-2292124409166412817');" onmouseout="out('-2292124409166412817');" style=""><abbr title=" 370      * Processes the request to add a new entity. If successful, returns a redirect to the newly created entity."> 370      * Processes the request to add a new entity. If successful, returns a redirect to the newly created ðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 371      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 372      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 373      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 374      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 375      * @param pathVars                                                                                   </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 376      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 377      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 378      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 379      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 380      */                                                                                                  </span>
<span class="-1840738840686664300" onmouseenter="enter('-1840738840686664300');" onmouseout="out('-1840738840686664300');" style=""> 381     @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.POST)                                         </span>
<span class="8551380442207718095" onmouseenter="enter('8551380442207718095');" onmouseout="out('8551380442207718095');" style=""> 382     public String addEntity(HttpServletRequest request, HttpServletResponse response, Model model,       </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 383             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title=" 384             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {"> 384             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 385         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 386         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 387         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="2596618104185041854" onmouseenter="enter('2596618104185041854');" onmouseout="out('2596618104185041854');" style=""><abbr title=" 388         ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 388         ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassNameðŸ”µ</abbr></span>
<span  style=""> 389                                                                                                          </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 390         extractDynamicFormFields(cmd, entityForm);                                                       </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 391         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 391         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="-4281879219750019053" onmouseenter="enter('-4281879219750019053');" onmouseout="out('-4281879219750019053');" style=""> 392         Entity entity = service.addEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();       </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 393         entityFormValidator.validate(entityForm, entity, result);                                        </span>
<span  style=""> 394                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 395         if (result.hasErrors()) {                                                                        </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 396             entityForm.clearFieldsMap();                                                                 </span>
<span class="-312181662169537666" onmouseenter="enter('-312181662169537666');" onmouseout="out('-312181662169537666');" style=""> 397             formService.populateEntityForm(cmd, entity, entityForm, sectionCrumbs);                      </span>
<span  style=""> 398                                                                                                          </span>
<span class="254171966199148419" onmouseenter="enter('254171966199148419');" onmouseout="out('254171966199148419');" style=""> 399             formService.removeNonApplicableFields(cmd, entityForm, entityForm.getEntityType());          </span>
<span  style=""> 400                                                                                                          </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 401             modifyAddEntityForm(entityForm, pathVars);                                                   </span>
<span  style=""> 402                                                                                                          </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 403             model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                           </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 404             model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                        </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 405             model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                 </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 406             model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 407             setModelAttributes(model, sectionKey);                                                       </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 408             return MODAL_CONTAINER_VIEW;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409         }                                                                                                </span>
<span  style=""> 410                                                                                                          </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 411         // Note that AJAX Redirects need the context path prepended to them                              </span>
<span class="-9104189425594863479" onmouseenter="enter('-9104189425594863479');" onmouseout="out('-9104189425594863479');" style=""><abbr title=" 412         return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).getValue();"> 412         return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413     }                                                                                                    </span>
<span  style=""> 414                                                                                                          </span>
<span class="1290933159858539781" onmouseenter="enter('1290933159858539781');" onmouseout="out('1290933159858539781');" style=""> 415     @RequestMapping(value = &quot;/{id}/duplicate&quot;, method = RequestMethod.POST)                              </span>
<span class="-7829728733805273999" onmouseenter="enter('-7829728733805273999');" onmouseout="out('-7829728733805273999');" style=""> 416     public String duplicateEntity(final HttpServletRequest request,                                      </span>
<span class="277417182565607361" onmouseenter="enter('277417182565607361');" onmouseout="out('277417182565607361');" style=""> 417             final HttpServletResponse response,                                                          </span>
<span class="7665770463560391322" onmouseenter="enter('7665770463560391322');" onmouseout="out('7665770463560391322');" style=""> 418             final Model model,                                                                           </span>
<span class="5144416334471976319" onmouseenter="enter('5144416334471976319');" onmouseout="out('5144416334471976319');" style=""> 419             @PathVariable final Map&lt;String, String&gt; pathVars,                                            </span>
<span class="5884230296910152604" onmouseenter="enter('5884230296910152604');" onmouseout="out('5884230296910152604');" style=""> 420             @PathVariable(value = &quot;id&quot;) final String id,                                                 </span>
<span class="5134952934925976911" onmouseenter="enter('5134952934925976911');" onmouseout="out('5134952934925976911');" style=""> 421             @ModelAttribute(value = &quot;entityForm&quot;) final EntityForm entityForm,                           </span>
<span class="3593210188792847894" onmouseenter="enter('3593210188792847894');" onmouseout="out('3593210188792847894');" style=""> 422             final BindingResult result) throws Exception {                                               </span>
<span class="5473402149144087547" onmouseenter="enter('5473402149144087547');" onmouseout="out('5473402149144087547');" style=""> 423         final String sectionKey = getSectionKey(pathVars);                                               </span>
<span class="5437662011929987553" onmouseenter="enter('5437662011929987553');" onmouseout="out('5437662011929987553');" style=""> 424         final String sectionClassName = getClassNameForSection(sectionKey);                              </span>
<span class="8553976943183535096" onmouseenter="enter('8553976943183535096');" onmouseout="out('8553976943183535096');" style=""> 425         final Class&lt;?&gt; entityClass = dynamicEntityDao.getImplClass(sectionClassName);                    </span>
<span class="3365797270076600425" onmouseenter="enter('3365797270076600425');" onmouseout="out('3365797270076600425');" style=""> 426         final long identifier = Long.parseLong(id);                                                      </span>
<span  style=""> 427                                                                                                          </span>
<span class="-138107922525045121" onmouseenter="enter('-138107922525045121');" onmouseout="out('-138107922525045121');" style=""> 428         if (duplicator.validate(entityClass, identifier)) {                                              </span>
<span class="5493542447860389431" onmouseenter="enter('5493542447860389431');" onmouseout="out('5493542447860389431');" style=""> 429             final Object duplicate;                                                                      </span>
<span  style=""> 430                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 431             try {                                                                                        </span>
<span class="-2283233085854885260" onmouseenter="enter('-2283233085854885260');" onmouseout="out('-2283233085854885260');" style=""> 432                 duplicate = duplicator.copy(entityClass, identifier);                                    </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 433             } catch (Exception e) {                                                                      </span>
<span class="-8850460393574909327" onmouseenter="enter('-8850460393574909327');" onmouseout="out('-8850460393574909327');" style=""> 434                 LOG.error(&quot;Could not duplicate entity&quot;, e);                                              </span>
<span class="-7503880796159563304" onmouseenter="enter('-7503880796159563304');" onmouseout="out('-7503880796159563304');" style=""> 435                 return getErrorDuplicatingResponse(response, &quot;Duplication_Failure&quot;);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436             }                                                                                            </span>
<span  style=""> 437                                                                                                          </span>
<span class="9202899875978069713" onmouseenter="enter('9202899875978069713');" onmouseout="out('9202899875978069713');" style=""> 438             final Serializable dupId = genericEntityService.getIdentifier(duplicate);                    </span>
<span  style=""> 439                                                                                                          </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 440             // Note that AJAX Redirects need the context path prepended to them                          </span>
<span class="6804960621276438337" onmouseenter="enter('6804960621276438337');" onmouseout="out('6804960621276438337');" style=""> 441             return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + dupId;                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 442         } else {                                                                                         </span>
<span class="-110948502599545681" onmouseenter="enter('-110948502599545681');" onmouseout="out('-110948502599545681');" style=""> 443             return getErrorDuplicatingResponse(response, &quot;Validation_Failure&quot;);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445     }                                                                                                    </span>
<span  style=""> 446                                                                                                          </span>
<span class="-106656131545478097" onmouseenter="enter('-106656131545478097');" onmouseout="out('-106656131545478097');" style=""> 447     protected String getErrorDuplicatingResponse(HttpServletResponse response, String code) {            </span>
<span class="7659712838923572459" onmouseenter="enter('7659712838923572459');" onmouseout="out('7659712838923572459');" style=""> 448         List&lt;Map&lt;String, Object&gt;&gt; errors = new ArrayList&lt;&gt;();                                            </span>
<span class="-6240695079450735253" onmouseenter="enter('-6240695079450735253');" onmouseout="out('-6240695079450735253');" style=""> 449         String message;                                                                                  </span>
<span class="-7826420477706002406" onmouseenter="enter('-7826420477706002406');" onmouseout="out('-7826420477706002406');" style=""> 450         BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();          </span>
<span class="-2727648393614728" onmouseenter="enter('-2727648393614728');" onmouseout="out('-2727648393614728');" style=""> 451         if (context != null &amp;&amp; context.getMessageSource() != null) {                                     </span>
<span class="-5978418614812499702" onmouseenter="enter('-5978418614812499702');" onmouseout="out('-5978418614812499702');" style=""> 452             message = context.getMessageSource()                                                         </span>
<span class="1624598595284946587" onmouseenter="enter('1624598595284946587');" onmouseout="out('1624598595284946587');" style=""> 453                     .getMessage(code, null, code, context.getJavaLocale());                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 454         } else {                                                                                         </span>
<span class="-9004243737964586892" onmouseenter="enter('-9004243737964586892');" onmouseout="out('-9004243737964586892');" style=""> 455             LOG.warn(                                                                                    </span>
<span class="6269614064328325287" onmouseenter="enter('6269614064328325287');" onmouseout="out('6269614064328325287');" style=""> 456                     &quot;Could not find the MessageSource on the current request, &quot;                          </span>
<span class="-8208830135626721740" onmouseenter="enter('-8208830135626721740');" onmouseout="out('-8208830135626721740');" style=""> 457                             + &quot;not translating the message key&quot;);                                        </span>
<span class="599114272120646428" onmouseenter="enter('599114272120646428');" onmouseout="out('599114272120646428');" style=""> 458             message = &quot;Duplication_Failure&quot;;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459         }                                                                                                </span>
<span  style=""> 460                                                                                                          </span>
<span class="-4703377271641004207" onmouseenter="enter('-4703377271641004207');" onmouseout="out('-4703377271641004207');" style=""> 461         Map&lt;String, Object&gt; errorMap = new HashMap&lt;&gt;();                                                  </span>
<span class="2851590661979449603" onmouseenter="enter('2851590661979449603');" onmouseout="out('2851590661979449603');" style=""> 462         errorMap.put(&quot;errorType&quot;, &quot;global&quot;);                                                             </span>
<span class="4738760182182965590" onmouseenter="enter('4738760182182965590');" onmouseout="out('4738760182182965590');" style=""> 463         errorMap.put(&quot;code&quot;, code);                                                                      </span>
<span class="7426718838785534996" onmouseenter="enter('7426718838785534996');" onmouseout="out('7426718838785534996');" style=""> 464         errorMap.put(&quot;message&quot;, message);                                                                </span>
<span class="-4906289066975989946" onmouseenter="enter('-4906289066975989946');" onmouseout="out('-4906289066975989946');" style=""> 465         errors.add(errorMap);                                                                            </span>
<span class="-8734340547513070222" onmouseenter="enter('-8734340547513070222');" onmouseout="out('-8734340547513070222');" style=""> 466         return new JsonResponse(response).with(&quot;errors&quot;, errors).done();                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467     }                                                                                                    </span>
<span  style=""> 468                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 469     /**                                                                                                  </span>
<span class="9102199281013466170" onmouseenter="enter('9102199281013466170');" onmouseout="out('9102199281013466170');" style=""> 470      * Renders the main entity form for the specified entity                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 471      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 472      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 473      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 474      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 475      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 476      * @param id                                                                                         </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 477      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 478      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 479      */                                                                                                  </span>
<span class="7083955269921705584" onmouseenter="enter('7083955269921705584');" onmouseout="out('7083955269921705584');" style=""> 480     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.GET)                                         </span>
<span class="-4309552397998806559" onmouseenter="enter('-4309552397998806559');" onmouseout="out('-4309552397998806559');" style=""> 481     public String viewEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,  </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 482             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="-2194094146044801021" onmouseenter="enter('-2194094146044801021');" onmouseout="out('-2194094146044801021');" style=""> 483             @PathVariable(&quot;id&quot;) String id) throws Exception {                                            </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 484         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 485         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 486         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                           </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""><abbr title=" 487         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);"> 487         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, patðŸ”µ</abbr></span>
<span  style=""> 488                                                                                                          </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 489         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-8780243800866475465" onmouseenter="enter('-8780243800866475465');" onmouseout="out('-8780243800866475465');" style=""> 490         Entity entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style=""> 491                                                                                                          </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""><abbr title=" 492         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);"> 492         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, cðŸ”µ</abbr></span>
<span  style=""> 493                                                                                                          </span>
<span class="872584542219399793" onmouseenter="enter('872584542219399793');" onmouseout="out('872584542219399793');" style=""> 494         EntityForm entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);        </span>
<span  style=""> 495                                                                                                          </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 496         modifyEntityForm(entity, entityForm, pathVars);                                                  </span>
<span  style=""> 497                                                                                                          </span>
<span class="1981952247030149381" onmouseenter="enter('1981952247030149381');" onmouseout="out('1981952247030149381');" style=""> 498         if (request.getParameter(&quot;headerFlash&quot;) != null) {                                               </span>
<span class="-2367607735703612103" onmouseenter="enter('-2367607735703612103');" onmouseout="out('-2367607735703612103');" style=""> 499             model.addAttribute(&quot;headerFlash&quot;, request.getParameter(&quot;headerFlash&quot;));                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500         }                                                                                                </span>
<span  style=""> 501                                                                                                          </span>
<span class="-6569554975283424126" onmouseenter="enter('-6569554975283424126');" onmouseout="out('-6569554975283424126');" style=""> 502         // Set the sectionKey again incase this is a typed entity                                        </span>
<span class="4201932972037321722" onmouseenter="enter('4201932972037321722');" onmouseout="out('4201932972037321722');" style=""> 503         entityForm.setSectionKey(sectionKey);                                                            </span>
<span  style=""> 504                                                                                                          </span>
<span class="5387752430767952558" onmouseenter="enter('5387752430767952558');" onmouseout="out('5387752430767952558');" style=""> 505         // Build the current url in the cast that this is a typed entity                                 </span>
<span class="3856485652570637824" onmouseenter="enter('3856485652570637824');" onmouseout="out('3856485652570637824');" style=""> 506         String originatingUri = new UrlPathHelper().getOriginatingRequestUri(request);                   </span>
<span class="-1728408616530607173" onmouseenter="enter('-1728408616530607173');" onmouseout="out('-1728408616530607173');" style=""> 507         int startIndex = request.getContextPath().length();                                              </span>
<span  style=""> 508                                                                                                          </span>
<span class="654052499558570629" onmouseenter="enter('654052499558570629');" onmouseout="out('654052499558570629');" style=""> 509         // Remove the context path from servlet path                                                     </span>
<span class="526107488063217153" onmouseenter="enter('526107488063217153');" onmouseout="out('526107488063217153');" style=""> 510         String currentUrl = originatingUri.substring(startIndex);                                        </span>
<span  style=""> 511                                                                                                          </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 512         model.addAttribute(&quot;entity&quot;, entity);                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 513         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-4977411250845897884" onmouseenter="enter('-4977411250845897884');" onmouseout="out('-4977411250845897884');" style=""> 514         model.addAttribute(&quot;currentUrl&quot;, currentUrl);                                                    </span>
<span  style=""> 515                                                                                                          </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 516         setModelAttributes(model, sectionKey);                                                           </span>
<span  style=""> 517                                                                                                          </span>
<span class="8236570979651257825" onmouseenter="enter('8236570979651257825');" onmouseout="out('8236570979651257825');" style=""> 518         // We want to replace author ids with their names                                                </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style=""> 519         addAuditableDisplayFields(entityForm);                                                           </span>
<span  style=""> 520                                                                                                          </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style=""> 521         return resolveAppropriateEntityView(request, model, entityForm);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522     }                                                                                                    </span>
<span  style=""> 523                                                                                                          </span>
<span class="9182660926479189949" onmouseenter="enter('9182660926479189949');" onmouseout="out('9182660926479189949');" style=""><abbr title=" 524     protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, String&gt; pathVars,"> 524     protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, StrðŸ”µ</abbr></span>
<span class="4477928710658117231" onmouseenter="enter('4477928710658117231');" onmouseout="out('4477928710658117231');" style=""> 525                                                               ClassMetadata cmd, Entity entity,          </span>
<span class="5660295431162582196" onmouseenter="enter('5660295431162582196');" onmouseout="out('5660295431162582196');" style=""><abbr title=" 526                                                               List&lt;SectionCrumb&gt; crumbs) throws Exception {"> 526                                                               List&lt;SectionCrumb&gt; crumbs) throws ExceptionðŸ”µ</abbr></span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style=""> 527         String tabName = pathVars.get(&quot;tabName&quot;);                                                        </span>
<span class="5384642555226517985" onmouseenter="enter('5384642555226517985');" onmouseout="out('5384642555226517985');" style=""> 528         if (StringUtils.isEmpty(tabName)) {                                                              </span>
<span class="-3672533750283461484" onmouseenter="enter('-3672533750283461484');" onmouseout="out('-3672533750283461484');" style=""> 529             tabName = cmd.getFirstTab() == null ? &quot;General&quot; : cmd.getFirstTab().getTabName();            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 530         }                                                                                                </span>
<span class="-5882478663361935855" onmouseenter="enter('-5882478663361935855');" onmouseout="out('-5882478663361935855');" style=""> 531         return service.getRecordsForSelectedTab(cmd, entity, crumbs, tabName);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532     }                                                                                                    </span>
<span  style=""> 533                                                                                                          </span>
<span class="1953795048205106952" onmouseenter="enter('1953795048205106952');" onmouseout="out('1953795048205106952');" style=""> 534     private boolean isAddRequest(Entity entity) {                                                        </span>
<span class="-2989581670667655563" onmouseenter="enter('-2989581670667655563');" onmouseout="out('-2989581670667655563');" style=""> 535         ExtensionResultHolder&lt;Boolean&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                     </span>
<span class="2773544387861748911" onmouseenter="enter('2773544387861748911');" onmouseout="out('2773544387861748911');" style=""><abbr title=" 536         ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder);"> 536         ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder)ðŸ”µ</abbr></span>
<span class="8622638495597819717" onmouseenter="enter('8622638495597819717');" onmouseout="out('8622638495597819717');" style=""> 537         if (result.equals(ExtensionResultStatusType.NOT_HANDLED)) {                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 538             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 539         }                                                                                                </span>
<span  style=""> 540                                                                                                          </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 541         return resultHolder.getResult();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542     }                                                                                                    </span>
<span  style=""> 543                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 544     /**                                                                                                  </span>
<span class="-4864218972040039628" onmouseenter="enter('-4864218972040039628');" onmouseout="out('-4864218972040039628');" style=""> 545      * Attempts to get the List Grid for the selected tab.                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 546      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 547      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 548      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 549      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 550      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 551      * @param id                                                                                         </span>
<span class="4841027518362301903" onmouseenter="enter('4841027518362301903');" onmouseout="out('4841027518362301903');" style=""> 552      * @param tabName                                                                                    </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 553      * @param entityForm                                                                                 </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style=""> 554      * @param entity                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 555      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 556      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 557      */                                                                                                  </span>
<span class="-7675092144868804288" onmouseenter="enter('-7675092144868804288');" onmouseout="out('-7675092144868804288');" style=""> 558     @RequestMapping(value = &quot;/{id}/{tab:[0-9]+}/{tabName}&quot;, method = RequestMethod.POST)                 </span>
<span class="-2248541185927650044" onmouseenter="enter('-2248541185927650044');" onmouseout="out('-2248541185927650044');" style=""> 559     public String viewEntityTab(HttpServletRequest request, HttpServletResponse response, Model model,   </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 560             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 561             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="2259450910520289810" onmouseenter="enter('2259450910520289810');" onmouseout="out('2259450910520289810');" style=""> 562             @PathVariable(value = &quot;tabName&quot;) String tabName,                                             </span>
<span class="2754607649135651414" onmouseenter="enter('2754607649135651414');" onmouseout="out('2754607649135651414');" style=""> 563             @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm,                                 </span>
<span class="-2950467864443381399" onmouseenter="enter('-2950467864443381399');" onmouseout="out('-2950467864443381399');" style=""> 564             @ModelAttribute(value = &quot;entity&quot;) Entity entity) throws Exception {                          </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 565         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 566         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 567         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                           </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""><abbr title=" 568         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);"> 568         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, patðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 569         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 570         entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];           </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""><abbr title=" 571         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);"> 571         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, cðŸ”µ</abbr></span>
<span class="-3846048132763499568" onmouseenter="enter('-3846048132763499568');" onmouseout="out('-3846048132763499568');" style=""> 572         entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);                   </span>
<span  style=""> 573                                                                                                          </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 574         modifyEntityForm(entity, entityForm, pathVars);                                                  </span>
<span  style=""> 575                                                                                                          </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 576         model.addAttribute(&quot;entity&quot;, entity);                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 577         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 578         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span  style=""> 579                                                                                                          </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 580         setModelAttributes(model, sectionKey);                                                           </span>
<span  style=""> 581                                                                                                          </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 582         model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                       </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 583         model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                    </span>
<span  style=""> 584                                                                                                          </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 585         return DEFAULT_CONTAINER_VIEW;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 586     }                                                                                                    </span>
<span  style=""> 587                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 588     /**                                                                                                  </span>
<span class="26428616724277901" onmouseenter="enter('26428616724277901');" onmouseout="out('26428616724277901');" style=""> 589      * Builds JSON that looks like this:                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 590      *                                                                                                   </span>
<span class="-619170819873097874" onmouseenter="enter('-619170819873097874');" onmouseout="out('-619170819873097874');" style=""> 591      * {&quot;errors&quot;:                                                                                        </span>
<span class="-7867797149207986089" onmouseenter="enter('-7867797149207986089');" onmouseout="out('-7867797149207986089');" style=""> 592      *      [{&quot;message&quot;:&quot;This field is Required&quot;,                                                        </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 593      *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                        </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 594      *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 595      *        &quot;errorType&quot;, &quot;field&quot;,                                                                      </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 596      *        &quot;tab&quot;: &quot;General&quot;                                                                           </span>
<span class="762081609125064039" onmouseenter="enter('762081609125064039');" onmouseout="out('762081609125064039');" style=""> 597      *        },                                                                                         </span>
<span class="2065208195238134241" onmouseenter="enter('2065208195238134241');" onmouseout="out('2065208195238134241');" style=""> 598      *        {&quot;message&quot;:&quot;This field is Required&quot;,                                                       </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 599      *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                        </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 600      *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 601      *        &quot;errorType&quot;, &quot;field&quot;,                                                                      </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 602      *        &quot;tab&quot;: &quot;General&quot;                                                                           </span>
<span class="-832778532632947969" onmouseenter="enter('-832778532632947969');" onmouseout="out('-832778532632947969');" style=""> 603      *        }]                                                                                         </span>
<span class="8941010846014250828" onmouseenter="enter('8941010846014250828');" onmouseout="out('8941010846014250828');" style=""> 604      * }                                                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 605      *                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 606      */                                                                                                  </span>
<span class="726178843151373675" onmouseenter="enter('726178843151373675');" onmouseout="out('726178843151373675');" style=""> 607     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST, produces = &quot;application/json&quot;)         </span>
<span class="-4245682307765667372" onmouseenter="enter('-4245682307765667372');" onmouseout="out('-4245682307765667372');" style=""> 608     public String saveEntityJson(HttpServletRequest request, HttpServletResponse response, Model model,  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 609             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 610             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="-5165411007609652701" onmouseenter="enter('-5165411007609652701');" onmouseout="out('-5165411007609652701');" style=""> 611             @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm, BindingResult result,           </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 612             RedirectAttributes ra) throws Exception {                                                    </span>
<span  style=""> 613                                                                                                          </span>
<span class="-7049584637685461961" onmouseenter="enter('-7049584637685461961');" onmouseout="out('-7049584637685461961');" style=""> 614         saveEntity(request, response, model, pathVars, id, entityForm, result, ra);                      </span>
<span  style=""> 615                                                                                                          </span>
<span class="2770382331963423086" onmouseenter="enter('2770382331963423086');" onmouseout="out('2770382331963423086');" style=""> 616         JsonResponse json = new JsonResponse(response);                                                  </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 617         if (result.hasErrors()) {                                                                        </span>
<span class="6668101882629849049" onmouseenter="enter('6668101882629849049');" onmouseout="out('6668101882629849049');" style=""> 618             populateJsonValidationErrors(entityForm, result, json);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 619         }                                                                                                </span>
<span class="-8719030961107019295" onmouseenter="enter('-8719030961107019295');" onmouseout="out('-8719030961107019295');" style=""> 620         List&lt;String&gt; dirtyList = buildDirtyList(pathVars, request, id);                                  </span>
<span class="-2397478597494600131" onmouseenter="enter('-2397478597494600131');" onmouseout="out('-2397478597494600131');" style=""> 621         if (CollectionUtils.isNotEmpty(dirtyList)) {                                                     </span>
<span class="-6863151800017638945" onmouseenter="enter('-6863151800017638945');" onmouseout="out('-6863151800017638945');" style=""> 622             json.with(&quot;dirty&quot;, dirtyList);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 623         }                                                                                                </span>
<span  style=""> 624                                                                                                          </span>
<span class="1148846903613025505" onmouseenter="enter('1148846903613025505');" onmouseout="out('1148846903613025505');" style=""> 625         ExtensionResultHolder&lt;String&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                      </span>
<span class="772761850497532920" onmouseenter="enter('772761850497532920');" onmouseout="out('772761850497532920');" style=""><abbr title=" 626         ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonResponse(response, result.hasErrors(), getSectionKey(pathVars), id, resultHolder);"> 626         ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonReðŸ”µ</abbr></span>
<span class="-7225919658162387284" onmouseenter="enter('-7225919658162387284');" onmouseout="out('-7225919658162387284');" style=""> 627         if (resultStatusType.equals(ExtensionResultStatusType.HANDLED)) {                                </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 628             return resultHolder.getResult();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 629         }                                                                                                </span>
<span  style=""> 630                                                                                                          </span>
<span class="-3901811907821215875" onmouseenter="enter('-3901811907821215875');" onmouseout="out('-3901811907821215875');" style=""> 631         return json.done();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 632     }                                                                                                    </span>
<span  style=""> 633                                                                                                          </span>
<span class="-2624067384280123527" onmouseenter="enter('-2624067384280123527');" onmouseout="out('-2624067384280123527');" style=""><abbr title=" 634     public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String id) throws ServiceException {"> 634     public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String iðŸ”µ</abbr></span>
<span class="-6199220983064020273" onmouseenter="enter('-6199220983064020273');" onmouseout="out('-6199220983064020273');" style=""> 635         List&lt;String&gt; dirtyList = new ArrayList&lt;&gt;();                                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 636         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 637         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 638         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 639         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 639         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="-6293964121119142853" onmouseenter="enter('-6293964121119142853');" onmouseout="out('-6293964121119142853');" style=""> 640         ClassMetadata cmd = null;                                                                        </span>
<span class="-6100049554794336383" onmouseenter="enter('-6100049554794336383');" onmouseout="out('-6100049554794336383');" style=""> 641         Entity entity = null;                                                                            </span>
<span class="-7221558264805358950" onmouseenter="enter('-7221558264805358950');" onmouseout="out('-7221558264805358950');" style=""> 642         cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();                    </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 643         entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];           </span>
<span  style=""> 644                                                                                                          </span>
<span class="-538034338216639378" onmouseenter="enter('-538034338216639378');" onmouseout="out('-538034338216639378');" style=""> 645         for (Property p: entity.getProperties()) {                                                       </span>
<span class="-5586383415891827802" onmouseenter="enter('-5586383415891827802');" onmouseout="out('-5586383415891827802');" style=""> 646             if (p.getIsDirty()) {                                                                        </span>
<span class="-1571805809811752662" onmouseenter="enter('-1571805809811752662');" onmouseout="out('-1571805809811752662');" style=""> 647                 dirtyList.add(p.getName());                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 648             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649         }                                                                                                </span>
<span class="7211627429904225799" onmouseenter="enter('7211627429904225799');" onmouseout="out('7211627429904225799');" style=""> 650         return dirtyList;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 651     }                                                                                                    </span>
<span  style=""> 652                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 653     /**                                                                                                  </span>
<span class="-1912365624495655250" onmouseenter="enter('-1912365624495655250');" onmouseout="out('-1912365624495655250');" style=""><abbr title=" 654      * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity form with"> 654      * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity forðŸ”µ</abbr></span>
<span class="3378821078357952120" onmouseenter="enter('3378821078357952120');" onmouseout="out('3378821078357952120');" style=""> 655      * error fields highlighted. On a successful save, it will refresh the entity page.                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 656      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 657      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 658      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 659      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 660      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 661      * @param id                                                                                         </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 662      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 663      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 664      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 665      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 666      */                                                                                                  </span>
<span class="681227659796054179" onmouseenter="enter('681227659796054179');" onmouseout="out('681227659796054179');" style=""> 667     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST)                                        </span>
<span class="2696827203115285075" onmouseenter="enter('2696827203115285075');" onmouseout="out('2696827203115285075');" style=""> 668     public String saveEntity(HttpServletRequest request, HttpServletResponse response, Model model,      </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 669             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 670             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 671             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,             </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 672             RedirectAttributes ra) throws Exception {                                                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 673         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 674         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 675         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 676         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 676         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 677         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span  style=""> 678                                                                                                          </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 679         extractDynamicFormFields(cmd, entityForm);                                                       </span>
<span  style=""> 680                                                                                                          </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 681         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 681         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="-4517703585527939334" onmouseenter="enter('-4517703585527939334');" onmouseout="out('-4517703585527939334');" style=""> 682         Entity entity = service.updateEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();    </span>
<span  style=""> 683                                                                                                          </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 684         entityFormValidator.validate(entityForm, entity, result);                                        </span>
<span  style=""> 685                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 686         if (result.hasErrors()) {                                                                        </span>
<span class="-9083492279253959347" onmouseenter="enter('-9083492279253959347');" onmouseout="out('-9083492279253959347');" style=""> 687             model.addAttribute(&quot;headerFlash&quot;, &quot;save.unsuccessful&quot;);                                      </span>
<span class="-3255113992478543295" onmouseenter="enter('-3255113992478543295');" onmouseout="out('-3255113992478543295');" style=""> 688             model.addAttribute(&quot;headerFlashAlert&quot;, true);                                                </span>
<span  style=""> 689                                                                                                          </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 690             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 690             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 691             entityForm.clearFieldsMap();                                                                 </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 692             formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);       </span>
<span  style=""> 693                                                                                                          </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 694             modifyEntityForm(entity, entityForm, pathVars);                                              </span>
<span  style=""> 695                                                                                                          </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 696             model.addAttribute(&quot;entity&quot;, entity);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 697             model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                        </span>
<span  style=""> 698                                                                                                          </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 699             setModelAttributes(model, sectionKey);                                                       </span>
<span  style=""> 700                                                                                                          </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style=""> 701             return resolveAppropriateEntityView(request, model, entityForm);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702         }                                                                                                </span>
<span  style=""> 703                                                                                                          </span>
<span class="-8977665602521560288" onmouseenter="enter('-8977665602521560288');" onmouseout="out('-8977665602521560288');" style=""> 704         ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;save.successful&quot;);                                          </span>
<span  style=""> 705                                                                                                          </span>
<span class="5326436654777975784" onmouseenter="enter('5326436654777975784');" onmouseout="out('5326436654777975784');" style=""> 706         return &quot;redirect:/&quot; + sectionKey + &quot;/&quot; + id;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 707     }                                                                                                    </span>
<span  style=""> 708                                                                                                          </span>
<span class="-1036069149620696687" onmouseenter="enter('-1036069149620696687');" onmouseout="out('-1036069149620696687');" style=""> 709     protected void modifyEntityForm(final Entity entity, final EntityForm entityForm,                    </span>
<span class="-2182671422299427893" onmouseenter="enter('-2182671422299427893');" onmouseout="out('-2182671422299427893');" style=""> 710             final Map&lt;String, String&gt; pathVars) throws Exception {                                       </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style=""> 711         if (isAddRequest(entity)) {                                                                      </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 712             modifyAddEntityForm(entityForm, pathVars);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 713         } else {                                                                                         </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 714             modifyEntityForm(entityForm, pathVars);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 715         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 716     }                                                                                                    </span>
<span  style=""> 717                                                                                                          </span>
<span class="7327611436230860688" onmouseenter="enter('7327611436230860688');" onmouseout="out('7327611436230860688');" style=""> 718     protected String resolveAppropriateEntityView(final HttpServletRequest request,                      </span>
<span class="7665770463560391322" onmouseenter="enter('7665770463560391322');" onmouseout="out('7665770463560391322');" style=""> 719             final Model model,                                                                           </span>
<span class="6537819747648345888" onmouseenter="enter('6537819747648345888');" onmouseout="out('6537819747648345888');" style=""> 720             final @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) {                         </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 721         if (isAjaxRequest(request)) {                                                                    </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style=""> 722             entityForm.setReadOnly();                                                                    </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style=""> 723             model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                          </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style=""> 724             model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 725             return MODAL_CONTAINER_VIEW;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 726         } else {                                                                                         </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 727             model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                   </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 728             model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 729             return DEFAULT_CONTAINER_VIEW;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 730         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 731     }                                                                                                    </span>
<span  style=""> 732                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 733     /**                                                                                                  </span>
<span class="4876253458579857532" onmouseenter="enter('4876253458579857532');" onmouseout="out('4876253458579857532');" style=""> 734      * Attempts to remove the given entity.                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 735      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 736      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 737      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 738      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 739      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 740      * @param id                                                                                         </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 741      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 742      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 743      */                                                                                                  </span>
<span class="8293921381301703428" onmouseenter="enter('8293921381301703428');" onmouseout="out('8293921381301703428');" style=""> 744     @RequestMapping(value = &quot;/{id}/delete&quot;, method = RequestMethod.POST)                                 </span>
<span class="2313354717081876463" onmouseenter="enter('2313354717081876463');" onmouseout="out('2313354717081876463');" style=""> 745     public String removeEntity(HttpServletRequest request, HttpServletResponse response, Model model,    </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 746             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 747             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 748             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,             </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 749             RedirectAttributes ra) throws Exception {                                                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 750         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 751         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 752         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span  style=""> 753                                                                                                          </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 754         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 754         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="6624819200143935214" onmouseenter="enter('6624819200143935214');" onmouseout="out('6624819200143935214');" style=""> 755         Entity entity = service.removeEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();    </span>
<span class="-6561774320633688873" onmouseenter="enter('-6561774320633688873');" onmouseout="out('-6561774320633688873');" style=""> 756         // Removal does not normally return an Entity unless there is some validation error              </span>
<span class="-2807113977407494827" onmouseenter="enter('-2807113977407494827');" onmouseout="out('-2807113977407494827');" style=""> 757         if (entity != null) {                                                                            </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 758             entityFormValidator.validate(entityForm, entity, result);                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 759             if (result.hasErrors()) {                                                                    </span>
<span class="354313568014337940" onmouseenter="enter('354313568014337940');" onmouseout="out('354313568014337940');" style=""> 760                 // Create a flash attribute for the unsuccessful delete                                  </span>
<span class="-3408473788799892596" onmouseenter="enter('-3408473788799892596');" onmouseout="out('-3408473788799892596');" style=""> 761                 FlashMap fm = new FlashMap();                                                            </span>
<span class="-3785724779356953427" onmouseenter="enter('-3785724779356953427');" onmouseout="out('-3785724779356953427');" style=""> 762                 fm.put(&quot;headerFlash&quot;, &quot;delete.unsuccessful&quot;);                                            </span>
<span class="2000410372434500283" onmouseenter="enter('2000410372434500283');" onmouseout="out('2000410372434500283');" style=""> 763                 fm.put(&quot;headerFlashAlert&quot;, true);                                                        </span>
<span class="-216272657842661141" onmouseenter="enter('-216272657842661141');" onmouseout="out('-216272657842661141');" style=""> 764                 request.setAttribute(DispatcherServlet.OUTPUT_FLASH_MAP_ATTRIBUTE, fm);                  </span>
<span  style=""> 765                                                                                                          </span>
<span class="-9154666565283892619" onmouseenter="enter('-9154666565283892619');" onmouseout="out('-9154666565283892619');" style=""> 766                 // Re-look back up the entity so that we can return something populated                  </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 767                 PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 767                 PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, secðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""><abbr title=" 768                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 768                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData(ðŸ”µ</abbr></span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 769                 entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];   </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 770                 Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 770                 Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr,ðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 771                 entityForm.clearFieldsMap();                                                             </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 772                 formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);   </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 773                 modifyEntityForm(entityForm, pathVars);                                                  </span>
<span  style=""> 774                                                                                                          </span>
<span class="-1358530666837283115" onmouseenter="enter('-1358530666837283115');" onmouseout="out('-1358530666837283115');" style=""> 775                 return populateJsonValidationErrors(entityForm, result, new JsonResponse(response))      </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style=""> 776                         .done();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 777             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 778         }                                                                                                </span>
<span  style=""> 779                                                                                                          </span>
<span class="3611526951082120901" onmouseenter="enter('3611526951082120901');" onmouseout="out('3611526951082120901');" style=""> 780         ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;delete.successful&quot;);                                        </span>
<span class="2579818068351246488" onmouseenter="enter('2579818068351246488');" onmouseout="out('2579818068351246488');" style=""> 781         ra.addFlashAttribute(&quot;headerFlashAlert&quot;, true);                                                  </span>
<span  style=""> 782                                                                                                          </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 783         if (isAjaxRequest(request)) {                                                                    </span>
<span class="-5684384949344822714" onmouseenter="enter('-5684384949344822714');" onmouseout="out('-5684384949344822714');" style=""> 784             // redirect attributes won&#x27;t work here since ajaxredirect actually makes a new request       </span>
<span class="-9107475529968351628" onmouseenter="enter('-9107475529968351628');" onmouseout="out('-9107475529968351628');" style=""><abbr title=" 785             return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;?headerFlash=delete.successful&quot;;"> 785             return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;?headerFlash=delete.successfðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 786         } else {                                                                                         </span>
<span class="4357427724598824699" onmouseenter="enter('4357427724598824699');" onmouseout="out('4357427724598824699');" style=""> 787             return &quot;redirect:/&quot; + sectionKey;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 788         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 789     }                                                                                                    </span>
<span  style=""> 790                                                                                                          </span>
<span class="-2983794507366563158" onmouseenter="enter('-2983794507366563158');" onmouseout="out('-2983794507366563158');" style=""> 791     @RequestMapping(value = &quot;/{collectionField:.*}/details&quot;, method = RequestMethod.GET)                 </span>
<span class="-527911248282232950" onmouseenter="enter('-527911248282232950');" onmouseout="out('-527911248282232950');" style=""><abbr title=" 792     public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 792     public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpSeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 793             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 794             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-5250072335910309101" onmouseenter="enter('-5250072335910309101');" onmouseout="out('-5250072335910309101');" style=""> 795             @RequestParam String ids,                                                                    </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 796             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 797         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 798         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 799         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="-5225610456611199616" onmouseenter="enter('-5225610456611199616');" onmouseout="out('-5225610456611199616');" style=""><abbr title=" 800         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, sectionCrumbs, pathVars);"> 800         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""><abbr title=" 801         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 801         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDataðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 802         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 803         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style=""> 804                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style=""> 805         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span class="-2120492003233088270" onmouseenter="enter('-2120492003233088270');" onmouseout="out('-2120492003233088270');" style=""> 806         ppr.setStartIndex(getStartIndex(requestParams));                                                 </span>
<span class="2736790979641523309" onmouseenter="enter('2736790979641523309');" onmouseout="out('2736790979641523309');" style=""> 807         ppr.setMaxIndex(getMaxIndex(requestParams));                                                     </span>
<span  style=""> 808                                                                                                          </span>
<span class="-8000769512056204294" onmouseenter="enter('-8000769512056204294');" onmouseout="out('-8000769512056204294');" style=""> 809         if (md instanceof BasicFieldMetadata) {                                                          </span>
<span class="-1954892043355765019" onmouseenter="enter('-1954892043355765019');" onmouseout="out('-1954892043355765019');" style=""> 810             String idProp = ((BasicFieldMetadata) md).getForeignKeyProperty();                           </span>
<span class="6288096257758990604" onmouseenter="enter('6288096257758990604');" onmouseout="out('6288096257758990604');" style=""> 811             String displayProp = ((BasicFieldMetadata) md).getForeignKeyDisplayValueProperty();          </span>
<span  style=""> 812                                                                                                          </span>
<span class="-6477100624593005266" onmouseenter="enter('-6477100624593005266');" onmouseout="out('-6477100624593005266');" style=""> 813             List&lt;String&gt; filterValues = BLCArrayUtils.asList(ids.split(FILTER_VALUE_SEPARATOR_REGEX));   </span>
<span class="3640259021720155935" onmouseenter="enter('3640259021720155935');" onmouseout="out('3640259021720155935');" style=""> 814             ppr.addFilterAndSortCriteria(new FilterAndSortCriteria(idProp, filterValues));               </span>
<span  style=""> 815                                                                                                          </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style=""> 816             DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                        </span>
<span class="-2768740094948248396" onmouseenter="enter('-2768740094948248396');" onmouseout="out('-2768740094948248396');" style=""> 817             Map&lt;String, String&gt; returnMap = new HashMap&lt;&gt;();                                             </span>
<span  style=""> 818                                                                                                          </span>
<span class="-5517026699518874938" onmouseenter="enter('-5517026699518874938');" onmouseout="out('-5517026699518874938');" style=""> 819             for (Entity e : drs.getRecords()) {                                                          </span>
<span class="4979367110517822568" onmouseenter="enter('4979367110517822568');" onmouseout="out('4979367110517822568');" style=""> 820                 String id = e.getPMap().get(idProp).getValue();                                          </span>
<span class="-4946347213336092877" onmouseenter="enter('-4946347213336092877');" onmouseout="out('-4946347213336092877');" style=""> 821                 String disp = e.getPMap().get(displayProp).getDisplayValue();                            </span>
<span  style=""> 822                                                                                                          </span>
<span class="3483982845402449596" onmouseenter="enter('3483982845402449596');" onmouseout="out('3483982845402449596');" style=""> 823                 if (StringUtils.isBlank(disp)) {                                                         </span>
<span class="-2027181132953179584" onmouseenter="enter('-2027181132953179584');" onmouseout="out('-2027181132953179584');" style=""> 824                     disp = e.getPMap().get(displayProp).getValue();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 825                 }                                                                                        </span>
<span  style=""> 826                                                                                                          </span>
<span class="-1075893121428940879" onmouseenter="enter('-1075893121428940879');" onmouseout="out('-1075893121428940879');" style=""> 827                 returnMap.put(id,  disp);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 828             }                                                                                            </span>
<span  style=""> 829                                                                                                          </span>
<span class="9157811424862351106" onmouseenter="enter('9157811424862351106');" onmouseout="out('9157811424862351106');" style=""> 830             return returnMap;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 831         }                                                                                                </span>
<span  style=""> 832                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 833         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 834     }                                                                                                    </span>
<span  style=""> 835                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 836     /**                                                                                                  </span>
<span class="7896529828316523089" onmouseenter="enter('7896529828316523089');" onmouseout="out('7896529828316523089');" style=""><abbr title=" 837      * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a list of products"> 837      * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a ðŸ”µ</abbr></span>
<span class="8702245574166025616" onmouseenter="enter('8702245574166025616');" onmouseout="out('8702245574166025616');" style=""> 838      * then this method is invoked when a user clicks on the name of the default category field.         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 839      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 840      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 841      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 842      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 843      * @param pathVars                                                                                   </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 844      * @param collectionField                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 845      * @param id                                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 846      * @return                                                                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 847      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 848      */                                                                                                  </span>
<span class="1405910210670150204" onmouseenter="enter('1405910210670150204');" onmouseout="out('1405910210670150204');" style=""> 849     @RequestMapping(value = &quot;/{collectionField:.*}/{id}/view&quot;, method = RequestMethod.GET)               </span>
<span class="-5496524556428427140" onmouseenter="enter('-5496524556428427140');" onmouseout="out('-5496524556428427140');" style=""><abbr title=" 850     public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 850     public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, ModðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 851             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 852             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-1857511616350008386" onmouseenter="enter('-1857511616350008386');" onmouseout="out('-1857511616350008386');" style=""> 853             @PathVariable(value=&quot;id&quot;) String id) throws Exception {                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 854         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 855         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 856         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 857         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 857         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 858         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="2157347470680130722" onmouseenter="enter('2157347470680130722');" onmouseout="out('2157347470680130722');" style=""> 859         BasicFieldMetadata md = (BasicFieldMetadata) collectionProperty.getMetadata();                   </span>
<span  style=""> 860                                                                                                          </span>
<span class="-1856968160831305726" onmouseenter="enter('-1856968160831305726');" onmouseout="out('-1856968160831305726');" style=""><abbr title=" 861         AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeyClass(), sectionKey);"> 861         AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeðŸ”µ</abbr></span>
<span class="-151095669048618305" onmouseenter="enter('-151095669048618305');" onmouseout="out('-151095669048618305');" style=""><abbr title=" 862         String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : section.getUrl();"> 862         String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : sectiðŸ”µ</abbr></span>
<span class="4949862081138664893" onmouseenter="enter('4949862081138664893');" onmouseout="out('4949862081138664893');" style=""> 863         Map&lt;String, String&gt; varsForField = new HashMap&lt;&gt;();                                              </span>
<span class="-4429965231898090358" onmouseenter="enter('-4429965231898090358');" onmouseout="out('-4429965231898090358');" style=""> 864         varsForField.put(&quot;sectionKey&quot;, sectionUrlKey);                                                   </span>
<span class="4805235980730638518" onmouseenter="enter('4805235980730638518');" onmouseout="out('4805235980730638518');" style=""> 865         return viewEntityForm(request, response, model, varsForField, id);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 866     }                                                                                                    </span>
<span  style=""> 867                                                                                                          </span>
<span class="2731983140361230349" onmouseenter="enter('2731983140361230349');" onmouseout="out('2731983140361230349');" style=""> 868     @RequestMapping(                                                                                     </span>
<span class="4528666449367390600" onmouseenter="enter('4528666449367390600');" onmouseout="out('4528666449367390600');" style=""> 869             value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{tab:[0-9]+}/{tabName}&quot;,              </span>
<span class="7470628324060602258" onmouseenter="enter('7470628324060602258');" onmouseout="out('7470628324060602258');" style=""> 870             method = RequestMethod.POST                                                                  </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 871     )                                                                                                    </span>
<span class="1786222500639285262" onmouseenter="enter('1786222500639285262');" onmouseout="out('1786222500639285262');" style=""><abbr title=" 872     public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model model,"> 872     public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model mðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 873                                         @PathVariable  Map&lt;String, String&gt; pathVars,                     </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 874                                         @PathVariable(value=&quot;id&quot;) String id,                             </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 875                                         @PathVariable(value=&quot;collectionField&quot;) String collectionField,   </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style=""> 876                                         @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId, </span>
<span class="1347902176383833481" onmouseenter="enter('1347902176383833481');" onmouseout="out('1347902176383833481');" style=""> 877                                         @PathVariable(value=&quot;tabName&quot;) String tabName,                   </span>
<span class="-2122907702415237135" onmouseenter="enter('-2122907702415237135');" onmouseout="out('-2122907702415237135');" style=""><abbr title=" 878                                         @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throws Exception {"> 878                                         @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throðŸ”µ</abbr></span>
<span  style=""> 879                                                                                                          </span>
<span class="2284268618604436814" onmouseenter="enter('2284268618604436814');" onmouseout="out('2284268618604436814');" style=""><abbr title=" 880         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ModalHeaderType.VIEW_COLLECTION_ITEM.getType(), entityForm, null);"> 880         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 881     }                                                                                                    </span>
<span  style=""> 882                                                                                                          </span>
<span  style=""> 883                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 884     /**                                                                                                  </span>
<span class="1274042523848442367" onmouseenter="enter('1274042523848442367');" onmouseout="out('1274042523848442367');" style=""> 885      * Returns the records for a given collectionField filtered by a particular criteria                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 886      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 887      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 888      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 889      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 890      * @param pathVars                                                                                   </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 891      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 892      * @param requestParams                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 893      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 894      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 895      */                                                                                                  </span>
<span class="-4095443548484775059" onmouseenter="enter('-4095443548484775059');" onmouseout="out('-4095443548484775059');" style=""> 896     @RequestMapping(value = &quot;/{id}/{collectionField:.*}&quot;, method = RequestMethod.GET)                    </span>
<span class="-5889287394210369546" onmouseenter="enter('-5889287394210369546');" onmouseout="out('-5889287394210369546');" style=""><abbr title=" 897     public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, Model model,"> 897     public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, ModðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 898             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 899             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 900             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="3465670919255037355" onmouseenter="enter('3465670919255037355');" onmouseout="out('3465670919255037355');" style=""> 901             @RequestParam  MultiValueMap&lt;String, String&gt; requestParams) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 902         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 903         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 904         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-6545915569490985196" onmouseenter="enter('-6545915569490985196');" onmouseout="out('-6545915569490985196');" style=""><abbr title=" 905         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams, sectionCrumbs, pathVars);"> 905         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams,ðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""><abbr title=" 906         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 906         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDataðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 907         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style=""> 908                                                                                                          </span>
<span class="-3734134243620930531" onmouseenter="enter('-3734134243620930531');" onmouseout="out('-3734134243620930531');" style=""> 909         ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);               </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title=" 910         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];"> 910         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style=""> 911                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style=""> 912         // Next, we must get the new list grid that represents this collection                           </span>
<span class="-8440278474384944243" onmouseenter="enter('-8440278474384944243');" onmouseout="out('-8440278474384944243');" style=""><abbr title=" 913         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParams, sectionKey, sectionCrumbs);"> 913         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParamsðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 914         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style=""> 915                                                                                                          </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style=""> 916         model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));       </span>
<span  style=""> 917                                                                                                          </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style=""> 918         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 919         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style=""> 920         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 921     }                                                                                                    </span>
<span  style=""> 922                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 923     /**                                                                                                  </span>
<span class="-2279175998905644242" onmouseenter="enter('-2279175998905644242');" onmouseout="out('-2279175998905644242');" style=""><abbr title=" 924      * Shows the modal dialog that is used to add an item to a given collection. There are several possible outcomes"> 924      * Shows the modal dialog that is used to add an item to a given collection. There are several possibðŸ”µ</abbr></span>
<span class="-3490572548815062734" onmouseenter="enter('-3490572548815062734');" onmouseout="out('-3490572548815062734');" style=""> 925      * of this call depending on the type of the specified collection field.                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 926      *                                                                                                   </span>
<span class="2717555647352622731" onmouseenter="enter('2717555647352622731');" onmouseout="out('2717555647352622731');" style=""> 927      * &lt;ul&gt;                                                                                              </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 928      *  &lt;li&gt;                                                                                             </span>
<span class="4930235181592711719" onmouseenter="enter('4930235181592711719');" onmouseout="out('4930235181592711719');" style=""><abbr title=" 929      *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so that the user may"> 929      *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so thaðŸ”µ</abbr></span>
<span class="-3142080293607523336" onmouseenter="enter('-3142080293607523336');" onmouseout="out('-3142080293607523336');" style=""><abbr title=" 930      *    enter information and associate the record with this collection. Used by fields such as ProductAttribute."> 930      *    enter information and associate the record with this collection. Used by fields such as ProductðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 931      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 932      *  &lt;li&gt;                                                                                             </span>
<span class="6319691685860667757" onmouseenter="enter('6319691685860667757');" onmouseout="out('6319691685860667757');" style=""><abbr title=" 933      *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and select it."> 933      *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entiðŸ”µ</abbr></span>
<span class="-8731186021492741581" onmouseenter="enter('-8731186021492741581');" onmouseout="out('-8731186021492741581');" style=""> 934      *    Used by fields such as &quot;allParentCategories&quot;.                                                  </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 935      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 936      *  &lt;li&gt;                                                                                             </span>
<span class="-6847404578833725914" onmouseenter="enter('-6847404578833725914');" onmouseout="out('-6847404578833725914');" style=""><abbr title=" 937      *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 937      *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click onðŸ”µ</abbr></span>
<span class="568361472595397074" onmouseenter="enter('568361472595397074');" onmouseout="out('568361472595397074');" style=""><abbr title=" 938      *    select it. The view rendered by this is identical to basic collection (lookup), but will perform the operation"> 938      *    select it. The view rendered by this is identical to basic collection (lookup), but will perforðŸ”µ</abbr></span>
<span class="-4048066359856567222" onmouseenter="enter('-4048066359856567222');" onmouseout="out('-4048066359856567222');" style=""><abbr title=" 939      *    on an adorned field, which may carry extra meta-information about the created relationship, such as order."> 939      *    on an adorned field, which may carry extra meta-information about the created relationship, sucðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 940      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 941      *  &lt;li&gt;                                                                                             </span>
<span class="7355096557601214207" onmouseenter="enter('7355096557601214207');" onmouseout="out('7355096557601214207');" style=""><abbr title=" 942      *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 942      *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on anðŸ”µ</abbr></span>
<span class="-146713903552295440" onmouseenter="enter('-146713903552295440');" onmouseout="out('-146713903552295440');" style=""><abbr title=" 943      *    select it. Once the user selects the entity, he will be presented with an empty form based on the specified"> 943      *    select it. Once the user selects the entity, he will be presented with an empty form based on tðŸ”µ</abbr></span>
<span class="7585671366133275820" onmouseenter="enter('7585671366133275820');" onmouseout="out('7585671366133275820');" style=""><abbr title=" 944      *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, which in addition"> 944      *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, whiðŸ”µ</abbr></span>
<span class="7350312284882119043" onmouseenter="enter('7350312284882119043');" onmouseout="out('7350312284882119043');" style=""> 945      *    to linking an entity, provide extra fields, such as a promotional message.                     </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 946      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 947      *  &lt;li&gt;                                                                                             </span>
<span class="8829232354049589291" onmouseenter="enter('8829232354049589291');" onmouseout="out('8829232354049589291');" style=""><abbr title=" 948      *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. This field is"> 948      *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. ðŸ”µ</abbr></span>
<span class="-8508051731153769866" onmouseenter="enter('-8508051731153769866');" onmouseout="out('-8508051731153769866');" style=""><abbr title=" 949      *    populated either from the configured map keys, or as a result of a lookup in the case of a key based on another"> 949      *    populated either from the configured map keys, or as a result of a lookup in the case of a key ðŸ”µ</abbr></span>
<span class="-6056737616128420156" onmouseenter="enter('-6056737616128420156');" onmouseout="out('-6056737616128420156');" style=""> 950      *    entity. Used by fields such as the mediaMap on a Sku.                                          </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 951      *  &lt;/li&gt;                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 952      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 953      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 954      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 955      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 956      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 957      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 958      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 959      * @param requestParams                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 960      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 961      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 962      */                                                                                                  </span>
<span class="835275592837580694" onmouseenter="enter('835275592837580694');" onmouseout="out('835275592837580694');" style=""> 963     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.GET)                </span>
<span class="2460266594736272943" onmouseenter="enter('2460266594736272943');" onmouseout="out('2460266594736272943');" style=""><abbr title=" 964     public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,"> 964     public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model mðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 965             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 966             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style=""> 967             @PathVariable(value = &quot;collectionField&quot;) String collectionField,                             </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 968             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 969         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 970         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 971         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style=""><abbr title=" 972         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,"> 972         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style=""> 973                 sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 974         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 975         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style=""> 976                                                                                                          </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style=""> 977         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)        </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style=""> 978                 .withFilterAndSortCriteria(getCriteria(requestParams))                                   </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style=""> 979                 .withStartIndex(getStartIndex(requestParams))                                            </span>
<span class="4786121744461484155" onmouseenter="enter('4786121744461484155');" onmouseout="out('4786121744461484155');" style=""> 980                 .withMaxIndex(getMaxIndex(requestParams))                                                </span>
<span class="2941692162045974129" onmouseenter="enter('2941692162045974129');" onmouseout="out('2941692162045974129');" style=""> 981                 .withLastId(getLastId(requestParams))                                                    </span>
<span class="-9137331061893195290" onmouseenter="enter('-9137331061893195290');" onmouseout="out('-9137331061893195290');" style=""> 982                 .withFirstId(getFirstId(requestParams))                                                  </span>
<span class="-6497878492174321892" onmouseenter="enter('-6497878492174321892');" onmouseout="out('-6497878492174321892');" style=""> 983                 .withUpperCount(getUpperCount(requestParams))                                            </span>
<span class="-8373154769706308503" onmouseenter="enter('-8373154769706308503');" onmouseout="out('-8373154769706308503');" style=""> 984                 .withLowerCount(getLowerCount(requestParams))                                            </span>
<span class="-1051723743320189375" onmouseenter="enter('-1051723743320189375');" onmouseout="out('-1051723743320189375');" style=""> 985                 .withPageSize(getPageSize(requestParams))                                                </span>
<span class="-6582704259903712752" onmouseenter="enter('-6582704259903712752');" onmouseout="out('-6582704259903712752');" style=""> 986                 .withPresentationFetch(true);                                                            </span>
<span  style=""> 987                                                                                                          </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style=""> 988         if (md instanceof BasicCollectionMetadata) {                                                     </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style=""> 989             BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                  </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style=""> 990             if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                  </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""><abbr title=" 991                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 991                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData(ðŸ”µ</abbr></span>
<span class="-2914433993330253670" onmouseenter="enter('-2914433993330253670');" onmouseout="out('-2914433993330253670');" style=""><abbr title=" 992                 // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types"> 992                 // If the entity type isn&#x27;t specified, we need to determine if there are various polymorpðŸ”µ</abbr></span>
<span class="-7795450821592681641" onmouseenter="enter('-7795450821592681641');" onmouseout="out('-7795450821592681641');" style=""> 993                 // for this entity.                                                                      </span>
<span class="6186895968667433501" onmouseenter="enter('6186895968667433501');" onmouseout="out('6186895968667433501');" style=""> 994                 String entityType = null;                                                                </span>
<span  style=""> 995                                                                                                          </span>
<span class="3580632700461537732" onmouseenter="enter('3580632700461537732');" onmouseout="out('3580632700461537732');" style=""> 996                 if (requestParams.containsKey(&quot;entityType&quot;)) {                                           </span>
<span class="-1630371572733568969" onmouseenter="enter('-1630371572733568969');" onmouseout="out('-1630371572733568969');" style=""> 997                     entityType = requestParams.get(&quot;entityType&quot;).get(0);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 998                 }                                                                                        </span>
<span  style=""> 999                                                                                                          </span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style="">1000                 entityType = determineEntityType(entityType, cmd);                                       </span>
<span  style="">1001                                                                                                          </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style="">1002                 if (StringUtils.isBlank(entityType)) {                                                   </span>
<span class="679217737668422196" onmouseenter="enter('679217737668422196');" onmouseout="out('679217737668422196');" style="">1003                     return getModalForBlankEntityType(request, model, sectionKey, cmd);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1004                     }                                                                                    </span>
<span  style="">1005                                                                                                          </span>
<span class="-58316621888079189" onmouseenter="enter('-58316621888079189');" onmouseout="out('-58316621888079189');" style="">1006                     ppr = ppr.withCeilingEntityClassname(entityType);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1007                 }                                                                                        </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1008         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="-8815560953057448419" onmouseenter="enter('-8815560953057448419');" onmouseout="out('-8815560953057448419');" style=""><abbr title="1009             ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(request,response,model,sectionKey,id,requestParams,(MapMetadata) md);">1009             ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionTypðŸ”µ</abbr></span>
<span class="6674469997589527714" onmouseenter="enter('6674469997589527714');" onmouseout="out('6674469997589527714');" style="">1010             if (result.equals(ExtensionResultStatusType.HANDLED)) {                                      </span>
<span class="1057476267973220454" onmouseenter="enter('1057476267973220454');" onmouseout="out('1057476267973220454');" style="">1011                 model.addAttribute(&quot;entityId&quot;, id);                                                      </span>
<span class="6720161805434028669" onmouseenter="enter('6720161805434028669');" onmouseout="out('6720161805434028669');" style="">1012                 model.addAttribute(&quot;sectionKey&quot;, sectionKey);                                            </span>
<span class="-2435595331613687341" onmouseenter="enter('-2435595331613687341');" onmouseout="out('-2435595331613687341');" style="">1013                 model.addAttribute(&quot;collectionField&quot;, collectionField);                                  </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1014                 return MODAL_CONTAINER_VIEW;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1015             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1016         }                                                                                                </span>
<span  style="">1017                                                                                                          </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style="">1018         model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));       </span>
<span  style="">1019                                                                                                          </span>
<span class="6180232744784249160" onmouseenter="enter('6180232744784249160');" onmouseout="out('6180232744784249160');" style=""><abbr title="1020         return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty, md, ppr, null, null);">1020         return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, colðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1021     }                                                                                                    </span>
<span  style="">1022                                                                                                          </span>
<span class="-2220429573703069666" onmouseenter="enter('-2220429573703069666');" onmouseout="out('-2220429573703069666');" style="">1023     protected String getModalForBlankEntityType(final HttpServletRequest request,                        </span>
<span class="-5263780204247815298" onmouseenter="enter('-5263780204247815298');" onmouseout="out('-5263780204247815298');" style="">1024             final Model model, final String sectionKey, final ClassMetadata cmd) {                       </span>
<span class="-2316979209506989336" onmouseenter="enter('-2316979209506989336');" onmouseout="out('-2316979209506989336');" style="">1025         final List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());             </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style="">1026         model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                  </span>
<span class="-7344898891916261334" onmouseenter="enter('-7344898891916261334');" onmouseout="out('-7344898891916261334');" style="">1027         model.addAttribute(&quot;viewType&quot;, &quot;modal/entityTypeSelection&quot;);                                     </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style="">1028         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span  style="">1029                                                                                                          </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style="">1030         String requestUri = request.getRequestURI();                                                     </span>
<span class="3126054482386392887" onmouseenter="enter('3126054482386392887');" onmouseout="out('3126054482386392887');" style="">1031         final String contextPath = request.getContextPath();                                             </span>
<span  style="">1032                                                                                                          </span>
<span class="1413502326105343009" onmouseenter="enter('1413502326105343009');" onmouseout="out('1413502326105343009');" style="">1033         if (!contextPath.equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(contextPath)) {                            </span>
<span class="-5812874762785975576" onmouseenter="enter('-5812874762785975576');" onmouseout="out('-5812874762785975576');" style="">1034             requestUri = requestUri.substring(contextPath.length() + 1, requestUri.length());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1035         }                                                                                                </span>
<span  style="">1036                                                                                                          </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style="">1037         model.addAttribute(&quot;currentUri&quot;, requestUri);                                                    </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style="">1038         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1039         setModelAttributes(model, sectionKey);                                                           </span>
<span  style="">1040                                                                                                          </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1041         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1042     }                                                                                                    </span>
<span  style="">1043                                                                                                          </span>
<span class="373770933822047642" onmouseenter="enter('373770933822047642');" onmouseout="out('373770933822047642');" style=""><abbr title="1044     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMethod.POST)">1044     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMðŸ”µ</abbr></span>
<span class="-870509305261572147" onmouseenter="enter('-870509305261572147');" onmouseout="out('-870509305261572147');" style=""><abbr title="1045     public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1045     public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1046             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1047             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1048             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1049             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1050         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1051         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1052         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1053         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1053         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1054         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1055         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1056         Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                               </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1057         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title="1058             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,">1058             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, maðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style="">1059                     collectionField,                                                                     </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style="">1060                     collectionItemId, responseMap);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1061         }                                                                                                </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1062         return responseMap;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1063     }                                                                                                    </span>
<span  style="">1064                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1065     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1066      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1067      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1068      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1069      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1070      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1071      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1072      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style="">1073      * @param requestParams                                                                              </span>
<span class="-4008047975326689228" onmouseenter="enter('-4008047975326689228');" onmouseout="out('-4008047975326689228');" style="">1074      * @return Json collection data                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1075      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1076      */                                                                                                  </span>
<span class="1491507797785399205" onmouseenter="enter('1491507797785399205');" onmouseout="out('1491507797785399205');" style="">1077     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize&quot;, method = RequestMethod.GET)          </span>
<span class="3394871197523978831" onmouseenter="enter('3394871197523978831');" onmouseout="out('3394871197523978831');" style=""><abbr title="1078     public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletResponse response, Model model,">1078     public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HtðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1079             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style="">1080             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style="">1081             @PathVariable(value = &quot;collectionField&quot;) String collectionField,                             </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style="">1082             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1083         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1084         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1085         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style=""><abbr title="1086         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,">1086         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style="">1087                 sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1088         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1089         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style="">1090                                                                                                          </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style="">1091         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)        </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style="">1092                 .withFilterAndSortCriteria(getCriteria(requestParams))                                   </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style="">1093                 .withStartIndex(getStartIndex(requestParams))                                            </span>
<span class="-115113180096268460" onmouseenter="enter('-115113180096268460');" onmouseout="out('-115113180096268460');" style="">1094                 .withMaxIndex(getMaxIndex(requestParams));                                               </span>
<span class="1857239787668878379" onmouseenter="enter('1857239787668878379');" onmouseout="out('1857239787668878379');" style=""><abbr title="1095         String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizeCustomCriteria()))">1095         String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizðŸ”µ</abbr></span>
<span class="8925682901439482297" onmouseenter="enter('8925682901439482297');" onmouseout="out('8925682901439482297');" style="">1096                 .toArray(String[]::new);                                                                 </span>
<span class="-226841645969872938" onmouseenter="enter('-226841645969872938');" onmouseout="out('-226841645969872938');" style="">1097         ppr = ppr.withCustomCriteria( both);                                                             </span>
<span  style="">1098                                                                                                          </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1099         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1100             ppr.setOperationTypesOverride(null);                                                         </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1101             ppr.setType(PersistencePackageRequest.Type.STANDARD);                                        </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1102             ppr.setSectionEntityField(collectionField);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1103         }                                                                                                </span>
<span  style="">1104                                                                                                          </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1105         DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                            </span>
<span  style="">1106                                                                                                          </span>
<span class="9153362413933125536" onmouseenter="enter('9153362413933125536');" onmouseout="out('9153362413933125536');" style=""><abbr title="1107         return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1107         return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1108     }                                                                                                    </span>
<span  style="">1109                                                                                                          </span>
<span class="-7439222430983038453" onmouseenter="enter('-7439222430983038453');" onmouseout="out('-7439222430983038453');" style="">1110     protected String[] buildSelectizeCustomCriteria() {                                                  </span>
<span class="-4161579644301235736" onmouseenter="enter('-4161579644301235736');" onmouseout="out('-4161579644301235736');" style="">1111         return new String[]{ IS_SELECTIZE_REQUEST };                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1112     }                                                                                                    </span>
<span  style="">1113                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1114     /**                                                                                                  </span>
<span class="-7141111024633203374" onmouseenter="enter('-7141111024633203374');" onmouseout="out('-7141111024633203374');" style="">1115      * Adds the requested collection item via Selectize                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1116      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1117      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1118      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1119      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1120      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1121      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1122      * @param collectionField                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1123      * @param entityForm                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1124      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1125      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1126      */                                                                                                  </span>
<span class="4942792763487402415" onmouseenter="enter('4942792763487402415');" onmouseout="out('4942792763487402415');" style="">1127     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize-add&quot;, method = RequestMethod.POST)     </span>
<span class="8163998475300370418" onmouseenter="enter('8163998475300370418');" onmouseout="out('8163998475300370418');" style=""><abbr title="1128     public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1128     public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpSðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1129             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1130             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1131             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1132             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1132             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-3120252458037341618" onmouseenter="enter('-3120252458037341618');" onmouseout="out('-3120252458037341618');" style="">1133         Map&lt;String, Object&gt; returnVal = new HashMap&lt;&gt;();                                                 </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1134         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1135         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1136         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1137         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1137         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1138         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1139                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1140         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1141             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1142             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1143                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1144             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1145         }                                                                                                </span>
<span  style="">1146                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1147         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1147         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style="">1148         ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                           </span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1149         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1150         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1150         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1151                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1152         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1153         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1153         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1154         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1155         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1156                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1157         if (result.hasErrors()) {                                                                        </span>
<span class="842224369260603633" onmouseenter="enter('842224369260603633');" onmouseout="out('842224369260603633');" style="">1158             returnVal.put(&quot;error&quot;, result.getFieldError());                                              </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1159             return returnVal;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1160         }                                                                                                </span>
<span  style="">1161                                                                                                          </span>
<span class="2610632867002015507" onmouseenter="enter('2610632867002015507');" onmouseout="out('2610632867002015507');" style="">1162         if (savedEntity.findProperty(ALTERNATE_ID_PROPERTY) != null) {                                   </span>
<span class="-5383740165855607078" onmouseenter="enter('-5383740165855607078');" onmouseout="out('-5383740165855607078');" style="">1163             returnVal.put(&quot;alternateId&quot;, savedEntity.findProperty(ALTERNATE_ID_PROPERTY).getValue());    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1164         }                                                                                                </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1165         return returnVal;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1166     }                                                                                                    </span>
<span  style="">1167                                                                                                          </span>
<span class="5412920841771640365" onmouseenter="enter('5412920841771640365');" onmouseout="out('5412920841771640365');" style="">1168     protected void declareShouldIgnoreAdditionStatusFilter() {                                           </span>
<span class="-4270951653865217168" onmouseenter="enter('-4270951653865217168');" onmouseout="out('-4270951653865217168');" style=""><abbr title="1169         Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().getAdditionalProperties();">1169         Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().gðŸ”µ</abbr></span>
<span class="-3723341051420574210" onmouseenter="enter('-3723341051420574210');" onmouseout="out('-3723341051420574210');" style="">1170         additionalProperties.put(&quot;shouldIgnoreAdditionStatusFilter&quot;, true);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1171     }                                                                                                    </span>
<span  style="">1172                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1173     /**                                                                                                  </span>
<span class="1325408264830379158" onmouseenter="enter('1325408264830379158');" onmouseout="out('1325408264830379158');" style="">1174      * Adds the requested collection item                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1175      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1176      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1177      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1178      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1179      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1180      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1181      * @param collectionField                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1182      * @param entityForm                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1183      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1184      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1185      */                                                                                                  </span>
<span class="-2068929988984533631" onmouseenter="enter('-2068929988984533631');" onmouseout="out('-2068929988984533631');" style="">1186     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.POST)               </span>
<span class="-6457137423768539998" onmouseenter="enter('-6457137423768539998');" onmouseout="out('-6457137423768539998');" style=""><abbr title="1187     public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1187     public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model modelðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1188             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1189             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1190             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1191             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1191             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1192         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1193         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1194         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1195         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1195         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1196         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1197                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1198         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1199             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1200             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1201                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1202             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1203         }                                                                                                </span>
<span  style="">1204                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1205         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1205         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1206         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1207         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1207         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1208                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1209         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1210         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1210         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1211         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1212         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1213                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1214         if (result.hasErrors()) {                                                                        </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1215             FieldMetadata md = collectionProperty.getMetadata();                                         </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1216             ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                             </span>
<span class="4503162777083318611" onmouseenter="enter('4503162777083318611');" onmouseout="out('4503162777083318611');" style=""><abbr title="1217             return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty,">1217             return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey,ðŸ”µ</abbr></span>
<span class="5267635088951466475" onmouseenter="enter('5267635088951466475');" onmouseout="out('5267635088951466475');" style="">1218                     md, ppr, entityForm, savedEntity);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1219         }                                                                                                </span>
<span  style="">1220                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1221         // Next, we must get the new list grid that represents this collection                           </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1222         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1222         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1223         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style="">1224                                                                                                          </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1225         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="7250522969210652718" onmouseenter="enter('7250522969210652718');" onmouseout="out('7250522969210652718');" style="">1226         model.addAttribute(&quot;actualEntityId&quot;, id);                                                        </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1227         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1228         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1229     }                                                                                                    </span>
<span  style="">1230                                                                                                          </span>
<span class="-8003545521832011894" onmouseenter="enter('-8003545521832011894');" onmouseout="out('-8003545521832011894');" style="">1231     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/addEmpty&quot;, method = RequestMethod.POST)          </span>
<span class="162700220048203938" onmouseenter="enter('162700220048203938');" onmouseout="out('162700220048203938');" style=""><abbr title="1232     public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1232     public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse reðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1233             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1234             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1235             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1236             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1236             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1237         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1238         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1239         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1240         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1240         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1241         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1242                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1243         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1244             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1245             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1246                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1247             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1248         }                                                                                                </span>
<span  style="">1249                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1250         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1250         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1251         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1251         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span class="-5337934248855825573" onmouseenter="enter('-5337934248855825573');" onmouseout="out('-5337934248855825573');" style="">1252         entity.setIsPreAdd(true);                                                                        </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1253         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1254         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1254         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1255         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span  style="">1256                                                                                                          </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1257         return new JsonResponse(response)                                                                </span>
<span class="-645443211281069037" onmouseenter="enter('-645443211281069037');" onmouseout="out('-645443211281069037');" style="">1258                 .with(&quot;status&quot;, &quot;complete&quot;)                                                              </span>
<span class="-7858493257692229655" onmouseenter="enter('-7858493257692229655');" onmouseout="out('-7858493257692229655');" style="">1259                 .with(&quot;id&quot;, savedEntity.findProperty(entityForm.getIdProperty()).getValue())             </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1260                 .done();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1261     }                                                                                                    </span>
<span  style="">1262                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1263     /**                                                                                                  </span>
<span class="-6140462241686685910" onmouseenter="enter('-6140462241686685910');" onmouseout="out('-6140462241686685910');" style=""><abbr title="1264      * Builds out all of the model information needed for showing the add modal for collection items on both the initial GET">1264      * Builds out all of the model information needed for showing the add modal for collection items on bðŸ”µ</abbr></span>
<span class="9052968863197617086" onmouseenter="enter('9052968863197617086');" onmouseout="out('9052968863197617086');" style="">1265      * as well as after a POST with validation errors                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1266      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1267      * @param request                                                                                    </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1268      * @param model                                                                                      </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1269      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1270      * @param collectionField                                                                            </span>
<span class="7403666429378321004" onmouseenter="enter('7403666429378321004');" onmouseout="out('7403666429378321004');" style="">1271      * @param sectionKey                                                                                 </span>
<span class="-7927619294366963435" onmouseenter="enter('-7927619294366963435');" onmouseout="out('-7927619294366963435');" style="">1272      * @param collectionProperty                                                                         </span>
<span class="-5426566728726502924" onmouseenter="enter('-5426566728726502924');" onmouseout="out('-5426566728726502924');" style="">1273      * @param md                                                                                         </span>
<span class="4349163197755218506" onmouseenter="enter('4349163197755218506');" onmouseout="out('4349163197755218506');" style="">1274      * @param ppr                                                                                        </span>
<span class="2094225145376343101" onmouseenter="enter('2094225145376343101');" onmouseout="out('2094225145376343101');" style="">1275      * @return the appropriate view to display for the modal                                             </span>
<span class="450948407444547835" onmouseenter="enter('450948407444547835');" onmouseout="out('450948407444547835');" style=""><abbr title="1276      * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, EntityForm, BindingResult)}">1276      * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, StringðŸ”µ</abbr></span>
<span class="3423849059172457982" onmouseenter="enter('3423849059172457982');" onmouseout="out('3423849059172457982');" style=""><abbr title="1277      * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, MultiValueMap)}">1277      * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, StðŸ”µ</abbr></span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1278      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1279      */                                                                                                  </span>
<span class="-4127331421111161450" onmouseenter="enter('-4127331421111161450');" onmouseout="out('-4127331421111161450');" style=""><abbr title="1280     protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse response,">1280     protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse responseðŸ”µ</abbr></span>
<span class="1808182660955839449" onmouseenter="enter('1808182660955839449');" onmouseout="out('1808182660955839449');" style=""><abbr title="1281             Model model, String id, String collectionField, String sectionKey, Property collectionProperty,">1281             Model model, String id, String collectionField, String sectionKey, Property collectionPropertðŸ”µ</abbr></span>
<span class="-5972908184992702659" onmouseenter="enter('-5972908184992702659');" onmouseout="out('-5972908184992702659');" style=""><abbr title="1282             FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throws ServiceException {">1282             FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throwsðŸ”µ</abbr></span>
<span  style="">1283                                                                                                          </span>
<span class="-2054675889041043286" onmouseenter="enter('-2054675889041043286');" onmouseout="out('-2054675889041043286');" style=""><abbr title="1284         // For requests to add a new collection item include the main class that the subsequent request comes from.">1284         // For requests to add a new collection item include the main class that the subsequent request cðŸ”µ</abbr></span>
<span class="7422952884503198827" onmouseenter="enter('7422952884503198827');" onmouseout="out('7422952884503198827');" style=""><abbr title="1285         // For instance, with basic collections we know the main associated class for a fetch through the ForeignKey">1285         // For instance, with basic collections we know the main associated class for a fetch through theðŸ”µ</abbr></span>
<span class="5831142982738818001" onmouseenter="enter('5831142982738818001');" onmouseout="out('5831142982738818001');" style=""><abbr title="1286         // persistence item but map and adorned target lookups make a standard persistence request. This solution">1286         // persistence item but map and adorned target lookups make a standard persistence request. This ðŸ”µ</abbr></span>
<span class="-3910081436214830376" onmouseenter="enter('-3910081436214830376');" onmouseout="out('-3910081436214830376');" style="">1287         // fixes all cases.                                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1288         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-8007514226035577536" onmouseenter="enter('-8007514226035577536');" onmouseout="out('-8007514226035577536');" style="">1289         ppr.addCustomCriteria(&quot;owningClass=&quot; + mainClassName);                                           </span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style="">1290         ppr.setAddOperationInspect(true);                                                                </span>
<span  style="">1291                                                                                                          </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1292         if (entityForm != null) {                                                                        </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1293             entityForm.clearFieldsMap();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1294         }                                                                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1295         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style="">1296         if (md instanceof BasicCollectionMetadata) {                                                     </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1297             BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                  </span>
<span  style="">1298                                                                                                          </span>
<span class="5473401195179812518" onmouseenter="enter('5473401195179812518');" onmouseout="out('5473401195179812518');" style=""><abbr title="1299             // When adding items to basic collections, we will sometimes show a form to persist a new record">1299             // When adding items to basic collections, we will sometimes show a form to persist a new recðŸ”µ</abbr></span>
<span class="3817220166052180028" onmouseenter="enter('3817220166052180028');" onmouseout="out('3817220166052180028');" style="">1300             // and sometimes show a list grid to allow the user to associate an existing record.         </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style="">1301             if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                  </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1302                 ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1302                 ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().geðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1303                 if (entityForm == null) {                                                                </span>
<span class="509426350308747164" onmouseenter="enter('509426350308747164');" onmouseout="out('509426350308747164');" style="">1304                     entityForm = formService.createEntityForm(collectionMetadata,sectionCrumbs);         </span>
<span class="2737056182573571703" onmouseenter="enter('2737056182573571703');" onmouseout="out('2737056182573571703');" style="">1305                     entityForm.setCeilingEntityClassname(ppr.getCeilingEntityClassname());               </span>
<span class="2710161406345740991" onmouseenter="enter('2710161406345740991');" onmouseout="out('2710161406345740991');" style="">1306                     entityForm.setEntityType(ppr.getCeilingEntityClassname());                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1307                 } else {                                                                                 </span>
<span class="-5799643084244932085" onmouseenter="enter('-5799643084244932085');" onmouseout="out('-5799643084244932085');" style="">1308                     formService.populateEntityForm(collectionMetadata, entityForm, sectionCrumbs);       </span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1309                     formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1310                 }                                                                                        </span>
<span class="-7315185064917392199" onmouseenter="enter('-7315185064917392199');" onmouseout="out('-7315185064917392199');" style=""><abbr title="1311                 formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntityClassname());">1311                 formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntitðŸ”µ</abbr></span>
<span class="1687533348183327340" onmouseenter="enter('1687533348183327340');" onmouseout="out('1687533348183327340');" style="">1312                 entityForm.getTabs().iterator().next().getIsVisible();                                   </span>
<span  style="">1313                                                                                                          </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1314                 model.addAttribute(&quot;entityForm&quot;, entityForm);                                            </span>
<span class="-2634442257361103125" onmouseenter="enter('-2634442257361103125');" onmouseout="out('-2634442257361103125');" style="">1315                 model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleAddEntity&quot;);                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1316             } else {                                                                                     </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1317                 DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                    </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1318                 ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1318                 ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectðŸ”µ</abbr></span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1319                 listGrid.setPathOverride(request.getRequestURL().toString());                            </span>
<span  style="">1320                                                                                                          </span>
<span class="6493773829436488040" onmouseenter="enter('6493773829436488040');" onmouseout="out('6493773829436488040');" style=""><abbr title="1321                 if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUP.equals(fmd.getAddMethodType())) {">1321                 if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUPðŸ”µ</abbr></span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1322                     listGrid.removeAllRowActions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1323                 }                                                                                        </span>
<span  style="">1324                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1325                 model.addAttribute(&quot;listGrid&quot;, listGrid);                                                </span>
<span class="-4615041483574305082" onmouseenter="enter('-4615041483574305082');" onmouseout="out('-4615041483574305082');" style="">1326                 model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleSelectEntity&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1327             }                                                                                            </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1328         } else if (md instanceof AdornedTargetCollectionMetadata) {                                      </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1329             AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                  </span>
<span  style="">1330                                                                                                          </span>
<span class="-4994014003685781795" onmouseenter="enter('-4994014003685781795');" onmouseout="out('-4994014003685781795');" style=""><abbr title="1331             // Even though this field represents an adorned target collection, the list we want to show in the modal">1331             // Even though this field represents an adorned target collection, the list we want to show iðŸ”µ</abbr></span>
<span class="3396745077097675731" onmouseenter="enter('3396745077097675731');" onmouseout="out('3396745077097675731');" style="">1332             // is the standard list grid for the target entity of this field                             </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1333             ppr.setOperationTypesOverride(null);                                                         </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1334             ppr.setType(PersistencePackageRequest.Type.STANDARD);                                        </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1335             ppr.setSectionEntityField(collectionField);                                                  </span>
<span  style="">1336                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1337             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1337             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span  style="">1338                                                                                                          </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1339             DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                        </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1340             ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1340             ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKðŸ”µ</abbr></span>
<span class="1884537605734649521" onmouseenter="enter('1884537605734649521');" onmouseout="out('1884537605734649521');" style="">1341             listGrid.setSubCollectionFieldName(collectionField);                                         </span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1342             listGrid.setPathOverride(request.getRequestURL().toString());                                </span>
<span class="2370419943178688476" onmouseenter="enter('2370419943178688476');" onmouseout="out('2370419943178688476');" style="">1343             listGrid.setFriendlyName(collectionMetadata.getPolymorphicEntities().getFriendlyName());     </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1344             if (entityForm == null) {                                                                    </span>
<span class="-1229292684052118628" onmouseenter="enter('-1229292684052118628');" onmouseout="out('-1229292684052118628');" style=""><abbr title="1345                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, true);">1345                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectiðŸ”µ</abbr></span>
<span class="-7486141420721649683" onmouseenter="enter('-7486141420721649683');" onmouseout="out('-7486141420721649683');" style=""><abbr title="1346                 entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassname());">1346                 entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassnameðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1347             } else {                                                                                     </span>
<span class="7685228187033982459" onmouseenter="enter('7685228187033982459');" onmouseout="out('7685228187033982459');" style=""><abbr title="1348                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectionCrumbs, true);">1348                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectioðŸ”µ</abbr></span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1349                 formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1350             }                                                                                            </span>
<span  style="">1351                                                                                                          </span>
<span class="5169338689637413329" onmouseenter="enter('5169338689637413329');" onmouseout="out('5169338689637413329');" style="">1352             listGrid.setListGridType(ListGrid.Type.ADORNED);                                             </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1353             for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                       </span>
<span class="8450559638200016101" onmouseenter="enter('8450559638200016101');" onmouseout="out('8450559638200016101');" style="">1354                 if (entry.getValue().getIsVisible()) {                                                   </span>
<span class="1657391013588898454" onmouseenter="enter('1657391013588898454');" onmouseout="out('1657391013588898454');" style="">1355                     listGrid.setListGridType(ListGrid.Type.ADORNED_WITH_FORM);                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1356                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1357                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1358             }                                                                                            </span>
<span  style="">1359                                                                                                          </span>
<span class="-757286675881477752" onmouseenter="enter('-757286675881477752');" onmouseout="out('-757286675881477752');" style="">1360             // This is part of an add, so we want to be able to filter/sort the listgrid                 </span>
<span class="3421525283764936758" onmouseenter="enter('3421525283764936758');" onmouseout="out('3421525283764936758');" style="">1361             listGrid.setIsSortable(false);                                                               </span>
<span class="-2714096270635703274" onmouseenter="enter('-2714096270635703274');" onmouseout="out('-2714096270635703274');" style="">1362             listGrid.setCanFilterAndSort(true);                                                          </span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1363             listGrid.removeAllRowActions();                                                              </span>
<span  style="">1364                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1365             model.addAttribute(&quot;listGrid&quot;, listGrid);                                                    </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1366             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="-1071174233767081578" onmouseenter="enter('-1071174233767081578');" onmouseout="out('-1071174233767081578');" style="">1367             model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedSelectEntity&quot;);                                 </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1368         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1369             MapMetadata fmd = (MapMetadata) md;                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1370             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1370             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span  style="">1371                                                                                                          </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1372             if (entityForm == null) {                                                                    </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style=""><abbr title="1373                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);">1373                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1374             } else {                                                                                     </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1375                 formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);</span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1376                 formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1377             }                                                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1378             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="-892500240032703395" onmouseenter="enter('-892500240032703395');" onmouseout="out('-892500240032703395');" style="">1379             model.addAttribute(&quot;viewType&quot;, &quot;modal/mapAddEntity&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1380         }                                                                                                </span>
<span  style="">1381                                                                                                          </span>
<span class="6074380392351813368" onmouseenter="enter('6074380392351813368');" onmouseout="out('6074380392351813368');" style="">1382         // Set the parent id on the entity form                                                          </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1383         if (entityForm != null) {                                                                        </span>
<span class="-3154229542834445725" onmouseenter="enter('-3154229542834445725');" onmouseout="out('-3154229542834445725');" style="">1384             entityForm.setParentId(id);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1385         }                                                                                                </span>
<span  style="">1386                                                                                                          </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1387         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="7819166863376485578" onmouseenter="enter('7819166863376485578');" onmouseout="out('7819166863376485578');" style="">1388         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_COLLECTION_ITEM.getType());            </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1389         model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1390         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1391         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1392     }                                                                                                    </span>
<span  style="">1393                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1394     /**                                                                                                  </span>
<span class="3915085583429756257" onmouseenter="enter('3915085583429756257');" onmouseout="out('3915085583429756257');" style="">1395      * Shows the appropriate modal dialog to edit the selected collection item                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1396      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1397      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1398      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1399      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1400      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1401      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1402      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1403      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1404      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1405      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1406      */                                                                                                  </span>
<span class="5941881897199209931" onmouseenter="enter('5941881897199209931');" onmouseout="out('5941881897199209931');" style=""><abbr title="1407     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.GET)">1407     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style=""><abbr title="1408     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1408     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, ModeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1409             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1410             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1411             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1412             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1413             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1414         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1414         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1415                 ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1416     }                                                                                                    </span>
<span  style="">1417                                                                                                          </span>
<span class="-3777402830265989862" onmouseenter="enter('-3777402830265989862');" onmouseout="out('-3777402830265989862');" style="">1418     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.GET) </span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style=""><abbr title="1419     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1419     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, ModeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1420             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1421             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1422             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1423             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="7585768018133278114" onmouseenter="enter('7585768018133278114');" onmouseout="out('7585768018133278114');" style=""><abbr title="1424         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1424         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1425                 ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1426     }                                                                                                    </span>
<span  style="">1427                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1428     /**                                                                                                  </span>
<span class="6761933478321573145" onmouseenter="enter('6761933478321573145');" onmouseout="out('6761933478321573145');" style=""><abbr title="1429      * Shows the appropriate modal dialog to view the selected collection item. This will display the modal as readonly">1429      * Shows the appropriate modal dialog to view the selected collection item. This will display the modðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1430      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1431      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1432      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1433      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1434      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1435      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1436      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1437      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1438      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1439      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1440      */                                                                                                  </span>
<span class="5228464490364608791" onmouseenter="enter('5228464490364608791');" onmouseout="out('5228464490364608791');" style=""><abbr title="1441     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = RequestMethod.GET)">1441     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = ðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style=""><abbr title="1442     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1442     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model ðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1443             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1444             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1445             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1446             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1447             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="7887850161668822106" onmouseenter="enter('7887850161668822106');" onmouseout="out('7887850161668822106');" style=""><abbr title="1448         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1448         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, colleðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1449                 ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                         </span>
<span  style="">1450                                                                                                          </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1451         // Since this is a read-only view, actions don&#x27;t make sense in this context                      </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1452         EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                    </span>
<span class="7289613241506142720" onmouseenter="enter('7289613241506142720');" onmouseout="out('7289613241506142720');" style="">1453         addAuditableDisplayFields(ef);                                                                   </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1454         ef.removeAllActions();                                                                           </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1455         ef.setReadOnly();                                                                                </span>
<span  style="">1456                                                                                                          </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1457         return returnPath;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1458     }                                                                                                    </span>
<span  style="">1459                                                                                                          </span>
<span class="6858008221927215769" onmouseenter="enter('6858008221927215769');" onmouseout="out('6858008221927215769');" style=""><abbr title="1460     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.GET)">1460     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.ðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style=""><abbr title="1461     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1461     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model ðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1462             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1463             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1464             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1465             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="2521791674908842244" onmouseenter="enter('2521791674908842244');" onmouseout="out('2521791674908842244');" style=""><abbr title="1466         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1466         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, colleðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1467                 ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                         </span>
<span  style="">1468                                                                                                          </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1469         // Since this is a read-only view, actions don&#x27;t make sense in this context                      </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1470         EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                    </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1471         ef.removeAllActions();                                                                           </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1472         ef.setReadOnly();                                                                                </span>
<span  style="">1473                                                                                                          </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1474         return returnPath;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1475     }                                                                                                    </span>
<span  style="">1476                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1477     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1477     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="6852009337058352330" onmouseenter="enter('6852009337058352330');" onmouseout="out('6852009337058352330');" style=""><abbr title="1478             String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType) throws ServiceException {">1478             String id, String collectionField, String collectionItemId, String alternateId, String modalHðŸ”µ</abbr></span>
<span class="-2699953653458232908" onmouseenter="enter('-2699953653458232908');" onmouseout="out('-2699953653458232908');" style=""><abbr title="1479         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId, modalHeaderType, null, null);">1479         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1480     }                                                                                                    </span>
<span  style="">1481                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1482     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1482     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="-3706011950121400951" onmouseenter="enter('-3706011950121400951');" onmouseout="out('-3706011950121400951');" style=""><abbr title="1483             String id, String collectionField, String collectionItemId, String modalHeaderType) throws ServiceException {">1483             String id, String collectionField, String collectionItemId, String modalHeaderType) throws SeðŸ”µ</abbr></span>
<span class="-6899013896128397577" onmouseenter="enter('-6899013896128397577');" onmouseout="out('-6899013896128397577');" style=""><abbr title="1484         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, null, null);">1484         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1485     }                                                                                                    </span>
<span  style="">1486                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1487     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1487     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="4852573692087282601" onmouseenter="enter('4852573692087282601');" onmouseout="out('4852573692087282601');" style=""><abbr title="1488                 String id, String collectionField, String collectionItemId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1488                 String id, String collectionField, String collectionItemId, String modalHeaderType, EntitðŸ”µ</abbr></span>
<span class="6580107021722154279" onmouseenter="enter('6580107021722154279');" onmouseout="out('6580107021722154279');" style=""><abbr title="1489         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, entityForm, entity);">1489         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1490     }                                                                                                    </span>
<span  style="">1491                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1492     /**                                                                                                  </span>
<span class="837861132196545598" onmouseenter="enter('837861132196545598');" onmouseout="out('837861132196545598');" style=""><abbr title="1493      * Shows the view and populates the model for updating a collection item. You can also pass in an entityform and entity">1493      * Shows the view and populates the model for updating a collection item. You can also pass in an entðŸ”µ</abbr></span>
<span class="5643306329084644224" onmouseenter="enter('5643306329084644224');" onmouseout="out('5643306329084644224');" style="">1494      * which are optional. If they are not passed in then they are automatically looked up               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1495      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1496      * @param request                                                                                    </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1497      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1498      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1499      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1500      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1501      * @param collectionItemId                                                                           </span>
<span class="-5929844173285242940" onmouseenter="enter('-5929844173285242940');" onmouseout="out('-5929844173285242940');" style="">1502      * @param modalHeaderType                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1503      * @param entityForm                                                                                 </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style="">1504      * @param entity                                                                                     </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">1505      * @return                                                                                           </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1506      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1507      */                                                                                                  </span>
<span class="-7113907340183053787" onmouseenter="enter('-7113907340183053787');" onmouseout="out('-7113907340183053787');" style="">1508     protected String showViewUpdateCollection(HttpServletRequest request,                                </span>
<span class="-8519940996091909282" onmouseenter="enter('-8519940996091909282');" onmouseout="out('-8519940996091909282');" style="">1509             Model model,                                                                                 </span>
<span class="233550986134862533" onmouseenter="enter('233550986134862533');" onmouseout="out('233550986134862533');" style="">1510             Map&lt;String, String&gt; pathVars,                                                                </span>
<span class="462404651577214798" onmouseenter="enter('462404651577214798');" onmouseout="out('462404651577214798');" style="">1511             String id,                                                                                   </span>
<span class="-5551105944774799057" onmouseenter="enter('-5551105944774799057');" onmouseout="out('-5551105944774799057');" style="">1512             String collectionField,                                                                      </span>
<span class="-7138244874257810737" onmouseenter="enter('-7138244874257810737');" onmouseout="out('-7138244874257810737');" style="">1513             String collectionItemId,                                                                     </span>
<span class="7426253478403504017" onmouseenter="enter('7426253478403504017');" onmouseout="out('7426253478403504017');" style="">1514             String alternateId,                                                                          </span>
<span class="2900696252953040190" onmouseenter="enter('2900696252953040190');" onmouseout="out('2900696252953040190');" style="">1515             String modalHeaderType,                                                                      </span>
<span class="5597094285729719755" onmouseenter="enter('5597094285729719755');" onmouseout="out('5597094285729719755');" style="">1516             EntityForm entityForm,                                                                       </span>
<span class="3632664887850253049" onmouseenter="enter('3632664887850253049');" onmouseout="out('3632664887850253049');" style="">1517             Entity entity) throws ServiceException {                                                     </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1518         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1519         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1520         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1521         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1521         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1522         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1523         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-2889762407992276786" onmouseenter="enter('-2889762407992276786');" onmouseout="out('-2889762407992276786');" style="">1524         SectionCrumb nextCrumb = new SectionCrumb();                                                     </span>
<span class="4180533444018328805" onmouseenter="enter('4180533444018328805');" onmouseout="out('4180533444018328805');" style="">1525         if (md instanceof MapMetadata) {                                                                 </span>
<span class="-382349485821163458" onmouseenter="enter('-382349485821163458');" onmouseout="out('-382349485821163458');" style="">1526             nextCrumb.setSectionIdentifier(((MapMetadata) md).getValueClassName());                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1527         } else {                                                                                         </span>
<span class="1919475910220989527" onmouseenter="enter('1919475910220989527');" onmouseout="out('1919475910220989527');" style="">1528             nextCrumb.setSectionIdentifier(((CollectionMetadata) md).getCollectionCeilingEntity());      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1529         }                                                                                                </span>
<span class="3745082800889494172" onmouseenter="enter('3745082800889494172');" onmouseout="out('3745082800889494172');" style="">1530         nextCrumb.setSectionId(collectionItemId);                                                        </span>
<span class="7047611651117816234" onmouseenter="enter('7047611651117816234');" onmouseout="out('7047611651117816234');" style="">1531         if (!sectionCrumbs.contains(nextCrumb)) {                                                        </span>
<span class="-6316688126111539901" onmouseenter="enter('-6316688126111539901');" onmouseout="out('-6316688126111539901');" style="">1532             sectionCrumbs.add(nextCrumb);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1533         }                                                                                                </span>
<span  style="">1534                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1535         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1535         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1536         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1536         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getReðŸ”µ</abbr></span>
<span  style="">1537                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1538         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span  style="">1539                                                                                                          </span>
<span class="4300500518149699432" onmouseenter="enter('4300500518149699432');" onmouseout="out('4300500518149699432');" style="">1540         if (md instanceof BasicCollectionMetadata &amp;&amp;                                                     </span>
<span class="3179311364823579995" onmouseenter="enter('3179311364823579995');" onmouseout="out('3179311364823579995');" style="">1541                 (((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST) ||      </span>
<span class="-5057368181444983975" onmouseenter="enter('-5057368181444983975');" onmouseout="out('-5057368181444983975');" style=""><abbr title="1542                         ((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST_EMPTY))) {">1542                         ((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST_EMðŸ”µ</abbr></span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1543             BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                  </span>
<span  style="">1544                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1545             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1545             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1546             if (entity == null) {                                                                        </span>
<span class="4597721164047448054" onmouseenter="enter('4597721164047448054');" onmouseout="out('4597721164047448054');" style=""><abbr title="1547                 entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResultSet().getRecords()[0];">1547                 entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1548             }                                                                                            </span>
<span  style="">1549                                                                                                          </span>
<span class="-7942197356638317765" onmouseenter="enter('-7942197356638317765');" onmouseout="out('-7942197356638317765');" style="">1550             String currentTabName = getCurrentTabName(pathVars, collectionMetadata);                     </span>
<span class="9017537031938626444" onmouseenter="enter('9017537031938626444');" onmouseout="out('9017537031938626444');" style=""><abbr title="1551             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetadata, entity, sectionCrumbs, currentTabName);">1551             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetaðŸ”µ</abbr></span>
<span  style="">1552                                                                                                          </span>
<span class="348957922752701667" onmouseenter="enter('348957922752701667');" onmouseout="out('348957922752701667');" style="">1553             entityForm = reinitializeEntityForm(entityForm, collectionMetadata, entity,                  </span>
<span class="-6666340752275266103" onmouseenter="enter('-6666340752275266103');" onmouseout="out('-6666340752275266103');" style="">1554                     subRecordsMap, sectionCrumbs);                                                       </span>
<span  style="">1555                                                                                                          </span>
<span class="-3892497188964586657" onmouseenter="enter('-3892497188964586657');" onmouseout="out('-3892497188964586657');" style="">1556             entityForm.removeAction(DefaultEntityFormActions.DELETE);                                    </span>
<span class="6748640999540281749" onmouseenter="enter('6748640999540281749');" onmouseout="out('6748640999540281749');" style="">1557             entityForm.removeAction(DefaultEntityFormActions.DUPLICATE);                                 </span>
<span  style="">1558                                                                                                          </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1559             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1560             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="2070483683171714322" onmouseenter="enter('2070483683171714322');" onmouseout="out('2070483683171714322');" style="">1561             model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleEditEntity&quot;);                                    </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1562         } else if (md instanceof AdornedTargetCollectionMetadata) {                                      </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1563             AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                  </span>
<span  style="">1564                                                                                                          </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1565             if (entity == null) {                                                                        </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style=""><abbr title="1566                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,">1566                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperðŸ”µ</abbr></span>
<span class="-2961516840614790290" onmouseenter="enter('-2961516840614790290');" onmouseout="out('-2961516840614790290');" style="">1567                     collectionItemId, sectionCrumbs, alternateId).getDynamicResultSet().getRecords()[0]; </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1568             }                                                                                            </span>
<span  style="">1569                                                                                                          </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1570             boolean populateTypeAndId = true;                                                            </span>
<span class="921756716374353809" onmouseenter="enter('921756716374353809');" onmouseout="out('921756716374353809');" style=""><abbr title="1571             boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaderType);">1571             boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1572             if (entityForm == null) {                                                                    </span>
<span class="-8902040329002931298" onmouseenter="enter('-8902040329002931298');" onmouseout="out('-8902040329002931298');" style=""><abbr title="1573                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, sectionCrumbs, false);">1573                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollecðŸ”µ</abbr></span>
<span class="-4655192855930300298" onmouseenter="enter('-4655192855930300298');" onmouseout="out('-4655192855930300298');" style="">1574                 entityForm.removeAction(DefaultAdornedEntityFormActions.Add);                            </span>
<span class="1109271490036416226" onmouseenter="enter('1109271490036416226');" onmouseout="out('1109271490036416226');" style="">1575                 entityForm.addAction(DefaultAdornedEntityFormActions.Save);                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1576             } else {                                                                                     </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1577                 entityForm.clearFieldsMap();                                                             </span>
<span class="2583214667713512490" onmouseenter="enter('2583214667713512490');" onmouseout="out('2583214667713512490');" style="">1578                 String entityType = entityForm.getEntityType();                                          </span>
<span class="-6584758178229470245" onmouseenter="enter('-6584758178229470245');" onmouseout="out('-6584758178229470245');" style=""><abbr title="1579                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entityForm, sectionCrumbs, false);">1579                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entðŸ”µ</abbr></span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style="">1580                 entityForm.setEntityType(entityType);                                                    </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1581                 populateTypeAndId = false;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1582             }                                                                                            </span>
<span  style="">1583                                                                                                          </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1584             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title="1585             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,">1585             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, maðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style="">1586                     collectionField,                                                                     </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style="">1587                     collectionItemId, responseMap);                                                      </span>
<span  style="">1588                                                                                                          </span>
<span class="-3972135447881278836" onmouseenter="enter('-3972135447881278836');" onmouseout="out('-3972135447881278836');" style=""><abbr title="1589             //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and Id is used.">1589             //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and ðŸ”µ</abbr></span>
<span class="-8007896595560301001" onmouseenter="enter('-8007896595560301001');" onmouseout="out('-8007896595560301001');" style=""><abbr title="1590             //It should be the entity and referenced Id of the adorned entity (not the target entity and Id).">1590             //It should be the entity and referenced Id of the adorned entity (not the target entity and ðŸ”µ</abbr></span>
<span class="316997016312344867" onmouseenter="enter('316997016312344867');" onmouseout="out('316997016312344867');" style="">1591             entityForm.setTranslationCeilingEntity(entityForm.getEntityType());                          </span>
<span class="-4512360180775881719" onmouseenter="enter('-4512360180775881719');" onmouseout="out('-4512360180775881719');" style="">1592             entityForm.setTranslationId(alternateId);                                                    </span>
<span  style="">1593                                                                                                          </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style="">1594             ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();  </span>
<span class="-1465905251928147670" onmouseenter="enter('-1465905251928147670');" onmouseout="out('-1465905251928147670');" style="">1595             for (String field : fmd.getMaintainedAdornedTargetFields()) {                                </span>
<span class="-2821179418575098708" onmouseenter="enter('-2821179418575098708');" onmouseout="out('-2821179418575098708');" style="">1596                 if (responseMap.containsKey(field) &amp;&amp; responseMap.containsKey(&quot;autoSubmit&quot;)) {           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1597                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1598                 }                                                                                        </span>
<span class="-3390991397790942785" onmouseenter="enter('-3390991397790942785');" onmouseout="out('-3390991397790942785');" style="">1599                 Property p = cmd.getPMap().get(field);                                                   </span>
<span class="3110636146594998978" onmouseenter="enter('3110636146594998978');" onmouseout="out('3110636146594998978');" style="">1600                 if (p != null &amp;&amp; p.getMetadata() instanceof AdornedTargetCollectionMetadata) {           </span>
<span class="-1526293730221303684" onmouseenter="enter('-1526293730221303684');" onmouseout="out('-1526293730221303684');" style=""><abbr title="1601                     // Because we&#x27;re dealing with a nested adorned target collection, this particular request must act">1601                     // Because we&#x27;re dealing with a nested adorned target collection, this particular reqðŸ”µ</abbr></span>
<span class="5008429970050276114" onmouseenter="enter('5008429970050276114');" onmouseout="out('5008429970050276114');" style=""><abbr title="1602                     // directly on the first adorned target collection. Because of this, we need the actual id property">1602                     // directly on the first adorned target collection. Because of this, we need the actuðŸ”µ</abbr></span>
<span class="-7713892716328274330" onmouseenter="enter('-7713892716328274330');" onmouseout="out('-7713892716328274330');" style=""><abbr title="1603                     // from the entity that models the adorned target relationship, and not the id of the target object.">1603                     // from the entity that models the adorned target relationship, and not the id of theðŸ”µ</abbr></span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1604                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1604                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style=""><abbr title="1605                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,">1605                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, nuðŸ”µ</abbr></span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1606                             alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();        </span>
<span  style="">1607                                                                                                          </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1608                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1608                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(ðŸ”µ</abbr></span>
<span class="-6504403122086949696" onmouseenter="enter('-6504403122086949696');" onmouseout="out('-6504403122086949696');" style="">1609                             ppr.getAdornedList().getAdornedTargetEntityClassname(), sectionCrumbs);      </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1610                     listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                        </span>
<span  style="">1611                                                                                                          </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1612                     if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {       </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1613                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1613                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1614                     } else {                                                                             </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1615                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1615                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1616                     }                                                                                    </span>
<span class="2712626054905490038" onmouseenter="enter('2712626054905490038');" onmouseout="out('2712626054905490038');" style="">1617                 } else if (p != null &amp;&amp; p.getMetadata() instanceof MapMetadata) {                        </span>
<span class="-388196981394792667" onmouseenter="enter('-388196981394792667');" onmouseout="out('-388196981394792667');" style="">1618                     // See above comment for AdornedTargetCollectionMetadata                             </span>
<span class="-9194902891343883685" onmouseenter="enter('-9194902891343883685');" onmouseout="out('-9194902891343883685');" style="">1619                     MapMetadata mmd = (MapMetadata) p.getMetadata();                                     </span>
<span  style="">1620                                                                                                          </span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1621                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1621                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style=""><abbr title="1622                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,">1622                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, nuðŸ”µ</abbr></span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1623                             alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();        </span>
<span  style="">1624                                                                                                          </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1625                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1625                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(ðŸ”µ</abbr></span>
<span class="-6515044965274807025" onmouseenter="enter('-6515044965274807025');" onmouseout="out('-6515044965274807025');" style="">1626                             mmd.getTargetClass(), sectionCrumbs);                                        </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1627                     listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                        </span>
<span  style="">1628                                                                                                          </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1629                     if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {       </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1630                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1630                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1631                     } else {                                                                             </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1632                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1632                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1633                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1634                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1635             }                                                                                            </span>
<span  style="">1636                                                                                                          </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style=""><abbr title="1637             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);">1637             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndIdðŸ”µ</abbr></span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1638             formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());       </span>
<span  style="">1639                                                                                                          </span>
<span class="7046829326366784672" onmouseenter="enter('7046829326366784672');" onmouseout="out('7046829326366784672');" style="">1640             boolean atLeastOneBasicField = false;                                                        </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1641             for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                       </span>
<span class="-3942382004211496115" onmouseenter="enter('-3942382004211496115');" onmouseout="out('-3942382004211496115');" style=""><abbr title="1642                 if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName()) &amp;&amp; !responseMap.containsKey(&quot;autoSubmit&quot;)) {">1642                 if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName(ðŸ”µ</abbr></span>
<span class="3115307772764059490" onmouseenter="enter('3115307772764059490');" onmouseout="out('3115307772764059490');" style="">1643                     atLeastOneBasicField = true;                                                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1644                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1645                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1646             }                                                                                            </span>
<span class="4813170790944841786" onmouseenter="enter('4813170790944841786');" onmouseout="out('4813170790944841786');" style="">1647             if (!atLeastOneBasicField) {                                                                 </span>
<span class="3364274495995556597" onmouseenter="enter('3364274495995556597');" onmouseout="out('3364274495995556597');" style="">1648                 entityForm.removeAction(DefaultEntityFormActions.SAVE);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1649             }                                                                                            </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1650             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1651             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="3009851293217081678" onmouseenter="enter('3009851293217081678');" onmouseout="out('3009851293217081678');" style="">1652             model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedEditEntity&quot;);                                   </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1653         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1654             MapMetadata fmd = (MapMetadata) md;                                                          </span>
<span  style="">1655                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1656             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1656             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1657             if (entity == null) {                                                                        </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style=""><abbr title="1658                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,">1658                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperðŸ”µ</abbr></span>
<span class="-2813813427236819301" onmouseenter="enter('-2813813427236819301');" onmouseout="out('-2813813427236819301');" style="">1659                     collectionItemId, sectionCrumbs, null).getEntity();                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1660             }                                                                                            </span>
<span  style="">1661                                                                                                          </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1662             boolean populateTypeAndId = true;                                                            </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1663             if (entityForm == null) {                                                                    </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style=""><abbr title="1664                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);">1664                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1665             } else {                                                                                     </span>
<span class="-2965751497501930249" onmouseenter="enter('-2965751497501930249');" onmouseout="out('-2965751497501930249');" style="">1666                 //save off the prior key before clearing out the fields map as it will not appear        </span>
<span class="-4459883460939835415" onmouseenter="enter('-4459883460939835415');" onmouseout="out('-4459883460939835415');" style="">1667                 //back on the saved entity                                                               </span>
<span class="-8617997777962995342" onmouseenter="enter('-8617997777962995342');" onmouseout="out('-8617997777962995342');" style="">1668                 String priorKey = entityForm.findField(&quot;priorKey&quot;).getValue();                           </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1669                 entityForm.clearFieldsMap();                                                             </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1670                 formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);</span>
<span class="-5674534809018144237" onmouseenter="enter('-5674534809018144237');" onmouseout="out('-5674534809018144237');" style="">1671                 entityForm.findField(&quot;priorKey&quot;).setValue(priorKey);                                     </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1672                 populateTypeAndId = false;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1673             }                                                                                            </span>
<span  style="">1674                                                                                                          </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style=""><abbr title="1675             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);">1675             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndIdðŸ”µ</abbr></span>
<span class="-7934209705949108459" onmouseenter="enter('-7934209705949108459');" onmouseout="out('-7934209705949108459');" style="">1676             formService.populateMapEntityFormFields(entityForm, entity);                                 </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1677             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1678             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="5184741693677662709" onmouseenter="enter('5184741693677662709');" onmouseout="out('5184741693677662709');" style="">1679             model.addAttribute(&quot;viewType&quot;, &quot;modal/mapEditEntity&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1680         }                                                                                                </span>
<span  style="">1681                                                                                                          </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1682         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="5715532112666019496" onmouseenter="enter('5715532112666019496');" onmouseout="out('5715532112666019496');" style="">1683         model.addAttribute(&quot;modalHeaderType&quot;, modalHeaderType);                                          </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1684         model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1685         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1686         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1687     }                                                                                                    </span>
<span  style="">1688                                                                                                          </span>
<span class="-6629135688250429856" onmouseenter="enter('-6629135688250429856');" onmouseout="out('-6629135688250429856');" style="">1689     protected EntityForm reinitializeEntityForm(final EntityForm entityForm,                             </span>
<span class="2488527282562212871" onmouseenter="enter('2488527282562212871');" onmouseout="out('2488527282562212871');" style="">1690             final ClassMetadata collectionMetadata,                                                      </span>
<span class="6244041270191906475" onmouseenter="enter('6244041270191906475');" onmouseout="out('6244041270191906475');" style="">1691             final Entity entity,                                                                         </span>
<span class="4210642227221008869" onmouseenter="enter('4210642227221008869');" onmouseout="out('4210642227221008869');" style="">1692             final Map&lt;String, DynamicResultSet&gt; subRecordsMap,                                           </span>
<span class="7695373887778905827" onmouseenter="enter('7695373887778905827');" onmouseout="out('7695373887778905827');" style="">1693             final List&lt;SectionCrumb&gt; sectionCrumbs) throws ServiceException {                            </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1694         if (entityForm == null) {                                                                        </span>
<span class="5007761642077021691" onmouseenter="enter('5007761642077021691');" onmouseout="out('5007761642077021691');" style="">1695             return formService                                                                           </span>
<span class="2427987523723463928" onmouseenter="enter('2427987523723463928');" onmouseout="out('2427987523723463928');" style="">1696                     .createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbs);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1697         }                                                                                                </span>
<span  style="">1698                                                                                                          </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1699         entityForm.clearFieldsMap();                                                                     </span>
<span class="524385531586817703" onmouseenter="enter('524385531586817703');" onmouseout="out('524385531586817703');" style="">1700         formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm,            </span>
<span class="2971672777452209099" onmouseenter="enter('2971672777452209099');" onmouseout="out('2971672777452209099');" style="">1701                 sectionCrumbs);                                                                          </span>
<span class="5496760487980360743" onmouseenter="enter('5496760487980360743');" onmouseout="out('5496760487980360743');" style="">1702         //remove all the actions since we&#x27;re not trying to redisplay them on the form                    </span>
<span class="-6469844840195102556" onmouseenter="enter('-6469844840195102556');" onmouseout="out('-6469844840195102556');" style="">1703         entityForm.removeAllActions();                                                                   </span>
<span  style="">1704                                                                                                          </span>
<span class="6548609876597156982" onmouseenter="enter('6548609876597156982');" onmouseout="out('6548609876597156982');" style="">1705         return entityForm;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1706     }                                                                                                    </span>
<span  style="">1707                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1708     /**                                                                                                  </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1709      * Updates the specified collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1710      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1711      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1712      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1713      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1714      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1715      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1716      * @param collectionField                                                                            </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1717      * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1717      * @param collectionItemId the collection primary key value (in the case of adorned target collectionðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1718      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1719      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1720      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1721      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1722      */                                                                                                  </span>
<span class="1690395709289479208" onmouseenter="enter('1690395709289479208');" onmouseout="out('1690395709289479208');" style="">1723     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.POST)</span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style=""><abbr title="1724     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1724     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1725             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1726             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1727             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1728             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1729             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                   </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1730             BindingResult result) throws Exception {                                                     </span>
<span class="454845068344591329" onmouseenter="enter('454845068344591329');" onmouseout="out('454845068344591329');" style=""><abbr title="1731         return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, entityForm, null, result);">1731         return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1732     }                                                                                                    </span>
<span  style="">1733                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1734     /**                                                                                                  </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1735      * Updates the specified collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1736      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1737      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1738      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1739      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1740      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1741      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1742      * @param collectionField                                                                            </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1743      * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1743      * @param collectionItemId the collection primary key value (in the case of adorned target collectionðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1744      * @param entityForm                                                                                 </span>
<span class="4031667150854181086" onmouseenter="enter('4031667150854181086');" onmouseout="out('4031667150854181086');" style=""><abbr title="1745      * @param alternateId in the case of adorned target collections, this is the primary key value of the collection member">1745      * @param alternateId in the case of adorned target collections, this is the primary key value of theðŸ”µ</abbr></span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1746      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1747      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1748      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1749      */                                                                                                  </span>
<span class="6716233350399381715" onmouseenter="enter('6716233350399381715');" onmouseout="out('6716233350399381715');" style=""><abbr title="1750     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.POST)">1750     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style=""><abbr title="1751     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1751     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1752             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1753             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1754             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1755             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1756             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                   </span>
<span class="-5366992345424767315" onmouseenter="enter('-5366992345424767315');" onmouseout="out('-5366992345424767315');" style="">1757             @PathVariable(value=&quot;alternateId&quot;) String alternateId,                                       </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1758             BindingResult result) throws Exception {                                                     </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1759         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1760         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1761         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1762         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1762         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1763         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1764                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1765         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1765         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1766         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1766         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1767                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1768         // First, we must save the collection entity                                                     </span>
<span class="3262117580653454816" onmouseenter="enter('3262117580653454816');" onmouseout="out('3262117580653454816');" style=""><abbr title="1769         PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, collectionItemId, alternateId, sectionCrumbs);">1769         PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1770         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1771         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1772                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1773         if (result.hasErrors()) {                                                                        </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1774             return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1774             return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemðŸ”µ</abbr></span>
<span class="-1009973048758571460" onmouseenter="enter('-1009973048758571460');" onmouseout="out('-1009973048758571460');" style="">1775                     ModalHeaderType.UPDATE_COLLECTION_ITEM.getType(), entityForm, savedEntity);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1776         }                                                                                                </span>
<span  style="">1777                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1778         // Next, we must get the new list grid that represents this collection                           </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1779         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1780         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1780         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span  style="">1781                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1782         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1783         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1784         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1785         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1786     }                                                                                                    </span>
<span  style="">1787                                                                                                          </span>
<span class="-2715204734461845190" onmouseenter="enter('-2715204734461845190');" onmouseout="out('-2715204734461845190');" style=""><abbr title="1788     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMethod.POST)">1788     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMetðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1789     public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,    </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1790             HttpServletResponse response, Model model,                                                   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1791             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1792             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1793             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1794             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="6458961487045284345" onmouseenter="enter('6458961487045284345');" onmouseout="out('6458961487045284345');" style="">1795             @RequestParam(value=&quot;newSequence&quot;) String newSequence) throws Exception {                    </span>
<span class="-6477101312884008952" onmouseenter="enter('-6477101312884008952');" onmouseout="out('-6477101312884008952');" style=""><abbr title="1796         return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collectionItemId, newSequence, null);">1796         return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1797     }                                                                                                    </span>
<span  style="">1798                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1799     /**                                                                                                  </span>
<span class="-7447609122613552365" onmouseenter="enter('-7447609122613552365');" onmouseout="out('-7447609122613552365');" style=""><abbr title="1800      * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target collections">1800      * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target colðŸ”µ</abbr></span>
<span class="5163972519999742424" onmouseenter="enter('5163972519999742424');" onmouseout="out('5163972519999742424');" style=""><abbr title="1801      * where a sort field is specified -- any other invocation is incorrect and will result in an exception.">1801      * where a sort field is specified -- any other invocation is incorrect and will result in an exceptiðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1802      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1803      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1804      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1805      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1806      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1807      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1808      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1809      * @param collectionItemId                                                                           </span>
<span class="8542418631474543845" onmouseenter="enter('8542418631474543845');" onmouseout="out('8542418631474543845');" style="">1810      * @return an object explaining the state of the operation                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1811      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1812      */                                                                                                  </span>
<span class="1279723180837283801" onmouseenter="enter('1279723180837283801');" onmouseout="out('1279723180837283801');" style=""><abbr title="1813     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, method = RequestMethod.POST)">1813     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, methoðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1814     public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,    </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1815             HttpServletResponse response, Model model,                                                   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1816             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1817             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1818             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1819             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="6744719432735700494" onmouseenter="enter('6744719432735700494');" onmouseout="out('6744719432735700494');" style="">1820             @RequestParam(value=&quot;newSequence&quot;) String newSequence,                                       </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1821             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1822         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1823         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1824         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1825         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1825         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1826         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1827         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style="">1828                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1829         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1829         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="6971869165316675737" onmouseenter="enter('6971869165316675737');" onmouseout="out('6971869165316675737');" style="">1830         ppr.addCustomCriteria(&quot;reorderParentEntityFetch&quot;);                                               </span>
<span  style="">1831                                                                                                          </span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1832         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1832         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getReðŸ”µ</abbr></span>
<span  style="">1833                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1834         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span  style="">1835                                                                                                          </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1836         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1837             AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                  </span>
<span class="-895931586936599512" onmouseenter="enter('-895931586936599512');" onmouseout="out('-895931586936599512');" style="">1838             AdornedTargetList atl = ppr.getAdornedList();                                                </span>
<span  style="">1839                                                                                                          </span>
<span class="4013888246220668443" onmouseenter="enter('4013888246220668443');" onmouseout="out('4013888246220668443');" style="">1840             // Get an entity form for the entity                                                         </span>
<span class="4144133685169635892" onmouseenter="enter('4144133685169635892');" onmouseout="out('4144133685169635892');" style=""><abbr title="1841             EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, false);">1841             EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, falseðŸ”µ</abbr></span>
<span class="985151044669117950" onmouseenter="enter('985151044669117950');" onmouseout="out('985151044669117950');" style=""><abbr title="1842             Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,">1842             Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProðŸ”µ</abbr></span>
<span class="-4422231398086337832" onmouseenter="enter('-4422231398086337832');" onmouseout="out('-4422231398086337832');" style=""><abbr title="1843                     collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;})">1843                     collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;}ðŸ”µ</abbr></span>
<span class="-7850695853310911802" onmouseenter="enter('-7850695853310911802');" onmouseout="out('-7850695853310911802');" style="">1844                     .getDynamicResultSet().getRecords()[0];                                              </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1845             formService.populateEntityFormFields(entityForm, entity);                                    </span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1846             formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());       </span>
<span  style="">1847                                                                                                          </span>
<span class="-3124065187694573478" onmouseenter="enter('-3124065187694573478');" onmouseout="out('-3124065187694573478');" style=""><abbr title="1848             // Set the new sequence (note that it will come in 0-indexed but the persistence module expects 1-indexed)">1848             // Set the new sequence (note that it will come in 0-indexed but the persistence module expecðŸ”µ</abbr></span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1849             int sequenceValue = Integer.parseInt(newSequence) + 1;                                       </span>
<span class="2556919505341751863" onmouseenter="enter('2556919505341751863');" onmouseout="out('2556919505341751863');" style="">1850             Field field = entityForm.findField(atl.getSortField());                                      </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1851             field.setValue(String.valueOf(sequenceValue));                                               </span>
<span  style="">1852                                                                                                          </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1853             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="-5669538829732150992" onmouseenter="enter('-5669538829732150992');" onmouseout="out('-5669538829732150992');" style=""><abbr title="1854             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, alternateId, sectionCrumbs);">1854             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMðŸ”µ</abbr></span>
<span class="-6209319883391535282" onmouseenter="enter('-6209319883391535282');" onmouseout="out('-6209319883391535282');" style="">1855             Property displayOrder = persistenceResponse.getEntity().findProperty(atl.getSortField());    </span>
<span  style="">1856                                                                                                          </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1857             responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                             </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1858             responseMap.put(&quot;field&quot;, collectionField);                                                   </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1859             responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());   </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1860             return responseMap;                                                                          </span>
<span class="-3117865694677500361" onmouseenter="enter('-3117865694677500361');" onmouseout="out('-3117865694677500361');" style="">1861         } else if (md instanceof BasicCollectionMetadata) {                                              </span>
<span class="-8492572584837651214" onmouseenter="enter('-8492572584837651214');" onmouseout="out('-8492572584837651214');" style="">1862             BasicCollectionMetadata cd = (BasicCollectionMetadata) md;                                   </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1863             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="-2546552603594507996" onmouseenter="enter('-2546552603594507996');" onmouseout="out('-2546552603594507996');" style=""><abbr title="1864             Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1864             Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResulðŸ”µ</abbr></span>
<span  style="">1865                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1866             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1866             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="-2818097934143266938" onmouseenter="enter('-2818097934143266938');" onmouseout="out('-2818097934143266938');" style="">1867             EntityForm entityForm = formService.createEntityForm(collectionMetadata, sectionCrumbs);     </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1868             if (!StringUtils.isEmpty(cd.getSortProperty())) {                                            </span>
<span class="-6303462610985739492" onmouseenter="enter('-6303462610985739492');" onmouseout="out('-6303462610985739492');" style="">1869                 Field f = new Field()                                                                    </span>
<span class="-2538063021289876061" onmouseenter="enter('-2538063021289876061');" onmouseout="out('-2538063021289876061');" style="">1870                         .withName(cd.getSortProperty())                                                  </span>
<span class="-2458072313875538806" onmouseenter="enter('-2458072313875538806');" onmouseout="out('-2458072313875538806');" style="">1871                         .withFieldType(SupportedFieldType.HIDDEN.toString());                            </span>
<span class="5054103958554301667" onmouseenter="enter('5054103958554301667');" onmouseout="out('5054103958554301667');" style="">1872                 entityForm.addHiddenField(mainMetadata, f);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1873             }                                                                                            </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1874             formService.populateEntityFormFields(entityForm, entity);                                    </span>
<span  style="">1875                                                                                                          </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1876             if (!StringUtils.isEmpty(cd.getSortProperty())) {                                            </span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1877                 int sequenceValue = Integer.parseInt(newSequence) + 1;                                   </span>
<span class="-3733495482183042291" onmouseenter="enter('-3733495482183042291');" onmouseout="out('-3733495482183042291');" style="">1878                 Field field = entityForm.findField(cd.getSortProperty());                                </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1879                 field.setValue(String.valueOf(sequenceValue));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1880             }                                                                                            </span>
<span  style="">1881                                                                                                          </span>
<span class="3923458830762383909" onmouseenter="enter('3923458830762383909');" onmouseout="out('3923458830762383909');" style=""><abbr title="1882             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, sectionCrumbs);">1882             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMðŸ”µ</abbr></span>
<span class="-792608105002716351" onmouseenter="enter('-792608105002716351');" onmouseout="out('-792608105002716351');" style="">1883             Property displayOrder = persistenceResponse.getEntity().findProperty(cd.getSortProperty());  </span>
<span  style="">1884                                                                                                          </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1885             responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                             </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1886             responseMap.put(&quot;field&quot;, collectionField);                                                   </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1887             responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());   </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1888             return responseMap;                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1889         } else {                                                                                         </span>
<span class="7542199431919878786" onmouseenter="enter('7542199431919878786');" onmouseout="out('7542199431919878786');" style=""><abbr title="1890             throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collection fields.&quot;);">1890             throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1891         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1892     }                                                                                                    </span>
<span  style="">1893                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1894     /**                                                                                                  </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1895      * Removes the requested collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1896      *                                                                                                   </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1897      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1897      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collectionðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1898      * map collection.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1899      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1900      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1901      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1902      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1903      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1904      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1905      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1906      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1907      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1908      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1909      */                                                                                                  </span>
<span class="6340503715634976611" onmouseenter="enter('6340503715634976611');" onmouseout="out('6340503715634976611');" style=""><abbr title="1910     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethod.POST)">1910     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethoðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style=""><abbr title="1911     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1911     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1912             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1913             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1914             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1915             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="6845453766150325497" onmouseenter="enter('6845453766150325497');" onmouseout="out('6845453766150325497');" style=""><abbr title="1916         return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, null);">1916         return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1917     }                                                                                                    </span>
<span  style="">1918                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1919     /**                                                                                                  </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1920      * Removes the requested collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1921      *                                                                                                   </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1922      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1922      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collectionðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1923      * map collection.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1924      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1925      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1926      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1927      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1928      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1929      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1930      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1931      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1932      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1933      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1934      */                                                                                                  </span>
<span class="-4053134536146029119" onmouseenter="enter('-4053134536146029119');" onmouseout="out('-4053134536146029119');" style=""><abbr title="1935     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method = RequestMethod.POST)">1935     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method ðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style=""><abbr title="1936     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1936     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1937             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1938             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1939             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1940             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1941             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1942         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1943         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1944         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1945         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1945         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1946         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1947                                                                                                          </span>
<span class="-6408221600487262974" onmouseenter="enter('-6408221600487262974');" onmouseout="out('-6408221600487262974');" style="">1948         String priorKey = request.getParameter(&quot;key&quot;);                                                   </span>
<span  style="">1949                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1950         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1950         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1951         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1952         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1952         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1953                                                                                                          </span>
<span class="8107528363762278945" onmouseenter="enter('8107528363762278945');" onmouseout="out('8107528363762278945');" style="">1954         // First, we must remove the collection entity                                                   </span>
<span class="-8185015406879465962" onmouseenter="enter('-8185015406879465962');" onmouseout="out('-8185015406879465962');" style=""><abbr title="1955         PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectionProperty, entity, collectionItemId, alternateId, priorKey, sectionCrumbs);">1955         PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectðŸ”µ</abbr></span>
<span class="4740780245520344929" onmouseenter="enter('4740780245520344929');" onmouseout="out('4740780245520344929');" style=""><abbr title="1956         if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailure()) {">1956         if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailurðŸ”µ</abbr></span>
<span class="-1907173364280213129" onmouseenter="enter('-1907173364280213129');" onmouseout="out('-1907173364280213129');" style="">1957             String error = &quot;There was an error removing the whatever&quot;;                                   </span>
<span class="6694909055776458558" onmouseenter="enter('6694909055776458558');" onmouseout="out('6694909055776458558');" style="">1958             if (MapUtils.isNotEmpty(persistenceResponse.getEntity().getPropertyValidationErrors())) {    </span>
<span class="2653002805011151778" onmouseenter="enter('2653002805011151778');" onmouseout="out('2653002805011151778');" style="">1959                 // If we failed, we&#x27;ll return some JSON with the first error                             </span>
<span class="6101527636004026445" onmouseenter="enter('6101527636004026445');" onmouseout="out('6101527636004026445');" style=""><abbr title="1960                 error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator().next().get(0);">1960                 error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator()ðŸ”µ</abbr></span>
<span class="3589903040125146199" onmouseenter="enter('3589903040125146199');" onmouseout="out('3589903040125146199');" style=""><abbr title="1961             } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErrors())) {">1961             } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErroðŸ”µ</abbr></span>
<span class="-8002349788440125315" onmouseenter="enter('-8002349788440125315');" onmouseout="out('-8002349788440125315');" style="">1962                 error = persistenceResponse.getEntity().getGlobalValidationErrors().get(0);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1963             }                                                                                            </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1964             return new JsonResponse(response)                                                            </span>
<span class="4764127484129551096" onmouseenter="enter('4764127484129551096');" onmouseout="out('4764127484129551096');" style="">1965                 .with(&quot;status&quot;, &quot;error&quot;)                                                                 </span>
<span class="-4778619806303294332" onmouseenter="enter('-4778619806303294332');" onmouseout="out('-4778619806303294332');" style="">1966                 .with(&quot;message&quot;, BLCMessageUtils.getMessage(error))                                      </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1967                 .done();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1968         }                                                                                                </span>
<span  style="">1969                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1970         // Next, we must get the new list grid that represents this collection                           </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1971         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1972         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1972         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span  style="">1973                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1974         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1975         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1976         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1977         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1978     }                                                                                                    </span>
<span  style="">1979                                                                                                          </span>
<span class="-1722269672251008380" onmouseenter="enter('-1722269672251008380');" onmouseout="out('-1722269672251008380');" style="">1980     public void addAuditableDisplayFields(EntityForm entityForm) {                                       </span>
<span class="2220665039639111541" onmouseenter="enter('2220665039639111541');" onmouseout="out('2220665039639111541');" style="">1981         Field createdBy = entityForm.findField(&quot;auditable.createdBy&quot;);                                   </span>
<span class="-1310269621989930827" onmouseenter="enter('-1310269621989930827');" onmouseout="out('-1310269621989930827');" style="">1982         if (createdBy != null &amp;&amp; createdBy.getValue() != null) {                                         </span>
<span class="3065344382927201496" onmouseenter="enter('3065344382927201496');" onmouseout="out('3065344382927201496');" style="">1983             addAuditableDisplayField(entityForm, createdBy);                                             </span>
<span  style="">1984                                                                                                          </span>
<span class="-8232178899610643805" onmouseenter="enter('-8232178899610643805');" onmouseout="out('-8232178899610643805');" style="">1985             createdBy.setIsVisible(false);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1986         }                                                                                                </span>
<span class="1393544913931451876" onmouseenter="enter('1393544913931451876');" onmouseout="out('1393544913931451876');" style="">1987         Field updatedBy = entityForm.findField(&quot;auditable.updatedBy&quot;);                                   </span>
<span class="362865388069983596" onmouseenter="enter('362865388069983596');" onmouseout="out('362865388069983596');" style="">1988         if (updatedBy != null &amp;&amp; updatedBy.getValue() != null) {                                         </span>
<span class="-892302887107162271" onmouseenter="enter('-892302887107162271');" onmouseout="out('-892302887107162271');" style="">1989             addAuditableDisplayField(entityForm, updatedBy);                                             </span>
<span  style="">1990                                                                                                          </span>
<span class="6398063041947851488" onmouseenter="enter('6398063041947851488');" onmouseout="out('6398063041947851488');" style="">1991             updatedBy.setIsVisible(false);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1992         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1993     }                                                                                                    </span>
<span  style="">1994                                                                                                          </span>
<span class="4984267825623541739" onmouseenter="enter('4984267825623541739');" onmouseout="out('4984267825623541739');" style="">1995     private void addAuditableDisplayField(EntityForm entityForm, Field userField) {                      </span>
<span class="-4635466229336929139" onmouseenter="enter('-4635466229336929139');" onmouseout="out('-4635466229336929139');" style="">1996         Field displayField = buildAuditableDisplayField(userField);                                      </span>
<span  style="">1997                                                                                                          </span>
<span class="-3510960703864117903" onmouseenter="enter('-3510960703864117903');" onmouseout="out('-3510960703864117903');" style="">1998         AdminUser user = adminUserDao.readAdminUserById(Long.parseLong(userField.getValue()));           </span>
<span class="-2749914300638269457" onmouseenter="enter('-2749914300638269457');" onmouseout="out('-2749914300638269457');" style="">1999         String userName = user == null ? null : user.getName();                                          </span>
<span class="-519467923242361473" onmouseenter="enter('-519467923242361473');" onmouseout="out('-519467923242361473');" style="">2000         displayField.setValue(userName);                                                                 </span>
<span  style="">2001                                                                                                          </span>
<span class="2796866146572271884" onmouseenter="enter('2796866146572271884');" onmouseout="out('2796866146572271884');" style="">2002         FieldGroup auditGroup = entityForm.findGroup(&quot;AdminAuditable_Audit&quot;);                            </span>
<span class="442119087406556402" onmouseenter="enter('442119087406556402');" onmouseout="out('442119087406556402');" style="">2003         if (auditGroup != null) {                                                                        </span>
<span class="2790071812155889083" onmouseenter="enter('2790071812155889083');" onmouseout="out('2790071812155889083');" style="">2004             auditGroup.addField(displayField);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2005         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2006     }                                                                                                    </span>
<span  style="">2007                                                                                                          </span>
<span class="-898012728924165157" onmouseenter="enter('-898012728924165157');" onmouseout="out('-898012728924165157');" style="">2008     private Field buildAuditableDisplayField(Field auditableField) {                                     </span>
<span class="7586031541837577475" onmouseenter="enter('7586031541837577475');" onmouseout="out('7586031541837577475');" style="">2009         return new Field().withFieldType(SupportedFieldType.STRING.toString())                           </span>
<span class="-5983163062967947616" onmouseenter="enter('-5983163062967947616');" onmouseout="out('-5983163062967947616');" style="">2010                 .withName(auditableField.getName() + &quot;Display&quot;)                                          </span>
<span class="-3810520855500417343" onmouseenter="enter('-3810520855500417343');" onmouseout="out('-3810520855500417343');" style="">2011                 .withFriendlyName(auditableField.getFriendlyName())                                      </span>
<span class="-2087540063707551713" onmouseenter="enter('-2087540063707551713');" onmouseout="out('-2087540063707551713');" style="">2012                 .withOrder(auditableField.getOrder())                                                    </span>
<span class="3252055162848788175" onmouseenter="enter('3252055162848788175');" onmouseout="out('3252055162848788175');" style="">2013                 .withOwningEntityClass(auditableField.getOwningEntityClass())                            </span>
<span class="8052491048417023702" onmouseenter="enter('8052491048417023702');" onmouseout="out('8052491048417023702');" style="">2014                 .withReadOnly(true);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2015     }                                                                                                    </span>
<span  style="">2016                                                                                                          </span>
<span class="2512746595428590302" onmouseenter="enter('2512746595428590302');" onmouseout="out('2512746595428590302');" style="">2017     protected String getCurrentTabName(Map&lt;String, String&gt; pathVars, ClassMetadata cmd) {                </span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style="">2018         String tabName = pathVars.get(&quot;tabName&quot;);                                                        </span>
<span class="620358619967646231" onmouseenter="enter('620358619967646231');" onmouseout="out('620358619967646231');" style="">2019         if (StringUtils.isBlank(tabName)) {                                                              </span>
<span class="-8386812650765964886" onmouseenter="enter('-8386812650765964886');" onmouseout="out('-8386812650765964886');" style="">2020             TabMetadata firstTab = cmd.getFirstTab();                                                    </span>
<span class="5997097813726693180" onmouseenter="enter('5997097813726693180');" onmouseout="out('5997097813726693180');" style="">2021             return firstTab != null ? firstTab.getTabName() : &quot;General&quot;;                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2022         }                                                                                                </span>
<span class="-6789109484485831180" onmouseenter="enter('-6789109484485831180');" onmouseout="out('-6789109484485831180');" style="">2023         return tabName;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2024     }                                                                                                    </span>
<span  style="">2025                                                                                                          </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">2026     // *****************************************                                                         </span>
<span class="2492884656402841956" onmouseenter="enter('2492884656402841956');" onmouseout="out('2492884656402841956');" style="">2027     // Typed Entity Helper Methods                                                                       </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">2028     // *****************************************                                                         </span>
<span  style="">2029                                                                                                          </span>
<span class="709722161552159597" onmouseenter="enter('709722161552159597');" onmouseout="out('709722161552159597');" style="">2030     protected void setTypedEntityModelAttributes(HttpServletRequest request, Model model) {              </span>
<span class="2572860224956804545" onmouseenter="enter('2572860224956804545');" onmouseout="out('2572860224956804545');" style="">2031         // Check if this is a typed entity                                                               </span>
<span class="-601784761218487618" onmouseenter="enter('-601784761218487618');" onmouseout="out('-601784761218487618');" style="">2032         AdminSection typedEntitySection = (AdminSection) request.getAttribute(&quot;typedEntitySection&quot;);     </span>
<span class="2356861889771822774" onmouseenter="enter('2356861889771822774');" onmouseout="out('2356861889771822774');" style="">2033         if (typedEntitySection != null) {                                                                </span>
<span class="-7054855399164801351" onmouseenter="enter('-7054855399164801351');" onmouseout="out('-7054855399164801351');" style="">2034             // Update the friendly name for this Entity Type                                             </span>
<span class="-8436584596314077038" onmouseenter="enter('-8436584596314077038');" onmouseout="out('-8436584596314077038');" style="">2035             model.addAttribute(&quot;entityFriendlyName&quot;, typedEntitySection.getName());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2036         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2037     }                                                                                                    </span>
<span  style="">2038                                                                                                          </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">2039     // *********************************                                                                 </span>
<span class="5570644305110686760" onmouseenter="enter('5570644305110686760');" onmouseout="out('5570644305110686760');" style="">2040     // ADDITIONAL SPRING-BOUND METHODS *                                                                 </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">2041     // *********************************                                                                 </span>
<span  style="">2042                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">2043     /**                                                                                                  </span>
<span class="-6771709729688841784" onmouseenter="enter('-6771709729688841784');" onmouseout="out('-6771709729688841784');" style=""><abbr title="2044      * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding process.">2044      * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding ðŸ”µ</abbr></span>
<span class="2498077318751920180" onmouseenter="enter('2498077318751920180');" onmouseout="out('2498077318751920180');" style=""><abbr title="2045      * By default, we register a binder that treats empty Strings as null and a Boolean editor that supports either true">2045      * By default, we register a binder that treats empty Strings as null and a Boolean editor that suppoðŸ”µ</abbr></span>
<span class="4465303089468973962" onmouseenter="enter('4465303089468973962');" onmouseout="out('4465303089468973962');" style="">2046      * or false. If the value is passed in as null, it will treat it as false.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">2047      *                                                                                                   </span>
<span class="-3898462538136412996" onmouseenter="enter('-3898462538136412996');" onmouseout="out('-3898462538136412996');" style="">2048      * @param binder                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">2049      */                                                                                                  </span>
<span class="2978104519843175555" onmouseenter="enter('2978104519843175555');" onmouseout="out('2978104519843175555');" style="">2050     @InitBinder                                                                                          </span>
<span class="4179572271848089300" onmouseenter="enter('4179572271848089300');" onmouseout="out('4179572271848089300');" style="">2051     public void initBinder(WebDataBinder binder) {                                                       </span>
<span class="3888201586857511470" onmouseenter="enter('3888201586857511470');" onmouseout="out('3888201586857511470');" style="">2052         binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));                        </span>
<span class="-4458929942740752488" onmouseenter="enter('-4458929942740752488');" onmouseout="out('-4458929942740752488');" style="">2053         binder.registerCustomEditor(Boolean.class, new NonNullBooleanEditor());                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2054     }                                                                                                    </span>
<span  style="">2055                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2056 }                                                                                                        </span>






</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="913821711322743166" onmouseenter="enter('913821711322743166');" onmouseout="out('913821711322743166');" style="">  18 package org.broadleafcommerce.openadmin.web.controller.entity;                                           </span>
<span  style="">  19                                                                                                          </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="">  20 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  21 import java.io.Serializable;                                                                             </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="">  22 import java.io.UnsupportedEncodingException;                                                             </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="">  23 import java.net.URLDecoder;                                                                              </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  24 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  25 import java.util.Arrays;                                                                                 </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  26 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  27 import java.util.List;                                                                                   </span>
<span class="2393042000349901971" onmouseenter="enter('2393042000349901971');" onmouseout="out('2393042000349901971');" style="">  28 import java.util.Map.Entry;                                                                              </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  29 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  30 import java.util.Set;                                                                                    </span>
<span class="5924803009700709999" onmouseenter="enter('5924803009700709999');" onmouseout="out('5924803009700709999');" style="">  31 import java.util.stream.Stream;                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  32 import javax.annotation.Resource;                                                                        </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="">  33 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="-2247759832438184775" onmouseenter="enter('-2247759832438184775');" onmouseout="out('-2247759832438184775');" style="">  34 import javax.servlet.http.HttpServletResponse;                                                           </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  35 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  36 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  37 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  38 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  39 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="3542918789910249764" onmouseenter="enter('3542918789910249764');" onmouseout="out('3542918789910249764');" style="">  40 import org.broadleafcommerce.common.exception.SecurityServiceException;                                  </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  41 import org.broadleafcommerce.common.exception.ServiceException;                                          </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  42 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  43 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-3349026188166660873" onmouseenter="enter('-3349026188166660873');" onmouseout="out('-3349026188166660873');" style="">  44 import org.broadleafcommerce.common.persistence.EntityDuplicator;                                        </span>
<span class="-6648433550510659033" onmouseenter="enter('-6648433550510659033');" onmouseout="out('-6648433550510659033');" style="">  45 import org.broadleafcommerce.common.presentation.client.AddMethodType;                                   </span>
<span class="1362364260528215152" onmouseenter="enter('1362364260528215152');" onmouseout="out('1362364260528215152');" style="">  46 import org.broadleafcommerce.common.presentation.client.SupportedFieldType;                              </span>
<span class="-2818686525334833130" onmouseenter="enter('-2818686525334833130');" onmouseout="out('-2818686525334833130');" style="">  47 import org.broadleafcommerce.common.sandbox.SandBoxHelper;                                               </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  48 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="2429458746821399950" onmouseenter="enter('2429458746821399950');" onmouseout="out('2429458746821399950');" style="">  49 import org.broadleafcommerce.common.util.BLCArrayUtils;                                                  </span>
<span class="2428099238642943960" onmouseenter="enter('2428099238642943960');" onmouseout="out('2428099238642943960');" style="">  50 import org.broadleafcommerce.common.util.BLCMessageUtils;                                                </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  51 import org.broadleafcommerce.common.web.BroadleafRequestContext;                                         </span>
<span class="-1418036767363331062" onmouseenter="enter('-1418036767363331062');" onmouseout="out('-1418036767363331062');" style="">  52 import org.broadleafcommerce.common.web.JsonResponse;                                                    </span>
<span class="-3361215363157046739" onmouseenter="enter('-3361215363157046739');" onmouseout="out('-3361215363157046739');" style="">  53 import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;                              </span>
<span class="-1781055592725563383" onmouseenter="enter('-1781055592725563383');" onmouseout="out('-1781055592725563383');" style="">  54 import org.broadleafcommerce.openadmin.dto.AdornedTargetList;                                            </span>
<span class="-6140296335181984013" onmouseenter="enter('-6140296335181984013');" onmouseout="out('-6140296335181984013');" style="">  55 import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;                                      </span>
<span class="4427537537958608766" onmouseenter="enter('4427537537958608766');" onmouseout="out('4427537537958608766');" style="">  56 import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;                                           </span>
<span class="-1607559599739253077" onmouseenter="enter('-1607559599739253077');" onmouseout="out('-1607559599739253077');" style="">  57 import org.broadleafcommerce.openadmin.dto.ClassMetadata;                                                </span>
<span class="5550564421881377532" onmouseenter="enter('5550564421881377532');" onmouseout="out('5550564421881377532');" style="">  58 import org.broadleafcommerce.openadmin.dto.ClassTree;                                                    </span>
<span class="-3165611006566133086" onmouseenter="enter('-3165611006566133086');" onmouseout="out('-3165611006566133086');" style="">  59 import org.broadleafcommerce.openadmin.dto.CollectionMetadata;                                           </span>
<span class="-4742435063138209714" onmouseenter="enter('-4742435063138209714');" onmouseout="out('-4742435063138209714');" style="">  60 import org.broadleafcommerce.openadmin.dto.DynamicResultSet;                                             </span>
<span class="-5093421835888664541" onmouseenter="enter('-5093421835888664541');" onmouseout="out('-5093421835888664541');" style="">  61 import org.broadleafcommerce.openadmin.dto.Entity;                                                       </span>
<span class="-8829499667991596741" onmouseenter="enter('-8829499667991596741');" onmouseout="out('-8829499667991596741');" style="">  62 import org.broadleafcommerce.openadmin.dto.FieldMetadata;                                                </span>
<span class="6369021917986026789" onmouseenter="enter('6369021917986026789');" onmouseout="out('6369021917986026789');" style="">  63 import org.broadleafcommerce.openadmin.dto.FilterAndSortCriteria;                                        </span>
<span class="826821438795056004" onmouseenter="enter('826821438795056004');" onmouseout="out('826821438795056004');" style="">  64 import org.broadleafcommerce.openadmin.dto.MapMetadata;                                                  </span>
<span class="1983554291461039357" onmouseenter="enter('1983554291461039357');" onmouseout="out('1983554291461039357');" style="">  65 import org.broadleafcommerce.openadmin.dto.Property;                                                     </span>
<span class="1696571253156436279" onmouseenter="enter('1696571253156436279');" onmouseout="out('1696571253156436279');" style="">  66 import org.broadleafcommerce.openadmin.dto.SectionCrumb;                                                 </span>
<span class="5662236005419086618" onmouseenter="enter('5662236005419086618');" onmouseout="out('5662236005419086618');" style="">  67 import org.broadleafcommerce.openadmin.dto.TabMetadata;                                                  </span>
<span class="-8828889589519173652" onmouseenter="enter('-8828889589519173652');" onmouseout="out('-8828889589519173652');" style="">  68 import org.broadleafcommerce.openadmin.server.dao.DynamicEntityDao;                                      </span>
<span class="4410643013278245372" onmouseenter="enter('4410643013278245372');" onmouseout="out('4410643013278245372');" style="">  69 import org.broadleafcommerce.openadmin.server.domain.PersistencePackageRequest;                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  70 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-7620175268967942501" onmouseenter="enter('-7620175268967942501');" onmouseout="out('-7620175268967942501');" style="">  71 import org.broadleafcommerce.openadmin.server.security.domain.AdminSection;                              </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  72 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-4641149340176766185" onmouseenter="enter('-4641149340176766185');" onmouseout="out('-4641149340176766185');" style="">  73 import org.broadleafcommerce.openadmin.server.security.remote.EntityOperationType;                       </span>
<span class="78786346091609662" onmouseenter="enter('78786346091609662');" onmouseout="out('78786346091609662');" style="">  74 import org.broadleafcommerce.openadmin.server.security.service.RowLevelSecurityService;                  </span>
<span class="-8603256547657551769" onmouseenter="enter('-8603256547657551769');" onmouseout="out('-8603256547657551769');" style="">  75 import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;                   </span>
<span class="5585583973934060515" onmouseenter="enter('5585583973934060515');" onmouseout="out('5585583973934060515');" style=""><abbr title="  76 import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExtensionManager;">  76 import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExteðŸ”µ</abbr></span>
<span class="-3086540061138981164" onmouseenter="enter('-3086540061138981164');" onmouseout="out('-3086540061138981164');" style="">  77 import org.broadleafcommerce.openadmin.server.service.persistence.module.BasicPersistenceModule;         </span>
<span class="9131075895472939574" onmouseenter="enter('9131075895472939574');" onmouseout="out('9131075895472939574');" style="">  78 import org.broadleafcommerce.openadmin.web.controller.AdminAbstractController;                           </span>
<span class="7254479112554025637" onmouseenter="enter('7254479112554025637');" onmouseout="out('7254479112554025637');" style="">  79 import org.broadleafcommerce.openadmin.web.controller.modal.ModalHeaderType;                             </span>
<span class="4507704609742395614" onmouseenter="enter('4507704609742395614');" onmouseout="out('4507704609742395614');" style="">  80 import org.broadleafcommerce.openadmin.web.editor.NonNullBooleanEditor;                                  </span>
<span class="-2042519459673859584" onmouseenter="enter('-2042519459673859584');" onmouseout="out('-2042519459673859584');" style="">  81 import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;                        </span>
<span class="3056790491614608405" onmouseenter="enter('3056790491614608405');" onmouseout="out('3056790491614608405');" style="">  82 import org.broadleafcommerce.openadmin.web.form.component.ListGrid;                                      </span>
<span class="1405974373227613661" onmouseenter="enter('1405974373227613661');" onmouseout="out('1405974373227613661');" style="">  83 import org.broadleafcommerce.openadmin.web.form.entity.DefaultAdornedEntityFormActions;                  </span>
<span class="2718350422838759693" onmouseenter="enter('2718350422838759693');" onmouseout="out('2718350422838759693');" style="">  84 import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;                         </span>
<span class="-3560862041655103076" onmouseenter="enter('-3560862041655103076');" onmouseout="out('-3560862041655103076');" style="">  85 import org.broadleafcommerce.openadmin.web.form.entity.DefaultMainActions;                               </span>
<span class="8035715143965725316" onmouseenter="enter('8035715143965725316');" onmouseout="out('8035715143965725316');" style="">  86 import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;                                       </span>
<span class="-3164920911156953697" onmouseenter="enter('-3164920911156953697');" onmouseout="out('-3164920911156953697');" style="">  87 import org.broadleafcommerce.openadmin.web.form.entity.EntityFormAction;                                 </span>
<span class="6015559832933397076" onmouseenter="enter('6015559832933397076');" onmouseout="out('6015559832933397076');" style="">  88 import org.broadleafcommerce.openadmin.web.form.entity.Field;                                            </span>
<span class="-5634654756625156689" onmouseenter="enter('-5634654756625156689');" onmouseout="out('-5634654756625156689');" style="">  89 import org.broadleafcommerce.openadmin.web.form.entity.FieldGroup;                                       </span>
<span class="8763280003660953520" onmouseenter="enter('8763280003660953520');" onmouseout="out('8763280003660953520');" style="">  90 import org.springframework.beans.propertyeditors.StringTrimmerEditor;                                    </span>
<span class="4128309806836178094" onmouseenter="enter('4128309806836178094');" onmouseout="out('4128309806836178094');" style="">  91 import org.springframework.stereotype.Controller;                                                        </span>
<span class="2230089600625206822" onmouseenter="enter('2230089600625206822');" onmouseout="out('2230089600625206822');" style="">  92 import org.springframework.ui.Model;                                                                     </span>
<span class="-8661390401087732702" onmouseenter="enter('-8661390401087732702');" onmouseout="out('-8661390401087732702');" style="">  93 import org.springframework.util.MultiValueMap;                                                           </span>
<span class="-5446610002806720528" onmouseenter="enter('-5446610002806720528');" onmouseout="out('-5446610002806720528');" style="">  94 import org.springframework.validation.BindingResult;                                                     </span>
<span class="-5956639343389312225" onmouseenter="enter('-5956639343389312225');" onmouseout="out('-5956639343389312225');" style="">  95 import org.springframework.web.bind.WebDataBinder;                                                       </span>
<span class="6486986322776186621" onmouseenter="enter('6486986322776186621');" onmouseout="out('6486986322776186621');" style="">  96 import org.springframework.web.bind.annotation.InitBinder;                                               </span>
<span class="2718246165073723950" onmouseenter="enter('2718246165073723950');" onmouseout="out('2718246165073723950');" style="">  97 import org.springframework.web.bind.annotation.ModelAttribute;                                           </span>
<span class="3963501418927616634" onmouseenter="enter('3963501418927616634');" onmouseout="out('3963501418927616634');" style="">  98 import org.springframework.web.bind.annotation.PathVariable;                                             </span>
<span class="-7989471178862524182" onmouseenter="enter('-7989471178862524182');" onmouseout="out('-7989471178862524182');" style="">  99 import org.springframework.web.bind.annotation.RequestMapping;                                           </span>
<span class="4584846860636268493" onmouseenter="enter('4584846860636268493');" onmouseout="out('4584846860636268493');" style=""> 100 import org.springframework.web.bind.annotation.RequestMethod;                                            </span>
<span class="-8913037601281016619" onmouseenter="enter('-8913037601281016619');" onmouseout="out('-8913037601281016619');" style=""> 101 import org.springframework.web.bind.annotation.RequestParam;                                             </span>
<span class="-7662224364501075428" onmouseenter="enter('-7662224364501075428');" onmouseout="out('-7662224364501075428');" style=""> 102 import org.springframework.web.bind.annotation.ResponseBody;                                             </span>
<span class="82864906475118767" onmouseenter="enter('82864906475118767');" onmouseout="out('82864906475118767');" style=""> 103 import org.springframework.web.servlet.DispatcherServlet;                                                </span>
<span class="4665273347041581179" onmouseenter="enter('4665273347041581179');" onmouseout="out('4665273347041581179');" style=""> 104 import org.springframework.web.servlet.FlashMap;                                                         </span>
<span class="4289605998216587359" onmouseenter="enter('4289605998216587359');" onmouseout="out('4289605998216587359');" style=""> 105 import org.springframework.web.servlet.mvc.support.RedirectAttributes;                                   </span>
<span class="2383374134797300138" onmouseenter="enter('2383374134797300138');" onmouseout="out('2383374134797300138');" style=""> 106 import org.springframework.web.util.UrlPathHelper;                                                       </span>
<span  style=""> 107                                                                                                          </span>
<span  style=""> 108                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 109 /**                                                                                                      </span>
<span class="5624503434864804252" onmouseenter="enter('5624503434864804252');" onmouseout="out('5624503434864804252');" style=""> 110  * The default implementation of the {@link AdminAbstractController}. This delegates every call to       </span>
<span class="-497882971048272294" onmouseenter="enter('-497882971048272294');" onmouseout="out('-497882971048272294');" style=""> 111  * super and does not provide any custom-tailored functionality. It is responsible for rendering the     </span>
<span class="-4790859535261881332" onmouseenter="enter('-4790859535261881332');" onmouseout="out('-4790859535261881332');" style=""> 112  * admin for every entity that is not explicitly customized by its own controller.                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 113  *                                                                                                       </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style=""> 114  * @author Andre Azzolini (apazzolini)                                                                   </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style=""> 115  * @author Jeff Fischer                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 116  */                                                                                                      </span>
<span class="4155455059275642147" onmouseenter="enter('4155455059275642147');" onmouseout="out('4155455059275642147');" style=""> 117 @Controller(&quot;blAdminBasicEntityController&quot;)                                                              </span>
<span class="1298802560762502343" onmouseenter="enter('1298802560762502343');" onmouseout="out('1298802560762502343');" style=""> 118 @RequestMapping(&quot;/{sectionKey:.+}&quot;)                                                                      </span>
<span class="8857493697785984988" onmouseenter="enter('8857493697785984988');" onmouseout="out('8857493697785984988');" style=""> 119 public class AdminBasicEntityController extends AdminAbstractController {                                </span>
<span class="6387945601766467724" onmouseenter="enter('6387945601766467724');" onmouseout="out('6387945601766467724');" style=""> 120     protected static final Log LOG = LogFactory.getLog(AdminBasicEntityController.class);                </span>
<span  style=""> 121                                                                                                          </span>
<span class="-3043900363751028803" onmouseenter="enter('-3043900363751028803');" onmouseout="out('-3043900363751028803');" style=""> 122     public static final String ALTERNATE_ID_PROPERTY = &quot;ALTERNATE_ID&quot;;                                   </span>
<span  style=""> 123                                                                                                          </span>
<span class="4075481265342786632" onmouseenter="enter('4075481265342786632');" onmouseout="out('4075481265342786632');" style=""> 124     public static final String CUSTOM_CRITERIA = &quot;criteria&quot;;                                             </span>
<span  style=""> 125                                                                                                          </span>
<span class="-5370879055704196240" onmouseenter="enter('-5370879055704196240');" onmouseout="out('-5370879055704196240');" style=""> 126     public static final String IS_SELECTIZE_REQUEST = &quot;isSelectizeRequest&quot;;                              </span>
<span  style=""> 127                                                                                                          </span>
<span class="-7030764210296949798" onmouseenter="enter('-7030764210296949798');" onmouseout="out('-7030764210296949798');" style=""> 128     @Resource(name=&quot;blSandBoxHelper&quot;)                                                                    </span>
<span class="-7799183597372200632" onmouseenter="enter('-7799183597372200632');" onmouseout="out('-7799183597372200632');" style=""> 129     protected SandBoxHelper sandBoxHelper;                                                               </span>
<span  style=""> 130                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style=""> 131     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style=""> 132     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style=""> 133                                                                                                          </span>
<span class="1039661802170570045" onmouseenter="enter('1039661802170570045');" onmouseout="out('1039661802170570045');" style=""> 134     @Resource(name=&quot;blDynamicEntityDao&quot;)                                                                 </span>
<span class="-6629482740079052882" onmouseenter="enter('-6629482740079052882');" onmouseout="out('-6629482740079052882');" style=""> 135     protected DynamicEntityDao dynamicEntityDao;                                                         </span>
<span  style=""> 136                                                                                                          </span>
<span class="3323977399618509653" onmouseenter="enter('3323977399618509653');" onmouseout="out('3323977399618509653');" style=""> 137     @Resource(name = &quot;blAdornedTargetAutoPopulateExtensionManager&quot;)                                      </span>
<span class="-4810148452666974339" onmouseenter="enter('-4810148452666974339');" onmouseout="out('-4810148452666974339');" style=""> 138     protected AdornedTargetAutoPopulateExtensionManager adornedTargetAutoPopulateExtensionManager;       </span>
<span  style=""> 139                                                                                                          </span>
<span class="-1073312679381587606" onmouseenter="enter('-1073312679381587606');" onmouseout="out('-1073312679381587606');" style=""> 140     @Resource(name = &quot;blRowLevelSecurityService&quot;)                                                        </span>
<span class="7292046362506695965" onmouseenter="enter('7292046362506695965');" onmouseout="out('7292046362506695965');" style=""> 141     protected RowLevelSecurityService rowLevelSecurityService;                                           </span>
<span  style=""> 142                                                                                                          </span>
<span class="4471392044492296285" onmouseenter="enter('4471392044492296285');" onmouseout="out('4471392044492296285');" style=""> 143     @Resource(name = &quot;blEntityDuplicator&quot;)                                                               </span>
<span class="-9194612273021432316" onmouseenter="enter('-9194612273021432316');" onmouseout="out('-9194612273021432316');" style=""> 144     protected EntityDuplicator duplicator;                                                               </span>
<span  style=""> 145                                                                                                          </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style=""> 146     @Resource(name = &quot;blGenericEntityService&quot;)                                                           </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style=""> 147     protected GenericEntityService genericEntityService;                                                 </span>
<span  style=""> 148                                                                                                          </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 149     // ******************************************                                                        </span>
<span class="8145904524131922989" onmouseenter="enter('8145904524131922989');" onmouseout="out('8145904524131922989');" style=""> 150     // REQUEST-MAPPING BOUND CONTROLLER METHODS *                                                        </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 151     // ******************************************                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 152     /**                                                                                                  </span>
<span class="5980196098348408716" onmouseenter="enter('5980196098348408716');" onmouseout="out('5980196098348408716');" style=""><abbr title=" 153      * Renders the main entity listing for the specified class, which is based on the current sectionKey with some optional"> 153      * Renders the main entity listing for the specified class, which is based on the current sectionKey ðŸ”µ</abbr></span>
<span class="1756838433111210325" onmouseenter="enter('1756838433111210325');" onmouseout="out('1756838433111210325');" style=""> 154      * criteria.                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 155      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 156      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 157      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 158      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 159      * @param pathVars                                                                                   </span>
<span class="-7836494531350161829" onmouseenter="enter('-7836494531350161829');" onmouseout="out('-7836494531350161829');" style=""> 160      * @param requestParams a Map of property name -&gt; list critiera values                               </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 161      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 162      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 163      */                                                                                                  </span>
<span class="854227037044969777" onmouseenter="enter('854227037044969777');" onmouseout="out('854227037044969777');" style=""> 164     @RequestMapping(value = &quot;&quot;, method = RequestMethod.GET)                                              </span>
<span class="-8904751421201051618" onmouseenter="enter('-8904751421201051618');" onmouseout="out('-8904751421201051618');" style=""><abbr title=" 165     public String viewEntityList(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 165     public String viewEntityList(HttpServletRequest request, HttpServletResponse response, Model model, @ðŸ”µ</abbr></span>
<span class="4231046062556777758" onmouseenter="enter('4231046062556777758');" onmouseout="out('4231046062556777758');" style=""> 166     Map&lt;String, String&gt; pathVars, @RequestParam                                                          </span>
<span class="1054657867470972542" onmouseenter="enter('1054657867470972542');" onmouseout="out('1054657867470972542');" style=""> 167     MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 168         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 169         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 170         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                               </span>
<span class="1452589137399878084" onmouseenter="enter('1452589137399878084');" onmouseout="out('1452589137399878084');" style=""><abbr title=" 171         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars);"> 171         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 172         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style=""> 173         DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                            </span>
<span class="-9123024135554384147" onmouseenter="enter('-9123024135554384147');" onmouseout="out('-9123024135554384147');" style=""> 174         ListGrid listGrid = formService.buildMainListGrid(drs, cmd, sectionKey, crumbs);                 </span>
<span class="-7197013270379460942" onmouseenter="enter('-7197013270379460942');" onmouseout="out('-7197013270379460942');" style=""> 175         listGrid.setSelectType(ListGrid.SelectType.NONE);                                                </span>
<span class="6707774114103003478" onmouseenter="enter('6707774114103003478');" onmouseout="out('6707774114103003478');" style=""> 176         Set&lt;Field&gt; headerFields = listGrid.getHeaderFields();                                            </span>
<span class="6157449347608657417" onmouseenter="enter('6157449347608657417');" onmouseout="out('6157449347608657417');" style=""> 177         if (CollectionUtils.isNotEmpty(headerFields)) {                                                  </span>
<span class="7359980094802675712" onmouseenter="enter('7359980094802675712');" onmouseout="out('7359980094802675712');" style=""> 178             Field firstField = headerFields.iterator().next();                                           </span>
<span class="-7992921859474727563" onmouseenter="enter('-7992921859474727563');" onmouseout="out('-7992921859474727563');" style=""> 179             if (requestParams.containsKey(firstField.getName())) {                                       </span>
<span class="-4847870846432586371" onmouseenter="enter('-4847870846432586371');" onmouseout="out('-4847870846432586371');" style=""> 180                 model.addAttribute(&quot;mainSearchTerm&quot;, requestParams.get(firstField.getName()).get(0));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182         }                                                                                                </span>
<span class="3294377821001327596" onmouseenter="enter('3294377821001327596');" onmouseout="out('3294377821001327596');" style=""> 183         model.addAttribute(&quot;viewType&quot;, &quot;entityList&quot;);                                                    </span>
<span class="5223794068523842694" onmouseenter="enter('5223794068523842694');" onmouseout="out('5223794068523842694');" style=""> 184         setupViewEntityListBasicModel(request, cmd, sectionKey, sectionClassName, model, requestParams); </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 185         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 186         return DEFAULT_CONTAINER_VIEW;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187     }                                                                                                    </span>
<span  style=""> 188                                                                                                          </span>
<span class="5512240627727429054" onmouseenter="enter('5512240627727429054');" onmouseout="out('5512240627727429054');" style=""><abbr title=" 189     protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String sectionKey,"> 189     protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String seðŸ”µ</abbr></span>
<span class="522743254766371502" onmouseenter="enter('522743254766371502');" onmouseout="out('522743254766371502');" style=""> 190             String sectionClassName, Model model, MultiValueMap&lt;String, String&gt; requestParams) {         </span>
<span class="5787313217223527782" onmouseenter="enter('5787313217223527782');" onmouseout="out('5787313217223527782');" style=""> 191         List&lt;EntityFormAction&gt; mainActions = new ArrayList&lt;&gt;();                                          </span>
<span class="-6495333239259317464" onmouseenter="enter('-6495333239259317464');" onmouseout="out('-6495333239259317464');" style=""> 192         addAddActionIfAllowed(sectionClassName, cmd, mainActions);                                       </span>
<span class="-5948121019403308590" onmouseenter="enter('-5948121019403308590');" onmouseout="out('-5948121019403308590');" style=""> 193         extensionManager.getProxy().addAdditionalMainActions(sectionClassName, mainActions);             </span>
<span class="-381816252130957573" onmouseenter="enter('-381816252130957573');" onmouseout="out('-381816252130957573');" style=""> 194         extensionManager.getProxy().modifyMainActions(cmd, mainActions);                                 </span>
<span  style=""> 195                                                                                                          </span>
<span class="-5498329164774951339" onmouseenter="enter('-5498329164774951339');" onmouseout="out('-5498329164774951339');" style=""> 196         // If this came from a delete save, we&#x27;ll have a headerFlash request parameter to take care of   </span>
<span class="6915846846822456322" onmouseenter="enter('6915846846822456322');" onmouseout="out('6915846846822456322');" style=""> 197         if (requestParams.containsKey(&quot;headerFlash&quot;)) {                                                  </span>
<span class="-7374079465520861767" onmouseenter="enter('-7374079465520861767');" onmouseout="out('-7374079465520861767');" style=""> 198             model.addAttribute(&quot;headerFlash&quot;, requestParams.get(&quot;headerFlash&quot;).get(0));                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199         }                                                                                                </span>
<span  style=""> 200                                                                                                          </span>
<span class="-5632901614715850082" onmouseenter="enter('-5632901614715850082');" onmouseout="out('-5632901614715850082');" style=""> 201         List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                   </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style=""> 202         String requestUri = request.getRequestURI();                                                     </span>
<span class="2670437920401576748" onmouseenter="enter('2670437920401576748');" onmouseout="out('2670437920401576748');" style=""> 203         if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) {  </span>
<span class="-901741071381030126" onmouseenter="enter('-901741071381030126');" onmouseout="out('-901741071381030126');" style=""><abbr title=" 204             requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length());"> 204             requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length())ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span  style=""> 206                                                                                                          </span>
<span class="-3335875933652663591" onmouseenter="enter('-3335875933652663591');" onmouseout="out('-3335875933652663591');" style=""> 207         model.addAttribute(&quot;isFilter&quot;, (requestParams.size() &gt; 0));                                      </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style=""> 208         model.addAttribute(&quot;currentUri&quot;, requestUri);                                                    </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style=""> 209         model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                  </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 210         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 211         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="-4219022137146036385" onmouseenter="enter('-4219022137146036385');" onmouseout="out('-4219022137146036385');" style=""> 212         model.addAttribute(&quot;mainActions&quot;, mainActions);                                                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 213         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-7167932239083034641" onmouseenter="enter('-7167932239083034641');" onmouseout="out('-7167932239083034641');" style=""> 214         setTypedEntityModelAttributes(request, model);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215     }                                                                                                    </span>
<span  style=""> 216                                                                                                          </span>
<span class="-3612928683982517341" onmouseenter="enter('-3612928683982517341');" onmouseout="out('-3612928683982517341');" style=""> 217     @RequestMapping(value = &quot;/selectize&quot;, method = RequestMethod.GET)                                    </span>
<span class="-2536734120775641057" onmouseenter="enter('-2536734120775641057');" onmouseout="out('-2536734120775641057');" style=""> 218     public @ResponseBody Map&lt;String, Object&gt; viewEntityListSelectize(HttpServletRequest request,         </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style=""> 219              HttpServletResponse response, Model model,                                                  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 220              @PathVariable Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 221              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 222         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 223         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 224         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                               </span>
<span class="3971039348455381302" onmouseenter="enter('3971039348455381302');" onmouseout="out('3971039348455381302');" style=""><abbr title=" 225         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars)"> 225         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="-5204717557696417186" onmouseenter="enter('-5204717557696417186');" onmouseout="out('-5204717557696417186');" style=""> 226                 .withCustomCriteria(getCustomCriteria(requestParams));                                   </span>
<span  style=""> 227                                                                                                          </span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style=""> 228         ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                           </span>
<span  style=""> 229                                                                                                          </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 230         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 231         DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                           </span>
<span  style=""> 232                                                                                                          </span>
<span class="-6840686923261380416" onmouseenter="enter('-6840686923261380416');" onmouseout="out('-6840686923261380416');" style=""> 233         return formService.constructSelectizeOptionMap(drs, cmd);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 236     /**                                                                                                  </span>
<span class="6015587852497052057" onmouseenter="enter('6015587852497052057');" onmouseout="out('6015587852497052057');" style=""> 237      * Obtains the requested criteria parameter                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 238      *                                                                                                   </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 239      * @param requestParams                                                                              </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 240      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 241      */                                                                                                  </span>
<span class="-5224065764328446223" onmouseenter="enter('-5224065764328446223');" onmouseout="out('-5224065764328446223');" style=""> 242     protected String[] getCustomCriteria(Map&lt;String, List&lt;String&gt;&gt; requestParams) {                      </span>
<span class="8308653628584061101" onmouseenter="enter('8308653628584061101');" onmouseout="out('8308653628584061101');" style=""> 243         if (requestParams == null || requestParams.isEmpty()) {                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 244             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245         }                                                                                                </span>
<span  style=""> 246                                                                                                          </span>
<span class="-6200156504676301578" onmouseenter="enter('-6200156504676301578');" onmouseout="out('-6200156504676301578');" style=""> 247         List&lt;String&gt; criteria = requestParams.get(CUSTOM_CRITERIA);                                      </span>
<span class="3479198517250864619" onmouseenter="enter('3479198517250864619');" onmouseout="out('3479198517250864619');" style=""> 248         String response = CollectionUtils.isEmpty(criteria) ? null : criteria.get(0);                    </span>
<span class="3591199473111095603" onmouseenter="enter('3591199473111095603');" onmouseout="out('3591199473111095603');" style=""> 249         return new String[] {response};                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 252     /**                                                                                                  </span>
<span class="53051913897087216" onmouseenter="enter('53051913897087216');" onmouseout="out('53051913897087216');" style=""><abbr title=" 253      * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new instances"> 253      * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new inðŸ”µ</abbr></span>
<span class="-2041834868205006384" onmouseenter="enter('-2041834868205006384');" onmouseout="out('-2041834868205006384');" style=""> 254      * of the entity and all of the fields in the entity aren&#x27;t marked as read only.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 255      *                                                                                                   </span>
<span class="2579837316240354786" onmouseenter="enter('2579837316240354786');" onmouseout="out('2579837316240354786');" style=""> 256      * @param sectionClassName                                                                           </span>
<span class="3340688165449077744" onmouseenter="enter('3340688165449077744');" onmouseout="out('3340688165449077744');" style=""> 257      * @param cmd                                                                                        </span>
<span class="-70241175981651056" onmouseenter="enter('-70241175981651056');" onmouseout="out('-70241175981651056');" style=""> 258      * @param mainActions                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 259      */                                                                                                  </span>
<span class="-3535265632615590771" onmouseenter="enter('-3535265632615590771');" onmouseout="out('-3535265632615590771');" style=""><abbr title=" 260     protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormAction&gt; mainActions) {"> 260     protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormActioðŸ”µ</abbr></span>
<span class="-1675673801723949520" onmouseenter="enter('-1675673801723949520');" onmouseout="out('-1675673801723949520');" style=""> 261         if (isAddActionAllowed(sectionClassName, cmd)) {                                                 </span>
<span class="-161553798203722975" onmouseenter="enter('-161553798203722975');" onmouseout="out('-161553798203722975');" style=""> 262             mainActions.add(DefaultMainActions.ADD);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264     }                                                                                                    </span>
<span  style=""> 265                                                                                                          </span>
<span class="4125299149074369729" onmouseenter="enter('4125299149074369729');" onmouseout="out('4125299149074369729');" style=""> 266     protected boolean isAddActionAllowed(final String sectionClassName, final ClassMetadata cmd) {       </span>
<span class="2379281051849826609" onmouseenter="enter('2379281051849826609');" onmouseout="out('2379281051849826609');" style=""> 267         // If the user does not have create permissions, we will not add the &quot;Add New&quot; button            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 268         try {                                                                                            </span>
<span class="-2050050318794737036" onmouseenter="enter('-2050050318794737036');" onmouseout="out('-2050050318794737036');" style=""> 269             adminRemoteSecurityService.securityCheck(sectionClassName, EntityOperationType.ADD);         </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 270         } catch (ServiceException e) {                                                                   </span>
<span class="-8912377967087217182" onmouseenter="enter('-8912377967087217182');" onmouseout="out('-8912377967087217182');" style=""> 271             if (e instanceof SecurityServiceException) {                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 272                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274         }                                                                                                </span>
<span class="-7280022754540940507" onmouseenter="enter('-7280022754540940507');" onmouseout="out('-7280022754540940507');" style=""><abbr title=" 275         final boolean canAdd = rowLevelSecurityService.canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectionClassName, cmd);"> 275         final boolean canAdd = rowLevelSecurityService.canAdd(adminRemoteSecurityService.getPersistentAdmðŸ”µ</abbr></span>
<span class="5125272502277129387" onmouseenter="enter('5125272502277129387');" onmouseout="out('5125272502277129387');" style=""> 276         return isNotReadOnly(cmd) &amp;&amp; canAdd;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277     }                                                                                                    </span>
<span  style=""> 278                                                                                                          </span>
<span class="-7397004815762425407" onmouseenter="enter('-7397004815762425407');" onmouseout="out('-7397004815762425407');" style=""> 279     protected boolean isNotReadOnly(final ClassMetadata cmd) {                                           </span>
<span class="-5650645308789885306" onmouseenter="enter('-5650645308789885306');" onmouseout="out('-5650645308789885306');" style=""> 280                 //check if all the metadata is read only                                                 </span>
<span class="-3497335608114491506" onmouseenter="enter('-3497335608114491506');" onmouseout="out('-3497335608114491506');" style=""> 281         for (Property property : cmd.getProperties()) {                                                  </span>
<span class="-446642995335437650" onmouseenter="enter('-446642995335437650');" onmouseout="out('-446642995335437650');" style=""> 282             if (property.getMetadata() instanceof BasicFieldMetadata) {                                  </span>
<span class="-2608302945385805606" onmouseenter="enter('-2608302945385805606');" onmouseout="out('-2608302945385805606');" style=""><abbr title=" 283                 if ((((BasicFieldMetadata) (property.getMetadata())).getReadOnly() == null) || (!((BasicFieldMetadata) (property.getMetadata())).getReadOnly())) {"> 283                 if ((((BasicFieldMetadata) (property.getMetadata())).getReadOnly() == null) || (!((BasicFðŸ”µ</abbr></span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 284                     return true;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 288         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span  style=""> 290                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 291     /**                                                                                                  </span>
<span class="-403478592182410175" onmouseenter="enter('-403478592182410175');" onmouseout="out('-403478592182410175');" style=""><abbr title=" 292      * Renders the modal form that is used to add a new parent level entity. Note that this form cannot render any"> 292      * Renders the modal form that is used to add a new parent level entity. Note that this form cannot rðŸ”µ</abbr></span>
<span class="-2684076904077363908" onmouseenter="enter('-2684076904077363908');" onmouseout="out('-2684076904077363908');" style=""><abbr title=" 293      * subcollections as operations on those collections require the parent level entity to first be saved and have"> 293      * subcollections as operations on those collections require the parent level entity to first be saveðŸ”µ</abbr></span>
<span class="-2496660529180512497" onmouseenter="enter('-2496660529180512497');" onmouseout="out('-2496660529180512497');" style=""><abbr title=" 294      * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity screen where"> 294      * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity ðŸ”µ</abbr></span>
<span class="-5672334976076130102" onmouseenter="enter('-5672334976076130102');" onmouseout="out('-5672334976076130102');" style=""> 295      * they can then perform operations on sub collections.                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 296      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 297      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 298      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 299      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 300      * @param pathVars                                                                                   </span>
<span class="-7339043177630483847" onmouseenter="enter('-7339043177630483847');" onmouseout="out('-7339043177630483847');" style=""> 301      * @param entityType                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 302      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 303      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 304      */                                                                                                  </span>
<span class="-6494270766546423105" onmouseenter="enter('-6494270766546423105');" onmouseout="out('-6494270766546423105');" style=""> 305     @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.GET)                                          </span>
<span class="6823365531397782281" onmouseenter="enter('6823365531397782281');" onmouseout="out('6823365531397782281');" style=""><abbr title=" 306     public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 306     public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model modelðŸ”µ</abbr></span>
<span class="3124096823693513972" onmouseenter="enter('3124096823693513972');" onmouseout="out('3124096823693513972');" style=""> 307     Map&lt;String, String&gt; pathVars, @RequestParam(defaultValue = &quot;&quot;)                                       </span>
<span class="-920091018198103553" onmouseenter="enter('-920091018198103553');" onmouseout="out('-920091018198103553');" style=""> 308     String entityType) throws Exception {                                                                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 309         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 310         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 311         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 312         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 312         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style=""> 313         ppr.setAddOperationInspect(true);                                                                </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 314         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style=""> 315         entityType = determineEntityType(entityType, cmd);                                               </span>
<span class="4098005746663533241" onmouseenter="enter('4098005746663533241');" onmouseout="out('4098005746663533241');" style=""> 316         EntityForm entityForm = formService.createEntityForm(cmd, sectionCrumbs);                        </span>
<span class="5826594571687596812" onmouseenter="enter('5826594571687596812');" onmouseout="out('5826594571687596812');" style=""><abbr title=" 317         // We need to make sure that the ceiling entity is set to the interface and the specific entity type"> 317         // We need to make sure that the ceiling entity is set to the interface and the specific entity tðŸ”µ</abbr></span>
<span class="37161952125740808" onmouseenter="enter('37161952125740808');" onmouseout="out('37161952125740808');" style=""> 318         // is set to the type we&#x27;re going to be creating.                                                </span>
<span class="5062735442039535924" onmouseenter="enter('5062735442039535924');" onmouseout="out('5062735442039535924');" style=""> 319         entityForm.setCeilingEntityClassname(cmd.getCeilingType());                                      </span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style=""> 320         entityForm.setEntityType(entityType);                                                            </span>
<span class="-5227856854691424770" onmouseenter="enter('-5227856854691424770');" onmouseout="out('-5227856854691424770');" style=""><abbr title=" 321         // When we initially build the class metadata (and thus, the entity form), we had all of the possible"> 321         // When we initially build the class metadata (and thus, the entity form), we had all of the possðŸ”µ</abbr></span>
<span class="5105619661852614163" onmouseenter="enter('5105619661852614163');" onmouseout="out('5105619661852614163');" style=""><abbr title=" 322         // polymorphic fields built out. Now that we have a concrete entity type to render, we can remove the"> 322         // polymorphic fields built out. Now that we have a concrete entity type to render, we can removeðŸ”µ</abbr></span>
<span class="-3843175043245177501" onmouseenter="enter('-3843175043245177501');" onmouseout="out('-3843175043245177501');" style=""> 323         // fields that are not applicable for this given entity type.                                    </span>
<span class="-2935519954456371455" onmouseenter="enter('-2935519954456371455');" onmouseout="out('-2935519954456371455');" style=""> 324         formService.removeNonApplicableFields(cmd, entityForm, entityType);                              </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 325         modifyAddEntityForm(entityForm, pathVars);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 326         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 327         model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                               </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 328         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 329         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 330         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 331         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 332         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333     }                                                                                                    </span>
<span  style=""> 334                                                                                                          </span>
<span class="6822582914767657426" onmouseenter="enter('6822582914767657426');" onmouseout="out('6822582914767657426');" style=""> 335     // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic         </span>
<span class="6925903770450869702" onmouseenter="enter('6925903770450869702');" onmouseout="out('6925903770450869702');" style=""> 336     // types for this entity.                                                                            </span>
<span class="4034648443280821325" onmouseenter="enter('4034648443280821325');" onmouseout="out('4034648443280821325');" style=""><abbr title=" 337     protected String determineEntityType(String entityType, final ClassMetadata cmd) throws UnsupportedEncodingException {"> 337     protected String determineEntityType(String entityType, final ClassMetadata cmd) throws UnsupportedEnðŸ”µ</abbr></span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 338         if (StringUtils.isBlank(entityType)) {                                                           </span>
<span class="2333848870190395940" onmouseenter="enter('2333848870190395940');" onmouseout="out('2333848870190395940');" style=""> 339             if (cmd.getPolymorphicEntities().getChildren().length == 0) {                                </span>
<span class="2097783908693957449" onmouseenter="enter('2097783908693957449');" onmouseout="out('2097783908693957449');" style=""> 340                 entityType = cmd.getPolymorphicEntities().getFullyQualifiedClassname();                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 341             } else {                                                                                     </span>
<span class="-6902702564943152777" onmouseenter="enter('-6902702564943152777');" onmouseout="out('-6902702564943152777');" style=""> 342                 entityType = getDefaultEntityType();                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 344         } else {                                                                                         </span>
<span class="7843468667819793383" onmouseenter="enter('7843468667819793383');" onmouseout="out('7843468667819793383');" style=""> 345             entityType = URLDecoder.decode(entityType, &quot;UTF-8&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346         }                                                                                                </span>
<span class="2597693607778452486" onmouseenter="enter('2597693607778452486');" onmouseout="out('2597693607778452486');" style=""> 347         return entityType;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348     }                                                                                                    </span>
<span  style=""> 349                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 350     /**                                                                                                  </span>
<span class="-2292124409166412817" onmouseenter="enter('-2292124409166412817');" onmouseout="out('-2292124409166412817');" style=""><abbr title=" 351      * Processes the request to add a new entity. If successful, returns a redirect to the newly created entity."> 351      * Processes the request to add a new entity. If successful, returns a redirect to the newly created ðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 352      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 353      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 354      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 355      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 356      * @param pathVars                                                                                   </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 357      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 358      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 359      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 360      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 361      */                                                                                                  </span>
<span class="-1840738840686664300" onmouseenter="enter('-1840738840686664300');" onmouseout="out('-1840738840686664300');" style=""> 362     @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.POST)                                         </span>
<span class="-7621920519882762179" onmouseenter="enter('-7621920519882762179');" onmouseout="out('-7621920519882762179');" style=""><abbr title=" 363     public String addEntity(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 363     public String addEntity(HttpServletRequest request, HttpServletResponse response, Model model, @PathVðŸ”µ</abbr></span>
<span class="6515967044179550846" onmouseenter="enter('6515967044179550846');" onmouseout="out('6515967044179550846');" style=""> 364     Map&lt;String, String&gt; pathVars, @ModelAttribute(&quot;entityForm&quot;)                                          </span>
<span class="-7044303285511372673" onmouseenter="enter('-7044303285511372673');" onmouseout="out('-7044303285511372673');" style=""> 365     EntityForm entityForm, BindingResult result) throws Exception {                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 366         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 367         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 368         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="2596618104185041854" onmouseenter="enter('2596618104185041854');" onmouseout="out('2596618104185041854');" style=""><abbr title=" 369         ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 369         ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassNameðŸ”µ</abbr></span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 370         extractDynamicFormFields(cmd, entityForm);                                                       </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 371         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 371         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="-4281879219750019053" onmouseenter="enter('-4281879219750019053');" onmouseout="out('-4281879219750019053');" style=""> 372         Entity entity = service.addEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();       </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 373         entityFormValidator.validate(entityForm, entity, result);                                        </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 374         if (result.hasErrors()) {                                                                        </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 375             entityForm.clearFieldsMap();                                                                 </span>
<span class="-312181662169537666" onmouseenter="enter('-312181662169537666');" onmouseout="out('-312181662169537666');" style=""> 376             formService.populateEntityForm(cmd, entity, entityForm, sectionCrumbs);                      </span>
<span class="254171966199148419" onmouseenter="enter('254171966199148419');" onmouseout="out('254171966199148419');" style=""> 377             formService.removeNonApplicableFields(cmd, entityForm, entityForm.getEntityType());          </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 378             modifyAddEntityForm(entityForm, pathVars);                                                   </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 379             model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                           </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 380             model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                        </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 381             model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                 </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 382             model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 383             setModelAttributes(model, sectionKey);                                                       </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 384             return MODAL_CONTAINER_VIEW;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385         }                                                                                                </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 386         // Note that AJAX Redirects need the context path prepended to them                              </span>
<span class="-7051829643538957045" onmouseenter="enter('-7051829643538957045');" onmouseout="out('-7051829643538957045');" style=""><abbr title=" 387         return (((&quot;ajaxredirect:&quot; + getContextPath(request)) + sectionKey) + &quot;/&quot;) + entity.getPMap().get(&quot;id&quot;).getValue();"> 387         return (((&quot;ajaxredirect:&quot; + getContextPath(request)) + sectionKey) + &quot;/&quot;) + entity.getPMap().get(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388     }                                                                                                    </span>
<span  style=""> 389                                                                                                          </span>
<span class="1290933159858539781" onmouseenter="enter('1290933159858539781');" onmouseout="out('1290933159858539781');" style=""> 390     @RequestMapping(value = &quot;/{id}/duplicate&quot;, method = RequestMethod.POST)                              </span>
<span class="-8648048319305434901" onmouseenter="enter('-8648048319305434901');" onmouseout="out('-8648048319305434901');" style=""><abbr title=" 391     public String duplicateEntity(final HttpServletRequest request, final HttpServletResponse response, final Model model, @PathVariable"> 391     public String duplicateEntity(final HttpServletRequest request, final HttpServletResponse response, fðŸ”µ</abbr></span>
<span class="-4197988234720805708" onmouseenter="enter('-4197988234720805708');" onmouseout="out('-4197988234720805708');" style=""> 392     final Map&lt;String, String&gt; pathVars, @PathVariable(&quot;id&quot;)                                              </span>
<span class="-248257474077456088" onmouseenter="enter('-248257474077456088');" onmouseout="out('-248257474077456088');" style=""> 393     final String id, @ModelAttribute(&quot;entityForm&quot;)                                                       </span>
<span class="2257649566782017554" onmouseenter="enter('2257649566782017554');" onmouseout="out('2257649566782017554');" style=""> 394     final EntityForm entityForm, final BindingResult result) throws Exception {                          </span>
<span class="5473402149144087547" onmouseenter="enter('5473402149144087547');" onmouseout="out('5473402149144087547');" style=""> 395         final String sectionKey = getSectionKey(pathVars);                                               </span>
<span class="5437662011929987553" onmouseenter="enter('5437662011929987553');" onmouseout="out('5437662011929987553');" style=""> 396         final String sectionClassName = getClassNameForSection(sectionKey);                              </span>
<span class="8553976943183535096" onmouseenter="enter('8553976943183535096');" onmouseout="out('8553976943183535096');" style=""> 397         final Class&lt;?&gt; entityClass = dynamicEntityDao.getImplClass(sectionClassName);                    </span>
<span class="3365797270076600425" onmouseenter="enter('3365797270076600425');" onmouseout="out('3365797270076600425');" style=""> 398         final long identifier = Long.parseLong(id);                                                      </span>
<span class="-138107922525045121" onmouseenter="enter('-138107922525045121');" onmouseout="out('-138107922525045121');" style=""> 399         if (duplicator.validate(entityClass, identifier)) {                                              </span>
<span class="5493542447860389431" onmouseenter="enter('5493542447860389431');" onmouseout="out('5493542447860389431');" style=""> 400             final Object duplicate;                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 401             try {                                                                                        </span>
<span class="-2283233085854885260" onmouseenter="enter('-2283233085854885260');" onmouseout="out('-2283233085854885260');" style=""> 402                 duplicate = duplicator.copy(entityClass, identifier);                                    </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 403             } catch (java.lang.Exception e) {                                                            </span>
<span class="-8850460393574909327" onmouseenter="enter('-8850460393574909327');" onmouseout="out('-8850460393574909327');" style=""> 404                 LOG.error(&quot;Could not duplicate entity&quot;, e);                                              </span>
<span class="-7503880796159563304" onmouseenter="enter('-7503880796159563304');" onmouseout="out('-7503880796159563304');" style=""> 405                 return getErrorDuplicatingResponse(response, &quot;Duplication_Failure&quot;);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406             }                                                                                            </span>
<span class="9202899875978069713" onmouseenter="enter('9202899875978069713');" onmouseout="out('9202899875978069713');" style=""> 407             final Serializable dupId = genericEntityService.getIdentifier(duplicate);                    </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 408             // Note that AJAX Redirects need the context path prepended to them                          </span>
<span class="7966955895170923074" onmouseenter="enter('7966955895170923074');" onmouseout="out('7966955895170923074');" style=""> 409             return (((&quot;ajaxredirect:&quot; + getContextPath(request)) + sectionKey) + &quot;/&quot;) + dupId;           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 410         } else {                                                                                         </span>
<span class="-110948502599545681" onmouseenter="enter('-110948502599545681');" onmouseout="out('-110948502599545681');" style=""> 411             return getErrorDuplicatingResponse(response, &quot;Validation_Failure&quot;);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 412         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413     }                                                                                                    </span>
<span  style=""> 414                                                                                                          </span>
<span class="-106656131545478097" onmouseenter="enter('-106656131545478097');" onmouseout="out('-106656131545478097');" style=""> 415     protected String getErrorDuplicatingResponse(HttpServletResponse response, String code) {            </span>
<span class="7659712838923572459" onmouseenter="enter('7659712838923572459');" onmouseout="out('7659712838923572459');" style=""> 416         List&lt;Map&lt;String, Object&gt;&gt; errors = new ArrayList&lt;&gt;();                                            </span>
<span class="-6240695079450735253" onmouseenter="enter('-6240695079450735253');" onmouseout="out('-6240695079450735253');" style=""> 417         String message;                                                                                  </span>
<span class="-7826420477706002406" onmouseenter="enter('-7826420477706002406');" onmouseout="out('-7826420477706002406');" style=""> 418         BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();          </span>
<span class="2995198333406694632" onmouseenter="enter('2995198333406694632');" onmouseout="out('2995198333406694632');" style=""> 419         if ((context != null) &amp;&amp; (context.getMessageSource() != null)) {                                 </span>
<span class="-6756935832772392260" onmouseenter="enter('-6756935832772392260');" onmouseout="out('-6756935832772392260');" style=""> 420             message = context.getMessageSource().getMessage(code, null, code, context.getJavaLocale());  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 421         } else {                                                                                         </span>
<span class="8013232734435478311" onmouseenter="enter('8013232734435478311');" onmouseout="out('8013232734435478311');" style=""><abbr title=" 422             LOG.warn(&quot;Could not find the MessageSource on the current request, &quot; + &quot;not translating the message key&quot;);"> 422             LOG.warn(&quot;Could not find the MessageSource on the current request, &quot; + &quot;not translating the mðŸ”µ</abbr></span>
<span class="599114272120646428" onmouseenter="enter('599114272120646428');" onmouseout="out('599114272120646428');" style=""> 423             message = &quot;Duplication_Failure&quot;;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424         }                                                                                                </span>
<span class="-4703377271641004207" onmouseenter="enter('-4703377271641004207');" onmouseout="out('-4703377271641004207');" style=""> 425         Map&lt;String, Object&gt; errorMap = new HashMap&lt;&gt;();                                                  </span>
<span class="2851590661979449603" onmouseenter="enter('2851590661979449603');" onmouseout="out('2851590661979449603');" style=""> 426         errorMap.put(&quot;errorType&quot;, &quot;global&quot;);                                                             </span>
<span class="4738760182182965590" onmouseenter="enter('4738760182182965590');" onmouseout="out('4738760182182965590');" style=""> 427         errorMap.put(&quot;code&quot;, code);                                                                      </span>
<span class="7426718838785534996" onmouseenter="enter('7426718838785534996');" onmouseout="out('7426718838785534996');" style=""> 428         errorMap.put(&quot;message&quot;, message);                                                                </span>
<span class="-4906289066975989946" onmouseenter="enter('-4906289066975989946');" onmouseout="out('-4906289066975989946');" style=""> 429         errors.add(errorMap);                                                                            </span>
<span class="-8734340547513070222" onmouseenter="enter('-8734340547513070222');" onmouseout="out('-8734340547513070222');" style=""> 430         return new JsonResponse(response).with(&quot;errors&quot;, errors).done();                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431     }                                                                                                    </span>
<span  style=""> 432                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 433     /**                                                                                                  </span>
<span class="9102199281013466170" onmouseenter="enter('9102199281013466170');" onmouseout="out('9102199281013466170');" style=""> 434      * Renders the main entity form for the specified entity                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 435      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 436      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 437      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 438      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 439      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 440      * @param id                                                                                         </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 441      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 442      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 443      */                                                                                                  </span>
<span class="7083955269921705584" onmouseenter="enter('7083955269921705584');" onmouseout="out('7083955269921705584');" style=""> 444     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.GET)                                         </span>
<span class="2570611297886699285" onmouseenter="enter('2570611297886699285');" onmouseout="out('2570611297886699285');" style=""><abbr title=" 445     public String viewEntityForm(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 445     public String viewEntityForm(HttpServletRequest request, HttpServletResponse response, Model model, @ðŸ”µ</abbr></span>
<span class="6743964908211411778" onmouseenter="enter('6743964908211411778');" onmouseout="out('6743964908211411778');" style=""> 446     Map&lt;String, String&gt; pathVars, @PathVariable(&quot;id&quot;)                                                    </span>
<span class="-8555711116400060980" onmouseenter="enter('-8555711116400060980');" onmouseout="out('-8555711116400060980');" style=""> 447     String id) throws Exception {                                                                        </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 448         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 449         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 450         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                           </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""><abbr title=" 451         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);"> 451         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, patðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 452         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-8780243800866475465" onmouseenter="enter('-8780243800866475465');" onmouseout="out('-8780243800866475465');" style=""> 453         Entity entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];    </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""><abbr title=" 454         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);"> 454         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, cðŸ”µ</abbr></span>
<span class="872584542219399793" onmouseenter="enter('872584542219399793');" onmouseout="out('872584542219399793');" style=""> 455         EntityForm entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);        </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 456         modifyEntityForm(entity, entityForm, pathVars);                                                  </span>
<span class="1981952247030149381" onmouseenter="enter('1981952247030149381');" onmouseout="out('1981952247030149381');" style=""> 457         if (request.getParameter(&quot;headerFlash&quot;) != null) {                                               </span>
<span class="-2367607735703612103" onmouseenter="enter('-2367607735703612103');" onmouseout="out('-2367607735703612103');" style=""> 458             model.addAttribute(&quot;headerFlash&quot;, request.getParameter(&quot;headerFlash&quot;));                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459         }                                                                                                </span>
<span class="-6569554975283424126" onmouseenter="enter('-6569554975283424126');" onmouseout="out('-6569554975283424126');" style=""> 460         // Set the sectionKey again incase this is a typed entity                                        </span>
<span class="4201932972037321722" onmouseenter="enter('4201932972037321722');" onmouseout="out('4201932972037321722');" style=""> 461         entityForm.setSectionKey(sectionKey);                                                            </span>
<span class="5387752430767952558" onmouseenter="enter('5387752430767952558');" onmouseout="out('5387752430767952558');" style=""> 462         // Build the current url in the cast that this is a typed entity                                 </span>
<span class="3856485652570637824" onmouseenter="enter('3856485652570637824');" onmouseout="out('3856485652570637824');" style=""> 463         String originatingUri = new UrlPathHelper().getOriginatingRequestUri(request);                   </span>
<span class="-1728408616530607173" onmouseenter="enter('-1728408616530607173');" onmouseout="out('-1728408616530607173');" style=""> 464         int startIndex = request.getContextPath().length();                                              </span>
<span class="654052499558570629" onmouseenter="enter('654052499558570629');" onmouseout="out('654052499558570629');" style=""> 465         // Remove the context path from servlet path                                                     </span>
<span class="526107488063217153" onmouseenter="enter('526107488063217153');" onmouseout="out('526107488063217153');" style=""> 466         String currentUrl = originatingUri.substring(startIndex);                                        </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 467         model.addAttribute(&quot;entity&quot;, entity);                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 468         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-4977411250845897884" onmouseenter="enter('-4977411250845897884');" onmouseout="out('-4977411250845897884');" style=""> 469         model.addAttribute(&quot;currentUrl&quot;, currentUrl);                                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 470         setModelAttributes(model, sectionKey);                                                           </span>
<span class="8236570979651257825" onmouseenter="enter('8236570979651257825');" onmouseout="out('8236570979651257825');" style=""> 471         // We want to replace author ids with their names                                                </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style=""> 472         addAuditableDisplayFields(entityForm);                                                           </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style=""> 473         return resolveAppropriateEntityView(request, model, entityForm);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474     }                                                                                                    </span>
<span  style=""> 475                                                                                                          </span>
<span class="9182660926479189949" onmouseenter="enter('9182660926479189949');" onmouseout="out('9182660926479189949');" style=""><abbr title=" 476     protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, String&gt; pathVars,"> 476     protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, StrðŸ”µ</abbr></span>
<span class="4477928710658117231" onmouseenter="enter('4477928710658117231');" onmouseout="out('4477928710658117231');" style=""> 477                                                               ClassMetadata cmd, Entity entity,          </span>
<span class="5660295431162582196" onmouseenter="enter('5660295431162582196');" onmouseout="out('5660295431162582196');" style=""><abbr title=" 478                                                               List&lt;SectionCrumb&gt; crumbs) throws Exception {"> 478                                                               List&lt;SectionCrumb&gt; crumbs) throws ExceptionðŸ”µ</abbr></span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style=""> 479         String tabName = pathVars.get(&quot;tabName&quot;);                                                        </span>
<span class="5384642555226517985" onmouseenter="enter('5384642555226517985');" onmouseout="out('5384642555226517985');" style=""> 480         if (StringUtils.isEmpty(tabName)) {                                                              </span>
<span class="-3672533750283461484" onmouseenter="enter('-3672533750283461484');" onmouseout="out('-3672533750283461484');" style=""> 481             tabName = cmd.getFirstTab() == null ? &quot;General&quot; : cmd.getFirstTab().getTabName();            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482         }                                                                                                </span>
<span class="-5882478663361935855" onmouseenter="enter('-5882478663361935855');" onmouseout="out('-5882478663361935855');" style=""> 483         return service.getRecordsForSelectedTab(cmd, entity, crumbs, tabName);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484     }                                                                                                    </span>
<span  style=""> 485                                                                                                          </span>
<span class="1953795048205106952" onmouseenter="enter('1953795048205106952');" onmouseout="out('1953795048205106952');" style=""> 486     private boolean isAddRequest(Entity entity) {                                                        </span>
<span class="-2989581670667655563" onmouseenter="enter('-2989581670667655563');" onmouseout="out('-2989581670667655563');" style=""> 487         ExtensionResultHolder&lt;Boolean&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                     </span>
<span class="2773544387861748911" onmouseenter="enter('2773544387861748911');" onmouseout="out('2773544387861748911');" style=""><abbr title=" 488         ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder);"> 488         ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder)ðŸ”µ</abbr></span>
<span class="8622638495597819717" onmouseenter="enter('8622638495597819717');" onmouseout="out('8622638495597819717');" style=""> 489         if (result.equals(ExtensionResultStatusType.NOT_HANDLED)) {                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 490             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491         }                                                                                                </span>
<span  style=""> 492                                                                                                          </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 493         return resultHolder.getResult();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494     }                                                                                                    </span>
<span  style=""> 495                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 496     /**                                                                                                  </span>
<span class="-4864218972040039628" onmouseenter="enter('-4864218972040039628');" onmouseout="out('-4864218972040039628');" style=""> 497      * Attempts to get the List Grid for the selected tab.                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 498      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 499      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 500      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 501      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 502      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 503      * @param id                                                                                         </span>
<span class="4841027518362301903" onmouseenter="enter('4841027518362301903');" onmouseout="out('4841027518362301903');" style=""> 504      * @param tabName                                                                                    </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 505      * @param entityForm                                                                                 </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style=""> 506      * @param entity                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 507      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 508      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 509      */                                                                                                  </span>
<span class="-7675092144868804288" onmouseenter="enter('-7675092144868804288');" onmouseout="out('-7675092144868804288');" style=""> 510     @RequestMapping(value = &quot;/{id}/{tab:[0-9]+}/{tabName}&quot;, method = RequestMethod.POST)                 </span>
<span class="-4141770086387887402" onmouseenter="enter('-4141770086387887402');" onmouseout="out('-4141770086387887402');" style=""><abbr title=" 511     public String viewEntityTab(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 511     public String viewEntityTab(HttpServletRequest request, HttpServletResponse response, Model model, @PðŸ”µ</abbr></span>
<span class="6743964908211411778" onmouseenter="enter('6743964908211411778');" onmouseout="out('6743964908211411778');" style=""> 512     Map&lt;String, String&gt; pathVars, @PathVariable(&quot;id&quot;)                                                    </span>
<span class="-8661857946276696812" onmouseenter="enter('-8661857946276696812');" onmouseout="out('-8661857946276696812');" style=""> 513     String id, @PathVariable(&quot;tabName&quot;)                                                                  </span>
<span class="-99929037322164944" onmouseenter="enter('-99929037322164944');" onmouseout="out('-99929037322164944');" style=""> 514     String tabName, @ModelAttribute(&quot;entityForm&quot;)                                                        </span>
<span class="-7137114655918138966" onmouseenter="enter('-7137114655918138966');" onmouseout="out('-7137114655918138966');" style=""> 515     EntityForm entityForm, @ModelAttribute(&quot;entity&quot;)                                                     </span>
<span class="5820623822704618237" onmouseenter="enter('5820623822704618237');" onmouseout="out('5820623822704618237');" style=""> 516     Entity entity) throws Exception {                                                                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 517         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 518         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 519         List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                           </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""><abbr title=" 520         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);"> 520         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, patðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 521         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 522         entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];           </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""><abbr title=" 523         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);"> 523         Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, cðŸ”µ</abbr></span>
<span class="-3846048132763499568" onmouseenter="enter('-3846048132763499568');" onmouseout="out('-3846048132763499568');" style=""> 524         entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);                   </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 525         modifyEntityForm(entity, entityForm, pathVars);                                                  </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 526         model.addAttribute(&quot;entity&quot;, entity);                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 527         model.addAttribute(&quot;entityForm&quot;, entityForm);                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 528         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 529         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 530         model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                       </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 531         model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                    </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 532         return DEFAULT_CONTAINER_VIEW;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 533     }                                                                                                    </span>
<span  style=""> 534                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 535     /**                                                                                                  </span>
<span class="26428616724277901" onmouseenter="enter('26428616724277901');" onmouseout="out('26428616724277901');" style=""> 536      * Builds JSON that looks like this:                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 537      *                                                                                                   </span>
<span class="-619170819873097874" onmouseenter="enter('-619170819873097874');" onmouseout="out('-619170819873097874');" style=""> 538      * {&quot;errors&quot;:                                                                                        </span>
<span class="-7867797149207986089" onmouseenter="enter('-7867797149207986089');" onmouseout="out('-7867797149207986089');" style=""> 539      *      [{&quot;message&quot;:&quot;This field is Required&quot;,                                                        </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 540      *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                        </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 541      *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 542      *        &quot;errorType&quot;, &quot;field&quot;,                                                                      </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 543      *        &quot;tab&quot;: &quot;General&quot;                                                                           </span>
<span class="762081609125064039" onmouseenter="enter('762081609125064039');" onmouseout="out('762081609125064039');" style=""> 544      *        },                                                                                         </span>
<span class="2065208195238134241" onmouseenter="enter('2065208195238134241');" onmouseout="out('2065208195238134241');" style=""> 545      *        {&quot;message&quot;:&quot;This field is Required&quot;,                                                       </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 546      *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                        </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 547      *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 548      *        &quot;errorType&quot;, &quot;field&quot;,                                                                      </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 549      *        &quot;tab&quot;: &quot;General&quot;                                                                           </span>
<span class="-832778532632947969" onmouseenter="enter('-832778532632947969');" onmouseout="out('-832778532632947969');" style=""> 550      *        }]                                                                                         </span>
<span class="8941010846014250828" onmouseenter="enter('8941010846014250828');" onmouseout="out('8941010846014250828');" style=""> 551      * }                                                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 552      *                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 553      */                                                                                                  </span>
<span class="726178843151373675" onmouseenter="enter('726178843151373675');" onmouseout="out('726178843151373675');" style=""> 554     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST, produces = &quot;application/json&quot;)         </span>
<span class="-4245682307765667372" onmouseenter="enter('-4245682307765667372');" onmouseout="out('-4245682307765667372');" style=""> 555     public String saveEntityJson(HttpServletRequest request, HttpServletResponse response, Model model,  </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 556             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 557             @PathVariable(value = &quot;id&quot;) String id,                                                       </span>
<span class="-5165411007609652701" onmouseenter="enter('-5165411007609652701');" onmouseout="out('-5165411007609652701');" style=""> 558             @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm, BindingResult result,           </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 559             RedirectAttributes ra) throws Exception {                                                    </span>
<span  style=""> 560                                                                                                          </span>
<span class="-7049584637685461961" onmouseenter="enter('-7049584637685461961');" onmouseout="out('-7049584637685461961');" style=""> 561         saveEntity(request, response, model, pathVars, id, entityForm, result, ra);                      </span>
<span  style=""> 562                                                                                                          </span>
<span class="2770382331963423086" onmouseenter="enter('2770382331963423086');" onmouseout="out('2770382331963423086');" style=""> 563         JsonResponse json = new JsonResponse(response);                                                  </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 564         if (result.hasErrors()) {                                                                        </span>
<span class="6668101882629849049" onmouseenter="enter('6668101882629849049');" onmouseout="out('6668101882629849049');" style=""> 565             populateJsonValidationErrors(entityForm, result, json);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566         }                                                                                                </span>
<span class="-8719030961107019295" onmouseenter="enter('-8719030961107019295');" onmouseout="out('-8719030961107019295');" style=""> 567         List&lt;String&gt; dirtyList = buildDirtyList(pathVars, request, id);                                  </span>
<span class="-2397478597494600131" onmouseenter="enter('-2397478597494600131');" onmouseout="out('-2397478597494600131');" style=""> 568         if (CollectionUtils.isNotEmpty(dirtyList)) {                                                     </span>
<span class="-6863151800017638945" onmouseenter="enter('-6863151800017638945');" onmouseout="out('-6863151800017638945');" style=""> 569             json.with(&quot;dirty&quot;, dirtyList);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 570         }                                                                                                </span>
<span  style=""> 571                                                                                                          </span>
<span class="1148846903613025505" onmouseenter="enter('1148846903613025505');" onmouseout="out('1148846903613025505');" style=""> 572         ExtensionResultHolder&lt;String&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                      </span>
<span class="772761850497532920" onmouseenter="enter('772761850497532920');" onmouseout="out('772761850497532920');" style=""><abbr title=" 573         ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonResponse(response, result.hasErrors(), getSectionKey(pathVars), id, resultHolder);"> 573         ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonReðŸ”µ</abbr></span>
<span class="-7225919658162387284" onmouseenter="enter('-7225919658162387284');" onmouseout="out('-7225919658162387284');" style=""> 574         if (resultStatusType.equals(ExtensionResultStatusType.HANDLED)) {                                </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 575             return resultHolder.getResult();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 576         }                                                                                                </span>
<span  style=""> 577                                                                                                          </span>
<span class="-3901811907821215875" onmouseenter="enter('-3901811907821215875');" onmouseout="out('-3901811907821215875');" style=""> 578         return json.done();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579     }                                                                                                    </span>
<span  style=""> 580                                                                                                          </span>
<span class="-2624067384280123527" onmouseenter="enter('-2624067384280123527');" onmouseout="out('-2624067384280123527');" style=""><abbr title=" 581     public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String id) throws ServiceException {"> 581     public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String iðŸ”µ</abbr></span>
<span class="-6199220983064020273" onmouseenter="enter('-6199220983064020273');" onmouseout="out('-6199220983064020273');" style=""> 582         List&lt;String&gt; dirtyList = new ArrayList&lt;&gt;();                                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 583         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 584         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 585         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 586         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 586         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="-6293964121119142853" onmouseenter="enter('-6293964121119142853');" onmouseout="out('-6293964121119142853');" style=""> 587         ClassMetadata cmd = null;                                                                        </span>
<span class="-6100049554794336383" onmouseenter="enter('-6100049554794336383');" onmouseout="out('-6100049554794336383');" style=""> 588         Entity entity = null;                                                                            </span>
<span class="-7221558264805358950" onmouseenter="enter('-7221558264805358950');" onmouseout="out('-7221558264805358950');" style=""> 589         cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();                    </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 590         entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];           </span>
<span  style=""> 591                                                                                                          </span>
<span class="-538034338216639378" onmouseenter="enter('-538034338216639378');" onmouseout="out('-538034338216639378');" style=""> 592         for (Property p: entity.getProperties()) {                                                       </span>
<span class="-5586383415891827802" onmouseenter="enter('-5586383415891827802');" onmouseout="out('-5586383415891827802');" style=""> 593             if (p.getIsDirty()) {                                                                        </span>
<span class="-1571805809811752662" onmouseenter="enter('-1571805809811752662');" onmouseout="out('-1571805809811752662');" style=""> 594                 dirtyList.add(p.getName());                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 596         }                                                                                                </span>
<span class="7211627429904225799" onmouseenter="enter('7211627429904225799');" onmouseout="out('7211627429904225799');" style=""> 597         return dirtyList;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598     }                                                                                                    </span>
<span  style=""> 599                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 600     /**                                                                                                  </span>
<span class="-1912365624495655250" onmouseenter="enter('-1912365624495655250');" onmouseout="out('-1912365624495655250');" style=""><abbr title=" 601      * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity form with"> 601      * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity forðŸ”µ</abbr></span>
<span class="3378821078357952120" onmouseenter="enter('3378821078357952120');" onmouseout="out('3378821078357952120');" style=""> 602      * error fields highlighted. On a successful save, it will refresh the entity page.                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 603      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 604      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 605      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 606      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 607      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 608      * @param id                                                                                         </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 609      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 610      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 611      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 612      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 613      */                                                                                                  </span>
<span class="681227659796054179" onmouseenter="enter('681227659796054179');" onmouseout="out('681227659796054179');" style=""> 614     @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST)                                        </span>
<span class="-4065142006710003019" onmouseenter="enter('-4065142006710003019');" onmouseout="out('-4065142006710003019');" style=""><abbr title=" 615     public String saveEntity(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 615     public String saveEntity(HttpServletRequest request, HttpServletResponse response, Model model, @PathðŸ”µ</abbr></span>
<span class="6743964908211411778" onmouseenter="enter('6743964908211411778');" onmouseout="out('6743964908211411778');" style=""> 616     Map&lt;String, String&gt; pathVars, @PathVariable(&quot;id&quot;)                                                    </span>
<span class="1449222553405438256" onmouseenter="enter('1449222553405438256');" onmouseout="out('1449222553405438256');" style=""> 617     String id, @ModelAttribute(&quot;entityForm&quot;)                                                             </span>
<span class="8991989850575357814" onmouseenter="enter('8991989850575357814');" onmouseout="out('8991989850575357814');" style=""> 618     EntityForm entityForm, BindingResult result, RedirectAttributes ra) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 619         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 620         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 621         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 622         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 622         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 623         ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 624         extractDynamicFormFields(cmd, entityForm);                                                       </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 625         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 625         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="-4517703585527939334" onmouseenter="enter('-4517703585527939334');" onmouseout="out('-4517703585527939334');" style=""> 626         Entity entity = service.updateEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();    </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 627         entityFormValidator.validate(entityForm, entity, result);                                        </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 628         if (result.hasErrors()) {                                                                        </span>
<span class="-9083492279253959347" onmouseenter="enter('-9083492279253959347');" onmouseout="out('-9083492279253959347');" style=""> 629             model.addAttribute(&quot;headerFlash&quot;, &quot;save.unsuccessful&quot;);                                      </span>
<span class="-3255113992478543295" onmouseenter="enter('-3255113992478543295');" onmouseout="out('-3255113992478543295');" style=""> 630             model.addAttribute(&quot;headerFlashAlert&quot;, true);                                                </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 631             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 631             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 632             entityForm.clearFieldsMap();                                                                 </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 633             formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);       </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style=""> 634             modifyEntityForm(entity, entityForm, pathVars);                                              </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 635             model.addAttribute(&quot;entity&quot;, entity);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 636             model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                        </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 637             setModelAttributes(model, sectionKey);                                                       </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style=""> 638             return resolveAppropriateEntityView(request, model, entityForm);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 639         }                                                                                                </span>
<span class="-8977665602521560288" onmouseenter="enter('-8977665602521560288');" onmouseout="out('-8977665602521560288');" style=""> 640         ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;save.successful&quot;);                                          </span>
<span class="-3210629817678777495" onmouseenter="enter('-3210629817678777495');" onmouseout="out('-3210629817678777495');" style=""> 641         return ((&quot;redirect:/&quot; + sectionKey) + &quot;/&quot;) + id;                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 642     }                                                                                                    </span>
<span  style=""> 643                                                                                                          </span>
<span class="-2955125898729179618" onmouseenter="enter('-2955125898729179618');" onmouseout="out('-2955125898729179618');" style=""><abbr title=" 644     protected void modifyEntityForm(final Entity entity, final EntityForm entityForm, final Map&lt;String, String&gt; pathVars) throws Exception {"> 644     protected void modifyEntityForm(final Entity entity, final EntityForm entityForm, final Map&lt;String, SðŸ”µ</abbr></span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style=""> 645         if (isAddRequest(entity)) {                                                                      </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 646             modifyAddEntityForm(entityForm, pathVars);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 647         } else {                                                                                         </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 648             modifyEntityForm(entityForm, pathVars);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 650     }                                                                                                    </span>
<span  style=""> 651                                                                                                          </span>
<span class="4792606531639070058" onmouseenter="enter('4792606531639070058');" onmouseout="out('4792606531639070058');" style=""><abbr title=" 652     protected String resolveAppropriateEntityView(final HttpServletRequest request, final Model model, @ModelAttribute(&quot;entityForm&quot;)"> 652     protected String resolveAppropriateEntityView(final HttpServletRequest request, final Model model, @MðŸ”µ</abbr></span>
<span class="8909778178417006462" onmouseenter="enter('8909778178417006462');" onmouseout="out('8909778178417006462');" style=""> 653     final EntityForm entityForm) {                                                                       </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 654         if (isAjaxRequest(request)) {                                                                    </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style=""> 655             entityForm.setReadOnly();                                                                    </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style=""> 656             model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                          </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style=""> 657             model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 658             return MODAL_CONTAINER_VIEW;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 659         } else {                                                                                         </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 660             model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                   </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 661             model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style=""> 662             return DEFAULT_CONTAINER_VIEW;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 663         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 664     }                                                                                                    </span>
<span  style=""> 665                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 666     /**                                                                                                  </span>
<span class="4876253458579857532" onmouseenter="enter('4876253458579857532');" onmouseout="out('4876253458579857532');" style=""> 667      * Attempts to remove the given entity.                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 668      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 669      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 670      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 671      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 672      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 673      * @param id                                                                                         </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 674      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 675      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 676      */                                                                                                  </span>
<span class="8293921381301703428" onmouseenter="enter('8293921381301703428');" onmouseout="out('8293921381301703428');" style=""> 677     @RequestMapping(value = &quot;/{id}/delete&quot;, method = RequestMethod.POST)                                 </span>
<span class="2352909485282890820" onmouseenter="enter('2352909485282890820');" onmouseout="out('2352909485282890820');" style=""><abbr title=" 678     public String removeEntity(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 678     public String removeEntity(HttpServletRequest request, HttpServletResponse response, Model model, @PaðŸ”µ</abbr></span>
<span class="6743964908211411778" onmouseenter="enter('6743964908211411778');" onmouseout="out('6743964908211411778');" style=""> 679     Map&lt;String, String&gt; pathVars, @PathVariable(&quot;id&quot;)                                                    </span>
<span class="1449222553405438256" onmouseenter="enter('1449222553405438256');" onmouseout="out('1449222553405438256');" style=""> 680     String id, @ModelAttribute(&quot;entityForm&quot;)                                                             </span>
<span class="8991989850575357814" onmouseenter="enter('8991989850575357814');" onmouseout="out('8991989850575357814');" style=""> 681     EntityForm entityForm, BindingResult result, RedirectAttributes ra) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 682         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 683         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 684         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 685         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 685         String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getðŸ”µ</abbr></span>
<span class="6624819200143935214" onmouseenter="enter('6624819200143935214');" onmouseout="out('6624819200143935214');" style=""> 686         Entity entity = service.removeEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();    </span>
<span class="-6561774320633688873" onmouseenter="enter('-6561774320633688873');" onmouseout="out('-6561774320633688873');" style=""> 687         // Removal does not normally return an Entity unless there is some validation error              </span>
<span class="-2807113977407494827" onmouseenter="enter('-2807113977407494827');" onmouseout="out('-2807113977407494827');" style=""> 688         if (entity != null) {                                                                            </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 689             entityFormValidator.validate(entityForm, entity, result);                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 690             if (result.hasErrors()) {                                                                    </span>
<span class="354313568014337940" onmouseenter="enter('354313568014337940');" onmouseout="out('354313568014337940');" style=""> 691                 // Create a flash attribute for the unsuccessful delete                                  </span>
<span class="-3408473788799892596" onmouseenter="enter('-3408473788799892596');" onmouseout="out('-3408473788799892596');" style=""> 692                 FlashMap fm = new FlashMap();                                                            </span>
<span class="-3785724779356953427" onmouseenter="enter('-3785724779356953427');" onmouseout="out('-3785724779356953427');" style=""> 693                 fm.put(&quot;headerFlash&quot;, &quot;delete.unsuccessful&quot;);                                            </span>
<span class="2000410372434500283" onmouseenter="enter('2000410372434500283');" onmouseout="out('2000410372434500283');" style=""> 694                 fm.put(&quot;headerFlashAlert&quot;, true);                                                        </span>
<span class="-216272657842661141" onmouseenter="enter('-216272657842661141');" onmouseout="out('-216272657842661141');" style=""> 695                 request.setAttribute(DispatcherServlet.OUTPUT_FLASH_MAP_ATTRIBUTE, fm);                  </span>
<span class="-9154666565283892619" onmouseenter="enter('-9154666565283892619');" onmouseout="out('-9154666565283892619');" style=""> 696                 // Re-look back up the entity so that we can return something populated                  </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 697                 PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 697                 PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, secðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""><abbr title=" 698                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 698                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData(ðŸ”µ</abbr></span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 699                 entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];   </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 700                 Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 700                 Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr,ðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 701                 entityForm.clearFieldsMap();                                                             </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 702                 formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);   </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 703                 modifyEntityForm(entityForm, pathVars);                                                  </span>
<span class="2790451319108084711" onmouseenter="enter('2790451319108084711');" onmouseout="out('2790451319108084711');" style=""><abbr title=" 704                 return populateJsonValidationErrors(entityForm, result, new JsonResponse(response)).done();"> 704                 return populateJsonValidationErrors(entityForm, result, new JsonResponse(response)).done(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 705             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 706         }                                                                                                </span>
<span class="3611526951082120901" onmouseenter="enter('3611526951082120901');" onmouseout="out('3611526951082120901');" style=""> 707         ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;delete.successful&quot;);                                        </span>
<span class="2579818068351246488" onmouseenter="enter('2579818068351246488');" onmouseout="out('2579818068351246488');" style=""> 708         ra.addFlashAttribute(&quot;headerFlashAlert&quot;, true);                                                  </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 709         if (isAjaxRequest(request)) {                                                                    </span>
<span class="-5684384949344822714" onmouseenter="enter('-5684384949344822714');" onmouseout="out('-5684384949344822714');" style=""> 710             // redirect attributes won&#x27;t work here since ajaxredirect actually makes a new request       </span>
<span class="6183533787948135628" onmouseenter="enter('6183533787948135628');" onmouseout="out('6183533787948135628');" style=""><abbr title=" 711             return ((&quot;ajaxredirect:&quot; + getContextPath(request)) + sectionKey) + &quot;?headerFlash=delete.successful&quot;;"> 711             return ((&quot;ajaxredirect:&quot; + getContextPath(request)) + sectionKey) + &quot;?headerFlash=delete.succðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 712         } else {                                                                                         </span>
<span class="4357427724598824699" onmouseenter="enter('4357427724598824699');" onmouseout="out('4357427724598824699');" style=""> 713             return &quot;redirect:/&quot; + sectionKey;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 714         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 715     }                                                                                                    </span>
<span  style=""> 716                                                                                                          </span>
<span class="-2983794507366563158" onmouseenter="enter('-2983794507366563158');" onmouseout="out('-2983794507366563158');" style=""> 717     @RequestMapping(value = &quot;/{collectionField:.*}/details&quot;, method = RequestMethod.GET)                 </span>
<span class="-527911248282232950" onmouseenter="enter('-527911248282232950');" onmouseout="out('-527911248282232950');" style=""><abbr title=" 718     public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 718     public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpSeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 719             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 720             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-5250072335910309101" onmouseenter="enter('-5250072335910309101');" onmouseout="out('-5250072335910309101');" style=""> 721             @RequestParam String ids,                                                                    </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 722             @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 723         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 724         String sectionClassName = getClassNameForSection(sectionKey);                                    </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 725         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                        </span>
<span class="-5225610456611199616" onmouseenter="enter('-5225610456611199616');" onmouseout="out('-5225610456611199616');" style=""><abbr title=" 726         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, sectionCrumbs, pathVars);"> 726         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParaðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""><abbr title=" 727         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 727         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDataðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 728         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 729         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style=""> 730                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style=""> 731         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span class="-2120492003233088270" onmouseenter="enter('-2120492003233088270');" onmouseout="out('-2120492003233088270');" style=""> 732         ppr.setStartIndex(getStartIndex(requestParams));                                                 </span>
<span class="2736790979641523309" onmouseenter="enter('2736790979641523309');" onmouseout="out('2736790979641523309');" style=""> 733         ppr.setMaxIndex(getMaxIndex(requestParams));                                                     </span>
<span  style=""> 734                                                                                                          </span>
<span class="-8000769512056204294" onmouseenter="enter('-8000769512056204294');" onmouseout="out('-8000769512056204294');" style=""> 735         if (md instanceof BasicFieldMetadata) {                                                          </span>
<span class="-1954892043355765019" onmouseenter="enter('-1954892043355765019');" onmouseout="out('-1954892043355765019');" style=""> 736             String idProp = ((BasicFieldMetadata) md).getForeignKeyProperty();                           </span>
<span class="6288096257758990604" onmouseenter="enter('6288096257758990604');" onmouseout="out('6288096257758990604');" style=""> 737             String displayProp = ((BasicFieldMetadata) md).getForeignKeyDisplayValueProperty();          </span>
<span  style=""> 738                                                                                                          </span>
<span class="-6477100624593005266" onmouseenter="enter('-6477100624593005266');" onmouseout="out('-6477100624593005266');" style=""> 739             List&lt;String&gt; filterValues = BLCArrayUtils.asList(ids.split(FILTER_VALUE_SEPARATOR_REGEX));   </span>
<span class="3640259021720155935" onmouseenter="enter('3640259021720155935');" onmouseout="out('3640259021720155935');" style=""> 740             ppr.addFilterAndSortCriteria(new FilterAndSortCriteria(idProp, filterValues));               </span>
<span  style=""> 741                                                                                                          </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style=""> 742             DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                        </span>
<span class="-2768740094948248396" onmouseenter="enter('-2768740094948248396');" onmouseout="out('-2768740094948248396');" style=""> 743             Map&lt;String, String&gt; returnMap = new HashMap&lt;&gt;();                                             </span>
<span  style=""> 744                                                                                                          </span>
<span class="-5517026699518874938" onmouseenter="enter('-5517026699518874938');" onmouseout="out('-5517026699518874938');" style=""> 745             for (Entity e : drs.getRecords()) {                                                          </span>
<span class="4979367110517822568" onmouseenter="enter('4979367110517822568');" onmouseout="out('4979367110517822568');" style=""> 746                 String id = e.getPMap().get(idProp).getValue();                                          </span>
<span class="-4946347213336092877" onmouseenter="enter('-4946347213336092877');" onmouseout="out('-4946347213336092877');" style=""> 747                 String disp = e.getPMap().get(displayProp).getDisplayValue();                            </span>
<span  style=""> 748                                                                                                          </span>
<span class="3483982845402449596" onmouseenter="enter('3483982845402449596');" onmouseout="out('3483982845402449596');" style=""> 749                 if (StringUtils.isBlank(disp)) {                                                         </span>
<span class="-2027181132953179584" onmouseenter="enter('-2027181132953179584');" onmouseout="out('-2027181132953179584');" style=""> 750                     disp = e.getPMap().get(displayProp).getValue();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 751                 }                                                                                        </span>
<span  style=""> 752                                                                                                          </span>
<span class="-1075893121428940879" onmouseenter="enter('-1075893121428940879');" onmouseout="out('-1075893121428940879');" style=""> 753                 returnMap.put(id,  disp);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 754             }                                                                                            </span>
<span  style=""> 755                                                                                                          </span>
<span class="9157811424862351106" onmouseenter="enter('9157811424862351106');" onmouseout="out('9157811424862351106');" style=""> 756             return returnMap;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 757         }                                                                                                </span>
<span  style=""> 758                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 759         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 760     }                                                                                                    </span>
<span  style=""> 761                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 762     /**                                                                                                  </span>
<span class="7896529828316523089" onmouseenter="enter('7896529828316523089');" onmouseout="out('7896529828316523089');" style=""><abbr title=" 763      * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a list of products"> 763      * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a ðŸ”µ</abbr></span>
<span class="8702245574166025616" onmouseenter="enter('8702245574166025616');" onmouseout="out('8702245574166025616');" style=""> 764      * then this method is invoked when a user clicks on the name of the default category field.         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 765      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 766      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 767      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 768      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 769      * @param pathVars                                                                                   </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 770      * @param collectionField                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 771      * @param id                                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 772      * @return                                                                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 773      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 774      */                                                                                                  </span>
<span class="1405910210670150204" onmouseenter="enter('1405910210670150204');" onmouseout="out('1405910210670150204');" style=""> 775     @RequestMapping(value = &quot;/{collectionField:.*}/{id}/view&quot;, method = RequestMethod.GET)               </span>
<span class="-5496524556428427140" onmouseenter="enter('-5496524556428427140');" onmouseout="out('-5496524556428427140');" style=""><abbr title=" 776     public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 776     public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, ModðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 777             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 778             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-1857511616350008386" onmouseenter="enter('-1857511616350008386');" onmouseout="out('-1857511616350008386');" style=""> 779             @PathVariable(value=&quot;id&quot;) String id) throws Exception {                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 780         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 781         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 782         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 783         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 783         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 784         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="2157347470680130722" onmouseenter="enter('2157347470680130722');" onmouseout="out('2157347470680130722');" style=""> 785         BasicFieldMetadata md = (BasicFieldMetadata) collectionProperty.getMetadata();                   </span>
<span  style=""> 786                                                                                                          </span>
<span class="-1856968160831305726" onmouseenter="enter('-1856968160831305726');" onmouseout="out('-1856968160831305726');" style=""><abbr title=" 787         AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeyClass(), sectionKey);"> 787         AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeðŸ”µ</abbr></span>
<span class="-151095669048618305" onmouseenter="enter('-151095669048618305');" onmouseout="out('-151095669048618305');" style=""><abbr title=" 788         String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : section.getUrl();"> 788         String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : sectiðŸ”µ</abbr></span>
<span class="4949862081138664893" onmouseenter="enter('4949862081138664893');" onmouseout="out('4949862081138664893');" style=""> 789         Map&lt;String, String&gt; varsForField = new HashMap&lt;&gt;();                                              </span>
<span class="-4429965231898090358" onmouseenter="enter('-4429965231898090358');" onmouseout="out('-4429965231898090358');" style=""> 790         varsForField.put(&quot;sectionKey&quot;, sectionUrlKey);                                                   </span>
<span class="4805235980730638518" onmouseenter="enter('4805235980730638518');" onmouseout="out('4805235980730638518');" style=""> 791         return viewEntityForm(request, response, model, varsForField, id);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 792     }                                                                                                    </span>
<span  style=""> 793                                                                                                          </span>
<span class="2731983140361230349" onmouseenter="enter('2731983140361230349');" onmouseout="out('2731983140361230349');" style=""> 794     @RequestMapping(                                                                                     </span>
<span class="4528666449367390600" onmouseenter="enter('4528666449367390600');" onmouseout="out('4528666449367390600');" style=""> 795             value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{tab:[0-9]+}/{tabName}&quot;,              </span>
<span class="7470628324060602258" onmouseenter="enter('7470628324060602258');" onmouseout="out('7470628324060602258');" style=""> 796             method = RequestMethod.POST                                                                  </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 797     )                                                                                                    </span>
<span class="1786222500639285262" onmouseenter="enter('1786222500639285262');" onmouseout="out('1786222500639285262');" style=""><abbr title=" 798     public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model model,"> 798     public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model mðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 799                                         @PathVariable  Map&lt;String, String&gt; pathVars,                     </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 800                                         @PathVariable(value=&quot;id&quot;) String id,                             </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 801                                         @PathVariable(value=&quot;collectionField&quot;) String collectionField,   </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style=""> 802                                         @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId, </span>
<span class="1347902176383833481" onmouseenter="enter('1347902176383833481');" onmouseout="out('1347902176383833481');" style=""> 803                                         @PathVariable(value=&quot;tabName&quot;) String tabName,                   </span>
<span class="-2122907702415237135" onmouseenter="enter('-2122907702415237135');" onmouseout="out('-2122907702415237135');" style=""><abbr title=" 804                                         @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throws Exception {"> 804                                         @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throðŸ”µ</abbr></span>
<span  style=""> 805                                                                                                          </span>
<span class="2284268618604436814" onmouseenter="enter('2284268618604436814');" onmouseout="out('2284268618604436814');" style=""><abbr title=" 806         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ModalHeaderType.VIEW_COLLECTION_ITEM.getType(), entityForm, null);"> 806         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 807     }                                                                                                    </span>
<span  style=""> 808                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 809     /**                                                                                                  </span>
<span class="1274042523848442367" onmouseenter="enter('1274042523848442367');" onmouseout="out('1274042523848442367');" style=""> 810      * Returns the records for a given collectionField filtered by a particular criteria                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 811      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 812      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 813      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 814      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 815      * @param pathVars                                                                                   </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 816      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 817      * @param requestParams                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 818      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 819      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 820      */                                                                                                  </span>
<span class="-4095443548484775059" onmouseenter="enter('-4095443548484775059');" onmouseout="out('-4095443548484775059');" style=""> 821     @RequestMapping(value = &quot;/{id}/{collectionField:.*}&quot;, method = RequestMethod.GET)                    </span>
<span class="-5889287394210369546" onmouseenter="enter('-5889287394210369546');" onmouseout="out('-5889287394210369546');" style=""><abbr title=" 822     public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, Model model,"> 822     public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, ModðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 823             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 824             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 825             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="3465670919255037355" onmouseenter="enter('3465670919255037355');" onmouseout="out('3465670919255037355');" style=""> 826             @RequestParam  MultiValueMap&lt;String, String&gt; requestParams) throws Exception {               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 827         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 828         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 829         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-6545915569490985196" onmouseenter="enter('-6545915569490985196');" onmouseout="out('-6545915569490985196');" style=""><abbr title=" 830         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams, sectionCrumbs, pathVars);"> 830         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams,ðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""><abbr title=" 831         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 831         ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDataðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 832         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style=""> 833                                                                                                          </span>
<span class="-3734134243620930531" onmouseenter="enter('-3734134243620930531');" onmouseout="out('-3734134243620930531');" style=""> 834         ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);               </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title=" 835         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];"> 835         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style=""> 836                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style=""> 837         // Next, we must get the new list grid that represents this collection                           </span>
<span class="-8440278474384944243" onmouseenter="enter('-8440278474384944243');" onmouseout="out('-8440278474384944243');" style=""><abbr title=" 838         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParams, sectionKey, sectionCrumbs);"> 838         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParamsðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 839         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style=""> 840                                                                                                          </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style=""> 841         model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));       </span>
<span  style=""> 842                                                                                                          </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style=""> 843         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 844         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style=""> 845         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 846     }                                                                                                    </span>
<span  style=""> 847                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 848     /**                                                                                                  </span>
<span class="-2279175998905644242" onmouseenter="enter('-2279175998905644242');" onmouseout="out('-2279175998905644242');" style=""><abbr title=" 849      * Shows the modal dialog that is used to add an item to a given collection. There are several possible outcomes"> 849      * Shows the modal dialog that is used to add an item to a given collection. There are several possibðŸ”µ</abbr></span>
<span class="-3490572548815062734" onmouseenter="enter('-3490572548815062734');" onmouseout="out('-3490572548815062734');" style=""> 850      * of this call depending on the type of the specified collection field.                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 851      *                                                                                                   </span>
<span class="2717555647352622731" onmouseenter="enter('2717555647352622731');" onmouseout="out('2717555647352622731');" style=""> 852      * &lt;ul&gt;                                                                                              </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 853      *  &lt;li&gt;                                                                                             </span>
<span class="4930235181592711719" onmouseenter="enter('4930235181592711719');" onmouseout="out('4930235181592711719');" style=""><abbr title=" 854      *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so that the user may"> 854      *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so thaðŸ”µ</abbr></span>
<span class="-3142080293607523336" onmouseenter="enter('-3142080293607523336');" onmouseout="out('-3142080293607523336');" style=""><abbr title=" 855      *    enter information and associate the record with this collection. Used by fields such as ProductAttribute."> 855      *    enter information and associate the record with this collection. Used by fields such as ProductðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 856      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 857      *  &lt;li&gt;                                                                                             </span>
<span class="6319691685860667757" onmouseenter="enter('6319691685860667757');" onmouseout="out('6319691685860667757');" style=""><abbr title=" 858      *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and select it."> 858      *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entiðŸ”µ</abbr></span>
<span class="-8731186021492741581" onmouseenter="enter('-8731186021492741581');" onmouseout="out('-8731186021492741581');" style=""> 859      *    Used by fields such as &quot;allParentCategories&quot;.                                                  </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 860      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 861      *  &lt;li&gt;                                                                                             </span>
<span class="-6847404578833725914" onmouseenter="enter('-6847404578833725914');" onmouseout="out('-6847404578833725914');" style=""><abbr title=" 862      *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 862      *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click onðŸ”µ</abbr></span>
<span class="568361472595397074" onmouseenter="enter('568361472595397074');" onmouseout="out('568361472595397074');" style=""><abbr title=" 863      *    select it. The view rendered by this is identical to basic collection (lookup), but will perform the operation"> 863      *    select it. The view rendered by this is identical to basic collection (lookup), but will perforðŸ”µ</abbr></span>
<span class="-4048066359856567222" onmouseenter="enter('-4048066359856567222');" onmouseout="out('-4048066359856567222');" style=""><abbr title=" 864      *    on an adorned field, which may carry extra meta-information about the created relationship, such as order."> 864      *    on an adorned field, which may carry extra meta-information about the created relationship, sucðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 865      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 866      *  &lt;li&gt;                                                                                             </span>
<span class="7355096557601214207" onmouseenter="enter('7355096557601214207');" onmouseout="out('7355096557601214207');" style=""><abbr title=" 867      *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 867      *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on anðŸ”µ</abbr></span>
<span class="-146713903552295440" onmouseenter="enter('-146713903552295440');" onmouseout="out('-146713903552295440');" style=""><abbr title=" 868      *    select it. Once the user selects the entity, he will be presented with an empty form based on the specified"> 868      *    select it. Once the user selects the entity, he will be presented with an empty form based on tðŸ”µ</abbr></span>
<span class="7585671366133275820" onmouseenter="enter('7585671366133275820');" onmouseout="out('7585671366133275820');" style=""><abbr title=" 869      *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, which in addition"> 869      *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, whiðŸ”µ</abbr></span>
<span class="7350312284882119043" onmouseenter="enter('7350312284882119043');" onmouseout="out('7350312284882119043');" style=""> 870      *    to linking an entity, provide extra fields, such as a promotional message.                     </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 871      *  &lt;/li&gt;                                                                                            </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 872      *  &lt;li&gt;                                                                                             </span>
<span class="8829232354049589291" onmouseenter="enter('8829232354049589291');" onmouseout="out('8829232354049589291');" style=""><abbr title=" 873      *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. This field is"> 873      *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. ðŸ”µ</abbr></span>
<span class="-8508051731153769866" onmouseenter="enter('-8508051731153769866');" onmouseout="out('-8508051731153769866');" style=""><abbr title=" 874      *    populated either from the configured map keys, or as a result of a lookup in the case of a key based on another"> 874      *    populated either from the configured map keys, or as a result of a lookup in the case of a key ðŸ”µ</abbr></span>
<span class="-6056737616128420156" onmouseenter="enter('-6056737616128420156');" onmouseout="out('-6056737616128420156');" style=""> 875      *    entity. Used by fields such as the mediaMap on a Sku.                                          </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 876      *  &lt;/li&gt;                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 877      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 878      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 879      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 880      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 881      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 882      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 883      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 884      * @param requestParams                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 885      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 886      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 887      */                                                                                                  </span>
<span class="835275592837580694" onmouseenter="enter('835275592837580694');" onmouseout="out('835275592837580694');" style=""> 888     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.GET)                </span>
<span class="4902394736721515955" onmouseenter="enter('4902394736721515955');" onmouseout="out('4902394736721515955');" style=""><abbr title=" 889     public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 889     public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model mðŸ”µ</abbr></span>
<span class="6743964908211411778" onmouseenter="enter('6743964908211411778');" onmouseout="out('6743964908211411778');" style=""> 890     Map&lt;String, String&gt; pathVars, @PathVariable(&quot;id&quot;)                                                    </span>
<span class="7290561676301767047" onmouseenter="enter('7290561676301767047');" onmouseout="out('7290561676301767047');" style=""> 891     String id, @PathVariable(&quot;collectionField&quot;)                                                          </span>
<span class="5662947930050952773" onmouseenter="enter('5662947930050952773');" onmouseout="out('5662947930050952773');" style=""> 892     String collectionField, @RequestParam                                                                </span>
<span class="1054657867470972542" onmouseenter="enter('1054657867470972542');" onmouseout="out('1054657867470972542');" style=""> 893     MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 894         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 895         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 896         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 897         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 897         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 898         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 899         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-3281825690379076822" onmouseenter="enter('-3281825690379076822');" onmouseout="out('-3281825690379076822');" style=""><abbr title=" 900         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs).withFilterAndSortCriteria(getCriteria(requestParams)).withStartIndex(getStartIndex(requestParams)).withMaxIndex(getMaxIndex(requestParams)).withLastId(getLastId(requestParams)).withFirstId(getFirstId(requestParams)).withUpperCount(getUpperCount(requestParams)).withLowerCount(getLowerCount(requestParams)).withPageSize(getPageSize(requestParams)).withPresentationFetch(true);"> 900         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs).withFilðŸ”µ</abbr></span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style=""> 901         if (md instanceof BasicCollectionMetadata) {                                                     </span>
<span class="-996348376888288134" onmouseenter="enter('-996348376888288134');" onmouseout="out('-996348376888288134');" style=""> 902             BasicCollectionMetadata fmd = ((BasicCollectionMetadata) (md));                              </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style=""> 903             if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                  </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""><abbr title=" 904                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();"> 904                 ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData(ðŸ”µ</abbr></span>
<span class="-2914433993330253670" onmouseenter="enter('-2914433993330253670');" onmouseout="out('-2914433993330253670');" style=""><abbr title=" 905                 // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types"> 905                 // If the entity type isn&#x27;t specified, we need to determine if there are various polymorpðŸ”µ</abbr></span>
<span class="-7795450821592681641" onmouseenter="enter('-7795450821592681641');" onmouseout="out('-7795450821592681641');" style=""> 906                 // for this entity.                                                                      </span>
<span class="6186895968667433501" onmouseenter="enter('6186895968667433501');" onmouseout="out('6186895968667433501');" style=""> 907                 String entityType = null;                                                                </span>
<span class="3580632700461537732" onmouseenter="enter('3580632700461537732');" onmouseout="out('3580632700461537732');" style=""> 908                 if (requestParams.containsKey(&quot;entityType&quot;)) {                                           </span>
<span class="-1630371572733568969" onmouseenter="enter('-1630371572733568969');" onmouseout="out('-1630371572733568969');" style=""> 909                     entityType = requestParams.get(&quot;entityType&quot;).get(0);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 910                 }                                                                                        </span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style=""> 911                 entityType = determineEntityType(entityType, cmd);                                       </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 912                 if (StringUtils.isBlank(entityType)) {                                                   </span>
<span class="679217737668422196" onmouseenter="enter('679217737668422196');" onmouseout="out('679217737668422196');" style=""> 913                     return getModalForBlankEntityType(request, model, sectionKey, cmd);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 914                 }                                                                                        </span>
<span class="-58316621888079189" onmouseenter="enter('-58316621888079189');" onmouseout="out('-58316621888079189');" style=""> 915                 ppr = ppr.withCeilingEntityClassname(entityType);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 916             }                                                                                            </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style=""> 917         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="1335071684637736926" onmouseenter="enter('1335071684637736926');" onmouseout="out('1335071684637736926');" style=""><abbr title=" 918             ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(request, response, model, sectionKey, id, requestParams, ((MapMetadata) (md)));"> 918             ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionTypðŸ”µ</abbr></span>
<span class="6674469997589527714" onmouseenter="enter('6674469997589527714');" onmouseout="out('6674469997589527714');" style=""> 919             if (result.equals(ExtensionResultStatusType.HANDLED)) {                                      </span>
<span class="1057476267973220454" onmouseenter="enter('1057476267973220454');" onmouseout="out('1057476267973220454');" style=""> 920                 model.addAttribute(&quot;entityId&quot;, id);                                                      </span>
<span class="6720161805434028669" onmouseenter="enter('6720161805434028669');" onmouseout="out('6720161805434028669');" style=""> 921                 model.addAttribute(&quot;sectionKey&quot;, sectionKey);                                            </span>
<span class="-2435595331613687341" onmouseenter="enter('-2435595331613687341');" onmouseout="out('-2435595331613687341');" style=""> 922                 model.addAttribute(&quot;collectionField&quot;, collectionField);                                  </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 923                 return MODAL_CONTAINER_VIEW;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 924             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 925         }                                                                                                </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style=""> 926         model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));       </span>
<span class="6180232744784249160" onmouseenter="enter('6180232744784249160');" onmouseout="out('6180232744784249160');" style=""><abbr title=" 927         return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty, md, ppr, null, null);"> 927         return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, colðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 928     }                                                                                                    </span>
<span  style=""> 929                                                                                                          </span>
<span class="-5048109525362584737" onmouseenter="enter('-5048109525362584737');" onmouseout="out('-5048109525362584737');" style=""><abbr title=" 930     protected String getModalForBlankEntityType(final HttpServletRequest request, final Model model, final String sectionKey, final ClassMetadata cmd) {"> 930     protected String getModalForBlankEntityType(final HttpServletRequest request, final Model model, finaðŸ”µ</abbr></span>
<span class="-2316979209506989336" onmouseenter="enter('-2316979209506989336');" onmouseout="out('-2316979209506989336');" style=""> 931         final List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());             </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style=""> 932         model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                  </span>
<span class="-7344898891916261334" onmouseenter="enter('-7344898891916261334');" onmouseout="out('-7344898891916261334');" style=""> 933         model.addAttribute(&quot;viewType&quot;, &quot;modal/entityTypeSelection&quot;);                                     </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 934         model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());        </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style=""> 935         String requestUri = request.getRequestURI();                                                     </span>
<span class="3126054482386392887" onmouseenter="enter('3126054482386392887');" onmouseout="out('3126054482386392887');" style=""> 936         final String contextPath = request.getContextPath();                                             </span>
<span class="2648330933147498797" onmouseenter="enter('2648330933147498797');" onmouseout="out('2648330933147498797');" style=""> 937         if ((!contextPath.equals(&quot;/&quot;)) &amp;&amp; requestUri.startsWith(contextPath)) {                          </span>
<span class="-5812874762785975576" onmouseenter="enter('-5812874762785975576');" onmouseout="out('-5812874762785975576');" style=""> 938             requestUri = requestUri.substring(contextPath.length() + 1, requestUri.length());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 939         }                                                                                                </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style=""> 940         model.addAttribute(&quot;currentUri&quot;, requestUri);                                                    </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 941         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 942         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style=""> 943         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 944     }                                                                                                    </span>
<span  style=""> 945                                                                                                          </span>
<span class="373770933822047642" onmouseenter="enter('373770933822047642');" onmouseout="out('373770933822047642');" style=""><abbr title=" 946     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMethod.POST)"> 946     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMðŸ”µ</abbr></span>
<span class="-870509305261572147" onmouseenter="enter('-870509305261572147');" onmouseout="out('-870509305261572147');" style=""><abbr title=" 947     public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,"> 947     public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 948             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 949             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 950             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style=""> 951             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 952         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 953         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 954         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 955         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 955         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 956         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 957         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style=""> 958         Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                               </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style=""> 959         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title=" 960             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,"> 960             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, maðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style=""> 961                     collectionField,                                                                     </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style=""> 962                     collectionItemId, responseMap);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 963         }                                                                                                </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style=""> 964         return responseMap;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 965     }                                                                                                    </span>
<span  style=""> 966                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 967     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 968      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 969      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 970      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 971      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 972      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 973      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 974      * @param collectionField                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 975      * @param requestParams                                                                              </span>
<span class="-4008047975326689228" onmouseenter="enter('-4008047975326689228');" onmouseout="out('-4008047975326689228');" style=""> 976      * @return Json collection data                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 977      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 978      */                                                                                                  </span>
<span class="1491507797785399205" onmouseenter="enter('1491507797785399205');" onmouseout="out('1491507797785399205');" style=""> 979     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize&quot;, method = RequestMethod.GET)          </span>
<span class="3400436135683901540" onmouseenter="enter('3400436135683901540');" onmouseout="out('3400436135683901540');" style=""> 980     @ResponseBody                                                                                        </span>
<span class="6684766987121317173" onmouseenter="enter('6684766987121317173');" onmouseout="out('6684766987121317173');" style=""><abbr title=" 981     public Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletResponse response, Model model, @PathVariable"> 981     public Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletRespoðŸ”µ</abbr></span>
<span class="6743964908211411778" onmouseenter="enter('6743964908211411778');" onmouseout="out('6743964908211411778');" style=""> 982     Map&lt;String, String&gt; pathVars, @PathVariable(&quot;id&quot;)                                                    </span>
<span class="7290561676301767047" onmouseenter="enter('7290561676301767047');" onmouseout="out('7290561676301767047');" style=""> 983     String id, @PathVariable(&quot;collectionField&quot;)                                                          </span>
<span class="5662947930050952773" onmouseenter="enter('5662947930050952773');" onmouseout="out('5662947930050952773');" style=""> 984     String collectionField, @RequestParam                                                                </span>
<span class="1054657867470972542" onmouseenter="enter('1054657867470972542');" onmouseout="out('1054657867470972542');" style=""> 985     MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                                      </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 986         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 987         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 988         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 989         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 989         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 990         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 991         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-4651186187628847625" onmouseenter="enter('-4651186187628847625');" onmouseout="out('-4651186187628847625');" style=""><abbr title=" 992         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs).withFilterAndSortCriteria(getCriteria(requestParams)).withStartIndex(getStartIndex(requestParams)).withMaxIndex(getMaxIndex(requestParams));"> 992         PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs).withFilðŸ”µ</abbr></span>
<span class="579227927421006312" onmouseenter="enter('579227927421006312');" onmouseout="out('579227927421006312');" style=""><abbr title=" 993         String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizeCustomCriteria())).toArray(String[]::new);"> 993         String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizðŸ”µ</abbr></span>
<span class="-6207325927333710692" onmouseenter="enter('-6207325927333710692');" onmouseout="out('-6207325927333710692');" style=""> 994         ppr = ppr.withCustomCriteria(both);                                                              </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style=""> 995         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style=""> 996             ppr.setOperationTypesOverride(null);                                                         </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style=""> 997             ppr.setType(PersistencePackageRequest.Type.STANDARD);                                        </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style=""> 998             ppr.setSectionEntityField(collectionField);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 999         }                                                                                                </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1000         DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                            </span>
<span class="9153362413933125536" onmouseenter="enter('9153362413933125536');" onmouseout="out('9153362413933125536');" style=""><abbr title="1001         return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1001         return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1002     }                                                                                                    </span>
<span  style="">1003                                                                                                          </span>
<span class="-7439222430983038453" onmouseenter="enter('-7439222430983038453');" onmouseout="out('-7439222430983038453');" style="">1004     protected String[] buildSelectizeCustomCriteria() {                                                  </span>
<span class="-4161579644301235736" onmouseenter="enter('-4161579644301235736');" onmouseout="out('-4161579644301235736');" style="">1005         return new String[]{ IS_SELECTIZE_REQUEST };                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1006     }                                                                                                    </span>
<span  style="">1007                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1008     /**                                                                                                  </span>
<span class="-7141111024633203374" onmouseenter="enter('-7141111024633203374');" onmouseout="out('-7141111024633203374');" style="">1009      * Adds the requested collection item via Selectize                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1010      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1011      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1012      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1013      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1014      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1015      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1016      * @param collectionField                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1017      * @param entityForm                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1018      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1019      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1020      */                                                                                                  </span>
<span class="4942792763487402415" onmouseenter="enter('4942792763487402415');" onmouseout="out('4942792763487402415');" style="">1021     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize-add&quot;, method = RequestMethod.POST)     </span>
<span class="8163998475300370418" onmouseenter="enter('8163998475300370418');" onmouseout="out('8163998475300370418');" style=""><abbr title="1022     public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1022     public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpSðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1023             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1024             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1025             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1026             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1026             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-3120252458037341618" onmouseenter="enter('-3120252458037341618');" onmouseout="out('-3120252458037341618');" style="">1027         Map&lt;String, Object&gt; returnVal = new HashMap&lt;&gt;();                                                 </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1028         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1029         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1030         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1031         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1031         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1032         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1033                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1034         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1035             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1036             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1037                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1038             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1039         }                                                                                                </span>
<span  style="">1040                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1041         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1041         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style="">1042         ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                           </span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1043         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1044         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1044         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1045                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1046         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1047         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1047         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1048         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1049         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1050                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1051         if (result.hasErrors()) {                                                                        </span>
<span class="842224369260603633" onmouseenter="enter('842224369260603633');" onmouseout="out('842224369260603633');" style="">1052             returnVal.put(&quot;error&quot;, result.getFieldError());                                              </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1053             return returnVal;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1054         }                                                                                                </span>
<span  style="">1055                                                                                                          </span>
<span class="2610632867002015507" onmouseenter="enter('2610632867002015507');" onmouseout="out('2610632867002015507');" style="">1056         if (savedEntity.findProperty(ALTERNATE_ID_PROPERTY) != null) {                                   </span>
<span class="-5383740165855607078" onmouseenter="enter('-5383740165855607078');" onmouseout="out('-5383740165855607078');" style="">1057             returnVal.put(&quot;alternateId&quot;, savedEntity.findProperty(ALTERNATE_ID_PROPERTY).getValue());    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1058         }                                                                                                </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1059         return returnVal;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1060     }                                                                                                    </span>
<span  style="">1061                                                                                                          </span>
<span class="5412920841771640365" onmouseenter="enter('5412920841771640365');" onmouseout="out('5412920841771640365');" style="">1062     protected void declareShouldIgnoreAdditionStatusFilter() {                                           </span>
<span class="-4270951653865217168" onmouseenter="enter('-4270951653865217168');" onmouseout="out('-4270951653865217168');" style=""><abbr title="1063         Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().getAdditionalProperties();">1063         Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().gðŸ”µ</abbr></span>
<span class="-3723341051420574210" onmouseenter="enter('-3723341051420574210');" onmouseout="out('-3723341051420574210');" style="">1064         additionalProperties.put(&quot;shouldIgnoreAdditionStatusFilter&quot;, true);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1065     }                                                                                                    </span>
<span  style="">1066                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1067     /**                                                                                                  </span>
<span class="1325408264830379158" onmouseenter="enter('1325408264830379158');" onmouseout="out('1325408264830379158');" style="">1068      * Adds the requested collection item                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1069      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1070      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1071      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1072      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1073      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1074      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1075      * @param collectionField                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1076      * @param entityForm                                                                                 </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1077      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1078      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1079      */                                                                                                  </span>
<span class="-2068929988984533631" onmouseenter="enter('-2068929988984533631');" onmouseout="out('-2068929988984533631');" style="">1080     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.POST)               </span>
<span class="-6457137423768539998" onmouseenter="enter('-6457137423768539998');" onmouseout="out('-6457137423768539998');" style=""><abbr title="1081     public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1081     public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model modelðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1082             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1083             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1084             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1085             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1085             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1086         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1087         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1088         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1089         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1089         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1090         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1091                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1092         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1093             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1094             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1095                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1096             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1097         }                                                                                                </span>
<span  style="">1098                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1099         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1099         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1100         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1101         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1101         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1102                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1103         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1104         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1104         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1105         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1106         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1107                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1108         if (result.hasErrors()) {                                                                        </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1109             FieldMetadata md = collectionProperty.getMetadata();                                         </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1110             ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                             </span>
<span class="4503162777083318611" onmouseenter="enter('4503162777083318611');" onmouseout="out('4503162777083318611');" style=""><abbr title="1111             return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty,">1111             return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey,ðŸ”µ</abbr></span>
<span class="5267635088951466475" onmouseenter="enter('5267635088951466475');" onmouseout="out('5267635088951466475');" style="">1112                     md, ppr, entityForm, savedEntity);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1113         }                                                                                                </span>
<span  style="">1114                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1115         // Next, we must get the new list grid that represents this collection                           </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1116         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1116         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1117         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span  style="">1118                                                                                                          </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1119         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="7250522969210652718" onmouseenter="enter('7250522969210652718');" onmouseout="out('7250522969210652718');" style="">1120         model.addAttribute(&quot;actualEntityId&quot;, id);                                                        </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1121         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1122         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1123     }                                                                                                    </span>
<span  style="">1124                                                                                                          </span>
<span class="-8003545521832011894" onmouseenter="enter('-8003545521832011894');" onmouseout="out('-8003545521832011894');" style="">1125     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/addEmpty&quot;, method = RequestMethod.POST)          </span>
<span class="162700220048203938" onmouseenter="enter('162700220048203938');" onmouseout="out('162700220048203938');" style=""><abbr title="1126     public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1126     public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse reðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1127             @PathVariable Map&lt;String, String&gt; pathVars,                                                  </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1128             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1129             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""><abbr title="1130             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {">1130             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws ExcepðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1131         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1132         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1133         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1134         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1134         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1135         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1136                                                                                                          </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1137         if (StringUtils.isBlank(entityForm.getEntityType())) {                                           </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1138             FieldMetadata fmd = collectionProperty.getMetadata();                                        </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1139             if (fmd instanceof BasicCollectionMetadata) {                                                </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1140                 entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1141             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1142         }                                                                                                </span>
<span  style="">1143                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1144         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1144         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1145         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1145         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span class="-5337934248855825573" onmouseenter="enter('-5337934248855825573');" onmouseout="out('-5337934248855825573');" style="">1146         entity.setIsPreAdd(true);                                                                        </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1147         // First, we must save the collection entity                                                     </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1148         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1148         PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadataðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1149         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span  style="">1150                                                                                                          </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1151         return new JsonResponse(response)                                                                </span>
<span class="-645443211281069037" onmouseenter="enter('-645443211281069037');" onmouseout="out('-645443211281069037');" style="">1152                 .with(&quot;status&quot;, &quot;complete&quot;)                                                              </span>
<span class="-7858493257692229655" onmouseenter="enter('-7858493257692229655');" onmouseout="out('-7858493257692229655');" style="">1153                 .with(&quot;id&quot;, savedEntity.findProperty(entityForm.getIdProperty()).getValue())             </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1154                 .done();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1155     }                                                                                                    </span>
<span  style="">1156                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1157     /**                                                                                                  </span>
<span class="-6140462241686685910" onmouseenter="enter('-6140462241686685910');" onmouseout="out('-6140462241686685910');" style=""><abbr title="1158      * Builds out all of the model information needed for showing the add modal for collection items on both the initial GET">1158      * Builds out all of the model information needed for showing the add modal for collection items on bðŸ”µ</abbr></span>
<span class="9052968863197617086" onmouseenter="enter('9052968863197617086');" onmouseout="out('9052968863197617086');" style="">1159      * as well as after a POST with validation errors                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1160      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1161      * @param request                                                                                    </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1162      * @param model                                                                                      </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1163      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1164      * @param collectionField                                                                            </span>
<span class="7403666429378321004" onmouseenter="enter('7403666429378321004');" onmouseout="out('7403666429378321004');" style="">1165      * @param sectionKey                                                                                 </span>
<span class="-7927619294366963435" onmouseenter="enter('-7927619294366963435');" onmouseout="out('-7927619294366963435');" style="">1166      * @param collectionProperty                                                                         </span>
<span class="-5426566728726502924" onmouseenter="enter('-5426566728726502924');" onmouseout="out('-5426566728726502924');" style="">1167      * @param md                                                                                         </span>
<span class="4349163197755218506" onmouseenter="enter('4349163197755218506');" onmouseout="out('4349163197755218506');" style="">1168      * @param ppr                                                                                        </span>
<span class="2094225145376343101" onmouseenter="enter('2094225145376343101');" onmouseout="out('2094225145376343101');" style="">1169      * @return the appropriate view to display for the modal                                             </span>
<span class="450948407444547835" onmouseenter="enter('450948407444547835');" onmouseout="out('450948407444547835');" style=""><abbr title="1170      * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, EntityForm, BindingResult)}">1170      * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, StringðŸ”µ</abbr></span>
<span class="3423849059172457982" onmouseenter="enter('3423849059172457982');" onmouseout="out('3423849059172457982');" style=""><abbr title="1171      * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, MultiValueMap)}">1171      * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, StðŸ”µ</abbr></span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1172      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1173      */                                                                                                  </span>
<span class="-1712549159131331616" onmouseenter="enter('-1712549159131331616');" onmouseout="out('-1712549159131331616');" style=""><abbr title="1174     protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse response, Model model, String id, String collectionField, String sectionKey, Property collectionProperty, FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throws ServiceException {">1174     protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse responseðŸ”µ</abbr></span>
<span class="-2054675889041043286" onmouseenter="enter('-2054675889041043286');" onmouseout="out('-2054675889041043286');" style=""><abbr title="1175         // For requests to add a new collection item include the main class that the subsequent request comes from.">1175         // For requests to add a new collection item include the main class that the subsequent request cðŸ”µ</abbr></span>
<span class="7422952884503198827" onmouseenter="enter('7422952884503198827');" onmouseout="out('7422952884503198827');" style=""><abbr title="1176         // For instance, with basic collections we know the main associated class for a fetch through the ForeignKey">1176         // For instance, with basic collections we know the main associated class for a fetch through theðŸ”µ</abbr></span>
<span class="5831142982738818001" onmouseenter="enter('5831142982738818001');" onmouseout="out('5831142982738818001');" style=""><abbr title="1177         // persistence item but map and adorned target lookups make a standard persistence request. This solution">1177         // persistence item but map and adorned target lookups make a standard persistence request. This ðŸ”µ</abbr></span>
<span class="-3910081436214830376" onmouseenter="enter('-3910081436214830376');" onmouseout="out('-3910081436214830376');" style="">1178         // fixes all cases.                                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1179         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-8007514226035577536" onmouseenter="enter('-8007514226035577536');" onmouseout="out('-8007514226035577536');" style="">1180         ppr.addCustomCriteria(&quot;owningClass=&quot; + mainClassName);                                           </span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style="">1181         ppr.setAddOperationInspect(true);                                                                </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1182         if (entityForm != null) {                                                                        </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1183             entityForm.clearFieldsMap();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1184         }                                                                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1185         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style="">1186         if (md instanceof BasicCollectionMetadata) {                                                     </span>
<span class="-996348376888288134" onmouseenter="enter('-996348376888288134');" onmouseout="out('-996348376888288134');" style="">1187             BasicCollectionMetadata fmd = ((BasicCollectionMetadata) (md));                              </span>
<span class="5473401195179812518" onmouseenter="enter('5473401195179812518');" onmouseout="out('5473401195179812518');" style=""><abbr title="1188             // When adding items to basic collections, we will sometimes show a form to persist a new record">1188             // When adding items to basic collections, we will sometimes show a form to persist a new recðŸ”µ</abbr></span>
<span class="3817220166052180028" onmouseenter="enter('3817220166052180028');" onmouseout="out('3817220166052180028');" style="">1189             // and sometimes show a list grid to allow the user to associate an existing record.         </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style="">1190             if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                  </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1191                 ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1191                 ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().geðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1192                 if (entityForm == null) {                                                                </span>
<span class="5775801065792496687" onmouseenter="enter('5775801065792496687');" onmouseout="out('5775801065792496687');" style="">1193                     entityForm = formService.createEntityForm(collectionMetadata, sectionCrumbs);        </span>
<span class="2737056182573571703" onmouseenter="enter('2737056182573571703');" onmouseout="out('2737056182573571703');" style="">1194                     entityForm.setCeilingEntityClassname(ppr.getCeilingEntityClassname());               </span>
<span class="2710161406345740991" onmouseenter="enter('2710161406345740991');" onmouseout="out('2710161406345740991');" style="">1195                     entityForm.setEntityType(ppr.getCeilingEntityClassname());                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1196                 } else {                                                                                 </span>
<span class="-5799643084244932085" onmouseenter="enter('-5799643084244932085');" onmouseout="out('-5799643084244932085');" style="">1197                     formService.populateEntityForm(collectionMetadata, entityForm, sectionCrumbs);       </span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1198                     formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1199                 }                                                                                        </span>
<span class="-7315185064917392199" onmouseenter="enter('-7315185064917392199');" onmouseout="out('-7315185064917392199');" style=""><abbr title="1200                 formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntityClassname());">1200                 formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntitðŸ”µ</abbr></span>
<span class="1687533348183327340" onmouseenter="enter('1687533348183327340');" onmouseout="out('1687533348183327340');" style="">1201                 entityForm.getTabs().iterator().next().getIsVisible();                                   </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1202                 model.addAttribute(&quot;entityForm&quot;, entityForm);                                            </span>
<span class="-2634442257361103125" onmouseenter="enter('-2634442257361103125');" onmouseout="out('-2634442257361103125');" style="">1203                 model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleAddEntity&quot;);                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1204             } else {                                                                                     </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1205                 DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                    </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1206                 ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1206                 ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectðŸ”µ</abbr></span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1207                 listGrid.setPathOverride(request.getRequestURL().toString());                            </span>
<span class="6493773829436488040" onmouseenter="enter('6493773829436488040');" onmouseout="out('6493773829436488040');" style=""><abbr title="1208                 if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUP.equals(fmd.getAddMethodType())) {">1208                 if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUPðŸ”µ</abbr></span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1209                     listGrid.removeAllRowActions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1210                 }                                                                                        </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1211                 model.addAttribute(&quot;listGrid&quot;, listGrid);                                                </span>
<span class="-4615041483574305082" onmouseenter="enter('-4615041483574305082');" onmouseout="out('-4615041483574305082');" style="">1212                 model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleSelectEntity&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1213             }                                                                                            </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1214         } else if (md instanceof AdornedTargetCollectionMetadata) {                                      </span>
<span class="1508526977756681505" onmouseenter="enter('1508526977756681505');" onmouseout="out('1508526977756681505');" style="">1215             AdornedTargetCollectionMetadata fmd = ((AdornedTargetCollectionMetadata) (md));              </span>
<span class="-4994014003685781795" onmouseenter="enter('-4994014003685781795');" onmouseout="out('-4994014003685781795');" style=""><abbr title="1216             // Even though this field represents an adorned target collection, the list we want to show in the modal">1216             // Even though this field represents an adorned target collection, the list we want to show iðŸ”µ</abbr></span>
<span class="3396745077097675731" onmouseenter="enter('3396745077097675731');" onmouseout="out('3396745077097675731');" style="">1217             // is the standard list grid for the target entity of this field                             </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1218             ppr.setOperationTypesOverride(null);                                                         </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1219             ppr.setType(PersistencePackageRequest.Type.STANDARD);                                        </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1220             ppr.setSectionEntityField(collectionField);                                                  </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1221             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1221             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1222             DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                        </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1223             ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1223             ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKðŸ”µ</abbr></span>
<span class="1884537605734649521" onmouseenter="enter('1884537605734649521');" onmouseout="out('1884537605734649521');" style="">1224             listGrid.setSubCollectionFieldName(collectionField);                                         </span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1225             listGrid.setPathOverride(request.getRequestURL().toString());                                </span>
<span class="2370419943178688476" onmouseenter="enter('2370419943178688476');" onmouseout="out('2370419943178688476');" style="">1226             listGrid.setFriendlyName(collectionMetadata.getPolymorphicEntities().getFriendlyName());     </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1227             if (entityForm == null) {                                                                    </span>
<span class="-1229292684052118628" onmouseenter="enter('-1229292684052118628');" onmouseout="out('-1229292684052118628');" style=""><abbr title="1228                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, true);">1228                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectiðŸ”µ</abbr></span>
<span class="-7486141420721649683" onmouseenter="enter('-7486141420721649683');" onmouseout="out('-7486141420721649683');" style=""><abbr title="1229                 entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassname());">1229                 entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassnameðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1230             } else {                                                                                     </span>
<span class="7685228187033982459" onmouseenter="enter('7685228187033982459');" onmouseout="out('7685228187033982459');" style=""><abbr title="1231                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectionCrumbs, true);">1231                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectioðŸ”µ</abbr></span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1232                 formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1233             }                                                                                            </span>
<span class="5169338689637413329" onmouseenter="enter('5169338689637413329');" onmouseout="out('5169338689637413329');" style="">1234             listGrid.setListGridType(ListGrid.Type.ADORNED);                                             </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1235             for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                       </span>
<span class="8450559638200016101" onmouseenter="enter('8450559638200016101');" onmouseout="out('8450559638200016101');" style="">1236                 if (entry.getValue().getIsVisible()) {                                                   </span>
<span class="1657391013588898454" onmouseenter="enter('1657391013588898454');" onmouseout="out('1657391013588898454');" style="">1237                     listGrid.setListGridType(ListGrid.Type.ADORNED_WITH_FORM);                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1238                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1239                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1240             }                                                                                            </span>
<span class="-757286675881477752" onmouseenter="enter('-757286675881477752');" onmouseout="out('-757286675881477752');" style="">1241             // This is part of an add, so we want to be able to filter/sort the listgrid                 </span>
<span class="3421525283764936758" onmouseenter="enter('3421525283764936758');" onmouseout="out('3421525283764936758');" style="">1242             listGrid.setIsSortable(false);                                                               </span>
<span class="-2714096270635703274" onmouseenter="enter('-2714096270635703274');" onmouseout="out('-2714096270635703274');" style="">1243             listGrid.setCanFilterAndSort(true);                                                          </span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1244             listGrid.removeAllRowActions();                                                              </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1245             model.addAttribute(&quot;listGrid&quot;, listGrid);                                                    </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1246             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="-1071174233767081578" onmouseenter="enter('-1071174233767081578');" onmouseout="out('-1071174233767081578');" style="">1247             model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedSelectEntity&quot;);                                 </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1248         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="2110793926177220554" onmouseenter="enter('2110793926177220554');" onmouseout="out('2110793926177220554');" style="">1249             MapMetadata fmd = ((MapMetadata) (md));                                                      </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1250             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1250             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1251             if (entityForm == null) {                                                                    </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style=""><abbr title="1252                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);">1252                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1253             } else {                                                                                     </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1254                 formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);</span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1255                 formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1256             }                                                                                            </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1257             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="-892500240032703395" onmouseenter="enter('-892500240032703395');" onmouseout="out('-892500240032703395');" style="">1258             model.addAttribute(&quot;viewType&quot;, &quot;modal/mapAddEntity&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1259         }                                                                                                </span>
<span class="6074380392351813368" onmouseenter="enter('6074380392351813368');" onmouseout="out('6074380392351813368');" style="">1260         // Set the parent id on the entity form                                                          </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1261         if (entityForm != null) {                                                                        </span>
<span class="-3154229542834445725" onmouseenter="enter('-3154229542834445725');" onmouseout="out('-3154229542834445725');" style="">1262             entityForm.setParentId(id);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1263         }                                                                                                </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1264         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="7819166863376485578" onmouseenter="enter('7819166863376485578');" onmouseout="out('7819166863376485578');" style="">1265         model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_COLLECTION_ITEM.getType());            </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1266         model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1267         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1268         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1269     }                                                                                                    </span>
<span  style="">1270                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1271     /**                                                                                                  </span>
<span class="3915085583429756257" onmouseenter="enter('3915085583429756257');" onmouseout="out('3915085583429756257');" style="">1272      * Shows the appropriate modal dialog to edit the selected collection item                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1273      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1274      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1275      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1276      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1277      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1278      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1279      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1280      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1281      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1282      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1283      */                                                                                                  </span>
<span class="5941881897199209931" onmouseenter="enter('5941881897199209931');" onmouseout="out('5941881897199209931');" style=""><abbr title="1284     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.GET)">1284     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style=""><abbr title="1285     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1285     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, ModeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1286             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1287             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1288             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1289             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1290             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1291         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1291         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1292                 ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1293     }                                                                                                    </span>
<span  style="">1294                                                                                                          </span>
<span class="-3777402830265989862" onmouseenter="enter('-3777402830265989862');" onmouseout="out('-3777402830265989862');" style="">1295     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.GET) </span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style=""><abbr title="1296     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1296     public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, ModeðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1297             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1298             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1299             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1300             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="7585768018133278114" onmouseenter="enter('7585768018133278114');" onmouseout="out('7585768018133278114');" style=""><abbr title="1301         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1301         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1302                 ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1303     }                                                                                                    </span>
<span  style="">1304                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1305     /**                                                                                                  </span>
<span class="6761933478321573145" onmouseenter="enter('6761933478321573145');" onmouseout="out('6761933478321573145');" style=""><abbr title="1306      * Shows the appropriate modal dialog to view the selected collection item. This will display the modal as readonly">1306      * Shows the appropriate modal dialog to view the selected collection item. This will display the modðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1307      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1308      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1309      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1310      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1311      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1312      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1313      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1314      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1315      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1316      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1317      */                                                                                                  </span>
<span class="5228464490364608791" onmouseenter="enter('5228464490364608791');" onmouseout="out('5228464490364608791');" style=""><abbr title="1318     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = RequestMethod.GET)">1318     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = ðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style=""><abbr title="1319     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1319     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model ðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1320             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1321             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1322             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1323             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1324             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="7887850161668822106" onmouseenter="enter('7887850161668822106');" onmouseout="out('7887850161668822106');" style=""><abbr title="1325         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1325         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, colleðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1326                 ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                         </span>
<span  style="">1327                                                                                                          </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1328         // Since this is a read-only view, actions don&#x27;t make sense in this context                      </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1329         EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                    </span>
<span class="7289613241506142720" onmouseenter="enter('7289613241506142720');" onmouseout="out('7289613241506142720');" style="">1330         addAuditableDisplayFields(ef);                                                                   </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1331         ef.removeAllActions();                                                                           </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1332         ef.setReadOnly();                                                                                </span>
<span  style="">1333                                                                                                          </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1334         return returnPath;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1335     }                                                                                                    </span>
<span  style="">1336                                                                                                          </span>
<span class="6858008221927215769" onmouseenter="enter('6858008221927215769');" onmouseout="out('6858008221927215769');" style=""><abbr title="1337     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.GET)">1337     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.ðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style=""><abbr title="1338     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1338     public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model ðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1339             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1340             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1341             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1342             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="2521791674908842244" onmouseenter="enter('2521791674908842244');" onmouseout="out('2521791674908842244');" style=""><abbr title="1343         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1343         String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, colleðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1344                 ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                         </span>
<span  style="">1345                                                                                                          </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1346         // Since this is a read-only view, actions don&#x27;t make sense in this context                      </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1347         EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                    </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1348         ef.removeAllActions();                                                                           </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1349         ef.setReadOnly();                                                                                </span>
<span  style="">1350                                                                                                          </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1351         return returnPath;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1352     }                                                                                                    </span>
<span  style="">1353                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1354     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1354     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="6852009337058352330" onmouseenter="enter('6852009337058352330');" onmouseout="out('6852009337058352330');" style=""><abbr title="1355             String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType) throws ServiceException {">1355             String id, String collectionField, String collectionItemId, String alternateId, String modalHðŸ”µ</abbr></span>
<span class="-2699953653458232908" onmouseenter="enter('-2699953653458232908');" onmouseout="out('-2699953653458232908');" style=""><abbr title="1356         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId, modalHeaderType, null, null);">1356         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1357     }                                                                                                    </span>
<span  style="">1358                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1359     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1359     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="-3706011950121400951" onmouseenter="enter('-3706011950121400951');" onmouseout="out('-3706011950121400951');" style=""><abbr title="1360             String id, String collectionField, String collectionItemId, String modalHeaderType) throws ServiceException {">1360             String id, String collectionField, String collectionItemId, String modalHeaderType) throws SeðŸ”µ</abbr></span>
<span class="-6899013896128397577" onmouseenter="enter('-6899013896128397577');" onmouseout="out('-6899013896128397577');" style=""><abbr title="1361         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, null, null);">1361         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1362     }                                                                                                    </span>
<span  style="">1363                                                                                                          </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1364     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1364     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="4852573692087282601" onmouseenter="enter('4852573692087282601');" onmouseout="out('4852573692087282601');" style=""><abbr title="1365                 String id, String collectionField, String collectionItemId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1365                 String id, String collectionField, String collectionItemId, String modalHeaderType, EntitðŸ”µ</abbr></span>
<span class="6580107021722154279" onmouseenter="enter('6580107021722154279');" onmouseout="out('6580107021722154279');" style=""><abbr title="1366         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, entityForm, entity);">1366         return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1367     }                                                                                                    </span>
<span  style="">1368                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1369     /**                                                                                                  </span>
<span class="837861132196545598" onmouseenter="enter('837861132196545598');" onmouseout="out('837861132196545598');" style=""><abbr title="1370      * Shows the view and populates the model for updating a collection item. You can also pass in an entityform and entity">1370      * Shows the view and populates the model for updating a collection item. You can also pass in an entðŸ”µ</abbr></span>
<span class="5643306329084644224" onmouseenter="enter('5643306329084644224');" onmouseout="out('5643306329084644224');" style="">1371      * which are optional. If they are not passed in then they are automatically looked up               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1372      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1373      * @param request                                                                                    </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1374      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1375      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1376      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1377      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1378      * @param collectionItemId                                                                           </span>
<span class="-5929844173285242940" onmouseenter="enter('-5929844173285242940');" onmouseout="out('-5929844173285242940');" style="">1379      * @param modalHeaderType                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1380      * @param entityForm                                                                                 </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style="">1381      * @param entity                                                                                     </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">1382      * @return                                                                                           </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1383      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1384      */                                                                                                  </span>
<span class="1266907140350915581" onmouseenter="enter('1266907140350915581');" onmouseout="out('1266907140350915581');" style=""><abbr title="1385     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars, String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1385     protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, StringðŸ”µ</abbr></span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1386         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1387         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1388         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1389         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1389         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1390         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1391         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span class="-2889762407992276786" onmouseenter="enter('-2889762407992276786');" onmouseout="out('-2889762407992276786');" style="">1392         SectionCrumb nextCrumb = new SectionCrumb();                                                     </span>
<span class="4180533444018328805" onmouseenter="enter('4180533444018328805');" onmouseout="out('4180533444018328805');" style="">1393         if (md instanceof MapMetadata) {                                                                 </span>
<span class="2710894502845994625" onmouseenter="enter('2710894502845994625');" onmouseout="out('2710894502845994625');" style="">1394             nextCrumb.setSectionIdentifier(((MapMetadata) (md)).getValueClassName());                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1395         } else {                                                                                         </span>
<span class="2766879942838671897" onmouseenter="enter('2766879942838671897');" onmouseout="out('2766879942838671897');" style="">1396             nextCrumb.setSectionIdentifier(((CollectionMetadata) (md)).getCollectionCeilingEntity());    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1397         }                                                                                                </span>
<span class="3745082800889494172" onmouseenter="enter('3745082800889494172');" onmouseout="out('3745082800889494172');" style="">1398         nextCrumb.setSectionId(collectionItemId);                                                        </span>
<span class="7047611651117816234" onmouseenter="enter('7047611651117816234');" onmouseout="out('7047611651117816234');" style="">1399         if (!sectionCrumbs.contains(nextCrumb)) {                                                        </span>
<span class="-6316688126111539901" onmouseenter="enter('-6316688126111539901');" onmouseout="out('-6316688126111539901');" style="">1400             sectionCrumbs.add(nextCrumb);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1401         }                                                                                                </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1402         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1402         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1403         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1403         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getReðŸ”µ</abbr></span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1404         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span class="4263414014170134460" onmouseenter="enter('4263414014170134460');" onmouseout="out('4263414014170134460');" style=""><abbr title="1405         if ((md instanceof BasicCollectionMetadata) &amp;&amp; (((BasicCollectionMetadata) (md)).getAddMethodType().equals(AddMethodType.PERSIST) || ((BasicCollectionMetadata) (md)).getAddMethodType().equals(AddMethodType.PERSIST_EMPTY))) {">1405         if ((md instanceof BasicCollectionMetadata) &amp;&amp; (((BasicCollectionMetadata) (md)).getAddMethodTypeðŸ”µ</abbr></span>
<span class="-996348376888288134" onmouseenter="enter('-996348376888288134');" onmouseout="out('-996348376888288134');" style="">1406             BasicCollectionMetadata fmd = ((BasicCollectionMetadata) (md));                              </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1407             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1407             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1408             if (entity == null) {                                                                        </span>
<span class="4597721164047448054" onmouseenter="enter('4597721164047448054');" onmouseout="out('4597721164047448054');" style=""><abbr title="1409                 entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResultSet().getRecords()[0];">1409                 entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1410             }                                                                                            </span>
<span class="-7942197356638317765" onmouseenter="enter('-7942197356638317765');" onmouseout="out('-7942197356638317765');" style="">1411             String currentTabName = getCurrentTabName(pathVars, collectionMetadata);                     </span>
<span class="9017537031938626444" onmouseenter="enter('9017537031938626444');" onmouseout="out('9017537031938626444');" style=""><abbr title="1412             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetadata, entity, sectionCrumbs, currentTabName);">1412             Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetaðŸ”µ</abbr></span>
<span class="2828362092592644184" onmouseenter="enter('2828362092592644184');" onmouseout="out('2828362092592644184');" style=""><abbr title="1413             entityForm = reinitializeEntityForm(entityForm, collectionMetadata, entity, subRecordsMap, sectionCrumbs);">1413             entityForm = reinitializeEntityForm(entityForm, collectionMetadata, entity, subRecordsMap, seðŸ”µ</abbr></span>
<span class="-3892497188964586657" onmouseenter="enter('-3892497188964586657');" onmouseout="out('-3892497188964586657');" style="">1414             entityForm.removeAction(DefaultEntityFormActions.DELETE);                                    </span>
<span class="6748640999540281749" onmouseenter="enter('6748640999540281749');" onmouseout="out('6748640999540281749');" style="">1415             entityForm.removeAction(DefaultEntityFormActions.DUPLICATE);                                 </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1416             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1417             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="2070483683171714322" onmouseenter="enter('2070483683171714322');" onmouseout="out('2070483683171714322');" style="">1418             model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleEditEntity&quot;);                                    </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1419         } else if (md instanceof AdornedTargetCollectionMetadata) {                                      </span>
<span class="1508526977756681505" onmouseenter="enter('1508526977756681505');" onmouseout="out('1508526977756681505');" style="">1420             AdornedTargetCollectionMetadata fmd = ((AdornedTargetCollectionMetadata) (md));              </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1421             if (entity == null) {                                                                        </span>
<span class="-7347716823881482598" onmouseenter="enter('-7347716823881482598');" onmouseout="out('-7347716823881482598');" style=""><abbr title="1422                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty, collectionItemId, sectionCrumbs, alternateId).getDynamicResultSet().getRecords()[0];">1422                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1423             }                                                                                            </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1424             boolean populateTypeAndId = true;                                                            </span>
<span class="921756716374353809" onmouseenter="enter('921756716374353809');" onmouseout="out('921756716374353809');" style=""><abbr title="1425             boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaderType);">1425             boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1426             if (entityForm == null) {                                                                    </span>
<span class="-8902040329002931298" onmouseenter="enter('-8902040329002931298');" onmouseout="out('-8902040329002931298');" style=""><abbr title="1427                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, sectionCrumbs, false);">1427                 entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollecðŸ”µ</abbr></span>
<span class="-4655192855930300298" onmouseenter="enter('-4655192855930300298');" onmouseout="out('-4655192855930300298');" style="">1428                 entityForm.removeAction(DefaultAdornedEntityFormActions.Add);                            </span>
<span class="1109271490036416226" onmouseenter="enter('1109271490036416226');" onmouseout="out('1109271490036416226');" style="">1429                 entityForm.addAction(DefaultAdornedEntityFormActions.Save);                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1430             } else {                                                                                     </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1431                 entityForm.clearFieldsMap();                                                             </span>
<span class="2583214667713512490" onmouseenter="enter('2583214667713512490');" onmouseout="out('2583214667713512490');" style="">1432                 String entityType = entityForm.getEntityType();                                          </span>
<span class="-6584758178229470245" onmouseenter="enter('-6584758178229470245');" onmouseout="out('-6584758178229470245');" style=""><abbr title="1433                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entityForm, sectionCrumbs, false);">1433                 formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entðŸ”µ</abbr></span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style="">1434                 entityForm.setEntityType(entityType);                                                    </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1435                 populateTypeAndId = false;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1436             }                                                                                            </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1437             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="7409812234697066835" onmouseenter="enter('7409812234697066835');" onmouseout="out('7409812234697066835');" style=""><abbr title="1438             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id, collectionField, collectionItemId, responseMap);">1438             adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, maðŸ”µ</abbr></span>
<span class="2742160767496208814" onmouseenter="enter('2742160767496208814');" onmouseout="out('2742160767496208814');" style=""><abbr title="1439             // For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and Id is used.">1439             // For AdornedTargetCollections, we need to be specific on what translation ceilingEntity andðŸ”µ</abbr></span>
<span class="-5073242989205220681" onmouseenter="enter('-5073242989205220681');" onmouseout="out('-5073242989205220681');" style=""><abbr title="1440             // It should be the entity and referenced Id of the adorned entity (not the target entity and Id).">1440             // It should be the entity and referenced Id of the adorned entity (not the target entity andðŸ”µ</abbr></span>
<span class="316997016312344867" onmouseenter="enter('316997016312344867');" onmouseout="out('316997016312344867');" style="">1441             entityForm.setTranslationCeilingEntity(entityForm.getEntityType());                          </span>
<span class="-4512360180775881719" onmouseenter="enter('-4512360180775881719');" onmouseout="out('-4512360180775881719');" style="">1442             entityForm.setTranslationId(alternateId);                                                    </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style="">1443             ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();  </span>
<span class="-1465905251928147670" onmouseenter="enter('-1465905251928147670');" onmouseout="out('-1465905251928147670');" style="">1444             for (String field : fmd.getMaintainedAdornedTargetFields()) {                                </span>
<span class="-2821179418575098708" onmouseenter="enter('-2821179418575098708');" onmouseout="out('-2821179418575098708');" style="">1445                 if (responseMap.containsKey(field) &amp;&amp; responseMap.containsKey(&quot;autoSubmit&quot;)) {           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1446                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1447                 }                                                                                        </span>
<span class="-3390991397790942785" onmouseenter="enter('-3390991397790942785');" onmouseout="out('-3390991397790942785');" style="">1448                 Property p = cmd.getPMap().get(field);                                                   </span>
<span class="8841772450259568211" onmouseenter="enter('8841772450259568211');" onmouseout="out('8841772450259568211');" style="">1449                 if ((p != null) &amp;&amp; (p.getMetadata() instanceof AdornedTargetCollectionMetadata)) {       </span>
<span class="-1526293730221303684" onmouseenter="enter('-1526293730221303684');" onmouseout="out('-1526293730221303684');" style=""><abbr title="1450                     // Because we&#x27;re dealing with a nested adorned target collection, this particular request must act">1450                     // Because we&#x27;re dealing with a nested adorned target collection, this particular reqðŸ”µ</abbr></span>
<span class="5008429970050276114" onmouseenter="enter('5008429970050276114');" onmouseout="out('5008429970050276114');" style=""><abbr title="1451                     // directly on the first adorned target collection. Because of this, we need the actual id property">1451                     // directly on the first adorned target collection. Because of this, we need the actuðŸ”µ</abbr></span>
<span class="-7713892716328274330" onmouseenter="enter('-7713892716328274330');" onmouseout="out('-7713892716328274330');" style=""><abbr title="1452                     // from the entity that models the adorned target relationship, and not the id of the target object.">1452                     // from the entity that models the adorned target relationship, and not the id of theðŸ”µ</abbr></span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1453                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1453                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ðŸ”µ</abbr></span>
<span class="-8700837243891184186" onmouseenter="enter('-8700837243891184186');" onmouseout="out('-8700837243891184186');" style=""><abbr title="1454                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null, alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();">1454                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, nuðŸ”µ</abbr></span>
<span class="-8426069236906961510" onmouseenter="enter('-8426069236906961510');" onmouseout="out('-8426069236906961510');" style=""><abbr title="1455                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p, ppr.getAdornedList().getAdornedTargetEntityClassname(), sectionCrumbs);">1455                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(ðŸ”µ</abbr></span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1456                     listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                        </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1457                     if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {       </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1458                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1458                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1459                     } else {                                                                             </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1460                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1460                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1461                     }                                                                                    </span>
<span class="91478021664453737" onmouseenter="enter('91478021664453737');" onmouseout="out('91478021664453737');" style="">1462                 } else if ((p != null) &amp;&amp; (p.getMetadata() instanceof MapMetadata)) {                    </span>
<span class="-388196981394792667" onmouseenter="enter('-388196981394792667');" onmouseout="out('-388196981394792667');" style="">1463                     // See above comment for AdornedTargetCollectionMetadata                             </span>
<span class="-5780842363226321337" onmouseenter="enter('-5780842363226321337');" onmouseout="out('-5780842363226321337');" style="">1464                     MapMetadata mmd = ((MapMetadata) (p.getMetadata()));                                 </span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1465                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1465                     Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ðŸ”µ</abbr></span>
<span class="-8700837243891184186" onmouseenter="enter('-8700837243891184186');" onmouseout="out('-8700837243891184186');" style=""><abbr title="1466                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null, alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();">1466                     DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, nuðŸ”µ</abbr></span>
<span class="5816800760712485268" onmouseenter="enter('5816800760712485268');" onmouseout="out('5816800760712485268');" style=""><abbr title="1467                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p, mmd.getTargetClass(), sectionCrumbs);">1467                     ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(ðŸ”µ</abbr></span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1468                     listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                        </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1469                     if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {       </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1470                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1470                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1471                     } else {                                                                             </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1472                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1472                         entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1473                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1474                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1475             }                                                                                            </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style=""><abbr title="1476             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);">1476             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndIdðŸ”µ</abbr></span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1477             formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());       </span>
<span class="7046829326366784672" onmouseenter="enter('7046829326366784672');" onmouseout="out('7046829326366784672');" style="">1478             boolean atLeastOneBasicField = false;                                                        </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1479             for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                       </span>
<span class="7813151848614995896" onmouseenter="enter('7813151848614995896');" onmouseout="out('7813151848614995896');" style=""><abbr title="1480                 if ((entry.getValue().getIsVisible() &amp;&amp; (!responseMap.containsKey(entry.getValue().getName()))) &amp;&amp; (!responseMap.containsKey(&quot;autoSubmit&quot;))) {">1480                 if ((entry.getValue().getIsVisible() &amp;&amp; (!responseMap.containsKey(entry.getValue().getNamðŸ”µ</abbr></span>
<span class="3115307772764059490" onmouseenter="enter('3115307772764059490');" onmouseout="out('3115307772764059490');" style="">1481                     atLeastOneBasicField = true;                                                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1482                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1483                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1484             }                                                                                            </span>
<span class="4813170790944841786" onmouseenter="enter('4813170790944841786');" onmouseout="out('4813170790944841786');" style="">1485             if (!atLeastOneBasicField) {                                                                 </span>
<span class="3364274495995556597" onmouseenter="enter('3364274495995556597');" onmouseout="out('3364274495995556597');" style="">1486                 entityForm.removeAction(DefaultEntityFormActions.SAVE);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1487             }                                                                                            </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1488             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1489             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="3009851293217081678" onmouseenter="enter('3009851293217081678');" onmouseout="out('3009851293217081678');" style="">1490             model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedEditEntity&quot;);                                   </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1491         } else if (md instanceof MapMetadata) {                                                          </span>
<span class="2110793926177220554" onmouseenter="enter('2110793926177220554');" onmouseout="out('2110793926177220554');" style="">1492             MapMetadata fmd = ((MapMetadata) (md));                                                      </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1493             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1493             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1494             if (entity == null) {                                                                        </span>
<span class="6337078590900308198" onmouseenter="enter('6337078590900308198');" onmouseout="out('6337078590900308198');" style=""><abbr title="1495                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty, collectionItemId, sectionCrumbs, null).getEntity();">1495                 entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1496             }                                                                                            </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1497             boolean populateTypeAndId = true;                                                            </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1498             if (entityForm == null) {                                                                    </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style=""><abbr title="1499                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);">1499                 entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id)ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1500             } else {                                                                                     </span>
<span class="-7948993312677492627" onmouseenter="enter('-7948993312677492627');" onmouseout="out('-7948993312677492627');" style="">1501                 // save off the prior key before clearing out the fields map as it will not appear       </span>
<span class="7896310386315991062" onmouseenter="enter('7896310386315991062');" onmouseout="out('7896310386315991062');" style="">1502                 // back on the saved entity                                                              </span>
<span class="-8617997777962995342" onmouseenter="enter('-8617997777962995342');" onmouseout="out('-8617997777962995342');" style="">1503                 String priorKey = entityForm.findField(&quot;priorKey&quot;).getValue();                           </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1504                 entityForm.clearFieldsMap();                                                             </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1505                 formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);</span>
<span class="-5674534809018144237" onmouseenter="enter('-5674534809018144237');" onmouseout="out('-5674534809018144237');" style="">1506                 entityForm.findField(&quot;priorKey&quot;).setValue(priorKey);                                     </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1507                 populateTypeAndId = false;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1508             }                                                                                            </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style=""><abbr title="1509             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);">1509             formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndIdðŸ”µ</abbr></span>
<span class="-7934209705949108459" onmouseenter="enter('-7934209705949108459');" onmouseout="out('-7934209705949108459');" style="">1510             formService.populateMapEntityFormFields(entityForm, entity);                                 </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1511             addAuditableDisplayFields(entityForm);                                                       </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1512             model.addAttribute(&quot;entityForm&quot;, entityForm);                                                </span>
<span class="5184741693677662709" onmouseenter="enter('5184741693677662709');" onmouseout="out('5184741693677662709');" style="">1513             model.addAttribute(&quot;viewType&quot;, &quot;modal/mapEditEntity&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1514         }                                                                                                </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1515         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="5715532112666019496" onmouseenter="enter('5715532112666019496');" onmouseout="out('5715532112666019496');" style="">1516         model.addAttribute(&quot;modalHeaderType&quot;, modalHeaderType);                                          </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1517         model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1518         setModelAttributes(model, sectionKey);                                                           </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="">1519         return MODAL_CONTAINER_VIEW;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1520     }                                                                                                    </span>
<span  style="">1521                                                                                                          </span>
<span class="262150526231288183" onmouseenter="enter('262150526231288183');" onmouseout="out('262150526231288183');" style=""><abbr title="1522     protected EntityForm reinitializeEntityForm(final EntityForm entityForm, final ClassMetadata collectionMetadata, final Entity entity, final Map&lt;String, DynamicResultSet&gt; subRecordsMap, final List&lt;SectionCrumb&gt; sectionCrumbs) throws ServiceException {">1522     protected EntityForm reinitializeEntityForm(final EntityForm entityForm, final ClassMetadata collectiðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1523         if (entityForm == null) {                                                                        </span>
<span class="3992709618683494990" onmouseenter="enter('3992709618683494990');" onmouseout="out('3992709618683494990');" style=""><abbr title="1524             return formService.createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbs);">1524             return formService.createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbs)ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1525         }                                                                                                </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1526         entityForm.clearFieldsMap();                                                                     </span>
<span class="1859879359946483810" onmouseenter="enter('1859879359946483810');" onmouseout="out('1859879359946483810');" style=""><abbr title="1527         formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm, sectionCrumbs);">1527         formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm, sectionCrumðŸ”µ</abbr></span>
<span class="-3720772885488984407" onmouseenter="enter('-3720772885488984407');" onmouseout="out('-3720772885488984407');" style="">1528         // remove all the actions since we&#x27;re not trying to redisplay them on the form                   </span>
<span class="-6469844840195102556" onmouseenter="enter('-6469844840195102556');" onmouseout="out('-6469844840195102556');" style="">1529         entityForm.removeAllActions();                                                                   </span>
<span class="6548609876597156982" onmouseenter="enter('6548609876597156982');" onmouseout="out('6548609876597156982');" style="">1530         return entityForm;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1531     }                                                                                                    </span>
<span  style="">1532                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1533     /**                                                                                                  </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1534      * Updates the specified collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1535      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1536      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1537      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1538      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1539      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1540      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1541      * @param collectionField                                                                            </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1542      * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1542      * @param collectionItemId the collection primary key value (in the case of adorned target collectionðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1543      * @param entityForm                                                                                 </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1544      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1545      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1546      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1547      */                                                                                                  </span>
<span class="1690395709289479208" onmouseenter="enter('1690395709289479208');" onmouseout="out('1690395709289479208');" style="">1548     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.POST)</span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style=""><abbr title="1549     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1549     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1550             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1551             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1552             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1553             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1554             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                   </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1555             BindingResult result) throws Exception {                                                     </span>
<span class="454845068344591329" onmouseenter="enter('454845068344591329');" onmouseout="out('454845068344591329');" style=""><abbr title="1556         return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, entityForm, null, result);">1556         return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1557     }                                                                                                    </span>
<span  style="">1558                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1559     /**                                                                                                  </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1560      * Updates the specified collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1561      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1562      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1563      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1564      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1565      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1566      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1567      * @param collectionField                                                                            </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1568      * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1568      * @param collectionItemId the collection primary key value (in the case of adorned target collectionðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1569      * @param entityForm                                                                                 </span>
<span class="4031667150854181086" onmouseenter="enter('4031667150854181086');" onmouseout="out('4031667150854181086');" style=""><abbr title="1570      * @param alternateId in the case of adorned target collections, this is the primary key value of the collection member">1570      * @param alternateId in the case of adorned target collections, this is the primary key value of theðŸ”µ</abbr></span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1571      * @param result                                                                                     </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1572      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1573      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1574      */                                                                                                  </span>
<span class="6716233350399381715" onmouseenter="enter('6716233350399381715');" onmouseout="out('6716233350399381715');" style=""><abbr title="1575     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.POST)">1575     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style=""><abbr title="1576     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1576     public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1577             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1578             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1579             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1580             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1581             @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                   </span>
<span class="-5366992345424767315" onmouseenter="enter('-5366992345424767315');" onmouseout="out('-5366992345424767315');" style="">1582             @PathVariable(value=&quot;alternateId&quot;) String alternateId,                                       </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1583             BindingResult result) throws Exception {                                                     </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1584         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1585         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1586         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1587         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1587         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1588         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1589                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1590         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1590         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1591         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1591         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1592                                                                                                          </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1593         // First, we must save the collection entity                                                     </span>
<span class="3262117580653454816" onmouseenter="enter('3262117580653454816');" onmouseout="out('3262117580653454816');" style=""><abbr title="1594         PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, collectionItemId, alternateId, sectionCrumbs);">1594         PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1595         Entity savedEntity = persistenceResponse.getEntity();                                            </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1596         entityFormValidator.validate(entityForm, savedEntity, result);                                   </span>
<span  style="">1597                                                                                                          </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1598         if (result.hasErrors()) {                                                                        </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1599             return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1599             return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemðŸ”µ</abbr></span>
<span class="-1009973048758571460" onmouseenter="enter('-1009973048758571460');" onmouseout="out('-1009973048758571460');" style="">1600                     ModalHeaderType.UPDATE_COLLECTION_ITEM.getType(), entityForm, savedEntity);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1601         }                                                                                                </span>
<span  style="">1602                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1603         // Next, we must get the new list grid that represents this collection                           </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1604         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1605         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1605         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span  style="">1606                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1607         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1608         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1609         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1610         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1611     }                                                                                                    </span>
<span  style="">1612                                                                                                          </span>
<span class="-2715204734461845190" onmouseenter="enter('-2715204734461845190');" onmouseout="out('-2715204734461845190');" style=""><abbr title="1613     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMethod.POST)">1613     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMetðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1614     public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,    </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1615             HttpServletResponse response, Model model,                                                   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1616             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1617             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1618             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1619             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="6458961487045284345" onmouseenter="enter('6458961487045284345');" onmouseout="out('6458961487045284345');" style="">1620             @RequestParam(value=&quot;newSequence&quot;) String newSequence) throws Exception {                    </span>
<span class="-6477101312884008952" onmouseenter="enter('-6477101312884008952');" onmouseout="out('-6477101312884008952');" style=""><abbr title="1621         return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collectionItemId, newSequence, null);">1621         return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1622     }                                                                                                    </span>
<span  style="">1623                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1624     /**                                                                                                  </span>
<span class="-7447609122613552365" onmouseenter="enter('-7447609122613552365');" onmouseout="out('-7447609122613552365');" style=""><abbr title="1625      * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target collections">1625      * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target colðŸ”µ</abbr></span>
<span class="5163972519999742424" onmouseenter="enter('5163972519999742424');" onmouseout="out('5163972519999742424');" style=""><abbr title="1626      * where a sort field is specified -- any other invocation is incorrect and will result in an exception.">1626      * where a sort field is specified -- any other invocation is incorrect and will result in an exceptiðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1627      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1628      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1629      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1630      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1631      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1632      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1633      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1634      * @param collectionItemId                                                                           </span>
<span class="8542418631474543845" onmouseenter="enter('8542418631474543845');" onmouseout="out('8542418631474543845');" style="">1635      * @return an object explaining the state of the operation                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1636      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1637      */                                                                                                  </span>
<span class="1279723180837283801" onmouseenter="enter('1279723180837283801');" onmouseout="out('1279723180837283801');" style=""><abbr title="1638     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, method = RequestMethod.POST)">1638     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, methoðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1639     public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,    </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1640             HttpServletResponse response, Model model,                                                   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1641             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1642             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1643             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1644             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="6744719432735700494" onmouseenter="enter('6744719432735700494');" onmouseout="out('6744719432735700494');" style="">1645             @RequestParam(value=&quot;newSequence&quot;) String newSequence,                                       </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1646             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1647         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1648         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1649         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1650         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1650         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1651         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1652         FieldMetadata md = collectionProperty.getMetadata();                                             </span>
<span  style="">1653                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1654         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1654         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="6971869165316675737" onmouseenter="enter('6971869165316675737');" onmouseout="out('6971869165316675737');" style="">1655         ppr.addCustomCriteria(&quot;reorderParentEntityFetch&quot;);                                               </span>
<span  style="">1656                                                                                                          </span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1657         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1657         Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getReðŸ”µ</abbr></span>
<span  style="">1658                                                                                                          </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1659         ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                 </span>
<span  style="">1660                                                                                                          </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1661         if (md instanceof AdornedTargetCollectionMetadata) {                                             </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1662             AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                  </span>
<span class="-895931586936599512" onmouseenter="enter('-895931586936599512');" onmouseout="out('-895931586936599512');" style="">1663             AdornedTargetList atl = ppr.getAdornedList();                                                </span>
<span  style="">1664                                                                                                          </span>
<span class="4013888246220668443" onmouseenter="enter('4013888246220668443');" onmouseout="out('4013888246220668443');" style="">1665             // Get an entity form for the entity                                                         </span>
<span class="4144133685169635892" onmouseenter="enter('4144133685169635892');" onmouseout="out('4144133685169635892');" style=""><abbr title="1666             EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, false);">1666             EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, falseðŸ”µ</abbr></span>
<span class="985151044669117950" onmouseenter="enter('985151044669117950');" onmouseout="out('985151044669117950');" style=""><abbr title="1667             Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,">1667             Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProðŸ”µ</abbr></span>
<span class="-4422231398086337832" onmouseenter="enter('-4422231398086337832');" onmouseout="out('-4422231398086337832');" style=""><abbr title="1668                     collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;})">1668                     collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;}ðŸ”µ</abbr></span>
<span class="-7850695853310911802" onmouseenter="enter('-7850695853310911802');" onmouseout="out('-7850695853310911802');" style="">1669                     .getDynamicResultSet().getRecords()[0];                                              </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1670             formService.populateEntityFormFields(entityForm, entity);                                    </span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1671             formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());       </span>
<span  style="">1672                                                                                                          </span>
<span class="-3124065187694573478" onmouseenter="enter('-3124065187694573478');" onmouseout="out('-3124065187694573478');" style=""><abbr title="1673             // Set the new sequence (note that it will come in 0-indexed but the persistence module expects 1-indexed)">1673             // Set the new sequence (note that it will come in 0-indexed but the persistence module expecðŸ”µ</abbr></span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1674             int sequenceValue = Integer.parseInt(newSequence) + 1;                                       </span>
<span class="2556919505341751863" onmouseenter="enter('2556919505341751863');" onmouseout="out('2556919505341751863');" style="">1675             Field field = entityForm.findField(atl.getSortField());                                      </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1676             field.setValue(String.valueOf(sequenceValue));                                               </span>
<span  style="">1677                                                                                                          </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1678             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="-5669538829732150992" onmouseenter="enter('-5669538829732150992');" onmouseout="out('-5669538829732150992');" style=""><abbr title="1679             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, alternateId, sectionCrumbs);">1679             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMðŸ”µ</abbr></span>
<span class="-6209319883391535282" onmouseenter="enter('-6209319883391535282');" onmouseout="out('-6209319883391535282');" style="">1680             Property displayOrder = persistenceResponse.getEntity().findProperty(atl.getSortField());    </span>
<span  style="">1681                                                                                                          </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1682             responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                             </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1683             responseMap.put(&quot;field&quot;, collectionField);                                                   </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1684             responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());   </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1685             return responseMap;                                                                          </span>
<span class="-3117865694677500361" onmouseenter="enter('-3117865694677500361');" onmouseout="out('-3117865694677500361');" style="">1686         } else if (md instanceof BasicCollectionMetadata) {                                              </span>
<span class="-8492572584837651214" onmouseenter="enter('-8492572584837651214');" onmouseout="out('-8492572584837651214');" style="">1687             BasicCollectionMetadata cd = (BasicCollectionMetadata) md;                                   </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1688             Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                           </span>
<span class="-2546552603594507996" onmouseenter="enter('-2546552603594507996');" onmouseout="out('-2546552603594507996');" style=""><abbr title="1689             Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1689             Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResulðŸ”µ</abbr></span>
<span  style="">1690                                                                                                          </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1691             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1691             ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClaðŸ”µ</abbr></span>
<span class="-2818097934143266938" onmouseenter="enter('-2818097934143266938');" onmouseout="out('-2818097934143266938');" style="">1692             EntityForm entityForm = formService.createEntityForm(collectionMetadata, sectionCrumbs);     </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1693             if (!StringUtils.isEmpty(cd.getSortProperty())) {                                            </span>
<span class="-6303462610985739492" onmouseenter="enter('-6303462610985739492');" onmouseout="out('-6303462610985739492');" style="">1694                 Field f = new Field()                                                                    </span>
<span class="-2538063021289876061" onmouseenter="enter('-2538063021289876061');" onmouseout="out('-2538063021289876061');" style="">1695                         .withName(cd.getSortProperty())                                                  </span>
<span class="-2458072313875538806" onmouseenter="enter('-2458072313875538806');" onmouseout="out('-2458072313875538806');" style="">1696                         .withFieldType(SupportedFieldType.HIDDEN.toString());                            </span>
<span class="5054103958554301667" onmouseenter="enter('5054103958554301667');" onmouseout="out('5054103958554301667');" style="">1697                 entityForm.addHiddenField(mainMetadata, f);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1698             }                                                                                            </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1699             formService.populateEntityFormFields(entityForm, entity);                                    </span>
<span  style="">1700                                                                                                          </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1701             if (!StringUtils.isEmpty(cd.getSortProperty())) {                                            </span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1702                 int sequenceValue = Integer.parseInt(newSequence) + 1;                                   </span>
<span class="-3733495482183042291" onmouseenter="enter('-3733495482183042291');" onmouseout="out('-3733495482183042291');" style="">1703                 Field field = entityForm.findField(cd.getSortProperty());                                </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1704                 field.setValue(String.valueOf(sequenceValue));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1705             }                                                                                            </span>
<span  style="">1706                                                                                                          </span>
<span class="3923458830762383909" onmouseenter="enter('3923458830762383909');" onmouseout="out('3923458830762383909');" style=""><abbr title="1707             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, sectionCrumbs);">1707             PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMðŸ”µ</abbr></span>
<span class="-792608105002716351" onmouseenter="enter('-792608105002716351');" onmouseout="out('-792608105002716351');" style="">1708             Property displayOrder = persistenceResponse.getEntity().findProperty(cd.getSortProperty());  </span>
<span  style="">1709                                                                                                          </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1710             responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                             </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1711             responseMap.put(&quot;field&quot;, collectionField);                                                   </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1712             responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());   </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1713             return responseMap;                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1714         } else {                                                                                         </span>
<span class="7542199431919878786" onmouseenter="enter('7542199431919878786');" onmouseout="out('7542199431919878786');" style=""><abbr title="1715             throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collection fields.&quot;);">1715             throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1716         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1717     }                                                                                                    </span>
<span  style="">1718                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1719     /**                                                                                                  </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1720      * Removes the requested collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1721      *                                                                                                   </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1722      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1722      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collectionðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1723      * map collection.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1724      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1725      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1726      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1727      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1728      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1729      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1730      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1731      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1732      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1733      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1734      */                                                                                                  </span>
<span class="6340503715634976611" onmouseenter="enter('6340503715634976611');" onmouseout="out('6340503715634976611');" style=""><abbr title="1735     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethod.POST)">1735     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethoðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style=""><abbr title="1736     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1736     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1737             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1738             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1739             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1740             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {          </span>
<span class="6845453766150325497" onmouseenter="enter('6845453766150325497');" onmouseout="out('6845453766150325497');" style=""><abbr title="1741         return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, null);">1741         return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1742     }                                                                                                    </span>
<span  style="">1743                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1744     /**                                                                                                  </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1745      * Removes the requested collection item                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1746      *                                                                                                   </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1747      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1747      * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collectionðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1748      * map collection.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1749      *                                                                                                   </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1750      * @param request                                                                                    </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1751      * @param response                                                                                   </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1752      * @param model                                                                                      </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1753      * @param pathVars                                                                                   </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1754      * @param id                                                                                         </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1755      * @param collectionField                                                                            </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1756      * @param collectionItemId                                                                           </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1757      * @return the return view path                                                                      </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1758      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1759      */                                                                                                  </span>
<span class="-4053134536146029119" onmouseenter="enter('-4053134536146029119');" onmouseout="out('-4053134536146029119');" style=""><abbr title="1760     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method = RequestMethod.POST)">1760     @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method ðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style=""><abbr title="1761     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1761     public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model moðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1762             @PathVariable  Map&lt;String, String&gt; pathVars,                                                 </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1763             @PathVariable(value=&quot;id&quot;) String id,                                                         </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1764             @PathVariable(value=&quot;collectionField&quot;) String collectionField,                               </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1765             @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                             </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1766             @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                    </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1767         String sectionKey = getSectionKey(pathVars);                                                     </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1768         String mainClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1769         List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                    </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1770         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1770         ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClaðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1771         Property collectionProperty = mainMetadata.getPMap().get(collectionField);                       </span>
<span  style="">1772                                                                                                          </span>
<span class="-6408221600487262974" onmouseenter="enter('-6408221600487262974');" onmouseout="out('-6408221600487262974');" style="">1773         String priorKey = request.getParameter(&quot;key&quot;);                                                   </span>
<span  style="">1774                                                                                                          </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1775         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1775         PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1776         declareShouldIgnoreAdditionStatusFilter();                                                       </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""><abbr title="1777         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1777         Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords(ðŸ”µ</abbr></span>
<span  style="">1778                                                                                                          </span>
<span class="8107528363762278945" onmouseenter="enter('8107528363762278945');" onmouseout="out('8107528363762278945');" style="">1779         // First, we must remove the collection entity                                                   </span>
<span class="-8185015406879465962" onmouseenter="enter('-8185015406879465962');" onmouseout="out('-8185015406879465962');" style=""><abbr title="1780         PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectionProperty, entity, collectionItemId, alternateId, priorKey, sectionCrumbs);">1780         PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectðŸ”µ</abbr></span>
<span class="4740780245520344929" onmouseenter="enter('4740780245520344929');" onmouseout="out('4740780245520344929');" style=""><abbr title="1781         if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailure()) {">1781         if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailurðŸ”µ</abbr></span>
<span class="-1907173364280213129" onmouseenter="enter('-1907173364280213129');" onmouseout="out('-1907173364280213129');" style="">1782             String error = &quot;There was an error removing the whatever&quot;;                                   </span>
<span class="6694909055776458558" onmouseenter="enter('6694909055776458558');" onmouseout="out('6694909055776458558');" style="">1783             if (MapUtils.isNotEmpty(persistenceResponse.getEntity().getPropertyValidationErrors())) {    </span>
<span class="2653002805011151778" onmouseenter="enter('2653002805011151778');" onmouseout="out('2653002805011151778');" style="">1784                 // If we failed, we&#x27;ll return some JSON with the first error                             </span>
<span class="6101527636004026445" onmouseenter="enter('6101527636004026445');" onmouseout="out('6101527636004026445');" style=""><abbr title="1785                 error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator().next().get(0);">1785                 error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator()ðŸ”µ</abbr></span>
<span class="3589903040125146199" onmouseenter="enter('3589903040125146199');" onmouseout="out('3589903040125146199');" style=""><abbr title="1786             } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErrors())) {">1786             } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErroðŸ”µ</abbr></span>
<span class="-8002349788440125315" onmouseenter="enter('-8002349788440125315');" onmouseout="out('-8002349788440125315');" style="">1787                 error = persistenceResponse.getEntity().getGlobalValidationErrors().get(0);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1788             }                                                                                            </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1789             return new JsonResponse(response)                                                            </span>
<span class="4764127484129551096" onmouseenter="enter('4764127484129551096');" onmouseout="out('4764127484129551096');" style="">1790                 .with(&quot;status&quot;, &quot;error&quot;)                                                                 </span>
<span class="-4778619806303294332" onmouseenter="enter('-4778619806303294332');" onmouseout="out('-4778619806303294332');" style="">1791                 .with(&quot;message&quot;, BLCMessageUtils.getMessage(error))                                      </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1792                 .done();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1793         }                                                                                                </span>
<span  style="">1794                                                                                                          </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1795         // Next, we must get the new list grid that represents this collection                           </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1796         // We return the new list grid so that it can replace the currently visible one                  </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1797         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1797         ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionðŸ”µ</abbr></span>
<span  style="">1798                                                                                                          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1799         model.addAttribute(&quot;listGrid&quot;, listGrid);                                                        </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1800         model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                            </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1801         setModelAttributes(model, sectionKey);                                                           </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1802         return &quot;views/standaloneListGrid&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1803     }                                                                                                    </span>
<span  style="">1804                                                                                                          </span>
<span class="-1722269672251008380" onmouseenter="enter('-1722269672251008380');" onmouseout="out('-1722269672251008380');" style="">1805     public void addAuditableDisplayFields(EntityForm entityForm) {                                       </span>
<span class="2220665039639111541" onmouseenter="enter('2220665039639111541');" onmouseout="out('2220665039639111541');" style="">1806         Field createdBy = entityForm.findField(&quot;auditable.createdBy&quot;);                                   </span>
<span class="-1310269621989930827" onmouseenter="enter('-1310269621989930827');" onmouseout="out('-1310269621989930827');" style="">1807         if (createdBy != null &amp;&amp; createdBy.getValue() != null) {                                         </span>
<span class="3065344382927201496" onmouseenter="enter('3065344382927201496');" onmouseout="out('3065344382927201496');" style="">1808             addAuditableDisplayField(entityForm, createdBy);                                             </span>
<span  style="">1809                                                                                                          </span>
<span class="-8232178899610643805" onmouseenter="enter('-8232178899610643805');" onmouseout="out('-8232178899610643805');" style="">1810             createdBy.setIsVisible(false);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1811         }                                                                                                </span>
<span class="1393544913931451876" onmouseenter="enter('1393544913931451876');" onmouseout="out('1393544913931451876');" style="">1812         Field updatedBy = entityForm.findField(&quot;auditable.updatedBy&quot;);                                   </span>
<span class="362865388069983596" onmouseenter="enter('362865388069983596');" onmouseout="out('362865388069983596');" style="">1813         if (updatedBy != null &amp;&amp; updatedBy.getValue() != null) {                                         </span>
<span class="-892302887107162271" onmouseenter="enter('-892302887107162271');" onmouseout="out('-892302887107162271');" style="">1814             addAuditableDisplayField(entityForm, updatedBy);                                             </span>
<span  style="">1815                                                                                                          </span>
<span class="6398063041947851488" onmouseenter="enter('6398063041947851488');" onmouseout="out('6398063041947851488');" style="">1816             updatedBy.setIsVisible(false);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1817         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1818     }                                                                                                    </span>
<span  style="">1819                                                                                                          </span>
<span class="4984267825623541739" onmouseenter="enter('4984267825623541739');" onmouseout="out('4984267825623541739');" style="">1820     private void addAuditableDisplayField(EntityForm entityForm, Field userField) {                      </span>
<span class="-4635466229336929139" onmouseenter="enter('-4635466229336929139');" onmouseout="out('-4635466229336929139');" style="">1821         Field displayField = buildAuditableDisplayField(userField);                                      </span>
<span  style="">1822                                                                                                          </span>
<span class="-3510960703864117903" onmouseenter="enter('-3510960703864117903');" onmouseout="out('-3510960703864117903');" style="">1823         AdminUser user = adminUserDao.readAdminUserById(Long.parseLong(userField.getValue()));           </span>
<span class="-2749914300638269457" onmouseenter="enter('-2749914300638269457');" onmouseout="out('-2749914300638269457');" style="">1824         String userName = user == null ? null : user.getName();                                          </span>
<span class="-519467923242361473" onmouseenter="enter('-519467923242361473');" onmouseout="out('-519467923242361473');" style="">1825         displayField.setValue(userName);                                                                 </span>
<span  style="">1826                                                                                                          </span>
<span class="2796866146572271884" onmouseenter="enter('2796866146572271884');" onmouseout="out('2796866146572271884');" style="">1827         FieldGroup auditGroup = entityForm.findGroup(&quot;AdminAuditable_Audit&quot;);                            </span>
<span class="442119087406556402" onmouseenter="enter('442119087406556402');" onmouseout="out('442119087406556402');" style="">1828         if (auditGroup != null) {                                                                        </span>
<span class="2790071812155889083" onmouseenter="enter('2790071812155889083');" onmouseout="out('2790071812155889083');" style="">1829             auditGroup.addField(displayField);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1830         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1831     }                                                                                                    </span>
<span  style="">1832                                                                                                          </span>
<span class="-898012728924165157" onmouseenter="enter('-898012728924165157');" onmouseout="out('-898012728924165157');" style="">1833     private Field buildAuditableDisplayField(Field auditableField) {                                     </span>
<span class="7586031541837577475" onmouseenter="enter('7586031541837577475');" onmouseout="out('7586031541837577475');" style="">1834         return new Field().withFieldType(SupportedFieldType.STRING.toString())                           </span>
<span class="-5983163062967947616" onmouseenter="enter('-5983163062967947616');" onmouseout="out('-5983163062967947616');" style="">1835                 .withName(auditableField.getName() + &quot;Display&quot;)                                          </span>
<span class="-3810520855500417343" onmouseenter="enter('-3810520855500417343');" onmouseout="out('-3810520855500417343');" style="">1836                 .withFriendlyName(auditableField.getFriendlyName())                                      </span>
<span class="-2087540063707551713" onmouseenter="enter('-2087540063707551713');" onmouseout="out('-2087540063707551713');" style="">1837                 .withOrder(auditableField.getOrder())                                                    </span>
<span class="3252055162848788175" onmouseenter="enter('3252055162848788175');" onmouseout="out('3252055162848788175');" style="">1838                 .withOwningEntityClass(auditableField.getOwningEntityClass())                            </span>
<span class="8052491048417023702" onmouseenter="enter('8052491048417023702');" onmouseout="out('8052491048417023702');" style="">1839                 .withReadOnly(true);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1840     }                                                                                                    </span>
<span  style="">1841                                                                                                          </span>
<span class="2512746595428590302" onmouseenter="enter('2512746595428590302');" onmouseout="out('2512746595428590302');" style="">1842     protected String getCurrentTabName(Map&lt;String, String&gt; pathVars, ClassMetadata cmd) {                </span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style="">1843         String tabName = pathVars.get(&quot;tabName&quot;);                                                        </span>
<span class="620358619967646231" onmouseenter="enter('620358619967646231');" onmouseout="out('620358619967646231');" style="">1844         if (StringUtils.isBlank(tabName)) {                                                              </span>
<span class="-8386812650765964886" onmouseenter="enter('-8386812650765964886');" onmouseout="out('-8386812650765964886');" style="">1845             TabMetadata firstTab = cmd.getFirstTab();                                                    </span>
<span class="5997097813726693180" onmouseenter="enter('5997097813726693180');" onmouseout="out('5997097813726693180');" style="">1846             return firstTab != null ? firstTab.getTabName() : &quot;General&quot;;                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1847         }                                                                                                </span>
<span class="-6789109484485831180" onmouseenter="enter('-6789109484485831180');" onmouseout="out('-6789109484485831180');" style="">1848         return tabName;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1849     }                                                                                                    </span>
<span  style="">1850                                                                                                          </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">1851     // *****************************************                                                         </span>
<span class="2492884656402841956" onmouseenter="enter('2492884656402841956');" onmouseout="out('2492884656402841956');" style="">1852     // Typed Entity Helper Methods                                                                       </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">1853     // *****************************************                                                         </span>
<span  style="">1854                                                                                                          </span>
<span class="709722161552159597" onmouseenter="enter('709722161552159597');" onmouseout="out('709722161552159597');" style="">1855     protected void setTypedEntityModelAttributes(HttpServletRequest request, Model model) {              </span>
<span class="2572860224956804545" onmouseenter="enter('2572860224956804545');" onmouseout="out('2572860224956804545');" style="">1856         // Check if this is a typed entity                                                               </span>
<span class="-601784761218487618" onmouseenter="enter('-601784761218487618');" onmouseout="out('-601784761218487618');" style="">1857         AdminSection typedEntitySection = (AdminSection) request.getAttribute(&quot;typedEntitySection&quot;);     </span>
<span class="2356861889771822774" onmouseenter="enter('2356861889771822774');" onmouseout="out('2356861889771822774');" style="">1858         if (typedEntitySection != null) {                                                                </span>
<span class="-7054855399164801351" onmouseenter="enter('-7054855399164801351');" onmouseout="out('-7054855399164801351');" style="">1859             // Update the friendly name for this Entity Type                                             </span>
<span class="-8436584596314077038" onmouseenter="enter('-8436584596314077038');" onmouseout="out('-8436584596314077038');" style="">1860             model.addAttribute(&quot;entityFriendlyName&quot;, typedEntitySection.getName());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1861         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1862     }                                                                                                    </span>
<span  style="">1863                                                                                                          </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">1864     // *********************************                                                                 </span>
<span class="5570644305110686760" onmouseenter="enter('5570644305110686760');" onmouseout="out('5570644305110686760');" style="">1865     // ADDITIONAL SPRING-BOUND METHODS *                                                                 </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">1866     // *********************************                                                                 </span>
<span  style="">1867                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1868     /**                                                                                                  </span>
<span class="-6771709729688841784" onmouseenter="enter('-6771709729688841784');" onmouseout="out('-6771709729688841784');" style=""><abbr title="1869      * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding process.">1869      * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding ðŸ”µ</abbr></span>
<span class="2498077318751920180" onmouseenter="enter('2498077318751920180');" onmouseout="out('2498077318751920180');" style=""><abbr title="1870      * By default, we register a binder that treats empty Strings as null and a Boolean editor that supports either true">1870      * By default, we register a binder that treats empty Strings as null and a Boolean editor that suppoðŸ”µ</abbr></span>
<span class="4465303089468973962" onmouseenter="enter('4465303089468973962');" onmouseout="out('4465303089468973962');" style="">1871      * or false. If the value is passed in as null, it will treat it as false.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1872      *                                                                                                   </span>
<span class="-3898462538136412996" onmouseenter="enter('-3898462538136412996');" onmouseout="out('-3898462538136412996');" style="">1873      * @param binder                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1874      */                                                                                                  </span>
<span class="2978104519843175555" onmouseenter="enter('2978104519843175555');" onmouseout="out('2978104519843175555');" style="">1875     @InitBinder                                                                                          </span>
<span class="4179572271848089300" onmouseenter="enter('4179572271848089300');" onmouseout="out('4179572271848089300');" style="">1876     public void initBinder(WebDataBinder binder) {                                                       </span>
<span class="3888201586857511470" onmouseenter="enter('3888201586857511470');" onmouseout="out('3888201586857511470');" style="">1877         binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));                        </span>
<span class="-4458929942740752488" onmouseenter="enter('-4458929942740752488');" onmouseout="out('-4458929942740752488');" style="">1878         binder.registerCustomEditor(Boolean.class, new NonNullBooleanEditor());                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1879     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1880 }                                                                                                        </span>






















































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="913821711322743166" onmouseenter="enter('913821711322743166');" onmouseout="out('913821711322743166');" style="">  18  package org.broadleafcommerce.openadmin.web.controller.entity;                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  20  import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  21  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="3542918789910249764" onmouseenter="enter('3542918789910249764');" onmouseout="out('3542918789910249764');" style="">  25  import org.broadleafcommerce.common.exception.SecurityServiceException;                                           </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  26  import org.broadleafcommerce.common.exception.ServiceException;                                                   </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  27  import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                              </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  28  import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                          </span>

<span class="-6648433550510659033" onmouseenter="enter('-6648433550510659033');" onmouseout="out('-6648433550510659033');" style="">  29  import org.broadleafcommerce.common.presentation.client.AddMethodType;                                            </span>
<span class="1362364260528215152" onmouseenter="enter('1362364260528215152');" onmouseout="out('1362364260528215152');" style="">  30  import org.broadleafcommerce.common.presentation.client.SupportedFieldType;                                       </span>
<span class="-2818686525334833130" onmouseenter="enter('-2818686525334833130');" onmouseout="out('-2818686525334833130');" style="">  31  import org.broadleafcommerce.common.sandbox.SandBoxHelper;                                                        </span>

<span class="2429458746821399950" onmouseenter="enter('2429458746821399950');" onmouseout="out('2429458746821399950');" style="">  32  import org.broadleafcommerce.common.util.BLCArrayUtils;                                                           </span>
<span class="2428099238642943960" onmouseenter="enter('2428099238642943960');" onmouseout="out('2428099238642943960');" style="">  33  import org.broadleafcommerce.common.util.BLCMessageUtils;                                                         </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  34  import org.broadleafcommerce.common.web.BroadleafRequestContext;                                                  </span>
<span class="-1418036767363331062" onmouseenter="enter('-1418036767363331062');" onmouseout="out('-1418036767363331062');" style="">  35  import org.broadleafcommerce.common.web.JsonResponse;                                                             </span>
<span class="-3361215363157046739" onmouseenter="enter('-3361215363157046739');" onmouseout="out('-3361215363157046739');" style="">  36  import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;                                       </span>
<span class="-1781055592725563383" onmouseenter="enter('-1781055592725563383');" onmouseout="out('-1781055592725563383');" style="">  37  import org.broadleafcommerce.openadmin.dto.AdornedTargetList;                                                     </span>
<span class="-6140296335181984013" onmouseenter="enter('-6140296335181984013');" onmouseout="out('-6140296335181984013');" style="">  38  import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;                                               </span>
<span class="4427537537958608766" onmouseenter="enter('4427537537958608766');" onmouseout="out('4427537537958608766');" style="">  39  import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;                                                    </span>
<span class="-1607559599739253077" onmouseenter="enter('-1607559599739253077');" onmouseout="out('-1607559599739253077');" style="">  40  import org.broadleafcommerce.openadmin.dto.ClassMetadata;                                                         </span>
<span class="5550564421881377532" onmouseenter="enter('5550564421881377532');" onmouseout="out('5550564421881377532');" style="">  41  import org.broadleafcommerce.openadmin.dto.ClassTree;                                                             </span>
<span class="-3165611006566133086" onmouseenter="enter('-3165611006566133086');" onmouseout="out('-3165611006566133086');" style="">  42  import org.broadleafcommerce.openadmin.dto.CollectionMetadata;                                                    </span>
<span class="-4742435063138209714" onmouseenter="enter('-4742435063138209714');" onmouseout="out('-4742435063138209714');" style="">  43  import org.broadleafcommerce.openadmin.dto.DynamicResultSet;                                                      </span>
<span class="-5093421835888664541" onmouseenter="enter('-5093421835888664541');" onmouseout="out('-5093421835888664541');" style="">  44  import org.broadleafcommerce.openadmin.dto.Entity;                                                                </span>
<span class="-8829499667991596741" onmouseenter="enter('-8829499667991596741');" onmouseout="out('-8829499667991596741');" style="">  45  import org.broadleafcommerce.openadmin.dto.FieldMetadata;                                                         </span>
<span class="6369021917986026789" onmouseenter="enter('6369021917986026789');" onmouseout="out('6369021917986026789');" style="">  46  import org.broadleafcommerce.openadmin.dto.FilterAndSortCriteria;                                                 </span>
<span class="826821438795056004" onmouseenter="enter('826821438795056004');" onmouseout="out('826821438795056004');" style="">  47  import org.broadleafcommerce.openadmin.dto.MapMetadata;                                                           </span>
<span class="1983554291461039357" onmouseenter="enter('1983554291461039357');" onmouseout="out('1983554291461039357');" style="">  48  import org.broadleafcommerce.openadmin.dto.Property;                                                              </span>
<span class="1696571253156436279" onmouseenter="enter('1696571253156436279');" onmouseout="out('1696571253156436279');" style="">  49  import org.broadleafcommerce.openadmin.dto.SectionCrumb;                                                          </span>
<span class="5662236005419086618" onmouseenter="enter('5662236005419086618');" onmouseout="out('5662236005419086618');" style="">  50  import org.broadleafcommerce.openadmin.dto.TabMetadata;                                                           </span>
<span class="-8828889589519173652" onmouseenter="enter('-8828889589519173652');" onmouseout="out('-8828889589519173652');" style="">  51  import org.broadleafcommerce.openadmin.server.dao.DynamicEntityDao;                                               </span>
<span class="4410643013278245372" onmouseenter="enter('4410643013278245372');" onmouseout="out('4410643013278245372');" style="">  52  import org.broadleafcommerce.openadmin.server.domain.PersistencePackageRequest;                                   </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  53  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-7620175268967942501" onmouseenter="enter('-7620175268967942501');" onmouseout="out('-7620175268967942501');" style="">  54  import org.broadleafcommerce.openadmin.server.security.domain.AdminSection;                                       </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  55  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-4641149340176766185" onmouseenter="enter('-4641149340176766185');" onmouseout="out('-4641149340176766185');" style="">  56  import org.broadleafcommerce.openadmin.server.security.remote.EntityOperationType;                                </span>
<span class="78786346091609662" onmouseenter="enter('78786346091609662');" onmouseout="out('78786346091609662');" style="">  57  import org.broadleafcommerce.openadmin.server.security.service.RowLevelSecurityService;                           </span>
<span class="-8603256547657551769" onmouseenter="enter('-8603256547657551769');" onmouseout="out('-8603256547657551769');" style="">  58  import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;                            </span>
<span class="5585583973934060515" onmouseenter="enter('5585583973934060515');" onmouseout="out('5585583973934060515');" style=""><abbr title="  59  import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExtensionManager;">  59  import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExtensionManaðŸ”µ</abbr></span>
<span class="-3086540061138981164" onmouseenter="enter('-3086540061138981164');" onmouseout="out('-3086540061138981164');" style="">  60  import org.broadleafcommerce.openadmin.server.service.persistence.module.BasicPersistenceModule;                  </span>
<span class="9131075895472939574" onmouseenter="enter('9131075895472939574');" onmouseout="out('9131075895472939574');" style="">  61  import org.broadleafcommerce.openadmin.web.controller.AdminAbstractController;                                    </span>
<span class="7254479112554025637" onmouseenter="enter('7254479112554025637');" onmouseout="out('7254479112554025637');" style="">  62  import org.broadleafcommerce.openadmin.web.controller.modal.ModalHeaderType;                                      </span>
<span class="4507704609742395614" onmouseenter="enter('4507704609742395614');" onmouseout="out('4507704609742395614');" style="">  63  import org.broadleafcommerce.openadmin.web.editor.NonNullBooleanEditor;                                           </span>
<span class="-2042519459673859584" onmouseenter="enter('-2042519459673859584');" onmouseout="out('-2042519459673859584');" style="">  64  import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;                                 </span>
<span class="3056790491614608405" onmouseenter="enter('3056790491614608405');" onmouseout="out('3056790491614608405');" style="">  65  import org.broadleafcommerce.openadmin.web.form.component.ListGrid;                                               </span>
<span class="1405974373227613661" onmouseenter="enter('1405974373227613661');" onmouseout="out('1405974373227613661');" style="">  66  import org.broadleafcommerce.openadmin.web.form.entity.DefaultAdornedEntityFormActions;                           </span>
<span class="2718350422838759693" onmouseenter="enter('2718350422838759693');" onmouseout="out('2718350422838759693');" style="">  67  import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;                                  </span>
<span class="-3560862041655103076" onmouseenter="enter('-3560862041655103076');" onmouseout="out('-3560862041655103076');" style="">  68  import org.broadleafcommerce.openadmin.web.form.entity.DefaultMainActions;                                        </span>
<span class="8035715143965725316" onmouseenter="enter('8035715143965725316');" onmouseout="out('8035715143965725316');" style="">  69  import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;                                                </span>
<span class="-3164920911156953697" onmouseenter="enter('-3164920911156953697');" onmouseout="out('-3164920911156953697');" style="">  70  import org.broadleafcommerce.openadmin.web.form.entity.EntityFormAction;                                          </span>
<span class="6015559832933397076" onmouseenter="enter('6015559832933397076');" onmouseout="out('6015559832933397076');" style="">  71  import org.broadleafcommerce.openadmin.web.form.entity.Field;                                                     </span>
<span class="-5634654756625156689" onmouseenter="enter('-5634654756625156689');" onmouseout="out('-5634654756625156689');" style="">  72  import org.broadleafcommerce.openadmin.web.form.entity.FieldGroup;                                                </span>
<span class="8763280003660953520" onmouseenter="enter('8763280003660953520');" onmouseout="out('8763280003660953520');" style="">  73  import org.springframework.beans.propertyeditors.StringTrimmerEditor;                                             </span>
<span class="4128309806836178094" onmouseenter="enter('4128309806836178094');" onmouseout="out('4128309806836178094');" style="">  74  import org.springframework.stereotype.Controller;                                                                 </span>
<span class="2230089600625206822" onmouseenter="enter('2230089600625206822');" onmouseout="out('2230089600625206822');" style="">  75  import org.springframework.ui.Model;                                                                              </span>
<span class="-8661390401087732702" onmouseenter="enter('-8661390401087732702');" onmouseout="out('-8661390401087732702');" style="">  76  import org.springframework.util.MultiValueMap;                                                                    </span>
<span class="-5446610002806720528" onmouseenter="enter('-5446610002806720528');" onmouseout="out('-5446610002806720528');" style="">  77  import org.springframework.validation.BindingResult;                                                              </span>
<span class="-5956639343389312225" onmouseenter="enter('-5956639343389312225');" onmouseout="out('-5956639343389312225');" style="">  78  import org.springframework.web.bind.WebDataBinder;                                                                </span>
<span class="6486986322776186621" onmouseenter="enter('6486986322776186621');" onmouseout="out('6486986322776186621');" style="">  79  import org.springframework.web.bind.annotation.InitBinder;                                                        </span>
<span class="2718246165073723950" onmouseenter="enter('2718246165073723950');" onmouseout="out('2718246165073723950');" style="">  80  import org.springframework.web.bind.annotation.ModelAttribute;                                                    </span>
<span class="3963501418927616634" onmouseenter="enter('3963501418927616634');" onmouseout="out('3963501418927616634');" style="">  81  import org.springframework.web.bind.annotation.PathVariable;                                                      </span>
<span class="-7989471178862524182" onmouseenter="enter('-7989471178862524182');" onmouseout="out('-7989471178862524182');" style="">  82  import org.springframework.web.bind.annotation.RequestMapping;                                                    </span>
<span class="4584846860636268493" onmouseenter="enter('4584846860636268493');" onmouseout="out('4584846860636268493');" style="">  83  import org.springframework.web.bind.annotation.RequestMethod;                                                     </span>
<span class="-8913037601281016619" onmouseenter="enter('-8913037601281016619');" onmouseout="out('-8913037601281016619');" style="">  84  import org.springframework.web.bind.annotation.RequestParam;                                                      </span>
<span class="-7662224364501075428" onmouseenter="enter('-7662224364501075428');" onmouseout="out('-7662224364501075428');" style="">  85  import org.springframework.web.bind.annotation.ResponseBody;                                                      </span>
<span class="82864906475118767" onmouseenter="enter('82864906475118767');" onmouseout="out('82864906475118767');" style="">  86  import org.springframework.web.servlet.DispatcherServlet;                                                         </span>
<span class="4665273347041581179" onmouseenter="enter('4665273347041581179');" onmouseout="out('4665273347041581179');" style="">  87  import org.springframework.web.servlet.FlashMap;                                                                  </span>
<span class="4289605998216587359" onmouseenter="enter('4289605998216587359');" onmouseout="out('4289605998216587359');" style="">  88  import org.springframework.web.servlet.mvc.support.RedirectAttributes;                                            </span>
<span class="2383374134797300138" onmouseenter="enter('2383374134797300138');" onmouseout="out('2383374134797300138');" style="">  89  import org.springframework.web.util.UrlPathHelper;                                                                </span>

<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="">  90  import com.fasterxml.jackson.databind.ObjectMapper;                                                               </span>
<span  style="">  91                                                                                                                    </span>


<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="">  92  import java.net.URLDecoder;                                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  93  import java.util.ArrayList;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +import java.util.Arrays;                                                                                          </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  95  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  96  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  97  import java.util.Map;                                                                                             </span>
<span class="2393042000349901971" onmouseenter="enter('2393042000349901971');" onmouseout="out('2393042000349901971');" style="">  98  import java.util.Map.Entry;                                                                                       </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  99  import java.util.Set;                                                                                             </span>
<span class="5924803009700709999" onmouseenter="enter('5924803009700709999');" onmouseout="out('5924803009700709999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +import java.util.stream.Stream;                                                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +                                                                                                                  </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style=""> 102  import javax.annotation.Resource;                                                                                 </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style=""> 103  import javax.servlet.http.HttpServletRequest;                                                                     </span>
<span class="-2247759832438184775" onmouseenter="enter('-2247759832438184775');" onmouseout="out('-2247759832438184775');" style=""> 104  import javax.servlet.http.HttpServletResponse;                                                                    </span>
<span  style=""> 105                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 106  /**                                                                                                               </span>
<span class="4260469300841401635" onmouseenter="enter('4260469300841401635');" onmouseout="out('4260469300841401635');" style=""><abbr title=" 107   * The default implementation of the {@link #BroadleafAdminAbstractEntityController}. This delegates every call to super"> 107   * The default implementation of the {@link #BroadleafAdminAbstractEntityController}. This delegates every call toðŸ”µ</abbr></span>
<span class="-3899564930283338794" onmouseenter="enter('-3899564930283338794');" onmouseout="out('-3899564930283338794');" style=""><abbr title=" 108   * and does not provide any custom-tailored functionality. It is responsible for rendering the admin for every entity"> 108   * and does not provide any custom-tailored functionality. It is responsible for rendering the admin for every entðŸ”µ</abbr></span>
<span class="-5698631600182435917" onmouseenter="enter('-5698631600182435917');" onmouseout="out('-5698631600182435917');" style=""> 109   * that is not explicitly customized by its own controller.                                                       </span>



<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 110   *                                                                                                                </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style=""> 111   * @author Andre Azzolini (apazzolini)                                                                            </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style=""> 112   * @author Jeff Fischer                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 113   */                                                                                                               </span>
<span class="4155455059275642147" onmouseenter="enter('4155455059275642147');" onmouseout="out('4155455059275642147');" style=""> 114  @Controller(&quot;blAdminBasicEntityController&quot;)                                                                       </span>
<span class="1298802560762502343" onmouseenter="enter('1298802560762502343');" onmouseout="out('1298802560762502343');" style=""> 115  @RequestMapping(&quot;/{sectionKey:.+}&quot;)                                                                               </span>
<span class="8857493697785984988" onmouseenter="enter('8857493697785984988');" onmouseout="out('8857493697785984988');" style=""> 116  public class AdminBasicEntityController extends AdminAbstractController {                                         </span>
<span  style=""> 117                                                                                                                    </span>
<span class="6387945601766467724" onmouseenter="enter('6387945601766467724');" onmouseout="out('6387945601766467724');" style=""> 118      protected static final Log LOG = LogFactory.getLog(AdminBasicEntityController.class);                         </span>
<span  style=""> 119                                                                                                                    </span>
<span class="-3043900363751028803" onmouseenter="enter('-3043900363751028803');" onmouseout="out('-3043900363751028803');" style=""> 120      public static final String ALTERNATE_ID_PROPERTY = &quot;ALTERNATE_ID&quot;;                                            </span>
<span class="4075481265342786632" onmouseenter="enter('4075481265342786632');" onmouseout="out('4075481265342786632');" style=""> 121      public static final String CUSTOM_CRITERIA = &quot;criteria&quot;;                                                      </span>
<span class="-5370879055704196240" onmouseenter="enter('-5370879055704196240');" onmouseout="out('-5370879055704196240');" style=""> 122      public static final String IS_SELECTIZE_REQUEST = &quot;isSelectizeRequest&quot;;                                       </span>
<span  style=""> 123                                                                                                                    </span>
<span class="-7030764210296949798" onmouseenter="enter('-7030764210296949798');" onmouseout="out('-7030764210296949798');" style=""> 124      @Resource(name=&quot;blSandBoxHelper&quot;)                                                                             </span>
<span class="-7799183597372200632" onmouseenter="enter('-7799183597372200632');" onmouseout="out('-7799183597372200632');" style=""> 125      protected SandBoxHelper sandBoxHelper;                                                                        </span>
<span  style=""> 126                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style=""> 127      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style=""> 128      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style=""> 129                                                                                                                    </span>
<span class="1039661802170570045" onmouseenter="enter('1039661802170570045');" onmouseout="out('1039661802170570045');" style=""> 130      @Resource(name=&quot;blDynamicEntityDao&quot;)                                                                          </span>
<span class="-6629482740079052882" onmouseenter="enter('-6629482740079052882');" onmouseout="out('-6629482740079052882');" style=""> 131      protected DynamicEntityDao dynamicEntityDao;                                                                  </span>
<span  style=""> 132                                                                                                                    </span>
<span class="3323977399618509653" onmouseenter="enter('3323977399618509653');" onmouseout="out('3323977399618509653');" style=""> 133      @Resource(name = &quot;blAdornedTargetAutoPopulateExtensionManager&quot;)                                               </span>
<span class="-4810148452666974339" onmouseenter="enter('-4810148452666974339');" onmouseout="out('-4810148452666974339');" style=""> 134      protected AdornedTargetAutoPopulateExtensionManager adornedTargetAutoPopulateExtensionManager;                </span>
<span  style=""> 135                                                                                                                    </span>
<span class="-1073312679381587606" onmouseenter="enter('-1073312679381587606');" onmouseout="out('-1073312679381587606');" style=""> 136      @Resource(name = &quot;blRowLevelSecurityService&quot;)                                                                 </span>
<span class="7292046362506695965" onmouseenter="enter('7292046362506695965');" onmouseout="out('7292046362506695965');" style=""> 137      protected RowLevelSecurityService rowLevelSecurityService;                                                    </span>
<span  style=""> 138                                                                                                                    </span>






<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 139      // ******************************************                                                                 </span>
<span class="8145904524131922989" onmouseenter="enter('8145904524131922989');" onmouseout="out('8145904524131922989');" style=""> 140      // REQUEST-MAPPING BOUND CONTROLLER METHODS *                                                                 </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 141      // ******************************************                                                                 </span>
<span  style=""> 142                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 143      /**                                                                                                           </span>
<span class="5980196098348408716" onmouseenter="enter('5980196098348408716');" onmouseout="out('5980196098348408716');" style=""><abbr title=" 144       * Renders the main entity listing for the specified class, which is based on the current sectionKey with some optional"> 144       * Renders the main entity listing for the specified class, which is based on the current sectionKey with someðŸ”µ</abbr></span>
<span class="1756838433111210325" onmouseenter="enter('1756838433111210325');" onmouseout="out('1756838433111210325');" style=""> 145       * criteria.                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 146       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 147       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 148       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 149       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 150       * @param pathVars                                                                                            </span>
<span class="-7836494531350161829" onmouseenter="enter('-7836494531350161829');" onmouseout="out('-7836494531350161829');" style=""> 151       * @param requestParams a Map of property name -&gt; list critiera values                                        </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 152       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 153       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 154       */                                                                                                           </span>
<span class="854227037044969777" onmouseenter="enter('854227037044969777');" onmouseout="out('854227037044969777');" style=""> 155      @RequestMapping(value = &quot;&quot;, method = RequestMethod.GET)                                                       </span>
<span class="5203424842505603172" onmouseenter="enter('5203424842505603172');" onmouseout="out('5203424842505603172');" style=""> 156      public String viewEntityList(HttpServletRequest request, HttpServletResponse response, Model model,           </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 157              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 158              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 159          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 160          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 161          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                                        </span>
<span class="1452589137399878084" onmouseenter="enter('1452589137399878084');" onmouseout="out('1452589137399878084');" style=""><abbr title=" 162          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars);"> 162          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 163          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 164          DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                                    </span>
<span  style=""> 165                                                                                                                    </span>
<span class="-9123024135554384147" onmouseenter="enter('-9123024135554384147');" onmouseout="out('-9123024135554384147');" style=""> 166          ListGrid listGrid = formService.buildMainListGrid(drs, cmd, sectionKey, crumbs);                          </span>
<span class="-7197013270379460942" onmouseenter="enter('-7197013270379460942');" onmouseout="out('-7197013270379460942');" style=""> 167          listGrid.setSelectType(ListGrid.SelectType.NONE);                                                         </span>
<span  style=""> 168                                                                                                                    </span>
<span class="6707774114103003478" onmouseenter="enter('6707774114103003478');" onmouseout="out('6707774114103003478');" style=""> 169          Set&lt;Field&gt; headerFields = listGrid.getHeaderFields();                                                     </span>
<span class="6157449347608657417" onmouseenter="enter('6157449347608657417');" onmouseout="out('6157449347608657417');" style=""> 170          if (CollectionUtils.isNotEmpty(headerFields)) {                                                           </span>
<span class="7359980094802675712" onmouseenter="enter('7359980094802675712');" onmouseout="out('7359980094802675712');" style=""> 171              Field firstField = headerFields.iterator().next();                                                    </span>
<span class="-7992921859474727563" onmouseenter="enter('-7992921859474727563');" onmouseout="out('-7992921859474727563');" style=""> 172              if (requestParams.containsKey(firstField.getName())) {                                                </span>
<span class="-4847870846432586371" onmouseenter="enter('-4847870846432586371');" onmouseout="out('-4847870846432586371');" style=""> 173                  model.addAttribute(&quot;mainSearchTerm&quot;, requestParams.get(firstField.getName()).get(0));             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175          }                                                                                                         </span>
<span  style=""> 176                                                                                                                    </span>
<span class="3294377821001327596" onmouseenter="enter('3294377821001327596');" onmouseout="out('3294377821001327596');" style=""> 177          model.addAttribute(&quot;viewType&quot;, &quot;entityList&quot;);                                                             </span>
<span  style=""> 178                                                                                                                    </span>
<span class="5223794068523842694" onmouseenter="enter('5223794068523842694');" onmouseout="out('5223794068523842694');" style=""> 179          setupViewEntityListBasicModel(request, cmd, sectionKey, sectionClassName, model, requestParams);          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 180          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span  style=""> 181                                                                                                                    </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style=""> 182          return &quot;modules/defaultContainer&quot;;                                                                        </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183      }                                                                                                             </span>
<span  style=""> 184                                                                                                                    </span>
<span class="5512240627727429054" onmouseenter="enter('5512240627727429054');" onmouseout="out('5512240627727429054');" style=""> 185      protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String sectionKey,</span>
<span class="522743254766371502" onmouseenter="enter('522743254766371502');" onmouseout="out('522743254766371502');" style=""> 186              String sectionClassName, Model model, MultiValueMap&lt;String, String&gt; requestParams) {                  </span>
<span class="5787313217223527782" onmouseenter="enter('5787313217223527782');" onmouseout="out('5787313217223527782');" style=""> 187          List&lt;EntityFormAction&gt; mainActions = new ArrayList&lt;&gt;();                                                   </span>
<span class="-6495333239259317464" onmouseenter="enter('-6495333239259317464');" onmouseout="out('-6495333239259317464');" style=""> 188          addAddActionIfAllowed(sectionClassName, cmd, mainActions);                                                </span>
<span class="-5948121019403308590" onmouseenter="enter('-5948121019403308590');" onmouseout="out('-5948121019403308590');" style=""> 189          extensionManager.getProxy().addAdditionalMainActions(sectionClassName, mainActions);                      </span>
<span class="-381816252130957573" onmouseenter="enter('-381816252130957573');" onmouseout="out('-381816252130957573');" style=""> 190          extensionManager.getProxy().modifyMainActions(cmd, mainActions);                                          </span>
<span  style=""> 191                                                                                                                    </span>
<span class="-5498329164774951339" onmouseenter="enter('-5498329164774951339');" onmouseout="out('-5498329164774951339');" style=""> 192          // If this came from a delete save, we&#x27;ll have a headerFlash request parameter to take care of            </span>
<span class="6915846846822456322" onmouseenter="enter('6915846846822456322');" onmouseout="out('6915846846822456322');" style=""> 193          if (requestParams.containsKey(&quot;headerFlash&quot;)) {                                                           </span>
<span class="-7374079465520861767" onmouseenter="enter('-7374079465520861767');" onmouseout="out('-7374079465520861767');" style=""> 194              model.addAttribute(&quot;headerFlash&quot;, requestParams.get(&quot;headerFlash&quot;).get(0));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195          }                                                                                                         </span>
<span  style=""> 196                                                                                                                    </span>
<span class="-5632901614715850082" onmouseenter="enter('-5632901614715850082');" onmouseout="out('-5632901614715850082');" style=""> 197          List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                            </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style=""> 198          String requestUri = request.getRequestURI();                                                              </span>
<span class="2670437920401576748" onmouseenter="enter('2670437920401576748');" onmouseout="out('2670437920401576748');" style=""> 199          if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) {           </span>
<span class="-901741071381030126" onmouseenter="enter('-901741071381030126');" onmouseout="out('-901741071381030126');" style=""> 200              requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length());        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201          }                                                                                                         </span>
<span  style=""> 202                                                                                                                    </span>
<span class="-3335875933652663591" onmouseenter="enter('-3335875933652663591');" onmouseout="out('-3335875933652663591');" style=""> 203          model.addAttribute(&quot;isFilter&quot;, (requestParams.size() &gt; 0));                                               </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style=""> 204          model.addAttribute(&quot;currentUri&quot;, requestUri);                                                             </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style=""> 205          model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                           </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 206          model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 207          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="-4219022137146036385" onmouseenter="enter('-4219022137146036385');" onmouseout="out('-4219022137146036385');" style=""> 208          model.addAttribute(&quot;mainActions&quot;, mainActions);                                                           </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 209          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-7167932239083034641" onmouseenter="enter('-7167932239083034641');" onmouseout="out('-7167932239083034641');" style=""> 210          setTypedEntityModelAttributes(request, model);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211      }                                                                                                             </span>
<span  style=""> 212                                                                                                                    </span>
<span class="-3612928683982517341" onmouseenter="enter('-3612928683982517341');" onmouseout="out('-3612928683982517341');" style=""> 213      @RequestMapping(value = &quot;/selectize&quot;, method = RequestMethod.GET)                                             </span>
<span class="-2536734120775641057" onmouseenter="enter('-2536734120775641057');" onmouseout="out('-2536734120775641057');" style=""> 214      public @ResponseBody Map&lt;String, Object&gt; viewEntityListSelectize(HttpServletRequest request,                  </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style=""> 215               HttpServletResponse response, Model model,                                                           </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 216               @PathVariable Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 217               @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                        </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 218          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 219          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 220          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                                        </span>
<span class="3971039348455381302" onmouseenter="enter('3971039348455381302');" onmouseout="out('3971039348455381302');" style=""><abbr title=" 221          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars)"> 221          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbðŸ”µ</abbr></span>
<span class="-5204717557696417186" onmouseenter="enter('-5204717557696417186');" onmouseout="out('-5204717557696417186');" style=""> 222                  .withCustomCriteria(getCustomCriteria(requestParams));                                            </span>
<span  style=""> 223                                                                                                                    </span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style=""> 224          ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                                    </span>
<span  style=""> 225                                                                                                                    </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 226          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 227          DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                                    </span>
<span  style=""> 228                                                                                                                    </span>
<span class="-6840686923261380416" onmouseenter="enter('-6840686923261380416');" onmouseout="out('-6840686923261380416');" style=""> 229          return formService.constructSelectizeOptionMap(drs, cmd);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230      }                                                                                                             </span>
<span  style=""> 231                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 232      /**                                                                                                           </span>
<span class="6015587852497052057" onmouseenter="enter('6015587852497052057');" onmouseout="out('6015587852497052057');" style=""> 233       * Obtains the requested criteria parameter                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 234       *                                                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 235       * @param requestParams                                                                                       </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 236       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 237       */                                                                                                           </span>
<span class="-5224065764328446223" onmouseenter="enter('-5224065764328446223');" onmouseout="out('-5224065764328446223');" style=""> 238      protected String[] getCustomCriteria(Map&lt;String, List&lt;String&gt;&gt; requestParams) {                               </span>
<span class="8308653628584061101" onmouseenter="enter('8308653628584061101');" onmouseout="out('8308653628584061101');" style=""> 239          if (requestParams == null || requestParams.isEmpty()) {                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 240              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241          }                                                                                                         </span>
<span  style=""> 242                                                                                                                    </span>
<span class="-6200156504676301578" onmouseenter="enter('-6200156504676301578');" onmouseout="out('-6200156504676301578');" style=""> 243          List&lt;String&gt; criteria = requestParams.get(CUSTOM_CRITERIA);                                               </span>
<span class="3479198517250864619" onmouseenter="enter('3479198517250864619');" onmouseout="out('3479198517250864619');" style=""> 244          String response = CollectionUtils.isEmpty(criteria) ? null : criteria.get(0);                             </span>
<span class="3591199473111095603" onmouseenter="enter('3591199473111095603');" onmouseout="out('3591199473111095603');" style=""> 245          return new String[] {response};                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 248      /**                                                                                                           </span>
<span class="53051913897087216" onmouseenter="enter('53051913897087216');" onmouseout="out('53051913897087216');" style=""> 249       * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new instances  </span>
<span class="-2041834868205006384" onmouseenter="enter('-2041834868205006384');" onmouseout="out('-2041834868205006384');" style=""> 250       * of the entity and all of the fields in the entity aren&#x27;t marked as read only.                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 251       *                                                                                                            </span>
<span class="2579837316240354786" onmouseenter="enter('2579837316240354786');" onmouseout="out('2579837316240354786');" style=""> 252       * @param sectionClassName                                                                                    </span>
<span class="3340688165449077744" onmouseenter="enter('3340688165449077744');" onmouseout="out('3340688165449077744');" style=""> 253       * @param cmd                                                                                                 </span>
<span class="-70241175981651056" onmouseenter="enter('-70241175981651056');" onmouseout="out('-70241175981651056');" style=""> 254       * @param mainActions                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 255       */                                                                                                           </span>
<span class="-3535265632615590771" onmouseenter="enter('-3535265632615590771');" onmouseout="out('-3535265632615590771');" style=""><abbr title=" 256      protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormAction&gt; mainActions) {"> 256      protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormAction&gt; mainAcðŸ”µ</abbr></span>
<span class="-1675673801723949520" onmouseenter="enter('-1675673801723949520');" onmouseout="out('-1675673801723949520');" style=""> 257          if (isAddActionAllowed(sectionClassName, cmd)) {                                                          </span>
<span class="-161553798203722975" onmouseenter="enter('-161553798203722975');" onmouseout="out('-161553798203722975');" style=""> 258              mainActions.add(DefaultMainActions.ADD);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260      }                                                                                                             </span>
<span  style=""> 261                                                                                                                    </span>
<span class="6251273327061769060" onmouseenter="enter('6251273327061769060');" onmouseout="out('6251273327061769060');" style=""> 262      protected boolean isAddActionAllowed(String sectionClassName, ClassMetadata cmd) {                            </span>

<span class="2379281051849826609" onmouseenter="enter('2379281051849826609');" onmouseout="out('2379281051849826609');" style=""> 263          // If the user does not have create permissions, we will not add the &quot;Add New&quot; button                     </span>
<span class="4837425918106440333" onmouseenter="enter('4837425918106440333');" onmouseout="out('4837425918106440333');" style=""> 264          boolean canCreate = true;                                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 265          try {                                                                                                     </span>
<span class="-2050050318794737036" onmouseenter="enter('-2050050318794737036');" onmouseout="out('-2050050318794737036');" style=""> 266              adminRemoteSecurityService.securityCheck(sectionClassName, EntityOperationType.ADD);                  </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 267          } catch (ServiceException e) {                                                                            </span>
<span class="-8912377967087217182" onmouseenter="enter('-8912377967087217182');" onmouseout="out('-8912377967087217182');" style=""> 268              if (e instanceof SecurityServiceException) {                                                          </span>
<span class="-5562308883634048055" onmouseenter="enter('-5562308883634048055');" onmouseout="out('-5562308883634048055');" style=""> 269                  canCreate = false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271          }                                                                                                         </span>
<span  style=""> 272                                                                                                                    </span>
<span class="-3452128956938556370" onmouseenter="enter('-3452128956938556370');" onmouseout="out('-3452128956938556370');" style=""> 273          if (canCreate) {                                                                                          </span>
<span class="-4263024171062822587" onmouseenter="enter('-4263024171062822587');" onmouseout="out('-4263024171062822587');" style=""> 274              checkReadOnly: {                                                                                      </span>
<span class="-5650645308789885306" onmouseenter="enter('-5650645308789885306');" onmouseout="out('-5650645308789885306');" style=""> 275                  //check if all the metadata is read only                                                          </span>
<span class="-3497335608114491506" onmouseenter="enter('-3497335608114491506');" onmouseout="out('-3497335608114491506');" style=""> 276                  for (Property property : cmd.getProperties()) {                                                   </span>
<span class="-446642995335437650" onmouseenter="enter('-446642995335437650');" onmouseout="out('-446642995335437650');" style=""> 277                      if (property.getMetadata() instanceof BasicFieldMetadata) {                                   </span>
<span class="-4740706861929444273" onmouseenter="enter('-4740706861929444273');" onmouseout="out('-4740706861929444273');" style=""> 278                          if (((BasicFieldMetadata) property.getMetadata()).getReadOnly() == null ||                </span>
<span class="7731016670197656615" onmouseenter="enter('7731016670197656615');" onmouseout="out('7731016670197656615');" style=""> 279                                  !((BasicFieldMetadata) property.getMetadata()).getReadOnly()) {                   </span>
<span class="7135533341781534816" onmouseenter="enter('7135533341781534816');" onmouseout="out('7135533341781534816');" style=""> 280                              break checkReadOnly;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282                      }                                                                                             </span>
















<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283                  }                                                                                                 </span>
<span class="-5562308883634048055" onmouseenter="enter('-5562308883634048055');" onmouseout="out('-5562308883634048055');" style=""> 284                  canCreate = false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286          }                                                                                                         </span>
<span  style=""> 287                                                                                                                    </span>
<span class="-3452128956938556370" onmouseenter="enter('-3452128956938556370');" onmouseout="out('-3452128956938556370');" style=""> 288          if (canCreate) {                                                                                          </span>
<span class="-5729139490324794214" onmouseenter="enter('-5729139490324794214');" onmouseout="out('-5729139490324794214');" style=""><abbr title=" 289              canCreate = rowLevelSecurityService.canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectionClassName, cmd);"> 289              canCreate = rowLevelSecurityService.canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectioðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290          }                                                                                                         </span>
<span  style=""> 291                                                                                                                    </span>
<span class="2674140840454218035" onmouseenter="enter('2674140840454218035');" onmouseout="out('2674140840454218035');" style=""> 292          return canCreate;                                                                                         </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293      }                                                                                                             </span>
<span  style=""> 294                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 295      /**                                                                                                           </span>
<span class="-403478592182410175" onmouseenter="enter('-403478592182410175');" onmouseout="out('-403478592182410175');" style=""> 296       * Renders the modal form that is used to add a new parent level entity. Note that this form cannot render any</span>
<span class="-2684076904077363908" onmouseenter="enter('-2684076904077363908');" onmouseout="out('-2684076904077363908');" style=""><abbr title=" 297       * subcollections as operations on those collections require the parent level entity to first be saved and have"> 297       * subcollections as operations on those collections require the parent level entity to first be saved and havðŸ”µ</abbr></span>
<span class="-2496660529180512497" onmouseenter="enter('-2496660529180512497');" onmouseout="out('-2496660529180512497');" style=""><abbr title=" 298       * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity screen where"> 298       * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity screen whðŸ”µ</abbr></span>
<span class="-5672334976076130102" onmouseenter="enter('-5672334976076130102');" onmouseout="out('-5672334976076130102');" style=""> 299       * they can then perform operations on sub collections.                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 300       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 301       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 302       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 303       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 304       * @param pathVars                                                                                            </span>
<span class="-7339043177630483847" onmouseenter="enter('-7339043177630483847');" onmouseout="out('-7339043177630483847');" style=""> 305       * @param entityType                                                                                          </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 306       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 307       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 308       */                                                                                                           </span>
<span class="-6494270766546423105" onmouseenter="enter('-6494270766546423105');" onmouseout="out('-6494270766546423105');" style=""> 309      @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.GET)                                                   </span>
<span class="8522113168804045570" onmouseenter="enter('8522113168804045570');" onmouseout="out('8522113168804045570');" style=""> 310      public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,        </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 311              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="-1715631339976075770" onmouseenter="enter('-1715631339976075770');" onmouseout="out('-1715631339976075770');" style=""> 312              @RequestParam(defaultValue = &quot;&quot;) String entityType) throws Exception {                                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 313          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 314          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 315          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                                 </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 316          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 316          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVðŸ”µ</abbr></span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style=""> 317          ppr.setAddOperationInspect(true);                                                                         </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 318          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span  style=""> 319                                                                                                                    </span>
<span class="4862894803792873117" onmouseenter="enter('4862894803792873117');" onmouseout="out('4862894803792873117');" style=""><abbr title=" 320          // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types for this entity."> 320          // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types for thiðŸ”µ</abbr></span>






























<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 321          if (StringUtils.isBlank(entityType)) {                                                                    </span>
<span class="2333848870190395940" onmouseenter="enter('2333848870190395940');" onmouseout="out('2333848870190395940');" style=""> 322              if (cmd.getPolymorphicEntities().getChildren().length == 0) {                                         </span>
<span class="2097783908693957449" onmouseenter="enter('2097783908693957449');" onmouseout="out('2097783908693957449');" style=""> 323                  entityType = cmd.getPolymorphicEntities().getFullyQualifiedClassname();                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 324              } else {                                                                                              </span>
<span class="-6902702564943152777" onmouseenter="enter('-6902702564943152777');" onmouseout="out('-6902702564943152777');" style=""> 325                  entityType = getDefaultEntityType();                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 327          } else {                                                                                                  </span>
<span class="7843468667819793383" onmouseenter="enter('7843468667819793383');" onmouseout="out('7843468667819793383');" style=""> 328              entityType = URLDecoder.decode(entityType, &quot;UTF-8&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329          }                                                                                                         </span>
<span  style=""> 330                                                                                                                    </span>
<span class="4098005746663533241" onmouseenter="enter('4098005746663533241');" onmouseout="out('4098005746663533241');" style=""> 331          EntityForm entityForm = formService.createEntityForm(cmd, sectionCrumbs);                                 </span>
<span  style=""> 332                                                                                                                    </span>
<span class="5826594571687596812" onmouseenter="enter('5826594571687596812');" onmouseout="out('5826594571687596812');" style=""> 333          // We need to make sure that the ceiling entity is set to the interface and the specific entity type      </span>
<span class="37161952125740808" onmouseenter="enter('37161952125740808');" onmouseout="out('37161952125740808');" style=""> 334          // is set to the type we&#x27;re going to be creating.                                                         </span>
<span class="5062735442039535924" onmouseenter="enter('5062735442039535924');" onmouseout="out('5062735442039535924');" style=""> 335          entityForm.setCeilingEntityClassname(cmd.getCeilingType());                                               </span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style=""> 336          entityForm.setEntityType(entityType);                                                                     </span>
<span  style=""> 337                                                                                                                    </span>
<span class="-5227856854691424770" onmouseenter="enter('-5227856854691424770');" onmouseout="out('-5227856854691424770');" style=""> 338          // When we initially build the class metadata (and thus, the entity form), we had all of the possible     </span>
<span class="5105619661852614163" onmouseenter="enter('5105619661852614163');" onmouseout="out('5105619661852614163');" style=""> 339          // polymorphic fields built out. Now that we have a concrete entity type to render, we can remove the     </span>
<span class="-3843175043245177501" onmouseenter="enter('-3843175043245177501');" onmouseout="out('-3843175043245177501');" style=""> 340          // fields that are not applicable for this given entity type.                                             </span>
<span class="-2935519954456371455" onmouseenter="enter('-2935519954456371455');" onmouseout="out('-2935519954456371455');" style=""> 341          formService.removeNonApplicableFields(cmd, entityForm, entityType);                                       </span>
<span  style=""> 342                                                                                                                    </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 343          modifyAddEntityForm(entityForm, pathVars);                                                                </span>
<span  style=""> 344                                                                                                                    </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 345          model.addAttribute(&quot;entityForm&quot;, entityForm);                                                             </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 346          model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                                        </span>
<span  style=""> 347                                                                                                                    </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 348          model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 349          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 350          model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                              </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 351          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style=""> 352          return &quot;modules/modalContainer&quot;;                                                                          </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353      }                                                                                                             </span>
<span  style=""> 354                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 355      /**                                                                                                           </span>
<span class="-2292124409166412817" onmouseenter="enter('-2292124409166412817');" onmouseout="out('-2292124409166412817');" style=""> 356       * Processes the request to add a new entity. If successful, returns a redirect to the newly created entity.  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 357       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 358       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 359       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 360       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 361       * @param pathVars                                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 362       * @param entityForm                                                                                          </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 363       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 364       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 365       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 366       */                                                                                                           </span>
<span class="-1840738840686664300" onmouseenter="enter('-1840738840686664300');" onmouseout="out('-1840738840686664300');" style=""> 367      @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.POST)                                                  </span>
<span class="8551380442207718095" onmouseenter="enter('8551380442207718095');" onmouseout="out('8551380442207718095');" style=""> 368      public String addEntity(HttpServletRequest request, HttpServletResponse response, Model model,                </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 369              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""> 370              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 371          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 372          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 373          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                                 </span>
<span class="2596618104185041854" onmouseenter="enter('2596618104185041854');" onmouseout="out('2596618104185041854');" style=""><abbr title=" 374          ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 374          ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassName, sectionðŸ”µ</abbr></span>
<span  style=""> 375                                                                                                                    </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 376          extractDynamicFormFields(cmd, entityForm);                                                                </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 377          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 377          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCuðŸ”µ</abbr></span>
<span class="-4281879219750019053" onmouseenter="enter('-4281879219750019053');" onmouseout="out('-4281879219750019053');" style=""> 378          Entity entity = service.addEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();                </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 379          entityFormValidator.validate(entityForm, entity, result);                                                 </span>
<span  style=""> 380                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 381          if (result.hasErrors()) {                                                                                 </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 382              entityForm.clearFieldsMap();                                                                          </span>
<span class="-312181662169537666" onmouseenter="enter('-312181662169537666');" onmouseout="out('-312181662169537666');" style=""> 383              formService.populateEntityForm(cmd, entity, entityForm, sectionCrumbs);                               </span>
<span  style=""> 384                                                                                                                    </span>
<span class="254171966199148419" onmouseenter="enter('254171966199148419');" onmouseout="out('254171966199148419');" style=""> 385              formService.removeNonApplicableFields(cmd, entityForm, entityForm.getEntityType());                   </span>
<span  style=""> 386                                                                                                                    </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 387              modifyAddEntityForm(entityForm, pathVars);                                                            </span>
<span  style=""> 388                                                                                                                    </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 389              model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 390              model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                 </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 391              model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                          </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 392              model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());             </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 393              setModelAttributes(model, sectionKey);                                                                </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style=""> 394              return &quot;modules/modalContainer&quot;;                                                                      </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395          }                                                                                                         </span>
<span  style=""> 396                                                                                                                    </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 397          // Note that AJAX Redirects need the context path prepended to them                                       </span>
<span class="-9104189425594863479" onmouseenter="enter('-9104189425594863479');" onmouseout="out('-9104189425594863479');" style=""><abbr title=" 398          return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).getValue();"> 398          return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).getValue(ðŸ”µ</abbr></span>






















































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399      }                                                                                                             </span>
<span  style=""> 400                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 401      /**                                                                                                           </span>
<span class="9102199281013466170" onmouseenter="enter('9102199281013466170');" onmouseout="out('9102199281013466170');" style=""> 402       * Renders the main entity form for the specified entity                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 403       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 404       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 405       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 406       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 407       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 408       * @param id                                                                                                  </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 409       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 410       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 411       */                                                                                                           </span>
<span class="7083955269921705584" onmouseenter="enter('7083955269921705584');" onmouseout="out('7083955269921705584');" style=""> 412      @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.GET)                                                  </span>
<span class="-4309552397998806559" onmouseenter="enter('-4309552397998806559');" onmouseout="out('-4309552397998806559');" style=""> 413      public String viewEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,           </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 414              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="-2194094146044801021" onmouseenter="enter('-2194094146044801021');" onmouseout="out('-2194094146044801021');" style=""> 415              @PathVariable(&quot;id&quot;) String id) throws Exception {                                                     </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 416          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 417          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 418          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                                    </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""> 419          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);  </span>
<span  style=""> 420                                                                                                                    </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 421          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="-8780243800866475465" onmouseenter="enter('-8780243800866475465');" onmouseout="out('-8780243800866475465');" style=""> 422          Entity entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];             </span>
<span  style=""> 423                                                                                                                    </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""> 424          Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);  </span>
<span  style=""> 425                                                                                                                    </span>
<span class="872584542219399793" onmouseenter="enter('872584542219399793');" onmouseout="out('872584542219399793');" style=""> 426          EntityForm entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);                 </span>
<span  style=""> 427                                                                                                                    </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style=""> 428          if (isAddRequest(entity)) {                                                                               </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 429              modifyAddEntityForm(entityForm, pathVars);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 430          } else {                                                                                                  </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 431              modifyEntityForm(entityForm, pathVars);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432          }                                                                                                         </span>

<span  style=""> 433                                                                                                                    </span>
<span class="1981952247030149381" onmouseenter="enter('1981952247030149381');" onmouseout="out('1981952247030149381');" style=""> 434          if (request.getParameter(&quot;headerFlash&quot;) != null) {                                                        </span>
<span class="-2367607735703612103" onmouseenter="enter('-2367607735703612103');" onmouseout="out('-2367607735703612103');" style=""> 435              model.addAttribute(&quot;headerFlash&quot;, request.getParameter(&quot;headerFlash&quot;));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436          }                                                                                                         </span>
<span  style=""> 437                                                                                                                    </span>
<span class="-6569554975283424126" onmouseenter="enter('-6569554975283424126');" onmouseout="out('-6569554975283424126');" style=""> 438          // Set the sectionKey again incase this is a typed entity                                                 </span>
<span class="4201932972037321722" onmouseenter="enter('4201932972037321722');" onmouseout="out('4201932972037321722');" style=""> 439          entityForm.setSectionKey(sectionKey);                                                                     </span>
<span  style=""> 440                                                                                                                    </span>
<span class="5387752430767952558" onmouseenter="enter('5387752430767952558');" onmouseout="out('5387752430767952558');" style=""> 441          // Build the current url in the cast that this is a typed entity                                          </span>
<span class="3856485652570637824" onmouseenter="enter('3856485652570637824');" onmouseout="out('3856485652570637824');" style=""> 442          String originatingUri = new UrlPathHelper().getOriginatingRequestUri(request);                            </span>
<span class="-1728408616530607173" onmouseenter="enter('-1728408616530607173');" onmouseout="out('-1728408616530607173');" style=""> 443          int startIndex = request.getContextPath().length();                                                       </span>
<span  style=""> 444                                                                                                                    </span>
<span class="654052499558570629" onmouseenter="enter('654052499558570629');" onmouseout="out('654052499558570629');" style=""> 445          // Remove the context path from servlet path                                                              </span>
<span class="526107488063217153" onmouseenter="enter('526107488063217153');" onmouseout="out('526107488063217153');" style=""> 446          String currentUrl = originatingUri.substring(startIndex);                                                 </span>
<span  style=""> 447                                                                                                                    </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 448          model.addAttribute(&quot;entity&quot;, entity);                                                                     </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 449          model.addAttribute(&quot;entityForm&quot;, entityForm);                                                             </span>
<span class="-4977411250845897884" onmouseenter="enter('-4977411250845897884');" onmouseout="out('-4977411250845897884');" style=""> 450          model.addAttribute(&quot;currentUrl&quot;, currentUrl);                                                             </span>
<span  style=""> 451                                                                                                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 452          setModelAttributes(model, sectionKey);                                                                    </span>
<span  style=""> 453                                                                                                                    </span>
<span class="8236570979651257825" onmouseenter="enter('8236570979651257825');" onmouseout="out('8236570979651257825');" style=""> 454          // We want to replace author ids with their names                                                         </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style=""> 455          addAuditableDisplayFields(entityForm);                                                                    </span>
<span  style=""> 456                                                                                                                    </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 457          if (isAjaxRequest(request)) {                                                                             </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style=""> 458              entityForm.setReadOnly();                                                                             </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style=""> 459              model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                                   </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style=""> 460              model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                         </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style=""> 461              return &quot;modules/modalContainer&quot;;                                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 462          } else {                                                                                                  </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 463              model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                            </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 464              model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                         </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style=""> 465              return &quot;modules/defaultContainer&quot;;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466          }                                                                                                         </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467      }                                                                                                             </span>
<span  style=""> 468                                                                                                                    </span>
<span class="9182660926479189949" onmouseenter="enter('9182660926479189949');" onmouseout="out('9182660926479189949');" style=""><abbr title=" 469      protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, String&gt; pathVars,"> 469      protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, String&gt; pathðŸ”µ</abbr></span>
<span class="4477928710658117231" onmouseenter="enter('4477928710658117231');" onmouseout="out('4477928710658117231');" style=""> 470                                                                ClassMetadata cmd, Entity entity,                   </span>
<span class="5660295431162582196" onmouseenter="enter('5660295431162582196');" onmouseout="out('5660295431162582196');" style=""> 471                                                                List&lt;SectionCrumb&gt; crumbs) throws Exception {       </span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style=""> 472          String tabName = pathVars.get(&quot;tabName&quot;);                                                                 </span>
<span class="5384642555226517985" onmouseenter="enter('5384642555226517985');" onmouseout="out('5384642555226517985');" style=""> 473          if (StringUtils.isEmpty(tabName)) {                                                                       </span>
<span class="-3672533750283461484" onmouseenter="enter('-3672533750283461484');" onmouseout="out('-3672533750283461484');" style=""> 474              tabName = cmd.getFirstTab() == null ? &quot;General&quot; : cmd.getFirstTab().getTabName();                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475          }                                                                                                         </span>
<span class="-5882478663361935855" onmouseenter="enter('-5882478663361935855');" onmouseout="out('-5882478663361935855');" style=""> 476          return service.getRecordsForSelectedTab(cmd, entity, crumbs, tabName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477      }                                                                                                             </span>
<span  style=""> 478                                                                                                                    </span>
<span class="1953795048205106952" onmouseenter="enter('1953795048205106952');" onmouseout="out('1953795048205106952');" style=""> 479      private boolean isAddRequest(Entity entity) {                                                                 </span>
<span class="-2989581670667655563" onmouseenter="enter('-2989581670667655563');" onmouseout="out('-2989581670667655563');" style=""> 480          ExtensionResultHolder&lt;Boolean&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                              </span>
<span class="2773544387861748911" onmouseenter="enter('2773544387861748911');" onmouseout="out('2773544387861748911');" style=""> 481          ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder);        </span>
<span class="8622638495597819717" onmouseenter="enter('8622638495597819717');" onmouseout="out('8622638495597819717');" style=""> 482          if (result.equals(ExtensionResultStatusType.NOT_HANDLED)) {                                               </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 483              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span  style=""> 485                                                                                                                    </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 486          return resultHolder.getResult();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487      }                                                                                                             </span>
<span  style=""> 488                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 489      /**                                                                                                           </span>
<span class="-4864218972040039628" onmouseenter="enter('-4864218972040039628');" onmouseout="out('-4864218972040039628');" style=""> 490       * Attempts to get the List Grid for the selected tab.                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 491       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 492       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 493       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 494       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 495       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 496       * @param id                                                                                                  </span>
<span class="4841027518362301903" onmouseenter="enter('4841027518362301903');" onmouseout="out('4841027518362301903');" style=""> 497       * @param tabName                                                                                             </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 498       * @param entityForm                                                                                          </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style=""> 499       * @param entity                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 500       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 501       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 502       */                                                                                                           </span>
<span class="-7675092144868804288" onmouseenter="enter('-7675092144868804288');" onmouseout="out('-7675092144868804288');" style=""> 503      @RequestMapping(value = &quot;/{id}/{tab:[0-9]+}/{tabName}&quot;, method = RequestMethod.POST)                          </span>
<span class="-2248541185927650044" onmouseenter="enter('-2248541185927650044');" onmouseout="out('-2248541185927650044');" style=""> 504      public String viewEntityTab(HttpServletRequest request, HttpServletResponse response, Model model,            </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 505              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 506              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="2259450910520289810" onmouseenter="enter('2259450910520289810');" onmouseout="out('2259450910520289810');" style=""> 507              @PathVariable(value = &quot;tabName&quot;) String tabName,                                                      </span>
<span class="2754607649135651414" onmouseenter="enter('2754607649135651414');" onmouseout="out('2754607649135651414');" style=""> 508              @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm,                                          </span>
<span class="-2950467864443381399" onmouseenter="enter('-2950467864443381399');" onmouseout="out('-2950467864443381399');" style=""> 509              @ModelAttribute(value = &quot;entity&quot;) Entity entity) throws Exception {                                   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 510          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 511          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 512          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                                    </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""> 513          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);  </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 514          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 515          entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];                    </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""> 516          Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);  </span>
<span class="-3846048132763499568" onmouseenter="enter('-3846048132763499568');" onmouseout="out('-3846048132763499568');" style=""> 517          entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);                            </span>
<span  style=""> 518                                                                                                                    </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style=""> 519          if (isAddRequest(entity)) {                                                                               </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 520              modifyAddEntityForm(entityForm, pathVars);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 521          } else {                                                                                                  </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 522              modifyEntityForm(entityForm, pathVars);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523          }                                                                                                         </span>

<span  style=""> 524                                                                                                                    </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 525          model.addAttribute(&quot;entity&quot;, entity);                                                                     </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 526          model.addAttribute(&quot;entityForm&quot;, entityForm);                                                             </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 527          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span  style=""> 528                                                                                                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 529          setModelAttributes(model, sectionKey);                                                                    </span>
<span  style=""> 530                                                                                                                    </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 531          model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                                </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 532          model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                             </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style=""> 533          return &quot;modules/defaultContainer&quot;;                                                                        </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534      }                                                                                                             </span>
<span  style=""> 535                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 536      /**                                                                                                           </span>
<span class="26428616724277901" onmouseenter="enter('26428616724277901');" onmouseout="out('26428616724277901');" style=""> 537       * Builds JSON that looks like this:                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 538       *                                                                                                            </span>
<span class="-619170819873097874" onmouseenter="enter('-619170819873097874');" onmouseout="out('-619170819873097874');" style=""> 539       * {&quot;errors&quot;:                                                                                                 </span>
<span class="-7867797149207986089" onmouseenter="enter('-7867797149207986089');" onmouseout="out('-7867797149207986089');" style=""> 540       *      [{&quot;message&quot;:&quot;This field is Required&quot;,                                                                 </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 541       *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                                 </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 542       *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                         </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 543       *        &quot;errorType&quot;, &quot;field&quot;,                                                                               </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 544       *        &quot;tab&quot;: &quot;General&quot;                                                                                    </span>
<span class="762081609125064039" onmouseenter="enter('762081609125064039');" onmouseout="out('762081609125064039');" style=""> 545       *        },                                                                                                  </span>
<span class="2065208195238134241" onmouseenter="enter('2065208195238134241');" onmouseout="out('2065208195238134241');" style=""> 546       *        {&quot;message&quot;:&quot;This field is Required&quot;,                                                                </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 547       *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                                 </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 548       *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                         </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 549       *        &quot;errorType&quot;, &quot;field&quot;,                                                                               </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 550       *        &quot;tab&quot;: &quot;General&quot;                                                                                    </span>
<span class="-832778532632947969" onmouseenter="enter('-832778532632947969');" onmouseout="out('-832778532632947969');" style=""> 551       *        }]                                                                                                  </span>
<span class="8941010846014250828" onmouseenter="enter('8941010846014250828');" onmouseout="out('8941010846014250828');" style=""> 552       * }                                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 553       *                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 554       */                                                                                                           </span>
<span class="726178843151373675" onmouseenter="enter('726178843151373675');" onmouseout="out('726178843151373675');" style=""> 555      @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST, produces = &quot;application/json&quot;)                  </span>
<span class="-4245682307765667372" onmouseenter="enter('-4245682307765667372');" onmouseout="out('-4245682307765667372');" style=""> 556      public String saveEntityJson(HttpServletRequest request, HttpServletResponse response, Model model,           </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 557              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 558              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="-5165411007609652701" onmouseenter="enter('-5165411007609652701');" onmouseout="out('-5165411007609652701');" style=""> 559              @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm, BindingResult result,                    </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 560              RedirectAttributes ra) throws Exception {                                                             </span>
<span  style=""> 561                                                                                                                    </span>
<span class="-7049584637685461961" onmouseenter="enter('-7049584637685461961');" onmouseout="out('-7049584637685461961');" style=""> 562          saveEntity(request, response, model, pathVars, id, entityForm, result, ra);                               </span>
<span  style=""> 563                                                                                                                    </span>
<span class="2770382331963423086" onmouseenter="enter('2770382331963423086');" onmouseout="out('2770382331963423086');" style=""> 564          JsonResponse json = new JsonResponse(response);                                                           </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 565          if (result.hasErrors()) {                                                                                 </span>
<span class="6668101882629849049" onmouseenter="enter('6668101882629849049');" onmouseout="out('6668101882629849049');" style=""> 566              populateJsonValidationErrors(entityForm, result, json);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567          }                                                                                                         </span>
<span class="-8719030961107019295" onmouseenter="enter('-8719030961107019295');" onmouseout="out('-8719030961107019295');" style=""> 568          List&lt;String&gt; dirtyList = buildDirtyList(pathVars, request, id);                                           </span>
<span class="-2397478597494600131" onmouseenter="enter('-2397478597494600131');" onmouseout="out('-2397478597494600131');" style=""> 569          if (CollectionUtils.isNotEmpty(dirtyList)) {                                                              </span>
<span class="-6863151800017638945" onmouseenter="enter('-6863151800017638945');" onmouseout="out('-6863151800017638945');" style=""> 570              json.with(&quot;dirty&quot;, dirtyList);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 571          }                                                                                                         </span>
<span  style=""> 572                                                                                                                    </span>
<span class="1148846903613025505" onmouseenter="enter('1148846903613025505');" onmouseout="out('1148846903613025505');" style=""> 573          ExtensionResultHolder&lt;String&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                               </span>
<span class="772761850497532920" onmouseenter="enter('772761850497532920');" onmouseout="out('772761850497532920');" style=""><abbr title=" 574          ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonResponse(response, result.hasErrors(), getSectionKey(pathVars), id, resultHolder);"> 574          ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonResponse(reðŸ”µ</abbr></span>
<span class="-7225919658162387284" onmouseenter="enter('-7225919658162387284');" onmouseout="out('-7225919658162387284');" style=""> 575          if (resultStatusType.equals(ExtensionResultStatusType.HANDLED)) {                                         </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 576              return resultHolder.getResult();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577          }                                                                                                         </span>
<span  style=""> 578                                                                                                                    </span>
<span class="-3901811907821215875" onmouseenter="enter('-3901811907821215875');" onmouseout="out('-3901811907821215875');" style=""> 579          return json.done();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 580      }                                                                                                             </span>
<span  style=""> 581                                                                                                                    </span>
<span class="-2624067384280123527" onmouseenter="enter('-2624067384280123527');" onmouseout="out('-2624067384280123527');" style=""><abbr title=" 582      public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String id) throws ServiceException {"> 582      public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String id) throwsðŸ”µ</abbr></span>
<span class="-6199220983064020273" onmouseenter="enter('-6199220983064020273');" onmouseout="out('-6199220983064020273');" style=""> 583          List&lt;String&gt; dirtyList = new ArrayList&lt;&gt;();                                                               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 584          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 585          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 586          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 587          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 587          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVðŸ”µ</abbr></span>
<span class="-6293964121119142853" onmouseenter="enter('-6293964121119142853');" onmouseout="out('-6293964121119142853');" style=""> 588          ClassMetadata cmd = null;                                                                                 </span>
<span class="-6100049554794336383" onmouseenter="enter('-6100049554794336383');" onmouseout="out('-6100049554794336383');" style=""> 589          Entity entity = null;                                                                                     </span>
<span class="-7221558264805358950" onmouseenter="enter('-7221558264805358950');" onmouseout="out('-7221558264805358950');" style=""> 590          cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();                             </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 591          entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];                    </span>
<span  style=""> 592                                                                                                                    </span>
<span class="-538034338216639378" onmouseenter="enter('-538034338216639378');" onmouseout="out('-538034338216639378');" style=""> 593          for (Property p: entity.getProperties()) {                                                                </span>
<span class="-5586383415891827802" onmouseenter="enter('-5586383415891827802');" onmouseout="out('-5586383415891827802');" style=""> 594              if (p.getIsDirty()) {                                                                                 </span>
<span class="-1571805809811752662" onmouseenter="enter('-1571805809811752662');" onmouseout="out('-1571805809811752662');" style=""> 595                  dirtyList.add(p.getName());                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 596              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597          }                                                                                                         </span>
<span class="7211627429904225799" onmouseenter="enter('7211627429904225799');" onmouseout="out('7211627429904225799');" style=""> 598          return dirtyList;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 599      }                                                                                                             </span>
<span  style=""> 600                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 601      /**                                                                                                           </span>
<span class="-1912365624495655250" onmouseenter="enter('-1912365624495655250');" onmouseout="out('-1912365624495655250');" style=""> 602       * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity form with   </span>
<span class="3378821078357952120" onmouseenter="enter('3378821078357952120');" onmouseout="out('3378821078357952120');" style=""> 603       * error fields highlighted. On a successful save, it will refresh the entity page.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 604       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 605       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 606       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 607       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 608       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 609       * @param id                                                                                                  </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 610       * @param entityForm                                                                                          </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 611       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 612       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 613       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 614       */                                                                                                           </span>
<span class="681227659796054179" onmouseenter="enter('681227659796054179');" onmouseout="out('681227659796054179');" style=""> 615      @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST)                                                 </span>
<span class="2696827203115285075" onmouseenter="enter('2696827203115285075');" onmouseout="out('2696827203115285075');" style=""> 616      public String saveEntity(HttpServletRequest request, HttpServletResponse response, Model model,               </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 617              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 618              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 619              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,                      </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 620              RedirectAttributes ra) throws Exception {                                                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 621          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 622          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 623          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 624          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 624          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 625          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span  style=""> 626                                                                                                                    </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 627          extractDynamicFormFields(cmd, entityForm);                                                                </span>
<span  style=""> 628                                                                                                                    </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 629          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 629          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCuðŸ”µ</abbr></span>
<span class="-4517703585527939334" onmouseenter="enter('-4517703585527939334');" onmouseout="out('-4517703585527939334');" style=""> 630          Entity entity = service.updateEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();             </span>
<span  style=""> 631                                                                                                                    </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 632          entityFormValidator.validate(entityForm, entity, result);                                                 </span>

<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 633          if (result.hasErrors()) {                                                                                 </span>
<span class="-9083492279253959347" onmouseenter="enter('-9083492279253959347');" onmouseout="out('-9083492279253959347');" style=""> 634              model.addAttribute(&quot;headerFlash&quot;, &quot;save.unsuccessful&quot;);                                               </span>
<span class="-3255113992478543295" onmouseenter="enter('-3255113992478543295');" onmouseout="out('-3255113992478543295');" style=""> 635              model.addAttribute(&quot;headerFlashAlert&quot;, true);                                                         </span>
<span  style=""> 636                                                                                                                    </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 637              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 637              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 638              entityForm.clearFieldsMap();                                                                          </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 639              formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);                </span>
<span  style=""> 640                                                                                                                    </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style=""> 641              if (isAddRequest(entity)) {                                                                           </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 642                  modifyAddEntityForm(entityForm, pathVars);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 643              } else {                                                                                              </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 644                  modifyEntityForm(entityForm, pathVars);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 645              }                                                                                                     </span>

<span  style=""> 646                                                                                                                    </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 647              model.addAttribute(&quot;entity&quot;, entity);                                                                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 648              model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                 </span>
<span  style=""> 649                                                                                                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 650              setModelAttributes(model, sectionKey);                                                                </span>
<span  style=""> 651                                                                                                                    </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 652              if (isAjaxRequest(request)) {                                                                         </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style=""> 653                  entityForm.setReadOnly();                                                                         </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style=""> 654                  model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                               </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style=""> 655                  model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                     </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style=""> 656                  return &quot;modules/modalContainer&quot;;                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 657              } else {                                                                                              </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 658                  model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                        </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 659                  model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                     </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style=""> 660                  return &quot;modules/defaultContainer&quot;;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661              }                                                                                                     </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 662          }                                                                                                         </span>
<span  style=""> 663                                                                                                                    </span>
<span class="-8977665602521560288" onmouseenter="enter('-8977665602521560288');" onmouseout="out('-8977665602521560288');" style=""> 664          ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;save.successful&quot;);                                                   </span>
<span  style=""> 665                                                                                                                    </span>
<span class="5326436654777975784" onmouseenter="enter('5326436654777975784');" onmouseout="out('5326436654777975784');" style=""> 666          return &quot;redirect:/&quot; + sectionKey + &quot;/&quot; + id;                                                              </span>
























<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 667      }                                                                                                             </span>
<span  style=""> 668                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 669      /**                                                                                                           </span>
<span class="4876253458579857532" onmouseenter="enter('4876253458579857532');" onmouseout="out('4876253458579857532');" style=""> 670       * Attempts to remove the given entity.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 671       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 672       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 673       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 674       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 675       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 676       * @param id                                                                                                  </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 677       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 678       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 679       */                                                                                                           </span>
<span class="8293921381301703428" onmouseenter="enter('8293921381301703428');" onmouseout="out('8293921381301703428');" style=""> 680      @RequestMapping(value = &quot;/{id}/delete&quot;, method = RequestMethod.POST)                                          </span>
<span class="2313354717081876463" onmouseenter="enter('2313354717081876463');" onmouseout="out('2313354717081876463');" style=""> 681      public String removeEntity(HttpServletRequest request, HttpServletResponse response, Model model,             </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 682              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 683              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 684              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,                      </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 685              RedirectAttributes ra) throws Exception {                                                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 686          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 687          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 688          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span  style=""> 689                                                                                                                    </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 690          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 690          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCuðŸ”µ</abbr></span>
<span class="6624819200143935214" onmouseenter="enter('6624819200143935214');" onmouseout="out('6624819200143935214');" style=""> 691          Entity entity = service.removeEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();             </span>
<span class="-6561774320633688873" onmouseenter="enter('-6561774320633688873');" onmouseout="out('-6561774320633688873');" style=""> 692          // Removal does not normally return an Entity unless there is some validation error                       </span>
<span class="-2807113977407494827" onmouseenter="enter('-2807113977407494827');" onmouseout="out('-2807113977407494827');" style=""> 693          if (entity != null) {                                                                                     </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 694              entityFormValidator.validate(entityForm, entity, result);                                             </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 695              if (result.hasErrors()) {                                                                             </span>
<span class="354313568014337940" onmouseenter="enter('354313568014337940');" onmouseout="out('354313568014337940');" style=""> 696                  // Create a flash attribute for the unsuccessful delete                                           </span>
<span class="-3408473788799892596" onmouseenter="enter('-3408473788799892596');" onmouseout="out('-3408473788799892596');" style=""> 697                  FlashMap fm = new FlashMap();                                                                     </span>
<span class="-3785724779356953427" onmouseenter="enter('-3785724779356953427');" onmouseout="out('-3785724779356953427');" style=""> 698                  fm.put(&quot;headerFlash&quot;, &quot;delete.unsuccessful&quot;);                                                     </span>
<span class="2000410372434500283" onmouseenter="enter('2000410372434500283');" onmouseout="out('2000410372434500283');" style=""> 699                  fm.put(&quot;headerFlashAlert&quot;, true);                                                                 </span>
<span class="-216272657842661141" onmouseenter="enter('-216272657842661141');" onmouseout="out('-216272657842661141');" style=""> 700                  request.setAttribute(DispatcherServlet.OUTPUT_FLASH_MAP_ATTRIBUTE, fm);                           </span>
<span  style=""> 701                                                                                                                    </span>
<span class="-9154666565283892619" onmouseenter="enter('-9154666565283892619');" onmouseout="out('-9154666565283892619');" style=""> 702                  // Re-look back up the entity so that we can return something populated                           </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 703                  PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 703                  PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 704                  ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();       </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 705                  entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];            </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 706                  Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 706                  Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, ðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 707                  entityForm.clearFieldsMap();                                                                      </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 708                  formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);            </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 709                  modifyEntityForm(entityForm, pathVars);                                                           </span>
<span  style=""> 710                                                                                                                    </span>
<span class="-1358530666837283115" onmouseenter="enter('-1358530666837283115');" onmouseout="out('-1358530666837283115');" style=""> 711                  return populateJsonValidationErrors(entityForm, result, new JsonResponse(response))               </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style=""> 712                          .done();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 713              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 714          }                                                                                                         </span>
<span  style=""> 715                                                                                                                    </span>
<span class="3611526951082120901" onmouseenter="enter('3611526951082120901');" onmouseout="out('3611526951082120901');" style=""> 716          ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;delete.successful&quot;);                                                 </span>
<span class="2579818068351246488" onmouseenter="enter('2579818068351246488');" onmouseout="out('2579818068351246488');" style=""> 717          ra.addFlashAttribute(&quot;headerFlashAlert&quot;, true);                                                           </span>
<span  style=""> 718                                                                                                                    </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 719          if (isAjaxRequest(request)) {                                                                             </span>
<span class="-5684384949344822714" onmouseenter="enter('-5684384949344822714');" onmouseout="out('-5684384949344822714');" style=""> 720              // redirect attributes won&#x27;t work here since ajaxredirect actually makes a new request                </span>
<span class="-9107475529968351628" onmouseenter="enter('-9107475529968351628');" onmouseout="out('-9107475529968351628');" style=""> 721              return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;?headerFlash=delete.successful&quot;;     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 722          } else {                                                                                                  </span>
<span class="4357427724598824699" onmouseenter="enter('4357427724598824699');" onmouseout="out('4357427724598824699');" style=""> 723              return &quot;redirect:/&quot; + sectionKey;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 725      }                                                                                                             </span>
<span  style=""> 726                                                                                                                    </span>
<span class="-2983794507366563158" onmouseenter="enter('-2983794507366563158');" onmouseout="out('-2983794507366563158');" style=""> 727      @RequestMapping(value = &quot;/{collectionField:.*}/details&quot;, method = RequestMethod.GET)                          </span>
<span class="-527911248282232950" onmouseenter="enter('-527911248282232950');" onmouseout="out('-527911248282232950');" style=""><abbr title=" 728      public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 728      public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpServletRespðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 729              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 730              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-5250072335910309101" onmouseenter="enter('-5250072335910309101');" onmouseout="out('-5250072335910309101');" style=""> 731              @RequestParam String ids,                                                                             </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 732              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 733          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 734          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 735          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                                 </span>
<span class="-5225610456611199616" onmouseenter="enter('-5225610456611199616');" onmouseout="out('-5225610456611199616');" style=""><abbr title=" 736          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, sectionCrumbs, pathVars);"> 736          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, sectiðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""> 737          ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 738          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 739          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style=""> 740                                                                                                                    </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style=""> 741          ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                          </span>
<span class="-2120492003233088270" onmouseenter="enter('-2120492003233088270');" onmouseout="out('-2120492003233088270');" style=""> 742          ppr.setStartIndex(getStartIndex(requestParams));                                                          </span>
<span class="2736790979641523309" onmouseenter="enter('2736790979641523309');" onmouseout="out('2736790979641523309');" style=""> 743          ppr.setMaxIndex(getMaxIndex(requestParams));                                                              </span>
<span  style=""> 744                                                                                                                    </span>
<span class="-8000769512056204294" onmouseenter="enter('-8000769512056204294');" onmouseout="out('-8000769512056204294');" style=""> 745          if (md instanceof BasicFieldMetadata) {                                                                   </span>
<span class="-1954892043355765019" onmouseenter="enter('-1954892043355765019');" onmouseout="out('-1954892043355765019');" style=""> 746              String idProp = ((BasicFieldMetadata) md).getForeignKeyProperty();                                    </span>
<span class="6288096257758990604" onmouseenter="enter('6288096257758990604');" onmouseout="out('6288096257758990604');" style=""> 747              String displayProp = ((BasicFieldMetadata) md).getForeignKeyDisplayValueProperty();                   </span>
<span  style=""> 748                                                                                                                    </span>
<span class="-6477100624593005266" onmouseenter="enter('-6477100624593005266');" onmouseout="out('-6477100624593005266');" style=""> 749              List&lt;String&gt; filterValues = BLCArrayUtils.asList(ids.split(FILTER_VALUE_SEPARATOR_REGEX));            </span>
<span class="3640259021720155935" onmouseenter="enter('3640259021720155935');" onmouseout="out('3640259021720155935');" style=""> 750              ppr.addFilterAndSortCriteria(new FilterAndSortCriteria(idProp, filterValues));                        </span>
<span  style=""> 751                                                                                                                    </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style=""> 752              DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                                 </span>
<span class="-2768740094948248396" onmouseenter="enter('-2768740094948248396');" onmouseout="out('-2768740094948248396');" style=""> 753              Map&lt;String, String&gt; returnMap = new HashMap&lt;&gt;();                                                      </span>
<span  style=""> 754                                                                                                                    </span>
<span class="-5517026699518874938" onmouseenter="enter('-5517026699518874938');" onmouseout="out('-5517026699518874938');" style=""> 755              for (Entity e : drs.getRecords()) {                                                                   </span>
<span class="4979367110517822568" onmouseenter="enter('4979367110517822568');" onmouseout="out('4979367110517822568');" style=""> 756                  String id = e.getPMap().get(idProp).getValue();                                                   </span>
<span class="-4946347213336092877" onmouseenter="enter('-4946347213336092877');" onmouseout="out('-4946347213336092877');" style=""> 757                  String disp = e.getPMap().get(displayProp).getDisplayValue();                                     </span>
<span  style=""> 758                                                                                                                    </span>
<span class="3483982845402449596" onmouseenter="enter('3483982845402449596');" onmouseout="out('3483982845402449596');" style=""> 759                  if (StringUtils.isBlank(disp)) {                                                                  </span>
<span class="-2027181132953179584" onmouseenter="enter('-2027181132953179584');" onmouseout="out('-2027181132953179584');" style=""> 760                      disp = e.getPMap().get(displayProp).getValue();                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 761                  }                                                                                                 </span>
<span  style=""> 762                                                                                                                    </span>
<span class="-1075893121428940879" onmouseenter="enter('-1075893121428940879');" onmouseout="out('-1075893121428940879');" style=""> 763                  returnMap.put(id,  disp);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 764              }                                                                                                     </span>
<span  style=""> 765                                                                                                                    </span>
<span class="9157811424862351106" onmouseenter="enter('9157811424862351106');" onmouseout="out('9157811424862351106');" style=""> 766              return returnMap;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 767          }                                                                                                         </span>
<span  style=""> 768                                                                                                                    </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 769          return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 770      }                                                                                                             </span>
<span  style=""> 771                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 772      /**                                                                                                           </span>
<span class="7896529828316523089" onmouseenter="enter('7896529828316523089');" onmouseout="out('7896529828316523089');" style=""><abbr title=" 773       * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a list of products"> 773       * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a list of pðŸ”µ</abbr></span>
<span class="8702245574166025616" onmouseenter="enter('8702245574166025616');" onmouseout="out('8702245574166025616');" style=""> 774       * then this method is invoked when a user clicks on the name of the default category field.                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 775       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 776       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 777       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 778       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 779       * @param pathVars                                                                                            </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 780       * @param collectionField                                                                                     </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 781       * @param id                                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 782       * @return                                                                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 783       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 784       */                                                                                                           </span>
<span class="1405910210670150204" onmouseenter="enter('1405910210670150204');" onmouseout="out('1405910210670150204');" style=""> 785      @RequestMapping(value = &quot;/{collectionField:.*}/{id}/view&quot;, method = RequestMethod.GET)                        </span>
<span class="-5496524556428427140" onmouseenter="enter('-5496524556428427140');" onmouseout="out('-5496524556428427140');" style=""> 786      public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, Model model,</span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 787              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 788              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-1857511616350008386" onmouseenter="enter('-1857511616350008386');" onmouseout="out('-1857511616350008386');" style=""> 789              @PathVariable(value=&quot;id&quot;) String id) throws Exception {                                               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 790          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 791          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 792          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 793          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 793          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 794          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="2157347470680130722" onmouseenter="enter('2157347470680130722');" onmouseout="out('2157347470680130722');" style=""> 795          BasicFieldMetadata md = (BasicFieldMetadata) collectionProperty.getMetadata();                            </span>
<span  style=""> 796                                                                                                                    </span>
<span class="-1856968160831305726" onmouseenter="enter('-1856968160831305726');" onmouseout="out('-1856968160831305726');" style=""><abbr title=" 797          AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeyClass(), sectionKey);"> 797          AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeyClass(),ðŸ”µ</abbr></span>
<span class="-151095669048618305" onmouseenter="enter('-151095669048618305');" onmouseout="out('-151095669048618305');" style=""><abbr title=" 798          String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : section.getUrl();"> 798          String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : section.getUrlðŸ”µ</abbr></span>
<span class="4949862081138664893" onmouseenter="enter('4949862081138664893');" onmouseout="out('4949862081138664893');" style=""> 799          Map&lt;String, String&gt; varsForField = new HashMap&lt;&gt;();                                                       </span>
<span class="-4429965231898090358" onmouseenter="enter('-4429965231898090358');" onmouseout="out('-4429965231898090358');" style=""> 800          varsForField.put(&quot;sectionKey&quot;, sectionUrlKey);                                                            </span>
<span class="4805235980730638518" onmouseenter="enter('4805235980730638518');" onmouseout="out('4805235980730638518');" style=""> 801          return viewEntityForm(request, response, model, varsForField, id);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 802      }                                                                                                             </span>
<span  style=""> 803                                                                                                                    </span>
<span class="2731983140361230349" onmouseenter="enter('2731983140361230349');" onmouseout="out('2731983140361230349');" style=""> 804      @RequestMapping(                                                                                              </span>
<span class="4528666449367390600" onmouseenter="enter('4528666449367390600');" onmouseout="out('4528666449367390600');" style=""> 805              value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{tab:[0-9]+}/{tabName}&quot;,                       </span>
<span class="7470628324060602258" onmouseenter="enter('7470628324060602258');" onmouseout="out('7470628324060602258');" style=""> 806              method = RequestMethod.POST                                                                           </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 807      )                                                                                                             </span>
<span class="1786222500639285262" onmouseenter="enter('1786222500639285262');" onmouseout="out('1786222500639285262');" style=""> 808      public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model model,    </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 809                                          @PathVariable  Map&lt;String, String&gt; pathVars,                              </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 810                                          @PathVariable(value=&quot;id&quot;) String id,                                      </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 811                                          @PathVariable(value=&quot;collectionField&quot;) String collectionField,            </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style=""> 812                                          @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,          </span>
<span class="1347902176383833481" onmouseenter="enter('1347902176383833481');" onmouseout="out('1347902176383833481');" style=""> 813                                          @PathVariable(value=&quot;tabName&quot;) String tabName,                            </span>
<span class="-2122907702415237135" onmouseenter="enter('-2122907702415237135');" onmouseout="out('-2122907702415237135');" style=""><abbr title=" 814                                          @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throws Exception {"> 814                                          @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throws ExceptðŸ”µ</abbr></span>
<span  style=""> 815                                                                                                                    </span>
<span class="2284268618604436814" onmouseenter="enter('2284268618604436814');" onmouseout="out('2284268618604436814');" style=""><abbr title=" 816          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ModalHeaderType.VIEW_COLLECTION_ITEM.getType(), entityForm, null);"> 816          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ModalHeadðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 817      }                                                                                                             </span>
<span  style=""> 818                                                                                                                    </span>
<span  style=""> 819                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 820      /**                                                                                                           </span>
<span class="1274042523848442367" onmouseenter="enter('1274042523848442367');" onmouseout="out('1274042523848442367');" style=""> 821       * Returns the records for a given collectionField filtered by a particular criteria                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 822       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 823       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 824       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 825       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 826       * @param pathVars                                                                                            </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 827       * @param collectionField                                                                                     </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 828       * @param requestParams                                                                                       </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 829       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 830       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 831       */                                                                                                           </span>
<span class="-4095443548484775059" onmouseenter="enter('-4095443548484775059');" onmouseout="out('-4095443548484775059');" style=""> 832      @RequestMapping(value = &quot;/{id}/{collectionField:.*}&quot;, method = RequestMethod.GET)                             </span>
<span class="-5889287394210369546" onmouseenter="enter('-5889287394210369546');" onmouseout="out('-5889287394210369546');" style=""> 833      public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, Model model,</span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 834              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 835              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 836              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="3465670919255037355" onmouseenter="enter('3465670919255037355');" onmouseout="out('3465670919255037355');" style=""> 837              @RequestParam  MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                        </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 838          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 839          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 840          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-6545915569490985196" onmouseenter="enter('-6545915569490985196');" onmouseout="out('-6545915569490985196');" style=""><abbr title=" 841          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams, sectionCrumbs, pathVars);"> 841          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams, sectionCðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""> 842          ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 843          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style=""> 844                                                                                                                    </span>
<span class="-3734134243620930531" onmouseenter="enter('-3734134243620930531');" onmouseout="out('-3734134243620930531');" style=""> 845          ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);                        </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""> 846          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style=""> 847                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style=""> 848          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="-8440278474384944243" onmouseenter="enter('-8440278474384944243');" onmouseout="out('-8440278474384944243');" style=""><abbr title=" 849          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParams, sectionKey, sectionCrumbs);"> 849          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParams, sectionðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 850          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span  style=""> 851                                                                                                                    </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style=""> 852          model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));                </span>
<span  style=""> 853                                                                                                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style=""> 854          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 855          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style=""> 856          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 857      }                                                                                                             </span>
<span  style=""> 858                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 859      /**                                                                                                           </span>
<span class="-2279175998905644242" onmouseenter="enter('-2279175998905644242');" onmouseout="out('-2279175998905644242');" style=""><abbr title=" 860       * Shows the modal dialog that is used to add an item to a given collection. There are several possible outcomes"> 860       * Shows the modal dialog that is used to add an item to a given collection. There are several possible outcomðŸ”µ</abbr></span>
<span class="-3490572548815062734" onmouseenter="enter('-3490572548815062734');" onmouseout="out('-3490572548815062734');" style=""> 861       * of this call depending on the type of the specified collection field.                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 862       *                                                                                                            </span>
<span class="2717555647352622731" onmouseenter="enter('2717555647352622731');" onmouseout="out('2717555647352622731');" style=""> 863       * &lt;ul&gt;                                                                                                       </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 864       *  &lt;li&gt;                                                                                                      </span>
<span class="4930235181592711719" onmouseenter="enter('4930235181592711719');" onmouseout="out('4930235181592711719');" style=""><abbr title=" 865       *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so that the user may"> 865       *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so that the useðŸ”µ</abbr></span>
<span class="-3142080293607523336" onmouseenter="enter('-3142080293607523336');" onmouseout="out('-3142080293607523336');" style=""><abbr title=" 866       *    enter information and associate the record with this collection. Used by fields such as ProductAttribute."> 866       *    enter information and associate the record with this collection. Used by fields such as ProductAttributeðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 867       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 868       *  &lt;li&gt;                                                                                                      </span>
<span class="6319691685860667757" onmouseenter="enter('6319691685860667757');" onmouseout="out('6319691685860667757');" style=""><abbr title=" 869       *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and select it."> 869       *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and seðŸ”µ</abbr></span>
<span class="-8731186021492741581" onmouseenter="enter('-8731186021492741581');" onmouseout="out('-8731186021492741581');" style=""> 870       *    Used by fields such as &quot;allParentCategories&quot;.                                                           </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 871       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 872       *  &lt;li&gt;                                                                                                      </span>
<span class="-6847404578833725914" onmouseenter="enter('-6847404578833725914');" onmouseout="out('-6847404578833725914');" style=""><abbr title=" 873       *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 873       *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entitðŸ”µ</abbr></span>
<span class="568361472595397074" onmouseenter="enter('568361472595397074');" onmouseout="out('568361472595397074');" style=""><abbr title=" 874       *    select it. The view rendered by this is identical to basic collection (lookup), but will perform the operation"> 874       *    select it. The view rendered by this is identical to basic collection (lookup), but will perform the opeðŸ”µ</abbr></span>
<span class="-4048066359856567222" onmouseenter="enter('-4048066359856567222');" onmouseout="out('-4048066359856567222');" style=""><abbr title=" 875       *    on an adorned field, which may carry extra meta-information about the created relationship, such as order."> 875       *    on an adorned field, which may carry extra meta-information about the created relationship, such as ordeðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 876       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 877       *  &lt;li&gt;                                                                                                      </span>
<span class="7355096557601214207" onmouseenter="enter('7355096557601214207');" onmouseout="out('7355096557601214207');" style=""><abbr title=" 878       *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and"> 878       *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity aðŸ”µ</abbr></span>
<span class="-146713903552295440" onmouseenter="enter('-146713903552295440');" onmouseout="out('-146713903552295440');" style=""><abbr title=" 879       *    select it. Once the user selects the entity, he will be presented with an empty form based on the specified"> 879       *    select it. Once the user selects the entity, he will be presented with an empty form based on the specifðŸ”µ</abbr></span>
<span class="7585671366133275820" onmouseenter="enter('7585671366133275820');" onmouseout="out('7585671366133275820');" style=""><abbr title=" 880       *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, which in addition"> 880       *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, which in addðŸ”µ</abbr></span>
<span class="7350312284882119043" onmouseenter="enter('7350312284882119043');" onmouseout="out('7350312284882119043');" style=""> 881       *    to linking an entity, provide extra fields, such as a promotional message.                              </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 882       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style=""> 883       *  &lt;li&gt;                                                                                                      </span>
<span class="8829232354049589291" onmouseenter="enter('8829232354049589291');" onmouseout="out('8829232354049589291');" style=""><abbr title=" 884       *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. This field is"> 884       *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. This fielðŸ”µ</abbr></span>
<span class="-8508051731153769866" onmouseenter="enter('-8508051731153769866');" onmouseout="out('-8508051731153769866');" style=""><abbr title=" 885       *    populated either from the configured map keys, or as a result of a lookup in the case of a key based on another"> 885       *    populated either from the configured map keys, or as a result of a lookup in the case of a key based on ðŸ”µ</abbr></span>
<span class="-6056737616128420156" onmouseenter="enter('-6056737616128420156');" onmouseout="out('-6056737616128420156');" style=""> 886       *    entity. Used by fields such as the mediaMap on a Sku.                                                   </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style=""> 887       *  &lt;/li&gt;                                                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 888       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 889       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 890       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 891       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 892       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 893       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 894       * @param collectionField                                                                                     </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 895       * @param requestParams                                                                                       </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 896       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 897       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 898       */                                                                                                           </span>
<span class="835275592837580694" onmouseenter="enter('835275592837580694');" onmouseout="out('835275592837580694');" style=""> 899      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.GET)                         </span>
<span class="2460266594736272943" onmouseenter="enter('2460266594736272943');" onmouseout="out('2460266594736272943');" style=""> 900      public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,    </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 901              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 902              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style=""> 903              @PathVariable(value = &quot;collectionField&quot;) String collectionField,                                      </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 904              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 905          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 906          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 907          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style=""> 908          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,  </span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style=""> 909                  sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                               </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 910          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 911          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style=""> 912                                                                                                                    </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style=""> 913          PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)                 </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style=""> 914                  .withFilterAndSortCriteria(getCriteria(requestParams))                                            </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style=""> 915                  .withStartIndex(getStartIndex(requestParams))                                                     </span>
<span class="4786121744461484155" onmouseenter="enter('4786121744461484155');" onmouseout="out('4786121744461484155');" style=""> 916                  .withMaxIndex(getMaxIndex(requestParams))                                                         </span>
<span class="2941692162045974129" onmouseenter="enter('2941692162045974129');" onmouseout="out('2941692162045974129');" style=""> 917                  .withLastId(getLastId(requestParams))                                                             </span>
<span class="-9137331061893195290" onmouseenter="enter('-9137331061893195290');" onmouseout="out('-9137331061893195290');" style=""> 918                  .withFirstId(getFirstId(requestParams))                                                           </span>
<span class="-6497878492174321892" onmouseenter="enter('-6497878492174321892');" onmouseout="out('-6497878492174321892');" style=""> 919                  .withUpperCount(getUpperCount(requestParams))                                                     </span>
<span class="-8373154769706308503" onmouseenter="enter('-8373154769706308503');" onmouseout="out('-8373154769706308503');" style=""> 920                  .withLowerCount(getLowerCount(requestParams))                                                     </span>
<span class="-1051723743320189375" onmouseenter="enter('-1051723743320189375');" onmouseout="out('-1051723743320189375');" style=""> 921                  .withPageSize(getPageSize(requestParams))                                                         </span>
<span class="-6582704259903712752" onmouseenter="enter('-6582704259903712752');" onmouseout="out('-6582704259903712752');" style=""> 922                  .withPresentationFetch(true);                                                                     </span>
<span  style=""> 923                                                                                                                    </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style=""> 924          if (md instanceof BasicCollectionMetadata) {                                                              </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style=""> 925              BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                           </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style=""> 926              if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                           </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 927                  ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();       </span>
<span class="-2914433993330253670" onmouseenter="enter('-2914433993330253670');" onmouseout="out('-2914433993330253670');" style=""> 928                  // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types</span>
<span class="-7795450821592681641" onmouseenter="enter('-7795450821592681641');" onmouseout="out('-7795450821592681641');" style=""> 929                  // for this entity.                                                                               </span>
<span class="6186895968667433501" onmouseenter="enter('6186895968667433501');" onmouseout="out('6186895968667433501');" style=""> 930                  String entityType = null;                                                                         </span>

<span class="3580632700461537732" onmouseenter="enter('3580632700461537732');" onmouseout="out('3580632700461537732');" style=""> 931                  if (requestParams.containsKey(&quot;entityType&quot;)) {                                                    </span>
<span class="-1630371572733568969" onmouseenter="enter('-1630371572733568969');" onmouseout="out('-1630371572733568969');" style=""> 932                      entityType = requestParams.get(&quot;entityType&quot;).get(0);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 933                  }                                                                                                 </span>



<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 934                  if (StringUtils.isBlank(entityType)) {                                                            </span>
<span class="2333848870190395940" onmouseenter="enter('2333848870190395940');" onmouseout="out('2333848870190395940');" style=""> 935                      if (cmd.getPolymorphicEntities().getChildren().length == 0) {                                 </span>
<span class="2097783908693957449" onmouseenter="enter('2097783908693957449');" onmouseout="out('2097783908693957449');" style=""> 936                          entityType = cmd.getPolymorphicEntities().getFullyQualifiedClassname();                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 937                      } else {                                                                                      </span>
<span class="-6902702564943152777" onmouseenter="enter('-6902702564943152777');" onmouseout="out('-6902702564943152777');" style=""> 938                          entityType = getDefaultEntityType();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 939                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 940                  } else {                                                                                          </span>
<span class="7843468667819793383" onmouseenter="enter('7843468667819793383');" onmouseout="out('7843468667819793383');" style=""> 941                      entityType = URLDecoder.decode(entityType, &quot;UTF-8&quot;);                                          </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 942                  }                                                                                                 </span>
<span  style=""> 943                                                                                                                    </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 944                  if (StringUtils.isBlank(entityType)) {                                                            </span>
<span class="-5632901614715850082" onmouseenter="enter('-5632901614715850082');" onmouseout="out('-5632901614715850082');" style=""> 945                      List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style=""> 946                      model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                               </span>
<span class="-7344898891916261334" onmouseenter="enter('-7344898891916261334');" onmouseout="out('-7344898891916261334');" style=""> 947                      model.addAttribute(&quot;viewType&quot;, &quot;modal/entityTypeSelection&quot;);                                  </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 948                      model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());     </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style=""> 949                      String requestUri = request.getRequestURI();                                                  </span>
<span class="2670437920401576748" onmouseenter="enter('2670437920401576748');" onmouseout="out('2670437920401576748');" style=""><abbr title=" 950                      if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) {"> 950                      if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) ðŸ”µ</abbr></span>
<span class="-901741071381030126" onmouseenter="enter('-901741071381030126');" onmouseout="out('-901741071381030126');" style=""><abbr title=" 951                          requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length());"> 951                          requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.lengthðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 952                      }                                                                                             </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style=""> 953                      model.addAttribute(&quot;currentUri&quot;, requestUri);                                                 </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 954                      model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 955                      setModelAttributes(model, sectionKey);                                                        </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style=""> 956                      return &quot;modules/modalContainer&quot;;                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 957                  } else {                                                                                          </span>
<span class="-58316621888079189" onmouseenter="enter('-58316621888079189');" onmouseout="out('-58316621888079189');" style=""> 958                      ppr = ppr.withCeilingEntityClassname(entityType);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 959                  }                                                                                                 </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 960              }                                                                                                     </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style=""> 961          } else if (md instanceof MapMetadata) {                                                                   </span>
<span class="-8815560953057448419" onmouseenter="enter('-8815560953057448419');" onmouseout="out('-8815560953057448419');" style=""><abbr title=" 962              ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(request,response,model,sectionKey,id,requestParams,(MapMetadata) md);"> 962              ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(requestðŸ”µ</abbr></span>
<span class="6674469997589527714" onmouseenter="enter('6674469997589527714');" onmouseout="out('6674469997589527714');" style=""> 963              if (result.equals(ExtensionResultStatusType.HANDLED)) {                                               </span>
<span class="1057476267973220454" onmouseenter="enter('1057476267973220454');" onmouseout="out('1057476267973220454');" style=""> 964                  model.addAttribute(&quot;entityId&quot;, id);                                                               </span>
<span class="6720161805434028669" onmouseenter="enter('6720161805434028669');" onmouseout="out('6720161805434028669');" style=""> 965                  model.addAttribute(&quot;sectionKey&quot;, sectionKey);                                                     </span>
<span class="-2435595331613687341" onmouseenter="enter('-2435595331613687341');" onmouseout="out('-2435595331613687341');" style=""> 966                  model.addAttribute(&quot;collectionField&quot;, collectionField);                                           </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style=""> 967                  return &quot;modules/modalContainer&quot;;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 968              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 969          }                                                                                                         </span>
<span  style=""> 970                                                                                                                    </span>
<span class="3903557829936589355" onmouseenter="enter('3903557829936589355');" onmouseout="out('3903557829936589355');" style=""> 971          //service.getContextSpecificRelationshipId(mainMetadata, entity, prefix);                                 </span>



<span  style=""> 972                                                                                                                    </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style=""> 973          model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));                </span>
<span  style=""> 974                                                                                                                    </span>
<span class="6180232744784249160" onmouseenter="enter('6180232744784249160');" onmouseout="out('6180232744784249160');" style=""><abbr title=" 975          return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty, md, ppr, null, null);"> 975          return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionPrðŸ”µ</abbr></span>





















<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 976      }                                                                                                             </span>
<span  style=""> 977                                                                                                                    </span>
<span class="373770933822047642" onmouseenter="enter('373770933822047642');" onmouseout="out('373770933822047642');" style=""><abbr title=" 978      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMethod.POST)"> 978      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMethod.POSðŸ”µ</abbr></span>
<span class="-870509305261572147" onmouseenter="enter('-870509305261572147');" onmouseout="out('-870509305261572147');" style=""><abbr title=" 979      public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,"> 979      public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResponse resðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 980              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 981              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 982              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style=""> 983              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 984          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 985          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 986          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 987          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 987          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 988          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 989          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style=""> 990          Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                        </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style=""> 991          if (md instanceof AdornedTargetCollectionMetadata) {                                                      </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title=" 992              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,"> 992              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassNaðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style=""> 993                      collectionField,                                                                              </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style=""> 994                      collectionItemId, responseMap);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 995          }                                                                                                         </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style=""> 996          return responseMap;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 997      }                                                                                                             </span>
<span  style=""> 998                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 999      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1000       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1001       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1002       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1003       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1004       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1005       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1006       * @param collectionField                                                                                     </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style="">1007       * @param requestParams                                                                                       </span>
<span class="-4008047975326689228" onmouseenter="enter('-4008047975326689228');" onmouseout="out('-4008047975326689228');" style="">1008       * @return Json collection data                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1009       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1010       */                                                                                                           </span>
<span class="1491507797785399205" onmouseenter="enter('1491507797785399205');" onmouseout="out('1491507797785399205');" style="">1011      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize&quot;, method = RequestMethod.GET)                   </span>
<span class="3394871197523978831" onmouseenter="enter('3394871197523978831');" onmouseout="out('3394871197523978831');" style=""><abbr title="1012      public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletResponse response, Model model,">1012      public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1013              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style="">1014              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style="">1015              @PathVariable(value = &quot;collectionField&quot;) String collectionField,                                      </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style="">1016              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1017          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1018          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1019          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style="">1020          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,  </span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style="">1021                  sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                               </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1022          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1023          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style="">1024                                                                                                                    </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style="">1025          PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)                 </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style="">1026                  .withFilterAndSortCriteria(getCriteria(requestParams))                                            </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style="">1027                  .withStartIndex(getStartIndex(requestParams))                                                     </span>
<span class="4786121744461484155" onmouseenter="enter('4786121744461484155');" onmouseout="out('4786121744461484155');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1028 -                .withMaxIndex(getMaxIndex(requestParams))                                                         </span>
<span class="245535740239558332" onmouseenter="enter('245535740239558332');" onmouseout="out('245535740239558332');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1029 -                .withCustomCriteria(buildSelectizeCustomCriteria());                                              </span>
<span class="-115113180096268460" onmouseenter="enter('-115113180096268460');" onmouseout="out('-115113180096268460');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1030 +                .withMaxIndex(getMaxIndex(requestParams));                                                        </span>
<span class="1857239787668878379" onmouseenter="enter('1857239787668878379');" onmouseout="out('1857239787668878379');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="1031 +        String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizeCustomCriteria()))">1031 +        String[] both = Stream.concat(Arrays.stream(ppr.getCustomCriteria()), Arrays.stream(buildSelectizeCustomCrðŸ”µ</abbr></span>
<span class="8925682901439482297" onmouseenter="enter('8925682901439482297');" onmouseout="out('8925682901439482297');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1032 +                .toArray(String[]::new);                                                                          </span>
<span class="-226841645969872938" onmouseenter="enter('-226841645969872938');" onmouseout="out('-226841645969872938');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1033 +        ppr = ppr.withCustomCriteria( both);                                                                      </span>
<span  style="">1034                                                                                                                    </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1035          if (md instanceof AdornedTargetCollectionMetadata) {                                                      </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1036              ppr.setOperationTypesOverride(null);                                                                  </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1037              ppr.setType(PersistencePackageRequest.Type.STANDARD);                                                 </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1038              ppr.setSectionEntityField(collectionField);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1039          }                                                                                                         </span>
<span  style="">1040                                                                                                                    </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1041          DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                                     </span>
<span  style="">1042                                                                                                                    </span>
<span class="9153362413933125536" onmouseenter="enter('9153362413933125536');" onmouseout="out('9153362413933125536');" style="">1043          return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCrumbs);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1044      }                                                                                                             </span>
<span  style="">1045                                                                                                                    </span>
<span class="-7439222430983038453" onmouseenter="enter('-7439222430983038453');" onmouseout="out('-7439222430983038453');" style="">1046      protected String[] buildSelectizeCustomCriteria() {                                                           </span>
<span class="-4161579644301235736" onmouseenter="enter('-4161579644301235736');" onmouseout="out('-4161579644301235736');" style="">1047          return new String[]{ IS_SELECTIZE_REQUEST };                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1048      }                                                                                                             </span>
<span  style="">1049                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1050      /**                                                                                                           </span>
<span class="-7141111024633203374" onmouseenter="enter('-7141111024633203374');" onmouseout="out('-7141111024633203374');" style="">1051       * Adds the requested collection item via Selectize                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1052       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1053       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1054       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1055       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1056       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1057       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1058       * @param collectionField                                                                                     </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1059       * @param entityForm                                                                                          </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1060       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1061       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1062       */                                                                                                           </span>
<span class="4942792763487402415" onmouseenter="enter('4942792763487402415');" onmouseout="out('4942792763487402415');" style="">1063      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize-add&quot;, method = RequestMethod.POST)              </span>
<span class="8163998475300370418" onmouseenter="enter('8163998475300370418');" onmouseout="out('8163998475300370418');" style=""><abbr title="1064      public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1064      public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpServletResðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1065              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1066              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1067              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style="">1068              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-3120252458037341618" onmouseenter="enter('-3120252458037341618');" onmouseout="out('-3120252458037341618');" style="">1069          Map&lt;String, Object&gt; returnVal = new HashMap&lt;&gt;();                                                          </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1070          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1071          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1072          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1073          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1073          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1074          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1075                                                                                                                    </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1076          if (StringUtils.isBlank(entityForm.getEntityType())) {                                                    </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1077              FieldMetadata fmd = collectionProperty.getMetadata();                                                 </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1078              if (fmd instanceof BasicCollectionMetadata) {                                                         </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1079                  entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1080              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1081          }                                                                                                         </span>
<span  style="">1082                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1083          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1083          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style="">1084          ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                                    </span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1085          declareShouldIgnoreAdditionStatusFilter();                                                                </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1086          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">1087                                                                                                                    </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1088          // First, we must save the collection entity                                                              </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1089          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1089          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1090          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1091          entityFormValidator.validate(entityForm, savedEntity, result);                                            </span>
<span  style="">1092                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1093          if (result.hasErrors()) {                                                                                 </span>
<span class="842224369260603633" onmouseenter="enter('842224369260603633');" onmouseout="out('842224369260603633');" style="">1094              returnVal.put(&quot;error&quot;, result.getFieldError());                                                       </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1095              return returnVal;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1096          }                                                                                                         </span>
<span  style="">1097                                                                                                                    </span>
<span class="2610632867002015507" onmouseenter="enter('2610632867002015507');" onmouseout="out('2610632867002015507');" style="">1098          if (savedEntity.findProperty(ALTERNATE_ID_PROPERTY) != null) {                                            </span>
<span class="-5383740165855607078" onmouseenter="enter('-5383740165855607078');" onmouseout="out('-5383740165855607078');" style="">1099              returnVal.put(&quot;alternateId&quot;, savedEntity.findProperty(ALTERNATE_ID_PROPERTY).getValue());             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1100          }                                                                                                         </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1101          return returnVal;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1102      }                                                                                                             </span>
<span  style="">1103                                                                                                                    </span>
<span class="5412920841771640365" onmouseenter="enter('5412920841771640365');" onmouseout="out('5412920841771640365');" style="">1104      protected void declareShouldIgnoreAdditionStatusFilter() {                                                    </span>
<span class="-4270951653865217168" onmouseenter="enter('-4270951653865217168');" onmouseout="out('-4270951653865217168');" style=""><abbr title="1105          Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().getAdditionalProperties();">1105          Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().getAdditioðŸ”µ</abbr></span>
<span class="-3723341051420574210" onmouseenter="enter('-3723341051420574210');" onmouseout="out('-3723341051420574210');" style="">1106          additionalProperties.put(&quot;shouldIgnoreAdditionStatusFilter&quot;, true);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1107      }                                                                                                             </span>
<span  style="">1108                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1109      /**                                                                                                           </span>
<span class="1325408264830379158" onmouseenter="enter('1325408264830379158');" onmouseout="out('1325408264830379158');" style="">1110       * Adds the requested collection item                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1111       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1112       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1113       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1114       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1115       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1116       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1117       * @param collectionField                                                                                     </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1118       * @param entityForm                                                                                          </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1119       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1120       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1121       */                                                                                                           </span>
<span class="-2068929988984533631" onmouseenter="enter('-2068929988984533631');" onmouseout="out('-2068929988984533631');" style="">1122      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.POST)                        </span>
<span class="-6457137423768539998" onmouseenter="enter('-6457137423768539998');" onmouseout="out('-6457137423768539998');" style="">1123      public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,        </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1124              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1125              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1126              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style="">1127              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1128          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1129          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1130          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1131          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1131          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1132          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1133                                                                                                                    </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1134          if (StringUtils.isBlank(entityForm.getEntityType())) {                                                    </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1135              FieldMetadata fmd = collectionProperty.getMetadata();                                                 </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1136              if (fmd instanceof BasicCollectionMetadata) {                                                         </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1137                  entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1138              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1139          }                                                                                                         </span>
<span  style="">1140                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1141          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1141          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1142          declareShouldIgnoreAdditionStatusFilter();                                                                </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1143          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">1144                                                                                                                    </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1145          // First, we must save the collection entity                                                              </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1146          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1146          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1147          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1148          entityFormValidator.validate(entityForm, savedEntity, result);                                            </span>
<span  style="">1149                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1150          if (result.hasErrors()) {                                                                                 </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1151              FieldMetadata md = collectionProperty.getMetadata();                                                  </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1152              ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                      </span>
<span class="4503162777083318611" onmouseenter="enter('4503162777083318611');" onmouseout="out('4503162777083318611');" style=""><abbr title="1153              return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty,">1153              return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectiðŸ”µ</abbr></span>
<span class="5267635088951466475" onmouseenter="enter('5267635088951466475');" onmouseout="out('5267635088951466475');" style="">1154                      md, ppr, entityForm, savedEntity);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1155          }                                                                                                         </span>
<span  style="">1156                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1157          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1158          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1158          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1159          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span  style="">1160                                                                                                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1161          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="7250522969210652718" onmouseenter="enter('7250522969210652718');" onmouseout="out('7250522969210652718');" style="">1162          model.addAttribute(&quot;actualEntityId&quot;, id);                                                                 </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1163          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1164          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1165      }                                                                                                             </span>
<span  style="">1166                                                                                                                    </span>
<span class="-8003545521832011894" onmouseenter="enter('-8003545521832011894');" onmouseout="out('-8003545521832011894');" style="">1167      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/addEmpty&quot;, method = RequestMethod.POST)                   </span>
<span class="162700220048203938" onmouseenter="enter('162700220048203938');" onmouseout="out('162700220048203938');" style=""><abbr title="1168      public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1168      public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse response, MðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1169              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1170              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1171              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style="">1172              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1173          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1174          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1175          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1176          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1176          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1177          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1178                                                                                                                    </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1179          if (StringUtils.isBlank(entityForm.getEntityType())) {                                                    </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1180              FieldMetadata fmd = collectionProperty.getMetadata();                                                 </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1181              if (fmd instanceof BasicCollectionMetadata) {                                                         </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1182                  entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1183              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1184          }                                                                                                         </span>
<span  style="">1185                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1186          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1186          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1187          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span class="-5337934248855825573" onmouseenter="enter('-5337934248855825573');" onmouseout="out('-5337934248855825573');" style="">1188          entity.setIsPreAdd(true);                                                                                 </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1189          // First, we must save the collection entity                                                              </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1190          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1190          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1191          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span  style="">1192                                                                                                                    </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1193          return new JsonResponse(response)                                                                         </span>
<span class="-645443211281069037" onmouseenter="enter('-645443211281069037');" onmouseout="out('-645443211281069037');" style="">1194                  .with(&quot;status&quot;, &quot;complete&quot;)                                                                       </span>
<span class="-7858493257692229655" onmouseenter="enter('-7858493257692229655');" onmouseout="out('-7858493257692229655');" style="">1195                  .with(&quot;id&quot;, savedEntity.findProperty(entityForm.getIdProperty()).getValue())                      </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1196                  .done();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1197      }                                                                                                             </span>
<span  style="">1198                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1199      /**                                                                                                           </span>
<span class="-6140462241686685910" onmouseenter="enter('-6140462241686685910');" onmouseout="out('-6140462241686685910');" style=""><abbr title="1200       * Builds out all of the model information needed for showing the add modal for collection items on both the initial GET">1200       * Builds out all of the model information needed for showing the add modal for collection items on both the iðŸ”µ</abbr></span>
<span class="9052968863197617086" onmouseenter="enter('9052968863197617086');" onmouseout="out('9052968863197617086');" style="">1201       * as well as after a POST with validation errors                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1202       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1203       * @param request                                                                                             </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1204       * @param model                                                                                               </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1205       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1206       * @param collectionField                                                                                     </span>
<span class="7403666429378321004" onmouseenter="enter('7403666429378321004');" onmouseout="out('7403666429378321004');" style="">1207       * @param sectionKey                                                                                          </span>
<span class="-7927619294366963435" onmouseenter="enter('-7927619294366963435');" onmouseout="out('-7927619294366963435');" style="">1208       * @param collectionProperty                                                                                  </span>
<span class="-5426566728726502924" onmouseenter="enter('-5426566728726502924');" onmouseout="out('-5426566728726502924');" style="">1209       * @param md                                                                                                  </span>
<span class="4349163197755218506" onmouseenter="enter('4349163197755218506');" onmouseout="out('4349163197755218506');" style="">1210       * @param ppr                                                                                                 </span>
<span class="2094225145376343101" onmouseenter="enter('2094225145376343101');" onmouseout="out('2094225145376343101');" style="">1211       * @return the appropriate view to display for the modal                                                      </span>
<span class="450948407444547835" onmouseenter="enter('450948407444547835');" onmouseout="out('450948407444547835');" style=""><abbr title="1212       * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, EntityForm, BindingResult)}">1212       * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, EntityFðŸ”µ</abbr></span>
<span class="3423849059172457982" onmouseenter="enter('3423849059172457982');" onmouseout="out('3423849059172457982');" style=""><abbr title="1213       * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, MultiValueMap)}">1213       * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, MulðŸ”µ</abbr></span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1214       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1215       */                                                                                                           </span>
<span class="-4127331421111161450" onmouseenter="enter('-4127331421111161450');" onmouseout="out('-4127331421111161450');" style="">1216      protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse response,        </span>
<span class="1808182660955839449" onmouseenter="enter('1808182660955839449');" onmouseout="out('1808182660955839449');" style="">1217              Model model, String id, String collectionField, String sectionKey, Property collectionProperty,       </span>
<span class="-5972908184992702659" onmouseenter="enter('-5972908184992702659');" onmouseout="out('-5972908184992702659');" style=""><abbr title="1218              FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throws ServiceException {">1218              FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throws ServiceEðŸ”µ</abbr></span>
<span  style="">1219                                                                                                                    </span>
<span class="-2054675889041043286" onmouseenter="enter('-2054675889041043286');" onmouseout="out('-2054675889041043286');" style=""><abbr title="1220          // For requests to add a new collection item include the main class that the subsequent request comes from.">1220          // For requests to add a new collection item include the main class that the subsequent request comes fromðŸ”µ</abbr></span>
<span class="7422952884503198827" onmouseenter="enter('7422952884503198827');" onmouseout="out('7422952884503198827');" style=""><abbr title="1221          // For instance, with basic collections we know the main associated class for a fetch through the ForeignKey">1221          // For instance, with basic collections we know the main associated class for a fetch through the ForeignKðŸ”µ</abbr></span>
<span class="5831142982738818001" onmouseenter="enter('5831142982738818001');" onmouseout="out('5831142982738818001');" style="">1222          // persistence item but map and adorned target lookups make a standard persistence request. This solution </span>
<span class="-3910081436214830376" onmouseenter="enter('-3910081436214830376');" onmouseout="out('-3910081436214830376');" style="">1223          // fixes all cases.                                                                                       </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1224          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-8007514226035577536" onmouseenter="enter('-8007514226035577536');" onmouseout="out('-8007514226035577536');" style="">1225          ppr.addCustomCriteria(&quot;owningClass=&quot; + mainClassName);                                                    </span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style="">1226          ppr.setAddOperationInspect(true);                                                                         </span>
<span  style="">1227                                                                                                                    </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1228          if (entityForm != null) {                                                                                 </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1229              entityForm.clearFieldsMap();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1230          }                                                                                                         </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1231          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style="">1232          if (md instanceof BasicCollectionMetadata) {                                                              </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1233              BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                           </span>
<span  style="">1234                                                                                                                    </span>
<span class="5473401195179812518" onmouseenter="enter('5473401195179812518');" onmouseout="out('5473401195179812518');" style="">1235              // When adding items to basic collections, we will sometimes show a form to persist a new record      </span>
<span class="3817220166052180028" onmouseenter="enter('3817220166052180028');" onmouseout="out('3817220166052180028');" style="">1236              // and sometimes show a list grid to allow the user to associate an existing record.                  </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style="">1237              if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                           </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1238                  ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1238                  ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1239                  if (entityForm == null) {                                                                         </span>
<span class="509426350308747164" onmouseenter="enter('509426350308747164');" onmouseout="out('509426350308747164');" style="">1240                      entityForm = formService.createEntityForm(collectionMetadata,sectionCrumbs);                  </span>
<span class="2737056182573571703" onmouseenter="enter('2737056182573571703');" onmouseout="out('2737056182573571703');" style="">1241                      entityForm.setCeilingEntityClassname(ppr.getCeilingEntityClassname());                        </span>
<span class="2710161406345740991" onmouseenter="enter('2710161406345740991');" onmouseout="out('2710161406345740991');" style="">1242                      entityForm.setEntityType(ppr.getCeilingEntityClassname());                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1243                  } else {                                                                                          </span>
<span class="-5799643084244932085" onmouseenter="enter('-5799643084244932085');" onmouseout="out('-5799643084244932085');" style="">1244                      formService.populateEntityForm(collectionMetadata, entityForm, sectionCrumbs);                </span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1245                      formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1246                  }                                                                                                 </span>
<span class="-7315185064917392199" onmouseenter="enter('-7315185064917392199');" onmouseout="out('-7315185064917392199');" style=""><abbr title="1247                  formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntityClassname());">1247                  formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntityClassnamðŸ”µ</abbr></span>
<span class="1687533348183327340" onmouseenter="enter('1687533348183327340');" onmouseout="out('1687533348183327340');" style="">1248                  entityForm.getTabs().iterator().next().getIsVisible();                                            </span>
<span  style="">1249                                                                                                                    </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1250                  model.addAttribute(&quot;entityForm&quot;, entityForm);                                                     </span>
<span class="-2634442257361103125" onmouseenter="enter('-2634442257361103125');" onmouseout="out('-2634442257361103125');" style="">1251                  model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleAddEntity&quot;);                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1252              } else {                                                                                              </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1253                  DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                             </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1254                  ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1254                  ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sðŸ”µ</abbr></span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1255                  listGrid.setPathOverride(request.getRequestURL().toString());                                     </span>
<span  style="">1256                                                                                                                    </span>
<span class="6493773829436488040" onmouseenter="enter('6493773829436488040');" onmouseout="out('6493773829436488040');" style=""><abbr title="1257                  if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUP.equals(fmd.getAddMethodType())) {">1257                  if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUP.equals(fðŸ”µ</abbr></span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1258                      listGrid.removeAllRowActions();                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1259                  }                                                                                                 </span>
<span  style="">1260                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1261                  model.addAttribute(&quot;listGrid&quot;, listGrid);                                                         </span>
<span class="-4615041483574305082" onmouseenter="enter('-4615041483574305082');" onmouseout="out('-4615041483574305082');" style="">1262                  model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleSelectEntity&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1263              }                                                                                                     </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1264          } else if (md instanceof AdornedTargetCollectionMetadata) {                                               </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1265              AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                           </span>
<span  style="">1266                                                                                                                    </span>
<span class="-4994014003685781795" onmouseenter="enter('-4994014003685781795');" onmouseout="out('-4994014003685781795');" style=""><abbr title="1267              // Even though this field represents an adorned target collection, the list we want to show in the modal">1267              // Even though this field represents an adorned target collection, the list we want to show in the modðŸ”µ</abbr></span>
<span class="3396745077097675731" onmouseenter="enter('3396745077097675731');" onmouseout="out('3396745077097675731');" style="">1268              // is the standard list grid for the target entity of this field                                      </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1269              ppr.setOperationTypesOverride(null);                                                                  </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1270              ppr.setType(PersistencePackageRequest.Type.STANDARD);                                                 </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1271              ppr.setSectionEntityField(collectionField);                                                           </span>
<span  style="">1272                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1273              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1273              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span  style="">1274                                                                                                                    </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1275              DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                                 </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1276              ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1276              ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectiðŸ”µ</abbr></span>
<span class="1884537605734649521" onmouseenter="enter('1884537605734649521');" onmouseout="out('1884537605734649521');" style="">1277              listGrid.setSubCollectionFieldName(collectionField);                                                  </span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1278              listGrid.setPathOverride(request.getRequestURL().toString());                                         </span>
<span class="2370419943178688476" onmouseenter="enter('2370419943178688476');" onmouseout="out('2370419943178688476');" style="">1279              listGrid.setFriendlyName(collectionMetadata.getPolymorphicEntities().getFriendlyName());              </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1280              if (entityForm == null) {                                                                             </span>
<span class="-1229292684052118628" onmouseenter="enter('-1229292684052118628');" onmouseout="out('-1229292684052118628');" style=""><abbr title="1281                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, true);">1281                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-7486141420721649683" onmouseenter="enter('-7486141420721649683');" onmouseout="out('-7486141420721649683');" style="">1282                  entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassname());     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1283              } else {                                                                                              </span>
<span class="7685228187033982459" onmouseenter="enter('7685228187033982459');" onmouseout="out('7685228187033982459');" style=""><abbr title="1284                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectionCrumbs, true);">1284                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectionCrumbs, ðŸ”µ</abbr></span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1285                  formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1286              }                                                                                                     </span>
<span  style="">1287                                                                                                                    </span>
<span class="5169338689637413329" onmouseenter="enter('5169338689637413329');" onmouseout="out('5169338689637413329');" style="">1288              listGrid.setListGridType(ListGrid.Type.ADORNED);                                                      </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1289              for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                                </span>
<span class="8450559638200016101" onmouseenter="enter('8450559638200016101');" onmouseout="out('8450559638200016101');" style="">1290                  if (entry.getValue().getIsVisible()) {                                                            </span>
<span class="1657391013588898454" onmouseenter="enter('1657391013588898454');" onmouseout="out('1657391013588898454');" style="">1291                      listGrid.setListGridType(ListGrid.Type.ADORNED_WITH_FORM);                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1292                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1293                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1294              }                                                                                                     </span>
<span  style="">1295                                                                                                                    </span>
<span class="-757286675881477752" onmouseenter="enter('-757286675881477752');" onmouseout="out('-757286675881477752');" style="">1296              // This is part of an add, so we want to be able to filter/sort the listgrid                          </span>
<span class="3421525283764936758" onmouseenter="enter('3421525283764936758');" onmouseout="out('3421525283764936758');" style="">1297              listGrid.setIsSortable(false);                                                                        </span>
<span class="-2714096270635703274" onmouseenter="enter('-2714096270635703274');" onmouseout="out('-2714096270635703274');" style="">1298              listGrid.setCanFilterAndSort(true);                                                                   </span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1299              listGrid.removeAllRowActions();                                                                       </span>
<span  style="">1300                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1301              model.addAttribute(&quot;listGrid&quot;, listGrid);                                                             </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1302              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="-1071174233767081578" onmouseenter="enter('-1071174233767081578');" onmouseout="out('-1071174233767081578');" style="">1303              model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedSelectEntity&quot;);                                          </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1304          } else if (md instanceof MapMetadata) {                                                                   </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1305              MapMetadata fmd = (MapMetadata) md;                                                                   </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1306              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1306              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span  style="">1307                                                                                                                    </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1308              if (entityForm == null) {                                                                             </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style="">1309                  entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1310              } else {                                                                                              </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1311                  formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);         </span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1312                  formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1313              }                                                                                                     </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1314              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="-892500240032703395" onmouseenter="enter('-892500240032703395');" onmouseout="out('-892500240032703395');" style="">1315              model.addAttribute(&quot;viewType&quot;, &quot;modal/mapAddEntity&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1316          }                                                                                                         </span>
<span  style="">1317                                                                                                                    </span>
<span class="6074380392351813368" onmouseenter="enter('6074380392351813368');" onmouseout="out('6074380392351813368');" style="">1318          // Set the parent id on the entity form                                                                   </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1319          if (entityForm != null) {                                                                                 </span>
<span class="-3154229542834445725" onmouseenter="enter('-3154229542834445725');" onmouseout="out('-3154229542834445725');" style="">1320              entityForm.setParentId(id);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1321          }                                                                                                         </span>
<span  style="">1322                                                                                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1323          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="7819166863376485578" onmouseenter="enter('7819166863376485578');" onmouseout="out('7819166863376485578');" style="">1324          model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_COLLECTION_ITEM.getType());                     </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1325          model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                             </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1326          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="">1327          return &quot;modules/modalContainer&quot;;                                                                          </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1328      }                                                                                                             </span>
<span  style="">1329                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1330      /**                                                                                                           </span>
<span class="3915085583429756257" onmouseenter="enter('3915085583429756257');" onmouseout="out('3915085583429756257');" style="">1331       * Shows the appropriate modal dialog to edit the selected collection item                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1332       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1333       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1334       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1335       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1336       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1337       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1338       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1339       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1340       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1341       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1342       */                                                                                                           </span>
<span class="5941881897199209931" onmouseenter="enter('5941881897199209931');" onmouseout="out('5941881897199209931');" style=""><abbr title="1343      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.GET)">1343      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.ðŸ”µ</abbr></span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style="">1344      public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model, </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1345              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1346              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1347              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1348              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1349              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1350          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1350          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1351                  ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1352      }                                                                                                             </span>
<span  style="">1353                                                                                                                    </span>
<span class="-3777402830265989862" onmouseenter="enter('-3777402830265989862');" onmouseout="out('-3777402830265989862');" style="">1354      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.GET)          </span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style="">1355      public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model, </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1356              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1357              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1358              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1359              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="7585768018133278114" onmouseenter="enter('7585768018133278114');" onmouseout="out('7585768018133278114');" style="">1360          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,    </span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1361                  ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1362      }                                                                                                             </span>
<span  style="">1363                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1364      /**                                                                                                           </span>
<span class="6761933478321573145" onmouseenter="enter('6761933478321573145');" onmouseout="out('6761933478321573145');" style=""><abbr title="1365       * Shows the appropriate modal dialog to view the selected collection item. This will display the modal as readonly">1365       * Shows the appropriate modal dialog to view the selected collection item. This will display the modal as reaðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1366       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1367       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1368       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1369       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1370       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1371       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1372       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1373       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1374       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1375       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1376       */                                                                                                           </span>
<span class="5228464490364608791" onmouseenter="enter('5228464490364608791');" onmouseout="out('5228464490364608791');" style=""><abbr title="1377      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = RequestMethod.GET)">1377      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = RequestMeðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style="">1378      public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1379              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1380              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1381              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1382              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1383              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="7887850161668822106" onmouseenter="enter('7887850161668822106');" onmouseout="out('7887850161668822106');" style=""><abbr title="1384          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1384          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1385                  ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                                  </span>
<span  style="">1386                                                                                                                    </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1387          // Since this is a read-only view, actions don&#x27;t make sense in this context                               </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1388          EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                             </span>
<span class="7289613241506142720" onmouseenter="enter('7289613241506142720');" onmouseout="out('7289613241506142720');" style="">1389          addAuditableDisplayFields(ef);                                                                            </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1390          ef.removeAllActions();                                                                                    </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1391          ef.setReadOnly();                                                                                         </span>
<span  style="">1392                                                                                                                    </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1393          return returnPath;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1394      }                                                                                                             </span>
<span  style="">1395                                                                                                                    </span>
<span class="6858008221927215769" onmouseenter="enter('6858008221927215769');" onmouseout="out('6858008221927215769');" style="">1396      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.GET)     </span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style="">1397      public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1398              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1399              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1400              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1401              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="2521791674908842244" onmouseenter="enter('2521791674908842244');" onmouseout="out('2521791674908842244');" style=""><abbr title="1402          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1402          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1403                  ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                                  </span>
<span  style="">1404                                                                                                                    </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1405          // Since this is a read-only view, actions don&#x27;t make sense in this context                               </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1406          EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                             </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1407          ef.removeAllActions();                                                                                    </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1408          ef.setReadOnly();                                                                                         </span>
<span  style="">1409                                                                                                                    </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1410          return returnPath;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1411      }                                                                                                             </span>
<span  style="">1412                                                                                                                    </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1413      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1413      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="6852009337058352330" onmouseenter="enter('6852009337058352330');" onmouseout="out('6852009337058352330');" style=""><abbr title="1414              String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType) throws ServiceException {">1414              String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderTypeðŸ”µ</abbr></span>
<span class="-2699953653458232908" onmouseenter="enter('-2699953653458232908');" onmouseout="out('-2699953653458232908');" style=""><abbr title="1415          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId, modalHeaderType, null, null);">1415          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1416      }                                                                                                             </span>
<span  style="">1417                                                                                                                    </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1418      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1418      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="-3706011950121400951" onmouseenter="enter('-3706011950121400951');" onmouseout="out('-3706011950121400951');" style=""><abbr title="1419              String id, String collectionField, String collectionItemId, String modalHeaderType) throws ServiceException {">1419              String id, String collectionField, String collectionItemId, String modalHeaderType) throws ServiceExceðŸ”µ</abbr></span>
<span class="-6899013896128397577" onmouseenter="enter('-6899013896128397577');" onmouseout="out('-6899013896128397577');" style=""><abbr title="1420          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, null, null);">1420          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1421      }                                                                                                             </span>
<span  style="">1422                                                                                                                    </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1423      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1423      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="4852573692087282601" onmouseenter="enter('4852573692087282601');" onmouseout="out('4852573692087282601');" style=""><abbr title="1424                  String id, String collectionField, String collectionItemId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1424                  String id, String collectionField, String collectionItemId, String modalHeaderType, EntityForm entðŸ”µ</abbr></span>
<span class="6580107021722154279" onmouseenter="enter('6580107021722154279');" onmouseout="out('6580107021722154279');" style=""><abbr title="1425          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, entityForm, entity);">1425          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1426      }                                                                                                             </span>
<span  style="">1427                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1428      /**                                                                                                           </span>
<span class="837861132196545598" onmouseenter="enter('837861132196545598');" onmouseout="out('837861132196545598');" style=""><abbr title="1429       * Shows the view and populates the model for updating a collection item. You can also pass in an entityform and entity">1429       * Shows the view and populates the model for updating a collection item. You can also pass in an entityform aðŸ”µ</abbr></span>
<span class="5643306329084644224" onmouseenter="enter('5643306329084644224');" onmouseout="out('5643306329084644224');" style="">1430       * which are optional. If they are not passed in then they are automatically looked up                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1431       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1432       * @param request                                                                                             </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1433       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1434       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1435       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1436       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1437       * @param collectionItemId                                                                                    </span>
<span class="-5929844173285242940" onmouseenter="enter('-5929844173285242940');" onmouseout="out('-5929844173285242940');" style="">1438       * @param modalHeaderType                                                                                     </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1439       * @param entityForm                                                                                          </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style="">1440       * @param entity                                                                                              </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">1441       * @return                                                                                                    </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1442       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1443       */                                                                                                           </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1444      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1444      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="-7524579279249503431" onmouseenter="enter('-7524579279249503431');" onmouseout="out('-7524579279249503431');" style=""><abbr title="1445              String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1445              String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderTypeðŸ”µ</abbr></span>










<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1446          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1447          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1448          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1449          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1449          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1450          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1451          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span class="-2889762407992276786" onmouseenter="enter('-2889762407992276786');" onmouseout="out('-2889762407992276786');" style="">1452          SectionCrumb nextCrumb = new SectionCrumb();                                                              </span>
<span class="4180533444018328805" onmouseenter="enter('4180533444018328805');" onmouseout="out('4180533444018328805');" style="">1453          if (md instanceof MapMetadata) {                                                                          </span>
<span class="-382349485821163458" onmouseenter="enter('-382349485821163458');" onmouseout="out('-382349485821163458');" style="">1454              nextCrumb.setSectionIdentifier(((MapMetadata) md).getValueClassName());                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1455          } else {                                                                                                  </span>
<span class="1919475910220989527" onmouseenter="enter('1919475910220989527');" onmouseout="out('1919475910220989527');" style="">1456              nextCrumb.setSectionIdentifier(((CollectionMetadata) md).getCollectionCeilingEntity());               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1457          }                                                                                                         </span>
<span class="3745082800889494172" onmouseenter="enter('3745082800889494172');" onmouseout="out('3745082800889494172');" style="">1458          nextCrumb.setSectionId(collectionItemId);                                                                 </span>
<span class="7047611651117816234" onmouseenter="enter('7047611651117816234');" onmouseout="out('7047611651117816234');" style="">1459          if (!sectionCrumbs.contains(nextCrumb)) {                                                                 </span>
<span class="-6316688126111539901" onmouseenter="enter('-6316688126111539901');" onmouseout="out('-6316688126111539901');" style="">1460              sectionCrumbs.add(nextCrumb);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1461          }                                                                                                         </span>
<span  style="">1462                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1463          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1463          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1464          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1464          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0ðŸ”µ</abbr></span>
<span  style="">1465                                                                                                                    </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1466          ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                          </span>
<span  style="">1467                                                                                                                    </span>
<span class="4300500518149699432" onmouseenter="enter('4300500518149699432');" onmouseout="out('4300500518149699432');" style="">1468          if (md instanceof BasicCollectionMetadata &amp;&amp;                                                              </span>
<span class="3179311364823579995" onmouseenter="enter('3179311364823579995');" onmouseout="out('3179311364823579995');" style="">1469                  (((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST) ||               </span>
<span class="-5057368181444983975" onmouseenter="enter('-5057368181444983975');" onmouseout="out('-5057368181444983975');" style="">1470                          ((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST_EMPTY))) { </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1471              BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                           </span>
<span  style="">1472                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1473              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1473              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1474              if (entity == null) {                                                                                 </span>
<span class="4597721164047448054" onmouseenter="enter('4597721164047448054');" onmouseout="out('4597721164047448054');" style=""><abbr title="1475                  entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResultSet().getRecords()[0];">1475                  entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResultSet().ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1476              }                                                                                                     </span>
<span  style="">1477                                                                                                                    </span>
<span class="-7942197356638317765" onmouseenter="enter('-7942197356638317765');" onmouseout="out('-7942197356638317765');" style="">1478              String currentTabName = getCurrentTabName(pathVars, collectionMetadata);                              </span>
<span class="9017537031938626444" onmouseenter="enter('9017537031938626444');" onmouseout="out('9017537031938626444');" style=""><abbr title="1479              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetadata, entity, sectionCrumbs, currentTabName);">1479              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetadata, entðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1480              if (entityForm == null) {                                                                             </span>
<span class="-3582618966464933757" onmouseenter="enter('-3582618966464933757');" onmouseout="out('-3582618966464933757');" style=""><abbr title="1481                  entityForm = formService.createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbs);">1481                  entityForm = formService.createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbsðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1482              } else {                                                                                              </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1483                  entityForm.clearFieldsMap();                                                                      </span>
<span class="1859879359946483810" onmouseenter="enter('1859879359946483810');" onmouseout="out('1859879359946483810');" style=""><abbr title="1484                  formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm, sectionCrumbs);">1484                  formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm, sectionCrumbðŸ”µ</abbr></span>
<span class="5496760487980360743" onmouseenter="enter('5496760487980360743');" onmouseout="out('5496760487980360743');" style="">1485                  //remove all the actions since we&#x27;re not trying to redisplay them on the form                     </span>
<span class="-6469844840195102556" onmouseenter="enter('-6469844840195102556');" onmouseout="out('-6469844840195102556');" style="">1486                  entityForm.removeAllActions();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1487              }                                                                                                     </span>




<span class="-3892497188964586657" onmouseenter="enter('-3892497188964586657');" onmouseout="out('-3892497188964586657');" style="">1488              entityForm.removeAction(DefaultEntityFormActions.DELETE);                                             </span>


<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1489              addAuditableDisplayFields(entityForm);                                                                </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1490              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="2070483683171714322" onmouseenter="enter('2070483683171714322');" onmouseout="out('2070483683171714322');" style="">1491              model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleEditEntity&quot;);                                             </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1492          } else if (md instanceof AdornedTargetCollectionMetadata) {                                               </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1493              AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                           </span>
<span  style="">1494                                                                                                                    </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1495              if (entity == null) {                                                                                 </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style="">1496                  entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,      </span>
<span class="-2961516840614790290" onmouseenter="enter('-2961516840614790290');" onmouseout="out('-2961516840614790290');" style="">1497                      collectionItemId, sectionCrumbs, alternateId).getDynamicResultSet().getRecords()[0];          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1498              }                                                                                                     </span>
<span  style="">1499                                                                                                                    </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1500              boolean populateTypeAndId = true;                                                                     </span>
<span class="921756716374353809" onmouseenter="enter('921756716374353809');" onmouseout="out('921756716374353809');" style="">1501              boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaderType);</span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1502              if (entityForm == null) {                                                                             </span>
<span class="-8902040329002931298" onmouseenter="enter('-8902040329002931298');" onmouseout="out('-8902040329002931298');" style=""><abbr title="1503                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, sectionCrumbs, false);">1503                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem,ðŸ”µ</abbr></span>
<span class="-4655192855930300298" onmouseenter="enter('-4655192855930300298');" onmouseout="out('-4655192855930300298');" style="">1504                  entityForm.removeAction(DefaultAdornedEntityFormActions.Add);                                     </span>
<span class="1109271490036416226" onmouseenter="enter('1109271490036416226');" onmouseout="out('1109271490036416226');" style="">1505                  entityForm.addAction(DefaultAdornedEntityFormActions.Save);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1506              } else {                                                                                              </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1507                  entityForm.clearFieldsMap();                                                                      </span>
<span class="2583214667713512490" onmouseenter="enter('2583214667713512490');" onmouseout="out('2583214667713512490');" style="">1508                  String entityType = entityForm.getEntityType();                                                   </span>
<span class="-6584758178229470245" onmouseenter="enter('-6584758178229470245');" onmouseout="out('-6584758178229470245');" style=""><abbr title="1509                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entityForm, sectionCrumbs, false);">1509                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entityForm, ðŸ”µ</abbr></span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style="">1510                  entityForm.setEntityType(entityType);                                                             </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1511                  populateTypeAndId = false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1512              }                                                                                                     </span>
<span  style="">1513                                                                                                                    </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1514              Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                    </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title="1515              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,">1515              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassNaðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style="">1516                      collectionField,                                                                              </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style="">1517                      collectionItemId, responseMap);                                                               </span>
<span  style="">1518                                                                                                                    </span>
<span class="-3972135447881278836" onmouseenter="enter('-3972135447881278836');" onmouseout="out('-3972135447881278836');" style=""><abbr title="1519              //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and Id is used.">1519              //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and Id is useðŸ”µ</abbr></span>
<span class="-8007896595560301001" onmouseenter="enter('-8007896595560301001');" onmouseout="out('-8007896595560301001');" style="">1520              //It should be the entity and referenced Id of the adorned entity (not the target entity and Id).     </span>
<span class="316997016312344867" onmouseenter="enter('316997016312344867');" onmouseout="out('316997016312344867');" style="">1521              entityForm.setTranslationCeilingEntity(entityForm.getEntityType());                                   </span>
<span class="-4512360180775881719" onmouseenter="enter('-4512360180775881719');" onmouseout="out('-4512360180775881719');" style="">1522              entityForm.setTranslationId(alternateId);                                                             </span>
<span  style="">1523                                                                                                                    </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style="">1524              ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();           </span>
<span class="-1465905251928147670" onmouseenter="enter('-1465905251928147670');" onmouseout="out('-1465905251928147670');" style="">1525              for (String field : fmd.getMaintainedAdornedTargetFields()) {                                         </span>
<span class="-2821179418575098708" onmouseenter="enter('-2821179418575098708');" onmouseout="out('-2821179418575098708');" style="">1526                  if (responseMap.containsKey(field) &amp;&amp; responseMap.containsKey(&quot;autoSubmit&quot;)) {                    </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1527                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1528                  }                                                                                                 </span>
<span class="-3390991397790942785" onmouseenter="enter('-3390991397790942785');" onmouseout="out('-3390991397790942785');" style="">1529                  Property p = cmd.getPMap().get(field);                                                            </span>
<span class="3110636146594998978" onmouseenter="enter('3110636146594998978');" onmouseout="out('3110636146594998978');" style="">1530                  if (p != null &amp;&amp; p.getMetadata() instanceof AdornedTargetCollectionMetadata) {                    </span>
<span class="-1526293730221303684" onmouseenter="enter('-1526293730221303684');" onmouseout="out('-1526293730221303684');" style=""><abbr title="1531                      // Because we&#x27;re dealing with a nested adorned target collection, this particular request must act">1531                      // Because we&#x27;re dealing with a nested adorned target collection, this particular request mustðŸ”µ</abbr></span>
<span class="5008429970050276114" onmouseenter="enter('5008429970050276114');" onmouseout="out('5008429970050276114');" style=""><abbr title="1532                      // directly on the first adorned target collection. Because of this, we need the actual id property">1532                      // directly on the first adorned target collection. Because of this, we need the actual id proðŸ”µ</abbr></span>
<span class="-7713892716328274330" onmouseenter="enter('-7713892716328274330');" onmouseout="out('-7713892716328274330');" style=""><abbr title="1533                      // from the entity that models the adorned target relationship, and not the id of the target object.">1533                      // from the entity that models the adorned target relationship, and not the id of the target oðŸ”µ</abbr></span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1534                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1534                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style="">1535                      DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,      </span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1536                              alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();                 </span>
<span  style="">1537                                                                                                                    </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1538                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1538                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, pðŸ”µ</abbr></span>
<span class="-6504403122086949696" onmouseenter="enter('-6504403122086949696');" onmouseout="out('-6504403122086949696');" style="">1539                              ppr.getAdornedList().getAdornedTargetEntityClassname(), sectionCrumbs);               </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1540                      listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                                 </span>
<span  style="">1541                                                                                                                    </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1542                      if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {                </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1543                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1543                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1544                      } else {                                                                                      </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1545                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1545                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1546                      }                                                                                             </span>
<span class="2712626054905490038" onmouseenter="enter('2712626054905490038');" onmouseout="out('2712626054905490038');" style="">1547                  } else if (p != null &amp;&amp; p.getMetadata() instanceof MapMetadata) {                                 </span>
<span class="-388196981394792667" onmouseenter="enter('-388196981394792667');" onmouseout="out('-388196981394792667');" style="">1548                      // See above comment for AdornedTargetCollectionMetadata                                      </span>
<span class="-9194902891343883685" onmouseenter="enter('-9194902891343883685');" onmouseout="out('-9194902891343883685');" style="">1549                      MapMetadata mmd = (MapMetadata) p.getMetadata();                                              </span>
<span  style="">1550                                                                                                                    </span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1551                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1551                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style="">1552                      DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,      </span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1553                              alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();                 </span>
<span  style="">1554                                                                                                                    </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1555                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1555                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, pðŸ”µ</abbr></span>
<span class="-6515044965274807025" onmouseenter="enter('-6515044965274807025');" onmouseout="out('-6515044965274807025');" style="">1556                              mmd.getTargetClass(), sectionCrumbs);                                                 </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1557                      listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                                 </span>
<span  style="">1558                                                                                                                    </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1559                      if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {                </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1560                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1560                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1561                      } else {                                                                                      </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1562                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1562                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1563                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1564                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1565              }                                                                                                     </span>
<span  style="">1566                                                                                                                    </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style="">1567              formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);       </span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1568              formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());                </span>
<span  style="">1569                                                                                                                    </span>
<span class="7046829326366784672" onmouseenter="enter('7046829326366784672');" onmouseout="out('7046829326366784672');" style="">1570              boolean atLeastOneBasicField = false;                                                                 </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1571              for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                                </span>
<span class="-3942382004211496115" onmouseenter="enter('-3942382004211496115');" onmouseout="out('-3942382004211496115');" style=""><abbr title="1572                  if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName()) &amp;&amp; !responseMap.containsKey(&quot;autoSubmit&quot;)) {">1572                  if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName()) &amp;&amp; !reðŸ”µ</abbr></span>
<span class="3115307772764059490" onmouseenter="enter('3115307772764059490');" onmouseout="out('3115307772764059490');" style="">1573                      atLeastOneBasicField = true;                                                                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1574                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1575                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1576              }                                                                                                     </span>
<span class="4813170790944841786" onmouseenter="enter('4813170790944841786');" onmouseout="out('4813170790944841786');" style="">1577              if (!atLeastOneBasicField) {                                                                          </span>
<span class="3364274495995556597" onmouseenter="enter('3364274495995556597');" onmouseout="out('3364274495995556597');" style="">1578                  entityForm.removeAction(DefaultEntityFormActions.SAVE);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1579              }                                                                                                     </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1580              addAuditableDisplayFields(entityForm);                                                                </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1581              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="3009851293217081678" onmouseenter="enter('3009851293217081678');" onmouseout="out('3009851293217081678');" style="">1582              model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedEditEntity&quot;);                                            </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1583          } else if (md instanceof MapMetadata) {                                                                   </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1584              MapMetadata fmd = (MapMetadata) md;                                                                   </span>
<span  style="">1585                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1586              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1586              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1587              if (entity == null) {                                                                                 </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style="">1588                  entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,      </span>
<span class="-2813813427236819301" onmouseenter="enter('-2813813427236819301');" onmouseout="out('-2813813427236819301');" style="">1589                      collectionItemId, sectionCrumbs, null).getEntity();                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1590              }                                                                                                     </span>
<span  style="">1591                                                                                                                    </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1592              boolean populateTypeAndId = true;                                                                     </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1593              if (entityForm == null) {                                                                             </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style="">1594                  entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1595              } else {                                                                                              </span>
<span class="-2965751497501930249" onmouseenter="enter('-2965751497501930249');" onmouseout="out('-2965751497501930249');" style="">1596                  //save off the prior key before clearing out the fields map as it will not appear                 </span>
<span class="-4459883460939835415" onmouseenter="enter('-4459883460939835415');" onmouseout="out('-4459883460939835415');" style="">1597                  //back on the saved entity                                                                        </span>
<span class="-8617997777962995342" onmouseenter="enter('-8617997777962995342');" onmouseout="out('-8617997777962995342');" style="">1598                  String priorKey = entityForm.findField(&quot;priorKey&quot;).getValue();                                    </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1599                  entityForm.clearFieldsMap();                                                                      </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1600                  formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);         </span>
<span class="-5674534809018144237" onmouseenter="enter('-5674534809018144237');" onmouseout="out('-5674534809018144237');" style="">1601                  entityForm.findField(&quot;priorKey&quot;).setValue(priorKey);                                              </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1602                  populateTypeAndId = false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1603              }                                                                                                     </span>
<span  style="">1604                                                                                                                    </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style="">1605              formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);       </span>
<span class="-7934209705949108459" onmouseenter="enter('-7934209705949108459');" onmouseout="out('-7934209705949108459');" style="">1606              formService.populateMapEntityFormFields(entityForm, entity);                                          </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1607              addAuditableDisplayFields(entityForm);                                                                </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1608              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="5184741693677662709" onmouseenter="enter('5184741693677662709');" onmouseout="out('5184741693677662709');" style="">1609              model.addAttribute(&quot;viewType&quot;, &quot;modal/mapEditEntity&quot;);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1610          }                                                                                                         </span>
<span  style="">1611                                                                                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1612          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="5715532112666019496" onmouseenter="enter('5715532112666019496');" onmouseout="out('5715532112666019496');" style="">1613          model.addAttribute(&quot;modalHeaderType&quot;, modalHeaderType);                                                   </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1614          model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                             </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1615          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="">1616          return &quot;modules/modalContainer&quot;;                                                                          </span>




















<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1617      }                                                                                                             </span>
<span  style="">1618                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1619      /**                                                                                                           </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1620       * Updates the specified collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1621       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1622       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1623       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1624       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1625       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1626       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1627       * @param collectionField                                                                                     </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1628       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1628       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this isðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1629       * @param entityForm                                                                                          </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1630       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1631       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1632       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1633       */                                                                                                           </span>
<span class="1690395709289479208" onmouseenter="enter('1690395709289479208');" onmouseout="out('1690395709289479208');" style="">1634      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.POST)         </span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style="">1635      public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1636              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1637              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1638              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1639              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1640              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                            </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1641              BindingResult result) throws Exception {                                                              </span>
<span class="454845068344591329" onmouseenter="enter('454845068344591329');" onmouseout="out('454845068344591329');" style=""><abbr title="1642          return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, entityForm, null, result);">1642          return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, entðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1643      }                                                                                                             </span>
<span  style="">1644                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1645      /**                                                                                                           </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1646       * Updates the specified collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1647       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1648       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1649       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1650       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1651       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1652       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1653       * @param collectionField                                                                                     </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1654       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1654       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this isðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1655       * @param entityForm                                                                                          </span>
<span class="4031667150854181086" onmouseenter="enter('4031667150854181086');" onmouseout="out('4031667150854181086');" style=""><abbr title="1656       * @param alternateId in the case of adorned target collections, this is the primary key value of the collection member">1656       * @param alternateId in the case of adorned target collections, this is the primary key value of the collectiðŸ”µ</abbr></span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1657       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1658       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1659       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1660       */                                                                                                           </span>
<span class="6716233350399381715" onmouseenter="enter('6716233350399381715');" onmouseout="out('6716233350399381715');" style=""><abbr title="1661      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.POST)">1661      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.ðŸ”µ</abbr></span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style="">1662      public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1663              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1664              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1665              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1666              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1667              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                            </span>
<span class="-5366992345424767315" onmouseenter="enter('-5366992345424767315');" onmouseout="out('-5366992345424767315');" style="">1668              @PathVariable(value=&quot;alternateId&quot;) String alternateId,                                                </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1669              BindingResult result) throws Exception {                                                              </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1670          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1671          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1672          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1673          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1673          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1674          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1675                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1676          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1676          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1677          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">1678                                                                                                                    </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1679          // First, we must save the collection entity                                                              </span>
<span class="3262117580653454816" onmouseenter="enter('3262117580653454816');" onmouseout="out('3262117580653454816');" style=""><abbr title="1680          PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, collectionItemId, alternateId, sectionCrumbs);">1680          PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1681          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1682          entityFormValidator.validate(entityForm, savedEntity, result);                                            </span>
<span  style="">1683                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1684          if (result.hasErrors()) {                                                                                 </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1685              return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1685              return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alterðŸ”µ</abbr></span>
<span class="-1009973048758571460" onmouseenter="enter('-1009973048758571460');" onmouseout="out('-1009973048758571460');" style="">1686                      ModalHeaderType.UPDATE_COLLECTION_ITEM.getType(), entityForm, savedEntity);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1687          }                                                                                                         </span>
<span  style="">1688                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1689          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1690          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1691          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1691          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persðŸ”µ</abbr></span>
<span  style="">1692                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1693          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1694          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1695          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1696          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1697      }                                                                                                             </span>
<span  style="">1698                                                                                                                    </span>
<span class="-2715204734461845190" onmouseenter="enter('-2715204734461845190');" onmouseout="out('-2715204734461845190');" style="">1699      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMethod.POST)</span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1700      public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,             </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1701              HttpServletResponse response, Model model,                                                            </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1702              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1703              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1704              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1705              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="6458961487045284345" onmouseenter="enter('6458961487045284345');" onmouseout="out('6458961487045284345');" style="">1706              @RequestParam(value=&quot;newSequence&quot;) String newSequence) throws Exception {                             </span>
<span class="-6477101312884008952" onmouseenter="enter('-6477101312884008952');" onmouseout="out('-6477101312884008952');" style=""><abbr title="1707          return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collectionItemId, newSequence, null);">1707          return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collectionIteðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1708      }                                                                                                             </span>
<span  style="">1709                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1710      /**                                                                                                           </span>
<span class="-7447609122613552365" onmouseenter="enter('-7447609122613552365');" onmouseout="out('-7447609122613552365');" style="">1711       * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target collections </span>
<span class="5163972519999742424" onmouseenter="enter('5163972519999742424');" onmouseout="out('5163972519999742424');" style="">1712       * where a sort field is specified -- any other invocation is incorrect and will result in an exception.      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1713       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1714       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1715       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1716       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1717       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1718       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1719       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1720       * @param collectionItemId                                                                                    </span>
<span class="8542418631474543845" onmouseenter="enter('8542418631474543845');" onmouseout="out('8542418631474543845');" style="">1721       * @return an object explaining the state of the operation                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1722       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1723       */                                                                                                           </span>
<span class="1279723180837283801" onmouseenter="enter('1279723180837283801');" onmouseout="out('1279723180837283801');" style=""><abbr title="1724      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, method = RequestMethod.POST)">1724      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1725      public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,             </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1726              HttpServletResponse response, Model model,                                                            </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1727              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1728              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1729              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1730              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="6744719432735700494" onmouseenter="enter('6744719432735700494');" onmouseout="out('6744719432735700494');" style="">1731              @RequestParam(value=&quot;newSequence&quot;) String newSequence,                                                </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1732              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1733          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1734          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1735          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1736          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1736          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1737          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1738          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style="">1739                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1740          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1740          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="6971869165316675737" onmouseenter="enter('6971869165316675737');" onmouseout="out('6971869165316675737');" style="">1741          ppr.addCustomCriteria(&quot;reorderParentEntityFetch&quot;);                                                        </span>
<span  style="">1742                                                                                                                    </span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1743          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1743          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0ðŸ”µ</abbr></span>
<span  style="">1744                                                                                                                    </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1745          ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                          </span>
<span  style="">1746                                                                                                                    </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1747          if (md instanceof AdornedTargetCollectionMetadata) {                                                      </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1748              AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                           </span>
<span class="-895931586936599512" onmouseenter="enter('-895931586936599512');" onmouseout="out('-895931586936599512');" style="">1749              AdornedTargetList atl = ppr.getAdornedList();                                                         </span>
<span  style="">1750                                                                                                                    </span>
<span class="4013888246220668443" onmouseenter="enter('4013888246220668443');" onmouseout="out('4013888246220668443');" style="">1751              // Get an entity form for the entity                                                                  </span>
<span class="4144133685169635892" onmouseenter="enter('4144133685169635892');" onmouseout="out('4144133685169635892');" style=""><abbr title="1752              EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, false);">1752              EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionðŸ”µ</abbr></span>
<span class="985151044669117950" onmouseenter="enter('985151044669117950');" onmouseout="out('985151044669117950');" style="">1753              Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,   </span>
<span class="-4422231398086337832" onmouseenter="enter('-4422231398086337832');" onmouseout="out('-4422231398086337832');" style="">1754                      collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;})        </span>
<span class="-7850695853310911802" onmouseenter="enter('-7850695853310911802');" onmouseout="out('-7850695853310911802');" style="">1755                      .getDynamicResultSet().getRecords()[0];                                                       </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1756              formService.populateEntityFormFields(entityForm, entity);                                             </span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1757              formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());                </span>
<span  style="">1758                                                                                                                    </span>
<span class="-3124065187694573478" onmouseenter="enter('-3124065187694573478');" onmouseout="out('-3124065187694573478');" style=""><abbr title="1759              // Set the new sequence (note that it will come in 0-indexed but the persistence module expects 1-indexed)">1759              // Set the new sequence (note that it will come in 0-indexed but the persistence module expects 1-indeðŸ”µ</abbr></span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1760              int sequenceValue = Integer.parseInt(newSequence) + 1;                                                </span>
<span class="2556919505341751863" onmouseenter="enter('2556919505341751863');" onmouseout="out('2556919505341751863');" style="">1761              Field field = entityForm.findField(atl.getSortField());                                               </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1762              field.setValue(String.valueOf(sequenceValue));                                                        </span>
<span  style="">1763                                                                                                                    </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1764              Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                    </span>
<span class="-5669538829732150992" onmouseenter="enter('-5669538829732150992');" onmouseout="out('-5669538829732150992');" style=""><abbr title="1765              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, alternateId, sectionCrumbs);">1765              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, ðŸ”µ</abbr></span>
<span class="-6209319883391535282" onmouseenter="enter('-6209319883391535282');" onmouseout="out('-6209319883391535282');" style="">1766              Property displayOrder = persistenceResponse.getEntity().findProperty(atl.getSortField());             </span>
<span  style="">1767                                                                                                                    </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1768              responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                                      </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1769              responseMap.put(&quot;field&quot;, collectionField);                                                            </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1770              responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());            </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1771              return responseMap;                                                                                   </span>
<span class="-3117865694677500361" onmouseenter="enter('-3117865694677500361');" onmouseout="out('-3117865694677500361');" style="">1772          } else if (md instanceof BasicCollectionMetadata) {                                                       </span>
<span class="-8492572584837651214" onmouseenter="enter('-8492572584837651214');" onmouseout="out('-8492572584837651214');" style="">1773              BasicCollectionMetadata cd = (BasicCollectionMetadata) md;                                            </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1774              Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                    </span>
<span class="-2546552603594507996" onmouseenter="enter('-2546552603594507996');" onmouseout="out('-2546552603594507996');" style=""><abbr title="1775              Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1775              Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResultSet().geðŸ”µ</abbr></span>
<span  style="">1776                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1777              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1777              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span class="-2818097934143266938" onmouseenter="enter('-2818097934143266938');" onmouseout="out('-2818097934143266938');" style="">1778              EntityForm entityForm = formService.createEntityForm(collectionMetadata, sectionCrumbs);              </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1779              if (!StringUtils.isEmpty(cd.getSortProperty())) {                                                     </span>
<span class="-6303462610985739492" onmouseenter="enter('-6303462610985739492');" onmouseout="out('-6303462610985739492');" style="">1780                  Field f = new Field()                                                                             </span>
<span class="-2538063021289876061" onmouseenter="enter('-2538063021289876061');" onmouseout="out('-2538063021289876061');" style="">1781                          .withName(cd.getSortProperty())                                                           </span>
<span class="-2458072313875538806" onmouseenter="enter('-2458072313875538806');" onmouseout="out('-2458072313875538806');" style="">1782                          .withFieldType(SupportedFieldType.HIDDEN.toString());                                     </span>
<span class="5054103958554301667" onmouseenter="enter('5054103958554301667');" onmouseout="out('5054103958554301667');" style="">1783                  entityForm.addHiddenField(mainMetadata, f);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1784              }                                                                                                     </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1785              formService.populateEntityFormFields(entityForm, entity);                                             </span>
<span  style="">1786                                                                                                                    </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1787              if (!StringUtils.isEmpty(cd.getSortProperty())) {                                                     </span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1788                  int sequenceValue = Integer.parseInt(newSequence) + 1;                                            </span>
<span class="-3733495482183042291" onmouseenter="enter('-3733495482183042291');" onmouseout="out('-3733495482183042291');" style="">1789                  Field field = entityForm.findField(cd.getSortProperty());                                         </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1790                  field.setValue(String.valueOf(sequenceValue));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1791              }                                                                                                     </span>
<span  style="">1792                                                                                                                    </span>
<span class="3923458830762383909" onmouseenter="enter('3923458830762383909');" onmouseout="out('3923458830762383909');" style=""><abbr title="1793              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, sectionCrumbs);">1793              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, ðŸ”µ</abbr></span>
<span class="-792608105002716351" onmouseenter="enter('-792608105002716351');" onmouseout="out('-792608105002716351');" style="">1794              Property displayOrder = persistenceResponse.getEntity().findProperty(cd.getSortProperty());           </span>
<span  style="">1795                                                                                                                    </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1796              responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                                      </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1797              responseMap.put(&quot;field&quot;, collectionField);                                                            </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1798              responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());            </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1799              return responseMap;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1800          } else {                                                                                                  </span>
<span class="7542199431919878786" onmouseenter="enter('7542199431919878786');" onmouseout="out('7542199431919878786');" style=""><abbr title="1801              throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collection fields.&quot;);">1801              throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collection fiðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1802          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1803      }                                                                                                             </span>
<span  style="">1804                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1805      /**                                                                                                           </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1806       * Removes the requested collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1807       *                                                                                                            </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1808       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1808       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item froðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1809       * map collection.                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1810       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1811       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1812       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1813       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1814       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1815       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1816       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1817       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1818       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1819       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1820       */                                                                                                           </span>
<span class="6340503715634976611" onmouseenter="enter('6340503715634976611');" onmouseout="out('6340503715634976611');" style="">1821      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethod.POST)  </span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style="">1822      public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1823              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1824              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1825              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1826              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="6845453766150325497" onmouseenter="enter('6845453766150325497');" onmouseout="out('6845453766150325497');" style=""><abbr title="1827          return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, null);">1827          return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, nulðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1828      }                                                                                                             </span>
<span  style="">1829                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1830      /**                                                                                                           </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">1831       * Removes the requested collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1832       *                                                                                                            </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="1833       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">1833       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item froðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">1834       * map collection.                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1835       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1836       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1837       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1838       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1839       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1840       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1841       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1842       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1843       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1844       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1845       */                                                                                                           </span>
<span class="-4053134536146029119" onmouseenter="enter('-4053134536146029119');" onmouseout="out('-4053134536146029119');" style=""><abbr title="1846      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method = RequestMethod.POST)">1846      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method = RequestðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style="">1847      public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1848              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1849              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1850              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1851              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1852              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1853          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1854          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1855          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1856          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1856          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1857          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1858                                                                                                                    </span>
<span class="-6408221600487262974" onmouseenter="enter('-6408221600487262974');" onmouseout="out('-6408221600487262974');" style="">1859          String priorKey = request.getParameter(&quot;key&quot;);                                                            </span>
<span  style="">1860                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1861          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1861          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1862          declareShouldIgnoreAdditionStatusFilter();                                                                </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1863          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">1864                                                                                                                    </span>
<span class="8107528363762278945" onmouseenter="enter('8107528363762278945');" onmouseout="out('8107528363762278945');" style="">1865          // First, we must remove the collection entity                                                            </span>
<span class="-8185015406879465962" onmouseenter="enter('-8185015406879465962');" onmouseout="out('-8185015406879465962');" style=""><abbr title="1866          PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectionProperty, entity, collectionItemId, alternateId, priorKey, sectionCrumbs);">1866          PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectionProperðŸ”µ</abbr></span>
<span class="4740780245520344929" onmouseenter="enter('4740780245520344929');" onmouseout="out('4740780245520344929');" style="">1867          if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailure()) {   </span>
<span class="-1907173364280213129" onmouseenter="enter('-1907173364280213129');" onmouseout="out('-1907173364280213129');" style="">1868              String error = &quot;There was an error removing the whatever&quot;;                                            </span>
<span class="6694909055776458558" onmouseenter="enter('6694909055776458558');" onmouseout="out('6694909055776458558');" style="">1869              if (MapUtils.isNotEmpty(persistenceResponse.getEntity().getPropertyValidationErrors())) {             </span>
<span class="2653002805011151778" onmouseenter="enter('2653002805011151778');" onmouseout="out('2653002805011151778');" style="">1870                  // If we failed, we&#x27;ll return some JSON with the first error                                      </span>
<span class="6101527636004026445" onmouseenter="enter('6101527636004026445');" onmouseout="out('6101527636004026445');" style=""><abbr title="1871                  error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator().next().get(0);">1871                  error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator().next().gðŸ”µ</abbr></span>
<span class="3589903040125146199" onmouseenter="enter('3589903040125146199');" onmouseout="out('3589903040125146199');" style="">1872              } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErrors())) { </span>
<span class="-8002349788440125315" onmouseenter="enter('-8002349788440125315');" onmouseout="out('-8002349788440125315');" style="">1873                  error = persistenceResponse.getEntity().getGlobalValidationErrors().get(0);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1874              }                                                                                                     </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1875              return new JsonResponse(response)                                                                     </span>
<span class="4764127484129551096" onmouseenter="enter('4764127484129551096');" onmouseout="out('4764127484129551096');" style="">1876                  .with(&quot;status&quot;, &quot;error&quot;)                                                                          </span>
<span class="-4778619806303294332" onmouseenter="enter('-4778619806303294332');" onmouseout="out('-4778619806303294332');" style="">1877                  .with(&quot;message&quot;, BLCMessageUtils.getMessage(error))                                               </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1878                  .done();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1879          }                                                                                                         </span>
<span  style="">1880                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1881          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1882          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1883          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1883          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persðŸ”µ</abbr></span>
<span  style="">1884                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1885          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1886          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1887          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1888          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1889      }                                                                                                             </span>
<span  style="">1890                                                                                                                    </span>
<span class="-1722269672251008380" onmouseenter="enter('-1722269672251008380');" onmouseout="out('-1722269672251008380');" style="">1891      public void addAuditableDisplayFields(EntityForm entityForm) {                                                </span>
<span class="2220665039639111541" onmouseenter="enter('2220665039639111541');" onmouseout="out('2220665039639111541');" style="">1892          Field createdBy = entityForm.findField(&quot;auditable.createdBy&quot;);                                            </span>
<span class="-1310269621989930827" onmouseenter="enter('-1310269621989930827');" onmouseout="out('-1310269621989930827');" style="">1893          if (createdBy != null &amp;&amp; createdBy.getValue() != null) {                                                  </span>
<span class="3065344382927201496" onmouseenter="enter('3065344382927201496');" onmouseout="out('3065344382927201496');" style="">1894              addAuditableDisplayField(entityForm, createdBy);                                                      </span>
<span  style="">1895                                                                                                                    </span>
<span class="-8232178899610643805" onmouseenter="enter('-8232178899610643805');" onmouseout="out('-8232178899610643805');" style="">1896              createdBy.setIsVisible(false);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1897          }                                                                                                         </span>
<span class="1393544913931451876" onmouseenter="enter('1393544913931451876');" onmouseout="out('1393544913931451876');" style="">1898          Field updatedBy = entityForm.findField(&quot;auditable.updatedBy&quot;);                                            </span>
<span class="362865388069983596" onmouseenter="enter('362865388069983596');" onmouseout="out('362865388069983596');" style="">1899          if (updatedBy != null &amp;&amp; updatedBy.getValue() != null) {                                                  </span>
<span class="-892302887107162271" onmouseenter="enter('-892302887107162271');" onmouseout="out('-892302887107162271');" style="">1900              addAuditableDisplayField(entityForm, updatedBy);                                                      </span>
<span  style="">1901                                                                                                                    </span>
<span class="6398063041947851488" onmouseenter="enter('6398063041947851488');" onmouseout="out('6398063041947851488');" style="">1902              updatedBy.setIsVisible(false);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1903          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1904      }                                                                                                             </span>
<span  style="">1905                                                                                                                    </span>
<span class="4984267825623541739" onmouseenter="enter('4984267825623541739');" onmouseout="out('4984267825623541739');" style="">1906      private void addAuditableDisplayField(EntityForm entityForm, Field userField) {                               </span>
<span class="-4635466229336929139" onmouseenter="enter('-4635466229336929139');" onmouseout="out('-4635466229336929139');" style="">1907          Field displayField = buildAuditableDisplayField(userField);                                               </span>
<span  style="">1908                                                                                                                    </span>
<span class="-3510960703864117903" onmouseenter="enter('-3510960703864117903');" onmouseout="out('-3510960703864117903');" style="">1909          AdminUser user = adminUserDao.readAdminUserById(Long.parseLong(userField.getValue()));                    </span>
<span class="-2749914300638269457" onmouseenter="enter('-2749914300638269457');" onmouseout="out('-2749914300638269457');" style="">1910          String userName = user == null ? null : user.getName();                                                   </span>
<span class="-519467923242361473" onmouseenter="enter('-519467923242361473');" onmouseout="out('-519467923242361473');" style="">1911          displayField.setValue(userName);                                                                          </span>
<span  style="">1912                                                                                                                    </span>
<span class="2796866146572271884" onmouseenter="enter('2796866146572271884');" onmouseout="out('2796866146572271884');" style="">1913          FieldGroup auditGroup = entityForm.findGroup(&quot;AdminAuditable_Audit&quot;);                                     </span>
<span class="442119087406556402" onmouseenter="enter('442119087406556402');" onmouseout="out('442119087406556402');" style="">1914          if (auditGroup != null) {                                                                                 </span>
<span class="2790071812155889083" onmouseenter="enter('2790071812155889083');" onmouseout="out('2790071812155889083');" style="">1915              auditGroup.addField(displayField);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1916          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1917      }                                                                                                             </span>
<span  style="">1918                                                                                                                    </span>
<span class="-898012728924165157" onmouseenter="enter('-898012728924165157');" onmouseout="out('-898012728924165157');" style="">1919      private Field buildAuditableDisplayField(Field auditableField) {                                              </span>
<span class="7586031541837577475" onmouseenter="enter('7586031541837577475');" onmouseout="out('7586031541837577475');" style="">1920          return new Field().withFieldType(SupportedFieldType.STRING.toString())                                    </span>
<span class="-5983163062967947616" onmouseenter="enter('-5983163062967947616');" onmouseout="out('-5983163062967947616');" style="">1921                  .withName(auditableField.getName() + &quot;Display&quot;)                                                   </span>
<span class="-3810520855500417343" onmouseenter="enter('-3810520855500417343');" onmouseout="out('-3810520855500417343');" style="">1922                  .withFriendlyName(auditableField.getFriendlyName())                                               </span>
<span class="-2087540063707551713" onmouseenter="enter('-2087540063707551713');" onmouseout="out('-2087540063707551713');" style="">1923                  .withOrder(auditableField.getOrder())                                                             </span>
<span class="3252055162848788175" onmouseenter="enter('3252055162848788175');" onmouseout="out('3252055162848788175');" style="">1924                  .withOwningEntityClass(auditableField.getOwningEntityClass())                                     </span>
<span class="8052491048417023702" onmouseenter="enter('8052491048417023702');" onmouseout="out('8052491048417023702');" style="">1925                  .withReadOnly(true);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1926      }                                                                                                             </span>
<span  style="">1927                                                                                                                    </span>
<span class="2512746595428590302" onmouseenter="enter('2512746595428590302');" onmouseout="out('2512746595428590302');" style="">1928      protected String getCurrentTabName(Map&lt;String, String&gt; pathVars, ClassMetadata cmd) {                         </span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style="">1929          String tabName = pathVars.get(&quot;tabName&quot;);                                                                 </span>
<span class="620358619967646231" onmouseenter="enter('620358619967646231');" onmouseout="out('620358619967646231');" style="">1930          if (StringUtils.isBlank(tabName)) {                                                                       </span>
<span class="-8386812650765964886" onmouseenter="enter('-8386812650765964886');" onmouseout="out('-8386812650765964886');" style="">1931              TabMetadata firstTab = cmd.getFirstTab();                                                             </span>
<span class="5997097813726693180" onmouseenter="enter('5997097813726693180');" onmouseout="out('5997097813726693180');" style="">1932              return firstTab != null ? firstTab.getTabName() : &quot;General&quot;;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1933          }                                                                                                         </span>
<span class="-6789109484485831180" onmouseenter="enter('-6789109484485831180');" onmouseout="out('-6789109484485831180');" style="">1934          return tabName;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1935      }                                                                                                             </span>
<span  style="">1936                                                                                                                    </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">1937      // *****************************************                                                                  </span>
<span class="2492884656402841956" onmouseenter="enter('2492884656402841956');" onmouseout="out('2492884656402841956');" style="">1938      // Typed Entity Helper Methods                                                                                </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">1939      // *****************************************                                                                  </span>
<span  style="">1940                                                                                                                    </span>
<span class="709722161552159597" onmouseenter="enter('709722161552159597');" onmouseout="out('709722161552159597');" style="">1941      protected void setTypedEntityModelAttributes(HttpServletRequest request, Model model) {                       </span>
<span class="2572860224956804545" onmouseenter="enter('2572860224956804545');" onmouseout="out('2572860224956804545');" style="">1942          // Check if this is a typed entity                                                                        </span>
<span class="-601784761218487618" onmouseenter="enter('-601784761218487618');" onmouseout="out('-601784761218487618');" style="">1943          AdminSection typedEntitySection = (AdminSection) request.getAttribute(&quot;typedEntitySection&quot;);              </span>
<span class="2356861889771822774" onmouseenter="enter('2356861889771822774');" onmouseout="out('2356861889771822774');" style="">1944          if (typedEntitySection != null) {                                                                         </span>
<span class="-7054855399164801351" onmouseenter="enter('-7054855399164801351');" onmouseout="out('-7054855399164801351');" style="">1945              // Update the friendly name for this Entity Type                                                      </span>
<span class="-8436584596314077038" onmouseenter="enter('-8436584596314077038');" onmouseout="out('-8436584596314077038');" style="">1946              model.addAttribute(&quot;entityFriendlyName&quot;, typedEntitySection.getName());                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1947          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1948      }                                                                                                             </span>
<span  style="">1949                                                                                                                    </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">1950      // *********************************                                                                          </span>
<span class="5570644305110686760" onmouseenter="enter('5570644305110686760');" onmouseout="out('5570644305110686760');" style="">1951      // ADDITIONAL SPRING-BOUND METHODS *                                                                          </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">1952      // *********************************                                                                          </span>
<span  style="">1953                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1954      /**                                                                                                           </span>
<span class="-6771709729688841784" onmouseenter="enter('-6771709729688841784');" onmouseout="out('-6771709729688841784');" style="">1955       * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding process. </span>
<span class="2498077318751920180" onmouseenter="enter('2498077318751920180');" onmouseout="out('2498077318751920180');" style=""><abbr title="1956       * By default, we register a binder that treats empty Strings as null and a Boolean editor that supports either true">1956       * By default, we register a binder that treats empty Strings as null and a Boolean editor that supports eitheðŸ”µ</abbr></span>
<span class="4465303089468973962" onmouseenter="enter('4465303089468973962');" onmouseout="out('4465303089468973962');" style="">1957       * or false. If the value is passed in as null, it will treat it as false.                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1958       *                                                                                                            </span>
<span class="-3898462538136412996" onmouseenter="enter('-3898462538136412996');" onmouseout="out('-3898462538136412996');" style="">1959       * @param binder                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1960       */                                                                                                           </span>
<span class="2978104519843175555" onmouseenter="enter('2978104519843175555');" onmouseout="out('2978104519843175555');" style="">1961      @InitBinder                                                                                                   </span>
<span class="4179572271848089300" onmouseenter="enter('4179572271848089300');" onmouseout="out('4179572271848089300');" style="">1962      public void initBinder(WebDataBinder binder) {                                                                </span>
<span class="3888201586857511470" onmouseenter="enter('3888201586857511470');" onmouseout="out('3888201586857511470');" style="">1963          binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));                                 </span>
<span class="-4458929942740752488" onmouseenter="enter('-4458929942740752488');" onmouseout="out('-4458929942740752488');" style="">1964          binder.registerCustomEditor(Boolean.class, new NonNullBooleanEditor());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1965      }                                                                                                             </span>
<span  style="">1966                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1967  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="913821711322743166" onmouseenter="enter('913821711322743166');" onmouseout="out('913821711322743166');" style="">  18  package org.broadleafcommerce.openadmin.web.controller.entity;                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  20  import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  21  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="3542918789910249764" onmouseenter="enter('3542918789910249764');" onmouseout="out('3542918789910249764');" style="">  25  import org.broadleafcommerce.common.exception.SecurityServiceException;                                           </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  26  import org.broadleafcommerce.common.exception.ServiceException;                                                   </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  27  import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                              </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  28  import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                          </span>
<span class="-3349026188166660873" onmouseenter="enter('-3349026188166660873');" onmouseout="out('-3349026188166660873');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import org.broadleafcommerce.common.persistence.EntityDuplicator;                                                 </span>
<span class="-6648433550510659033" onmouseenter="enter('-6648433550510659033');" onmouseout="out('-6648433550510659033');" style="">  30  import org.broadleafcommerce.common.presentation.client.AddMethodType;                                            </span>
<span class="1362364260528215152" onmouseenter="enter('1362364260528215152');" onmouseout="out('1362364260528215152');" style="">  31  import org.broadleafcommerce.common.presentation.client.SupportedFieldType;                                       </span>
<span class="-2818686525334833130" onmouseenter="enter('-2818686525334833130');" onmouseout="out('-2818686525334833130');" style="">  32  import org.broadleafcommerce.common.sandbox.SandBoxHelper;                                                        </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +import org.broadleafcommerce.common.service.GenericEntityService;                                                 </span>
<span class="2429458746821399950" onmouseenter="enter('2429458746821399950');" onmouseout="out('2429458746821399950');" style="">  34  import org.broadleafcommerce.common.util.BLCArrayUtils;                                                           </span>
<span class="2428099238642943960" onmouseenter="enter('2428099238642943960');" onmouseout="out('2428099238642943960');" style="">  35  import org.broadleafcommerce.common.util.BLCMessageUtils;                                                         </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  36  import org.broadleafcommerce.common.web.BroadleafRequestContext;                                                  </span>
<span class="-1418036767363331062" onmouseenter="enter('-1418036767363331062');" onmouseout="out('-1418036767363331062');" style="">  37  import org.broadleafcommerce.common.web.JsonResponse;                                                             </span>
<span class="-3361215363157046739" onmouseenter="enter('-3361215363157046739');" onmouseout="out('-3361215363157046739');" style="">  38  import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;                                       </span>
<span class="-1781055592725563383" onmouseenter="enter('-1781055592725563383');" onmouseout="out('-1781055592725563383');" style="">  39  import org.broadleafcommerce.openadmin.dto.AdornedTargetList;                                                     </span>
<span class="-6140296335181984013" onmouseenter="enter('-6140296335181984013');" onmouseout="out('-6140296335181984013');" style="">  40  import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;                                               </span>
<span class="4427537537958608766" onmouseenter="enter('4427537537958608766');" onmouseout="out('4427537537958608766');" style="">  41  import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;                                                    </span>
<span class="-1607559599739253077" onmouseenter="enter('-1607559599739253077');" onmouseout="out('-1607559599739253077');" style="">  42  import org.broadleafcommerce.openadmin.dto.ClassMetadata;                                                         </span>
<span class="5550564421881377532" onmouseenter="enter('5550564421881377532');" onmouseout="out('5550564421881377532');" style="">  43  import org.broadleafcommerce.openadmin.dto.ClassTree;                                                             </span>
<span class="-3165611006566133086" onmouseenter="enter('-3165611006566133086');" onmouseout="out('-3165611006566133086');" style="">  44  import org.broadleafcommerce.openadmin.dto.CollectionMetadata;                                                    </span>
<span class="-4742435063138209714" onmouseenter="enter('-4742435063138209714');" onmouseout="out('-4742435063138209714');" style="">  45  import org.broadleafcommerce.openadmin.dto.DynamicResultSet;                                                      </span>
<span class="-5093421835888664541" onmouseenter="enter('-5093421835888664541');" onmouseout="out('-5093421835888664541');" style="">  46  import org.broadleafcommerce.openadmin.dto.Entity;                                                                </span>
<span class="-8829499667991596741" onmouseenter="enter('-8829499667991596741');" onmouseout="out('-8829499667991596741');" style="">  47  import org.broadleafcommerce.openadmin.dto.FieldMetadata;                                                         </span>
<span class="6369021917986026789" onmouseenter="enter('6369021917986026789');" onmouseout="out('6369021917986026789');" style="">  48  import org.broadleafcommerce.openadmin.dto.FilterAndSortCriteria;                                                 </span>
<span class="826821438795056004" onmouseenter="enter('826821438795056004');" onmouseout="out('826821438795056004');" style="">  49  import org.broadleafcommerce.openadmin.dto.MapMetadata;                                                           </span>
<span class="1983554291461039357" onmouseenter="enter('1983554291461039357');" onmouseout="out('1983554291461039357');" style="">  50  import org.broadleafcommerce.openadmin.dto.Property;                                                              </span>
<span class="1696571253156436279" onmouseenter="enter('1696571253156436279');" onmouseout="out('1696571253156436279');" style="">  51  import org.broadleafcommerce.openadmin.dto.SectionCrumb;                                                          </span>
<span class="5662236005419086618" onmouseenter="enter('5662236005419086618');" onmouseout="out('5662236005419086618');" style="">  52  import org.broadleafcommerce.openadmin.dto.TabMetadata;                                                           </span>
<span class="-8828889589519173652" onmouseenter="enter('-8828889589519173652');" onmouseout="out('-8828889589519173652');" style="">  53  import org.broadleafcommerce.openadmin.server.dao.DynamicEntityDao;                                               </span>
<span class="4410643013278245372" onmouseenter="enter('4410643013278245372');" onmouseout="out('4410643013278245372');" style="">  54  import org.broadleafcommerce.openadmin.server.domain.PersistencePackageRequest;                                   </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  55  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-7620175268967942501" onmouseenter="enter('-7620175268967942501');" onmouseout="out('-7620175268967942501');" style="">  56  import org.broadleafcommerce.openadmin.server.security.domain.AdminSection;                                       </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  57  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-4641149340176766185" onmouseenter="enter('-4641149340176766185');" onmouseout="out('-4641149340176766185');" style="">  58  import org.broadleafcommerce.openadmin.server.security.remote.EntityOperationType;                                </span>
<span class="78786346091609662" onmouseenter="enter('78786346091609662');" onmouseout="out('78786346091609662');" style="">  59  import org.broadleafcommerce.openadmin.server.security.service.RowLevelSecurityService;                           </span>
<span class="-8603256547657551769" onmouseenter="enter('-8603256547657551769');" onmouseout="out('-8603256547657551769');" style="">  60  import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;                            </span>
<span class="5585583973934060515" onmouseenter="enter('5585583973934060515');" onmouseout="out('5585583973934060515');" style=""><abbr title="  61  import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExtensionManager;">  61  import org.broadleafcommerce.openadmin.server.service.persistence.extension.AdornedTargetAutoPopulateExtensionManaðŸ”µ</abbr></span>
<span class="-3086540061138981164" onmouseenter="enter('-3086540061138981164');" onmouseout="out('-3086540061138981164');" style="">  62  import org.broadleafcommerce.openadmin.server.service.persistence.module.BasicPersistenceModule;                  </span>
<span class="9131075895472939574" onmouseenter="enter('9131075895472939574');" onmouseout="out('9131075895472939574');" style="">  63  import org.broadleafcommerce.openadmin.web.controller.AdminAbstractController;                                    </span>
<span class="7254479112554025637" onmouseenter="enter('7254479112554025637');" onmouseout="out('7254479112554025637');" style="">  64  import org.broadleafcommerce.openadmin.web.controller.modal.ModalHeaderType;                                      </span>
<span class="4507704609742395614" onmouseenter="enter('4507704609742395614');" onmouseout="out('4507704609742395614');" style="">  65  import org.broadleafcommerce.openadmin.web.editor.NonNullBooleanEditor;                                           </span>
<span class="-2042519459673859584" onmouseenter="enter('-2042519459673859584');" onmouseout="out('-2042519459673859584');" style="">  66  import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;                                 </span>
<span class="3056790491614608405" onmouseenter="enter('3056790491614608405');" onmouseout="out('3056790491614608405');" style="">  67  import org.broadleafcommerce.openadmin.web.form.component.ListGrid;                                               </span>
<span class="1405974373227613661" onmouseenter="enter('1405974373227613661');" onmouseout="out('1405974373227613661');" style="">  68  import org.broadleafcommerce.openadmin.web.form.entity.DefaultAdornedEntityFormActions;                           </span>
<span class="2718350422838759693" onmouseenter="enter('2718350422838759693');" onmouseout="out('2718350422838759693');" style="">  69  import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;                                  </span>
<span class="-3560862041655103076" onmouseenter="enter('-3560862041655103076');" onmouseout="out('-3560862041655103076');" style="">  70  import org.broadleafcommerce.openadmin.web.form.entity.DefaultMainActions;                                        </span>
<span class="8035715143965725316" onmouseenter="enter('8035715143965725316');" onmouseout="out('8035715143965725316');" style="">  71  import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;                                                </span>
<span class="-3164920911156953697" onmouseenter="enter('-3164920911156953697');" onmouseout="out('-3164920911156953697');" style="">  72  import org.broadleafcommerce.openadmin.web.form.entity.EntityFormAction;                                          </span>
<span class="6015559832933397076" onmouseenter="enter('6015559832933397076');" onmouseout="out('6015559832933397076');" style="">  73  import org.broadleafcommerce.openadmin.web.form.entity.Field;                                                     </span>
<span class="-5634654756625156689" onmouseenter="enter('-5634654756625156689');" onmouseout="out('-5634654756625156689');" style="">  74  import org.broadleafcommerce.openadmin.web.form.entity.FieldGroup;                                                </span>
<span class="8763280003660953520" onmouseenter="enter('8763280003660953520');" onmouseout="out('8763280003660953520');" style="">  75  import org.springframework.beans.propertyeditors.StringTrimmerEditor;                                             </span>
<span class="4128309806836178094" onmouseenter="enter('4128309806836178094');" onmouseout="out('4128309806836178094');" style="">  76  import org.springframework.stereotype.Controller;                                                                 </span>
<span class="2230089600625206822" onmouseenter="enter('2230089600625206822');" onmouseout="out('2230089600625206822');" style="">  77  import org.springframework.ui.Model;                                                                              </span>
<span class="-8661390401087732702" onmouseenter="enter('-8661390401087732702');" onmouseout="out('-8661390401087732702');" style="">  78  import org.springframework.util.MultiValueMap;                                                                    </span>
<span class="-5446610002806720528" onmouseenter="enter('-5446610002806720528');" onmouseout="out('-5446610002806720528');" style="">  79  import org.springframework.validation.BindingResult;                                                              </span>
<span class="-5956639343389312225" onmouseenter="enter('-5956639343389312225');" onmouseout="out('-5956639343389312225');" style="">  80  import org.springframework.web.bind.WebDataBinder;                                                                </span>
<span class="6486986322776186621" onmouseenter="enter('6486986322776186621');" onmouseout="out('6486986322776186621');" style="">  81  import org.springframework.web.bind.annotation.InitBinder;                                                        </span>
<span class="2718246165073723950" onmouseenter="enter('2718246165073723950');" onmouseout="out('2718246165073723950');" style="">  82  import org.springframework.web.bind.annotation.ModelAttribute;                                                    </span>
<span class="3963501418927616634" onmouseenter="enter('3963501418927616634');" onmouseout="out('3963501418927616634');" style="">  83  import org.springframework.web.bind.annotation.PathVariable;                                                      </span>
<span class="-7989471178862524182" onmouseenter="enter('-7989471178862524182');" onmouseout="out('-7989471178862524182');" style="">  84  import org.springframework.web.bind.annotation.RequestMapping;                                                    </span>
<span class="4584846860636268493" onmouseenter="enter('4584846860636268493');" onmouseout="out('4584846860636268493');" style="">  85  import org.springframework.web.bind.annotation.RequestMethod;                                                     </span>
<span class="-8913037601281016619" onmouseenter="enter('-8913037601281016619');" onmouseout="out('-8913037601281016619');" style="">  86  import org.springframework.web.bind.annotation.RequestParam;                                                      </span>
<span class="-7662224364501075428" onmouseenter="enter('-7662224364501075428');" onmouseout="out('-7662224364501075428');" style="">  87  import org.springframework.web.bind.annotation.ResponseBody;                                                      </span>
<span class="82864906475118767" onmouseenter="enter('82864906475118767');" onmouseout="out('82864906475118767');" style="">  88  import org.springframework.web.servlet.DispatcherServlet;                                                         </span>
<span class="4665273347041581179" onmouseenter="enter('4665273347041581179');" onmouseout="out('4665273347041581179');" style="">  89  import org.springframework.web.servlet.FlashMap;                                                                  </span>
<span class="4289605998216587359" onmouseenter="enter('4289605998216587359');" onmouseout="out('4289605998216587359');" style="">  90  import org.springframework.web.servlet.mvc.support.RedirectAttributes;                                            </span>
<span class="2383374134797300138" onmouseenter="enter('2383374134797300138');" onmouseout="out('2383374134797300138');" style="">  91  import org.springframework.web.util.UrlPathHelper;                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  92 +                                                                                                                  </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="">  93  import com.fasterxml.jackson.databind.ObjectMapper;                                                               </span>
<span  style="">  94                                                                                                                    </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +import java.io.Serializable;                                                                                      </span>
<span class="8256805395213692609" onmouseenter="enter('8256805395213692609');" onmouseout="out('8256805395213692609');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +import java.io.UnsupportedEncodingException;                                                                      </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="">  97  import java.net.URLDecoder;                                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  98  import java.util.ArrayList;                                                                                       </span>

<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  99  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style=""> 100  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style=""> 101  import java.util.Map;                                                                                             </span>
<span class="2393042000349901971" onmouseenter="enter('2393042000349901971');" onmouseout="out('2393042000349901971');" style=""> 102  import java.util.Map.Entry;                                                                                       </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style=""> 103  import java.util.Set;                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +                                                                                                                  </span>

<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style=""> 105  import javax.annotation.Resource;                                                                                 </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style=""> 106  import javax.servlet.http.HttpServletRequest;                                                                     </span>
<span class="-2247759832438184775" onmouseenter="enter('-2247759832438184775');" onmouseout="out('-2247759832438184775');" style=""> 107  import javax.servlet.http.HttpServletResponse;                                                                    </span>
<span  style=""> 108                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 109  /**                                                                                                               </span>
<span class="4260469300841401635" onmouseenter="enter('4260469300841401635');" onmouseout="out('4260469300841401635');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 110 - * The default implementation of the {@link #BroadleafAdminAbstractEntityController}. This delegates every call to super"> 110 - * The default implementation of the {@link #BroadleafAdminAbstractEntityController}. This delegates every call toðŸ”µ</abbr></span>
<span class="-3899564930283338794" onmouseenter="enter('-3899564930283338794');" onmouseout="out('-3899564930283338794');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 111 - * and does not provide any custom-tailored functionality. It is responsible for rendering the admin for every entity"> 111 - * and does not provide any custom-tailored functionality. It is responsible for rendering the admin for every entðŸ”µ</abbr></span>
<span class="-5698631600182435917" onmouseenter="enter('-5698631600182435917');" onmouseout="out('-5698631600182435917');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 - * that is not explicitly customized by its own controller.                                                       </span>
<span class="5624503434864804252" onmouseenter="enter('5624503434864804252');" onmouseout="out('5624503434864804252');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 + * The default implementation of the {@link AdminAbstractController}. This delegates every call to                </span>
<span class="-497882971048272294" onmouseenter="enter('-497882971048272294');" onmouseout="out('-497882971048272294');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 + * super and does not provide any custom-tailored functionality. It is responsible for rendering the              </span>
<span class="-4790859535261881332" onmouseenter="enter('-4790859535261881332');" onmouseout="out('-4790859535261881332');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 + * admin for every entity that is not explicitly customized by its own controller.                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 116   *                                                                                                                </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style=""> 117   * @author Andre Azzolini (apazzolini)                                                                            </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style=""> 118   * @author Jeff Fischer                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 119   */                                                                                                               </span>
<span class="4155455059275642147" onmouseenter="enter('4155455059275642147');" onmouseout="out('4155455059275642147');" style=""> 120  @Controller(&quot;blAdminBasicEntityController&quot;)                                                                       </span>
<span class="1298802560762502343" onmouseenter="enter('1298802560762502343');" onmouseout="out('1298802560762502343');" style=""> 121  @RequestMapping(&quot;/{sectionKey:.+}&quot;)                                                                               </span>
<span class="8857493697785984988" onmouseenter="enter('8857493697785984988');" onmouseout="out('8857493697785984988');" style=""> 122  public class AdminBasicEntityController extends AdminAbstractController {                                         </span>
<span  style=""> 123                                                                                                                    </span>
<span class="6387945601766467724" onmouseenter="enter('6387945601766467724');" onmouseout="out('6387945601766467724');" style=""> 124      protected static final Log LOG = LogFactory.getLog(AdminBasicEntityController.class);                         </span>
<span  style=""> 125                                                                                                                    </span>
<span class="-3043900363751028803" onmouseenter="enter('-3043900363751028803');" onmouseout="out('-3043900363751028803');" style=""> 126      public static final String ALTERNATE_ID_PROPERTY = &quot;ALTERNATE_ID&quot;;                                            </span>
<span class="4075481265342786632" onmouseenter="enter('4075481265342786632');" onmouseout="out('4075481265342786632');" style=""> 127      public static final String CUSTOM_CRITERIA = &quot;criteria&quot;;                                                      </span>
<span class="-5370879055704196240" onmouseenter="enter('-5370879055704196240');" onmouseout="out('-5370879055704196240');" style=""> 128      public static final String IS_SELECTIZE_REQUEST = &quot;isSelectizeRequest&quot;;                                       </span>
<span  style=""> 129                                                                                                                    </span>
<span class="-7030764210296949798" onmouseenter="enter('-7030764210296949798');" onmouseout="out('-7030764210296949798');" style=""> 130      @Resource(name=&quot;blSandBoxHelper&quot;)                                                                             </span>
<span class="-7799183597372200632" onmouseenter="enter('-7799183597372200632');" onmouseout="out('-7799183597372200632');" style=""> 131      protected SandBoxHelper sandBoxHelper;                                                                        </span>
<span  style=""> 132                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style=""> 133      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style=""> 134      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style=""> 135                                                                                                                    </span>
<span class="1039661802170570045" onmouseenter="enter('1039661802170570045');" onmouseout="out('1039661802170570045');" style=""> 136      @Resource(name=&quot;blDynamicEntityDao&quot;)                                                                          </span>
<span class="-6629482740079052882" onmouseenter="enter('-6629482740079052882');" onmouseout="out('-6629482740079052882');" style=""> 137      protected DynamicEntityDao dynamicEntityDao;                                                                  </span>
<span  style=""> 138                                                                                                                    </span>
<span class="3323977399618509653" onmouseenter="enter('3323977399618509653');" onmouseout="out('3323977399618509653');" style=""> 139      @Resource(name = &quot;blAdornedTargetAutoPopulateExtensionManager&quot;)                                               </span>
<span class="-4810148452666974339" onmouseenter="enter('-4810148452666974339');" onmouseout="out('-4810148452666974339');" style=""> 140      protected AdornedTargetAutoPopulateExtensionManager adornedTargetAutoPopulateExtensionManager;                </span>
<span  style=""> 141                                                                                                                    </span>
<span class="-1073312679381587606" onmouseenter="enter('-1073312679381587606');" onmouseout="out('-1073312679381587606');" style=""> 142      @Resource(name = &quot;blRowLevelSecurityService&quot;)                                                                 </span>
<span class="7292046362506695965" onmouseenter="enter('7292046362506695965');" onmouseout="out('7292046362506695965');" style=""> 143      protected RowLevelSecurityService rowLevelSecurityService;                                                    </span>
<span  style=""> 144                                                                                                                    </span>
<span class="4471392044492296285" onmouseenter="enter('4471392044492296285');" onmouseout="out('4471392044492296285');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +    @Resource(name = &quot;blEntityDuplicator&quot;)                                                                        </span>
<span class="-9194612273021432316" onmouseenter="enter('-9194612273021432316');" onmouseout="out('-9194612273021432316');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +    protected EntityDuplicator duplicator;                                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +                                                                                                                  </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +    @Resource(name = &quot;blGenericEntityService&quot;)                                                                    </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +    protected GenericEntityService genericEntityService;                                                          </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +                                                                                                                  </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 151      // ******************************************                                                                 </span>
<span class="8145904524131922989" onmouseenter="enter('8145904524131922989');" onmouseout="out('8145904524131922989');" style=""> 152      // REQUEST-MAPPING BOUND CONTROLLER METHODS *                                                                 </span>
<span class="-459840192887909665" onmouseenter="enter('-459840192887909665');" onmouseout="out('-459840192887909665');" style=""> 153      // ******************************************                                                                 </span>
<span  style=""> 154                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 155      /**                                                                                                           </span>
<span class="5980196098348408716" onmouseenter="enter('5980196098348408716');" onmouseout="out('5980196098348408716');" style=""><abbr title=" 156       * Renders the main entity listing for the specified class, which is based on the current sectionKey with some optional"> 156       * Renders the main entity listing for the specified class, which is based on the current sectionKey with someðŸ”µ</abbr></span>
<span class="1756838433111210325" onmouseenter="enter('1756838433111210325');" onmouseout="out('1756838433111210325');" style=""> 157       * criteria.                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 158       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 159       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 160       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 161       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 162       * @param pathVars                                                                                            </span>
<span class="-7836494531350161829" onmouseenter="enter('-7836494531350161829');" onmouseout="out('-7836494531350161829');" style=""> 163       * @param requestParams a Map of property name -&gt; list critiera values                                        </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 164       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 165       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 166       */                                                                                                           </span>
<span class="854227037044969777" onmouseenter="enter('854227037044969777');" onmouseout="out('854227037044969777');" style=""> 167      @RequestMapping(value = &quot;&quot;, method = RequestMethod.GET)                                                       </span>
<span class="5203424842505603172" onmouseenter="enter('5203424842505603172');" onmouseout="out('5203424842505603172');" style=""> 168      public String viewEntityList(HttpServletRequest request, HttpServletResponse response, Model model,           </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 169              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 170              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 171          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 172          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 173          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                                        </span>
<span class="1452589137399878084" onmouseenter="enter('1452589137399878084');" onmouseout="out('1452589137399878084');" style=""><abbr title=" 174          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars);"> 174          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 175          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 176          DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                                    </span>
<span  style=""> 177                                                                                                                    </span>
<span class="-9123024135554384147" onmouseenter="enter('-9123024135554384147');" onmouseout="out('-9123024135554384147');" style=""> 178          ListGrid listGrid = formService.buildMainListGrid(drs, cmd, sectionKey, crumbs);                          </span>
<span class="-7197013270379460942" onmouseenter="enter('-7197013270379460942');" onmouseout="out('-7197013270379460942');" style=""> 179          listGrid.setSelectType(ListGrid.SelectType.NONE);                                                         </span>
<span  style=""> 180                                                                                                                    </span>
<span class="6707774114103003478" onmouseenter="enter('6707774114103003478');" onmouseout="out('6707774114103003478');" style=""> 181          Set&lt;Field&gt; headerFields = listGrid.getHeaderFields();                                                     </span>
<span class="6157449347608657417" onmouseenter="enter('6157449347608657417');" onmouseout="out('6157449347608657417');" style=""> 182          if (CollectionUtils.isNotEmpty(headerFields)) {                                                           </span>
<span class="7359980094802675712" onmouseenter="enter('7359980094802675712');" onmouseout="out('7359980094802675712');" style=""> 183              Field firstField = headerFields.iterator().next();                                                    </span>
<span class="-7992921859474727563" onmouseenter="enter('-7992921859474727563');" onmouseout="out('-7992921859474727563');" style=""> 184              if (requestParams.containsKey(firstField.getName())) {                                                </span>
<span class="-4847870846432586371" onmouseenter="enter('-4847870846432586371');" onmouseout="out('-4847870846432586371');" style=""> 185                  model.addAttribute(&quot;mainSearchTerm&quot;, requestParams.get(firstField.getName()).get(0));             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187          }                                                                                                         </span>
<span  style=""> 188                                                                                                                    </span>
<span class="3294377821001327596" onmouseenter="enter('3294377821001327596');" onmouseout="out('3294377821001327596');" style=""> 189          model.addAttribute(&quot;viewType&quot;, &quot;entityList&quot;);                                                             </span>
<span  style=""> 190                                                                                                                    </span>
<span class="5223794068523842694" onmouseenter="enter('5223794068523842694');" onmouseout="out('5223794068523842694');" style=""> 191          setupViewEntityListBasicModel(request, cmd, sectionKey, sectionClassName, model, requestParams);          </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style=""> 192          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span  style=""> 193                                                                                                                    </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -        return &quot;modules/defaultContainer&quot;;                                                                        </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 195 +        return DEFAULT_CONTAINER_VIEW;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196      }                                                                                                             </span>
<span  style=""> 197                                                                                                                    </span>
<span class="5512240627727429054" onmouseenter="enter('5512240627727429054');" onmouseout="out('5512240627727429054');" style=""> 198      protected void setupViewEntityListBasicModel(HttpServletRequest request, ClassMetadata cmd, String sectionKey,</span>
<span class="522743254766371502" onmouseenter="enter('522743254766371502');" onmouseout="out('522743254766371502');" style=""> 199              String sectionClassName, Model model, MultiValueMap&lt;String, String&gt; requestParams) {                  </span>
<span class="5787313217223527782" onmouseenter="enter('5787313217223527782');" onmouseout="out('5787313217223527782');" style=""> 200          List&lt;EntityFormAction&gt; mainActions = new ArrayList&lt;&gt;();                                                   </span>
<span class="-6495333239259317464" onmouseenter="enter('-6495333239259317464');" onmouseout="out('-6495333239259317464');" style=""> 201          addAddActionIfAllowed(sectionClassName, cmd, mainActions);                                                </span>
<span class="-5948121019403308590" onmouseenter="enter('-5948121019403308590');" onmouseout="out('-5948121019403308590');" style=""> 202          extensionManager.getProxy().addAdditionalMainActions(sectionClassName, mainActions);                      </span>
<span class="-381816252130957573" onmouseenter="enter('-381816252130957573');" onmouseout="out('-381816252130957573');" style=""> 203          extensionManager.getProxy().modifyMainActions(cmd, mainActions);                                          </span>
<span  style=""> 204                                                                                                                    </span>
<span class="-5498329164774951339" onmouseenter="enter('-5498329164774951339');" onmouseout="out('-5498329164774951339');" style=""> 205          // If this came from a delete save, we&#x27;ll have a headerFlash request parameter to take care of            </span>
<span class="6915846846822456322" onmouseenter="enter('6915846846822456322');" onmouseout="out('6915846846822456322');" style=""> 206          if (requestParams.containsKey(&quot;headerFlash&quot;)) {                                                           </span>
<span class="-7374079465520861767" onmouseenter="enter('-7374079465520861767');" onmouseout="out('-7374079465520861767');" style=""> 207              model.addAttribute(&quot;headerFlash&quot;, requestParams.get(&quot;headerFlash&quot;).get(0));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208          }                                                                                                         </span>
<span  style=""> 209                                                                                                                    </span>
<span class="-5632901614715850082" onmouseenter="enter('-5632901614715850082');" onmouseout="out('-5632901614715850082');" style=""> 210          List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                            </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style=""> 211          String requestUri = request.getRequestURI();                                                              </span>
<span class="2670437920401576748" onmouseenter="enter('2670437920401576748');" onmouseout="out('2670437920401576748');" style=""> 212          if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) {           </span>
<span class="-901741071381030126" onmouseenter="enter('-901741071381030126');" onmouseout="out('-901741071381030126');" style=""> 213              requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length());        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214          }                                                                                                         </span>
<span  style=""> 215                                                                                                                    </span>
<span class="-3335875933652663591" onmouseenter="enter('-3335875933652663591');" onmouseout="out('-3335875933652663591');" style=""> 216          model.addAttribute(&quot;isFilter&quot;, (requestParams.size() &gt; 0));                                               </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style=""> 217          model.addAttribute(&quot;currentUri&quot;, requestUri);                                                             </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style=""> 218          model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                           </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 219          model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 220          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="-4219022137146036385" onmouseenter="enter('-4219022137146036385');" onmouseout="out('-4219022137146036385');" style=""> 221          model.addAttribute(&quot;mainActions&quot;, mainActions);                                                           </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 222          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-7167932239083034641" onmouseenter="enter('-7167932239083034641');" onmouseout="out('-7167932239083034641');" style=""> 223          setTypedEntityModelAttributes(request, model);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224      }                                                                                                             </span>
<span  style=""> 225                                                                                                                    </span>
<span class="-3612928683982517341" onmouseenter="enter('-3612928683982517341');" onmouseout="out('-3612928683982517341');" style=""> 226      @RequestMapping(value = &quot;/selectize&quot;, method = RequestMethod.GET)                                             </span>
<span class="-2536734120775641057" onmouseenter="enter('-2536734120775641057');" onmouseout="out('-2536734120775641057');" style=""> 227      public @ResponseBody Map&lt;String, Object&gt; viewEntityListSelectize(HttpServletRequest request,                  </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style=""> 228               HttpServletResponse response, Model model,                                                           </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 229               @PathVariable Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 230               @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                        </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 231          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 232          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-1360124541010218678" onmouseenter="enter('-1360124541010218678');" onmouseout="out('-1360124541010218678');" style=""> 233          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, null, null);                                        </span>
<span class="3971039348455381302" onmouseenter="enter('3971039348455381302');" onmouseout="out('3971039348455381302');" style=""><abbr title=" 234          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbs, pathVars)"> 234          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, crumbðŸ”µ</abbr></span>
<span class="-5204717557696417186" onmouseenter="enter('-5204717557696417186');" onmouseout="out('-5204717557696417186');" style=""> 235                  .withCustomCriteria(getCustomCriteria(requestParams));                                            </span>
<span  style=""> 236                                                                                                                    </span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style=""> 237          ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                                    </span>
<span  style=""> 238                                                                                                                    </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 239          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="8256501976011402349" onmouseenter="enter('8256501976011402349');" onmouseout="out('8256501976011402349');" style=""> 240          DynamicResultSet drs =  service.getRecords(ppr).getDynamicResultSet();                                    </span>
<span  style=""> 241                                                                                                                    </span>
<span class="-6840686923261380416" onmouseenter="enter('-6840686923261380416');" onmouseout="out('-6840686923261380416');" style=""> 242          return formService.constructSelectizeOptionMap(drs, cmd);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243      }                                                                                                             </span>
<span  style=""> 244                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 245      /**                                                                                                           </span>
<span class="6015587852497052057" onmouseenter="enter('6015587852497052057');" onmouseout="out('6015587852497052057');" style=""> 246       * Obtains the requested criteria parameter                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 247       *                                                                                                            </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 248       * @param requestParams                                                                                       </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 249       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 250       */                                                                                                           </span>
<span class="-5224065764328446223" onmouseenter="enter('-5224065764328446223');" onmouseout="out('-5224065764328446223');" style=""> 251      protected String[] getCustomCriteria(Map&lt;String, List&lt;String&gt;&gt; requestParams) {                               </span>
<span class="8308653628584061101" onmouseenter="enter('8308653628584061101');" onmouseout="out('8308653628584061101');" style=""> 252          if (requestParams == null || requestParams.isEmpty()) {                                                   </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 253              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254          }                                                                                                         </span>
<span  style=""> 255                                                                                                                    </span>
<span class="-6200156504676301578" onmouseenter="enter('-6200156504676301578');" onmouseout="out('-6200156504676301578');" style=""> 256          List&lt;String&gt; criteria = requestParams.get(CUSTOM_CRITERIA);                                               </span>
<span class="3479198517250864619" onmouseenter="enter('3479198517250864619');" onmouseout="out('3479198517250864619');" style=""> 257          String response = CollectionUtils.isEmpty(criteria) ? null : criteria.get(0);                             </span>
<span class="3591199473111095603" onmouseenter="enter('3591199473111095603');" onmouseout="out('3591199473111095603');" style=""> 258          return new String[] {response};                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259      }                                                                                                             </span>
<span  style=""> 260                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 261      /**                                                                                                           </span>
<span class="53051913897087216" onmouseenter="enter('53051913897087216');" onmouseout="out('53051913897087216');" style=""> 262       * Adds the &quot;Add&quot; button to the main entity form if the current user has permissions to create new instances  </span>
<span class="-2041834868205006384" onmouseenter="enter('-2041834868205006384');" onmouseout="out('-2041834868205006384');" style=""> 263       * of the entity and all of the fields in the entity aren&#x27;t marked as read only.                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 264       *                                                                                                            </span>
<span class="2579837316240354786" onmouseenter="enter('2579837316240354786');" onmouseout="out('2579837316240354786');" style=""> 265       * @param sectionClassName                                                                                    </span>
<span class="3340688165449077744" onmouseenter="enter('3340688165449077744');" onmouseout="out('3340688165449077744');" style=""> 266       * @param cmd                                                                                                 </span>
<span class="-70241175981651056" onmouseenter="enter('-70241175981651056');" onmouseout="out('-70241175981651056');" style=""> 267       * @param mainActions                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 268       */                                                                                                           </span>
<span class="-3535265632615590771" onmouseenter="enter('-3535265632615590771');" onmouseout="out('-3535265632615590771');" style=""><abbr title=" 269      protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormAction&gt; mainActions) {"> 269      protected void addAddActionIfAllowed(String sectionClassName, ClassMetadata cmd, List&lt;EntityFormAction&gt; mainAcðŸ”µ</abbr></span>
<span class="-1675673801723949520" onmouseenter="enter('-1675673801723949520');" onmouseout="out('-1675673801723949520');" style=""> 270          if (isAddActionAllowed(sectionClassName, cmd)) {                                                          </span>
<span class="-161553798203722975" onmouseenter="enter('-161553798203722975');" onmouseout="out('-161553798203722975');" style=""> 271              mainActions.add(DefaultMainActions.ADD);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273      }                                                                                                             </span>
<span  style=""> 274                                                                                                                    </span>
<span class="6251273327061769060" onmouseenter="enter('6251273327061769060');" onmouseout="out('6251273327061769060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -    protected boolean isAddActionAllowed(String sectionClassName, ClassMetadata cmd) {                            </span>
<span class="4125299149074369729" onmouseenter="enter('4125299149074369729');" onmouseout="out('4125299149074369729');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 276 +    protected boolean isAddActionAllowed(final String sectionClassName, final ClassMetadata cmd) {                </span>
<span class="2379281051849826609" onmouseenter="enter('2379281051849826609');" onmouseout="out('2379281051849826609');" style=""> 277          // If the user does not have create permissions, we will not add the &quot;Add New&quot; button                     </span>
<span class="4837425918106440333" onmouseenter="enter('4837425918106440333');" onmouseout="out('4837425918106440333');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -        boolean canCreate = true;                                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 279          try {                                                                                                     </span>
<span class="-2050050318794737036" onmouseenter="enter('-2050050318794737036');" onmouseout="out('-2050050318794737036');" style=""> 280              adminRemoteSecurityService.securityCheck(sectionClassName, EntityOperationType.ADD);                  </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 281          } catch (ServiceException e) {                                                                            </span>
<span class="-8912377967087217182" onmouseenter="enter('-8912377967087217182');" onmouseout="out('-8912377967087217182');" style=""> 282              if (e instanceof SecurityServiceException) {                                                          </span>
<span class="-5562308883634048055" onmouseenter="enter('-5562308883634048055');" onmouseout="out('-5562308883634048055');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -                canCreate = false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -                                                                                                                  </span>
<span class="-3452128956938556370" onmouseenter="enter('-3452128956938556370');" onmouseout="out('-3452128956938556370');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -        if (canCreate) {                                                                                          </span>
<span class="-4263024171062822587" onmouseenter="enter('-4263024171062822587');" onmouseout="out('-4263024171062822587');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -            checkReadOnly: {                                                                                      </span>
<span class="-5650645308789885306" onmouseenter="enter('-5650645308789885306');" onmouseout="out('-5650645308789885306');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -                //check if all the metadata is read only                                                          </span>
<span class="-3497335608114491506" onmouseenter="enter('-3497335608114491506');" onmouseout="out('-3497335608114491506');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -                for (Property property : cmd.getProperties()) {                                                   </span>
<span class="-446642995335437650" onmouseenter="enter('-446642995335437650');" onmouseout="out('-446642995335437650');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -                    if (property.getMetadata() instanceof BasicFieldMetadata) {                                   </span>
<span class="-4740706861929444273" onmouseenter="enter('-4740706861929444273');" onmouseout="out('-4740706861929444273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -                        if (((BasicFieldMetadata) property.getMetadata()).getReadOnly() == null ||                </span>
<span class="7731016670197656615" onmouseenter="enter('7731016670197656615');" onmouseout="out('7731016670197656615');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -                                !((BasicFieldMetadata) property.getMetadata()).getReadOnly()) {                   </span>
<span class="7135533341781534816" onmouseenter="enter('7135533341781534816');" onmouseout="out('7135533341781534816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -                            break checkReadOnly;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -                    }                                                                                             </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 297 +                return false;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 298 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 299 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 300 +                                                                                                                  </span>
<span class="-3272601440754635767" onmouseenter="enter('-3272601440754635767');" onmouseout="out('-3272601440754635767');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 301 +        final boolean canAdd = rowLevelSecurityService                                                            </span>
<span class="-1653290766274377775" onmouseenter="enter('-1653290766274377775');" onmouseout="out('-1653290766274377775');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 302 +                .canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectionClassName, cmd);              </span>
<span class="5125272502277129387" onmouseenter="enter('5125272502277129387');" onmouseout="out('5125272502277129387');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 303 +        return isNotReadOnly(cmd) &amp;&amp; canAdd;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 304 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 305 +                                                                                                                  </span>
<span class="-7397004815762425407" onmouseenter="enter('-7397004815762425407');" onmouseout="out('-7397004815762425407');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 306 +    protected boolean isNotReadOnly(final ClassMetadata cmd) {                                                    </span>
<span class="-5650645308789885306" onmouseenter="enter('-5650645308789885306');" onmouseout="out('-5650645308789885306');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 307 +        //check if all the metadata is read only                                                                  </span>
<span class="-3497335608114491506" onmouseenter="enter('-3497335608114491506');" onmouseout="out('-3497335608114491506');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 308 +        for (Property property : cmd.getProperties()) {                                                           </span>
<span class="-446642995335437650" onmouseenter="enter('-446642995335437650');" onmouseout="out('-446642995335437650');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 309 +            if (property.getMetadata() instanceof BasicFieldMetadata) {                                           </span>
<span class="-4740706861929444273" onmouseenter="enter('-4740706861929444273');" onmouseout="out('-4740706861929444273');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 310 +                if (((BasicFieldMetadata) property.getMetadata()).getReadOnly() == null ||                        </span>
<span class="7731016670197656615" onmouseenter="enter('7731016670197656615');" onmouseout="out('7731016670197656615');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 311 +                        !((BasicFieldMetadata) property.getMetadata()).getReadOnly()) {                           </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 312 +                    return true;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313                  }                                                                                                 </span>
<span class="-5562308883634048055" onmouseenter="enter('-5562308883634048055');" onmouseout="out('-5562308883634048055');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 314 -                canCreate = false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 315 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 316 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 317 -                                                                                                                  </span>
<span class="-3452128956938556370" onmouseenter="enter('-3452128956938556370');" onmouseout="out('-3452128956938556370');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 318 -        if (canCreate) {                                                                                          </span>
<span class="-5729139490324794214" onmouseenter="enter('-5729139490324794214');" onmouseout="out('-5729139490324794214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 319 -            canCreate = rowLevelSecurityService.canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectionClassName, cmd);"> 319 -            canCreate = rowLevelSecurityService.canAdd(adminRemoteSecurityService.getPersistentAdminUser(), sectioðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 320 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 321 -                                                                                                                  </span>
<span class="2674140840454218035" onmouseenter="enter('2674140840454218035');" onmouseout="out('2674140840454218035');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 322 -        return canCreate;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 323 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 324 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 325 +                                                                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 326 +        return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327      }                                                                                                             </span>
<span  style=""> 328                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 329      /**                                                                                                           </span>
<span class="-403478592182410175" onmouseenter="enter('-403478592182410175');" onmouseout="out('-403478592182410175');" style=""> 330       * Renders the modal form that is used to add a new parent level entity. Note that this form cannot render any</span>
<span class="-2684076904077363908" onmouseenter="enter('-2684076904077363908');" onmouseout="out('-2684076904077363908');" style=""><abbr title=" 331       * subcollections as operations on those collections require the parent level entity to first be saved and have"> 331       * subcollections as operations on those collections require the parent level entity to first be saved and havðŸ”µ</abbr></span>
<span class="-2496660529180512497" onmouseenter="enter('-2496660529180512497');" onmouseout="out('-2496660529180512497');" style=""><abbr title=" 332       * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity screen where"> 332       * and id. Once the entity is initially saved, we will redirect the user to the normal manage entity screen whðŸ”µ</abbr></span>
<span class="-5672334976076130102" onmouseenter="enter('-5672334976076130102');" onmouseout="out('-5672334976076130102');" style=""> 333       * they can then perform operations on sub collections.                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 334       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 335       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 336       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 337       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 338       * @param pathVars                                                                                            </span>
<span class="-7339043177630483847" onmouseenter="enter('-7339043177630483847');" onmouseout="out('-7339043177630483847');" style=""> 339       * @param entityType                                                                                          </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 340       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 341       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 342       */                                                                                                           </span>
<span class="-6494270766546423105" onmouseenter="enter('-6494270766546423105');" onmouseout="out('-6494270766546423105');" style=""> 343      @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.GET)                                                   </span>
<span class="8522113168804045570" onmouseenter="enter('8522113168804045570');" onmouseout="out('8522113168804045570');" style=""> 344      public String viewAddEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,        </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 345              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="-1715631339976075770" onmouseenter="enter('-1715631339976075770');" onmouseout="out('-1715631339976075770');" style=""> 346              @RequestParam(defaultValue = &quot;&quot;) String entityType) throws Exception {                                </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 347          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 348          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 349          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                                 </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 350          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 350          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVðŸ”µ</abbr></span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style=""> 351          ppr.setAddOperationInspect(true);                                                                         </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 352          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span  style=""> 353                                                                                                                    </span>
<span class="4862894803792873117" onmouseenter="enter('4862894803792873117');" onmouseout="out('4862894803792873117');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 354 -        // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types for this entity."> 354 -        // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types for thiðŸ”µ</abbr></span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 355 +        entityType = determineEntityType(entityType, cmd);                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 356 +                                                                                                                  </span>
<span class="4098005746663533241" onmouseenter="enter('4098005746663533241');" onmouseout="out('4098005746663533241');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 357 +        EntityForm entityForm = formService.createEntityForm(cmd, sectionCrumbs);                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 358 +                                                                                                                  </span>
<span class="5826594571687596812" onmouseenter="enter('5826594571687596812');" onmouseout="out('5826594571687596812');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 359 +        // We need to make sure that the ceiling entity is set to the interface and the specific entity type      </span>
<span class="37161952125740808" onmouseenter="enter('37161952125740808');" onmouseout="out('37161952125740808');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 360 +        // is set to the type we&#x27;re going to be creating.                                                         </span>
<span class="5062735442039535924" onmouseenter="enter('5062735442039535924');" onmouseout="out('5062735442039535924');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 361 +        entityForm.setCeilingEntityClassname(cmd.getCeilingType());                                               </span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 362 +        entityForm.setEntityType(entityType);                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 363 +                                                                                                                  </span>
<span class="-5227856854691424770" onmouseenter="enter('-5227856854691424770');" onmouseout="out('-5227856854691424770');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 364 +        // When we initially build the class metadata (and thus, the entity form), we had all of the possible     </span>
<span class="5105619661852614163" onmouseenter="enter('5105619661852614163');" onmouseout="out('5105619661852614163');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 365 +        // polymorphic fields built out. Now that we have a concrete entity type to render, we can remove the     </span>
<span class="-3843175043245177501" onmouseenter="enter('-3843175043245177501');" onmouseout="out('-3843175043245177501');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 366 +        // fields that are not applicable for this given entity type.                                             </span>
<span class="-2935519954456371455" onmouseenter="enter('-2935519954456371455');" onmouseout="out('-2935519954456371455');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 367 +        formService.removeNonApplicableFields(cmd, entityForm, entityType);                                       </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 368 +                                                                                                                  </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 369 +        modifyAddEntityForm(entityForm, pathVars);                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 370 +                                                                                                                  </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 371 +        model.addAttribute(&quot;entityForm&quot;, entityForm);                                                             </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 372 +        model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 373 +                                                                                                                  </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 374 +        model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 375 +        model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 376 +        model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                              </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 377 +        setModelAttributes(model, sectionKey);                                                                    </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 378 +        return MODAL_CONTAINER_VIEW;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 379 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 380 +                                                                                                                  </span>
<span class="6822582914767657426" onmouseenter="enter('6822582914767657426');" onmouseout="out('6822582914767657426');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 381 +    // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic                  </span>
<span class="6925903770450869702" onmouseenter="enter('6925903770450869702');" onmouseout="out('6925903770450869702');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 382 +    // types for this entity.                                                                                     </span>
<span class="3096473113628081949" onmouseenter="enter('3096473113628081949');" onmouseout="out('3096473113628081949');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 383 +    protected String determineEntityType(String entityType, final ClassMetadata cmd)                              </span>
<span class="363372168864539985" onmouseenter="enter('363372168864539985');" onmouseout="out('363372168864539985');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 384 +            throws UnsupportedEncodingException {                                                                 </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style=""> 385          if (StringUtils.isBlank(entityType)) {                                                                    </span>
<span class="2333848870190395940" onmouseenter="enter('2333848870190395940');" onmouseout="out('2333848870190395940');" style=""> 386              if (cmd.getPolymorphicEntities().getChildren().length == 0) {                                         </span>
<span class="2097783908693957449" onmouseenter="enter('2097783908693957449');" onmouseout="out('2097783908693957449');" style=""> 387                  entityType = cmd.getPolymorphicEntities().getFullyQualifiedClassname();                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 388              } else {                                                                                              </span>
<span class="-6902702564943152777" onmouseenter="enter('-6902702564943152777');" onmouseout="out('-6902702564943152777');" style=""> 389                  entityType = getDefaultEntityType();                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 391          } else {                                                                                                  </span>
<span class="7843468667819793383" onmouseenter="enter('7843468667819793383');" onmouseout="out('7843468667819793383');" style=""> 392              entityType = URLDecoder.decode(entityType, &quot;UTF-8&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 393          }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 394 -                                                                                                                  </span>
<span class="4098005746663533241" onmouseenter="enter('4098005746663533241');" onmouseout="out('4098005746663533241');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 395 -        EntityForm entityForm = formService.createEntityForm(cmd, sectionCrumbs);                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 396 -                                                                                                                  </span>
<span class="5826594571687596812" onmouseenter="enter('5826594571687596812');" onmouseout="out('5826594571687596812');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 397 -        // We need to make sure that the ceiling entity is set to the interface and the specific entity type      </span>
<span class="37161952125740808" onmouseenter="enter('37161952125740808');" onmouseout="out('37161952125740808');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 398 -        // is set to the type we&#x27;re going to be creating.                                                         </span>
<span class="5062735442039535924" onmouseenter="enter('5062735442039535924');" onmouseout="out('5062735442039535924');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 399 -        entityForm.setCeilingEntityClassname(cmd.getCeilingType());                                               </span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 400 -        entityForm.setEntityType(entityType);                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 401 -                                                                                                                  </span>
<span class="-5227856854691424770" onmouseenter="enter('-5227856854691424770');" onmouseout="out('-5227856854691424770');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 402 -        // When we initially build the class metadata (and thus, the entity form), we had all of the possible     </span>
<span class="5105619661852614163" onmouseenter="enter('5105619661852614163');" onmouseout="out('5105619661852614163');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 403 -        // polymorphic fields built out. Now that we have a concrete entity type to render, we can remove the     </span>
<span class="-3843175043245177501" onmouseenter="enter('-3843175043245177501');" onmouseout="out('-3843175043245177501');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 404 -        // fields that are not applicable for this given entity type.                                             </span>
<span class="-2935519954456371455" onmouseenter="enter('-2935519954456371455');" onmouseout="out('-2935519954456371455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 405 -        formService.removeNonApplicableFields(cmd, entityForm, entityType);                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 406 -                                                                                                                  </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 407 -        modifyAddEntityForm(entityForm, pathVars);                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 408 -                                                                                                                  </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 409 -        model.addAttribute(&quot;entityForm&quot;, entityForm);                                                             </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 410 -        model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 411 -                                                                                                                  </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 412 -        model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 413 -        model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 414 -        model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                              </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 415 -        setModelAttributes(model, sectionKey);                                                                    </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 416 -        return &quot;modules/modalContainer&quot;;                                                                          </span>
<span class="2597693607778452486" onmouseenter="enter('2597693607778452486');" onmouseout="out('2597693607778452486');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 417 +        return entityType;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418      }                                                                                                             </span>
<span  style=""> 419                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 420      /**                                                                                                           </span>
<span class="-2292124409166412817" onmouseenter="enter('-2292124409166412817');" onmouseout="out('-2292124409166412817');" style=""> 421       * Processes the request to add a new entity. If successful, returns a redirect to the newly created entity.  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 422       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 423       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 424       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 425       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 426       * @param pathVars                                                                                            </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 427       * @param entityForm                                                                                          </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 428       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 429       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 430       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 431       */                                                                                                           </span>
<span class="-1840738840686664300" onmouseenter="enter('-1840738840686664300');" onmouseout="out('-1840738840686664300');" style=""> 432      @RequestMapping(value = &quot;/add&quot;, method = RequestMethod.POST)                                                  </span>
<span class="8551380442207718095" onmouseenter="enter('8551380442207718095');" onmouseout="out('8551380442207718095');" style=""> 433      public String addEntity(HttpServletRequest request, HttpServletResponse response, Model model,                </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 434              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style=""> 435              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 436          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 437          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 438          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                                 </span>
<span class="2596618104185041854" onmouseenter="enter('2596618104185041854');" onmouseout="out('2596618104185041854');" style=""><abbr title=" 439          ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 439          ClassMetadata cmd = service.getClassMetadata(getSectionPersistencePackageRequest(sectionClassName, sectionðŸ”µ</abbr></span>
<span  style=""> 440                                                                                                                    </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 441          extractDynamicFormFields(cmd, entityForm);                                                                </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 442          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 442          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCuðŸ”µ</abbr></span>
<span class="-4281879219750019053" onmouseenter="enter('-4281879219750019053');" onmouseout="out('-4281879219750019053');" style=""> 443          Entity entity = service.addEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();                </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 444          entityFormValidator.validate(entityForm, entity, result);                                                 </span>
<span  style=""> 445                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 446          if (result.hasErrors()) {                                                                                 </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 447              entityForm.clearFieldsMap();                                                                          </span>
<span class="-312181662169537666" onmouseenter="enter('-312181662169537666');" onmouseout="out('-312181662169537666');" style=""> 448              formService.populateEntityForm(cmd, entity, entityForm, sectionCrumbs);                               </span>
<span  style=""> 449                                                                                                                    </span>
<span class="254171966199148419" onmouseenter="enter('254171966199148419');" onmouseout="out('254171966199148419');" style=""> 450              formService.removeNonApplicableFields(cmd, entityForm, entityForm.getEntityType());                   </span>
<span  style=""> 451                                                                                                                    </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style=""> 452              modifyAddEntityForm(entityForm, pathVars);                                                            </span>
<span  style=""> 453                                                                                                                    </span>
<span class="-816008806055241643" onmouseenter="enter('-816008806055241643');" onmouseout="out('-816008806055241643');" style=""> 454              model.addAttribute(&quot;viewType&quot;, &quot;modal/entityAdd&quot;);                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 455              model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                 </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style=""> 456              model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                          </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style=""> 457              model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());             </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 458              setModelAttributes(model, sectionKey);                                                                </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 459 -            return &quot;modules/modalContainer&quot;;                                                                      </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 460 +            return MODAL_CONTAINER_VIEW;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461          }                                                                                                         </span>
<span  style=""> 462                                                                                                                    </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style=""> 463          // Note that AJAX Redirects need the context path prepended to them                                       </span>
<span class="-9104189425594863479" onmouseenter="enter('-9104189425594863479');" onmouseout="out('-9104189425594863479');" style=""><abbr title=" 464          return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).getValue();"> 464          return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + entity.getPMap().get(&quot;id&quot;).getValue(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 465 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 466 +                                                                                                                  </span>
<span class="1290933159858539781" onmouseenter="enter('1290933159858539781');" onmouseout="out('1290933159858539781');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 467 +    @RequestMapping(value = &quot;/{id}/duplicate&quot;, method = RequestMethod.POST)                                       </span>
<span class="-7829728733805273999" onmouseenter="enter('-7829728733805273999');" onmouseout="out('-7829728733805273999');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 468 +    public String duplicateEntity(final HttpServletRequest request,                                               </span>
<span class="277417182565607361" onmouseenter="enter('277417182565607361');" onmouseout="out('277417182565607361');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 469 +            final HttpServletResponse response,                                                                   </span>
<span class="7665770463560391322" onmouseenter="enter('7665770463560391322');" onmouseout="out('7665770463560391322');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 470 +            final Model model,                                                                                    </span>
<span class="5144416334471976319" onmouseenter="enter('5144416334471976319');" onmouseout="out('5144416334471976319');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 471 +            @PathVariable final Map&lt;String, String&gt; pathVars,                                                     </span>
<span class="5884230296910152604" onmouseenter="enter('5884230296910152604');" onmouseout="out('5884230296910152604');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 472 +            @PathVariable(value = &quot;id&quot;) final String id,                                                          </span>
<span class="5134952934925976911" onmouseenter="enter('5134952934925976911');" onmouseout="out('5134952934925976911');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 473 +            @ModelAttribute(value = &quot;entityForm&quot;) final EntityForm entityForm,                                    </span>
<span class="3593210188792847894" onmouseenter="enter('3593210188792847894');" onmouseout="out('3593210188792847894');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 474 +            final BindingResult result) throws Exception {                                                        </span>
<span class="5473402149144087547" onmouseenter="enter('5473402149144087547');" onmouseout="out('5473402149144087547');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 475 +        final String sectionKey = getSectionKey(pathVars);                                                        </span>
<span class="5437662011929987553" onmouseenter="enter('5437662011929987553');" onmouseout="out('5437662011929987553');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 476 +        final String sectionClassName = getClassNameForSection(sectionKey);                                       </span>
<span class="8553976943183535096" onmouseenter="enter('8553976943183535096');" onmouseout="out('8553976943183535096');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 477 +        final Class&lt;?&gt; entityClass = dynamicEntityDao.getImplClass(sectionClassName);                             </span>
<span class="3365797270076600425" onmouseenter="enter('3365797270076600425');" onmouseout="out('3365797270076600425');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 478 +        final long identifier = Long.parseLong(id);                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 479 +                                                                                                                  </span>
<span class="-138107922525045121" onmouseenter="enter('-138107922525045121');" onmouseout="out('-138107922525045121');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 480 +        if (duplicator.validate(entityClass, identifier)) {                                                       </span>
<span class="5493542447860389431" onmouseenter="enter('5493542447860389431');" onmouseout="out('5493542447860389431');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 481 +            final Object duplicate;                                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 482 +                                                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 483 +            try {                                                                                                 </span>
<span class="-2283233085854885260" onmouseenter="enter('-2283233085854885260');" onmouseout="out('-2283233085854885260');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 484 +                duplicate = duplicator.copy(entityClass, identifier);                                             </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 485 +            } catch (Exception e) {                                                                               </span>
<span class="-8850460393574909327" onmouseenter="enter('-8850460393574909327');" onmouseout="out('-8850460393574909327');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 486 +                LOG.error(&quot;Could not duplicate entity&quot;, e);                                                       </span>
<span class="-7503880796159563304" onmouseenter="enter('-7503880796159563304');" onmouseout="out('-7503880796159563304');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 487 +                return getErrorDuplicatingResponse(response, &quot;Duplication_Failure&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 488 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 489 +                                                                                                                  </span>
<span class="9202899875978069713" onmouseenter="enter('9202899875978069713');" onmouseout="out('9202899875978069713');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 490 +            final Serializable dupId = genericEntityService.getIdentifier(duplicate);                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 491 +                                                                                                                  </span>
<span class="7931002159447649906" onmouseenter="enter('7931002159447649906');" onmouseout="out('7931002159447649906');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 492 +            // Note that AJAX Redirects need the context path prepended to them                                   </span>
<span class="6804960621276438337" onmouseenter="enter('6804960621276438337');" onmouseout="out('6804960621276438337');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 493 +            return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;/&quot; + dupId;                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 494 +        } else {                                                                                                  </span>
<span class="-110948502599545681" onmouseenter="enter('-110948502599545681');" onmouseout="out('-110948502599545681');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 495 +            return getErrorDuplicatingResponse(response, &quot;Validation_Failure&quot;);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 496 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 497 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 498 +                                                                                                                  </span>
<span class="-106656131545478097" onmouseenter="enter('-106656131545478097');" onmouseout="out('-106656131545478097');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 499 +    protected String getErrorDuplicatingResponse(HttpServletResponse response, String code) {                     </span>
<span class="7659712838923572459" onmouseenter="enter('7659712838923572459');" onmouseout="out('7659712838923572459');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 500 +        List&lt;Map&lt;String, Object&gt;&gt; errors = new ArrayList&lt;&gt;();                                                     </span>
<span class="-6240695079450735253" onmouseenter="enter('-6240695079450735253');" onmouseout="out('-6240695079450735253');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 501 +        String message;                                                                                           </span>
<span class="-7826420477706002406" onmouseenter="enter('-7826420477706002406');" onmouseout="out('-7826420477706002406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 502 +        BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();                   </span>
<span class="-2727648393614728" onmouseenter="enter('-2727648393614728');" onmouseout="out('-2727648393614728');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 503 +        if (context != null &amp;&amp; context.getMessageSource() != null) {                                              </span>
<span class="-5978418614812499702" onmouseenter="enter('-5978418614812499702');" onmouseout="out('-5978418614812499702');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 504 +            message = context.getMessageSource()                                                                  </span>
<span class="1624598595284946587" onmouseenter="enter('1624598595284946587');" onmouseout="out('1624598595284946587');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 505 +                    .getMessage(code, null, code, context.getJavaLocale());                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 506 +        } else {                                                                                                  </span>
<span class="-9004243737964586892" onmouseenter="enter('-9004243737964586892');" onmouseout="out('-9004243737964586892');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 507 +            LOG.warn(                                                                                             </span>
<span class="6269614064328325287" onmouseenter="enter('6269614064328325287');" onmouseout="out('6269614064328325287');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 508 +                    &quot;Could not find the MessageSource on the current request, &quot;                                   </span>
<span class="-8208830135626721740" onmouseenter="enter('-8208830135626721740');" onmouseout="out('-8208830135626721740');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 509 +                            + &quot;not translating the message key&quot;);                                                 </span>
<span class="599114272120646428" onmouseenter="enter('599114272120646428');" onmouseout="out('599114272120646428');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 510 +            message = &quot;Duplication_Failure&quot;;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 511 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 512 +                                                                                                                  </span>
<span class="-4703377271641004207" onmouseenter="enter('-4703377271641004207');" onmouseout="out('-4703377271641004207');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 513 +        Map&lt;String, Object&gt; errorMap = new HashMap&lt;&gt;();                                                           </span>
<span class="2851590661979449603" onmouseenter="enter('2851590661979449603');" onmouseout="out('2851590661979449603');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 514 +        errorMap.put(&quot;errorType&quot;, &quot;global&quot;);                                                                      </span>
<span class="4738760182182965590" onmouseenter="enter('4738760182182965590');" onmouseout="out('4738760182182965590');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 515 +        errorMap.put(&quot;code&quot;, code);                                                                               </span>
<span class="7426718838785534996" onmouseenter="enter('7426718838785534996');" onmouseout="out('7426718838785534996');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 516 +        errorMap.put(&quot;message&quot;, message);                                                                         </span>
<span class="-4906289066975989946" onmouseenter="enter('-4906289066975989946');" onmouseout="out('-4906289066975989946');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 517 +        errors.add(errorMap);                                                                                     </span>
<span class="-8734340547513070222" onmouseenter="enter('-8734340547513070222');" onmouseout="out('-8734340547513070222');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 518 +        return new JsonResponse(response).with(&quot;errors&quot;, errors).done();                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519      }                                                                                                             </span>
<span  style=""> 520                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 521      /**                                                                                                           </span>
<span class="9102199281013466170" onmouseenter="enter('9102199281013466170');" onmouseout="out('9102199281013466170');" style=""> 522       * Renders the main entity form for the specified entity                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 523       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 524       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 525       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 526       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 527       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 528       * @param id                                                                                                  </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 529       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 530       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 531       */                                                                                                           </span>
<span class="7083955269921705584" onmouseenter="enter('7083955269921705584');" onmouseout="out('7083955269921705584');" style=""> 532      @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.GET)                                                  </span>
<span class="-4309552397998806559" onmouseenter="enter('-4309552397998806559');" onmouseout="out('-4309552397998806559');" style=""> 533      public String viewEntityForm(HttpServletRequest request, HttpServletResponse response, Model model,           </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 534              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="-2194094146044801021" onmouseenter="enter('-2194094146044801021');" onmouseout="out('-2194094146044801021');" style=""> 535              @PathVariable(&quot;id&quot;) String id) throws Exception {                                                     </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 536          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 537          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 538          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                                    </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""> 539          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);  </span>
<span  style=""> 540                                                                                                                    </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 541          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="-8780243800866475465" onmouseenter="enter('-8780243800866475465');" onmouseout="out('-8780243800866475465');" style=""> 542          Entity entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];             </span>
<span  style=""> 543                                                                                                                    </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""> 544          Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);  </span>
<span  style=""> 545                                                                                                                    </span>
<span class="872584542219399793" onmouseenter="enter('872584542219399793');" onmouseout="out('872584542219399793');" style=""> 546          EntityForm entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);                 </span>
<span  style=""> 547                                                                                                                    </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 548 -        if (isAddRequest(entity)) {                                                                               </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 549 -            modifyAddEntityForm(entityForm, pathVars);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 550 -        } else {                                                                                                  </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 551 -            modifyEntityForm(entityForm, pathVars);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 552 -        }                                                                                                         </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 553 +        modifyEntityForm(entity, entityForm, pathVars);                                                           </span>
<span  style=""> 554                                                                                                                    </span>
<span class="1981952247030149381" onmouseenter="enter('1981952247030149381');" onmouseout="out('1981952247030149381');" style=""> 555          if (request.getParameter(&quot;headerFlash&quot;) != null) {                                                        </span>
<span class="-2367607735703612103" onmouseenter="enter('-2367607735703612103');" onmouseout="out('-2367607735703612103');" style=""> 556              model.addAttribute(&quot;headerFlash&quot;, request.getParameter(&quot;headerFlash&quot;));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 557          }                                                                                                         </span>
<span  style=""> 558                                                                                                                    </span>
<span class="-6569554975283424126" onmouseenter="enter('-6569554975283424126');" onmouseout="out('-6569554975283424126');" style=""> 559          // Set the sectionKey again incase this is a typed entity                                                 </span>
<span class="4201932972037321722" onmouseenter="enter('4201932972037321722');" onmouseout="out('4201932972037321722');" style=""> 560          entityForm.setSectionKey(sectionKey);                                                                     </span>
<span  style=""> 561                                                                                                                    </span>
<span class="5387752430767952558" onmouseenter="enter('5387752430767952558');" onmouseout="out('5387752430767952558');" style=""> 562          // Build the current url in the cast that this is a typed entity                                          </span>
<span class="3856485652570637824" onmouseenter="enter('3856485652570637824');" onmouseout="out('3856485652570637824');" style=""> 563          String originatingUri = new UrlPathHelper().getOriginatingRequestUri(request);                            </span>
<span class="-1728408616530607173" onmouseenter="enter('-1728408616530607173');" onmouseout="out('-1728408616530607173');" style=""> 564          int startIndex = request.getContextPath().length();                                                       </span>
<span  style=""> 565                                                                                                                    </span>
<span class="654052499558570629" onmouseenter="enter('654052499558570629');" onmouseout="out('654052499558570629');" style=""> 566          // Remove the context path from servlet path                                                              </span>
<span class="526107488063217153" onmouseenter="enter('526107488063217153');" onmouseout="out('526107488063217153');" style=""> 567          String currentUrl = originatingUri.substring(startIndex);                                                 </span>
<span  style=""> 568                                                                                                                    </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 569          model.addAttribute(&quot;entity&quot;, entity);                                                                     </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 570          model.addAttribute(&quot;entityForm&quot;, entityForm);                                                             </span>
<span class="-4977411250845897884" onmouseenter="enter('-4977411250845897884');" onmouseout="out('-4977411250845897884');" style=""> 571          model.addAttribute(&quot;currentUrl&quot;, currentUrl);                                                             </span>
<span  style=""> 572                                                                                                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 573          setModelAttributes(model, sectionKey);                                                                    </span>
<span  style=""> 574                                                                                                                    </span>
<span class="8236570979651257825" onmouseenter="enter('8236570979651257825');" onmouseout="out('8236570979651257825');" style=""> 575          // We want to replace author ids with their names                                                         </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style=""> 576          addAuditableDisplayFields(entityForm);                                                                    </span>
<span  style=""> 577                                                                                                                    </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 578 -        if (isAjaxRequest(request)) {                                                                             </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 579 -            entityForm.setReadOnly();                                                                             </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 580 -            model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                                   </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 581 -            model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                         </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 582 -            return &quot;modules/modalContainer&quot;;                                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 583 -        } else {                                                                                                  </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 584 -            model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                            </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 585 -            model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                         </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 586 -            return &quot;modules/defaultContainer&quot;;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 587 -        }                                                                                                         </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 588 +        return resolveAppropriateEntityView(request, model, entityForm);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589      }                                                                                                             </span>
<span  style=""> 590                                                                                                                    </span>
<span class="9182660926479189949" onmouseenter="enter('9182660926479189949');" onmouseout="out('9182660926479189949');" style=""><abbr title=" 591      protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, String&gt; pathVars,"> 591      protected Map&lt;String, DynamicResultSet&gt; getViewSubRecords(HttpServletRequest request, Map&lt;String, String&gt; pathðŸ”µ</abbr></span>
<span class="4477928710658117231" onmouseenter="enter('4477928710658117231');" onmouseout="out('4477928710658117231');" style=""> 592                                                                ClassMetadata cmd, Entity entity,                   </span>
<span class="5660295431162582196" onmouseenter="enter('5660295431162582196');" onmouseout="out('5660295431162582196');" style=""> 593                                                                List&lt;SectionCrumb&gt; crumbs) throws Exception {       </span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style=""> 594          String tabName = pathVars.get(&quot;tabName&quot;);                                                                 </span>
<span class="5384642555226517985" onmouseenter="enter('5384642555226517985');" onmouseout="out('5384642555226517985');" style=""> 595          if (StringUtils.isEmpty(tabName)) {                                                                       </span>
<span class="-3672533750283461484" onmouseenter="enter('-3672533750283461484');" onmouseout="out('-3672533750283461484');" style=""> 596              tabName = cmd.getFirstTab() == null ? &quot;General&quot; : cmd.getFirstTab().getTabName();                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597          }                                                                                                         </span>
<span class="-5882478663361935855" onmouseenter="enter('-5882478663361935855');" onmouseout="out('-5882478663361935855');" style=""> 598          return service.getRecordsForSelectedTab(cmd, entity, crumbs, tabName);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 599      }                                                                                                             </span>
<span  style=""> 600                                                                                                                    </span>
<span class="1953795048205106952" onmouseenter="enter('1953795048205106952');" onmouseout="out('1953795048205106952');" style=""> 601      private boolean isAddRequest(Entity entity) {                                                                 </span>
<span class="-2989581670667655563" onmouseenter="enter('-2989581670667655563');" onmouseout="out('-2989581670667655563');" style=""> 602          ExtensionResultHolder&lt;Boolean&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                              </span>
<span class="2773544387861748911" onmouseenter="enter('2773544387861748911');" onmouseout="out('2773544387861748911');" style=""> 603          ExtensionResultStatusType result = extensionManager.getProxy().isAddRequest(entity, resultHolder);        </span>
<span class="8622638495597819717" onmouseenter="enter('8622638495597819717');" onmouseout="out('8622638495597819717');" style=""> 604          if (result.equals(ExtensionResultStatusType.NOT_HANDLED)) {                                               </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 605              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 606          }                                                                                                         </span>
<span  style=""> 607                                                                                                                    </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 608          return resultHolder.getResult();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 609      }                                                                                                             </span>
<span  style=""> 610                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 611      /**                                                                                                           </span>
<span class="-4864218972040039628" onmouseenter="enter('-4864218972040039628');" onmouseout="out('-4864218972040039628');" style=""> 612       * Attempts to get the List Grid for the selected tab.                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 613       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 614       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 615       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 616       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 617       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 618       * @param id                                                                                                  </span>
<span class="4841027518362301903" onmouseenter="enter('4841027518362301903');" onmouseout="out('4841027518362301903');" style=""> 619       * @param tabName                                                                                             </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 620       * @param entityForm                                                                                          </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style=""> 621       * @param entity                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 622       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 623       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 624       */                                                                                                           </span>
<span class="-7675092144868804288" onmouseenter="enter('-7675092144868804288');" onmouseout="out('-7675092144868804288');" style=""> 625      @RequestMapping(value = &quot;/{id}/{tab:[0-9]+}/{tabName}&quot;, method = RequestMethod.POST)                          </span>
<span class="-2248541185927650044" onmouseenter="enter('-2248541185927650044');" onmouseout="out('-2248541185927650044');" style=""> 626      public String viewEntityTab(HttpServletRequest request, HttpServletResponse response, Model model,            </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 627              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 628              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="2259450910520289810" onmouseenter="enter('2259450910520289810');" onmouseout="out('2259450910520289810');" style=""> 629              @PathVariable(value = &quot;tabName&quot;) String tabName,                                                      </span>
<span class="2754607649135651414" onmouseenter="enter('2754607649135651414');" onmouseout="out('2754607649135651414');" style=""> 630              @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm,                                          </span>
<span class="-2950467864443381399" onmouseenter="enter('-2950467864443381399');" onmouseout="out('-2950467864443381399');" style=""> 631              @ModelAttribute(value = &quot;entity&quot;) Entity entity) throws Exception {                                   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 632          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 633          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-4536538478423353936" onmouseenter="enter('-4536538478423353936');" onmouseout="out('-4536538478423353936');" style=""> 634          List&lt;SectionCrumb&gt; crumbs = getSectionCrumbs(request, sectionKey, id);                                    </span>
<span class="7448677779013604849" onmouseenter="enter('7448677779013604849');" onmouseout="out('7448677779013604849');" style=""> 635          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, crumbs, pathVars);  </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 636          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 637          entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];                    </span>
<span class="-1542864321304829050" onmouseenter="enter('-1542864321304829050');" onmouseout="out('-1542864321304829050');" style=""> 638          Map&lt;String, DynamicResultSet&gt; subRecordsMap = getViewSubRecords(request, pathVars, cmd, entity, crumbs);  </span>
<span class="-3846048132763499568" onmouseenter="enter('-3846048132763499568');" onmouseout="out('-3846048132763499568');" style=""> 639          entityForm = formService.createEntityForm(cmd, entity, subRecordsMap, crumbs);                            </span>
<span  style=""> 640                                                                                                                    </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 641 -        if (isAddRequest(entity)) {                                                                               </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 642 -            modifyAddEntityForm(entityForm, pathVars);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 643 -        } else {                                                                                                  </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 644 -            modifyEntityForm(entityForm, pathVars);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 645 -        }                                                                                                         </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 646 +        modifyEntityForm(entity, entityForm, pathVars);                                                           </span>
<span  style=""> 647                                                                                                                    </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 648          model.addAttribute(&quot;entity&quot;, entity);                                                                     </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style=""> 649          model.addAttribute(&quot;entityForm&quot;, entityForm);                                                             </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 650          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span  style=""> 651                                                                                                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 652          setModelAttributes(model, sectionKey);                                                                    </span>
<span  style=""> 653                                                                                                                    </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style=""> 654          model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                                </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style=""> 655          model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                             </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 656 -        return &quot;modules/defaultContainer&quot;;                                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 657 +                                                                                                                  </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 658 +        return DEFAULT_CONTAINER_VIEW;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659      }                                                                                                             </span>
<span  style=""> 660                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 661      /**                                                                                                           </span>
<span class="26428616724277901" onmouseenter="enter('26428616724277901');" onmouseout="out('26428616724277901');" style=""> 662       * Builds JSON that looks like this:                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 663       *                                                                                                            </span>
<span class="-619170819873097874" onmouseenter="enter('-619170819873097874');" onmouseout="out('-619170819873097874');" style=""> 664       * {&quot;errors&quot;:                                                                                                 </span>
<span class="-7867797149207986089" onmouseenter="enter('-7867797149207986089');" onmouseout="out('-7867797149207986089');" style=""> 665       *      [{&quot;message&quot;:&quot;This field is Required&quot;,                                                                 </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 666       *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                                 </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 667       *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                         </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 668       *        &quot;errorType&quot;, &quot;field&quot;,                                                                               </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 669       *        &quot;tab&quot;: &quot;General&quot;                                                                                    </span>
<span class="762081609125064039" onmouseenter="enter('762081609125064039');" onmouseout="out('762081609125064039');" style=""> 670       *        },                                                                                                  </span>
<span class="2065208195238134241" onmouseenter="enter('2065208195238134241');" onmouseout="out('2065208195238134241');" style=""> 671       *        {&quot;message&quot;:&quot;This field is Required&quot;,                                                                </span>
<span class="5571013926509347967" onmouseenter="enter('5571013926509347967');" onmouseout="out('5571013926509347967');" style=""> 672       *        &quot;code&quot;: &quot;requiredValidationFailure&quot;                                                                 </span>
<span class="2193225165471793404" onmouseenter="enter('2193225165471793404');" onmouseout="out('2193225165471793404');" style=""> 673       *        &quot;field&quot;:&quot;defaultSku--name&quot;,                                                                         </span>
<span class="-292030086071489485" onmouseenter="enter('-292030086071489485');" onmouseout="out('-292030086071489485');" style=""> 674       *        &quot;errorType&quot;, &quot;field&quot;,                                                                               </span>
<span class="-614892938232592574" onmouseenter="enter('-614892938232592574');" onmouseout="out('-614892938232592574');" style=""> 675       *        &quot;tab&quot;: &quot;General&quot;                                                                                    </span>
<span class="-832778532632947969" onmouseenter="enter('-832778532632947969');" onmouseout="out('-832778532632947969');" style=""> 676       *        }]                                                                                                  </span>
<span class="8941010846014250828" onmouseenter="enter('8941010846014250828');" onmouseout="out('8941010846014250828');" style=""> 677       * }                                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 678       *                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 679       */                                                                                                           </span>
<span class="726178843151373675" onmouseenter="enter('726178843151373675');" onmouseout="out('726178843151373675');" style=""> 680      @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST, produces = &quot;application/json&quot;)                  </span>
<span class="-4245682307765667372" onmouseenter="enter('-4245682307765667372');" onmouseout="out('-4245682307765667372');" style=""> 681      public String saveEntityJson(HttpServletRequest request, HttpServletResponse response, Model model,           </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style=""> 682              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style=""> 683              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="-5165411007609652701" onmouseenter="enter('-5165411007609652701');" onmouseout="out('-5165411007609652701');" style=""> 684              @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm, BindingResult result,                    </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 685              RedirectAttributes ra) throws Exception {                                                             </span>
<span  style=""> 686                                                                                                                    </span>
<span class="-7049584637685461961" onmouseenter="enter('-7049584637685461961');" onmouseout="out('-7049584637685461961');" style=""> 687          saveEntity(request, response, model, pathVars, id, entityForm, result, ra);                               </span>
<span  style=""> 688                                                                                                                    </span>
<span class="2770382331963423086" onmouseenter="enter('2770382331963423086');" onmouseout="out('2770382331963423086');" style=""> 689          JsonResponse json = new JsonResponse(response);                                                           </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 690          if (result.hasErrors()) {                                                                                 </span>
<span class="6668101882629849049" onmouseenter="enter('6668101882629849049');" onmouseout="out('6668101882629849049');" style=""> 691              populateJsonValidationErrors(entityForm, result, json);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 692          }                                                                                                         </span>
<span class="-8719030961107019295" onmouseenter="enter('-8719030961107019295');" onmouseout="out('-8719030961107019295');" style=""> 693          List&lt;String&gt; dirtyList = buildDirtyList(pathVars, request, id);                                           </span>
<span class="-2397478597494600131" onmouseenter="enter('-2397478597494600131');" onmouseout="out('-2397478597494600131');" style=""> 694          if (CollectionUtils.isNotEmpty(dirtyList)) {                                                              </span>
<span class="-6863151800017638945" onmouseenter="enter('-6863151800017638945');" onmouseout="out('-6863151800017638945');" style=""> 695              json.with(&quot;dirty&quot;, dirtyList);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 696          }                                                                                                         </span>
<span  style=""> 697                                                                                                                    </span>
<span class="1148846903613025505" onmouseenter="enter('1148846903613025505');" onmouseout="out('1148846903613025505');" style=""> 698          ExtensionResultHolder&lt;String&gt; resultHolder = new ExtensionResultHolder&lt;&gt;();                               </span>
<span class="772761850497532920" onmouseenter="enter('772761850497532920');" onmouseout="out('772761850497532920');" style=""><abbr title=" 699          ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonResponse(response, result.hasErrors(), getSectionKey(pathVars), id, resultHolder);"> 699          ExtensionResultStatusType resultStatusType = extensionManager.getProxy().overrideSaveEntityJsonResponse(reðŸ”µ</abbr></span>
<span class="-7225919658162387284" onmouseenter="enter('-7225919658162387284');" onmouseout="out('-7225919658162387284');" style=""> 700          if (resultStatusType.equals(ExtensionResultStatusType.HANDLED)) {                                         </span>
<span class="2335728720915807395" onmouseenter="enter('2335728720915807395');" onmouseout="out('2335728720915807395');" style=""> 701              return resultHolder.getResult();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702          }                                                                                                         </span>
<span  style=""> 703                                                                                                                    </span>
<span class="-3901811907821215875" onmouseenter="enter('-3901811907821215875');" onmouseout="out('-3901811907821215875');" style=""> 704          return json.done();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 705      }                                                                                                             </span>
<span  style=""> 706                                                                                                                    </span>
<span class="-2624067384280123527" onmouseenter="enter('-2624067384280123527');" onmouseout="out('-2624067384280123527');" style=""><abbr title=" 707      public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String id) throws ServiceException {"> 707      public List&lt;String&gt; buildDirtyList(Map&lt;String, String&gt; pathVars, HttpServletRequest request, String id) throwsðŸ”µ</abbr></span>
<span class="-6199220983064020273" onmouseenter="enter('-6199220983064020273');" onmouseout="out('-6199220983064020273');" style=""> 708          List&lt;String&gt; dirtyList = new ArrayList&lt;&gt;();                                                               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 709          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 710          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 711          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 712          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 712          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVðŸ”µ</abbr></span>
<span class="-6293964121119142853" onmouseenter="enter('-6293964121119142853');" onmouseout="out('-6293964121119142853');" style=""> 713          ClassMetadata cmd = null;                                                                                 </span>
<span class="-6100049554794336383" onmouseenter="enter('-6100049554794336383');" onmouseout="out('-6100049554794336383');" style=""> 714          Entity entity = null;                                                                                     </span>
<span class="-7221558264805358950" onmouseenter="enter('-7221558264805358950');" onmouseout="out('-7221558264805358950');" style=""> 715          cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();                             </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 716          entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];                    </span>
<span  style=""> 717                                                                                                                    </span>
<span class="-538034338216639378" onmouseenter="enter('-538034338216639378');" onmouseout="out('-538034338216639378');" style=""> 718          for (Property p: entity.getProperties()) {                                                                </span>
<span class="-5586383415891827802" onmouseenter="enter('-5586383415891827802');" onmouseout="out('-5586383415891827802');" style=""> 719              if (p.getIsDirty()) {                                                                                 </span>
<span class="-1571805809811752662" onmouseenter="enter('-1571805809811752662');" onmouseout="out('-1571805809811752662');" style=""> 720                  dirtyList.add(p.getName());                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 721              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 722          }                                                                                                         </span>
<span class="7211627429904225799" onmouseenter="enter('7211627429904225799');" onmouseout="out('7211627429904225799');" style=""> 723          return dirtyList;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724      }                                                                                                             </span>
<span  style=""> 725                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 726      /**                                                                                                           </span>
<span class="-1912365624495655250" onmouseenter="enter('-1912365624495655250');" onmouseout="out('-1912365624495655250');" style=""> 727       * Attempts to save the given entity. If validation is unsuccessful, it will re-render the entity form with   </span>
<span class="3378821078357952120" onmouseenter="enter('3378821078357952120');" onmouseout="out('3378821078357952120');" style=""> 728       * error fields highlighted. On a successful save, it will refresh the entity page.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 729       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 730       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 731       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 732       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 733       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 734       * @param id                                                                                                  </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style=""> 735       * @param entityForm                                                                                          </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style=""> 736       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 737       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 738       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 739       */                                                                                                           </span>
<span class="681227659796054179" onmouseenter="enter('681227659796054179');" onmouseout="out('681227659796054179');" style=""> 740      @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.POST)                                                 </span>
<span class="2696827203115285075" onmouseenter="enter('2696827203115285075');" onmouseout="out('2696827203115285075');" style=""> 741      public String saveEntity(HttpServletRequest request, HttpServletResponse response, Model model,               </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 742              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 743              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 744              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,                      </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 745              RedirectAttributes ra) throws Exception {                                                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 746          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 747          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 748          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 749          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 749          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 750          ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();               </span>
<span  style=""> 751                                                                                                                    </span>
<span class="-4959046161090402131" onmouseenter="enter('-4959046161090402131');" onmouseout="out('-4959046161090402131');" style=""> 752          extractDynamicFormFields(cmd, entityForm);                                                                </span>
<span  style=""> 753                                                                                                                    </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 754          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 754          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCuðŸ”µ</abbr></span>
<span class="-4517703585527939334" onmouseenter="enter('-4517703585527939334');" onmouseout="out('-4517703585527939334');" style=""> 755          Entity entity = service.updateEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();             </span>
<span  style=""> 756                                                                                                                    </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 757          entityFormValidator.validate(entityForm, entity, result);                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 758 +                                                                                                                  </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 759          if (result.hasErrors()) {                                                                                 </span>
<span class="-9083492279253959347" onmouseenter="enter('-9083492279253959347');" onmouseout="out('-9083492279253959347');" style=""> 760              model.addAttribute(&quot;headerFlash&quot;, &quot;save.unsuccessful&quot;);                                               </span>
<span class="-3255113992478543295" onmouseenter="enter('-3255113992478543295');" onmouseout="out('-3255113992478543295');" style=""> 761              model.addAttribute(&quot;headerFlashAlert&quot;, true);                                                         </span>
<span  style=""> 762                                                                                                                    </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 763              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 763              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 764              entityForm.clearFieldsMap();                                                                          </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 765              formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);                </span>
<span  style=""> 766                                                                                                                    </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 767 -            if (isAddRequest(entity)) {                                                                           </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 768 -                modifyAddEntityForm(entityForm, pathVars);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 769 -            } else {                                                                                              </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 770 -                modifyEntityForm(entityForm, pathVars);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 771 -            }                                                                                                     </span>
<span class="1451551715319124344" onmouseenter="enter('1451551715319124344');" onmouseout="out('1451551715319124344');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 772 +            modifyEntityForm(entity, entityForm, pathVars);                                                       </span>
<span  style=""> 773                                                                                                                    </span>
<span class="-8005063546895619069" onmouseenter="enter('-8005063546895619069');" onmouseout="out('-8005063546895619069');" style=""> 774              model.addAttribute(&quot;entity&quot;, entity);                                                                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style=""> 775              model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                 </span>
<span  style=""> 776                                                                                                                    </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style=""> 777              setModelAttributes(model, sectionKey);                                                                </span>
<span  style=""> 778                                                                                                                    </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 779 -            if (isAjaxRequest(request)) {                                                                         </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 780 -                entityForm.setReadOnly();                                                                         </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 781 -                model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                               </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 782 -                model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                     </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 783 -                return &quot;modules/modalContainer&quot;;                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 784 -            } else {                                                                                              </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 785 -                model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                        </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 786 -                model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                     </span>
<span class="-8888412066156990741" onmouseenter="enter('-8888412066156990741');" onmouseout="out('-8888412066156990741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 787 -                return &quot;modules/defaultContainer&quot;;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 788 -            }                                                                                                     </span>
<span class="858139107025117803" onmouseenter="enter('858139107025117803');" onmouseout="out('858139107025117803');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 789 +            return resolveAppropriateEntityView(request, model, entityForm);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 790          }                                                                                                         </span>
<span  style=""> 791                                                                                                                    </span>
<span class="-8977665602521560288" onmouseenter="enter('-8977665602521560288');" onmouseout="out('-8977665602521560288');" style=""> 792          ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;save.successful&quot;);                                                   </span>
<span  style=""> 793                                                                                                                    </span>
<span class="5326436654777975784" onmouseenter="enter('5326436654777975784');" onmouseout="out('5326436654777975784');" style=""> 794          return &quot;redirect:/&quot; + sectionKey + &quot;/&quot; + id;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 795 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 796 +                                                                                                                  </span>
<span class="-1036069149620696687" onmouseenter="enter('-1036069149620696687');" onmouseout="out('-1036069149620696687');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 797 +    protected void modifyEntityForm(final Entity entity, final EntityForm entityForm,                             </span>
<span class="-2182671422299427893" onmouseenter="enter('-2182671422299427893');" onmouseout="out('-2182671422299427893');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 798 +            final Map&lt;String, String&gt; pathVars) throws Exception {                                                </span>
<span class="866690756091128541" onmouseenter="enter('866690756091128541');" onmouseout="out('866690756091128541');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 799 +        if (isAddRequest(entity)) {                                                                               </span>
<span class="-9055696754430154144" onmouseenter="enter('-9055696754430154144');" onmouseout="out('-9055696754430154144');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 800 +            modifyAddEntityForm(entityForm, pathVars);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 801 +        } else {                                                                                                  </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 802 +            modifyEntityForm(entityForm, pathVars);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 803 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 804 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 805 +                                                                                                                  </span>
<span class="7327611436230860688" onmouseenter="enter('7327611436230860688');" onmouseout="out('7327611436230860688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 806 +    protected String resolveAppropriateEntityView(final HttpServletRequest request,                               </span>
<span class="7665770463560391322" onmouseenter="enter('7665770463560391322');" onmouseout="out('7665770463560391322');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 807 +            final Model model,                                                                                    </span>
<span class="6537819747648345888" onmouseenter="enter('6537819747648345888');" onmouseout="out('6537819747648345888');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 808 +            final @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) {                                  </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 809 +        if (isAjaxRequest(request)) {                                                                             </span>
<span class="7356620202531041753" onmouseenter="enter('7356620202531041753');" onmouseout="out('7356620202531041753');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 810 +            entityForm.setReadOnly();                                                                             </span>
<span class="5332308135205776861" onmouseenter="enter('5332308135205776861');" onmouseout="out('5332308135205776861');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 811 +            model.addAttribute(&quot;viewType&quot;, &quot;modal/entityView&quot;);                                                   </span>
<span class="4999052042157491707" onmouseenter="enter('4999052042157491707');" onmouseout="out('4999052042157491707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 812 +            model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.VIEW_ENTITY.getType());                         </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 813 +            return MODAL_CONTAINER_VIEW;                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 814 +        } else {                                                                                                  </span>
<span class="-9186208801255720147" onmouseenter="enter('-9186208801255720147');" onmouseout="out('-9186208801255720147');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 815 +            model.addAttribute(&quot;useAjaxUpdate&quot;, true);                                                            </span>
<span class="-4186728612395086803" onmouseenter="enter('-4186728612395086803');" onmouseout="out('-4186728612395086803');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 816 +            model.addAttribute(&quot;viewType&quot;, &quot;entityEdit&quot;);                                                         </span>
<span class="-4487883013655706388" onmouseenter="enter('-4487883013655706388');" onmouseout="out('-4487883013655706388');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 817 +            return DEFAULT_CONTAINER_VIEW;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 818 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 819      }                                                                                                             </span>
<span  style=""> 820                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 821      /**                                                                                                           </span>
<span class="4876253458579857532" onmouseenter="enter('4876253458579857532');" onmouseout="out('4876253458579857532');" style=""> 822       * Attempts to remove the given entity.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 823       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 824       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 825       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 826       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 827       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 828       * @param id                                                                                                  </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 829       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 830       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 831       */                                                                                                           </span>
<span class="8293921381301703428" onmouseenter="enter('8293921381301703428');" onmouseout="out('8293921381301703428');" style=""> 832      @RequestMapping(value = &quot;/{id}/delete&quot;, method = RequestMethod.POST)                                          </span>
<span class="2313354717081876463" onmouseenter="enter('2313354717081876463');" onmouseout="out('2313354717081876463');" style=""> 833      public String removeEntity(HttpServletRequest request, HttpServletResponse response, Model model,             </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 834              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 835              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="-4070161356240747615" onmouseenter="enter('-4070161356240747615');" onmouseout="out('-4070161356240747615');" style=""> 836              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result,                      </span>
<span class="-8377204068919013534" onmouseenter="enter('-8377204068919013534');" onmouseout="out('-8377204068919013534');" style=""> 837              RedirectAttributes ra) throws Exception {                                                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 838          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 839          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 840          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span  style=""> 841                                                                                                                    </span>
<span class="8924350377579193296" onmouseenter="enter('8924350377579193296');" onmouseout="out('8924350377579193296');" style=""><abbr title=" 842          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCustomCriteria());"> 842          String[] sectionCriteria = customCriteriaService.mergeSectionCustomCriteria(sectionClassName, getSectionCuðŸ”µ</abbr></span>
<span class="6624819200143935214" onmouseenter="enter('6624819200143935214');" onmouseout="out('6624819200143935214');" style=""> 843          Entity entity = service.removeEntity(entityForm, sectionCriteria, sectionCrumbs).getEntity();             </span>
<span class="-6561774320633688873" onmouseenter="enter('-6561774320633688873');" onmouseout="out('-6561774320633688873');" style=""> 844          // Removal does not normally return an Entity unless there is some validation error                       </span>
<span class="-2807113977407494827" onmouseenter="enter('-2807113977407494827');" onmouseout="out('-2807113977407494827');" style=""> 845          if (entity != null) {                                                                                     </span>
<span class="6387591393977647956" onmouseenter="enter('6387591393977647956');" onmouseout="out('6387591393977647956');" style=""> 846              entityFormValidator.validate(entityForm, entity, result);                                             </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style=""> 847              if (result.hasErrors()) {                                                                             </span>
<span class="354313568014337940" onmouseenter="enter('354313568014337940');" onmouseout="out('354313568014337940');" style=""> 848                  // Create a flash attribute for the unsuccessful delete                                           </span>
<span class="-3408473788799892596" onmouseenter="enter('-3408473788799892596');" onmouseout="out('-3408473788799892596');" style=""> 849                  FlashMap fm = new FlashMap();                                                                     </span>
<span class="-3785724779356953427" onmouseenter="enter('-3785724779356953427');" onmouseout="out('-3785724779356953427');" style=""> 850                  fm.put(&quot;headerFlash&quot;, &quot;delete.unsuccessful&quot;);                                                     </span>
<span class="2000410372434500283" onmouseenter="enter('2000410372434500283');" onmouseout="out('2000410372434500283');" style=""> 851                  fm.put(&quot;headerFlashAlert&quot;, true);                                                                 </span>
<span class="-216272657842661141" onmouseenter="enter('-216272657842661141');" onmouseout="out('-216272657842661141');" style=""> 852                  request.setAttribute(DispatcherServlet.OUTPUT_FLASH_MAP_ATTRIBUTE, fm);                           </span>
<span  style=""> 853                                                                                                                    </span>
<span class="-9154666565283892619" onmouseenter="enter('-9154666565283892619');" onmouseout="out('-9154666565283892619');" style=""> 854                  // Re-look back up the entity so that we can return something populated                           </span>
<span class="4282540080013759409" onmouseenter="enter('4282540080013759409');" onmouseout="out('4282540080013759409');" style=""><abbr title=" 855                  PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbs, pathVars);"> 855                  PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, sectionCrumbðŸ”µ</abbr></span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style=""> 856                  ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();       </span>
<span class="-8733438670030443717" onmouseenter="enter('-8733438670030443717');" onmouseout="out('-8733438670030443717');" style=""> 857                  entity = service.getRecord(ppr, id, cmd, false).getDynamicResultSet().getRecords()[0];            </span>
<span class="-1751195764969422173" onmouseenter="enter('-1751195764969422173');" onmouseout="out('-1751195764969422173');" style=""><abbr title=" 858                  Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, sectionCrumbs);"> 858                  Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForAllSubCollections(ppr, entity, ðŸ”µ</abbr></span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style=""> 859                  entityForm.clearFieldsMap();                                                                      </span>
<span class="3638724345026879346" onmouseenter="enter('3638724345026879346');" onmouseout="out('3638724345026879346');" style=""> 860                  formService.populateEntityForm(cmd, entity, subRecordsMap, entityForm, sectionCrumbs);            </span>
<span class="-1918535871427094882" onmouseenter="enter('-1918535871427094882');" onmouseout="out('-1918535871427094882');" style=""> 861                  modifyEntityForm(entityForm, pathVars);                                                           </span>
<span  style=""> 862                                                                                                                    </span>
<span class="-1358530666837283115" onmouseenter="enter('-1358530666837283115');" onmouseout="out('-1358530666837283115');" style=""> 863                  return populateJsonValidationErrors(entityForm, result, new JsonResponse(response))               </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style=""> 864                          .done();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 865              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 866          }                                                                                                         </span>
<span  style=""> 867                                                                                                                    </span>
<span class="3611526951082120901" onmouseenter="enter('3611526951082120901');" onmouseout="out('3611526951082120901');" style=""> 868          ra.addFlashAttribute(&quot;headerFlash&quot;, &quot;delete.successful&quot;);                                                 </span>
<span class="2579818068351246488" onmouseenter="enter('2579818068351246488');" onmouseout="out('2579818068351246488');" style=""> 869          ra.addFlashAttribute(&quot;headerFlashAlert&quot;, true);                                                           </span>
<span  style=""> 870                                                                                                                    </span>
<span class="1916110883796229758" onmouseenter="enter('1916110883796229758');" onmouseout="out('1916110883796229758');" style=""> 871          if (isAjaxRequest(request)) {                                                                             </span>
<span class="-5684384949344822714" onmouseenter="enter('-5684384949344822714');" onmouseout="out('-5684384949344822714');" style=""> 872              // redirect attributes won&#x27;t work here since ajaxredirect actually makes a new request                </span>
<span class="-9107475529968351628" onmouseenter="enter('-9107475529968351628');" onmouseout="out('-9107475529968351628');" style=""> 873              return &quot;ajaxredirect:&quot; + getContextPath(request) + sectionKey + &quot;?headerFlash=delete.successful&quot;;     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 874          } else {                                                                                                  </span>
<span class="4357427724598824699" onmouseenter="enter('4357427724598824699');" onmouseout="out('4357427724598824699');" style=""> 875              return &quot;redirect:/&quot; + sectionKey;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 876          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 877      }                                                                                                             </span>
<span  style=""> 878                                                                                                                    </span>
<span class="-2983794507366563158" onmouseenter="enter('-2983794507366563158');" onmouseout="out('-2983794507366563158');" style=""> 879      @RequestMapping(value = &quot;/{collectionField:.*}/details&quot;, method = RequestMethod.GET)                          </span>
<span class="-527911248282232950" onmouseenter="enter('-527911248282232950');" onmouseout="out('-527911248282232950');" style=""><abbr title=" 880      public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpServletResponse response, Model model,"> 880      public @ResponseBody Map&lt;String, String&gt; getCollectionValueDetails(HttpServletRequest request, HttpServletRespðŸ”µ</abbr></span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 881              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 882              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-5250072335910309101" onmouseenter="enter('-5250072335910309101');" onmouseout="out('-5250072335910309101');" style=""> 883              @RequestParam String ids,                                                                             </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style=""> 884              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 885          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="1649393097671814093" onmouseenter="enter('1649393097671814093');" onmouseout="out('1649393097671814093');" style=""> 886          String sectionClassName = getClassNameForSection(sectionKey);                                             </span>
<span class="4646131203125045792" onmouseenter="enter('4646131203125045792');" onmouseout="out('4646131203125045792');" style=""> 887          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, null, null);                                 </span>
<span class="-5225610456611199616" onmouseenter="enter('-5225610456611199616');" onmouseout="out('-5225610456611199616');" style=""><abbr title=" 888          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, sectionCrumbs, pathVars);"> 888          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(sectionClassName, requestParams, sectiðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""> 889          ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 890          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style=""> 891          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style=""> 892                                                                                                                    </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style=""> 893          ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                          </span>
<span class="-2120492003233088270" onmouseenter="enter('-2120492003233088270');" onmouseout="out('-2120492003233088270');" style=""> 894          ppr.setStartIndex(getStartIndex(requestParams));                                                          </span>
<span class="2736790979641523309" onmouseenter="enter('2736790979641523309');" onmouseout="out('2736790979641523309');" style=""> 895          ppr.setMaxIndex(getMaxIndex(requestParams));                                                              </span>
<span  style=""> 896                                                                                                                    </span>
<span class="-8000769512056204294" onmouseenter="enter('-8000769512056204294');" onmouseout="out('-8000769512056204294');" style=""> 897          if (md instanceof BasicFieldMetadata) {                                                                   </span>
<span class="-1954892043355765019" onmouseenter="enter('-1954892043355765019');" onmouseout="out('-1954892043355765019');" style=""> 898              String idProp = ((BasicFieldMetadata) md).getForeignKeyProperty();                                    </span>
<span class="6288096257758990604" onmouseenter="enter('6288096257758990604');" onmouseout="out('6288096257758990604');" style=""> 899              String displayProp = ((BasicFieldMetadata) md).getForeignKeyDisplayValueProperty();                   </span>
<span  style=""> 900                                                                                                                    </span>
<span class="-6477100624593005266" onmouseenter="enter('-6477100624593005266');" onmouseout="out('-6477100624593005266');" style=""> 901              List&lt;String&gt; filterValues = BLCArrayUtils.asList(ids.split(FILTER_VALUE_SEPARATOR_REGEX));            </span>
<span class="3640259021720155935" onmouseenter="enter('3640259021720155935');" onmouseout="out('3640259021720155935');" style=""> 902              ppr.addFilterAndSortCriteria(new FilterAndSortCriteria(idProp, filterValues));                        </span>
<span  style=""> 903                                                                                                                    </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style=""> 904              DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                                 </span>
<span class="-2768740094948248396" onmouseenter="enter('-2768740094948248396');" onmouseout="out('-2768740094948248396');" style=""> 905              Map&lt;String, String&gt; returnMap = new HashMap&lt;&gt;();                                                      </span>
<span  style=""> 906                                                                                                                    </span>
<span class="-5517026699518874938" onmouseenter="enter('-5517026699518874938');" onmouseout="out('-5517026699518874938');" style=""> 907              for (Entity e : drs.getRecords()) {                                                                   </span>
<span class="4979367110517822568" onmouseenter="enter('4979367110517822568');" onmouseout="out('4979367110517822568');" style=""> 908                  String id = e.getPMap().get(idProp).getValue();                                                   </span>
<span class="-4946347213336092877" onmouseenter="enter('-4946347213336092877');" onmouseout="out('-4946347213336092877');" style=""> 909                  String disp = e.getPMap().get(displayProp).getDisplayValue();                                     </span>
<span  style=""> 910                                                                                                                    </span>
<span class="3483982845402449596" onmouseenter="enter('3483982845402449596');" onmouseout="out('3483982845402449596');" style=""> 911                  if (StringUtils.isBlank(disp)) {                                                                  </span>
<span class="-2027181132953179584" onmouseenter="enter('-2027181132953179584');" onmouseout="out('-2027181132953179584');" style=""> 912                      disp = e.getPMap().get(displayProp).getValue();                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 913                  }                                                                                                 </span>
<span  style=""> 914                                                                                                                    </span>
<span class="-1075893121428940879" onmouseenter="enter('-1075893121428940879');" onmouseout="out('-1075893121428940879');" style=""> 915                  returnMap.put(id,  disp);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 916              }                                                                                                     </span>
<span  style=""> 917                                                                                                                    </span>
<span class="9157811424862351106" onmouseenter="enter('9157811424862351106');" onmouseout="out('9157811424862351106');" style=""> 918              return returnMap;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 919          }                                                                                                         </span>
<span  style=""> 920                                                                                                                    </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 921          return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 922      }                                                                                                             </span>
<span  style=""> 923                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 924      /**                                                                                                           </span>
<span class="7896529828316523089" onmouseenter="enter('7896529828316523089');" onmouseout="out('7896529828316523089');" style=""><abbr title=" 925       * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a list of products"> 925       * Shows the modal popup for the current selected &quot;to-one&quot; field. For instance, if you are viewing a list of pðŸ”µ</abbr></span>
<span class="8702245574166025616" onmouseenter="enter('8702245574166025616');" onmouseout="out('8702245574166025616');" style=""> 926       * then this method is invoked when a user clicks on the name of the default category field.                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 927       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 928       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 929       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 930       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 931       * @param pathVars                                                                                            </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 932       * @param collectionField                                                                                     </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style=""> 933       * @param id                                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 934       * @return                                                                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 935       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 936       */                                                                                                           </span>
<span class="1405910210670150204" onmouseenter="enter('1405910210670150204');" onmouseout="out('1405910210670150204');" style=""> 937      @RequestMapping(value = &quot;/{collectionField:.*}/{id}/view&quot;, method = RequestMethod.GET)                        </span>
<span class="-5496524556428427140" onmouseenter="enter('-5496524556428427140');" onmouseout="out('-5496524556428427140');" style=""> 938      public String viewCollectionItemDetails(HttpServletRequest request, HttpServletResponse response, Model model,</span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 939              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 940              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-1857511616350008386" onmouseenter="enter('-1857511616350008386');" onmouseout="out('-1857511616350008386');" style=""> 941              @PathVariable(value=&quot;id&quot;) String id) throws Exception {                                               </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 942          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 943          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 944          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title=" 945          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();"> 945          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 946          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="2157347470680130722" onmouseenter="enter('2157347470680130722');" onmouseout="out('2157347470680130722');" style=""> 947          BasicFieldMetadata md = (BasicFieldMetadata) collectionProperty.getMetadata();                            </span>
<span  style=""> 948                                                                                                                    </span>
<span class="-1856968160831305726" onmouseenter="enter('-1856968160831305726');" onmouseout="out('-1856968160831305726');" style=""><abbr title=" 949          AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeyClass(), sectionKey);"> 949          AdminSection section = adminNavigationService.findAdminSectionByClassAndSectionId(md.getForeignKeyClass(),ðŸ”µ</abbr></span>
<span class="-151095669048618305" onmouseenter="enter('-151095669048618305');" onmouseout="out('-151095669048618305');" style=""><abbr title=" 950          String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : section.getUrl();"> 950          String sectionUrlKey = (section.getUrl().startsWith(&quot;/&quot;)) ? section.getUrl().substring(1) : section.getUrlðŸ”µ</abbr></span>
<span class="4949862081138664893" onmouseenter="enter('4949862081138664893');" onmouseout="out('4949862081138664893');" style=""> 951          Map&lt;String, String&gt; varsForField = new HashMap&lt;&gt;();                                                       </span>
<span class="-4429965231898090358" onmouseenter="enter('-4429965231898090358');" onmouseout="out('-4429965231898090358');" style=""> 952          varsForField.put(&quot;sectionKey&quot;, sectionUrlKey);                                                            </span>
<span class="4805235980730638518" onmouseenter="enter('4805235980730638518');" onmouseout="out('4805235980730638518');" style=""> 953          return viewEntityForm(request, response, model, varsForField, id);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 954      }                                                                                                             </span>
<span  style=""> 955                                                                                                                    </span>
<span class="2731983140361230349" onmouseenter="enter('2731983140361230349');" onmouseout="out('2731983140361230349');" style=""> 956      @RequestMapping(                                                                                              </span>
<span class="4528666449367390600" onmouseenter="enter('4528666449367390600');" onmouseout="out('4528666449367390600');" style=""> 957              value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{tab:[0-9]+}/{tabName}&quot;,                       </span>
<span class="7470628324060602258" onmouseenter="enter('7470628324060602258');" onmouseout="out('7470628324060602258');" style=""> 958              method = RequestMethod.POST                                                                           </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 959      )                                                                                                             </span>
<span class="1786222500639285262" onmouseenter="enter('1786222500639285262');" onmouseout="out('1786222500639285262');" style=""> 960      public String viewCollectionItemTab(HttpServletRequest request, HttpServletResponse response, Model model,    </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 961                                          @PathVariable  Map&lt;String, String&gt; pathVars,                              </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 962                                          @PathVariable(value=&quot;id&quot;) String id,                                      </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 963                                          @PathVariable(value=&quot;collectionField&quot;) String collectionField,            </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style=""> 964                                          @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,          </span>
<span class="1347902176383833481" onmouseenter="enter('1347902176383833481');" onmouseout="out('1347902176383833481');" style=""> 965                                          @PathVariable(value=&quot;tabName&quot;) String tabName,                            </span>
<span class="-2122907702415237135" onmouseenter="enter('-2122907702415237135');" onmouseout="out('-2122907702415237135');" style=""><abbr title=" 966                                          @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throws Exception {"> 966                                          @ModelAttribute(value = &quot;entityForm&quot;) EntityForm entityForm) throws ExceptðŸ”µ</abbr></span>
<span  style=""> 967                                                                                                                    </span>
<span class="2284268618604436814" onmouseenter="enter('2284268618604436814');" onmouseout="out('2284268618604436814');" style=""><abbr title=" 968          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ModalHeaderType.VIEW_COLLECTION_ITEM.getType(), entityForm, null);"> 968          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, ModalHeadðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 969      }                                                                                                             </span>
<span  style=""> 970                                                                                                                    </span>
<span  style=""> 971                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 972      /**                                                                                                           </span>
<span class="1274042523848442367" onmouseenter="enter('1274042523848442367');" onmouseout="out('1274042523848442367');" style=""> 973       * Returns the records for a given collectionField filtered by a particular criteria                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 974       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style=""> 975       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style=""> 976       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style=""> 977       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style=""> 978       * @param pathVars                                                                                            </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style=""> 979       * @param collectionField                                                                                     </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style=""> 980       * @param requestParams                                                                                       </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style=""> 981       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 982       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 983       */                                                                                                           </span>
<span class="-4095443548484775059" onmouseenter="enter('-4095443548484775059');" onmouseout="out('-4095443548484775059');" style=""> 984      @RequestMapping(value = &quot;/{id}/{collectionField:.*}&quot;, method = RequestMethod.GET)                             </span>
<span class="-5889287394210369546" onmouseenter="enter('-5889287394210369546');" onmouseout="out('-5889287394210369546');" style=""> 985      public String getCollectionFieldRecords(HttpServletRequest request, HttpServletResponse response, Model model,</span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style=""> 986              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style=""> 987              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style=""> 988              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="3465670919255037355" onmouseenter="enter('3465670919255037355');" onmouseout="out('3465670919255037355');" style=""> 989              @RequestParam  MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                        </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style=""> 990          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style=""> 991          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style=""> 992          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-6545915569490985196" onmouseenter="enter('-6545915569490985196');" onmouseout="out('-6545915569490985196');" style=""><abbr title=" 993          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams, sectionCrumbs, pathVars);"> 993          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, requestParams, sectionCðŸ”µ</abbr></span>
<span class="-7085294426206085681" onmouseenter="enter('-7085294426206085681');" onmouseout="out('-7085294426206085681');" style=""> 994          ClassMetadata mainMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();      </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style=""> 995          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style=""> 996                                                                                                                    </span>
<span class="-3734134243620930531" onmouseenter="enter('-3734134243620930531');" onmouseout="out('-3734134243620930531');" style=""> 997          ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);                        </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style=""> 998          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style=""> 999                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1000          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="-8440278474384944243" onmouseenter="enter('-8440278474384944243');" onmouseout="out('-8440278474384944243');" style=""><abbr title="1001          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParams, sectionKey, sectionCrumbs);">1001          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, requestParams, sectionðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1002          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span  style="">1003                                                                                                                    </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style="">1004          model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));                </span>
<span  style="">1005                                                                                                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1006          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1007          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1008          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1009      }                                                                                                             </span>
<span  style="">1010                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1011      /**                                                                                                           </span>
<span class="-2279175998905644242" onmouseenter="enter('-2279175998905644242');" onmouseout="out('-2279175998905644242');" style=""><abbr title="1012       * Shows the modal dialog that is used to add an item to a given collection. There are several possible outcomes">1012       * Shows the modal dialog that is used to add an item to a given collection. There are several possible outcomðŸ”µ</abbr></span>
<span class="-3490572548815062734" onmouseenter="enter('-3490572548815062734');" onmouseout="out('-3490572548815062734');" style="">1013       * of this call depending on the type of the specified collection field.                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1014       *                                                                                                            </span>
<span class="2717555647352622731" onmouseenter="enter('2717555647352622731');" onmouseout="out('2717555647352622731');" style="">1015       * &lt;ul&gt;                                                                                                       </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style="">1016       *  &lt;li&gt;                                                                                                      </span>
<span class="4930235181592711719" onmouseenter="enter('4930235181592711719');" onmouseout="out('4930235181592711719');" style=""><abbr title="1017       *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so that the user may">1017       *    &lt;b&gt;Basic Collection (Persist)&lt;/b&gt; - Renders a blank form for the specified target entity so that the useðŸ”µ</abbr></span>
<span class="-3142080293607523336" onmouseenter="enter('-3142080293607523336');" onmouseout="out('-3142080293607523336');" style=""><abbr title="1018       *    enter information and associate the record with this collection. Used by fields such as ProductAttribute.">1018       *    enter information and associate the record with this collection. Used by fields such as ProductAttributeðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style="">1019       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style="">1020       *  &lt;li&gt;                                                                                                      </span>
<span class="6319691685860667757" onmouseenter="enter('6319691685860667757');" onmouseout="out('6319691685860667757');" style=""><abbr title="1021       *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and select it.">1021       *    &lt;b&gt;Basic Collection (Lookup)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and seðŸ”µ</abbr></span>
<span class="-8731186021492741581" onmouseenter="enter('-8731186021492741581');" onmouseout="out('-8731186021492741581');" style="">1022       *    Used by fields such as &quot;allParentCategories&quot;.                                                           </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style="">1023       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style="">1024       *  &lt;li&gt;                                                                                                      </span>
<span class="-6847404578833725914" onmouseenter="enter('-6847404578833725914');" onmouseout="out('-6847404578833725914');" style=""><abbr title="1025       *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and">1025       *    &lt;b&gt;Adorned Collection (without form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entitðŸ”µ</abbr></span>
<span class="568361472595397074" onmouseenter="enter('568361472595397074');" onmouseout="out('568361472595397074');" style=""><abbr title="1026       *    select it. The view rendered by this is identical to basic collection (lookup), but will perform the operation">1026       *    select it. The view rendered by this is identical to basic collection (lookup), but will perform the opeðŸ”µ</abbr></span>
<span class="-4048066359856567222" onmouseenter="enter('-4048066359856567222');" onmouseout="out('-4048066359856567222');" style=""><abbr title="1027       *    on an adorned field, which may carry extra meta-information about the created relationship, such as order.">1027       *    on an adorned field, which may carry extra meta-information about the created relationship, such as ordeðŸ”µ</abbr></span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style="">1028       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style="">1029       *  &lt;li&gt;                                                                                                      </span>
<span class="7355096557601214207" onmouseenter="enter('7355096557601214207');" onmouseout="out('7355096557601214207');" style=""><abbr title="1030       *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity and">1030       *    &lt;b&gt;Adorned Collection (with form)&lt;/b&gt; - Renders a list grid that allows the user to click on an entity aðŸ”µ</abbr></span>
<span class="-146713903552295440" onmouseenter="enter('-146713903552295440');" onmouseout="out('-146713903552295440');" style=""><abbr title="1031       *    select it. Once the user selects the entity, he will be presented with an empty form based on the specified">1031       *    select it. Once the user selects the entity, he will be presented with an empty form based on the specifðŸ”µ</abbr></span>
<span class="7585671366133275820" onmouseenter="enter('7585671366133275820');" onmouseout="out('7585671366133275820');" style=""><abbr title="1032       *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, which in addition">1032       *    &quot;maintainedAdornedTargetFields&quot; for this field. Used by fields such as &quot;crossSellProducts&quot;, which in addðŸ”µ</abbr></span>
<span class="7350312284882119043" onmouseenter="enter('7350312284882119043');" onmouseout="out('7350312284882119043');" style="">1033       *    to linking an entity, provide extra fields, such as a promotional message.                              </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style="">1034       *  &lt;/li&gt;                                                                                                     </span>
<span class="3706201315693353419" onmouseenter="enter('3706201315693353419');" onmouseout="out('3706201315693353419');" style="">1035       *  &lt;li&gt;                                                                                                      </span>
<span class="8829232354049589291" onmouseenter="enter('8829232354049589291');" onmouseout="out('8829232354049589291');" style=""><abbr title="1036       *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. This field is">1036       *    &lt;b&gt;Map Collection&lt;/b&gt; - Renders a form for the target entity that has an additional key field. This fielðŸ”µ</abbr></span>
<span class="-8508051731153769866" onmouseenter="enter('-8508051731153769866');" onmouseout="out('-8508051731153769866');" style=""><abbr title="1037       *    populated either from the configured map keys, or as a result of a lookup in the case of a key based on another">1037       *    populated either from the configured map keys, or as a result of a lookup in the case of a key based on ðŸ”µ</abbr></span>
<span class="-6056737616128420156" onmouseenter="enter('-6056737616128420156');" onmouseout="out('-6056737616128420156');" style="">1038       *    entity. Used by fields such as the mediaMap on a Sku.                                                   </span>
<span class="229435711692215518" onmouseenter="enter('229435711692215518');" onmouseout="out('229435711692215518');" style="">1039       *  &lt;/li&gt;                                                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1040       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1041       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1042       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1043       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1044       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1045       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1046       * @param collectionField                                                                                     </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style="">1047       * @param requestParams                                                                                       </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1048       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1049       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1050       */                                                                                                           </span>
<span class="835275592837580694" onmouseenter="enter('835275592837580694');" onmouseout="out('835275592837580694');" style="">1051      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.GET)                         </span>
<span class="2460266594736272943" onmouseenter="enter('2460266594736272943');" onmouseout="out('2460266594736272943');" style="">1052      public String showAddCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,    </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1053              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style="">1054              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style="">1055              @PathVariable(value = &quot;collectionField&quot;) String collectionField,                                      </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style="">1056              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1057          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1058          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1059          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style="">1060          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,  </span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style="">1061                  sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                               </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1062          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1063          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style="">1064                                                                                                                    </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style="">1065          PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)                 </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style="">1066                  .withFilterAndSortCriteria(getCriteria(requestParams))                                            </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style="">1067                  .withStartIndex(getStartIndex(requestParams))                                                     </span>
<span class="4786121744461484155" onmouseenter="enter('4786121744461484155');" onmouseout="out('4786121744461484155');" style="">1068                  .withMaxIndex(getMaxIndex(requestParams))                                                         </span>
<span class="2941692162045974129" onmouseenter="enter('2941692162045974129');" onmouseout="out('2941692162045974129');" style="">1069                  .withLastId(getLastId(requestParams))                                                             </span>
<span class="-9137331061893195290" onmouseenter="enter('-9137331061893195290');" onmouseout="out('-9137331061893195290');" style="">1070                  .withFirstId(getFirstId(requestParams))                                                           </span>
<span class="-6497878492174321892" onmouseenter="enter('-6497878492174321892');" onmouseout="out('-6497878492174321892');" style="">1071                  .withUpperCount(getUpperCount(requestParams))                                                     </span>
<span class="-8373154769706308503" onmouseenter="enter('-8373154769706308503');" onmouseout="out('-8373154769706308503');" style="">1072                  .withLowerCount(getLowerCount(requestParams))                                                     </span>
<span class="-1051723743320189375" onmouseenter="enter('-1051723743320189375');" onmouseout="out('-1051723743320189375');" style="">1073                  .withPageSize(getPageSize(requestParams))                                                         </span>
<span class="-6582704259903712752" onmouseenter="enter('-6582704259903712752');" onmouseout="out('-6582704259903712752');" style="">1074                  .withPresentationFetch(true);                                                                     </span>
<span  style="">1075                                                                                                                    </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style="">1076          if (md instanceof BasicCollectionMetadata) {                                                              </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1077              BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                           </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style="">1078              if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                           </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style="">1079                  ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();       </span>
<span class="-2914433993330253670" onmouseenter="enter('-2914433993330253670');" onmouseout="out('-2914433993330253670');" style="">1080                  // If the entity type isn&#x27;t specified, we need to determine if there are various polymorphic types</span>
<span class="-7795450821592681641" onmouseenter="enter('-7795450821592681641');" onmouseout="out('-7795450821592681641');" style="">1081                  // for this entity.                                                                               </span>
<span class="6186895968667433501" onmouseenter="enter('6186895968667433501');" onmouseout="out('6186895968667433501');" style="">1082                  String entityType = null;                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1083 +                                                                                                                  </span>
<span class="3580632700461537732" onmouseenter="enter('3580632700461537732');" onmouseout="out('3580632700461537732');" style="">1084                  if (requestParams.containsKey(&quot;entityType&quot;)) {                                                    </span>
<span class="-1630371572733568969" onmouseenter="enter('-1630371572733568969');" onmouseout="out('-1630371572733568969');" style="">1085                      entityType = requestParams.get(&quot;entityType&quot;).get(0);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1086                  }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1087 +                                                                                                                  </span>
<span class="2600422776092116832" onmouseenter="enter('2600422776092116832');" onmouseout="out('2600422776092116832');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1088 +                entityType = determineEntityType(entityType, cmd);                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1089 +                                                                                                                  </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style="">1090                  if (StringUtils.isBlank(entityType)) {                                                            </span>
<span class="2333848870190395940" onmouseenter="enter('2333848870190395940');" onmouseout="out('2333848870190395940');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1091 -                    if (cmd.getPolymorphicEntities().getChildren().length == 0) {                                 </span>
<span class="2097783908693957449" onmouseenter="enter('2097783908693957449');" onmouseout="out('2097783908693957449');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1092 -                        entityType = cmd.getPolymorphicEntities().getFullyQualifiedClassname();                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1093 -                    } else {                                                                                      </span>
<span class="-6902702564943152777" onmouseenter="enter('-6902702564943152777');" onmouseout="out('-6902702564943152777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1094 -                        entityType = getDefaultEntityType();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1095 -                    }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1096 -                } else {                                                                                          </span>
<span class="7843468667819793383" onmouseenter="enter('7843468667819793383');" onmouseout="out('7843468667819793383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1097 -                    entityType = URLDecoder.decode(entityType, &quot;UTF-8&quot;);                                          </span>
<span class="679217737668422196" onmouseenter="enter('679217737668422196');" onmouseout="out('679217737668422196');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1098 +                    return getModalForBlankEntityType(request, model, sectionKey, cmd);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1099                  }                                                                                                 </span>
<span  style="">1100                                                                                                                    </span>
<span class="4772034882902081020" onmouseenter="enter('4772034882902081020');" onmouseout="out('4772034882902081020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1101 -                if (StringUtils.isBlank(entityType)) {                                                            </span>
<span class="-5632901614715850082" onmouseenter="enter('-5632901614715850082');" onmouseout="out('-5632901614715850082');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1102 -                    List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1103 -                    model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                               </span>
<span class="-7344898891916261334" onmouseenter="enter('-7344898891916261334');" onmouseout="out('-7344898891916261334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1104 -                    model.addAttribute(&quot;viewType&quot;, &quot;modal/entityTypeSelection&quot;);                                  </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1105 -                    model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());     </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1106 -                    String requestUri = request.getRequestURI();                                                  </span>
<span class="2670437920401576748" onmouseenter="enter('2670437920401576748');" onmouseout="out('2670437920401576748');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="1107 -                    if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) {">1107 -                    if (!request.getContextPath().equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(request.getContextPath())) ðŸ”µ</abbr></span>
<span class="-901741071381030126" onmouseenter="enter('-901741071381030126');" onmouseout="out('-901741071381030126');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="1108 -                        requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.length());">1108 -                        requestUri = requestUri.substring(request.getContextPath().length() + 1, requestUri.lengthðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1109 -                    }                                                                                             </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1110 -                    model.addAttribute(&quot;currentUri&quot;, requestUri);                                                 </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1111 -                    model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                  </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1112 -                    setModelAttributes(model, sectionKey);                                                        </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1113 -                    return &quot;modules/modalContainer&quot;;                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1114 -                } else {                                                                                          </span>
<span class="-58316621888079189" onmouseenter="enter('-58316621888079189');" onmouseout="out('-58316621888079189');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1115 -                    ppr = ppr.withCeilingEntityClassname(entityType);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1116 -                }                                                                                                 </span>
<span class="-58316621888079189" onmouseenter="enter('-58316621888079189');" onmouseout="out('-58316621888079189');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1117 +                ppr = ppr.withCeilingEntityClassname(entityType);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1118              }                                                                                                     </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1119          } else if (md instanceof MapMetadata) {                                                                   </span>
<span class="-8815560953057448419" onmouseenter="enter('-8815560953057448419');" onmouseout="out('-8815560953057448419');" style=""><abbr title="1120              ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(request,response,model,sectionKey,id,requestParams,(MapMetadata) md);">1120              ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(requestðŸ”µ</abbr></span>
<span class="6674469997589527714" onmouseenter="enter('6674469997589527714');" onmouseout="out('6674469997589527714');" style="">1121              if (result.equals(ExtensionResultStatusType.HANDLED)) {                                               </span>
<span class="1057476267973220454" onmouseenter="enter('1057476267973220454');" onmouseout="out('1057476267973220454');" style="">1122                  model.addAttribute(&quot;entityId&quot;, id);                                                               </span>
<span class="6720161805434028669" onmouseenter="enter('6720161805434028669');" onmouseout="out('6720161805434028669');" style="">1123                  model.addAttribute(&quot;sectionKey&quot;, sectionKey);                                                     </span>
<span class="-2435595331613687341" onmouseenter="enter('-2435595331613687341');" onmouseout="out('-2435595331613687341');" style="">1124                  model.addAttribute(&quot;collectionField&quot;, collectionField);                                           </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1125 -                return &quot;modules/modalContainer&quot;;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1126 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1127 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1128 -                                                                                                                  </span>
<span class="3903557829936589355" onmouseenter="enter('3903557829936589355');" onmouseout="out('3903557829936589355');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1129 -        //service.getContextSpecificRelationshipId(mainMetadata, entity, prefix);                                 </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1130 +                return MODAL_CONTAINER_VIEW;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1131 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1132 +        }                                                                                                         </span>
<span  style="">1133                                                                                                                    </span>
<span class="6576809561193708131" onmouseenter="enter('6576809561193708131');" onmouseout="out('6576809561193708131');" style="">1134          model.addAttribute(&quot;currentParams&quot;, new ObjectMapper().writeValueAsString(requestParams));                </span>
<span  style="">1135                                                                                                                    </span>
<span class="6180232744784249160" onmouseenter="enter('6180232744784249160');" onmouseout="out('6180232744784249160');" style=""><abbr title="1136          return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty, md, ppr, null, null);">1136          return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionPrðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1137 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1138 +                                                                                                                  </span>
<span class="-2220429573703069666" onmouseenter="enter('-2220429573703069666');" onmouseout="out('-2220429573703069666');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1139 +    protected String getModalForBlankEntityType(final HttpServletRequest request,                                 </span>
<span class="-5263780204247815298" onmouseenter="enter('-5263780204247815298');" onmouseout="out('-5263780204247815298');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1140 +            final Model model, final String sectionKey, final ClassMetadata cmd) {                                </span>
<span class="-2316979209506989336" onmouseenter="enter('-2316979209506989336');" onmouseout="out('-2316979209506989336');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1141 +        final List&lt;ClassTree&gt; entityTypes = getAddEntityTypes(cmd.getPolymorphicEntities());                      </span>
<span class="-1786762136943638870" onmouseenter="enter('-1786762136943638870');" onmouseout="out('-1786762136943638870');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1142 +        model.addAttribute(&quot;entityTypes&quot;, entityTypes);                                                           </span>
<span class="-7344898891916261334" onmouseenter="enter('-7344898891916261334');" onmouseout="out('-7344898891916261334');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1143 +        model.addAttribute(&quot;viewType&quot;, &quot;modal/entityTypeSelection&quot;);                                              </span>
<span class="4114307546969826358" onmouseenter="enter('4114307546969826358');" onmouseout="out('4114307546969826358');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1144 +        model.addAttribute(&quot;entityFriendlyName&quot;, cmd.getPolymorphicEntities().getFriendlyName());                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1145 +                                                                                                                  </span>
<span class="-2813713255221264789" onmouseenter="enter('-2813713255221264789');" onmouseout="out('-2813713255221264789');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1146 +        String requestUri = request.getRequestURI();                                                              </span>
<span class="3126054482386392887" onmouseenter="enter('3126054482386392887');" onmouseout="out('3126054482386392887');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1147 +        final String contextPath = request.getContextPath();                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1148 +                                                                                                                  </span>
<span class="1413502326105343009" onmouseenter="enter('1413502326105343009');" onmouseout="out('1413502326105343009');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1149 +        if (!contextPath.equals(&quot;/&quot;) &amp;&amp; requestUri.startsWith(contextPath)) {                                     </span>
<span class="-5812874762785975576" onmouseenter="enter('-5812874762785975576');" onmouseout="out('-5812874762785975576');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1150 +            requestUri = requestUri.substring(contextPath.length() + 1, requestUri.length());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1151 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1152 +                                                                                                                  </span>
<span class="-4266558034071691802" onmouseenter="enter('-4266558034071691802');" onmouseout="out('-4266558034071691802');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1153 +        model.addAttribute(&quot;currentUri&quot;, requestUri);                                                             </span>
<span class="-7253477283405475092" onmouseenter="enter('-7253477283405475092');" onmouseout="out('-7253477283405475092');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1154 +        model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_ENTITY.getType());                              </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1155 +        setModelAttributes(model, sectionKey);                                                                    </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1156 +                                                                                                                  </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1157 +        return MODAL_CONTAINER_VIEW;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1158      }                                                                                                             </span>
<span  style="">1159                                                                                                                    </span>
<span class="373770933822047642" onmouseenter="enter('373770933822047642');" onmouseout="out('373770933822047642');" style=""><abbr title="1160      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMethod.POST)">1160      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add/{collectionItemId}/verify&quot;, method = RequestMethod.POSðŸ”µ</abbr></span>
<span class="-870509305261572147" onmouseenter="enter('-870509305261572147');" onmouseout="out('-870509305261572147');" style=""><abbr title="1161      public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1161      public @ResponseBody Map&lt;String, Object&gt; addCollectionItem(HttpServletRequest request, HttpServletResponse resðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1162              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1163              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1164              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1165              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1166          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1167          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1168          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1169          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1169          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1170          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1171          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1172          Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                        </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1173          if (md instanceof AdornedTargetCollectionMetadata) {                                                      </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title="1174              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,">1174              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassNaðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style="">1175                      collectionField,                                                                              </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style="">1176                      collectionItemId, responseMap);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1177          }                                                                                                         </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1178          return responseMap;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1179      }                                                                                                             </span>
<span  style="">1180                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1181      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1182       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1183       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1184       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1185       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1186       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1187       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1188       * @param collectionField                                                                                     </span>
<span class="-3886153901014472312" onmouseenter="enter('-3886153901014472312');" onmouseout="out('-3886153901014472312');" style="">1189       * @param requestParams                                                                                       </span>
<span class="-4008047975326689228" onmouseenter="enter('-4008047975326689228');" onmouseout="out('-4008047975326689228');" style="">1190       * @return Json collection data                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1191       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1192       */                                                                                                           </span>
<span class="1491507797785399205" onmouseenter="enter('1491507797785399205');" onmouseout="out('1491507797785399205');" style="">1193      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize&quot;, method = RequestMethod.GET)                   </span>
<span class="3394871197523978831" onmouseenter="enter('3394871197523978831');" onmouseout="out('3394871197523978831');" style=""><abbr title="1194      public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletResponse response, Model model,">1194      public @ResponseBody Map&lt;String, Object&gt; getSelectizeCollectionOptions(HttpServletRequest request, HttpServletðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1195              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="7801446570851981981" onmouseenter="enter('7801446570851981981');" onmouseout="out('7801446570851981981');" style="">1196              @PathVariable(value = &quot;id&quot;) String id,                                                                </span>
<span class="4713833916830794200" onmouseenter="enter('4713833916830794200');" onmouseout="out('4713833916830794200');" style="">1197              @PathVariable(value = &quot;collectionField&quot;) String collectionField,                                      </span>
<span class="-2945988258914821593" onmouseenter="enter('-2945988258914821593');" onmouseout="out('-2945988258914821593');" style="">1198              @RequestParam MultiValueMap&lt;String, String&gt; requestParams) throws Exception {                         </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1199          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1200          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1201          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-3489429610696180181" onmouseenter="enter('-3489429610696180181');" onmouseout="out('-3489429610696180181');" style="">1202          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName,  </span>
<span class="3509078744615154166" onmouseenter="enter('3509078744615154166');" onmouseout="out('3509078744615154166');" style="">1203                  sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();                               </span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1204          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1205          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style="">1206                                                                                                                    </span>
<span class="-3154651088293222897" onmouseenter="enter('-3154651088293222897');" onmouseout="out('-3154651088293222897');" style="">1207          PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs)                 </span>
<span class="-6426257397240599496" onmouseenter="enter('-6426257397240599496');" onmouseout="out('-6426257397240599496');" style="">1208                  .withFilterAndSortCriteria(getCriteria(requestParams))                                            </span>
<span class="2108540405732330992" onmouseenter="enter('2108540405732330992');" onmouseout="out('2108540405732330992');" style="">1209                  .withStartIndex(getStartIndex(requestParams))                                                     </span>
<span class="4786121744461484155" onmouseenter="enter('4786121744461484155');" onmouseout="out('4786121744461484155');" style="">1210                  .withMaxIndex(getMaxIndex(requestParams))                                                         </span>
<span class="245535740239558332" onmouseenter="enter('245535740239558332');" onmouseout="out('245535740239558332');" style="">1211                  .withCustomCriteria(buildSelectizeCustomCriteria());                                              </span>




<span  style="">1212                                                                                                                    </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1213          if (md instanceof AdornedTargetCollectionMetadata) {                                                      </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1214              ppr.setOperationTypesOverride(null);                                                                  </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1215              ppr.setType(PersistencePackageRequest.Type.STANDARD);                                                 </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1216              ppr.setSectionEntityField(collectionField);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1217          }                                                                                                         </span>
<span  style="">1218                                                                                                                    </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1219          DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                                     </span>
<span  style="">1220                                                                                                                    </span>
<span class="9153362413933125536" onmouseenter="enter('9153362413933125536');" onmouseout="out('9153362413933125536');" style="">1221          return formService.buildSelectizeCollectionInfo(id, drs, collectionProperty, sectionKey, sectionCrumbs);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1222      }                                                                                                             </span>
<span  style="">1223                                                                                                                    </span>
<span class="-7439222430983038453" onmouseenter="enter('-7439222430983038453');" onmouseout="out('-7439222430983038453');" style="">1224      protected String[] buildSelectizeCustomCriteria() {                                                           </span>
<span class="-4161579644301235736" onmouseenter="enter('-4161579644301235736');" onmouseout="out('-4161579644301235736');" style="">1225          return new String[]{ IS_SELECTIZE_REQUEST };                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1226      }                                                                                                             </span>
<span  style="">1227                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1228      /**                                                                                                           </span>
<span class="-7141111024633203374" onmouseenter="enter('-7141111024633203374');" onmouseout="out('-7141111024633203374');" style="">1229       * Adds the requested collection item via Selectize                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1230       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1231       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1232       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1233       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1234       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1235       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1236       * @param collectionField                                                                                     </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1237       * @param entityForm                                                                                          </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1238       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1239       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1240       */                                                                                                           </span>
<span class="4942792763487402415" onmouseenter="enter('4942792763487402415');" onmouseout="out('4942792763487402415');" style="">1241      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/selectize-add&quot;, method = RequestMethod.POST)              </span>
<span class="8163998475300370418" onmouseenter="enter('8163998475300370418');" onmouseout="out('8163998475300370418');" style=""><abbr title="1242      public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1242      public @ResponseBody Map&lt;String, Object&gt; addSelectizeCollectionItem(HttpServletRequest request, HttpServletResðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1243              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1244              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1245              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style="">1246              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-3120252458037341618" onmouseenter="enter('-3120252458037341618');" onmouseout="out('-3120252458037341618');" style="">1247          Map&lt;String, Object&gt; returnVal = new HashMap&lt;&gt;();                                                          </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1248          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1249          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1250          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1251          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1251          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1252          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1253                                                                                                                    </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1254          if (StringUtils.isBlank(entityForm.getEntityType())) {                                                    </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1255              FieldMetadata fmd = collectionProperty.getMetadata();                                                 </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1256              if (fmd instanceof BasicCollectionMetadata) {                                                         </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1257                  entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1258              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1259          }                                                                                                         </span>
<span  style="">1260                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1261          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1261          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="242274841373215217" onmouseenter="enter('242274841373215217');" onmouseout="out('242274841373215217');" style="">1262          ppr.addCustomCriteria(buildSelectizeCustomCriteria());                                                    </span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1263          declareShouldIgnoreAdditionStatusFilter();                                                                </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1264          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">1265                                                                                                                    </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1266          // First, we must save the collection entity                                                              </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1267          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1267          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1268          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1269          entityFormValidator.validate(entityForm, savedEntity, result);                                            </span>
<span  style="">1270                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1271          if (result.hasErrors()) {                                                                                 </span>
<span class="842224369260603633" onmouseenter="enter('842224369260603633');" onmouseout="out('842224369260603633');" style="">1272              returnVal.put(&quot;error&quot;, result.getFieldError());                                                       </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1273              return returnVal;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1274          }                                                                                                         </span>
<span  style="">1275                                                                                                                    </span>
<span class="2610632867002015507" onmouseenter="enter('2610632867002015507');" onmouseout="out('2610632867002015507');" style="">1276          if (savedEntity.findProperty(ALTERNATE_ID_PROPERTY) != null) {                                            </span>
<span class="-5383740165855607078" onmouseenter="enter('-5383740165855607078');" onmouseout="out('-5383740165855607078');" style="">1277              returnVal.put(&quot;alternateId&quot;, savedEntity.findProperty(ALTERNATE_ID_PROPERTY).getValue());             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1278          }                                                                                                         </span>
<span class="-7825370386877723068" onmouseenter="enter('-7825370386877723068');" onmouseout="out('-7825370386877723068');" style="">1279          return returnVal;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1280      }                                                                                                             </span>
<span  style="">1281                                                                                                                    </span>
<span class="5412920841771640365" onmouseenter="enter('5412920841771640365');" onmouseout="out('5412920841771640365');" style="">1282      protected void declareShouldIgnoreAdditionStatusFilter() {                                                    </span>
<span class="-4270951653865217168" onmouseenter="enter('-4270951653865217168');" onmouseout="out('-4270951653865217168');" style=""><abbr title="1283          Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().getAdditionalProperties();">1283          Map&lt;String, Object&gt; additionalProperties = BroadleafRequestContext.getBroadleafRequestContext().getAdditioðŸ”µ</abbr></span>
<span class="-3723341051420574210" onmouseenter="enter('-3723341051420574210');" onmouseout="out('-3723341051420574210');" style="">1284          additionalProperties.put(&quot;shouldIgnoreAdditionStatusFilter&quot;, true);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1285      }                                                                                                             </span>
<span  style="">1286                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1287      /**                                                                                                           </span>
<span class="1325408264830379158" onmouseenter="enter('1325408264830379158');" onmouseout="out('1325408264830379158');" style="">1288       * Adds the requested collection item                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1289       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1290       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1291       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1292       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1293       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1294       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1295       * @param collectionField                                                                                     </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1296       * @param entityForm                                                                                          </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1297       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1298       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1299       */                                                                                                           </span>
<span class="-2068929988984533631" onmouseenter="enter('-2068929988984533631');" onmouseout="out('-2068929988984533631');" style="">1300      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/add&quot;, method = RequestMethod.POST)                        </span>
<span class="-6457137423768539998" onmouseenter="enter('-6457137423768539998');" onmouseout="out('-6457137423768539998');" style="">1301      public String addCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,        </span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1302              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1303              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1304              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style="">1305              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1306          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1307          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1308          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1309          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1309          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1310          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1311                                                                                                                    </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1312          if (StringUtils.isBlank(entityForm.getEntityType())) {                                                    </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1313              FieldMetadata fmd = collectionProperty.getMetadata();                                                 </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1314              if (fmd instanceof BasicCollectionMetadata) {                                                         </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1315                  entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1316              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1317          }                                                                                                         </span>
<span  style="">1318                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1319          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1319          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">1320          declareShouldIgnoreAdditionStatusFilter();                                                                </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1321          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">1322                                                                                                                    </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1323          // First, we must save the collection entity                                                              </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1324          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1324          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1325          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1326          entityFormValidator.validate(entityForm, savedEntity, result);                                            </span>
<span  style="">1327                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1328          if (result.hasErrors()) {                                                                                 </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1329              FieldMetadata md = collectionProperty.getMetadata();                                                  </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1330              ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                      </span>
<span class="4503162777083318611" onmouseenter="enter('4503162777083318611');" onmouseout="out('4503162777083318611');" style=""><abbr title="1331              return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectionProperty,">1331              return buildAddCollectionItemModel(request, response, model, id, collectionField, sectionKey, collectiðŸ”µ</abbr></span>
<span class="5267635088951466475" onmouseenter="enter('5267635088951466475');" onmouseout="out('5267635088951466475');" style="">1332                      md, ppr, entityForm, savedEntity);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1333          }                                                                                                         </span>
<span  style="">1334                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1335          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1336          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1336          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persðŸ”µ</abbr></span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1337          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span  style="">1338                                                                                                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1339          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="7250522969210652718" onmouseenter="enter('7250522969210652718');" onmouseout="out('7250522969210652718');" style="">1340          model.addAttribute(&quot;actualEntityId&quot;, id);                                                                 </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1341          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1342          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1343      }                                                                                                             </span>
<span  style="">1344                                                                                                                    </span>
<span class="-8003545521832011894" onmouseenter="enter('-8003545521832011894');" onmouseout="out('-8003545521832011894');" style="">1345      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/addEmpty&quot;, method = RequestMethod.POST)                   </span>
<span class="162700220048203938" onmouseenter="enter('162700220048203938');" onmouseout="out('162700220048203938');" style=""><abbr title="1346      public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,">1346      public @ResponseBody String addEmptyCollectionItem(HttpServletRequest request, HttpServletResponse response, MðŸ”µ</abbr></span>
<span class="9080178630750613356" onmouseenter="enter('9080178630750613356');" onmouseout="out('9080178630750613356');" style="">1347              @PathVariable Map&lt;String, String&gt; pathVars,                                                           </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1348              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1349              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="4340432618416424941" onmouseenter="enter('4340432618416424941');" onmouseout="out('4340432618416424941');" style="">1350              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm, BindingResult result) throws Exception {   </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1351          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1352          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1353          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1354          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1354          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1355          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1356                                                                                                                    </span>
<span class="-6595863764736615866" onmouseenter="enter('-6595863764736615866');" onmouseout="out('-6595863764736615866');" style="">1357          if (StringUtils.isBlank(entityForm.getEntityType())) {                                                    </span>
<span class="8181101062672404960" onmouseenter="enter('8181101062672404960');" onmouseout="out('8181101062672404960');" style="">1358              FieldMetadata fmd = collectionProperty.getMetadata();                                                 </span>
<span class="2527411229913876505" onmouseenter="enter('2527411229913876505');" onmouseout="out('2527411229913876505');" style="">1359              if (fmd instanceof BasicCollectionMetadata) {                                                         </span>
<span class="7749679000663231640" onmouseenter="enter('7749679000663231640');" onmouseout="out('7749679000663231640');" style="">1360                  entityForm.setEntityType(((BasicCollectionMetadata) fmd).getCollectionCeilingEntity());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1361              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1362          }                                                                                                         </span>
<span  style="">1363                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1364          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1364          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1365          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span class="-5337934248855825573" onmouseenter="enter('-5337934248855825573');" onmouseout="out('-5337934248855825573');" style="">1366          entity.setIsPreAdd(true);                                                                                 </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1367          // First, we must save the collection entity                                                              </span>
<span class="6484400768602424454" onmouseenter="enter('6484400768602424454');" onmouseout="out('6484400768602424454');" style=""><abbr title="1368          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, sectionCrumbs);">1368          PersistenceResponse persistenceResponse = service.addSubCollectionEntity(entityForm, mainMetadata, collectðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1369          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span  style="">1370                                                                                                                    </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">1371          return new JsonResponse(response)                                                                         </span>
<span class="-645443211281069037" onmouseenter="enter('-645443211281069037');" onmouseout="out('-645443211281069037');" style="">1372                  .with(&quot;status&quot;, &quot;complete&quot;)                                                                       </span>
<span class="-7858493257692229655" onmouseenter="enter('-7858493257692229655');" onmouseout="out('-7858493257692229655');" style="">1373                  .with(&quot;id&quot;, savedEntity.findProperty(entityForm.getIdProperty()).getValue())                      </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">1374                  .done();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1375      }                                                                                                             </span>
<span  style="">1376                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1377      /**                                                                                                           </span>
<span class="-6140462241686685910" onmouseenter="enter('-6140462241686685910');" onmouseout="out('-6140462241686685910');" style=""><abbr title="1378       * Builds out all of the model information needed for showing the add modal for collection items on both the initial GET">1378       * Builds out all of the model information needed for showing the add modal for collection items on both the iðŸ”µ</abbr></span>
<span class="9052968863197617086" onmouseenter="enter('9052968863197617086');" onmouseout="out('9052968863197617086');" style="">1379       * as well as after a POST with validation errors                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1380       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1381       * @param request                                                                                             </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1382       * @param model                                                                                               </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1383       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1384       * @param collectionField                                                                                     </span>
<span class="7403666429378321004" onmouseenter="enter('7403666429378321004');" onmouseout="out('7403666429378321004');" style="">1385       * @param sectionKey                                                                                          </span>
<span class="-7927619294366963435" onmouseenter="enter('-7927619294366963435');" onmouseout="out('-7927619294366963435');" style="">1386       * @param collectionProperty                                                                                  </span>
<span class="-5426566728726502924" onmouseenter="enter('-5426566728726502924');" onmouseout="out('-5426566728726502924');" style="">1387       * @param md                                                                                                  </span>
<span class="4349163197755218506" onmouseenter="enter('4349163197755218506');" onmouseout="out('4349163197755218506');" style="">1388       * @param ppr                                                                                                 </span>
<span class="2094225145376343101" onmouseenter="enter('2094225145376343101');" onmouseout="out('2094225145376343101');" style="">1389       * @return the appropriate view to display for the modal                                                      </span>
<span class="450948407444547835" onmouseenter="enter('450948407444547835');" onmouseout="out('450948407444547835');" style=""><abbr title="1390       * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, EntityForm, BindingResult)}">1390       * @see {@link #addCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, EntityFðŸ”µ</abbr></span>
<span class="3423849059172457982" onmouseenter="enter('3423849059172457982');" onmouseout="out('3423849059172457982');" style=""><abbr title="1391       * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, MultiValueMap)}">1391       * @see {@link #showAddCollectionItem(HttpServletRequest, HttpServletResponse, Model, Map, String, String, MulðŸ”µ</abbr></span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1392       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1393       */                                                                                                           </span>
<span class="-4127331421111161450" onmouseenter="enter('-4127331421111161450');" onmouseout="out('-4127331421111161450');" style="">1394      protected String buildAddCollectionItemModel(HttpServletRequest request, HttpServletResponse response,        </span>
<span class="1808182660955839449" onmouseenter="enter('1808182660955839449');" onmouseout="out('1808182660955839449');" style="">1395              Model model, String id, String collectionField, String sectionKey, Property collectionProperty,       </span>
<span class="-5972908184992702659" onmouseenter="enter('-5972908184992702659');" onmouseout="out('-5972908184992702659');" style=""><abbr title="1396              FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throws ServiceException {">1396              FieldMetadata md, PersistencePackageRequest ppr, EntityForm entityForm, Entity entity) throws ServiceEðŸ”µ</abbr></span>
<span  style="">1397                                                                                                                    </span>
<span class="-2054675889041043286" onmouseenter="enter('-2054675889041043286');" onmouseout="out('-2054675889041043286');" style=""><abbr title="1398          // For requests to add a new collection item include the main class that the subsequent request comes from.">1398          // For requests to add a new collection item include the main class that the subsequent request comes fromðŸ”µ</abbr></span>
<span class="7422952884503198827" onmouseenter="enter('7422952884503198827');" onmouseout="out('7422952884503198827');" style=""><abbr title="1399          // For instance, with basic collections we know the main associated class for a fetch through the ForeignKey">1399          // For instance, with basic collections we know the main associated class for a fetch through the ForeignKðŸ”µ</abbr></span>
<span class="5831142982738818001" onmouseenter="enter('5831142982738818001');" onmouseout="out('5831142982738818001');" style="">1400          // persistence item but map and adorned target lookups make a standard persistence request. This solution </span>
<span class="-3910081436214830376" onmouseenter="enter('-3910081436214830376');" onmouseout="out('-3910081436214830376');" style="">1401          // fixes all cases.                                                                                       </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1402          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-8007514226035577536" onmouseenter="enter('-8007514226035577536');" onmouseout="out('-8007514226035577536');" style="">1403          ppr.addCustomCriteria(&quot;owningClass=&quot; + mainClassName);                                                    </span>
<span class="5215062918947094881" onmouseenter="enter('5215062918947094881');" onmouseout="out('5215062918947094881');" style="">1404          ppr.setAddOperationInspect(true);                                                                         </span>
<span  style="">1405                                                                                                                    </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1406          if (entityForm != null) {                                                                                 </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1407              entityForm.clearFieldsMap();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1408          }                                                                                                         </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1409          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-1532720970191757712" onmouseenter="enter('-1532720970191757712');" onmouseout="out('-1532720970191757712');" style="">1410          if (md instanceof BasicCollectionMetadata) {                                                              </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1411              BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                           </span>
<span  style="">1412                                                                                                                    </span>
<span class="5473401195179812518" onmouseenter="enter('5473401195179812518');" onmouseout="out('5473401195179812518');" style="">1413              // When adding items to basic collections, we will sometimes show a form to persist a new record      </span>
<span class="3817220166052180028" onmouseenter="enter('3817220166052180028');" onmouseout="out('3817220166052180028');" style="">1414              // and sometimes show a list grid to allow the user to associate an existing record.                  </span>
<span class="-7272899612546422146" onmouseenter="enter('-7272899612546422146');" onmouseout="out('-7272899612546422146');" style="">1415              if (fmd.getAddMethodType().equals(AddMethodType.PERSIST)) {                                           </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1416                  ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1416                  ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1417                  if (entityForm == null) {                                                                         </span>
<span class="509426350308747164" onmouseenter="enter('509426350308747164');" onmouseout="out('509426350308747164');" style="">1418                      entityForm = formService.createEntityForm(collectionMetadata,sectionCrumbs);                  </span>
<span class="2737056182573571703" onmouseenter="enter('2737056182573571703');" onmouseout="out('2737056182573571703');" style="">1419                      entityForm.setCeilingEntityClassname(ppr.getCeilingEntityClassname());                        </span>
<span class="2710161406345740991" onmouseenter="enter('2710161406345740991');" onmouseout="out('2710161406345740991');" style="">1420                      entityForm.setEntityType(ppr.getCeilingEntityClassname());                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1421                  } else {                                                                                          </span>
<span class="-5799643084244932085" onmouseenter="enter('-5799643084244932085');" onmouseout="out('-5799643084244932085');" style="">1422                      formService.populateEntityForm(collectionMetadata, entityForm, sectionCrumbs);                </span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1423                      formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1424                  }                                                                                                 </span>
<span class="-7315185064917392199" onmouseenter="enter('-7315185064917392199');" onmouseout="out('-7315185064917392199');" style=""><abbr title="1425                  formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntityClassname());">1425                  formService.removeNonApplicableFields(collectionMetadata, entityForm, ppr.getCeilingEntityClassnamðŸ”µ</abbr></span>
<span class="1687533348183327340" onmouseenter="enter('1687533348183327340');" onmouseout="out('1687533348183327340');" style="">1426                  entityForm.getTabs().iterator().next().getIsVisible();                                            </span>
<span  style="">1427                                                                                                                    </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1428                  model.addAttribute(&quot;entityForm&quot;, entityForm);                                                     </span>
<span class="-2634442257361103125" onmouseenter="enter('-2634442257361103125');" onmouseout="out('-2634442257361103125');" style="">1429                  model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleAddEntity&quot;);                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1430              } else {                                                                                              </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1431                  DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                             </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1432                  ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1432                  ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sðŸ”µ</abbr></span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1433                  listGrid.setPathOverride(request.getRequestURL().toString());                                     </span>
<span  style="">1434                                                                                                                    </span>
<span class="6493773829436488040" onmouseenter="enter('6493773829436488040');" onmouseout="out('6493773829436488040');" style=""><abbr title="1435                  if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUP.equals(fmd.getAddMethodType())) {">1435                  if (AddMethodType.LOOKUP.equals(fmd.getAddMethodType()) || AddMethodType.SELECTIZE_LOOKUP.equals(fðŸ”µ</abbr></span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1436                      listGrid.removeAllRowActions();                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1437                  }                                                                                                 </span>
<span  style="">1438                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1439                  model.addAttribute(&quot;listGrid&quot;, listGrid);                                                         </span>
<span class="-4615041483574305082" onmouseenter="enter('-4615041483574305082');" onmouseout="out('-4615041483574305082');" style="">1440                  model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleSelectEntity&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1441              }                                                                                                     </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1442          } else if (md instanceof AdornedTargetCollectionMetadata) {                                               </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1443              AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                           </span>
<span  style="">1444                                                                                                                    </span>
<span class="-4994014003685781795" onmouseenter="enter('-4994014003685781795');" onmouseout="out('-4994014003685781795');" style=""><abbr title="1445              // Even though this field represents an adorned target collection, the list we want to show in the modal">1445              // Even though this field represents an adorned target collection, the list we want to show in the modðŸ”µ</abbr></span>
<span class="3396745077097675731" onmouseenter="enter('3396745077097675731');" onmouseout="out('3396745077097675731');" style="">1446              // is the standard list grid for the target entity of this field                                      </span>
<span class="2483520132597674649" onmouseenter="enter('2483520132597674649');" onmouseout="out('2483520132597674649');" style="">1447              ppr.setOperationTypesOverride(null);                                                                  </span>
<span class="-7122938661029434364" onmouseenter="enter('-7122938661029434364');" onmouseout="out('-7122938661029434364');" style="">1448              ppr.setType(PersistencePackageRequest.Type.STANDARD);                                                 </span>
<span class="6901858484753166023" onmouseenter="enter('6901858484753166023');" onmouseout="out('6901858484753166023');" style="">1449              ppr.setSectionEntityField(collectionField);                                                           </span>
<span  style="">1450                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1451              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1451              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span  style="">1452                                                                                                                    </span>
<span class="301151810532897107" onmouseenter="enter('301151810532897107');" onmouseout="out('301151810532897107');" style="">1453              DynamicResultSet drs = service.getRecords(ppr).getDynamicResultSet();                                 </span>
<span class="-2345582796497859124" onmouseenter="enter('-2345582796497859124');" onmouseout="out('-2345582796497859124');" style=""><abbr title="1454              ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectionCrumbs);">1454              ListGrid listGrid = formService.buildCollectionListGrid(id, drs, collectionProperty, sectionKey, sectiðŸ”µ</abbr></span>
<span class="1884537605734649521" onmouseenter="enter('1884537605734649521');" onmouseout="out('1884537605734649521');" style="">1455              listGrid.setSubCollectionFieldName(collectionField);                                                  </span>
<span class="-6349032840682010013" onmouseenter="enter('-6349032840682010013');" onmouseout="out('-6349032840682010013');" style="">1456              listGrid.setPathOverride(request.getRequestURL().toString());                                         </span>
<span class="2370419943178688476" onmouseenter="enter('2370419943178688476');" onmouseout="out('2370419943178688476');" style="">1457              listGrid.setFriendlyName(collectionMetadata.getPolymorphicEntities().getFriendlyName());              </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1458              if (entityForm == null) {                                                                             </span>
<span class="-1229292684052118628" onmouseenter="enter('-1229292684052118628');" onmouseout="out('-1229292684052118628');" style=""><abbr title="1459                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, true);">1459                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs,ðŸ”µ</abbr></span>
<span class="-7486141420721649683" onmouseenter="enter('-7486141420721649683');" onmouseout="out('-7486141420721649683');" style="">1460                  entityForm.setCeilingEntityClassname(ppr.getAdornedList().getAdornedTargetEntityClassname());     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1461              } else {                                                                                              </span>
<span class="7685228187033982459" onmouseenter="enter('7685228187033982459');" onmouseout="out('7685228187033982459');" style=""><abbr title="1462                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectionCrumbs, true);">1462                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, entityForm, sectionCrumbs, ðŸ”µ</abbr></span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1463                  formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1464              }                                                                                                     </span>
<span  style="">1465                                                                                                                    </span>
<span class="5169338689637413329" onmouseenter="enter('5169338689637413329');" onmouseout="out('5169338689637413329');" style="">1466              listGrid.setListGridType(ListGrid.Type.ADORNED);                                                      </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1467              for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                                </span>
<span class="8450559638200016101" onmouseenter="enter('8450559638200016101');" onmouseout="out('8450559638200016101');" style="">1468                  if (entry.getValue().getIsVisible()) {                                                            </span>
<span class="1657391013588898454" onmouseenter="enter('1657391013588898454');" onmouseout="out('1657391013588898454');" style="">1469                      listGrid.setListGridType(ListGrid.Type.ADORNED_WITH_FORM);                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1470                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1471                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1472              }                                                                                                     </span>
<span  style="">1473                                                                                                                    </span>
<span class="-757286675881477752" onmouseenter="enter('-757286675881477752');" onmouseout="out('-757286675881477752');" style="">1474              // This is part of an add, so we want to be able to filter/sort the listgrid                          </span>
<span class="3421525283764936758" onmouseenter="enter('3421525283764936758');" onmouseout="out('3421525283764936758');" style="">1475              listGrid.setIsSortable(false);                                                                        </span>
<span class="-2714096270635703274" onmouseenter="enter('-2714096270635703274');" onmouseout="out('-2714096270635703274');" style="">1476              listGrid.setCanFilterAndSort(true);                                                                   </span>
<span class="2544638267985543974" onmouseenter="enter('2544638267985543974');" onmouseout="out('2544638267985543974');" style="">1477              listGrid.removeAllRowActions();                                                                       </span>
<span  style="">1478                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1479              model.addAttribute(&quot;listGrid&quot;, listGrid);                                                             </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1480              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="-1071174233767081578" onmouseenter="enter('-1071174233767081578');" onmouseout="out('-1071174233767081578');" style="">1481              model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedSelectEntity&quot;);                                          </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1482          } else if (md instanceof MapMetadata) {                                                                   </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1483              MapMetadata fmd = (MapMetadata) md;                                                                   </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1484              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1484              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span  style="">1485                                                                                                                    </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1486              if (entityForm == null) {                                                                             </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style="">1487                  entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1488              } else {                                                                                              </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1489                  formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);         </span>
<span class="3430167897814743775" onmouseenter="enter('3430167897814743775');" onmouseout="out('3430167897814743775');" style="">1490                  formService.populateEntityFormFieldValues(collectionMetadata, entity, entityForm);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1491              }                                                                                                     </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1492              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="-892500240032703395" onmouseenter="enter('-892500240032703395');" onmouseout="out('-892500240032703395');" style="">1493              model.addAttribute(&quot;viewType&quot;, &quot;modal/mapAddEntity&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1494          }                                                                                                         </span>
<span  style="">1495                                                                                                                    </span>
<span class="6074380392351813368" onmouseenter="enter('6074380392351813368');" onmouseout="out('6074380392351813368');" style="">1496          // Set the parent id on the entity form                                                                   </span>
<span class="428061459827264798" onmouseenter="enter('428061459827264798');" onmouseout="out('428061459827264798');" style="">1497          if (entityForm != null) {                                                                                 </span>
<span class="-3154229542834445725" onmouseenter="enter('-3154229542834445725');" onmouseout="out('-3154229542834445725');" style="">1498              entityForm.setParentId(id);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1499          }                                                                                                         </span>
<span  style="">1500                                                                                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1501          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="7819166863376485578" onmouseenter="enter('7819166863376485578');" onmouseout="out('7819166863376485578');" style="">1502          model.addAttribute(&quot;modalHeaderType&quot;, ModalHeaderType.ADD_COLLECTION_ITEM.getType());                     </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1503          model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                             </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1504          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1505 -        return &quot;modules/modalContainer&quot;;                                                                          </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1506 +        return MODAL_CONTAINER_VIEW;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1507      }                                                                                                             </span>
<span  style="">1508                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1509      /**                                                                                                           </span>
<span class="3915085583429756257" onmouseenter="enter('3915085583429756257');" onmouseout="out('3915085583429756257');" style="">1510       * Shows the appropriate modal dialog to edit the selected collection item                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1511       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1512       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1513       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1514       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1515       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1516       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1517       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1518       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1519       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1520       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1521       */                                                                                                           </span>
<span class="5941881897199209931" onmouseenter="enter('5941881897199209931');" onmouseout="out('5941881897199209931');" style=""><abbr title="1522      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.GET)">1522      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.ðŸ”µ</abbr></span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style="">1523      public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model, </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1524              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1525              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1526              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1527              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1528              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1529          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1529          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateðŸ”µ</abbr></span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1530                  ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1531      }                                                                                                             </span>
<span  style="">1532                                                                                                                    </span>
<span class="-3777402830265989862" onmouseenter="enter('-3777402830265989862');" onmouseout="out('-3777402830265989862');" style="">1533      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.GET)          </span>
<span class="-4908339404803295782" onmouseenter="enter('-4908339404803295782');" onmouseout="out('-4908339404803295782');" style="">1534      public String showUpdateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model, </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1535              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1536              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1537              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1538              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="7585768018133278114" onmouseenter="enter('7585768018133278114');" onmouseout="out('7585768018133278114');" style="">1539          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,    </span>
<span class="-1960257468419948758" onmouseenter="enter('-1960257468419948758');" onmouseout="out('-1960257468419948758');" style="">1540                  ModalHeaderType.UPDATE_COLLECTION_ITEM.getType());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1541      }                                                                                                             </span>
<span  style="">1542                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1543      /**                                                                                                           </span>
<span class="6761933478321573145" onmouseenter="enter('6761933478321573145');" onmouseout="out('6761933478321573145');" style=""><abbr title="1544       * Shows the appropriate modal dialog to view the selected collection item. This will display the modal as readonly">1544       * Shows the appropriate modal dialog to view the selected collection item. This will display the modal as reaðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1545       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1546       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1547       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1548       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1549       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1550       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1551       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1552       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1553       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1554       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1555       */                                                                                                           </span>
<span class="5228464490364608791" onmouseenter="enter('5228464490364608791');" onmouseout="out('5228464490364608791');" style=""><abbr title="1556      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = RequestMethod.GET)">1556      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view&quot;, method = RequestMeðŸ”µ</abbr></span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style="">1557      public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1558              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1559              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1560              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1561              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1562              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="7887850161668822106" onmouseenter="enter('7887850161668822106');" onmouseout="out('7887850161668822106');" style=""><abbr title="1563          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1563          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1564                  ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                                  </span>
<span  style="">1565                                                                                                                    </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1566          // Since this is a read-only view, actions don&#x27;t make sense in this context                               </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1567          EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                             </span>
<span class="7289613241506142720" onmouseenter="enter('7289613241506142720');" onmouseout="out('7289613241506142720');" style="">1568          addAuditableDisplayFields(ef);                                                                            </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1569          ef.removeAllActions();                                                                                    </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1570          ef.setReadOnly();                                                                                         </span>
<span  style="">1571                                                                                                                    </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1572          return returnPath;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1573      }                                                                                                             </span>
<span  style="">1574                                                                                                                    </span>
<span class="6858008221927215769" onmouseenter="enter('6858008221927215769');" onmouseout="out('6858008221927215769');" style="">1575      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/view&quot;, method = RequestMethod.GET)     </span>
<span class="5253033568903944771" onmouseenter="enter('5253033568903944771');" onmouseout="out('5253033568903944771');" style="">1576      public String showViewCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,   </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1577              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1578              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1579              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">1580              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="2521791674908842244" onmouseenter="enter('2521791674908842244');" onmouseout="out('2521791674908842244');" style=""><abbr title="1581          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null,">1581          String returnPath = showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemðŸ”µ</abbr></span>
<span class="3577092831509406770" onmouseenter="enter('3577092831509406770');" onmouseout="out('3577092831509406770');" style="">1582                  ModalHeaderType.VIEW_COLLECTION_ITEM.getType());                                                  </span>
<span  style="">1583                                                                                                                    </span>
<span class="31897919845004115" onmouseenter="enter('31897919845004115');" onmouseout="out('31897919845004115');" style="">1584          // Since this is a read-only view, actions don&#x27;t make sense in this context                               </span>
<span class="-4450365867670114419" onmouseenter="enter('-4450365867670114419');" onmouseout="out('-4450365867670114419');" style="">1585          EntityForm ef = (EntityForm) model.asMap().get(&quot;entityForm&quot;);                                             </span>
<span class="8625028479691986712" onmouseenter="enter('8625028479691986712');" onmouseout="out('8625028479691986712');" style="">1586          ef.removeAllActions();                                                                                    </span>
<span class="-5643274933892579495" onmouseenter="enter('-5643274933892579495');" onmouseout="out('-5643274933892579495');" style="">1587          ef.setReadOnly();                                                                                         </span>
<span  style="">1588                                                                                                                    </span>
<span class="8472562720288088352" onmouseenter="enter('8472562720288088352');" onmouseout="out('8472562720288088352');" style="">1589          return returnPath;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1590      }                                                                                                             </span>
<span  style="">1591                                                                                                                    </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1592      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1592      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="6852009337058352330" onmouseenter="enter('6852009337058352330');" onmouseout="out('6852009337058352330');" style=""><abbr title="1593              String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType) throws ServiceException {">1593              String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderTypeðŸ”µ</abbr></span>
<span class="-2699953653458232908" onmouseenter="enter('-2699953653458232908');" onmouseout="out('-2699953653458232908');" style=""><abbr title="1594          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId, modalHeaderType, null, null);">1594          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1595      }                                                                                                             </span>
<span  style="">1596                                                                                                                    </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1597      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1597      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="-3706011950121400951" onmouseenter="enter('-3706011950121400951');" onmouseout="out('-3706011950121400951');" style=""><abbr title="1598              String id, String collectionField, String collectionItemId, String modalHeaderType) throws ServiceException {">1598              String id, String collectionField, String collectionItemId, String modalHeaderType) throws ServiceExceðŸ”µ</abbr></span>
<span class="-6899013896128397577" onmouseenter="enter('-6899013896128397577');" onmouseout="out('-6899013896128397577');" style=""><abbr title="1599          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, null, null);">1599          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1600      }                                                                                                             </span>
<span  style="">1601                                                                                                                    </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style=""><abbr title="1602      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1602      protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="4852573692087282601" onmouseenter="enter('4852573692087282601');" onmouseout="out('4852573692087282601');" style=""><abbr title="1603                  String id, String collectionField, String collectionItemId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1603                  String id, String collectionField, String collectionItemId, String modalHeaderType, EntityForm entðŸ”µ</abbr></span>
<span class="6580107021722154279" onmouseenter="enter('6580107021722154279');" onmouseout="out('6580107021722154279');" style=""><abbr title="1604          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modalHeaderType, entityForm, entity);">1604          return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, null, modðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1605      }                                                                                                             </span>
<span  style="">1606                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1607      /**                                                                                                           </span>
<span class="837861132196545598" onmouseenter="enter('837861132196545598');" onmouseout="out('837861132196545598');" style=""><abbr title="1608       * Shows the view and populates the model for updating a collection item. You can also pass in an entityform and entity">1608       * Shows the view and populates the model for updating a collection item. You can also pass in an entityform aðŸ”µ</abbr></span>
<span class="5643306329084644224" onmouseenter="enter('5643306329084644224');" onmouseout="out('5643306329084644224');" style="">1609       * which are optional. If they are not passed in then they are automatically looked up                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1610       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1611       * @param request                                                                                             </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1612       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1613       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1614       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1615       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1616       * @param collectionItemId                                                                                    </span>
<span class="-5929844173285242940" onmouseenter="enter('-5929844173285242940');" onmouseout="out('-5929844173285242940');" style="">1617       * @param modalHeaderType                                                                                     </span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1618       * @param entityForm                                                                                          </span>
<span class="5381683285013722867" onmouseenter="enter('5381683285013722867');" onmouseout="out('5381683285013722867');" style="">1619       * @param entity                                                                                              </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">1620       * @return                                                                                                    </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style="">1621       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1622       */                                                                                                           </span>
<span class="-6584628192976964117" onmouseenter="enter('-6584628192976964117');" onmouseout="out('-6584628192976964117');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="1623 -    protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVars,">1623 -    protected String showViewUpdateCollection(HttpServletRequest request, Model model, Map&lt;String, String&gt; pathVarðŸ”µ</abbr></span>
<span class="-7524579279249503431" onmouseenter="enter('-7524579279249503431');" onmouseout="out('-7524579279249503431');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="1624 -            String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderType, EntityForm entityForm, Entity entity) throws ServiceException {">1624 -            String id, String collectionField, String collectionItemId, String alternateId, String modalHeaderTypeðŸ”µ</abbr></span>
<span class="-7113907340183053787" onmouseenter="enter('-7113907340183053787');" onmouseout="out('-7113907340183053787');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1625 +    protected String showViewUpdateCollection(HttpServletRequest request,                                         </span>
<span class="-8519940996091909282" onmouseenter="enter('-8519940996091909282');" onmouseout="out('-8519940996091909282');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1626 +            Model model,                                                                                          </span>
<span class="233550986134862533" onmouseenter="enter('233550986134862533');" onmouseout="out('233550986134862533');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1627 +            Map&lt;String, String&gt; pathVars,                                                                         </span>
<span class="462404651577214798" onmouseenter="enter('462404651577214798');" onmouseout="out('462404651577214798');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1628 +            String id,                                                                                            </span>
<span class="-5551105944774799057" onmouseenter="enter('-5551105944774799057');" onmouseout="out('-5551105944774799057');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1629 +            String collectionField,                                                                               </span>
<span class="-7138244874257810737" onmouseenter="enter('-7138244874257810737');" onmouseout="out('-7138244874257810737');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1630 +            String collectionItemId,                                                                              </span>
<span class="7426253478403504017" onmouseenter="enter('7426253478403504017');" onmouseout="out('7426253478403504017');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1631 +            String alternateId,                                                                                   </span>
<span class="2900696252953040190" onmouseenter="enter('2900696252953040190');" onmouseout="out('2900696252953040190');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1632 +            String modalHeaderType,                                                                               </span>
<span class="5597094285729719755" onmouseenter="enter('5597094285729719755');" onmouseout="out('5597094285729719755');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1633 +            EntityForm entityForm,                                                                                </span>
<span class="3632664887850253049" onmouseenter="enter('3632664887850253049');" onmouseout="out('3632664887850253049');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1634 +            Entity entity) throws ServiceException {                                                              </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1635          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1636          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1637          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1638          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1638          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1639          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1640          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span class="-2889762407992276786" onmouseenter="enter('-2889762407992276786');" onmouseout="out('-2889762407992276786');" style="">1641          SectionCrumb nextCrumb = new SectionCrumb();                                                              </span>
<span class="4180533444018328805" onmouseenter="enter('4180533444018328805');" onmouseout="out('4180533444018328805');" style="">1642          if (md instanceof MapMetadata) {                                                                          </span>
<span class="-382349485821163458" onmouseenter="enter('-382349485821163458');" onmouseout="out('-382349485821163458');" style="">1643              nextCrumb.setSectionIdentifier(((MapMetadata) md).getValueClassName());                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1644          } else {                                                                                                  </span>
<span class="1919475910220989527" onmouseenter="enter('1919475910220989527');" onmouseout="out('1919475910220989527');" style="">1645              nextCrumb.setSectionIdentifier(((CollectionMetadata) md).getCollectionCeilingEntity());               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1646          }                                                                                                         </span>
<span class="3745082800889494172" onmouseenter="enter('3745082800889494172');" onmouseout="out('3745082800889494172');" style="">1647          nextCrumb.setSectionId(collectionItemId);                                                                 </span>
<span class="7047611651117816234" onmouseenter="enter('7047611651117816234');" onmouseout="out('7047611651117816234');" style="">1648          if (!sectionCrumbs.contains(nextCrumb)) {                                                                 </span>
<span class="-6316688126111539901" onmouseenter="enter('-6316688126111539901');" onmouseout="out('-6316688126111539901');" style="">1649              sectionCrumbs.add(nextCrumb);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1650          }                                                                                                         </span>
<span  style="">1651                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1652          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1652          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1653          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1653          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0ðŸ”µ</abbr></span>
<span  style="">1654                                                                                                                    </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1655          ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                          </span>
<span  style="">1656                                                                                                                    </span>
<span class="4300500518149699432" onmouseenter="enter('4300500518149699432');" onmouseout="out('4300500518149699432');" style="">1657          if (md instanceof BasicCollectionMetadata &amp;&amp;                                                              </span>
<span class="3179311364823579995" onmouseenter="enter('3179311364823579995');" onmouseout="out('3179311364823579995');" style="">1658                  (((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST) ||               </span>
<span class="-5057368181444983975" onmouseenter="enter('-5057368181444983975');" onmouseout="out('-5057368181444983975');" style="">1659                          ((BasicCollectionMetadata) md).getAddMethodType().equals(AddMethodType.PERSIST_EMPTY))) { </span>
<span class="6607267312947776736" onmouseenter="enter('6607267312947776736');" onmouseout="out('6607267312947776736');" style="">1660              BasicCollectionMetadata fmd = (BasicCollectionMetadata) md;                                           </span>
<span  style="">1661                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1662              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1662              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1663              if (entity == null) {                                                                                 </span>
<span class="4597721164047448054" onmouseenter="enter('4597721164047448054');" onmouseout="out('4597721164047448054');" style=""><abbr title="1664                  entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResultSet().getRecords()[0];">1664                  entity = service.getRecord(ppr, collectionItemId, collectionMetadata, true).getDynamicResultSet().ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1665              }                                                                                                     </span>
<span  style="">1666                                                                                                                    </span>
<span class="-7942197356638317765" onmouseenter="enter('-7942197356638317765');" onmouseout="out('-7942197356638317765');" style="">1667              String currentTabName = getCurrentTabName(pathVars, collectionMetadata);                              </span>
<span class="9017537031938626444" onmouseenter="enter('9017537031938626444');" onmouseout="out('9017537031938626444');" style=""><abbr title="1668              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetadata, entity, sectionCrumbs, currentTabName);">1668              Map&lt;String, DynamicResultSet&gt; subRecordsMap = service.getRecordsForSelectedTab(collectionMetadata, entðŸ”µ</abbr></span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1669 -            if (entityForm == null) {                                                                             </span>
<span class="-3582618966464933757" onmouseenter="enter('-3582618966464933757');" onmouseout="out('-3582618966464933757');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="1670 -                entityForm = formService.createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbs);">1670 -                entityForm = formService.createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbsðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1671 -            } else {                                                                                              </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1672 -                entityForm.clearFieldsMap();                                                                      </span>
<span class="1859879359946483810" onmouseenter="enter('1859879359946483810');" onmouseout="out('1859879359946483810');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="1673 -                formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm, sectionCrumbs);">1673 -                formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm, sectionCrumbðŸ”µ</abbr></span>
<span class="5496760487980360743" onmouseenter="enter('5496760487980360743');" onmouseout="out('5496760487980360743');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1674 -                //remove all the actions since we&#x27;re not trying to redisplay them on the form                     </span>
<span class="-6469844840195102556" onmouseenter="enter('-6469844840195102556');" onmouseout="out('-6469844840195102556');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1675 -                entityForm.removeAllActions();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1676 -            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1677 +                                                                                                                  </span>
<span class="348957922752701667" onmouseenter="enter('348957922752701667');" onmouseout="out('348957922752701667');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1678 +            entityForm = reinitializeEntityForm(entityForm, collectionMetadata, entity,                           </span>
<span class="-6666340752275266103" onmouseenter="enter('-6666340752275266103');" onmouseout="out('-6666340752275266103');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1679 +                    subRecordsMap, sectionCrumbs);                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1680 +                                                                                                                  </span>
<span class="-3892497188964586657" onmouseenter="enter('-3892497188964586657');" onmouseout="out('-3892497188964586657');" style="">1681              entityForm.removeAction(DefaultEntityFormActions.DELETE);                                             </span>
<span class="6748640999540281749" onmouseenter="enter('6748640999540281749');" onmouseout="out('6748640999540281749');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1682 +            entityForm.removeAction(DefaultEntityFormActions.DUPLICATE);                                          </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1683 +                                                                                                                  </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1684              addAuditableDisplayFields(entityForm);                                                                </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1685              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="2070483683171714322" onmouseenter="enter('2070483683171714322');" onmouseout="out('2070483683171714322');" style="">1686              model.addAttribute(&quot;viewType&quot;, &quot;modal/simpleEditEntity&quot;);                                             </span>
<span class="205388064165131770" onmouseenter="enter('205388064165131770');" onmouseout="out('205388064165131770');" style="">1687          } else if (md instanceof AdornedTargetCollectionMetadata) {                                               </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1688              AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                           </span>
<span  style="">1689                                                                                                                    </span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1690              if (entity == null) {                                                                                 </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style="">1691                  entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,      </span>
<span class="-2961516840614790290" onmouseenter="enter('-2961516840614790290');" onmouseout="out('-2961516840614790290');" style="">1692                      collectionItemId, sectionCrumbs, alternateId).getDynamicResultSet().getRecords()[0];          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1693              }                                                                                                     </span>
<span  style="">1694                                                                                                                    </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1695              boolean populateTypeAndId = true;                                                                     </span>
<span class="921756716374353809" onmouseenter="enter('921756716374353809');" onmouseout="out('921756716374353809');" style="">1696              boolean isViewCollectionItem = ModalHeaderType.VIEW_COLLECTION_ITEM.getType().equals(modalHeaderType);</span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1697              if (entityForm == null) {                                                                             </span>
<span class="-8902040329002931298" onmouseenter="enter('-8902040329002931298');" onmouseout="out('-8902040329002931298');" style=""><abbr title="1698                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, sectionCrumbs, false);">1698                  entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem,ðŸ”µ</abbr></span>
<span class="-4655192855930300298" onmouseenter="enter('-4655192855930300298');" onmouseout="out('-4655192855930300298');" style="">1699                  entityForm.removeAction(DefaultAdornedEntityFormActions.Add);                                     </span>
<span class="1109271490036416226" onmouseenter="enter('1109271490036416226');" onmouseout="out('1109271490036416226');" style="">1700                  entityForm.addAction(DefaultAdornedEntityFormActions.Save);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1701              } else {                                                                                              </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1702                  entityForm.clearFieldsMap();                                                                      </span>
<span class="2583214667713512490" onmouseenter="enter('2583214667713512490');" onmouseout="out('2583214667713512490');" style="">1703                  String entityType = entityForm.getEntityType();                                                   </span>
<span class="-6584758178229470245" onmouseenter="enter('-6584758178229470245');" onmouseout="out('-6584758178229470245');" style=""><abbr title="1704                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entityForm, sectionCrumbs, false);">1704                  formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, isViewCollectionItem, entityForm, ðŸ”µ</abbr></span>
<span class="2514188310084553719" onmouseenter="enter('2514188310084553719');" onmouseout="out('2514188310084553719');" style="">1705                  entityForm.setEntityType(entityType);                                                             </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1706                  populateTypeAndId = false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1707              }                                                                                                     </span>
<span  style="">1708                                                                                                                    </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1709              Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                    </span>
<span class="4854206459128421670" onmouseenter="enter('4854206459128421670');" onmouseout="out('4854206459128421670');" style=""><abbr title="1710              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassName, id,">1710              adornedTargetAutoPopulateExtensionManager.getProxy().autoSetAdornedTargetManagedFields(md, mainClassNaðŸ”µ</abbr></span>
<span class="8256760534167228532" onmouseenter="enter('8256760534167228532');" onmouseout="out('8256760534167228532');" style="">1711                      collectionField,                                                                              </span>
<span class="7203370545455450378" onmouseenter="enter('7203370545455450378');" onmouseout="out('7203370545455450378');" style="">1712                      collectionItemId, responseMap);                                                               </span>
<span  style="">1713                                                                                                                    </span>
<span class="-3972135447881278836" onmouseenter="enter('-3972135447881278836');" onmouseout="out('-3972135447881278836');" style=""><abbr title="1714              //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and Id is used.">1714              //For AdornedTargetCollections, we need to be specific on what translation ceilingEntity and Id is useðŸ”µ</abbr></span>
<span class="-8007896595560301001" onmouseenter="enter('-8007896595560301001');" onmouseout="out('-8007896595560301001');" style="">1715              //It should be the entity and referenced Id of the adorned entity (not the target entity and Id).     </span>
<span class="316997016312344867" onmouseenter="enter('316997016312344867');" onmouseout="out('316997016312344867');" style="">1716              entityForm.setTranslationCeilingEntity(entityForm.getEntityType());                                   </span>
<span class="-4512360180775881719" onmouseenter="enter('-4512360180775881719');" onmouseout="out('-4512360180775881719');" style="">1717              entityForm.setTranslationId(alternateId);                                                             </span>
<span  style="">1718                                                                                                                    </span>
<span class="5324287805739012771" onmouseenter="enter('5324287805739012771');" onmouseout="out('5324287805739012771');" style="">1719              ClassMetadata cmd = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();           </span>
<span class="-1465905251928147670" onmouseenter="enter('-1465905251928147670');" onmouseout="out('-1465905251928147670');" style="">1720              for (String field : fmd.getMaintainedAdornedTargetFields()) {                                         </span>
<span class="-2821179418575098708" onmouseenter="enter('-2821179418575098708');" onmouseout="out('-2821179418575098708');" style="">1721                  if (responseMap.containsKey(field) &amp;&amp; responseMap.containsKey(&quot;autoSubmit&quot;)) {                    </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1722                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1723                  }                                                                                                 </span>
<span class="-3390991397790942785" onmouseenter="enter('-3390991397790942785');" onmouseout="out('-3390991397790942785');" style="">1724                  Property p = cmd.getPMap().get(field);                                                            </span>
<span class="3110636146594998978" onmouseenter="enter('3110636146594998978');" onmouseout="out('3110636146594998978');" style="">1725                  if (p != null &amp;&amp; p.getMetadata() instanceof AdornedTargetCollectionMetadata) {                    </span>
<span class="-1526293730221303684" onmouseenter="enter('-1526293730221303684');" onmouseout="out('-1526293730221303684');" style=""><abbr title="1726                      // Because we&#x27;re dealing with a nested adorned target collection, this particular request must act">1726                      // Because we&#x27;re dealing with a nested adorned target collection, this particular request mustðŸ”µ</abbr></span>
<span class="5008429970050276114" onmouseenter="enter('5008429970050276114');" onmouseout="out('5008429970050276114');" style=""><abbr title="1727                      // directly on the first adorned target collection. Because of this, we need the actual id property">1727                      // directly on the first adorned target collection. Because of this, we need the actual id proðŸ”µ</abbr></span>
<span class="-7713892716328274330" onmouseenter="enter('-7713892716328274330');" onmouseout="out('-7713892716328274330');" style=""><abbr title="1728                      // from the entity that models the adorned target relationship, and not the id of the target object.">1728                      // from the entity that models the adorned target relationship, and not the id of the target oðŸ”µ</abbr></span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1729                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1729                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style="">1730                      DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,      </span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1731                              alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();                 </span>
<span  style="">1732                                                                                                                    </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1733                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1733                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, pðŸ”µ</abbr></span>
<span class="-6504403122086949696" onmouseenter="enter('-6504403122086949696');" onmouseout="out('-6504403122086949696');" style="">1734                              ppr.getAdornedList().getAdornedTargetEntityClassname(), sectionCrumbs);               </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1735                      listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                                 </span>
<span  style="">1736                                                                                                                    </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1737                      if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {                </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1738                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1738                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1739                      } else {                                                                                      </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1740                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1740                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1741                      }                                                                                             </span>
<span class="2712626054905490038" onmouseenter="enter('2712626054905490038');" onmouseout="out('2712626054905490038');" style="">1742                  } else if (p != null &amp;&amp; p.getMetadata() instanceof MapMetadata) {                                 </span>
<span class="-388196981394792667" onmouseenter="enter('-388196981394792667');" onmouseout="out('-388196981394792667');" style="">1743                      // See above comment for AdornedTargetCollectionMetadata                                      </span>
<span class="-9194902891343883685" onmouseenter="enter('-9194902891343883685');" onmouseout="out('-9194902891343883685');" style="">1744                      MapMetadata mmd = (MapMetadata) p.getMetadata();                                              </span>
<span  style="">1745                                                                                                                    </span>
<span class="-1545323212479782948" onmouseenter="enter('-1545323212479782948');" onmouseout="out('-1545323212479782948');" style=""><abbr title="1746                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERTY);">1746                      Property alternateIdProperty = entity.getPMap().get(BasicPersistenceModule.ALTERNATE_ID_PROPERðŸ”µ</abbr></span>
<span class="-2604548800815530907" onmouseenter="enter('-2604548800815530907');" onmouseout="out('-2604548800815530907');" style="">1747                      DynamicResultSet drs = service.getRecordsForCollection(cmd, entity, p, null, null, null,      </span>
<span class="6998312672677631430" onmouseenter="enter('6998312672677631430');" onmouseout="out('6998312672677631430');" style="">1748                              alternateIdProperty.getValue(), sectionCrumbs).getDynamicResultSet();                 </span>
<span  style="">1749                                                                                                                    </span>
<span class="7745189830620413203" onmouseenter="enter('7745189830620413203');" onmouseout="out('7745189830620413203');" style=""><abbr title="1750                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, p,">1750                      ListGrid listGrid = formService.buildCollectionListGrid(alternateIdProperty.getValue(), drs, pðŸ”µ</abbr></span>
<span class="-6515044965274807025" onmouseenter="enter('-6515044965274807025');" onmouseout="out('-6515044965274807025');" style="">1751                              mmd.getTargetClass(), sectionCrumbs);                                                 </span>
<span class="2479481499951886238" onmouseenter="enter('2479481499951886238');" onmouseout="out('2479481499951886238');" style="">1752                      listGrid.getToolbarActions().add(DefaultListGridActions.ADD);                                 </span>
<span  style="">1753                                                                                                                    </span>
<span class="2161161253789479317" onmouseenter="enter('2161161253789479317');" onmouseout="out('2161161253789479317');" style="">1754                      if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {                </span>
<span class="-878833693208744660" onmouseenter="enter('-878833693208744660');" onmouseout="out('-878833693208744660');" style=""><abbr title="1755                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);">1755                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1756                      } else {                                                                                      </span>
<span class="1709831237852781159" onmouseenter="enter('1709831237852781159');" onmouseout="out('1709831237852781159');" style=""><abbr title="1757                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);">1757                          entityForm.addListGrid(cmd, listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1758                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1759                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1760              }                                                                                                     </span>
<span  style="">1761                                                                                                                    </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style="">1762              formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);       </span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1763              formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());                </span>
<span  style="">1764                                                                                                                    </span>
<span class="7046829326366784672" onmouseenter="enter('7046829326366784672');" onmouseout="out('7046829326366784672');" style="">1765              boolean atLeastOneBasicField = false;                                                                 </span>
<span class="-1983225226345189396" onmouseenter="enter('-1983225226345189396');" onmouseout="out('-1983225226345189396');" style="">1766              for (Entry&lt;String, Field&gt; entry : entityForm.getFields().entrySet()) {                                </span>
<span class="-3942382004211496115" onmouseenter="enter('-3942382004211496115');" onmouseout="out('-3942382004211496115');" style=""><abbr title="1767                  if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName()) &amp;&amp; !responseMap.containsKey(&quot;autoSubmit&quot;)) {">1767                  if (entry.getValue().getIsVisible() &amp;&amp; !responseMap.containsKey(entry.getValue().getName()) &amp;&amp; !reðŸ”µ</abbr></span>
<span class="3115307772764059490" onmouseenter="enter('3115307772764059490');" onmouseout="out('3115307772764059490');" style="">1768                      atLeastOneBasicField = true;                                                                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1769                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1770                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1771              }                                                                                                     </span>
<span class="4813170790944841786" onmouseenter="enter('4813170790944841786');" onmouseout="out('4813170790944841786');" style="">1772              if (!atLeastOneBasicField) {                                                                          </span>
<span class="3364274495995556597" onmouseenter="enter('3364274495995556597');" onmouseout="out('3364274495995556597');" style="">1773                  entityForm.removeAction(DefaultEntityFormActions.SAVE);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1774              }                                                                                                     </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1775              addAuditableDisplayFields(entityForm);                                                                </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1776              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="3009851293217081678" onmouseenter="enter('3009851293217081678');" onmouseout="out('3009851293217081678');" style="">1777              model.addAttribute(&quot;viewType&quot;, &quot;modal/adornedEditEntity&quot;);                                            </span>
<span class="-5178510075759343040" onmouseenter="enter('-5178510075759343040');" onmouseout="out('-5178510075759343040');" style="">1778          } else if (md instanceof MapMetadata) {                                                                   </span>
<span class="-2093939551741714312" onmouseenter="enter('-2093939551741714312');" onmouseout="out('-2093939551741714312');" style="">1779              MapMetadata fmd = (MapMetadata) md;                                                                   </span>
<span  style="">1780                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1781              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1781              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span class="6617779912342853710" onmouseenter="enter('6617779912342853710');" onmouseout="out('6617779912342853710');" style="">1782              if (entity == null) {                                                                                 </span>
<span class="-4540135717015451176" onmouseenter="enter('-4540135717015451176');" onmouseout="out('-4540135717015451176');" style="">1783                  entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,      </span>
<span class="-2813813427236819301" onmouseenter="enter('-2813813427236819301');" onmouseout="out('-2813813427236819301');" style="">1784                      collectionItemId, sectionCrumbs, null).getEntity();                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1785              }                                                                                                     </span>
<span  style="">1786                                                                                                                    </span>
<span class="6497914953434077233" onmouseenter="enter('6497914953434077233');" onmouseout="out('6497914953434077233');" style="">1787              boolean populateTypeAndId = true;                                                                     </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="">1788              if (entityForm == null) {                                                                             </span>
<span class="-8329410661113991951" onmouseenter="enter('-8329410661113991951');" onmouseout="out('-8329410661113991951');" style="">1789                  entityForm = formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id);        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1790              } else {                                                                                              </span>
<span class="-2965751497501930249" onmouseenter="enter('-2965751497501930249');" onmouseout="out('-2965751497501930249');" style="">1791                  //save off the prior key before clearing out the fields map as it will not appear                 </span>
<span class="-4459883460939835415" onmouseenter="enter('-4459883460939835415');" onmouseout="out('-4459883460939835415');" style="">1792                  //back on the saved entity                                                                        </span>
<span class="-8617997777962995342" onmouseenter="enter('-8617997777962995342');" onmouseout="out('-8617997777962995342');" style="">1793                  String priorKey = entityForm.findField(&quot;priorKey&quot;).getValue();                                    </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="">1794                  entityForm.clearFieldsMap();                                                                      </span>
<span class="1316382661564166860" onmouseenter="enter('1316382661564166860');" onmouseout="out('1316382661564166860');" style="">1795                  formService.buildMapForm(fmd, ppr.getMapStructure(), collectionMetadata, id, entityForm);         </span>
<span class="-5674534809018144237" onmouseenter="enter('-5674534809018144237');" onmouseout="out('-5674534809018144237');" style="">1796                  entityForm.findField(&quot;priorKey&quot;).setValue(priorKey);                                              </span>
<span class="3771843644088136874" onmouseenter="enter('3771843644088136874');" onmouseout="out('3771843644088136874');" style="">1797                  populateTypeAndId = false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1798              }                                                                                                     </span>
<span  style="">1799                                                                                                                    </span>
<span class="-4115659644617305625" onmouseenter="enter('-4115659644617305625');" onmouseout="out('-4115659644617305625');" style="">1800              formService.populateEntityFormFields(entityForm, entity, populateTypeAndId, populateTypeAndId);       </span>
<span class="-7934209705949108459" onmouseenter="enter('-7934209705949108459');" onmouseout="out('-7934209705949108459');" style="">1801              formService.populateMapEntityFormFields(entityForm, entity);                                          </span>
<span class="3005107501467199781" onmouseenter="enter('3005107501467199781');" onmouseout="out('3005107501467199781');" style="">1802              addAuditableDisplayFields(entityForm);                                                                </span>
<span class="-8091154852481792239" onmouseenter="enter('-8091154852481792239');" onmouseout="out('-8091154852481792239');" style="">1803              model.addAttribute(&quot;entityForm&quot;, entityForm);                                                         </span>
<span class="5184741693677662709" onmouseenter="enter('5184741693677662709');" onmouseout="out('5184741693677662709');" style="">1804              model.addAttribute(&quot;viewType&quot;, &quot;modal/mapEditEntity&quot;);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1805          }                                                                                                         </span>
<span  style="">1806                                                                                                                    </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1807          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="5715532112666019496" onmouseenter="enter('5715532112666019496');" onmouseout="out('5715532112666019496');" style="">1808          model.addAttribute(&quot;modalHeaderType&quot;, modalHeaderType);                                                   </span>
<span class="-1083818386659623083" onmouseenter="enter('-1083818386659623083');" onmouseout="out('-1083818386659623083');" style="">1809          model.addAttribute(&quot;collectionProperty&quot;, collectionProperty);                                             </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1810          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="1764453142051682246" onmouseenter="enter('1764453142051682246');" onmouseout="out('1764453142051682246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">1811 -        return &quot;modules/modalContainer&quot;;                                                                          </span>
<span class="4471897299383983956" onmouseenter="enter('4471897299383983956');" onmouseout="out('4471897299383983956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1812 +        return MODAL_CONTAINER_VIEW;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1813 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1814 +                                                                                                                  </span>
<span class="-6629135688250429856" onmouseenter="enter('-6629135688250429856');" onmouseout="out('-6629135688250429856');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1815 +    protected EntityForm reinitializeEntityForm(final EntityForm entityForm,                                      </span>
<span class="2488527282562212871" onmouseenter="enter('2488527282562212871');" onmouseout="out('2488527282562212871');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1816 +            final ClassMetadata collectionMetadata,                                                               </span>
<span class="6244041270191906475" onmouseenter="enter('6244041270191906475');" onmouseout="out('6244041270191906475');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1817 +            final Entity entity,                                                                                  </span>
<span class="4210642227221008869" onmouseenter="enter('4210642227221008869');" onmouseout="out('4210642227221008869');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1818 +            final Map&lt;String, DynamicResultSet&gt; subRecordsMap,                                                    </span>
<span class="7695373887778905827" onmouseenter="enter('7695373887778905827');" onmouseout="out('7695373887778905827');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1819 +            final List&lt;SectionCrumb&gt; sectionCrumbs) throws ServiceException {                                     </span>
<span class="7617750196757619382" onmouseenter="enter('7617750196757619382');" onmouseout="out('7617750196757619382');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1820 +        if (entityForm == null) {                                                                                 </span>
<span class="5007761642077021691" onmouseenter="enter('5007761642077021691');" onmouseout="out('5007761642077021691');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1821 +            return formService                                                                                    </span>
<span class="2427987523723463928" onmouseenter="enter('2427987523723463928');" onmouseout="out('2427987523723463928');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1822 +                    .createEntityForm(collectionMetadata, entity, subRecordsMap, sectionCrumbs);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1823 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1824 +                                                                                                                  </span>
<span class="8295048026622439317" onmouseenter="enter('8295048026622439317');" onmouseout="out('8295048026622439317');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1825 +        entityForm.clearFieldsMap();                                                                              </span>
<span class="524385531586817703" onmouseenter="enter('524385531586817703');" onmouseout="out('524385531586817703');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1826 +        formService.populateEntityForm(collectionMetadata, entity, subRecordsMap, entityForm,                     </span>
<span class="2971672777452209099" onmouseenter="enter('2971672777452209099');" onmouseout="out('2971672777452209099');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1827 +                sectionCrumbs);                                                                                   </span>
<span class="5496760487980360743" onmouseenter="enter('5496760487980360743');" onmouseout="out('5496760487980360743');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1828 +        //remove all the actions since we&#x27;re not trying to redisplay them on the form                             </span>
<span class="-6469844840195102556" onmouseenter="enter('-6469844840195102556');" onmouseout="out('-6469844840195102556');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1829 +        entityForm.removeAllActions();                                                                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1830 +                                                                                                                  </span>
<span class="6548609876597156982" onmouseenter="enter('6548609876597156982');" onmouseout="out('6548609876597156982');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">1831 +        return entityForm;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1832      }                                                                                                             </span>
<span  style="">1833                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1834      /**                                                                                                           </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1835       * Updates the specified collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1836       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1837       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1838       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1839       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1840       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1841       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1842       * @param collectionField                                                                                     </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1843       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1843       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this isðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1844       * @param entityForm                                                                                          </span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1845       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1846       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1847       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1848       */                                                                                                           </span>
<span class="1690395709289479208" onmouseenter="enter('1690395709289479208');" onmouseout="out('1690395709289479208');" style="">1849      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}&quot;, method = RequestMethod.POST)         </span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style="">1850      public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1851              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1852              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1853              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1854              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1855              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                            </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1856              BindingResult result) throws Exception {                                                              </span>
<span class="454845068344591329" onmouseenter="enter('454845068344591329');" onmouseout="out('454845068344591329');" style=""><abbr title="1857          return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, entityForm, null, result);">1857          return updateCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, entðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1858      }                                                                                                             </span>
<span  style="">1859                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1860      /**                                                                                                           </span>
<span class="-1844574720116286815" onmouseenter="enter('-1844574720116286815');" onmouseout="out('-1844574720116286815');" style="">1861       * Updates the specified collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1862       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1863       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1864       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1865       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1866       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1867       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1868       * @param collectionField                                                                                     </span>
<span class="665997280574374899" onmouseenter="enter('665997280574374899');" onmouseout="out('665997280574374899');" style=""><abbr title="1869       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this is the primary key value of the target entity)">1869       * @param collectionItemId the collection primary key value (in the case of adorned target collection, this isðŸ”µ</abbr></span>
<span class="-4758509257574949373" onmouseenter="enter('-4758509257574949373');" onmouseout="out('-4758509257574949373');" style="">1870       * @param entityForm                                                                                          </span>
<span class="4031667150854181086" onmouseenter="enter('4031667150854181086');" onmouseout="out('4031667150854181086');" style=""><abbr title="1871       * @param alternateId in the case of adorned target collections, this is the primary key value of the collection member">1871       * @param alternateId in the case of adorned target collections, this is the primary key value of the collectiðŸ”µ</abbr></span>
<span class="471163069337744535" onmouseenter="enter('471163069337744535');" onmouseout="out('471163069337744535');" style="">1872       * @param result                                                                                              </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">1873       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1874       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1875       */                                                                                                           </span>
<span class="6716233350399381715" onmouseenter="enter('6716233350399381715');" onmouseout="out('6716233350399381715');" style=""><abbr title="1876      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.POST)">1876      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}&quot;, method = RequestMethod.ðŸ”µ</abbr></span>
<span class="-1457248957582848154" onmouseenter="enter('-1457248957582848154');" onmouseout="out('-1457248957582848154');" style="">1877      public String updateCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1878              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1879              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1880              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1881              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4505141283599003626" onmouseenter="enter('4505141283599003626');" onmouseout="out('4505141283599003626');" style="">1882              @ModelAttribute(value=&quot;entityForm&quot;) EntityForm entityForm,                                            </span>
<span class="-5366992345424767315" onmouseenter="enter('-5366992345424767315');" onmouseout="out('-5366992345424767315');" style="">1883              @PathVariable(value=&quot;alternateId&quot;) String alternateId,                                                </span>
<span class="5356568511809013810" onmouseenter="enter('5356568511809013810');" onmouseout="out('5356568511809013810');" style="">1884              BindingResult result) throws Exception {                                                              </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1885          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1886          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1887          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1888          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1888          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1889          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">1890                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1891          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1891          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">1892          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">1893                                                                                                                    </span>
<span class="-371048815825413194" onmouseenter="enter('-371048815825413194');" onmouseout="out('-371048815825413194');" style="">1894          // First, we must save the collection entity                                                              </span>
<span class="3262117580653454816" onmouseenter="enter('3262117580653454816');" onmouseout="out('3262117580653454816');" style=""><abbr title="1895          PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, entity, collectionItemId, alternateId, sectionCrumbs);">1895          PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collðŸ”µ</abbr></span>
<span class="1865635597530960613" onmouseenter="enter('1865635597530960613');" onmouseout="out('1865635597530960613');" style="">1896          Entity savedEntity = persistenceResponse.getEntity();                                                     </span>
<span class="7962243372282781310" onmouseenter="enter('7962243372282781310');" onmouseout="out('7962243372282781310');" style="">1897          entityFormValidator.validate(entityForm, savedEntity, result);                                            </span>
<span  style="">1898                                                                                                                    </span>
<span class="4556169223967360348" onmouseenter="enter('4556169223967360348');" onmouseout="out('4556169223967360348');" style="">1899          if (result.hasErrors()) {                                                                                 </span>
<span class="7889587439615503999" onmouseenter="enter('7889587439615503999');" onmouseout="out('7889587439615503999');" style=""><abbr title="1900              return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alternateId,">1900              return showViewUpdateCollection(request, model, pathVars, id, collectionField, collectionItemId, alterðŸ”µ</abbr></span>
<span class="-1009973048758571460" onmouseenter="enter('-1009973048758571460');" onmouseout="out('-1009973048758571460');" style="">1901                      ModalHeaderType.UPDATE_COLLECTION_ITEM.getType(), entityForm, savedEntity);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1902          }                                                                                                         </span>
<span  style="">1903                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">1904          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">1905          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="1906          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">1906          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persðŸ”µ</abbr></span>
<span  style="">1907                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">1908          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">1909          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">1910          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">1911          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1912      }                                                                                                             </span>
<span  style="">1913                                                                                                                    </span>
<span class="-2715204734461845190" onmouseenter="enter('-2715204734461845190');" onmouseout="out('-2715204734461845190');" style="">1914      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/sequence&quot;, method = RequestMethod.POST)</span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1915      public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,             </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1916              HttpServletResponse response, Model model,                                                            </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1917              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1918              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1919              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1920              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="6458961487045284345" onmouseenter="enter('6458961487045284345');" onmouseout="out('6458961487045284345');" style="">1921              @RequestParam(value=&quot;newSequence&quot;) String newSequence) throws Exception {                             </span>
<span class="-6477101312884008952" onmouseenter="enter('-6477101312884008952');" onmouseout="out('-6477101312884008952');" style=""><abbr title="1922          return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collectionItemId, newSequence, null);">1922          return updateCollectionItemSequence(request, response, model, pathVars, id, collectionField, collectionIteðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1923      }                                                                                                             </span>
<span  style="">1924                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">1925      /**                                                                                                           </span>
<span class="-7447609122613552365" onmouseenter="enter('-7447609122613552365');" onmouseout="out('-7447609122613552365');" style="">1926       * Updates the given collection item&#x27;s sequence. This should only be triggered for adorned target collections </span>
<span class="5163972519999742424" onmouseenter="enter('5163972519999742424');" onmouseout="out('5163972519999742424');" style="">1927       * where a sort field is specified -- any other invocation is incorrect and will result in an exception.      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">1928       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">1929       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">1930       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">1931       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">1932       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">1933       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">1934       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">1935       * @param collectionItemId                                                                                    </span>
<span class="8542418631474543845" onmouseenter="enter('8542418631474543845');" onmouseout="out('8542418631474543845');" style="">1936       * @return an object explaining the state of the operation                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">1937       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">1938       */                                                                                                           </span>
<span class="1279723180837283801" onmouseenter="enter('1279723180837283801');" onmouseout="out('1279723180837283801');" style=""><abbr title="1939      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, method = RequestMethod.POST)">1939      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence&quot;, method = RequeðŸ”µ</abbr></span>
<span class="-5848116267348459565" onmouseenter="enter('-5848116267348459565');" onmouseout="out('-5848116267348459565');" style="">1940      public @ResponseBody Map&lt;String, Object&gt; updateCollectionItemSequence(HttpServletRequest request,             </span>
<span class="3008840524978762228" onmouseenter="enter('3008840524978762228');" onmouseout="out('3008840524978762228');" style="">1941              HttpServletResponse response, Model model,                                                            </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">1942              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">1943              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">1944              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">1945              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="6744719432735700494" onmouseenter="enter('6744719432735700494');" onmouseout="out('6744719432735700494');" style="">1946              @RequestParam(value=&quot;newSequence&quot;) String newSequence,                                                </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">1947              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">1948          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">1949          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">1950          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="1951          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">1951          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">1952          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span class="8267317305911636660" onmouseenter="enter('8267317305911636660');" onmouseout="out('8267317305911636660');" style="">1953          FieldMetadata md = collectionProperty.getMetadata();                                                      </span>
<span  style="">1954                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="1955          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">1955          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="6971869165316675737" onmouseenter="enter('6971869165316675737');" onmouseout="out('6971869165316675737');" style="">1956          ppr.addCustomCriteria(&quot;reorderParentEntityFetch&quot;);                                                        </span>
<span  style="">1957                                                                                                                    </span>
<span class="-3265158847012683001" onmouseenter="enter('-3265158847012683001');" onmouseout="out('-3265158847012683001');" style=""><abbr title="1958          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1958          Entity parentEntity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0ðŸ”µ</abbr></span>
<span  style="">1959                                                                                                                    </span>
<span class="-6925496807616680895" onmouseenter="enter('-6925496807616680895');" onmouseout="out('-6925496807616680895');" style="">1960          ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);                                          </span>
<span  style="">1961                                                                                                                    </span>
<span class="-5961537470500127604" onmouseenter="enter('-5961537470500127604');" onmouseout="out('-5961537470500127604');" style="">1962          if (md instanceof AdornedTargetCollectionMetadata) {                                                      </span>
<span class="-3118550417067613592" onmouseenter="enter('-3118550417067613592');" onmouseout="out('-3118550417067613592');" style="">1963              AdornedTargetCollectionMetadata fmd = (AdornedTargetCollectionMetadata) md;                           </span>
<span class="-895931586936599512" onmouseenter="enter('-895931586936599512');" onmouseout="out('-895931586936599512');" style="">1964              AdornedTargetList atl = ppr.getAdornedList();                                                         </span>
<span  style="">1965                                                                                                                    </span>
<span class="4013888246220668443" onmouseenter="enter('4013888246220668443');" onmouseout="out('4013888246220668443');" style="">1966              // Get an entity form for the entity                                                                  </span>
<span class="4144133685169635892" onmouseenter="enter('4144133685169635892');" onmouseout="out('4144133685169635892');" style=""><abbr title="1967              EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionCrumbs, false);">1967              EntityForm entityForm = formService.buildAdornedListForm(fmd, ppr.getAdornedList(), id, false, sectionðŸ”µ</abbr></span>
<span class="985151044669117950" onmouseenter="enter('985151044669117950');" onmouseout="out('985151044669117950');" style="">1968              Entity entity = service.getAdvancedCollectionRecord(mainMetadata, parentEntity, collectionProperty,   </span>
<span class="-4422231398086337832" onmouseenter="enter('-4422231398086337832');" onmouseout="out('-4422231398086337832');" style="">1969                      collectionItemId, sectionCrumbs, alternateId, new String[]{&quot;reorderChildEntityFetch&quot;})        </span>
<span class="-7850695853310911802" onmouseenter="enter('-7850695853310911802');" onmouseout="out('-7850695853310911802');" style="">1970                      .getDynamicResultSet().getRecords()[0];                                                       </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">1971              formService.populateEntityFormFields(entityForm, entity);                                             </span>
<span class="-1847884471983028057" onmouseenter="enter('-1847884471983028057');" onmouseout="out('-1847884471983028057');" style="">1972              formService.populateAdornedEntityFormFields(entityForm, entity, ppr.getAdornedList());                </span>
<span  style="">1973                                                                                                                    </span>
<span class="-3124065187694573478" onmouseenter="enter('-3124065187694573478');" onmouseout="out('-3124065187694573478');" style=""><abbr title="1974              // Set the new sequence (note that it will come in 0-indexed but the persistence module expects 1-indexed)">1974              // Set the new sequence (note that it will come in 0-indexed but the persistence module expects 1-indeðŸ”µ</abbr></span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">1975              int sequenceValue = Integer.parseInt(newSequence) + 1;                                                </span>
<span class="2556919505341751863" onmouseenter="enter('2556919505341751863');" onmouseout="out('2556919505341751863');" style="">1976              Field field = entityForm.findField(atl.getSortField());                                               </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">1977              field.setValue(String.valueOf(sequenceValue));                                                        </span>
<span  style="">1978                                                                                                                    </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1979              Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                    </span>
<span class="-5669538829732150992" onmouseenter="enter('-5669538829732150992');" onmouseout="out('-5669538829732150992');" style=""><abbr title="1980              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, alternateId, sectionCrumbs);">1980              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, ðŸ”µ</abbr></span>
<span class="-6209319883391535282" onmouseenter="enter('-6209319883391535282');" onmouseout="out('-6209319883391535282');" style="">1981              Property displayOrder = persistenceResponse.getEntity().findProperty(atl.getSortField());             </span>
<span  style="">1982                                                                                                                    </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">1983              responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                                      </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">1984              responseMap.put(&quot;field&quot;, collectionField);                                                            </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">1985              responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());            </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">1986              return responseMap;                                                                                   </span>
<span class="-3117865694677500361" onmouseenter="enter('-3117865694677500361');" onmouseout="out('-3117865694677500361');" style="">1987          } else if (md instanceof BasicCollectionMetadata) {                                                       </span>
<span class="-8492572584837651214" onmouseenter="enter('-8492572584837651214');" onmouseout="out('-8492572584837651214');" style="">1988              BasicCollectionMetadata cd = (BasicCollectionMetadata) md;                                            </span>
<span class="-8895891660821831826" onmouseenter="enter('-8895891660821831826');" onmouseout="out('-8895891660821831826');" style="">1989              Map&lt;String, Object&gt; responseMap = new HashMap&lt;&gt;();                                                    </span>
<span class="-2546552603594507996" onmouseenter="enter('-2546552603594507996');" onmouseout="out('-2546552603594507996');" style=""><abbr title="1990              Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResultSet().getRecords()[0];">1990              Entity entity = service.getRecord(ppr, collectionItemId, mainMetadata, false).getDynamicResultSet().geðŸ”µ</abbr></span>
<span  style="">1991                                                                                                                    </span>
<span class="-1667086083424072384" onmouseenter="enter('-1667086083424072384');" onmouseout="out('-1667086083424072384');" style=""><abbr title="1992              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();">1992              ClassMetadata collectionMetadata = service.getClassMetadata(ppr).getDynamicResultSet().getClassMetaDatðŸ”µ</abbr></span>
<span class="-2818097934143266938" onmouseenter="enter('-2818097934143266938');" onmouseout="out('-2818097934143266938');" style="">1993              EntityForm entityForm = formService.createEntityForm(collectionMetadata, sectionCrumbs);              </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">1994              if (!StringUtils.isEmpty(cd.getSortProperty())) {                                                     </span>
<span class="-6303462610985739492" onmouseenter="enter('-6303462610985739492');" onmouseout="out('-6303462610985739492');" style="">1995                  Field f = new Field()                                                                             </span>
<span class="-2538063021289876061" onmouseenter="enter('-2538063021289876061');" onmouseout="out('-2538063021289876061');" style="">1996                          .withName(cd.getSortProperty())                                                           </span>
<span class="-2458072313875538806" onmouseenter="enter('-2458072313875538806');" onmouseout="out('-2458072313875538806');" style="">1997                          .withFieldType(SupportedFieldType.HIDDEN.toString());                                     </span>
<span class="5054103958554301667" onmouseenter="enter('5054103958554301667');" onmouseout="out('5054103958554301667');" style="">1998                  entityForm.addHiddenField(mainMetadata, f);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1999              }                                                                                                     </span>
<span class="-731933207069741460" onmouseenter="enter('-731933207069741460');" onmouseout="out('-731933207069741460');" style="">2000              formService.populateEntityFormFields(entityForm, entity);                                             </span>
<span  style="">2001                                                                                                                    </span>
<span class="8453688484620698371" onmouseenter="enter('8453688484620698371');" onmouseout="out('8453688484620698371');" style="">2002              if (!StringUtils.isEmpty(cd.getSortProperty())) {                                                     </span>
<span class="625882899310766208" onmouseenter="enter('625882899310766208');" onmouseout="out('625882899310766208');" style="">2003                  int sequenceValue = Integer.parseInt(newSequence) + 1;                                            </span>
<span class="-3733495482183042291" onmouseenter="enter('-3733495482183042291');" onmouseout="out('-3733495482183042291');" style="">2004                  Field field = entityForm.findField(cd.getSortProperty());                                         </span>
<span class="3974469841945299276" onmouseenter="enter('3974469841945299276');" onmouseout="out('3974469841945299276');" style="">2005                  field.setValue(String.valueOf(sequenceValue));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2006              }                                                                                                     </span>
<span  style="">2007                                                                                                                    </span>
<span class="3923458830762383909" onmouseenter="enter('3923458830762383909');" onmouseout="out('3923458830762383909');" style=""><abbr title="2008              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, collectionProperty, parentEntity, collectionItemId, sectionCrumbs);">2008              PersistenceResponse persistenceResponse = service.updateSubCollectionEntity(entityForm, mainMetadata, ðŸ”µ</abbr></span>
<span class="-792608105002716351" onmouseenter="enter('-792608105002716351');" onmouseout="out('-792608105002716351');" style="">2009              Property displayOrder = persistenceResponse.getEntity().findProperty(cd.getSortProperty());           </span>
<span  style="">2010                                                                                                                    </span>
<span class="970505058101105571" onmouseenter="enter('970505058101105571');" onmouseout="out('970505058101105571');" style="">2011              responseMap.put(&quot;status&quot;, &quot;ok&quot;);                                                                      </span>
<span class="-875386757038139000" onmouseenter="enter('-875386757038139000');" onmouseout="out('-875386757038139000');" style="">2012              responseMap.put(&quot;field&quot;, collectionField);                                                            </span>
<span class="5750364143877710698" onmouseenter="enter('5750364143877710698');" onmouseout="out('5750364143877710698');" style="">2013              responseMap.put(&quot;newDisplayOrder&quot;, displayOrder == null ? null : displayOrder.getValue());            </span>
<span class="-7443798818164322631" onmouseenter="enter('-7443798818164322631');" onmouseout="out('-7443798818164322631');" style="">2014              return responseMap;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">2015          } else {                                                                                                  </span>
<span class="7542199431919878786" onmouseenter="enter('7542199431919878786');" onmouseout="out('7542199431919878786');" style=""><abbr title="2016              throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collection fields.&quot;);">2016              throw new UnsupportedOperationException(&quot;Cannot handle sequencing for non adorned target collection fiðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2017          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2018      }                                                                                                             </span>
<span  style="">2019                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">2020      /**                                                                                                           </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">2021       * Removes the requested collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">2022       *                                                                                                            </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="2023       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">2023       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item froðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">2024       * map collection.                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">2025       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">2026       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">2027       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">2028       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">2029       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">2030       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">2031       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">2032       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">2033       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">2034       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">2035       */                                                                                                           </span>
<span class="6340503715634976611" onmouseenter="enter('6340503715634976611');" onmouseout="out('6340503715634976611');" style="">2036      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/delete&quot;, method = RequestMethod.POST)  </span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style="">2037      public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">2038              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">2039              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">2040              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="-8628957632607227534" onmouseenter="enter('-8628957632607227534');" onmouseout="out('-8628957632607227534');" style="">2041              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId) throws Exception {                   </span>
<span class="6845453766150325497" onmouseenter="enter('6845453766150325497');" onmouseout="out('6845453766150325497');" style=""><abbr title="2042          return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, null);">2042          return removeCollectionItem(request, response, model, pathVars, id, collectionField, collectionItemId, nulðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2043      }                                                                                                             </span>
<span  style="">2044                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">2045      /**                                                                                                           </span>
<span class="8990706001139491465" onmouseenter="enter('8990706001139491465');" onmouseout="out('8990706001139491465');" style="">2046       * Removes the requested collection item                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">2047       *                                                                                                            </span>
<span class="-933426963836656590" onmouseenter="enter('-933426963836656590');" onmouseout="out('-933426963836656590');" style=""><abbr title="2048       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item from a">2048       * Note that the request must contain a parameter called &quot;key&quot; when attempting to remove a collection item froðŸ”µ</abbr></span>
<span class="9215599325185788819" onmouseenter="enter('9215599325185788819');" onmouseout="out('9215599325185788819');" style="">2049       * map collection.                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">2050       *                                                                                                            </span>
<span class="2683834429188260963" onmouseenter="enter('2683834429188260963');" onmouseout="out('2683834429188260963');" style="">2051       * @param request                                                                                             </span>
<span class="592482809986819432" onmouseenter="enter('592482809986819432');" onmouseout="out('592482809986819432');" style="">2052       * @param response                                                                                            </span>
<span class="-7822492205708441341" onmouseenter="enter('-7822492205708441341');" onmouseout="out('-7822492205708441341');" style="">2053       * @param model                                                                                               </span>
<span class="8612671783291279915" onmouseenter="enter('8612671783291279915');" onmouseout="out('8612671783291279915');" style="">2054       * @param pathVars                                                                                            </span>
<span class="-8430734829547091754" onmouseenter="enter('-8430734829547091754');" onmouseout="out('-8430734829547091754');" style="">2055       * @param id                                                                                                  </span>
<span class="8889160159320276397" onmouseenter="enter('8889160159320276397');" onmouseout="out('8889160159320276397');" style="">2056       * @param collectionField                                                                                     </span>
<span class="2892671224809423282" onmouseenter="enter('2892671224809423282');" onmouseout="out('2892671224809423282');" style="">2057       * @param collectionItemId                                                                                    </span>
<span class="-9006212091433374761" onmouseenter="enter('-9006212091433374761');" onmouseout="out('-9006212091433374761');" style="">2058       * @return the return view path                                                                               </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="">2059       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">2060       */                                                                                                           </span>
<span class="-4053134536146029119" onmouseenter="enter('-4053134536146029119');" onmouseout="out('-4053134536146029119');" style=""><abbr title="2061      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method = RequestMethod.POST)">2061      @RequestMapping(value = &quot;/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete&quot;, method = RequestðŸ”µ</abbr></span>
<span class="-7837390842785437488" onmouseenter="enter('-7837390842785437488');" onmouseout="out('-7837390842785437488');" style="">2062      public String removeCollectionItem(HttpServletRequest request, HttpServletResponse response, Model model,     </span>
<span class="-7861712661849570358" onmouseenter="enter('-7861712661849570358');" onmouseout="out('-7861712661849570358');" style="">2063              @PathVariable  Map&lt;String, String&gt; pathVars,                                                          </span>
<span class="3987103068863415796" onmouseenter="enter('3987103068863415796');" onmouseout="out('3987103068863415796');" style="">2064              @PathVariable(value=&quot;id&quot;) String id,                                                                  </span>
<span class="8509136642392968035" onmouseenter="enter('8509136642392968035');" onmouseout="out('8509136642392968035');" style="">2065              @PathVariable(value=&quot;collectionField&quot;) String collectionField,                                        </span>
<span class="5049469427624471282" onmouseenter="enter('5049469427624471282');" onmouseout="out('5049469427624471282');" style="">2066              @PathVariable(value=&quot;collectionItemId&quot;) String collectionItemId,                                      </span>
<span class="4582279248224591120" onmouseenter="enter('4582279248224591120');" onmouseout="out('4582279248224591120');" style="">2067              @PathVariable(value=&quot;alternateId&quot;) String alternateId) throws Exception {                             </span>
<span class="-4501012331914419749" onmouseenter="enter('-4501012331914419749');" onmouseout="out('-4501012331914419749');" style="">2068          String sectionKey = getSectionKey(pathVars);                                                              </span>
<span class="-895861717242257733" onmouseenter="enter('-895861717242257733');" onmouseout="out('-895861717242257733');" style="">2069          String mainClassName = getClassNameForSection(sectionKey);                                                </span>
<span class="-7934414612876458390" onmouseenter="enter('-7934414612876458390');" onmouseout="out('-7934414612876458390');" style="">2070          List&lt;SectionCrumb&gt; sectionCrumbs = getSectionCrumbs(request, sectionKey, id);                             </span>
<span class="-7833137323132411092" onmouseenter="enter('-7833137323132411092');" onmouseout="out('-7833137323132411092');" style=""><abbr title="2071          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars)).getDynamicResultSet().getClassMetaData();">2071          ClassMetadata mainMetadata = service.getClassMetadata(getSectionPersistencePackageRequest(mainClassName, sðŸ”µ</abbr></span>
<span class="-2830221416952234994" onmouseenter="enter('-2830221416952234994');" onmouseout="out('-2830221416952234994');" style="">2072          Property collectionProperty = mainMetadata.getPMap().get(collectionField);                                </span>
<span  style="">2073                                                                                                                    </span>
<span class="-6408221600487262974" onmouseenter="enter('-6408221600487262974');" onmouseout="out('-6408221600487262974');" style="">2074          String priorKey = request.getParameter(&quot;key&quot;);                                                            </span>
<span  style="">2075                                                                                                                    </span>
<span class="6010077750459927585" onmouseenter="enter('6010077750459927585');" onmouseout="out('6010077750459927585');" style=""><abbr title="2076          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVars);">2076          PersistencePackageRequest ppr = getSectionPersistencePackageRequest(mainClassName, sectionCrumbs, pathVarsðŸ”µ</abbr></span>
<span class="-1139848007146299768" onmouseenter="enter('-1139848007146299768');" onmouseout="out('-1139848007146299768');" style="">2077          declareShouldIgnoreAdditionStatusFilter();                                                                </span>
<span class="5092066553659633012" onmouseenter="enter('5092066553659633012');" onmouseout="out('5092066553659633012');" style="">2078          Entity entity = service.getRecord(ppr, id, mainMetadata, false).getDynamicResultSet().getRecords()[0];    </span>
<span  style="">2079                                                                                                                    </span>
<span class="8107528363762278945" onmouseenter="enter('8107528363762278945');" onmouseout="out('8107528363762278945');" style="">2080          // First, we must remove the collection entity                                                            </span>
<span class="-8185015406879465962" onmouseenter="enter('-8185015406879465962');" onmouseout="out('-8185015406879465962');" style=""><abbr title="2081          PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectionProperty, entity, collectionItemId, alternateId, priorKey, sectionCrumbs);">2081          PersistenceResponse persistenceResponse = service.removeSubCollectionEntity(mainMetadata, collectionProperðŸ”µ</abbr></span>
<span class="4740780245520344929" onmouseenter="enter('4740780245520344929');" onmouseout="out('4740780245520344929');" style="">2082          if (persistenceResponse.getEntity() != null &amp;&amp; persistenceResponse.getEntity().isValidationFailure()) {   </span>
<span class="-1907173364280213129" onmouseenter="enter('-1907173364280213129');" onmouseout="out('-1907173364280213129');" style="">2083              String error = &quot;There was an error removing the whatever&quot;;                                            </span>
<span class="6694909055776458558" onmouseenter="enter('6694909055776458558');" onmouseout="out('6694909055776458558');" style="">2084              if (MapUtils.isNotEmpty(persistenceResponse.getEntity().getPropertyValidationErrors())) {             </span>
<span class="2653002805011151778" onmouseenter="enter('2653002805011151778');" onmouseout="out('2653002805011151778');" style="">2085                  // If we failed, we&#x27;ll return some JSON with the first error                                      </span>
<span class="6101527636004026445" onmouseenter="enter('6101527636004026445');" onmouseout="out('6101527636004026445');" style=""><abbr title="2086                  error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator().next().get(0);">2086                  error = persistenceResponse.getEntity().getPropertyValidationErrors().values().iterator().next().gðŸ”µ</abbr></span>
<span class="3589903040125146199" onmouseenter="enter('3589903040125146199');" onmouseout="out('3589903040125146199');" style="">2087              } else if (CollectionUtils.isNotEmpty(persistenceResponse.getEntity().getGlobalValidationErrors())) { </span>
<span class="-8002349788440125315" onmouseenter="enter('-8002349788440125315');" onmouseout="out('-8002349788440125315');" style="">2088                  error = persistenceResponse.getEntity().getGlobalValidationErrors().get(0);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2089              }                                                                                                     </span>
<span class="-5992560194076697230" onmouseenter="enter('-5992560194076697230');" onmouseout="out('-5992560194076697230');" style="">2090              return new JsonResponse(response)                                                                     </span>
<span class="4764127484129551096" onmouseenter="enter('4764127484129551096');" onmouseout="out('4764127484129551096');" style="">2091                  .with(&quot;status&quot;, &quot;error&quot;)                                                                          </span>
<span class="-4778619806303294332" onmouseenter="enter('-4778619806303294332');" onmouseout="out('-4778619806303294332');" style="">2092                  .with(&quot;message&quot;, BLCMessageUtils.getMessage(error))                                               </span>
<span class="-7022340256072404218" onmouseenter="enter('-7022340256072404218');" onmouseout="out('-7022340256072404218');" style="">2093                  .done();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2094          }                                                                                                         </span>
<span  style="">2095                                                                                                                    </span>
<span class="6847553206794399102" onmouseenter="enter('6847553206794399102');" onmouseout="out('6847553206794399102');" style="">2096          // Next, we must get the new list grid that represents this collection                                    </span>
<span class="2783295710544667282" onmouseenter="enter('2783295710544667282');" onmouseout="out('2783295710544667282');" style="">2097          // We return the new list grid so that it can replace the currently visible one                           </span>
<span class="-540928088313216925" onmouseenter="enter('-540928088313216925');" onmouseout="out('-540928088313216925');" style=""><abbr title="2098          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persistenceResponse, sectionCrumbs);">2098          ListGrid listGrid = getCollectionListGrid(mainMetadata, entity, collectionProperty, null, sectionKey, persðŸ”µ</abbr></span>
<span  style="">2099                                                                                                                    </span>
<span class="1367311393823085969" onmouseenter="enter('1367311393823085969');" onmouseout="out('1367311393823085969');" style="">2100          model.addAttribute(&quot;listGrid&quot;, listGrid);                                                                 </span>
<span class="-8967653170262042052" onmouseenter="enter('-8967653170262042052');" onmouseout="out('-8967653170262042052');" style="">2101          model.addAttribute(&quot;currentUrl&quot;, request.getRequestURL().toString());                                     </span>
<span class="4821340166815723604" onmouseenter="enter('4821340166815723604');" onmouseout="out('4821340166815723604');" style="">2102          setModelAttributes(model, sectionKey);                                                                    </span>
<span class="-1608657499772052292" onmouseenter="enter('-1608657499772052292');" onmouseout="out('-1608657499772052292');" style="">2103          return &quot;views/standaloneListGrid&quot;;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2104      }                                                                                                             </span>
<span  style="">2105                                                                                                                    </span>
<span class="-1722269672251008380" onmouseenter="enter('-1722269672251008380');" onmouseout="out('-1722269672251008380');" style="">2106      public void addAuditableDisplayFields(EntityForm entityForm) {                                                </span>
<span class="2220665039639111541" onmouseenter="enter('2220665039639111541');" onmouseout="out('2220665039639111541');" style="">2107          Field createdBy = entityForm.findField(&quot;auditable.createdBy&quot;);                                            </span>
<span class="-1310269621989930827" onmouseenter="enter('-1310269621989930827');" onmouseout="out('-1310269621989930827');" style="">2108          if (createdBy != null &amp;&amp; createdBy.getValue() != null) {                                                  </span>
<span class="3065344382927201496" onmouseenter="enter('3065344382927201496');" onmouseout="out('3065344382927201496');" style="">2109              addAuditableDisplayField(entityForm, createdBy);                                                      </span>
<span  style="">2110                                                                                                                    </span>
<span class="-8232178899610643805" onmouseenter="enter('-8232178899610643805');" onmouseout="out('-8232178899610643805');" style="">2111              createdBy.setIsVisible(false);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2112          }                                                                                                         </span>
<span class="1393544913931451876" onmouseenter="enter('1393544913931451876');" onmouseout="out('1393544913931451876');" style="">2113          Field updatedBy = entityForm.findField(&quot;auditable.updatedBy&quot;);                                            </span>
<span class="362865388069983596" onmouseenter="enter('362865388069983596');" onmouseout="out('362865388069983596');" style="">2114          if (updatedBy != null &amp;&amp; updatedBy.getValue() != null) {                                                  </span>
<span class="-892302887107162271" onmouseenter="enter('-892302887107162271');" onmouseout="out('-892302887107162271');" style="">2115              addAuditableDisplayField(entityForm, updatedBy);                                                      </span>
<span  style="">2116                                                                                                                    </span>
<span class="6398063041947851488" onmouseenter="enter('6398063041947851488');" onmouseout="out('6398063041947851488');" style="">2117              updatedBy.setIsVisible(false);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2118          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2119      }                                                                                                             </span>
<span  style="">2120                                                                                                                    </span>
<span class="4984267825623541739" onmouseenter="enter('4984267825623541739');" onmouseout="out('4984267825623541739');" style="">2121      private void addAuditableDisplayField(EntityForm entityForm, Field userField) {                               </span>
<span class="-4635466229336929139" onmouseenter="enter('-4635466229336929139');" onmouseout="out('-4635466229336929139');" style="">2122          Field displayField = buildAuditableDisplayField(userField);                                               </span>
<span  style="">2123                                                                                                                    </span>
<span class="-3510960703864117903" onmouseenter="enter('-3510960703864117903');" onmouseout="out('-3510960703864117903');" style="">2124          AdminUser user = adminUserDao.readAdminUserById(Long.parseLong(userField.getValue()));                    </span>
<span class="-2749914300638269457" onmouseenter="enter('-2749914300638269457');" onmouseout="out('-2749914300638269457');" style="">2125          String userName = user == null ? null : user.getName();                                                   </span>
<span class="-519467923242361473" onmouseenter="enter('-519467923242361473');" onmouseout="out('-519467923242361473');" style="">2126          displayField.setValue(userName);                                                                          </span>
<span  style="">2127                                                                                                                    </span>
<span class="2796866146572271884" onmouseenter="enter('2796866146572271884');" onmouseout="out('2796866146572271884');" style="">2128          FieldGroup auditGroup = entityForm.findGroup(&quot;AdminAuditable_Audit&quot;);                                     </span>
<span class="442119087406556402" onmouseenter="enter('442119087406556402');" onmouseout="out('442119087406556402');" style="">2129          if (auditGroup != null) {                                                                                 </span>
<span class="2790071812155889083" onmouseenter="enter('2790071812155889083');" onmouseout="out('2790071812155889083');" style="">2130              auditGroup.addField(displayField);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2131          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2132      }                                                                                                             </span>
<span  style="">2133                                                                                                                    </span>
<span class="-898012728924165157" onmouseenter="enter('-898012728924165157');" onmouseout="out('-898012728924165157');" style="">2134      private Field buildAuditableDisplayField(Field auditableField) {                                              </span>
<span class="7586031541837577475" onmouseenter="enter('7586031541837577475');" onmouseout="out('7586031541837577475');" style="">2135          return new Field().withFieldType(SupportedFieldType.STRING.toString())                                    </span>
<span class="-5983163062967947616" onmouseenter="enter('-5983163062967947616');" onmouseout="out('-5983163062967947616');" style="">2136                  .withName(auditableField.getName() + &quot;Display&quot;)                                                   </span>
<span class="-3810520855500417343" onmouseenter="enter('-3810520855500417343');" onmouseout="out('-3810520855500417343');" style="">2137                  .withFriendlyName(auditableField.getFriendlyName())                                               </span>
<span class="-2087540063707551713" onmouseenter="enter('-2087540063707551713');" onmouseout="out('-2087540063707551713');" style="">2138                  .withOrder(auditableField.getOrder())                                                             </span>
<span class="3252055162848788175" onmouseenter="enter('3252055162848788175');" onmouseout="out('3252055162848788175');" style="">2139                  .withOwningEntityClass(auditableField.getOwningEntityClass())                                     </span>
<span class="8052491048417023702" onmouseenter="enter('8052491048417023702');" onmouseout="out('8052491048417023702');" style="">2140                  .withReadOnly(true);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2141      }                                                                                                             </span>
<span  style="">2142                                                                                                                    </span>
<span class="2512746595428590302" onmouseenter="enter('2512746595428590302');" onmouseout="out('2512746595428590302');" style="">2143      protected String getCurrentTabName(Map&lt;String, String&gt; pathVars, ClassMetadata cmd) {                         </span>
<span class="-1960421544259469215" onmouseenter="enter('-1960421544259469215');" onmouseout="out('-1960421544259469215');" style="">2144          String tabName = pathVars.get(&quot;tabName&quot;);                                                                 </span>
<span class="620358619967646231" onmouseenter="enter('620358619967646231');" onmouseout="out('620358619967646231');" style="">2145          if (StringUtils.isBlank(tabName)) {                                                                       </span>
<span class="-8386812650765964886" onmouseenter="enter('-8386812650765964886');" onmouseout="out('-8386812650765964886');" style="">2146              TabMetadata firstTab = cmd.getFirstTab();                                                             </span>
<span class="5997097813726693180" onmouseenter="enter('5997097813726693180');" onmouseout="out('5997097813726693180');" style="">2147              return firstTab != null ? firstTab.getTabName() : &quot;General&quot;;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2148          }                                                                                                         </span>
<span class="-6789109484485831180" onmouseenter="enter('-6789109484485831180');" onmouseout="out('-6789109484485831180');" style="">2149          return tabName;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2150      }                                                                                                             </span>
<span  style="">2151                                                                                                                    </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">2152      // *****************************************                                                                  </span>
<span class="2492884656402841956" onmouseenter="enter('2492884656402841956');" onmouseout="out('2492884656402841956');" style="">2153      // Typed Entity Helper Methods                                                                                </span>
<span class="7635428391280151313" onmouseenter="enter('7635428391280151313');" onmouseout="out('7635428391280151313');" style="">2154      // *****************************************                                                                  </span>
<span  style="">2155                                                                                                                    </span>
<span class="709722161552159597" onmouseenter="enter('709722161552159597');" onmouseout="out('709722161552159597');" style="">2156      protected void setTypedEntityModelAttributes(HttpServletRequest request, Model model) {                       </span>
<span class="2572860224956804545" onmouseenter="enter('2572860224956804545');" onmouseout="out('2572860224956804545');" style="">2157          // Check if this is a typed entity                                                                        </span>
<span class="-601784761218487618" onmouseenter="enter('-601784761218487618');" onmouseout="out('-601784761218487618');" style="">2158          AdminSection typedEntitySection = (AdminSection) request.getAttribute(&quot;typedEntitySection&quot;);              </span>
<span class="2356861889771822774" onmouseenter="enter('2356861889771822774');" onmouseout="out('2356861889771822774');" style="">2159          if (typedEntitySection != null) {                                                                         </span>
<span class="-7054855399164801351" onmouseenter="enter('-7054855399164801351');" onmouseout="out('-7054855399164801351');" style="">2160              // Update the friendly name for this Entity Type                                                      </span>
<span class="-8436584596314077038" onmouseenter="enter('-8436584596314077038');" onmouseout="out('-8436584596314077038');" style="">2161              model.addAttribute(&quot;entityFriendlyName&quot;, typedEntitySection.getName());                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2162          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2163      }                                                                                                             </span>
<span  style="">2164                                                                                                                    </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">2165      // *********************************                                                                          </span>
<span class="5570644305110686760" onmouseenter="enter('5570644305110686760');" onmouseout="out('5570644305110686760');" style="">2166      // ADDITIONAL SPRING-BOUND METHODS *                                                                          </span>
<span class="6759941537805838467" onmouseenter="enter('6759941537805838467');" onmouseout="out('6759941537805838467');" style="">2167      // *********************************                                                                          </span>
<span  style="">2168                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">2169      /**                                                                                                           </span>
<span class="-6771709729688841784" onmouseenter="enter('-6771709729688841784');" onmouseout="out('-6771709729688841784');" style="">2170       * Invoked on every request to provide the ability to register specific binders for Spring&#x27;s binding process. </span>
<span class="2498077318751920180" onmouseenter="enter('2498077318751920180');" onmouseout="out('2498077318751920180');" style=""><abbr title="2171       * By default, we register a binder that treats empty Strings as null and a Boolean editor that supports either true">2171       * By default, we register a binder that treats empty Strings as null and a Boolean editor that supports eitheðŸ”µ</abbr></span>
<span class="4465303089468973962" onmouseenter="enter('4465303089468973962');" onmouseout="out('4465303089468973962');" style="">2172       * or false. If the value is passed in as null, it will treat it as false.                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">2173       *                                                                                                            </span>
<span class="-3898462538136412996" onmouseenter="enter('-3898462538136412996');" onmouseout="out('-3898462538136412996');" style="">2174       * @param binder                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">2175       */                                                                                                           </span>
<span class="2978104519843175555" onmouseenter="enter('2978104519843175555');" onmouseout="out('2978104519843175555');" style="">2176      @InitBinder                                                                                                   </span>
<span class="4179572271848089300" onmouseenter="enter('4179572271848089300');" onmouseout="out('4179572271848089300');" style="">2177      public void initBinder(WebDataBinder binder) {                                                                </span>
<span class="3888201586857511470" onmouseenter="enter('3888201586857511470');" onmouseout="out('3888201586857511470');" style="">2178          binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));                                 </span>
<span class="-4458929942740752488" onmouseenter="enter('-4458929942740752488');" onmouseout="out('-4458929942740752488');" style="">2179          binder.registerCustomEditor(Boolean.class, new NonNullBooleanEditor());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2180      }                                                                                                             </span>
<span  style="">2181                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">2182  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            