<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>598 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.common.functions.RichFlatMapFunction;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.table.runtime.types.CRow;\n&#x27;
                           &#x27;import org.apache.flink.types.Row;\n&#x27;
                           &#x27;import org.apache.flink.util.Collector;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.factory.DTThreadFactory;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.sql.SQLException;\n&#x27;
                           &#x27;import java.util.concurrent.Executors;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;java.util.concurrent.ScheduledExecutorService;\n&#x27;
                           &#x27;import java.util.concurrent.TimeUnit;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class AllReqRow extends &#x27;
                           &#x27;RichFlatMapFunction&lt;CRow, CRow&gt; implements &#x27;
                           &#x27;ISideReqRow {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideInfo sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private ScheduledExecutorService es;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AllReqRow(SideInfo sideInfo){\n&#x27;
                           &#x27;        this.sideInfo = sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void initCache() throws &#x27;
                           &#x27;SQLException;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void reloadCache();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void open(Configuration parameters) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;        super.open(parameters);\n&#x27;
                           &#x27;        initCache();\n&#x27;
                           &#x27;        System.out.println(&quot;----- all cacheRef &#x27;
                           &#x27;init end-----&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        //start reload cache thread\n&#x27;
                           &#x27;        SideTableInfo sideTableInfo = &#x27;
                           &#x27;sideInfo.getSideTableInfo();\n&#x27;
                           &#x27;        es = &#x27;
                           &#x27;Executors.newSingleThreadScheduledExecutor(new &#x27;
                           &#x27;DTThreadFactory(&quot;cache-all-reload&quot;));\n&#x27;
                           &#x27;        es.scheduleAtFixedRate(() -&gt; &#x27;
                           &#x27;reloadCache(), sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;TimeUnit.MILLISECONDS);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected void sendOutputRow(CRow value, &#x27;
                           &#x27;Object sideInput, Collector&lt;CRow&gt; out) {\n&#x27;
                           &#x27;        if (sideInput == null &amp;&amp; &#x27;
                           &#x27;sideInfo.getJoinType() != JoinType.LEFT) {\n&#x27;
                           &#x27;            return;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        Row row = fillData(value.row(), &#x27;
                           &#x27;sideInput);\n&#x27;
                           &#x27;        out.collect(new CRow(row, &#x27;
                           &#x27;value.change()));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void close() throws Exception {\n&#x27;
                           &#x27;        if (null != es &amp;&amp; !es.isShutdown()) {\n&#x27;
                           &#x27;            es.shutdown();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.common.functions.RichFlatMapFunction;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.table.runtime.types.CRow;\n&#x27;
                           &#x27;import org.apache.flink.types.Row;\n&#x27;
                           &#x27;import org.apache.flink.util.Collector;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.factory.DTThreadFactory;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.sql.SQLException;\n&#x27;
                           &#x27;import java.util.concurrent.Executors;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;java.util.concurrent.ScheduledExecutorService;\n&#x27;
                           &#x27;import java.util.concurrent.TimeUnit;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class AllReqRow extends &#x27;
                           &#x27;RichFlatMapFunction&lt;CRow, CRow&gt; implements &#x27;
                           &#x27;ISideReqRow {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideInfo sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private ScheduledExecutorService es;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AllReqRow(SideInfo sideInfo){\n&#x27;
                           &#x27;        this.sideInfo = sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void initCache() throws &#x27;
                           &#x27;SQLException;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void reloadCache();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void open(Configuration parameters) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;        super.open(parameters);\n&#x27;
                           &#x27;        initCache();\n&#x27;
                           &#x27;        System.out.println(&quot;----- all cacheRef &#x27;
                           &#x27;init end-----&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        //start reload cache thread\n&#x27;
                           &#x27;        SideTableInfo sideTableInfo = &#x27;
                           &#x27;sideInfo.getSideTableInfo();\n&#x27;
                           &#x27;        es = &#x27;
                           &#x27;Executors.newSingleThreadScheduledExecutor(new &#x27;
                           &#x27;DTThreadFactory(&quot;cache-all-reload&quot;));\n&#x27;
                           &#x27;        es.scheduleAtFixedRate(() -&gt; &#x27;
                           &#x27;reloadCache(), sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;TimeUnit.MILLISECONDS);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected void sendOutputRow(CRow value, &#x27;
                           &#x27;Object sideInput, Collector&lt;CRow&gt; out) {\n&#x27;
                           &#x27;        if (sideInput == null &amp;&amp; &#x27;
                           &#x27;sideInfo.getJoinType() != JoinType.LEFT) {\n&#x27;
                           &#x27;            return;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        Row row = fillData(value.row(), &#x27;
                           &#x27;sideInput);\n&#x27;
                           &#x27;        out.collect(new CRow(row, &#x27;
                           &#x27;value.change()));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void close() throws Exception {\n&#x27;
                           &#x27;        if (null != es &amp;&amp; !es.isShutdown()) {\n&#x27;
                           &#x27;            es.shutdown();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.common.functions.RichFlatMapFunction;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.table.runtime.types.CRow;\n&#x27;
                           &#x27;import org.apache.flink.types.Row;\n&#x27;
                           &#x27;import org.apache.flink.util.Collector;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.factory.DTThreadFactory;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.sql.SQLException;\n&#x27;
                           &#x27;import java.util.concurrent.Executors;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;java.util.concurrent.ScheduledExecutorService;\n&#x27;
                           &#x27;import java.util.concurrent.TimeUnit;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class AllReqRow extends &#x27;
                           &#x27;RichFlatMapFunction&lt;CRow, CRow&gt; implements &#x27;
                           &#x27;ISideReqRow {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideInfo sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private ScheduledExecutorService es;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AllReqRow(SideInfo sideInfo){\n&#x27;
                           &#x27;        this.sideInfo = sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void initCache() throws &#x27;
                           &#x27;SQLException;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void reloadCache();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void open(Configuration parameters) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;        super.open(parameters);\n&#x27;
                           &#x27;        initCache();\n&#x27;
                           &#x27;        System.out.println(&quot;----- all cacheRef &#x27;
                           &#x27;init end-----&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        //start reload cache thread\n&#x27;
                           &#x27;        SideTableInfo sideTableInfo = &#x27;
                           &#x27;sideInfo.getSideTableInfo();\n&#x27;
                           &#x27;        es = &#x27;
                           &#x27;Executors.newSingleThreadScheduledExecutor(new &#x27;
                           &#x27;DTThreadFactory(&quot;cache-all-reload&quot;));\n&#x27;
                           &#x27;        es.scheduleAtFixedRate(() -&gt; &#x27;
                           &#x27;reloadCache(), sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;TimeUnit.MILLISECONDS);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected void sendOutputRow(CRow value, &#x27;
                           &#x27;Object sideInput, Collector&lt;CRow&gt; out) {\n&#x27;
                           &#x27;        if (sideInput == null &amp;&amp; &#x27;
                           &#x27;sideInfo.getJoinType() != JoinType.LEFT) {\n&#x27;
                           &#x27;            return;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        Row row = fillData(value.row(), &#x27;
                           &#x27;sideInput);\n&#x27;
                           &#x27;        out.collect(new CRow(row, &#x27;
                           &#x27;value.change()));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void close() throws Exception {\n&#x27;
                           &#x27;        if (null != es &amp;&amp; !es.isShutdown()) {\n&#x27;
                           &#x27;            es.shutdown();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;spork&#x27;, &#x27;baseline&#x27;, &#x27;jfstmerge&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.common.functions.RichFlatMapFunction;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.table.runtime.types.CRow;\n&#x27;
                           &#x27;import org.apache.flink.types.Row;\n&#x27;
                           &#x27;import org.apache.flink.util.Collector;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.factory.DTThreadFactory;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.sql.SQLException;\n&#x27;
                           &#x27;import java.util.concurrent.Executors;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;java.util.concurrent.ScheduledExecutorService;\n&#x27;
                           &#x27;import java.util.concurrent.TimeUnit;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class AllReqRow extends &#x27;
                           &#x27;RichFlatMapFunction&lt;CRow, CRow&gt; implements &#x27;
                           &#x27;ISideReqRow {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideInfo sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private ScheduledExecutorService es;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AllReqRow(SideInfo sideInfo){\n&#x27;
                           &#x27;        this.sideInfo = sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void initCache() throws &#x27;
                           &#x27;SQLException;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void reloadCache();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void open(Configuration parameters) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;        super.open(parameters);\n&#x27;
                           &#x27;        initCache();\n&#x27;
                           &#x27;        System.out.println(&quot;----- all cacheRef &#x27;
                           &#x27;init end-----&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        //start reload cache thread\n&#x27;
                           &#x27;        SideTableInfo sideTableInfo = &#x27;
                           &#x27;sideInfo.getSideTableInfo();\n&#x27;
                           &#x27;        es = &#x27;
                           &#x27;Executors.newSingleThreadScheduledExecutor(new &#x27;
                           &#x27;DTThreadFactory(&quot;cache-all-reload&quot;));\n&#x27;
                           &#x27;        es.scheduleAtFixedRate(() -&gt; &#x27;
                           &#x27;reloadCache(), sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;TimeUnit.MILLISECONDS);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected void sendOutputRow(CRow value, &#x27;
                           &#x27;Object sideInput, Collector&lt;CRow&gt; out) {\n&#x27;
                           &#x27;        if (sideInput == null &amp;&amp; &#x27;
                           &#x27;sideInfo.getJoinType() != JoinType.LEFT) {\n&#x27;
                           &#x27;            return;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        Row row = fillData(value.row(), &#x27;
                           &#x27;sideInput);\n&#x27;
                           &#x27;        out.collect(new CRow(row, &#x27;
                           &#x27;value.change()));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void close() throws Exception {\n&#x27;
                           &#x27;        if (null != es &amp;&amp; !es.isShutdown()) {\n&#x27;
                           &#x27;            es.shutdown();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.common.functions.RichFlatMapFunction;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.table.runtime.types.CRow;\n&#x27;
                           &#x27;import org.apache.flink.types.Row;\n&#x27;
                           &#x27;import org.apache.flink.util.Collector;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.factory.DTThreadFactory;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.sql.SQLException;\n&#x27;
                           &#x27;import java.util.concurrent.Executors;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;java.util.concurrent.ScheduledExecutorService;\n&#x27;
                           &#x27;import java.util.concurrent.TimeUnit;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class AllReqRow extends &#x27;
                           &#x27;RichFlatMapFunction&lt;CRow, CRow&gt; implements &#x27;
                           &#x27;ISideReqRow {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideInfo sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private ScheduledExecutorService es;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AllReqRow(SideInfo sideInfo){\n&#x27;
                           &#x27;        this.sideInfo = sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void initCache() throws &#x27;
                           &#x27;SQLException;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void reloadCache();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void open(Configuration parameters) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;        super.open(parameters);\n&#x27;
                           &#x27;        initCache();\n&#x27;
                           &#x27;        System.out.println(&quot;----- all cacheRef &#x27;
                           &#x27;init end-----&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        //start reload cache thread\n&#x27;
                           &#x27;        SideTableInfo sideTableInfo = &#x27;
                           &#x27;sideInfo.getSideTableInfo();\n&#x27;
                           &#x27;        es = &#x27;
                           &#x27;Executors.newSingleThreadScheduledExecutor(new &#x27;
                           &#x27;DTThreadFactory(&quot;cache-all-reload&quot;));\n&#x27;
                           &#x27;        es.scheduleAtFixedRate(() -&gt; &#x27;
                           &#x27;reloadCache(), sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;TimeUnit.MILLISECONDS);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected void sendOutputRow(CRow value, &#x27;
                           &#x27;Object sideInput, Collector&lt;CRow&gt; out) {\n&#x27;
                           &#x27;        if (sideInput == null &amp;&amp; &#x27;
                           &#x27;sideInfo.getJoinType() != JoinType.LEFT) {\n&#x27;
                           &#x27;            return;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        Row row = fillData(value.row(), &#x27;
                           &#x27;sideInput);\n&#x27;
                           &#x27;        out.collect(new CRow(row, &#x27;
                           &#x27;value.change()));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void close() throws Exception {\n&#x27;
                           &#x27;        if (null != es &amp;&amp; !es.isShutdown()) {\n&#x27;
                           &#x27;            es.shutdown();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;/*\n&#x27;
                           &#x27; * Licensed to the Apache Software Foundation &#x27;
                           &#x27;(ASF) under one\n&#x27;
                           &#x27; * or more contributor license agreements.  See &#x27;
                           &#x27;the NOTICE file\n&#x27;
                           &#x27; * distributed with this work for additional &#x27;
                           &#x27;information\n&#x27;
                           &#x27; * regarding copyright ownership.  The ASF &#x27;
                           &#x27;licenses this file\n&#x27;
                           &#x27; * to you under the Apache License, Version 2.0 &#x27;
                           &#x27;(the\n&#x27;
                           &#x27; * &quot;License&quot;); you may not use this file except in &#x27;
                           &#x27;compliance\n&#x27;
                           &#x27; * with the License.  You may obtain a copy of the &#x27;
                           &#x27;License at\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; *     http://www.apache.org/licenses/LICENSE-2.0\n&#x27;
                           &#x27; *\n&#x27;
                           &#x27; * Unless required by applicable law or agreed to &#x27;
                           &#x27;in writing, software\n&#x27;
                           &#x27; * distributed under the License is distributed on &#x27;
                           &#x27;an &quot;AS IS&quot; BASIS,\n&#x27;
                           &#x27; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, &#x27;
                           &#x27;either express or implied.\n&#x27;
                           &#x27; * See the License for the specific language &#x27;
                           &#x27;governing permissions and\n&#x27;
                           &#x27; * limitations under the License.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;package com.dtstack.flink.sql.side;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.api.common.functions.RichFlatMapFunction;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.apache.flink.configuration.Configuration;\n&#x27;
                           &#x27;import org.apache.flink.table.runtime.types.CRow;\n&#x27;
                           &#x27;import org.apache.flink.types.Row;\n&#x27;
                           &#x27;import org.apache.flink.util.Collector;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;com.dtstack.flink.sql.factory.DTThreadFactory;\n&#x27;
                           &#x27;import org.apache.calcite.sql.JoinType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.sql.SQLException;\n&#x27;
                           &#x27;import java.util.concurrent.Executors;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;java.util.concurrent.ScheduledExecutorService;\n&#x27;
                           &#x27;import java.util.concurrent.TimeUnit;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * Reason:\n&#x27;
                           &#x27; * Date: 2018/9/18\n&#x27;
                           &#x27; * Company: www.dtstack.com\n&#x27;
                           &#x27; * @author xuchao\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;public abstract class AllReqRow extends &#x27;
                           &#x27;RichFlatMapFunction&lt;CRow, CRow&gt; implements &#x27;
                           &#x27;ISideReqRow {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected SideInfo sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private ScheduledExecutorService es;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public AllReqRow(SideInfo sideInfo){\n&#x27;
                           &#x27;        this.sideInfo = sideInfo;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void initCache() throws &#x27;
                           &#x27;SQLException;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected abstract void reloadCache();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void open(Configuration parameters) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;        super.open(parameters);\n&#x27;
                           &#x27;        initCache();\n&#x27;
                           &#x27;        System.out.println(&quot;----- all cacheRef &#x27;
                           &#x27;init end-----&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        //start reload cache thread\n&#x27;
                           &#x27;        SideTableInfo sideTableInfo = &#x27;
                           &#x27;sideInfo.getSideTableInfo();\n&#x27;
                           &#x27;        es = &#x27;
                           &#x27;Executors.newSingleThreadScheduledExecutor(new &#x27;
                           &#x27;DTThreadFactory(&quot;cache-all-reload&quot;));\n&#x27;
                           &#x27;        es.scheduleAtFixedRate(() -&gt; &#x27;
                           &#x27;reloadCache(), sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;sideTableInfo.getCacheTimeout(), &#x27;
                           &#x27;TimeUnit.MILLISECONDS);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    protected void sendOutputRow(CRow value, &#x27;
                           &#x27;Object sideInput, Collector&lt;CRow&gt; out) {\n&#x27;
                           &#x27;        if (sideInput == null &amp;&amp; &#x27;
                           &#x27;sideInfo.getJoinType() != JoinType.LEFT) {\n&#x27;
                           &#x27;            return;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        Row row = fillData(value.row(), &#x27;
                           &#x27;sideInput);\n&#x27;
                           &#x27;        out.collect(new CRow(row, &#x27;
                           &#x27;value.change()));\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void close() throws Exception {\n&#x27;
                           &#x27;        if (null != es &amp;&amp; !es.isShutdown()) {\n&#x27;
                           &#x27;            es.shutdown();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;spork&#x27;, &#x27;baseline&#x27;, &#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        