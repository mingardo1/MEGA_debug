<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>577</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    577
                    <a href="576.html">prev</a>
                    <a href="578.html">next</a>
                    <a href="577_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_f05e92b15d5e4c94442e53a9f83e2659c369aa5e_core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e^1:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e^2:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;14446f4dd844b1bb9da6c412e3556e135bafcba4:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b]], subset: [[b], [b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  25 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  26 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  28 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  29 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  30 import com.google.common.collect.Maps;                                                                   </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  31 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  32 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  33 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  34 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  35 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  36 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  37 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  38 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  39 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  40 import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                      </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  42 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  43 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44 import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50 import java.util.Collections;                                                                            </span>
<span class="-4237179635486895929" onmouseenter="enter('-4237179635486895929');" onmouseout="out('-4237179635486895929');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51 import java.util.concurrent.TimeoutException;                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  53 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  54 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  55 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  56 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  57 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  58 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  59                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  60 import java.util.Collections;                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  61 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  62 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  63 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  64 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  65 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  66 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  67 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  68 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69 import java.util.Collections;                                                                            </span>
<span class="-4237179635486895929" onmouseenter="enter('-4237179635486895929');" onmouseout="out('-4237179635486895929');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70 import java.util.concurrent.TimeoutException;                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79                                                                                                          </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {     </span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  84 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  85 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  86                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  87 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  88  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  89  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  90  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  91  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  92  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  93  */                                                                                                      </span>
<span  style="">  94                                                                                                          </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="">  95 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {     </span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  96     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  97     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  98     private RuntimeContext runtimeContext;                                                               </span>
<span  style="">  99                                                                                                          </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style=""> 100     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style=""> 101     private int timeOutNum = 0;                                                                          </span>
<span  style=""> 102                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style=""> 103     protected BaseSideInfo sideInfo;                                                                     </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style=""> 104     protected transient Counter parseErrorRecords;                                                       </span>
<span  style=""> 105                                                                                                          </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style=""> 106     public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                       </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style=""> 107         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 109     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style=""> 110     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style=""> 111         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style=""> 112         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 114     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style=""> 115     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style=""> 116         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style=""> 117         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style=""> 118         initMetric();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119     }                                                                                                    </span>
<span  style=""> 120                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style=""> 121     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style=""> 122         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title=" 123         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){"> 123         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 124             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125         }                                                                                                </span>
<span  style=""> 126                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style=""> 127         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style=""> 128         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 129             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 130             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 131         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 132             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 132             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133         }                                                                                                </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 134         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135     }                                                                                                    </span>
<span  style=""> 136                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 137     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 138         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 138         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139     }                                                                                                    </span>
<span  style=""> 140                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 141     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 142         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143     }                                                                                                    </span>
<span  style=""> 144                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 145     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 146         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147     }                                                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 149     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 150         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151     }                                                                                                    </span>
<span  style=""> 152                                                                                                          </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style=""> 153     protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                             </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 154         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 155             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 156             try {                                                                                        </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style=""> 157                 Row row = fillData(input.row(), null);                                                   </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 158                 resultFuture.complete(Collections.singleton(new CRow(row, input.change())));             </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 159             } catch (Exception e) {                                                                      </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 160                 dealFillDataError(resultFuture, e, input);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161             }                                                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 162         }else{                                                                                           </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 163             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165     }                                                                                                    </span>
<span  style=""> 166                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 167     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 168         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 169             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171     }                                                                                                    </span>
<span  style=""> 172                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 173     @Override                                                                                            </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style=""> 174     public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                  </span>
<span  style=""> 175                                                                                                          </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 176         if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                     </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""><abbr title=" 177             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);"> 177             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeO🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178         }                                                                                                </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 179         timeOutNum ++;                                                                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 180         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 181             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 182             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183         }                                                                                                </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 184         if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                 </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 185             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 185             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limi🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 186             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 188         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style=""> 191     protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                               </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 192         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style=""> 193         cancelTimerWhenComplete(resultFuture, timeFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 196     @Override                                                                                            </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style=""> 197     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 198         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 199         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 200         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 201             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 202             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 204         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 205             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 206             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 208         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209     }                                                                                                    </span>
<span  style=""> 210                                                                                                          </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style=""> 211     private Map&lt;String, Object&gt; parseInputParam(CRow input){                                             </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 212         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 213         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 214             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style=""> 215             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 216             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 217                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218             }                                                                                            </span>
<span class="-8634238178709382150" onmouseenter="enter('-8634238178709382150');" onmouseout="out('-8634238178709382150');" style=""> 219             String columnName = sideInfo.getEqualFieldList().get(conValIndex);                           </span>
<span class="-6002020895040254528" onmouseenter="enter('-6002020895040254528');" onmouseout="out('-6002020895040254528');" style=""> 220             inputParams.put(columnName, equalObj.toString());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 222         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223     }                                                                                                    </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 224     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 225         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226     }                                                                                                    </span>
<span  style=""> 227                                                                                                          </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style=""><abbr title=" 228     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){"> 228     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFu🔵</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 229         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 230             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 231             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 232                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 233                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 234                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 235                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 236                     try {                                                                                </span>
<span class="-2457127370522435624" onmouseenter="enter('-2457127370522435624');" onmouseout="out('-2457127370522435624');" style=""> 237                         Row row = fillData(input.row(), val);                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 238                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 239                     } catch (Exception e) {                                                              </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 240                         dealFillDataError(resultFuture, e, input);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 242                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 243                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 244                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 245                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style=""> 246                             Row row = fillData(input.row(), one);                                        </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 247                             rowList.add(new CRow(row, input.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 249                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 250                     } catch (Exception e) {                                                              </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 251                         dealFillDataError(resultFuture, e, input);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 253                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 254                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 254                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 256                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259     }                                                                                                    </span>
<span  style=""> 260                                                                                                          </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style=""><abbr title=" 261     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 261     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRo🔵</abbr></span>
<span  style=""> 262                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 263     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 264                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 265     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 266         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267     }                                                                                                    </span>
<span  style=""> 268                                                                                                          </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style=""> 269     protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){             </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 270         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 270         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 271         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 272                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 273                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 274                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 275                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 276                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 278                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279     }                                                                                                    </span>
<span  style=""> 280                                                                                                          </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style=""><abbr title=" 281     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){"> 281     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFutur🔵</abbr></span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style=""><abbr title=" 282         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 282         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedB🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style=""> 283         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style=""> 284             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style=""> 285             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style=""> 286                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style=""> 287             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span  style=""> 290                                                                                                          </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style=""> 291     protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {  </span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style=""> 292         LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                  </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style=""> 293         LOG.debug(&quot;async buid row error..{}&quot;, e);                                                        </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 294         parseErrorRecords.inc();                                                                         </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style=""> 295         resultFuture.complete(Collections.emptyList());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296     }                                                                                                    </span>
<span  style=""> 297                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 298     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 299     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 300         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  25 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  26 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  28 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  29 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  30 import com.google.common.collect.Maps;                                                                   </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  31 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  32 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  33 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  34 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  35 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  36 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  37 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  38 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  39 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  40 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  41 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  42 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  43 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  44 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  45                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  46 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  47 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  48 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  49 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  50 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  51 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  52 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="">  53                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  54 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  55  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  56  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  57  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  58  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  59  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  60  */                                                                                                      </span>
<span  style="">  61                                                                                                          </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="">  62 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {     </span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  63     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  64     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  65     private RuntimeContext runtimeContext;                                                               </span>
<span  style="">  66                                                                                                          </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  67     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  68     private int timeOutNum = 0;                                                                          </span>
<span  style="">  69                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  70     protected BaseSideInfo sideInfo;                                                                     </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  71     protected transient Counter parseErrorRecords;                                                       </span>
<span  style="">  72                                                                                                          </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  73     public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                       </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  74         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  76     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  77     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  78         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  79         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  81     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  82     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  83         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  84         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  85         initMetric();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86     }                                                                                                    </span>
<span  style="">  87                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  88     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  89         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  90         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  90         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  91             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92         }                                                                                                </span>
<span  style="">  93                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  94         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  95         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style="">  96             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style="">  97             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="">  98         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title="  99             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());">  99             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100         }                                                                                                </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 101         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102     }                                                                                                    </span>
<span  style=""> 103                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 104     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 105         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 105         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span  style=""> 107                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 108     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 109         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110     }                                                                                                    </span>
<span  style=""> 111                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 112     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 113         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114     }                                                                                                    </span>
<span  style=""> 115                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 116     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 117         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118     }                                                                                                    </span>
<span  style=""> 119                                                                                                          </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style=""> 120     protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                             </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 121         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 122             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 123             try {                                                                                        </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style=""> 124                 Row row = fillData(input.row(), null);                                                   </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 125                 resultFuture.complete(Collections.singleton(new CRow(row, input.change())));             </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 126             } catch (Exception e) {                                                                      </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 127                 dealFillDataError(resultFuture, e, input);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128             }                                                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 129         }else{                                                                                           </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 130             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132     }                                                                                                    </span>
<span  style=""> 133                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 134     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 135         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 136             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138     }                                                                                                    </span>
<span  style=""> 139                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 140     @Override                                                                                            </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style=""> 141     public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                  </span>
<span  style=""> 142                                                                                                          </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 143         if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                     </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""><abbr title=" 144             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);"> 144             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeO🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145         }                                                                                                </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 146         timeOutNum ++;                                                                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 147         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 148             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 149             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150         }                                                                                                </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 151         if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                 </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 152             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 152             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limi🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 153             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 155         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156     }                                                                                                    </span>
<span  style=""> 157                                                                                                          </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style=""> 158     protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                               </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 159         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style=""> 160         cancelTimerWhenComplete(resultFuture, timeFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span  style=""> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163     @Override                                                                                            </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style=""> 164     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 165         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 166         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 167         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 168             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 169             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 171         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 172             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 173             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 175         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176     }                                                                                                    </span>
<span  style=""> 177                                                                                                          </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style=""> 178     private Map&lt;String, Object&gt; parseInputParam(CRow input){                                             </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 179         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 180         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 181             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style=""> 182             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 183             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 184                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185             }                                                                                            </span>
<span class="-8634238178709382150" onmouseenter="enter('-8634238178709382150');" onmouseout="out('-8634238178709382150');" style=""> 186             String columnName = sideInfo.getEqualFieldList().get(conValIndex);                           </span>
<span class="-6002020895040254528" onmouseenter="enter('-6002020895040254528');" onmouseout="out('-6002020895040254528');" style=""> 187             inputParams.put(columnName, equalObj.toString());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 189         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190     }                                                                                                    </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 191     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 192         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span  style=""> 194                                                                                                          </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style=""><abbr title=" 195     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){"> 195     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFu🔵</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 196         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 197             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 198             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 199                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 200                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 201                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 202                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 203                     try {                                                                                </span>
<span class="-2457127370522435624" onmouseenter="enter('-2457127370522435624');" onmouseout="out('-2457127370522435624');" style=""> 204                         Row row = fillData(input.row(), val);                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 205                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 206                     } catch (Exception e) {                                                              </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 207                         dealFillDataError(resultFuture, e, input);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 209                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 210                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 211                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 212                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style=""> 213                             Row row = fillData(input.row(), one);                                        </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 214                             rowList.add(new CRow(row, input.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 216                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 217                     } catch (Exception e) {                                                              </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 218                         dealFillDataError(resultFuture, e, input);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 220                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 221                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 221                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 223                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226     }                                                                                                    </span>
<span  style=""> 227                                                                                                          </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style=""><abbr title=" 228     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 228     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRo🔵</abbr></span>
<span  style=""> 229                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 230     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 231                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 232     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 233         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style=""> 236     protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){             </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 237         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 237         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 238         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 239                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 240                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 241                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 242                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 243                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 245                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246     }                                                                                                    </span>
<span  style=""> 247                                                                                                          </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style=""><abbr title=" 248     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){"> 248     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFutur🔵</abbr></span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style=""><abbr title=" 249         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 249         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedB🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style=""> 250         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style=""> 251             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style=""> 252             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style=""> 253                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style=""> 254             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256     }                                                                                                    </span>
<span  style=""> 257                                                                                                          </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style=""> 258     protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {  </span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style=""> 259         LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                  </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style=""> 260         LOG.debug(&quot;async buid row error..{}&quot;, e);                                                        </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 261         parseErrorRecords.inc();                                                                         </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style=""> 262         resultFuture.complete(Collections.emptyList());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263     }                                                                                                    </span>
<span  style=""> 264                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 265     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 266     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 267         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269 }                                                                                                        </span>































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  18 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  21 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  22 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  23 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  24 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  25 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  26 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  27 import com.google.common.collect.Maps;                                                                   </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  28 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  29 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  30 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  31 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  32 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  33 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  34 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  35 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  36 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  37 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  38 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  39 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  40 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  41 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  42 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  43 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  44 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  45 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  46 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  47 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  48 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  49                                                                                                          </span>
<span  style="">  50                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  51 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  52  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  53  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  54  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  55  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  56  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57  */                                                                                                      </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="">  58 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {     </span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  59     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span  style="">  60                                                                                                          </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  61     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span  style="">  62                                                                                                          </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  63     private RuntimeContext runtimeContext;                                                               </span>
<span  style="">  64                                                                                                          </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  65     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span  style="">  66                                                                                                          </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  67     private int timeOutNum = 0;                                                                          </span>
<span  style="">  68                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  69     protected BaseSideInfo sideInfo;                                                                     </span>
<span  style="">  70                                                                                                          </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  71     protected transient Counter parseErrorRecords;                                                       </span>
<span  style="">  72                                                                                                          </span>
<span class="8633132124041356827" onmouseenter="enter('8633132124041356827');" onmouseout="out('8633132124041356827');" style="">  73     public BaseAsyncReqRow(BaseSideInfo sideInfo) {                                                      </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  74         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  77     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  78     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  79         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  80         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  84     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  85         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  86         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  87         initMetric();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88     }                                                                                                    </span>
<span  style="">  89                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  90     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  91         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  92         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  92         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  93             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94         }                                                                                                </span>
<span  style="">  95                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  96         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  97         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style="">  98             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style="">  99             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 100         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 101             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 101             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102         }                                                                                                </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 103         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104     }                                                                                                    </span>
<span  style=""> 105                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 106     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 107         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 107         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 110     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 111         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112     }                                                                                                    </span>
<span  style=""> 113                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 114     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 115         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 118     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 119         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120     }                                                                                                    </span>
<span  style=""> 121                                                                                                          </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style=""> 122     protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                             </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 123         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 124             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 125             try {                                                                                        </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style=""> 126                 Row row = fillData(input.row(), null);                                                   </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 127                 resultFuture.complete(Collections.singleton(new CRow(row, input.change())));             </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 128             } catch (Exception e) {                                                                      </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 129                 dealFillDataError(resultFuture, e, input);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130             }                                                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 131         }else{                                                                                           </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 132             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134     }                                                                                                    </span>
<span  style=""> 135                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 136     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 137         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 138             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140     }                                                                                                    </span>
<span  style=""> 141                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 142     @Override                                                                                            </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style=""> 143     public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                  </span>
<span class="-4512921245805166737" onmouseenter="enter('-4512921245805166737');" onmouseout="out('-4512921245805166737');" style=""> 144         if ((timeOutNum % TIMEOUT_LOG_FLUSH_NUM) == 0) {                                                 </span>
<span class="969036689275660584" onmouseenter="enter('969036689275660584');" onmouseout="out('969036689275660584');" style=""><abbr title=" 145             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;, input.toString(), timeOutNum);"> 145             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;, input.toString(), time🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146         }                                                                                                </span>
<span class="-2219815117127949521" onmouseenter="enter('-2219815117127949521');" onmouseout="out('-2219815117127949521');" style=""> 147         timeOutNum++;                                                                                    </span>
<span class="3012505652182075436" onmouseenter="enter('3012505652182075436');" onmouseout="out('3012505652182075436');" style=""> 148         if (sideInfo.getJoinType() == JoinType.LEFT) {                                                   </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 149             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 150             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151         }                                                                                                </span>
<span class="1912651862938115971" onmouseenter="enter('1912651862938115971');" onmouseout="out('1912651862938115971');" style=""> 152         if (timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)) {               </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 153             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 153             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limi🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 154             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 156         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style=""> 159     protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                               </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 160         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style=""> 161         cancelTimerWhenComplete(resultFuture, timeFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164     @Override                                                                                            </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style=""> 165     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 166         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 167         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 168         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 169             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 170             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 172         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 173             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 174             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 176         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177     }                                                                                                    </span>
<span  style=""> 178                                                                                                          </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style=""> 179     private Map&lt;String, Object&gt; parseInputParam(CRow input){                                             </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 180         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 181         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 182             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style=""> 183             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 184             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 185                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186             }                                                                                            </span>
<span class="-8634238178709382150" onmouseenter="enter('-8634238178709382150');" onmouseout="out('-8634238178709382150');" style=""> 187             String columnName = sideInfo.getEqualFieldList().get(conValIndex);                           </span>
<span class="-6002020895040254528" onmouseenter="enter('-6002020895040254528');" onmouseout="out('-6002020895040254528');" style=""> 188             inputParams.put(columnName, equalObj.toString());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 190         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191     }                                                                                                    </span>
<span  style=""> 192                                                                                                          </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 193     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 194         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195     }                                                                                                    </span>
<span  style=""> 196                                                                                                          </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style=""><abbr title=" 197     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){"> 197     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFu🔵</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 198         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 199             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 200             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 201                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 202                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 203                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 204                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 205                     try {                                                                                </span>
<span class="-2457127370522435624" onmouseenter="enter('-2457127370522435624');" onmouseout="out('-2457127370522435624');" style=""> 206                         Row row = fillData(input.row(), val);                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 207                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 208                     } catch (Exception e) {                                                              </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 209                         dealFillDataError(resultFuture, e, input);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 211                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 212                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 213                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 214                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style=""> 215                             Row row = fillData(input.row(), one);                                        </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 216                             rowList.add(new CRow(row, input.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 218                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 219                     } catch (Exception e) {                                                              </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 220                         dealFillDataError(resultFuture, e, input);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 222                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 223                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 223                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 225                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228     }                                                                                                    </span>
<span  style=""> 229                                                                                                          </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style=""><abbr title=" 230     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 230     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRo🔵</abbr></span>
<span  style=""> 231                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 232     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 233                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 234     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 235         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236     }                                                                                                    </span>
<span  style=""> 237                                                                                                          </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style=""> 238     protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){             </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 239         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 239         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 240         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 241                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 242                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 243                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 244                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 245                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 247                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248     }                                                                                                    </span>
<span  style=""> 249                                                                                                          </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style=""><abbr title=" 250     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){"> 250     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFutur🔵</abbr></span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style=""><abbr title=" 251         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 251         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedB🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style=""> 252         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style=""> 253             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style=""> 254             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style=""> 255                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style=""> 256             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258     }                                                                                                    </span>
<span  style=""> 259                                                                                                          </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style=""> 260     protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {  </span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style=""> 261         LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                  </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style=""> 262         LOG.debug(&quot;async buid row error..{}&quot;, e);                                                        </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 263         parseErrorRecords.inc();                                                                         </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style=""> 264         resultFuture.complete(Collections.emptyList());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265     }                                                                                                    </span>
<span  style=""> 266                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 267     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 268     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 269         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271 }                                                                                                        </span>





























</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  25  import com.dtstack.flink.sql.metric.MetricConstant;                                                               </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  26  import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                                        </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  28  import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                             </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +import com.google.common.collect.Maps;                                                                            </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  31  import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +import org.apache.flink.api.common.functions.RuntimeContext;                                                      </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  34  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  35  import org.apache.flink.metrics.Counter;                                                                          </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  36  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  37  import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                          </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  38 +import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                          </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="">  39  import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                               </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                           </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                            </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  42  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  43  import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  44  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  45  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  46                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  47  import java.util.Collections;                                                                                     </span>
<span class="-4237179635486895929" onmouseenter="enter('-4237179635486895929');" onmouseout="out('-4237179635486895929');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import java.util.concurrent.TimeoutException;                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +import java.util.Map;                                                                                             </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +import java.util.concurrent.LinkedBlockingQueue;                                                                  </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +import java.util.concurrent.ScheduledFuture;                                                                      </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +import java.util.concurrent.ThreadPoolExecutor;                                                                   </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="">  55                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  56  /**                                                                                                               </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  57   * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                         </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  58   * only support Left join / inner join(join),not support right join                                               </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  59   * Date: 2018/7/9                                                                                                 </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  60   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  61   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  62   */                                                                                                               </span>
<span  style="">  63                                                                                                                    </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="">  64  public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  65      private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                             </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  66      private static final long serialVersionUID = 2098635244857937717L;                                            </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +    private RuntimeContext runtimeContext;                                                                        </span>
<span  style="">  68                                                                                                                    </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  69      private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                                </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  70      private int timeOutNum = 0;                                                                                   </span>
<span  style="">  71                                                                                                                    </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  72      protected BaseSideInfo sideInfo;                                                                              </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  73      protected transient Counter parseErrorRecords;                                                                </span>
<span  style="">  74                                                                                                                    </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  75      public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                                </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  76          this.sideInfo = sideInfo;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77      }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +    @Override                                                                                                     </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +    public void setRuntimeContext(RuntimeContext runtimeContext) {                                                </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +        super.setRuntimeContext(runtimeContext);                                                                  </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +        this.runtimeContext = runtimeContext;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +    }                                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  84      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  85      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  86          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  87          initCache();                                                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  88          initMetric();                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89      }                                                                                                             </span>
<span  style="">  90                                                                                                                    </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  91      private void initCache(){                                                                                     </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  92          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  93          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  93          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheT🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  94              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95          }                                                                                                         </span>
<span  style="">  96                                                                                                                    </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  97          AbstractSideCache sideCache;                                                                              </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  98          if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style="">  99              sideCache = new LRUSideCache(sideTableInfo);                                                          </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 100              sideInfo.setSideCache(sideCache);                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 101          }else{                                                                                                    </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""> 102              throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103          }                                                                                                         </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 104          sideCache.initCache();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105      }                                                                                                             </span>
<span  style=""> 106                                                                                                                    </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 107      private void initMetric() {                                                                                   </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 108          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 108          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109      }                                                                                                             </span>
<span  style=""> 110                                                                                                                    </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 111      protected CacheObj getFromCache(String key){                                                                  </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 112          return sideInfo.getSideCache().getFromCache(key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113      }                                                                                                             </span>
<span  style=""> 114                                                                                                                    </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 115      protected void putCache(String key, CacheObj value){                                                          </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 116          sideInfo.getSideCache().putCache(key, value);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117      }                                                                                                             </span>
<span  style=""> 118                                                                                                                    </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 119      protected boolean openCache(){                                                                                </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 120          return sideInfo.getSideCache() != null;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121      }                                                                                                             </span>
<span  style=""> 122                                                                                                                    </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style=""> 123      protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                      </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 124          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 125              //Reserved left table data                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 126              try {                                                                                                 </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style=""> 127                  Row row = fillData(input.row(), null);                                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 128                  resultFuture.complete(Collections.singleton(new CRow(row, input.change())));                      </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 129              } catch (Exception e) {                                                                               </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 130                  dealFillDataError(resultFuture, e, input);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131              }                                                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 132          }else{                                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 133              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135      }                                                                                                             </span>
<span  style=""> 136                                                                                                                    </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 137      protected void dealCacheData(String key, CacheObj missKeyObj) {                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 138          if (openCache()) {                                                                                        </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 139              putCache(key, missKeyObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141      }                                                                                                             </span>
<span  style=""> 142                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 143      @Override                                                                                                     </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style=""> 144      public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                           </span>
<span  style=""> 145                                                                                                                    </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 146          if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                              </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""> 147              LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148          }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                                                                                                                  </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 150          timeOutNum ++;                                                                                            </span>
<span class="3720393119063151586" onmouseenter="enter('3720393119063151586');" onmouseout="out('3720393119063151586');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -        if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncTimeoutNumLimit()){                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +        if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +            resultFuture.complete(null);                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +        }                                                                                                         </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +        if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                          </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""> 157              resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -        } else {                                                                                                  </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -            resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -                                                                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +        }                                                                                                         </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +        resultFuture.complete(null);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +                                                                                                                  </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +    protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                        </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +        ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                                       </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +        cancelTimerWhenComplete(resultFuture, timeFuture);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 171 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 173 +    @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +    public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +        preInvoke(input, resultFuture);                                                                           </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +        Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                                 </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +        if(MapUtils.isEmpty(inputParams)){                                                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 178 +            dealMissKey(input, resultFuture);                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 179 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 180 +        }                                                                                                         </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 181 +        if(isUseCache(inputParams)){                                                                              </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +            invokeWithCache(inputParams, input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 184 +        }                                                                                                         </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +        handleAsyncInvoke(inputParams, input, resultFuture);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 186 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 187 +                                                                                                                  </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 188 +    private Map&lt;String, Object&gt; parseInputParam(CRow input){                                                      </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 189 +        Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                                      </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 190 +        for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +            Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 192 +            Object equalObj = input.row().getField(conValIndex);                                                  </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +            if(equalObj == null){                                                                                 </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +                return inputParams;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 195 +            }                                                                                                     </span>
<span class="-8634238178709382150" onmouseenter="enter('-8634238178709382150');" onmouseout="out('-8634238178709382150');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 196 +            String columnName = sideInfo.getEqualFieldList().get(conValIndex);                                    </span>
<span class="-6002020895040254528" onmouseenter="enter('-6002020895040254528');" onmouseout="out('-6002020895040254528');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 197 +            inputParams.put(columnName, equalObj.toString());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +        }                                                                                                         </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 199 +        return inputParams;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 200 +    }                                                                                                             </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 201 +    protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                                </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 202 +        return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 203 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 204 +                                                                                                                  </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 205 +    private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){   </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 206 +        if (openCache()) {                                                                                        </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 207 +            CacheObj val = getFromCache(buildCacheKey(inputParams));                                              </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 208 +            if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 209 +                if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +                    dealMissKey(input, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 211 +                    return;                                                                                       </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +                }else if(ECacheContentType.SingleLine == val.getType()){                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +                    try {                                                                                         </span>
<span class="-2457127370522435624" onmouseenter="enter('-2457127370522435624');" onmouseout="out('-2457127370522435624');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +                        Row row = fillData(input.row(), val);                                                     </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 215 +                        resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +                    } catch (Exception e) {                                                                       </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +                        dealFillDataError(resultFuture, e, input);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 218 +                    }                                                                                             </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 219 +                } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +                    try {                                                                                         </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +                        List&lt;CRow&gt; rowList = Lists.newArrayList();                                                </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +                        for (Object one : (List) val.getContent()) {                                              </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 223 +                            Row row = fillData(input.row(), one);                                                 </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 224 +                            rowList.add(new CRow(row, input.change()));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 225 +                        }                                                                                         </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 226 +                        resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 227 +                    } catch (Exception e) {                                                                       </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 228 +                        dealFillDataError(resultFuture, e, input);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 229 +                    }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 230 +                } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 231 +                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 231 +                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.ge🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 232 +                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 233 +                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 234 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 235 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 236 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 237 +                                                                                                                  </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 238 +    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 238 +    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; result🔵</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 239 +                                                                                                                  </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 240 +    public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 241 +                                                                                                                  </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 242 +    private ProcessingTimeService getProcessingTimeService(){                                                     </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 243 +        return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 244 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 245 +                                                                                                                  </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 246 +    protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                      </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 247 +        long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 247 +        long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurr🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 248 +        return getProcessingTimeService().registerTimer(                                                          </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 249 +                timeoutTimestamp,                                                                                 </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 250 +                new ProcessingTimeCallback() {                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 251 +                    @Override                                                                                     </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +                    public void onProcessingTime(long timestamp) throws Exception {                               </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 253 +                        timeout(input, resultFuture);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 254 +                    }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 255 +                });                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 256 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 257 +                                                                                                                  </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 258 +    protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){      </span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 259 +        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 259 +        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQu🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 260 +        if(resultFuture instanceof StreamRecordQueueEntry){                                                       </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 261 +            StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;               </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 262 +            streamRecordBufferEntry.onComplete((Object value) -&gt; {                                                </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 263 +                timerFuture.cancel(true);                                                                         </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 264 +            },executors);                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 265 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 266 +    }                                                                                                             </span>
<span  style=""> 267                                                                                                                    </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style=""> 268      protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {           </span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style=""> 269          LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                           </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style=""> 270          LOG.debug(&quot;async buid row error..{}&quot;, e);                                                                 </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 271          parseErrorRecords.inc();                                                                                  </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style=""> 272          resultFuture.complete(Collections.emptyList());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273      }                                                                                                             </span>
<span  style=""> 274                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 275      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 276      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 277          super.close();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>

<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  23  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  24  import com.dtstack.flink.sql.metric.MetricConstant;                                                               </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  25  import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                                        </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  26  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  27  import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                             </span>


<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  28  import org.apache.calcite.sql.JoinType;                                                                           </span>


<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  29  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  30  import org.apache.flink.metrics.Counter;                                                                          </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  31  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  32  import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                          </span>

<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                               </span>


<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  34  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  35  import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  36  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  37  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  38                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  39  import java.util.Collections;                                                                                     </span>
<span class="-4237179635486895929" onmouseenter="enter('-4237179635486895929');" onmouseout="out('-4237179635486895929');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import java.util.concurrent.TimeoutException;                                                                     </span>






<span  style="">  41                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  42  /**                                                                                                               </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  43   * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                         </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  44   * only support Left join / inner join(join),not support right join                                               </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  45   * Date: 2018/7/9                                                                                                 </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  46   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  47   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  48   */                                                                                                               </span>
<span  style="">  49                                                                                                                    </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="">  50  public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  51      private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                             </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  52      private static final long serialVersionUID = 2098635244857937717L;                                            </span>

<span  style="">  53                                                                                                                    </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  54      private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                                </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  55      private int timeOutNum = 0;                                                                                   </span>
<span  style="">  56                                                                                                                    </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  57      protected BaseSideInfo sideInfo;                                                                              </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  58      protected transient Counter parseErrorRecords;                                                                </span>
<span  style="">  59                                                                                                                    </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  60      public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                                </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  61          this.sideInfo = sideInfo;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  62      }                                                                                                             </span>
<span  style="">  63                                                                                                                    </span>





<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  64      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  65      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  66          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  67          initCache();                                                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  68          initMetric();                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69      }                                                                                                             </span>
<span  style="">  70                                                                                                                    </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  71      private void initCache(){                                                                                     </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  72          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  73          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  73          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheT🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  74              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75          }                                                                                                         </span>
<span  style="">  76                                                                                                                    </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  77          AbstractSideCache sideCache;                                                                              </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  78          if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style="">  79              sideCache = new LRUSideCache(sideTableInfo);                                                          </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style="">  80              sideInfo.setSideCache(sideCache);                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="">  81          }else{                                                                                                    </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style="">  82              throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83          }                                                                                                         </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style="">  84          sideCache.initCache();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85      }                                                                                                             </span>
<span  style="">  86                                                                                                                    </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style="">  87      private void initMetric() {                                                                                   </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title="  88          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);">  88          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89      }                                                                                                             </span>
<span  style="">  90                                                                                                                    </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style="">  91      protected CacheObj getFromCache(String key){                                                                  </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style="">  92          return sideInfo.getSideCache().getFromCache(key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93      }                                                                                                             </span>
<span  style="">  94                                                                                                                    </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style="">  95      protected void putCache(String key, CacheObj value){                                                          </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style="">  96          sideInfo.getSideCache().putCache(key, value);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97      }                                                                                                             </span>
<span  style="">  98                                                                                                                    </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style="">  99      protected boolean openCache(){                                                                                </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 100          return sideInfo.getSideCache() != null;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101      }                                                                                                             </span>
<span  style=""> 102                                                                                                                    </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style=""> 103      protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                      </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 104          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 105              //Reserved left table data                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 106              try {                                                                                                 </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style=""> 107                  Row row = fillData(input.row(), null);                                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 108                  resultFuture.complete(Collections.singleton(new CRow(row, input.change())));                      </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 109              } catch (Exception e) {                                                                               </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 110                  dealFillDataError(resultFuture, e, input);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111              }                                                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 112          }else{                                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 113              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115      }                                                                                                             </span>
<span  style=""> 116                                                                                                                    </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 117      protected void dealCacheData(String key, CacheObj missKeyObj) {                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 118          if (openCache()) {                                                                                        </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 119              putCache(key, missKeyObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121      }                                                                                                             </span>
<span  style=""> 122                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 123      @Override                                                                                                     </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style=""> 124      public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                           </span>
<span  style=""> 125                                                                                                                    </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 126          if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                              </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""> 127              LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128          }                                                                                                         </span>
<span  style=""> 129                                                                                                                    </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 130          timeOutNum ++;                                                                                            </span>
<span class="3720393119063151586" onmouseenter="enter('3720393119063151586');" onmouseout="out('3720393119063151586');" style=""> 131          if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncTimeoutNumLimit()){                                   </span>





<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""> 132              resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 133          } else {                                                                                                  </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 134              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136      }                                                                                                             </span>
<span  style=""> 137                                                                                                                    </span>








































































































<span  style=""> 138                                                                                                                    </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style=""> 139      protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {           </span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style=""> 140          LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                           </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style=""> 141          LOG.debug(&quot;async buid row error..{}&quot;, e);                                                                 </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 142          parseErrorRecords.inc();                                                                                  </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style=""> 143          resultFuture.complete(Collections.emptyList());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144      }                                                                                                             </span>
<span  style=""> 145                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 146      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 147      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 148          super.close();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            