<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>82</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        abbr {
                          /* Here is the delay */
                          transition-delay:0s;
                        }
                    </style>
              </head>
              <body>
                <span style="height: 4vh">
                    82
                    <a href="81.html">prev</a>
                    <a href="83.html">next</a>
                    <a href="82_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Automattic/simplenote-android_7428c4d038363290d1a1a253552b709df5d5ebcb_Simplenote/src/main/java/com/automattic/simplenote/InfoBottomSheetDialog.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;7428c4d038363290d1a1a253552b709df5d5ebcb:Simplenote/src/main/java/com/automattic/simplenote/InfoBottomSheetDialog.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;7428c4d038363290d1a1a253552b709df5d5ebcb^1:Simplenote/src/main/java/com/automattic/simplenote/InfoBottomSheetDialog.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;7428c4d038363290d1a1a253552b709df5d5ebcb^2:Simplenote/src/main/java/com/automattic/simplenote/InfoBottomSheetDialog.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;e1d7aa5181efabb67e0c3c0de85f788cc7efcfcf:Simplenote/src/main/java/com/automattic/simplenote/InfoBottomSheetDialog.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b]], subset: [[b], [b], [b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre>   1 package com.automattic.simplenote;
   2 
   3 import android.content.DialogInterface;
   4 import android.os.Bundle;
   5 import android.view.LayoutInflater;
   6 import android.view.View;
   7 import android.view.ViewGroup;
   8 import android.widget.FrameLayout;
   9 import android.widget.LinearLayout;
  10 import android.widget.TextView;
  11 
  12 import androidx.annotation.NonNull;
  13 import androidx.annotation.Nullable;
  14 import androidx.fragment.app.Fragment;
  15 import androidx.fragment.app.FragmentManager;
  16 import androidx.recyclerview.widget.LinearLayoutManager;
  17 import androidx.recyclerview.widget.RecyclerView;
  18 
  19 import com.automattic.simplenote.models.Note;
  20 import com.automattic.simplenote.models.Reference;
  21 import com.automattic.simplenote.utils.DateTimeUtils;
  22 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  23 import com.automattic.simplenote.utils.DisplayUtils;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24 import com.automattic.simplenote.utils.SimplenoteLinkify;</span>
  25 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import com.google.android.material.bottomsheet.BottomSheetBehavior;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import com.google.android.material.bottomsheet.BottomSheetDialog;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import java.text.NumberFormat;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 public class InfoBottomSheetDialog extends BottomSheetDialogBase {</span>
  32 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import com.automattic.simplenote.utils.NoteUtils;</span>
  34 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
  35 import com.google.android.material.bottomsheet.BottomSheetBehavior;
  36 import com.google.android.material.bottomsheet.BottomSheetDialog;
  37 import com.simperium.client.Bucket;
  38 
  39 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  40 import java.text.NumberFormat;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41 import java.util.ArrayList;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  42 import java.util.List;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  43 </span>
  44 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46 public class InfoBottomSheetDialog extends BottomSheetDialogBase {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47     public static final String TAG = InfoBottomSheetDialog.class.getSimpleName();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49     private Fragment mFragment;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50     private TextView mCountCharacters;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51     private TextView mCountWords;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52     private TextView mDateTimeCreated;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53     private TextView mDateTimeModified;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 </span>
  55 =======
  56 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
  57 public class InfoBottomSheetDialog extends BottomSheetDialogBase {
  58     public static final String TAG = InfoBottomSheetDialog.class.getSimpleName();
  59 
  60     private Fragment mFragment;
  61     private LinearLayout mReferencesLayout;
  62     private RecyclerView mReferences;
  63     private TextView mCountCharacters;
  64     private TextView mCountWords;
  65     private TextView mDateTimeCreated;
  66     private TextView mDateTimeModified;
  67 
  68     public InfoBottomSheetDialog(@NonNull Fragment fragment) {
  69         mFragment = fragment;
  70     }
  71 
  72     @Nullable
  73     @Override
<abbr title="  74     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {">  74     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable BðŸ”µ</abbr>
  75         View infoView = inflater.inflate(R.layout.bottom_sheet_info, null, false);
  76         mCountCharacters = infoView.findViewById(R.id.count_characters);
  77         mCountWords = infoView.findViewById(R.id.count_words);
  78         mDateTimeCreated = infoView.findViewById(R.id.date_time_created);
  79         mDateTimeModified = infoView.findViewById(R.id.date_time_modified);
  80         mReferencesLayout = infoView.findViewById(R.id.references_layout);
  81         mReferences = infoView.findViewById(R.id.references);
  82 
  83         if (getDialog() != null) {
  84             // Set peek height to half height of screen.
  85             getDialog().setOnShowListener(new DialogInterface.OnShowListener() {
  86                 @Override
  87                 public void onShow(DialogInterface dialogInterface) {
  88                     BottomSheetDialog bottomSheetDialog = (BottomSheetDialog) dialogInterface;
<abbr title="  89                     FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.R.id.design_bottom_sheet);">  89                     FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.ðŸ”µ</abbr>
  90 
  91                     if (bottomSheet != null) {
<abbr title="  92                         BottomSheetBehavior&lt;FrameLayout&gt; behavior = BottomSheetBehavior.from(bottomSheet);">  92                         BottomSheetBehavior&lt;FrameLayout&gt; behavior = BottomSheetBehavior.from(bottomSheet)ðŸ”µ</abbr>
  93                         behavior.setPeekHeight(DisplayUtils.getDisplayPixelSize(requireContext()).y / 2);
  94                         behavior.setState(BottomSheetBehavior.STATE_COLLAPSED);
  95                         behavior.setSkipCollapsed(true);
  96                     }
  97                 }
  98             });
  99 
 100             getDialog().setContentView(infoView);
 101         }
 102 
 103         return super.onCreateView(inflater, container, savedInstanceState);
 104     }
 105 
 106     public void show(FragmentManager manager, Note note) {
 107         if (mFragment.isAdded()) {
 108             showNow(manager, TAG);
 109             mCountCharacters.setText(NoteUtils.getCharactersCount(note.getContent()));
 110             mCountWords.setText(NoteUtils.getWordCount(note.getContent()));
<abbr title=" 111             mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDate()));"> 111             mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDaðŸ”µ</abbr>
<abbr title=" 112             mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificationDate()));"> 112             mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificatðŸ”µ</abbr>
 113             getReferences(note);
 114         }
 115     }
 116 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 117 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 118     private String getWordCount(String content) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 119         int words = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 120         return NumberFormat.getInstance().format(words);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 121     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 122 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 123     private String getCharactersCount(String content) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 124         return NumberFormat.getInstance().format(content.length());</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 125     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 126 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 127     private void getReferences(Note note) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 128         Simplenote application = (Simplenote) mFragment.requireActivity().getApplicationContext();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 129         Bucket&lt;Note&gt; bucket = application.getNotesBucket();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 130         List&lt;Reference&gt; references = Note.getReferences(bucket, note.getSimperiumKey());</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132         if (references.size() &gt; 0) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133             mReferencesLayout.setVisibility(View.VISIBLE);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134             ReferenceAdapter adapter = new ReferenceAdapter(references);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 135             mReferences.setAdapter(adapter);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 136             mReferences.setLayoutManager(new LinearLayoutManager(requireContext()));</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 137         } else {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 138             mReferencesLayout.setVisibility(View.GONE);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 139         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 141 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 142     private class ReferenceAdapter extends RecyclerView.Adapter&lt;ReferenceAdapter.ViewHolder&gt; {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 143         private final List&lt;Reference&gt; mReferences;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145         private ReferenceAdapter(List&lt;Reference&gt; references) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146             mReferences = new ArrayList&lt;&gt;(references);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 147         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 148 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 149         @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 150         public int getItemCount() {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 151             return mReferences.size();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 152         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 153 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 154         @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 155         public void onBindViewHolder(@NonNull final ViewHolder holder, final int position) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 156             final Reference reference = mReferences.get(position);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 157             holder.mTitle.setText(reference.getTitle());</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 158             holder.mSubtitle.setText(</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 159                 getResources().getQuantityString(</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 160                     R.plurals.references_count,</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 161                     reference.getCount(),</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 162                     reference.getCount(),</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 163                     DateTimeUtils.getDateTextNumeric(reference.getDate())</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 164                 )</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 165             );</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 166             holder.mView.setOnClickListener(</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 167                 new View.OnClickListener() {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 168                     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 169                     public void onClick(View view) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 170                         SimplenoteLinkify.openNote(mFragment.requireActivity(), reference.getKey());</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 171                     }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 172                 }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 173             );</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 174         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 175 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 176         @NonNull</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 177         @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 178         public ReferenceAdapter.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 179             return new ViewHolder(LayoutInflater.from(requireContext()).inflate(R.layout.reference_list_row, parent, false));"> 179             return new ViewHolder(LayoutInflater.from(requireContext()).inflate(R.layout.reference_list_rðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 180         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 181 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 182         private class ViewHolder extends RecyclerView.ViewHolder {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 183             private TextView mSubtitle;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 184             private TextView mTitle;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 185             private View mView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 186 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 187             private ViewHolder(View itemView) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 188                 super(itemView);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 189                 mView = itemView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 190                 mTitle = itemView.findViewById(R.id.reference_title);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 191                 mSubtitle = itemView.findViewById(R.id.reference_subtitle);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 192             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 193         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 194     }</span>
 195 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198     private String getWordCount(String content) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199         int words = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200         return NumberFormat.getInstance().format(words);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203     private String getCharactersCount(String content) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204         return NumberFormat.getInstance().format(content.length());</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206 }</span>
 207 =======
 208 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 209 }</pre></td>
                            <td><pre>   1 package com.automattic.simplenote;
   2 
   3 import android.content.DialogInterface;
   4 import android.os.Bundle;
   5 import android.view.LayoutInflater;
   6 import android.view.View;
   7 import android.view.ViewGroup;
   8 import android.widget.FrameLayout;
   9 import android.widget.LinearLayout;
  10 import android.widget.TextView;
  11 
  12 import androidx.annotation.NonNull;
  13 import androidx.annotation.Nullable;
  14 import androidx.fragment.app.Fragment;
  15 import androidx.fragment.app.FragmentManager;
  16 import androidx.recyclerview.widget.LinearLayoutManager;
  17 import androidx.recyclerview.widget.RecyclerView;
  18 
  19 import com.automattic.simplenote.models.Note;
  20 import com.automattic.simplenote.models.Reference;
  21 import com.automattic.simplenote.utils.DateTimeUtils;
  22 import com.automattic.simplenote.utils.DisplayUtils;
  23 import com.automattic.simplenote.utils.SimplenoteLinkify;
  24 import com.automattic.simplenote.utils.NoteUtils;
  25 import com.google.android.material.bottomsheet.BottomSheetBehavior;
  26 import com.google.android.material.bottomsheet.BottomSheetDialog;
  27 import com.simperium.client.Bucket;
  28 import java.util.ArrayList;
  29 import java.util.List;
  30 
  31 public class InfoBottomSheetDialog extends BottomSheetDialogBase {
  32     public static final String TAG = InfoBottomSheetDialog.class.getSimpleName();
  33 
  34     private Fragment mFragment;
  35     private LinearLayout mReferencesLayout;
  36     private RecyclerView mReferences;
  37     private TextView mCountCharacters;
  38     private TextView mCountWords;
  39     private TextView mDateTimeCreated;
  40     private TextView mDateTimeModified;
  41 
  42     public InfoBottomSheetDialog(@NonNull Fragment fragment) {
  43         mFragment = fragment;
  44     }
  45 
  46     @Nullable
  47     @Override
<abbr title="  48     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {">  48     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable BðŸ”µ</abbr>
  49         View infoView = inflater.inflate(R.layout.bottom_sheet_info, null, false);
  50         mCountCharacters = infoView.findViewById(R.id.count_characters);
  51         mCountWords = infoView.findViewById(R.id.count_words);
  52         mDateTimeCreated = infoView.findViewById(R.id.date_time_created);
  53         mDateTimeModified = infoView.findViewById(R.id.date_time_modified);
  54         mReferencesLayout = infoView.findViewById(R.id.references_layout);
  55         mReferences = infoView.findViewById(R.id.references);
  56 
  57         if (getDialog() != null) {
  58             // Set peek height to half height of screen.
  59             getDialog().setOnShowListener(new DialogInterface.OnShowListener() {
  60                 @Override
  61                 public void onShow(DialogInterface dialogInterface) {
  62                     BottomSheetDialog bottomSheetDialog = (BottomSheetDialog) dialogInterface;
<abbr title="  63                     FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.R.id.design_bottom_sheet);">  63                     FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.ðŸ”µ</abbr>
  64 
  65                     if (bottomSheet != null) {
<abbr title="  66                         BottomSheetBehavior&lt;FrameLayout&gt; behavior = BottomSheetBehavior.from(bottomSheet);">  66                         BottomSheetBehavior&lt;FrameLayout&gt; behavior = BottomSheetBehavior.from(bottomSheet)ðŸ”µ</abbr>
  67                         behavior.setPeekHeight(DisplayUtils.getDisplayPixelSize(requireContext()).y / 2);
  68                         behavior.setState(BottomSheetBehavior.STATE_COLLAPSED);
  69                         behavior.setSkipCollapsed(true);
  70                     }
  71                 }
  72             });
  73 
  74             getDialog().setContentView(infoView);
  75         }
  76 
  77         return super.onCreateView(inflater, container, savedInstanceState);
  78     }
  79 
  80     public void show(FragmentManager manager, Note note) {
  81         if (mFragment.isAdded()) {
  82             showNow(manager, TAG);
  83             mCountCharacters.setText(NoteUtils.getCharactersCount(note.getContent()));
  84             mCountWords.setText(NoteUtils.getWordCount(note.getContent()));
<abbr title="  85             mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDate()));">  85             mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDaðŸ”µ</abbr>
<abbr title="  86             mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificationDate()));">  86             mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificatðŸ”µ</abbr>
  87             getReferences(note);
  88         }
  89     }
  90 
  91     private void getReferences(Note note) {
  92         Simplenote application = (Simplenote) mFragment.requireActivity().getApplicationContext();
  93         Bucket&lt;Note&gt; bucket = application.getNotesBucket();
  94         List&lt;Reference&gt; references = Note.getReferences(bucket, note.getSimperiumKey());
  95 
  96         if (references.size() &gt; 0) {
  97             mReferencesLayout.setVisibility(View.VISIBLE);
  98             ReferenceAdapter adapter = new ReferenceAdapter(references);
  99             mReferences.setAdapter(adapter);
 100             mReferences.setLayoutManager(new LinearLayoutManager(requireContext()));
 101         } else {
 102             mReferencesLayout.setVisibility(View.GONE);
 103         }
 104     }
 105 
 106     private class ReferenceAdapter extends RecyclerView.Adapter&lt;ReferenceAdapter.ViewHolder&gt; {
 107         private final List&lt;Reference&gt; mReferences;
 108 
 109         private ReferenceAdapter(List&lt;Reference&gt; references) {
 110             mReferences = new ArrayList&lt;&gt;(references);
 111         }
 112 
 113         @Override
 114         public int getItemCount() {
 115             return mReferences.size();
 116         }
 117 
 118         @Override
 119         public void onBindViewHolder(@NonNull final ViewHolder holder, final int position) {
 120             final Reference reference = mReferences.get(position);
 121             holder.mTitle.setText(reference.getTitle());
 122             holder.mSubtitle.setText(
 123                 getResources().getQuantityString(
 124                     R.plurals.references_count,
 125                     reference.getCount(),
 126                     reference.getCount(),
 127                     DateTimeUtils.getDateTextNumeric(reference.getDate())
 128                 )
 129             );
 130             holder.mView.setOnClickListener(
 131                 new View.OnClickListener() {
 132                     @Override
 133                     public void onClick(View view) {
 134                         SimplenoteLinkify.openNote(mFragment.requireActivity(), reference.getKey());
 135                     }
 136                 }
 137             );
 138         }
 139 
 140         @NonNull
 141         @Override
 142         public ReferenceAdapter.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
<abbr title=" 143             return new ViewHolder(LayoutInflater.from(requireContext()).inflate(R.layout.reference_list_row, parent, false));"> 143             return new ViewHolder(LayoutInflater.from(requireContext()).inflate(R.layout.reference_list_rðŸ”µ</abbr>
 144         }
 145 
 146         private class ViewHolder extends RecyclerView.ViewHolder {
 147             private TextView mSubtitle;
 148             private TextView mTitle;
 149             private View mView;
 150 
 151             private ViewHolder(View itemView) {
 152                 super(itemView);
 153                 mView = itemView;
 154                 mTitle = itemView.findViewById(R.id.reference_title);
 155                 mSubtitle = itemView.findViewById(R.id.reference_subtitle);
 156             }
 157         }
 158     }
 159 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                            <td><pre>   1 package com.automattic.simplenote;
   2 
   3 import android.content.DialogInterface;
   4 import android.os.Bundle;
   5 import android.view.LayoutInflater;
   6 import android.view.View;
   7 import android.view.ViewGroup;
   8 import android.widget.FrameLayout;
   9 import android.widget.LinearLayout;
  10 import android.widget.TextView;
  11 import androidx.annotation.NonNull;
  12 import androidx.annotation.Nullable;
  13 import androidx.fragment.app.Fragment;
  14 import androidx.fragment.app.FragmentManager;
  15 import androidx.recyclerview.widget.LinearLayoutManager;
  16 import androidx.recyclerview.widget.RecyclerView;
  17 import com.automattic.simplenote.models.Note;
  18 import com.automattic.simplenote.models.Reference;
  19 import com.automattic.simplenote.utils.DateTimeUtils;
  20 import com.automattic.simplenote.utils.DisplayUtils;
  21 import com.automattic.simplenote.utils.NoteUtils;
  22 import com.automattic.simplenote.utils.SimplenoteLinkify;
  23 import com.google.android.material.bottomsheet.BottomSheetBehavior;
  24 import com.google.android.material.bottomsheet.BottomSheetDialog;
  25 import com.simperium.client.Bucket;
  26 import java.util.ArrayList;
  27 import java.util.List;
  28 
  29 
  30 public class InfoBottomSheetDialog extends BottomSheetDialogBase {
  31     public static final String TAG = InfoBottomSheetDialog.class.getSimpleName();
  32 
  33     private Fragment mFragment;
  34 
  35     private LinearLayout mReferencesLayout;
  36 
  37     private RecyclerView mReferences;
  38 
  39     private TextView mCountCharacters;
  40 
  41     private TextView mCountWords;
  42 
  43     private TextView mDateTimeCreated;
  44 
  45     private TextView mDateTimeModified;
  46 
  47     public InfoBottomSheetDialog(@NonNull
  48     Fragment fragment) {
  49         mFragment = fragment;
  50     }
  51 
  52     @Nullable
  53     @Override
  54     public View onCreateView(@NonNull
  55     LayoutInflater inflater, @Nullable
  56     ViewGroup container, @Nullable
  57     Bundle savedInstanceState) {
  58         View infoView = inflater.inflate(R.layout.bottom_sheet_info, null, false);
  59         mCountCharacters = infoView.findViewById(R.id.count_characters);
  60         mCountWords = infoView.findViewById(R.id.count_words);
  61         mDateTimeCreated = infoView.findViewById(R.id.date_time_created);
  62         mDateTimeModified = infoView.findViewById(R.id.date_time_modified);
  63         mReferencesLayout = infoView.findViewById(R.id.references_layout);
  64         mReferences = infoView.findViewById(R.id.references);
  65         if (getDialog() != null) {
  66             // Set peek height to half height of screen.
  67             getDialog().setOnShowListener(new DialogInterface.OnShowListener() {
  68                 @Override
  69                 public void onShow(DialogInterface dialogInterface) {
  70                     BottomSheetDialog bottomSheetDialog = ((BottomSheetDialog) (dialogInterface));
<abbr title="  71                     FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.R.id.design_bottom_sheet);">  71                     FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.ðŸ”µ</abbr>
  72                     if (bottomSheet != null) {
<abbr title="  73                         BottomSheetBehavior&lt;FrameLayout&gt; behavior = BottomSheetBehavior.from(bottomSheet);">  73                         BottomSheetBehavior&lt;FrameLayout&gt; behavior = BottomSheetBehavior.from(bottomSheet)ðŸ”µ</abbr>
  74                         behavior.setPeekHeight(DisplayUtils.getDisplayPixelSize(requireContext()).y / 2);
  75                         behavior.setState(BottomSheetBehavior.STATE_COLLAPSED);
  76                         behavior.setSkipCollapsed(true);
  77                     }
  78                 }
  79             });
  80             getDialog().setContentView(infoView);
  81         }
  82         return super.onCreateView(inflater, container, savedInstanceState);
  83     }
  84 
  85     public void show(FragmentManager manager, Note note) {
  86         if (mFragment.isAdded()) {
  87             showNow(manager, TAG);
  88             mCountCharacters.setText(NoteUtils.getCharactersCount(note.getContent()));
  89             mCountWords.setText(NoteUtils.getWordCount(note.getContent()));
<abbr title="  90             mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDate()));">  90             mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDaðŸ”µ</abbr>
<abbr title="  91             mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificationDate()));">  91             mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificatðŸ”µ</abbr>
  92             getReferences(note);
  93         }
  94     }
  95 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre>   1  package com.automattic.simplenote;
   2  
   3  import android.content.DialogInterface;
   4  import android.os.Bundle;
   5  import android.view.LayoutInflater;
   6  import android.view.View;
   7  import android.view.ViewGroup;
   8  import android.widget.FrameLayout;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 +import android.widget.LinearLayout;</span>
  10  import android.widget.TextView;
  11  
  12  import androidx.annotation.NonNull;
  13  import androidx.annotation.Nullable;
  14  import androidx.fragment.app.Fragment;
  15  import androidx.fragment.app.FragmentManager;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  16 +import androidx.recyclerview.widget.LinearLayoutManager;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  17 +import androidx.recyclerview.widget.RecyclerView;</span>
  18  
  19  import com.automattic.simplenote.models.Note;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  20 +import com.automattic.simplenote.models.Reference;</span>
  21  import com.automattic.simplenote.utils.DateTimeUtils;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  22 +import com.automattic.simplenote.utils.DisplayUtils;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.automattic.simplenote.utils.SimplenoteLinkify;</span>
  24  import com.google.android.material.bottomsheet.BottomSheetBehavior;
  25  import com.google.android.material.bottomsheet.BottomSheetDialog;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import com.simperium.client.Bucket;</span>
  27  
  28  import java.text.NumberFormat;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import java.util.ArrayList;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +import java.util.List;</span>
  31  
  32  public class InfoBottomSheetDialog extends BottomSheetDialogBase {
  33      public static final String TAG = InfoBottomSheetDialog.class.getSimpleName();
  34  
  35      private Fragment mFragment;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +    private LinearLayout mReferencesLayout;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  37 +    private RecyclerView mReferences;</span>
  38      private TextView mCountCharacters;
  39      private TextView mCountWords;
  40      private TextView mDateTimeCreated;
  41      private TextView mDateTimeModified;
  42  
  43      public InfoBottomSheetDialog(@NonNull Fragment fragment) {
  44          mFragment = fragment;
  45      }
  46  
  47      @Nullable
  48      @Override
<abbr title="  49      public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {">  49      public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savðŸ”µ</abbr>
  50          View infoView = inflater.inflate(R.layout.bottom_sheet_info, null, false);
  51          mCountCharacters = infoView.findViewById(R.id.count_characters);
  52          mCountWords = infoView.findViewById(R.id.count_words);
  53          mDateTimeCreated = infoView.findViewById(R.id.date_time_created);
  54          mDateTimeModified = infoView.findViewById(R.id.date_time_modified);
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +        mReferencesLayout = infoView.findViewById(R.id.references_layout);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +        mReferences = infoView.findViewById(R.id.references);</span>
  57  
  58          if (getDialog() != null) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  59 -            // Set peek height to full height of view (i.e. set STATE_EXPANDED) to avoid buttons</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  60 -            // being off screen when bottom sheet is shown.</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +            // Set peek height to half height of screen.</span>
  62              getDialog().setOnShowListener(new DialogInterface.OnShowListener() {
  63                  @Override
  64                  public void onShow(DialogInterface dialogInterface) {
  65                      BottomSheetDialog bottomSheetDialog = (BottomSheetDialog) dialogInterface;
<abbr title="  66                      FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.R.id.design_bottom_sheet);">  66                      FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.R.id.desiðŸ”µ</abbr>
  67  
  68                      if (bottomSheet != null) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  69 -                        BottomSheetBehavior behavior = BottomSheetBehavior.from(bottomSheet);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  70 -                        behavior.setState(BottomSheetBehavior.STATE_EXPANDED);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +                        BottomSheetBehavior&lt;FrameLayout&gt; behavior = BottomSheetBehavior.from(bottomSheet);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +                        behavior.setPeekHeight(DisplayUtils.getDisplayPixelSize(requireContext()).y / 2);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +                        behavior.setState(BottomSheetBehavior.STATE_COLLAPSED);</span>
  74                          behavior.setSkipCollapsed(true);
  75                      }
  76                  }
  77              });
  78  
  79              getDialog().setContentView(infoView);
  80          }
  81  
  82          return super.onCreateView(inflater, container, savedInstanceState);
  83      }
  84  
  85      public void show(FragmentManager manager, Note note) {
  86          if (mFragment.isAdded()) {
  87              showNow(manager, TAG);
  88              mCountCharacters.setText(getCharactersCount(note.getContent()));
  89              mCountWords.setText(getWordCount(note.getContent()));


  90              mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDate()));
<abbr title="  91              mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificationDate()));">  91              mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificationDate()ðŸ”µ</abbr>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  92 +            getReferences(note);</span>
  93          }
  94      }
  95  
  96      private String getWordCount(String content) {
  97          int words = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;
  98          return NumberFormat.getInstance().format(words);
  99      }
 100  
 101      private String getCharactersCount(String content) {
 102          return NumberFormat.getInstance().format(content.length());
 103      }
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 105 +    private void getReferences(Note note) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +        Simplenote application = (Simplenote) mFragment.requireActivity().getApplicationContext();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +        Bucket&lt;Note&gt; bucket = application.getNotesBucket();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 108 +        List&lt;Reference&gt; references = Note.getReferences(bucket, note.getSimperiumKey());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +        if (references.size() &gt; 0) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +            mReferencesLayout.setVisibility(View.VISIBLE);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +            ReferenceAdapter adapter = new ReferenceAdapter(references);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +            mReferences.setAdapter(adapter);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +            mReferences.setLayoutManager(new LinearLayoutManager(requireContext()));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +        } else {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +            mReferencesLayout.setVisibility(View.GONE);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +    private class ReferenceAdapter extends RecyclerView.Adapter&lt;ReferenceAdapter.ViewHolder&gt; {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +        private final List&lt;Reference&gt; mReferences;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +        private ReferenceAdapter(List&lt;Reference&gt; references) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +            mReferences = new ArrayList&lt;&gt;(references);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +        @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +        public int getItemCount() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +            return mReferences.size();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +        @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +        public void onBindViewHolder(@NonNull final ViewHolder holder, final int position) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +            final Reference reference = mReferences.get(position);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +            holder.mTitle.setText(reference.getTitle());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 136 +            holder.mSubtitle.setText(</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +                getResources().getQuantityString(</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +                    R.plurals.references_count,</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +                    reference.getCount(),</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +                    reference.getCount(),</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +                    DateTimeUtils.getDateTextNumeric(reference.getDate())</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +                )</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 143 +            );</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 144 +            holder.mView.setOnClickListener(</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +                new View.OnClickListener() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +                    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +                    public void onClick(View view) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +                        SimplenoteLinkify.openNote(mFragment.requireActivity(), reference.getKey());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +                    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +                }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +            );</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +        @NonNull</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +        @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +        public ReferenceAdapter.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 157 +            return new ViewHolder(LayoutInflater.from(requireContext()).inflate(R.layout.reference_list_row, parent, false));"> 157 +            return new ViewHolder(LayoutInflater.from(requireContext()).inflate(R.layout.reference_list_row, parenðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +        private class ViewHolder extends RecyclerView.ViewHolder {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +            private TextView mSubtitle;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +            private TextView mTitle;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +            private View mView;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +            private ViewHolder(View itemView) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +                super(itemView);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +                mView = itemView;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +                mTitle = itemView.findViewById(R.id.reference_title);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +                mSubtitle = itemView.findViewById(R.id.reference_subtitle);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +            }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 171 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +    }</span>
 173  }</pre></td>
                            <td><pre>   1  package com.automattic.simplenote;
   2  
   3  import android.content.DialogInterface;
   4  import android.os.Bundle;
   5  import android.view.LayoutInflater;
   6  import android.view.View;
   7  import android.view.ViewGroup;
   8  import android.widget.FrameLayout;

   9  import android.widget.TextView;
  10  
  11  import androidx.annotation.NonNull;
  12  import androidx.annotation.Nullable;
  13  import androidx.fragment.app.Fragment;
  14  import androidx.fragment.app.FragmentManager;


  15  
  16  import com.automattic.simplenote.models.Note;

  17  import com.automattic.simplenote.utils.DateTimeUtils;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  18 +import com.automattic.simplenote.utils.NoteUtils;</span>

  19  import com.google.android.material.bottomsheet.BottomSheetBehavior;
  20  import com.google.android.material.bottomsheet.BottomSheetDialog;

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  21 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  22 -import java.text.NumberFormat;</span>


  23  
  24  public class InfoBottomSheetDialog extends BottomSheetDialogBase {
  25      public static final String TAG = InfoBottomSheetDialog.class.getSimpleName();
  26  
  27      private Fragment mFragment;


  28      private TextView mCountCharacters;
  29      private TextView mCountWords;
  30      private TextView mDateTimeCreated;
  31      private TextView mDateTimeModified;
  32  
  33      public InfoBottomSheetDialog(@NonNull Fragment fragment) {
  34          mFragment = fragment;
  35      }
  36  
  37      @Nullable
  38      @Override
<abbr title="  39      public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {">  39      public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savðŸ”µ</abbr>
  40          View infoView = inflater.inflate(R.layout.bottom_sheet_info, null, false);
  41          mCountCharacters = infoView.findViewById(R.id.count_characters);
  42          mCountWords = infoView.findViewById(R.id.count_words);
  43          mDateTimeCreated = infoView.findViewById(R.id.date_time_created);
  44          mDateTimeModified = infoView.findViewById(R.id.date_time_modified);


  45  
  46          if (getDialog() != null) {
  47              // Set peek height to full height of view (i.e. set STATE_EXPANDED) to avoid buttons
  48              // being off screen when bottom sheet is shown.

  49              getDialog().setOnShowListener(new DialogInterface.OnShowListener() {
  50                  @Override
  51                  public void onShow(DialogInterface dialogInterface) {
  52                      BottomSheetDialog bottomSheetDialog = (BottomSheetDialog) dialogInterface;
<abbr title="  53                      FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.R.id.design_bottom_sheet);">  53                      FrameLayout bottomSheet = bottomSheetDialog.findViewById(com.google.android.material.R.id.desiðŸ”µ</abbr>
  54  
  55                      if (bottomSheet != null) {
  56                          BottomSheetBehavior behavior = BottomSheetBehavior.from(bottomSheet);
  57                          behavior.setState(BottomSheetBehavior.STATE_EXPANDED);



  58                          behavior.setSkipCollapsed(true);
  59                      }
  60                  }
  61              });
  62  
  63              getDialog().setContentView(infoView);
  64          }
  65  
  66          return super.onCreateView(inflater, container, savedInstanceState);
  67      }
  68  
  69      public void show(FragmentManager manager, Note note) {
  70          if (mFragment.isAdded()) {
  71              showNow(manager, TAG);
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  72 -            mCountCharacters.setText(getCharactersCount(note.getContent()));</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  73 -            mCountWords.setText(getWordCount(note.getContent()));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +            mCountCharacters.setText(NoteUtils.getCharactersCount(note.getContent()));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  75 +            mCountWords.setText(NoteUtils.getWordCount(note.getContent()));</span>
  76              mDateTimeCreated.setText(DateTimeUtils.getDateTextString(requireContext(), note.getCreationDate()));
<abbr title="  77              mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificationDate()));">  77              mDateTimeModified.setText(DateTimeUtils.getDateTextString(requireContext(), note.getModificationDate()ðŸ”µ</abbr>

  78          }
  79      }
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  80 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  81 -    private String getWordCount(String content) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  82 -        int words = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  83 -        return NumberFormat.getInstance().format(words);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  84 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  85 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  86 -    private String getCharactersCount(String content) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  87 -        return NumberFormat.getInstance().format(content.length());</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  88 -    }</span>





































































  89  }</pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            